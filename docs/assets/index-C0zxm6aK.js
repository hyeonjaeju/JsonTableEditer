var fB=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var J0e=fB((dEe,dw)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function gB(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function mB(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function oH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function pB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ex(t,e){return t.get(oH(t,e))}function wB(t,e,n){pB(t,e),e.set(t,n)}function vB(t,e,n){return t.set(oH(t,e),n),n}const yB=100,Me={},CB=()=>{Me.previousActiveElement instanceof HTMLElement?(Me.previousActiveElement.focus(),Me.previousActiveElement=null):document.body&&document.body.focus()},bB=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Me.restoreFocusTimeout=setTimeout(()=>{CB(),e()},yB),window.scrollTo(n,r)}),sH="swal2-",SB=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],Y=SB.reduce((t,e)=>(t[e]=sH+e,t),{}),RB=["success","warning","info","question","error"],fw=RB.reduce((t,e)=>(t[e]=sH+e,t),{}),aH="SweetAlert2:",A0=t=>t.charAt(0).toUpperCase()+t.slice(1),vr=t=>{console.warn(`${aH} ${typeof t=="object"?t.join(" "):t}`)},Tu=t=>{console.error(`${aH} ${t}`)},Tx=[],EB=t=>{Tx.includes(t)||(Tx.push(t),vr(t))},lH=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;EB(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},xv=t=>typeof t=="function"?t():t,H0=t=>t&&typeof t.toPromise=="function",rg=t=>H0(t)?t.toPromise():Promise.resolve(t),N0=t=>t&&Promise.resolve(t)===t,br=()=>document.body.querySelector(`.${Y.container}`),ig=t=>{const e=br();return e?e.querySelector(t):null},si=t=>ig(`.${t}`),ct=()=>si(Y.popup),gh=()=>si(Y.icon),TB=()=>si(Y["icon-content"]),uH=()=>si(Y.title),D0=()=>si(Y["html-container"]),cH=()=>si(Y.image),k0=()=>si(Y["progress-steps"]),Iv=()=>si(Y["validation-message"]),ts=()=>ig(`.${Y.actions} .${Y.confirm}`),mh=()=>ig(`.${Y.actions} .${Y.cancel}`),Mu=()=>ig(`.${Y.actions} .${Y.deny}`),MB=()=>si(Y["input-label"]),ph=()=>ig(`.${Y.loader}`),og=()=>si(Y.actions),hH=()=>si(Y.footer),Pv=()=>si(Y["timer-progress-bar"]),$0=()=>si(Y.close),_B=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,L0=()=>{const t=ct();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(_B),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>Wr(o))},F0=()=>Gs(document.body,Y.shown)&&!Gs(document.body,Y["toast-shown"])&&!Gs(document.body,Y["no-backdrop"]),Ov=()=>{const t=ct();return t?Gs(t,Y.toast):!1},xB=()=>{const t=ct();return t?t.hasAttribute("data-loading"):!1},ai=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},Gs=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},IB=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(Y).includes(n)&&!Object.values(fw).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},oi=(t,e,n)=>{if(IB(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){vr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}pt(t,r)}},Av=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${Y.popup} > .${Y[e]}`);case"checkbox":return t.querySelector(`.${Y.popup} > .${Y.checkbox} input`);case"radio":return t.querySelector(`.${Y.popup} > .${Y.radio} input:checked`)||t.querySelector(`.${Y.popup} > .${Y.radio} input:first-child`);case"range":return t.querySelector(`.${Y.popup} > .${Y.range} input`);default:return t.querySelector(`.${Y.popup} > .${Y.input}`)}},dH=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},fH=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},pt=(t,e)=>{fH(t,e,!0)},xi=(t,e)=>{fH(t,e,!1)},Da=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&Gs(i,e))return i}},uu=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},Fn=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},ir=t=>{t&&(t.style.display="none")},V0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{sg(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},Mx=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},sg=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?Fn(t,n):ir(t)},Wr=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),PB=()=>!Wr(ts())&&!Wr(Mu())&&!Wr(mh()),_x=t=>t.scrollHeight>t.clientHeight,gH=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},B0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=Pv();n&&Wr(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},OB=()=>{const t=Pv();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},AB=()=>typeof window>"u"||typeof document>"u",HB=`
 <div aria-labelledby="${Y.title}" aria-describedby="${Y["html-container"]}" class="${Y.popup}" tabindex="-1">
   <button type="button" class="${Y.close}"></button>
   <ul class="${Y["progress-steps"]}"></ul>
   <div class="${Y.icon}"></div>
   <img class="${Y.image}" />
   <h2 class="${Y.title}" id="${Y.title}"></h2>
   <div class="${Y["html-container"]}" id="${Y["html-container"]}"></div>
   <input class="${Y.input}" id="${Y.input}" />
   <input type="file" class="${Y.file}" />
   <div class="${Y.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${Y.select}" id="${Y.select}"></select>
   <div class="${Y.radio}"></div>
   <label class="${Y.checkbox}">
     <input type="checkbox" id="${Y.checkbox}" />
     <span class="${Y.label}"></span>
   </label>
   <textarea class="${Y.textarea}" id="${Y.textarea}"></textarea>
   <div class="${Y["validation-message"]}" id="${Y["validation-message"]}"></div>
   <div class="${Y.actions}">
     <div class="${Y.loader}"></div>
     <button type="button" class="${Y.confirm}"></button>
     <button type="button" class="${Y.deny}"></button>
     <button type="button" class="${Y.cancel}"></button>
   </div>
   <div class="${Y.footer}"></div>
   <div class="${Y["timer-progress-bar-container"]}">
     <div class="${Y["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),NB=()=>{const t=br();return t?(t.remove(),xi([document.documentElement,document.body],[Y["no-backdrop"],Y["toast-shown"],Y["has-column"]]),!0):!1},ll=()=>{Me.currentInstance.resetValidationMessage()},DB=()=>{const t=ct(),e=Da(t,Y.input),n=Da(t,Y.file),r=t.querySelector(`.${Y.range} input`),i=t.querySelector(`.${Y.range} output`),o=Da(t,Y.select),s=t.querySelector(`.${Y.checkbox} input`),a=Da(t,Y.textarea);e.oninput=ll,n.onchange=ll,o.onchange=ll,s.onchange=ll,a.oninput=ll,r.oninput=()=>{ll(),i.value=r.value},r.onchange=()=>{ll(),i.value=r.value}},kB=t=>typeof t=="string"?document.querySelector(t):t,$B=t=>{const e=ct();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},LB=t=>{window.getComputedStyle(t).direction==="rtl"&&pt(br(),Y.rtl)},FB=t=>{const e=NB();if(AB()){Tu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=Y.container,e&&pt(n,Y["no-transition"]),ai(n,HB),n.dataset.swal2Theme=t.theme;const r=kB(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),$B(t),LB(r),DB()},W0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?VB(t,e):t&&ai(e,t)},VB=(t,e)=>{t.jquery?BB(e,t):ai(e,t.toString())},BB=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},WB=(t,e)=>{const n=og(),r=ph();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?ir(n):Fn(n),oi(n,e,"actions"),jB(n,r,e),ai(r,e.loaderHtml||""),oi(r,e,"loader"))};function jB(t,e,n){const r=ts(),i=Mu(),o=mh();!r||!i||!o||(By(r,"confirm",n),By(i,"deny",n),By(o,"cancel",n),UB(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function UB(t,e,n,r){if(!r.buttonsStyling){xi([t,e,n],Y.styled);return}pt([t,e,n],Y.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),Vy(t),Vy(e),Vy(n)}function Vy(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function By(t,e,n){const r=A0(e);sg(t,n[`show${r}Button`],"inline-block"),ai(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=Y[e],oi(t,n,`${e}Button`)}const zB=(t,e)=>{const n=$0();n&&(ai(n,e.closeButtonHtml||""),oi(n,e,"closeButton"),sg(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},YB=(t,e)=>{const n=br();n&&(GB(n,e.backdrop),KB(n,e.position),qB(n,e.grow),oi(n,e,"container"))};function GB(t,e){typeof e=="string"?t.style.background=e:e||pt([document.documentElement,document.body],Y["no-backdrop"])}function KB(t,e){e&&(e in Y?pt(t,Y[e]):(vr('The "position" parameter is not valid, defaulting to "center"'),pt(t,Y.center)))}function qB(t,e){e&&pt(t,Y[`grow-${e}`])}var Ht={innerParams:new WeakMap,domCache:new WeakMap};const XB=["input","file","range","select","radio","checkbox","textarea"],JB=(t,e)=>{const n=ct();if(!n)return;const r=Ht.innerParams.get(t),i=!r||e.input!==r.input;XB.forEach(o=>{const s=Da(n,Y[o]);s&&(eW(o,e.inputAttributes),s.className=Y[o],i&&ir(s))}),e.input&&(i&&ZB(e),tW(e))},ZB=t=>{if(!t.input)return;if(!hn[t.input]){Tu(`Unexpected type of input! Expected ${Object.keys(hn).join(" | ")}, got "${t.input}"`);return}const e=mH(t.input);if(!e)return;const n=hn[t.input](e,t);Fn(e),t.inputAutoFocus&&setTimeout(()=>{dH(n)})},QB=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},eW=(t,e)=>{const n=ct();if(!n)return;const r=Av(n,t);if(r){QB(r);for(const i in e)r.setAttribute(i,e[i])}},tW=t=>{if(!t.input)return;const e=mH(t.input);e&&oi(e,t,"input")},j0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},ag=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=Y["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&pt(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},mH=t=>{const e=ct();if(e)return Da(e,Y[t]||Y.input)},gw=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:N0(e)||vr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},hn={};hn.text=hn.email=hn.password=hn.number=hn.tel=hn.url=hn.search=hn.date=hn["datetime-local"]=hn.time=hn.week=hn.month=(t,e)=>(gw(t,e.inputValue),ag(t,t,e),j0(t,e),t.type=e.input,t);hn.file=(t,e)=>(ag(t,t,e),j0(t,e),t);hn.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return gw(n,e.inputValue),n.type=e.input,gw(r,e.inputValue),ag(n,t,e),t};hn.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");ai(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return ag(t,t,e),t};hn.radio=t=>(t.textContent="",t);hn.checkbox=(t,e)=>{const n=Av(ct(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return ai(r,e.inputPlaceholder||e.inputLabel),n};hn.textarea=(t,e)=>{gw(t,e.inputValue),j0(t,e),ag(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(ct()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?ct().style.width=`${o}px`:uu(ct(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const nW=(t,e)=>{const n=D0();n&&(V0(n),oi(n,e,"htmlContainer"),e.html?(W0(e.html,n),Fn(n,"block")):e.text?(n.textContent=e.text,Fn(n,"block")):ir(n),JB(t,e))},rW=(t,e)=>{const n=hH();n&&(V0(n),sg(n,e.footer,"block"),e.footer&&W0(e.footer,n),oi(n,e,"footer"))},iW=(t,e)=>{const n=Ht.innerParams.get(t),r=gh();if(!r)return;if(n&&e.icon===n.icon){Ix(r,e),xx(r,e);return}if(!e.icon&&!e.iconHtml){ir(r);return}if(e.icon&&Object.keys(fw).indexOf(e.icon)===-1){Tu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),ir(r);return}Fn(r),Ix(r,e),xx(r,e),pt(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",pH)},xx=(t,e)=>{for(const[n,r]of Object.entries(fw))e.icon!==n&&xi(t,r);pt(t,e.icon&&fw[e.icon]),aW(t,e),pH(),oi(t,e,"icon")},pH=()=>{const t=ct();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},oW=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,sW=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,Ix=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=Px(e.iconHtml):e.icon==="success"?(r=oW,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=sW:e.icon&&(r=Px({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&ai(t,r)},aW=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Mx(t,n,"background-color",e.iconColor);Mx(t,".swal2-success-ring","border-color",e.iconColor)}},Px=t=>`<div class="${Y["icon-content"]}">${t}</div>`,lW=(t,e)=>{const n=cH();if(n){if(!e.imageUrl){ir(n);return}Fn(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),uu(n,"width",e.imageWidth),uu(n,"height",e.imageHeight),n.className=Y.image,oi(n,e,"image")}};let U0=!1,wH=0,vH=0,yH=0,CH=0;const uW=t=>{t.addEventListener("mousedown",mw),document.body.addEventListener("mousemove",pw),t.addEventListener("mouseup",ww),t.addEventListener("touchstart",mw),document.body.addEventListener("touchmove",pw),t.addEventListener("touchend",ww)},cW=t=>{t.removeEventListener("mousedown",mw),document.body.removeEventListener("mousemove",pw),t.removeEventListener("mouseup",ww),t.removeEventListener("touchstart",mw),document.body.removeEventListener("touchmove",pw),t.removeEventListener("touchend",ww)},mw=t=>{const e=ct();if(t.target===e||gh().contains(t.target)){U0=!0;const n=bH(t);wH=n.clientX,vH=n.clientY,yH=parseInt(e.style.insetInlineStart)||0,CH=parseInt(e.style.insetBlockStart)||0,pt(e,"swal2-dragging")}},pw=t=>{const e=ct();if(U0){let{clientX:n,clientY:r}=bH(t);e.style.insetInlineStart=`${yH+(n-wH)}px`,e.style.insetBlockStart=`${CH+(r-vH)}px`}},ww=()=>{const t=ct();U0=!1,xi(t,"swal2-dragging")},bH=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},hW=(t,e)=>{const n=br(),r=ct();if(!(!n||!r)){if(e.toast){uu(n,"width",e.width),r.style.width="100%";const i=ph();i&&r.insertBefore(i,gh())}else uu(r,"width",e.width);uu(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),ir(Iv()),dW(r,e),e.draggable&&!e.toast?(pt(r,Y.draggable),uW(r)):(xi(r,Y.draggable),cW(r))}},dW=(t,e)=>{const n=e.showClass||{};t.className=`${Y.popup} ${Wr(t)?n.popup:""}`,e.toast?(pt([document.documentElement,document.body],Y["toast-shown"]),pt(t,Y.toast)):pt(t,Y.modal),oi(t,e,"popup"),typeof e.customClass=="string"&&pt(t,e.customClass),e.icon&&pt(t,Y[`icon-${e.icon}`])},fW=(t,e)=>{const n=k0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){ir(n);return}Fn(n),n.textContent="",i>=r.length&&vr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=gW(o);if(n.appendChild(a),s===i&&pt(a,Y["active-progress-step"]),s!==r.length-1){const l=mW(e);n.appendChild(l)}})},gW=t=>{const e=document.createElement("li");return pt(e,Y["progress-step"]),ai(e,t),e},mW=t=>{const e=document.createElement("li");return pt(e,Y["progress-step-line"]),t.progressStepsDistance&&uu(e,"width",t.progressStepsDistance),e},pW=(t,e)=>{const n=uH();n&&(V0(n),sg(n,e.title||e.titleText,"block"),e.title&&W0(e.title,n),e.titleText&&(n.innerText=e.titleText),oi(n,e,"title"))},SH=(t,e)=>{hW(t,e),YB(t,e),fW(t,e),iW(t,e),lW(t,e),pW(t,e),zB(t,e),nW(t,e),WB(t,e),rW(t,e);const n=ct();typeof e.didRender=="function"&&n&&e.didRender(n),Me.eventEmitter.emit("didRender",n)},wW=()=>Wr(ct()),RH=()=>{var t;return(t=ts())===null||t===void 0?void 0:t.click()},vW=()=>{var t;return(t=Mu())===null||t===void 0?void 0:t.click()},yW=()=>{var t;return(t=mh())===null||t===void 0?void 0:t.click()},wh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),EH=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},CW=(t,e,n)=>{EH(t),e.toast||(t.keydownHandler=r=>SW(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:ct(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},ZS=(t,e)=>{var n;const r=L0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=ct())===null||n===void 0||n.focus()},TH=["ArrowRight","ArrowDown"],bW=["ArrowLeft","ArrowUp"],SW=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?RW(e,t):e.key==="Tab"?EW(e):[...TH,...bW].includes(e.key)?TW(e.key):e.key==="Escape"&&MW(e,t,n)))},RW=(t,e)=>{if(!xv(e.allowEnterKey))return;const n=Av(ct(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;RH(),t.preventDefault()}},EW=t=>{const e=t.target,n=L0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?ZS(r,-1):ZS(r,1),t.stopPropagation(),t.preventDefault()},TW=t=>{const e=og(),n=ts(),r=Mu(),i=mh();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=TH.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Wr(a))break}a instanceof HTMLButtonElement&&a.focus()}},MW=(t,e,n)=>{xv(e.allowEscapeKey)&&(t.preventDefault(),n(wh.esc))};var nh={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const _W=()=>{const t=br();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},MH=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},_H=typeof window<"u"&&!!window.GestureEvent,xW=()=>{if(_H&&!Gs(document.body,Y.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,pt(document.body,Y.iosfix),IW()}},IW=()=>{const t=br();if(!t)return;let e;t.ontouchstart=n=>{e=PW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},PW=t=>{const e=t.target,n=br(),r=D0();return!n||!r||OW(t)||AW(t)?!1:e===n||!_x(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(_x(r)&&r.contains(e))},OW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",AW=t=>t.touches&&t.touches.length>1,HW=()=>{if(Gs(document.body,Y.iosfix)){const t=parseInt(document.body.style.top,10);xi(document.body,Y.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},NW=()=>{const t=document.createElement("div");t.className=Y["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let jc=null;const DW=t=>{jc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(jc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${jc+NW()}px`)},kW=()=>{jc!==null&&(document.body.style.paddingRight=`${jc}px`,jc=null)};function xH(t,e,n,r){Ov()?Ox(t,r):(bB(n).then(()=>Ox(t,r)),EH(Me)),_H?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),F0()&&(kW(),HW(),MH()),$W()}function $W(){xi([document.documentElement,document.body],[Y.shown,Y["height-auto"],Y["no-backdrop"],Y["toast-shown"]])}function ka(t){t=FW(t);const e=nh.swalPromiseResolve.get(this),n=LW(this);this.isAwaitingPromise?t.isDismissed||(lg(this),e(t)):n&&e(t)}const LW=t=>{const e=ct();if(!e)return!1;const n=Ht.innerParams.get(t);if(!n||Gs(e,n.hideClass.popup))return!1;xi(e,n.showClass.popup),pt(e,n.hideClass.popup);const r=br();return xi(r,n.showClass.backdrop),pt(r,n.hideClass.backdrop),VW(t,e,n),!0};function IH(t){const e=nh.swalPromiseReject.get(this);lg(this),e&&e(t)}const lg=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Ht.innerParams.get(t)||t._destroy())},FW=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),VW=(t,e,n)=>{var r;const i=br(),o=gH(e);typeof n.willClose=="function"&&n.willClose(e),(r=Me.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?BW(t,e,i,n.returnFocus,n.didClose):xH(t,i,n.returnFocus,n.didClose)},BW=(t,e,n,r,i)=>{Me.swalCloseEventFinishedCallback=xH.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Me.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Me),delete Me.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},Ox=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Me.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},rh=t=>{let e=ct();if(e||new ri,e=ct(),!e)return;const n=ph();Ov()?ir(gh()):WW(e,t),Fn(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},WW=(t,e)=>{const n=og(),r=ph();!n||!r||(!e&&Wr(ts())&&(e=ts()),Fn(n),e&&(ir(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),pt([t,n],Y.loading))},jW=(t,e)=>{e.input==="select"||e.input==="radio"?KW(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(H0(e.inputValue)||N0(e.inputValue))&&(rh(ts()),qW(t,e))},UW=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return zW(n);case"radio":return YW(n);case"file":return GW(n);default:return e.inputAutoTrim?n.value.trim():n.value}},zW=t=>t.checked?1:0,YW=t=>t.checked?t.value:null,GW=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,KW=(t,e)=>{const n=ct();if(!n)return;const r=i=>{e.input==="select"?XW(n,vw(i),e):e.input==="radio"&&JW(n,vw(i),e)};H0(e.inputOptions)||N0(e.inputOptions)?(rh(ts()),rg(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):Tu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},qW=(t,e)=>{const n=t.getInput();n&&(ir(n),rg(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,Fn(n),n.focus(),t.hideLoading()}).catch(r=>{Tu(`Error in inputValue promise: ${r}`),n.value="",Fn(n),n.focus(),t.hideLoading()}))};function XW(t,e,n){const r=Da(t,Y.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,ai(l,s),l.selected=PH(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function JW(t,e,n){const r=Da(t,Y.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=Y.radio,l.value=s,PH(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");ai(c,a),c.className=Y.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const vw=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=vw(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=vw(r)),e.push([n,r])}),e},PH=(t,e)=>!!e&&e.toString()===t.toString(),ZW=t=>{const e=Ht.innerParams.get(t);t.disableButtons(),e.input?OH(t,"confirm"):Y0(t,!0)},QW=t=>{const e=Ht.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?OH(t,"deny"):z0(t,!1)},e2=(t,e)=>{t.disableButtons(),e(wh.cancel)},OH=(t,e)=>{const n=Ht.innerParams.get(t);if(!n.input){Tu(`The "input" parameter is needed to be set when using returnInputValueOn${A0(e)}`);return}const r=t.getInput(),i=UW(t,n);n.inputValidator?t2(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?z0(t,i):Y0(t,i)},t2=(t,e,n)=>{const r=Ht.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>rg(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?z0(t,e):Y0(t,e)})},z0=(t,e)=>{const n=Ht.innerParams.get(t||void 0);n.showLoaderOnDeny&&rh(Mu()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>rg(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),lg(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>AH(t||void 0,i))):t.close({isDenied:!0,value:e})},Ax=(t,e)=>{t.close({isConfirmed:!0,value:e})},AH=(t,e)=>{t.rejectPromise(e)},Y0=(t,e)=>{const n=Ht.innerParams.get(t||void 0);n.showLoaderOnConfirm&&rh(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>rg(n.preConfirm(e,n.validationMessage))).then(i=>{Wr(Iv())||i===!1?(t.hideLoading(),lg(t)):Ax(t,typeof i>"u"?e:i)}).catch(i=>AH(t||void 0,i))):Ax(t,e)};function yw(){const t=Ht.innerParams.get(this);if(!t)return;const e=Ht.domCache.get(this);ir(e.loader),Ov()?t.icon&&Fn(gh()):n2(e),xi([e.popup,e.actions],Y.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const n2=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?Fn(e[0],"inline-block"):PB()&&ir(t.actions)};function HH(){const t=Ht.innerParams.get(this),e=Ht.domCache.get(this);return e?Av(e.popup,t.input):null}function NH(t,e,n){const r=Ht.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function DH(t,e){const n=ct();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${Y.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function kH(){NH(this,["confirmButton","denyButton","cancelButton"],!1)}function $H(){NH(this,["confirmButton","denyButton","cancelButton"],!0)}function LH(){DH(this.getInput(),!1)}function FH(){DH(this.getInput(),!0)}function VH(t){const e=Ht.domCache.get(this),n=Ht.innerParams.get(this);ai(e.validationMessage,t),e.validationMessage.className=Y["validation-message"],n.customClass&&n.customClass.validationMessage&&pt(e.validationMessage,n.customClass.validationMessage),Fn(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",Y["validation-message"]),dH(r),pt(r,Y.inputerror))}function BH(){const t=Ht.domCache.get(this);t.validationMessage&&ir(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),xi(e,Y.inputerror))}const Uc={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},r2=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],i2={allowEnterKey:void 0},o2=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],WH=t=>Object.prototype.hasOwnProperty.call(Uc,t),jH=t=>r2.indexOf(t)!==-1,UH=t=>i2[t],s2=t=>{WH(t)||vr(`Unknown parameter "${t}"`)},a2=t=>{o2.includes(t)&&vr(`The parameter "${t}" is incompatible with toasts`)},l2=t=>{const e=UH(t);e&&lH(t,e)},zH=t=>{t.backdrop===!1&&t.allowOutsideClick&&vr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&vr(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)s2(e),t.toast&&a2(e),l2(e)};function YH(t){const e=br(),n=ct(),r=Ht.innerParams.get(this);if(!n||Gs(n,r.hideClass.popup)){vr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=u2(t),o=Object.assign({},r,i);zH(o),e.dataset.swal2Theme=o.theme,SH(this,o),Ht.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const u2=t=>{const e={};return Object.keys(t).forEach(n=>{jH(n)?e[n]=t[n]:vr(`Invalid parameter to update: ${n}`)}),e};function GH(){const t=Ht.domCache.get(this),e=Ht.innerParams.get(this);if(!e){KH(this);return}t.popup&&Me.swalCloseEventFinishedCallback&&(Me.swalCloseEventFinishedCallback(),delete Me.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Me.eventEmitter.emit("didDestroy"),c2(this)}const c2=t=>{KH(t),delete t.params,delete Me.keydownHandler,delete Me.keydownTarget,delete Me.currentInstance},KH=t=>{t.isAwaitingPromise?(Wy(Ht,t),t.isAwaitingPromise=!0):(Wy(nh,t),Wy(Ht,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},Wy=(t,e)=>{for(const n in t)t[n].delete(e)};var h2=Object.freeze({__proto__:null,_destroy:GH,close:ka,closeModal:ka,closePopup:ka,closeToast:ka,disableButtons:$H,disableInput:FH,disableLoading:yw,enableButtons:kH,enableInput:LH,getInput:HH,handleAwaitingPromise:lg,hideLoading:yw,rejectPromise:IH,resetValidationMessage:BH,showValidationMessage:VH,update:YH});const d2=(t,e,n)=>{t.toast?f2(t,e,n):(m2(e),p2(e),w2(t,e,n))},f2=(t,e,n)=>{e.popup.onclick=()=>{t&&(g2(t)||t.timer||t.input)||n(wh.close)}},g2=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let Cw=!1;const m2=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(Cw=!0)}}},p2=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(Cw=!0)}}},w2=(t,e,n)=>{e.container.onclick=r=>{if(Cw){Cw=!1;return}r.target===e.container&&xv(t.allowOutsideClick)&&n(wh.backdrop)}},v2=t=>typeof t=="object"&&t.jquery,Hx=t=>t instanceof Element||v2(t),y2=t=>{const e={};return typeof t[0]=="object"&&!Hx(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||Hx(i)?e[n]=i:i!==void 0&&Tu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function C2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function b2(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const S2=()=>Me.timeout&&Me.timeout.getTimerLeft(),qH=()=>{if(Me.timeout)return OB(),Me.timeout.stop()},XH=()=>{if(Me.timeout){const t=Me.timeout.start();return B0(t),t}},R2=()=>{const t=Me.timeout;return t&&(t.running?qH():XH())},E2=t=>{if(Me.timeout){const e=Me.timeout.increase(t);return B0(e,!0),e}},T2=()=>!!(Me.timeout&&Me.timeout.isRunning());let Nx=!1;const QS={};function M2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";QS[t]=this,Nx||(document.body.addEventListener("click",_2),Nx=!0)}const _2=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in QS){const r=e.getAttribute(n);if(r){QS[n].fire({template:r});return}}};class x2{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Me.eventEmitter=new x2;const I2=(t,e)=>{Me.eventEmitter.on(t,e)},P2=(t,e)=>{Me.eventEmitter.once(t,e)},O2=(t,e)=>{if(!t){Me.eventEmitter.reset();return}e?Me.eventEmitter.removeListener(t,e):Me.eventEmitter.removeAllListeners(t)};var A2=Object.freeze({__proto__:null,argsToParams:y2,bindClickHandler:M2,clickCancel:yW,clickConfirm:RH,clickDeny:vW,enableLoading:rh,fire:C2,getActions:og,getCancelButton:mh,getCloseButton:$0,getConfirmButton:ts,getContainer:br,getDenyButton:Mu,getFocusableElements:L0,getFooter:hH,getHtmlContainer:D0,getIcon:gh,getIconContent:TB,getImage:cH,getInputLabel:MB,getLoader:ph,getPopup:ct,getProgressSteps:k0,getTimerLeft:S2,getTimerProgressBar:Pv,getTitle:uH,getValidationMessage:Iv,increaseTimer:E2,isDeprecatedParameter:UH,isLoading:xB,isTimerRunning:T2,isUpdatableParameter:jH,isValidParameter:WH,isVisible:wW,mixin:b2,off:O2,on:I2,once:P2,resumeTimer:XH,showLoading:rh,stopTimer:qH,toggleTimer:R2});class H2{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const JH=["swal-title","swal-html","swal-footer"],N2=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return W2(n),Object.assign(D2(n),k2(n),$2(n),L2(n),F2(n),V2(n),B2(n,JH))},D2=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{gu(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof Uc[i]=="boolean"?e[i]=o!=="false":typeof Uc[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},k2=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},$2=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{gu(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${A0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},L2=t=>{const e={},n=t.querySelector("swal-image");return n&&(gu(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},F2=t=>{const e={},n=t.querySelector("swal-icon");return n&&(gu(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},V2=t=>{const e={},n=t.querySelector("swal-input");n&&(gu(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{gu(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},B2=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(gu(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},W2=t=>{const e=JH.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||vr(`Unrecognized element <${r}>`)})},gu=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&vr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},ZH=10,j2=t=>{const e=br(),n=ct();typeof t.willOpen=="function"&&t.willOpen(n),Me.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;Y2(e,n,t),setTimeout(()=>{U2(e,n)},ZH),F0()&&(z2(e,t.scrollbarPadding,i),_W()),!Ov()&&!Me.previousActiveElement&&(Me.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Me.eventEmitter.emit("didOpen",n),xi(e,Y["no-transition"])},bw=t=>{const e=ct();if(t.target!==e)return;const n=br();e.removeEventListener("animationend",bw),e.removeEventListener("transitionend",bw),n.style.overflowY="auto"},U2=(t,e)=>{gH(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",bw),e.addEventListener("transitionend",bw)):t.style.overflowY="auto"},z2=(t,e,n)=>{xW(),e&&n!=="hidden"&&DW(n),setTimeout(()=>{t.scrollTop=0})},Y2=(t,e,n)=>{pt(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),Fn(e,"grid"),setTimeout(()=>{pt(e,n.showClass.popup),e.style.removeProperty("opacity")},ZH)):Fn(e,"grid"),pt([document.documentElement,document.body],Y.shown),n.heightAuto&&n.backdrop&&!n.toast&&pt([document.documentElement,document.body],Y["height-auto"])};var Dx={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function G2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=Dx.email),t.input==="url"&&(t.inputValidator=Dx.url))}function K2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(vr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function q2(t){G2(t),t.showLoaderOnConfirm&&!t.preConfirm&&vr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),K2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),FB(t)}let Wo;var Ug=new WeakMap;class wn{constructor(){if(wB(this,Ug,void 0),typeof window>"u")return;Wo=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,vB(Ug,this,this._main(Wo.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(zH(Object.assign({},n,e)),Me.currentInstance){const o=nh.swalPromiseResolve.get(Me.currentInstance),{isAwaitingPromise:s}=Me.currentInstance;Me.currentInstance._destroy(),s||o({isDismissed:!0}),F0()&&MH()}Me.currentInstance=Wo;const r=J2(e,n);q2(r),Object.freeze(r),Me.timeout&&(Me.timeout.stop(),delete Me.timeout),clearTimeout(Me.restoreFocusTimeout);const i=Z2(Wo);return SH(Wo,r),Ht.innerParams.set(Wo,r),X2(Wo,i,r)}then(e){return Ex(Ug,this).then(e)}finally(e){return Ex(Ug,this).finally(e)}}const X2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};nh.swalPromiseResolve.set(t,r),nh.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{ZW(t)},e.denyButton.onclick=()=>{QW(t)},e.cancelButton.onclick=()=>{e2(t,o)},e.closeButton.onclick=()=>{o(wh.close)},d2(n,e,o),CW(Me,n,o),jW(t,n),j2(n),Q2(Me,n,o),ej(e,n),setTimeout(()=>{e.container.scrollTop=0})}),J2=(t,e)=>{const n=N2(t),r=Object.assign({},Uc,e,n,t);return r.showClass=Object.assign({},Uc.showClass,r.showClass),r.hideClass=Object.assign({},Uc.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},Z2=t=>{const e={popup:ct(),container:br(),actions:og(),confirmButton:ts(),denyButton:Mu(),cancelButton:mh(),loader:ph(),closeButton:$0(),validationMessage:Iv(),progressSteps:k0()};return Ht.domCache.set(t,e),e},Q2=(t,e,n)=>{const r=Pv();ir(r),e.timer&&(t.timeout=new H2(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(Fn(r),oi(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&B0(e.timer)})))},ej=(t,e)=>{if(!e.toast){if(!xv(e.allowEnterKey)){lH("allowEnterKey"),rj();return}tj(t)||nj(t,e)||ZS(-1,1)}},tj=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&Wr(n))return n.focus(),!0;return!1},nj=(t,e)=>e.focusDeny&&Wr(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Wr(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&Wr(t.confirmButton)?(t.confirmButton.focus(),!0):!1,rj=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}wn.prototype.disableButtons=$H;wn.prototype.enableButtons=kH;wn.prototype.getInput=HH;wn.prototype.disableInput=FH;wn.prototype.enableInput=LH;wn.prototype.hideLoading=yw;wn.prototype.disableLoading=yw;wn.prototype.showValidationMessage=VH;wn.prototype.resetValidationMessage=BH;wn.prototype.close=ka;wn.prototype.closePopup=ka;wn.prototype.closeModal=ka;wn.prototype.closeToast=ka;wn.prototype.rejectPromise=IH;wn.prototype.update=YH;wn.prototype._destroy=GH;Object.assign(wn,A2);Object.keys(h2).forEach(t=>{wn[t]=function(){return Wo&&Wo[t]?Wo[t](...arguments):null}});wn.DismissReason=wh;wn.version="11.21.0";const ri=wn;ri.default=ri;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var ea=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(_){if(_=o.postProcess(_,r),i){setTimeout(function(){i(_)},0);return}else return _},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],p=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&p+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var C=-1/0,E=1/0,y=function(){for(var _=Math.max(C,-c);_<=Math.min(E,c);_+=2){var P=void 0,M=g[_-1],I=g[_+1];M&&(g[_-1]=void 0);var z=!1;if(I){var W=I.oldPos-_;z=I&&0<=W&&W<l}var V=M&&M.oldPos+1<u;if(!z&&!V){g[_]=void 0;continue}if(!V||z&&M.oldPos<I.oldPos?P=o.addToPath(I,!0,!1,0,r):P=o.addToPath(M,!1,!0,1,r),p=o.extractCommon(P,n,e,_,r),P.oldPos+1>=u&&p+1>=l)return a(o.buildValues(P.lastComponent,n,e))||!0;g[_]=P,P.oldPos+1>=u&&(E=Math.min(E,_-1)),p+1>=l&&(C=Math.max(C,_+1))}c++};if(i)(function _(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);y()||_()},0)})();else for(;c<=h&&Date.now()<=f;){var T=y();if(T)return T}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),ij=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),oj=function(t){ij(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(ea),QH=new oj;function sj(t,e,n){return QH.diff(t,e,n)}function kx(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function $x(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function eR(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function tR(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function kh(t,e){return eR(t,e,"")}function zg(t,e){return tR(t,e,"")}function Lx(t,e){return e.slice(0,aj(t,e))}function aj(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function lj(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function uj(t){return!t.includes(`\r
`)&&t.includes(`
`)}function $h(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function aa(t){var e=t.match(/^\s*/);return e?e[0]:""}var eN=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sw="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",cj=new RegExp("[".concat(Sw,"]+|\\s+|[^").concat(Sw,"]"),"ug"),hj=function(t){eN(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(cj)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&Fx(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&Fx(i,s,o,null),n},e}(ea),tN=new hj;function dj(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?rN(t,e,n):tN.diff(t,e,n)}function Fx(t,e,n,r){if(e&&n){var i=aa(e.value),o=$h(e.value),s=aa(n.value),a=$h(n.value);if(t){var l=kx(i,s);t.value=tR(t.value,s,l),e.value=kh(e.value,l),n.value=kh(n.value,l)}if(r){var u=$x(o,a);r.value=eR(r.value,a,u),e.value=zg(e.value,u),n.value=zg(n.value,u)}}else if(n){if(t){var c=aa(n.value);n.value=n.value.substring(c.length)}if(r){var c=aa(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=aa(r.value),d=aa(e.value),f=$h(e.value),g=kx(h,d);e.value=kh(e.value,g);var p=$x(kh(h,g),f);e.value=zg(e.value,p),r.value=eR(r.value,h,p),t.value=tR(t.value,h,h.slice(0,h.length-p.length))}else if(r){var C=aa(r.value),E=$h(e.value),y=Lx(E,C);e.value=zg(e.value,y)}else if(t){var T=$h(t.value),_=aa(e.value),y=Lx(T,_);e.value=kh(e.value,y)}}var fj=function(t){eN(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(Sw,"]+|[^\\S\\n\\r]+|[^").concat(Sw,"]"),"ug");return n.match(r)||[]},e}(ea),nN=new fj;function rN(t,e,n){return nN.diff(t,e,n)}function gj(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var mj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),pj=function(t){mj(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=iN,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}(ea),G0=new pj;function Pf(t,e,n){return G0.diff(t,e,n)}function wj(t,e,n){return n=gj(n,{ignoreWhitespace:!0}),G0.diff(t,e,n)}function iN(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var vj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),yj=function(t){vj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}(ea),oN=new yj;function Cj(t,e,n){return oN.diff(t,e,n)}var bj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sj=function(t){bj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}(ea),sN=new Sj;function Rj(t,e,n){return sN.diff(t,e,n)}var Ej=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tj=function(t){Ej(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=iN,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(Rw(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}(ea),aN=new Tj;function Mj(t,e,n){return aN.diff(t,e,n)}function Rw(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=Rw(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=Rw(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var _j=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),xj=function(t){_j(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}(ea),lN=new xj;function Ij(t,e,n){return lN.diff(t,e,n)}var Xo=function(){return Xo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Xo.apply(this,arguments)};function uN(t){return Array.isArray(t)?t.map(function(e){return uN(e)}):Xo(Xo({},t),{hunks:t.hunks.map(function(e){return Xo(Xo({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function cN(t){return Array.isArray(t)?t.map(function(e){return cN(e)}):Xo(Xo({},t),{hunks:t.hunks.map(function(e){return Xo(Xo({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function Pj(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function Oj(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function K0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function Aj(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function hN(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=K0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return Hj(t,r[0],n)}function Hj(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(lj(t)&&Pj(e)?e=uN(e):uj(t)&&Oj(e)&&(e=cN(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(z,W,V,q){return W===q},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(z,W,V,q,Z,ee,te){q===void 0&&(q=0),Z===void 0&&(Z=!0),ee===void 0&&(ee=[]),te===void 0&&(te=0);for(var he=0,Ue=!1;q<z.length;q++){var ve=z[q],He=ve.length>0?ve[0]:" ",st=ve.length>0?ve.substr(1):ve;if(He==="-")if(o(W+1,r[W],He,st))W++,he=0;else return!V||r[W]==null?null:(ee[te]=r[W],f(z,W+1,V-1,q,!1,ee,te+1));if(He==="+"){if(!Z)return null;ee[te]=st,te++,he=0,Ue=!0}if(He===" ")if(he++,ee[te]=r[W],o(W+1,r[W],He,st))te++,Z=!0,Ue=!1,W++;else return Ue||!V?null:r[W]&&(f(z,W+1,V-1,q+1,!1,ee,te+1)||f(z,W+1,V-1,q,!1,ee,te+1))||f(z,W,V-1,q+1,!1,ee,te)}return te-=he,W-=he,ee.length=te,{patchedLines:ee,oldLineLastI:W-1}}for(var g=[],p=0,h=0;h<i.length;h++){for(var C=i[h],E=void 0,y=r.length-C.oldLines+s,T=void 0,_=0;_<=s;_++){T=C.oldStart+p-1;for(var P=Aj(T,a,y);T!==void 0&&(E=f(C.lines,T,_),!E);T=P());if(E)break}if(!E)return!1;for(var M=a;M<T;M++)g.push(r[M]);for(var I=0;I<E.patchedLines.length;I++){var d=E.patchedLines[I];g.push(d)}a=E.oldLineLastI+1,p=T+1-C.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function Nj(t,e){var n=typeof t=="string"?K0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=hN(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var Ew=function(){return Ew=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Ew.apply(this,arguments)};function dN(t){return Array.isArray(t)?t.map(function(e){return dN(e)}).reverse():Ew(Ew({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var ih=function(){return ih=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ih.apply(this,arguments)};function nR(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;Pf(n,r,ih(ih({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(Pf(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(He){return He.map(function(st){return" "+st})}for(var f=[],g=0,p=0,C=[],E=1,y=1,T=0;T<h.length;T++){var _=h[T],P=_.lines||kj(_.value);if(_.lines=P,_.added||_.removed){if(!g){var M=h[T-1];g=E,p=y,M&&(C=l>0?d(M.lines.slice(-l)):[],g-=C.length,p-=C.length)}for(var I=0,z=P;I<z.length;I++){var W=z[I];C.push((_.added?"+":"-")+W)}_.added?y+=P.length:E+=P.length}else{if(g)if(P.length<=l*2&&T<h.length-2)for(var V=0,q=d(P);V<q.length;V++){var W=q[V];C.push(W)}else{for(var Z=Math.min(P.length,l),ee=0,te=d(P.slice(0,Z));ee<te.length;ee++){var W=te[ee];C.push(W)}var he={oldStart:g,oldLines:E-g+Z,newStart:p,newLines:y-p+Z,lines:C};f.push(he),g=0,p=0,C=[]}E+=P.length,y+=P.length}}for(var Ue=0,ve=f;Ue<ve.length;Ue++)for(var he=ve[Ue],T=0;T<he.lines.length;T++)he.lines[T].endsWith(`
`)?he.lines[T]=he.lines[T].slice(0,-1):(he.lines.splice(T+1,0,"\\ No newline at end of file"),T++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function Tw(t){if(Array.isArray(t))return t.map(Tw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function fN(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;nR(t,e,n,r,i,o,ih(ih({},s),{callback:function(u){l(u?Tw(u):void 0)}}))}else{var a=nR(t,e,n,r,i,o,s);return a?Tw(a):void 0}}function Dj(t,e,n,r,i,o){return fN(t,t,e,n,r,i,o)}function kj(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function $j(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function Lj(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(Fj(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function Fj(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const Vj=Object.freeze(Object.defineProperty({__proto__:null,Diff:ea,applyPatch:hN,applyPatches:Nj,arrayDiff:lN,canonicalize:Rw,characterDiff:QH,convertChangesToDMP:$j,convertChangesToXML:Lj,createPatch:Dj,createTwoFilesPatch:fN,cssDiff:sN,diffArrays:Ij,diffChars:sj,diffCss:Rj,diffJson:Mj,diffLines:Pf,diffSentences:Cj,diffTrimmedLines:wj,diffWords:dj,diffWordsWithSpace:rN,formatPatch:Tw,jsonDiff:aN,lineDiff:G0,parsePatch:K0,reversePatch:dN,sentenceDiff:oN,structuredPatch:nR,wordDiff:tN,wordsWithSpaceDiff:nN},Symbol.toStringTag,{value:"Module"}));function Un(t){return typeof t!="string"?"":t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Hv(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u,hotInstance:c}=t;c&&typeof c.deselectCell=="function"&&c.deselectCell();const h={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:{...a,popup:`popup-base ${a.popup||""}`.trim()},preConfirm:l,didOpen:u},d=i.find(g=>g.role==="confirm"||!g.role&&i.indexOf(g)===0),f=i.find(g=>g.role==="cancel");return d?(h.confirmButtonText=d.text||ri.getConfirmButton().innerText,d.color&&(h.confirmButtonColor=d.color)):(!l&&i.every(g=>g.role==="cancel")||i.length===0&&!l)&&(h.showConfirmButton=!1),f&&(h.showCancelButton=!0,h.cancelButtonText=f.text||ri.getCancelButton().innerText,f.color&&(h.cancelButtonColor=f.color)),typeof ri>"u"?(console.error("SweetAlert2 (Swal) is not loaded!"),Promise.reject("SweetAlert2 is not imported")):ri.fire(h).then(g=>{const p={...g,formData:g.value&&typeof g.value=="object"?g.value:{}};return g.isConfirmed&&l&&(p.formData=g.value),g.isConfirmed&&d&&typeof d.action=="function"&&!l?d.action(p):g.isDismissed&&f&&typeof f.action=="function"&&g.dismiss===ri.DismissReason.cancel&&f.action(p),p})}function Bj(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[],hotInstance:i,customClass:o={}}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();let s="",a="",l=[],u=0,c=0;const h=(g,p=2)=>{const C=E=>{if(typeof E!="object"||E===null)return E;if(Array.isArray(E))return E.map(C);const y={};return Object.keys(E).forEach(T=>{y[T]=C(E[T])}),y};try{return JSON.stringify(C(g),null,p)}catch{return JSON.stringify(g,null,p)}};if(n&&n.left!==void 0&&n.right!==void 0)if(typeof Vj>"u"||typeof Pf!="function")a='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다.</p>',s='<div class="diff-popup-header diff-error">라이브러리 오류</div>';else try{const g=h(n.left),p=h(n.right),C=Pf(g,p);C.forEach(V=>{const q=V.value||"",Z=q.split(`
`);let ee=Z.length;Z[Z.length-1]===""&&q.length>0&&ee--,q===""&&(ee=0),V.added?u+=ee:V.removed&&(c+=ee)});const E=[];let y=1,T=1;C.forEach((V,q)=>{const Z=V.value||"",ee=Z.split(`
`);let te=ee.length;ee[ee.length-1]===""&&Z.length>0&&te--,Z===""&&(te=0),V.removed?(E.push({originalPartIndex:q,part:V,sourceType:"del",lineNumber:y,numLines:te}),y+=te):V.added?(E.push({originalPartIndex:q,part:V,sourceType:"ins",lineNumber:T,numLines:te}),T+=te):(y+=te,T+=te)}),l=[];let _=[...E];if(_.length>0){_.sort((q,Z)=>q.lineNumber!==Z.lineNumber?q.lineNumber-Z.lineNumber:q.sourceType==="del"&&Z.sourceType!=="del"?-1:q.sourceType!=="del"&&Z.sourceType==="del"?1:q.originalPartIndex-Z.originalPartIndex);let V=_.shift();for(l.push(V);_.length>0&&V;){const q=V.lineNumber;let Z=null;const ee=_.map(te=>({...te,diff:Math.abs(te.lineNumber-q),sortOrder:te.lineNumber>=q?0:1})).sort((te,he)=>te.sortOrder!==he.sortOrder?te.sortOrder-he.sortOrder:te.diff!==he.diff?te.diff-he.diff:te.lineNumber!==he.lineNumber?te.lineNumber-he.lineNumber:te.sourceType==="del"&&he.sourceType!=="del"?-1:te.sourceType!=="del"&&he.sourceType==="del"?1:te.originalPartIndex-he.originalPartIndex);if(ee.length>0&&(Z=ee[0]),Z)l.push(Z),V=Z,_=_.filter(te=>te.originalPartIndex!==Z.originalPartIndex);else break}}let P="",M="",I=1,z=1;const W=new Map;l.forEach((V,q)=>W.set(V.originalPartIndex,q)),C.forEach((V,q)=>{const Z=V.value||"",ee=Z.endsWith(`
`)?Z.slice(0,-1).split(`
`):Z.split(`
`);Z===""&&ee.length===1&&ee[0]===""||ee.forEach((te,he)=>{let Ue="";(V.added||V.removed)&&he===0&&W.has(q)&&(Ue=`id="diff-nav-target-${W.get(q)}"`),V.added?(P+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,M+=`<div ${Ue} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${z++}</span><span class="diff-sbs-line-content">${Un(te)}</span></div>
`):V.removed?(P+=`<div ${Ue} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${I++}</span><span class="diff-sbs-line-content">${Un(te)}</span></div>
`,M+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(P+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${I++}</span><span class="diff-sbs-line-content">${Un(te)}</span></div>
`,M+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${z++}</span><span class="diff-sbs-line-content">${Un(te)}</span></div>
`)})}),a=`<div class="diff-sbs-container"><div class="diff-sbs-pane" id="diff-left-pane">${P}</div><div class="diff-sbs-pane" id="diff-right-pane">${M}</div></div>`,l.length>0||u>0||c>0?s=`<div class="diff-popup-header">JSON 비교 결과</div><div id="diff-navigation" class="diff-navigation-controls">${u>0||c>0?`<span class="diff-summary"><strong class="diff-summary-added">+${u}</strong> <strong class="diff-summary-removed">-${c}</strong></span>`:""}<button id="prev-change-btn" class="swal2-styled">이전 변경점</button><button id="next-change-btn" class="swal2-styled">다음 변경점</button><span id="current-change-info" class="diff-current-change-info"></span></div>`:(s='<div class="diff-popup-header">JSON 비교 결과</div>',a=g===p?'<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':'<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>')}catch(g){a=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${Un(g.message)}</p>`,s='<div class="diff-popup-header diff-error">오류 발생</div>'}else a='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',s='<div class="diff-popup-header diff-error">데이터 오류</div>';const d=`${s}<div id="diff-container" class="diff-main-container">${a}</div>`,f={...o,popup:`popup-diff-view ${o.popup||""}`.trim(),htmlContainer:o.htmlContainer||"custom-swal-html-container-text-diff"};return Hv({title:e,html:d,buttons:r,width:"95%",customClass:f,didOpen:g=>{const p=l.map((z,W)=>document.getElementById(`diff-nav-target-${W}`)).filter(z=>z);let C=-1,E=null;const y=document.getElementById("diff-navigation"),T=document.getElementById("next-change-btn"),_=document.getElementById("prev-change-btn"),P=document.getElementById("current-change-info");function M(){if(!y)return;const z=p.length===0;T&&(T.style.display=z?"none":"inline-block"),_&&(_.style.display=z?"none":"inline-block"),P&&(P.textContent=z?u>0||c>0?"0 / 0":"변경점 없음":`${C+1} / ${p.length}`),T&&(T.disabled=C>=p.length-1),_&&(_.disabled=C<=0)}function I(z){if(z<0||z>=p.length)return;E&&E.classList.remove("diff-navigation-highlight");const W=p[z];if(W){const V=document.getElementById("diff-container");if(V){const q=W.offsetTop;V.scrollTop=q-V.clientHeight/2+W.clientHeight/2}else W.scrollIntoView({block:"center"});W.classList.add("diff-navigation-highlight"),E=W}C=z,M()}p.length>0?I(0):M(),T&&T.addEventListener("click",()=>{C<p.length-1&&I(C+1)}),_&&_.addEventListener("click",()=>{C>0&&I(C-1)}),g.addEventListener("keydown",z=>{p.length===0||!T||!_||(z.key==="ArrowDown"||z.key==="PageDown"?(z.preventDefault(),T.disabled||T.click()):(z.key==="ArrowUp"||z.key==="PageUp")&&(z.preventDefault(),_.disabled||_.click()))}),M()},hotInstance:i})}async function to(t){const{title:e,inputLabel:n,inputValue:r="",inputPlaceholder:i="",inputValidator:o,confirmButtonText:s="확인",cancelButtonText:a="취소",showCancelButton:l=!0,customClass:u={},html:c,hotInstance:h}=t;h&&typeof h.deselectCell=="function"&&h.deselectCell();const d={title:e,input:"text",inputValue:r,inputPlaceholder:i,inputValidator:o,showCancelButton:l,confirmButtonText:s,cancelButtonText:a,customClass:{...u,popup:`swal-text-input-popup ${u.popup||""}`.trim()},didOpen:()=>{const f=ri.getInput();f&&(f.focus(),typeof f.select=="function"&&f.select())}};return c?d.html=c:n&&(d.inputLabel=n),ri.fire(d)}async function Ce(t){const{title:e,text:n="",html:r="",icon:i="warning",confirmButtonText:o="확인",cancelButtonText:s="취소",showCancelButton:a=!0,customClass:l={},hotInstance:u}=t;return u&&typeof u.deselectCell=="function"&&u.deselectCell(),ri.fire({title:e,text:n,html:r,icon:i,showCancelButton:a,confirmButtonText:o,cancelButtonText:s,customClass:{...l,popup:`swal-confirmation-popup ${l.popup||""}`.trim()}})}async function Vx(t){const{title:e="URL 작업",initialInputValue:n="",inputLabel:r="입력:",outputLabel:i="결과:",actionButtonText:o="실행",confirmButtonText:s="결과를 메인 편집기에 복사",cancelButtonText:a="팝업 닫기",onExecuteAction:l,hotInstance:u,customClass:c={}}=t;u&&typeof u.deselectCell=="function"&&u.deselectCell();const h=Date.now(),d=`popup-url-input-${h}`,f=`popup-url-output-${h}`,g=`popup-execute-action-${h}`,p=`popup-url-validation-${h}`,C=`
        <div class="popup-url-process-container">
            <div class="popup-form-group">
                <label for="${d}" class="popup-label">${Un(r)}</label>
                <textarea id="${d}" class="swal2-textarea popup-textarea" placeholder="여기에 문자열을 입력하세요...">${Un(n)}</textarea>
            </div>
            <div class="popup-action-button-container">
                <button type="button" id="${g}" class="swal2-styled popup-execute-button">${Un(o)}</button>
            </div>
            <div class="popup-form-group">
                <label for="${f}" class="popup-label">${Un(i)}</label>
                <textarea id="${f}" class="swal2-textarea popup-textarea" readonly placeholder="결과가 여기에 표시됩니다..."></textarea>
            </div>
            <div id="${p}" class="popup-validation-message"></div>
        </div>`,E={...c,popup:`popup-url-process popup-basic-white-theme ${c.popup||""}`.trim(),htmlContainer:c.htmlContainer||"popup-html-container-spacing"};return Hv({title:e,html:C,hotInstance:u,width:"50em",padding:"1.5em",customClass:E,buttons:[{text:s,role:"confirm"},{text:a,role:"cancel"}],didOpen:y=>{const T=y.querySelector(`#${d}`),_=y.querySelector(`#${f}`),P=y.querySelector(`#${g}`),M=y.querySelector(`#${p}`);T&&T.focus(),P&&T&&_&&M&&P.addEventListener("click",()=>{const I=T.value;if(M.textContent="",I.trim()===""){_.value="",M.textContent="입력값이 비어있습니다.";return}if(typeof l=="function")try{const z=l(I);_.value=z,typeof z=="string"&&z.startsWith("오류:")&&(M.textContent=z)}catch(z){const W=`실행 중 예외: ${z.message}`;_.value=W,M.textContent=W}else{const z="오류: 실행할 작업(onExecuteAction)이 정의되지 않았습니다.";_.value=z,M.textContent=z}})},preConfirm:()=>{const y=document.getElementById(f),T=document.getElementById(p);return T&&(T.textContent=""),y&&y.value.trim()!==""?y.value.startsWith("오류:")||y.value.startsWith("실행 중 예외:")?(T&&(T.textContent="오류가 있는 결과는 복사할 수 없습니다."),!1):y.value:(T&&(T.textContent="메인 편집기에 복사할 결과가 없습니다."),!1)}})}async function gN(t){const{title:e="템플릿 선택",templates:n=[],message:r="",confirmButtonText:i="확인",cancelButtonText:o="취소",hotInstance:s,existingUserTemplateNames:a=[],customClass:l={}}=t;if(s&&typeof s.deselectCell=="function"&&s.deselectCell(),n.length===0)return await Ce({title:e,text:"선택할 템플릿이 없습니다.",icon:"info",showCancelButton:!1,confirmButtonText:"닫기",hotInstance:s}),{isConfirmed:!1,selectedTemplates:[]};const u=n.map((f,g)=>{const C=!f.isDefault&&a.includes(f.name)?' <span class="popup-template-overwrite-indicator">(덮어씀)</span>':"";return{id:`template_checkbox_${g}_${Date.now()}`,label:`${Un(f.name)} <span class="popup-template-type-indicator">(${Un(f.type)})</span>${f.isDefault?' <span class="popup-template-default-indicator">[기본]</span>':""}${C}`,initialChecked:!0,originalTemplate:f}});let c='<form id="popup-template-selection-form" class="popup-template-selection-container">';r&&(c+=`<p class="popup-message">${Un(r)}</p>`),u.forEach(f=>{c+=`<div class="popup-template-item">
                        <input type="checkbox" id="${f.id}" name="${f.id}" value="true" ${f.initialChecked?"checked":""} class="popup-checkbox">
                        <label for="${f.id}" class="popup-label-checkbox">${f.label}</label>
                     </div>`}),c+="</form>";const h={...l,popup:`popup-template-selection popup-basic-white-theme ${l.popup||""}`.trim()},d=await Hv({title:e,html:c,hotInstance:s,buttons:[{text:i,role:"confirm"},{text:o,role:"cancel"}],width:"45em",padding:"1.5em",customClass:h,preConfirm:()=>{const f=document.getElementById("popup-template-selection-form");return f?u.filter(g=>{var p;return(p=f.querySelector(`#${g.id}`))==null?void 0:p.checked}).map(g=>g.originalTemplate):[]}});return{isConfirmed:d.isConfirmed,selectedTemplates:d.isConfirmed&&Array.isArray(d.formData)?d.formData:[]}}async function Wj(t){const{templateName:e,templateValue:n,hotInstance:r,customClass:i={}}=t;r&&typeof r.deselectCell=="function"&&r.deselectCell();let o;try{const a=JSON.stringify(n,null,2);o=`<pre class="popup-template-content-pre">${Un(a)}</pre>`}catch(a){o=`<p class="popup-error-message">템플릿 내용을 표시 중 오류: ${Un(a.message)}</p>`}const s={...i,popup:`popup-template-content popup-basic-white-theme ${i.popup||""}`.trim(),htmlContainer:i.htmlContainer||"popup-html-container-spacing"};return Ce({title:`${Un(e)} - 내용`,html:o,icon:null,showCancelButton:!1,confirmButtonText:"닫기",customClass:s,hotInstance:r})}async function jj(t){const{title:e="템플릿 관리",userTemplates:n=[],callbacks:r={},hotInstance:i,customClass:o={}}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();const s=l=>{if(l.length===0)return'<p class="popup-empty-message">관리할 사용자 정의 템플릿이 없습니다.</p>';let u='<div class="popup-template-management-list-container"><ul class="popup-list">';return l.forEach(c=>{const h=Un(c.name),d=Un(c.type);u+=`
                <li class="popup-list-item tm-list-item-hoverable">
                    <span class="popup-list-item-name" title="${h} (${d})">
                        ${h} <span class="popup-list-item-type">(${d})</span>
                    </span>
                    <span class="popup-list-item-actions">
                        <button type="button" class="swal2-styled swal2-styled-small tm-view-btn" data-template-name="${h}" title="내용 보기">내용 확인</button>
                        <button type="button" class="swal2-styled swal2-styled-small tm-rename-btn" data-template-name="${h}" title="이름 변경">이름 변경</button>
                        <button type="button" class="swal2-styled swal2-styled-small tm-delete-btn" data-template-name="${h}" title="삭제">삭제</button>
                    </span>
                </li>`}),u+="</ul></div>",u},a={...o,popup:`popup-template-management popup-basic-white-theme ${o.popup||""}`.trim(),htmlContainer:o.htmlContainer||"popup-html-container-spacing"};return Hv({title:e,html:s(n),hotInstance:i,width:"60em",padding:"1.5em",customClass:a,buttons:[{text:"닫기",role:"cancel"}],didOpen:l=>{l.addEventListener("click",u=>{const c=u.target.closest("button[data-template-name]");if(!c)return;const h=c.dataset.templateName;h&&(c.classList.contains("tm-view-btn")&&r.onViewRequest?r.onViewRequest(h):c.classList.contains("tm-rename-btn")&&r.onRenameRequest?r.onRenameRequest(h):c.classList.contains("tm-delete-btn")&&r.onDeleteRequest&&r.onDeleteRequest(h))})}})}const gt=document.getElementById("json-input"),je=document.getElementById("save-message"),Ye=document.getElementById("json-error"),Pt=document.getElementById("tree-view"),rR=document.getElementById("table-view");function Ot(t,e,n){t&&(t.textContent=e,setTimeout(()=>{t.textContent=""},n))}function zc(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent&&a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(i.appendChild(document.createTextNode(o)),e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.style.color="var(--table-cell-text)",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));if(t&&t!==""){let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u;for(;(u=l.exec(t))!==null;){const c=u[0];let h=c;if(a===""?a=c:c.startsWith("[")?a+=c:a+="."+c,i.appendChild(document.createTextNode(" > ")),e){const d=document.createElement("a");d.href="#",d.textContent=h,d.style.textDecoration="underline",d.style.cursor="pointer",d.style.color="var(--table-cell-text)",d.onclick=(f=>g=>{g.preventDefault(),e(f)})(a),i.appendChild(d)}else i.appendChild(document.createTextNode(h))}}i.appendChild(document.createTextNode(s))}function Uj(){Pt&&(Pt.innerHTML=""),rR&&(rR.innerHTML=""),Ye&&(Ye.textContent=""),je&&(je.textContent=""),zc(null,null)}function mu(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function iR(t,e){if(typeof t=="string"){const n=t.trim();if(n.toLowerCase()==="null")return null;if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1;if(n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,"")))return Number(n);if(n.startsWith("[")&&n.endsWith("]")||n.startsWith("{")&&n.endsWith("}"))try{return JSON.parse(n)}catch{return t}return t}return t}function mN(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let Ql=null;function oh(t){Ql&&Ql.classList.remove("selected-node"),Ql=t,Ql&&Ql.classList.add("selected-node")}function zj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),oh(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),mN(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),oh(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function Yj(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),Of(e,o,n,r.rootJsonData,r.depth+1,r),o}function Of(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=zj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=Yj(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function Gj(){return Ql?Ql.dataset.path:null}function Kj(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function qj(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var Yg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Lh=function(t){return t&&t.Math===Math&&t},Tn=Lh(typeof globalThis=="object"&&globalThis)||Lh(typeof window=="object"&&window)||Lh(typeof self=="object"&&self)||Lh(typeof Yg=="object"&&Yg)||Lh(typeof Yg=="object"&&Yg)||function(){return this}()||Function("return this")(),q0={},Vn=function(t){try{return!!t()}catch{return!0}},Xj=Vn,Oi=!Xj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Jj=Vn,Nv=!Jj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Zj=Nv,Gg=Function.prototype.call,Mn=Zj?Gg.bind(Gg):function(){return Gg.apply(Gg,arguments)},pN={},wN={}.propertyIsEnumerable,vN=Object.getOwnPropertyDescriptor,Qj=vN&&!wN.call({1:2},1);pN.f=Qj?function(e){var n=vN(this,e);return!!n&&n.enumerable}:wN;var Dv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},yN=Nv,CN=Function.prototype,oR=CN.call,eU=yN&&CN.bind.bind(oR,oR),vn=yN?eU:function(t){return function(){return oR.apply(t,arguments)}},bN=vn,tU=bN({}.toString),nU=bN("".slice),_u=function(t){return nU(tU(t),8,-1)},rU=vn,iU=Vn,oU=_u,jy=Object,sU=rU("".split),aU=iU(function(){return!jy("z").propertyIsEnumerable(0)})?function(t){return oU(t)==="String"?sU(t,""):jy(t)}:jy,X0=function(t){return t==null},lU=X0,uU=TypeError,ug=function(t){if(lU(t))throw new uU("Can't call method on "+t);return t},cU=aU,hU=ug,cg=function(t){return cU(hU(t))},Uy=typeof document=="object"&&document.all,_n=typeof Uy>"u"&&Uy!==void 0?function(t){return typeof t=="function"||t===Uy}:function(t){return typeof t=="function"},dU=_n,Ai=function(t){return typeof t=="object"?t!==null:dU(t)},zy=Tn,fU=_n,gU=function(t){return fU(t)?t:void 0},vh=function(t,e){return arguments.length<2?gU(zy[t]):zy[t]&&zy[t][e]},mU=vn,hg=mU({}.isPrototypeOf),pU=Tn,Bx=pU.navigator,Wx=Bx&&Bx.userAgent,kv=Wx?String(Wx):"",SN=Tn,Yy=kv,jx=SN.process,Ux=SN.Deno,zx=jx&&jx.versions||Ux&&Ux.version,Yx=zx&&zx.v8,oo,Mw;Yx&&(oo=Yx.split("."),Mw=oo[0]>0&&oo[0]<4?1:+(oo[0]+oo[1]));!Mw&&Yy&&(oo=Yy.match(/Edge\/(\d+)/),(!oo||oo[1]>=74)&&(oo=Yy.match(/Chrome\/(\d+)/),oo&&(Mw=+oo[1])));var wU=Mw,Gx=wU,vU=Vn,yU=Tn,CU=yU.String,J0=!!Object.getOwnPropertySymbols&&!vU(function(){var t=Symbol("symbol detection");return!CU(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Gx&&Gx<41}),bU=J0,RN=bU&&!Symbol.sham&&typeof Symbol.iterator=="symbol",SU=vh,RU=_n,EU=hg,TU=RN,MU=Object,Z0=TU?function(t){return typeof t=="symbol"}:function(t){var e=SU("Symbol");return RU(e)&&EU(e.prototype,MU(t))},_U=String,$v=function(t){try{return _U(t)}catch{return"Object"}},xU=_n,IU=$v,PU=TypeError,jr=function(t){if(xU(t))return t;throw new PU(IU(t)+" is not a function")},OU=jr,AU=X0,dg=function(t,e){var n=t[e];return AU(n)?void 0:OU(n)},Gy=Mn,Ky=_n,qy=Ai,HU=TypeError,NU=function(t,e){var n,r;if(e==="string"&&Ky(n=t.toString)&&!qy(r=Gy(n,t))||Ky(n=t.valueOf)&&!qy(r=Gy(n,t))||e!=="string"&&Ky(n=t.toString)&&!qy(r=Gy(n,t)))return r;throw new HU("Can't convert object to primitive value")},EN={exports:{}},Kx=Tn,DU=Object.defineProperty,Q0=function(t,e){try{DU(Kx,t,{value:e,configurable:!0,writable:!0})}catch{Kx[t]=e}return e},kU=Tn,$U=Q0,qx="__core-js_shared__",Xx=EN.exports=kU[qx]||$U(qx,{});(Xx.versions||(Xx.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var eE=EN.exports,Jx=eE,TN=function(t,e){return Jx[t]||(Jx[t]=e||{})},LU=ug,FU=Object,yh=function(t){return FU(LU(t))},VU=vn,BU=yh,WU=VU({}.hasOwnProperty),Hi=Object.hasOwn||function(e,n){return WU(BU(e),n)},jU=vn,UU=0,zU=Math.random(),YU=jU(1 .toString),MN=function(t){return"Symbol("+(t===void 0?"":t)+")_"+YU(++UU+zU,36)},GU=Tn,KU=TN,Zx=Hi,qU=MN,XU=J0,JU=RN,kc=GU.Symbol,Xy=KU("wks"),ZU=JU?kc.for||kc:kc&&kc.withoutSetter||qU,go=function(t){return Zx(Xy,t)||(Xy[t]=XU&&Zx(kc,t)?kc[t]:ZU("Symbol."+t)),Xy[t]},QU=Mn,Qx=Ai,eI=Z0,ez=dg,tz=NU,nz=go,rz=TypeError,iz=nz("toPrimitive"),oz=function(t,e){if(!Qx(t)||eI(t))return t;var n=ez(t,iz),r;if(n){if(e===void 0&&(e="default"),r=QU(n,t,e),!Qx(r)||eI(r))return r;throw new rz("Can't convert object to primitive value")}return e===void 0&&(e="number"),tz(t,e)},sz=oz,az=Z0,_N=function(t){var e=sz(t,"string");return az(e)?e:e+""},lz=Tn,tI=Ai,sR=lz.document,uz=tI(sR)&&tI(sR.createElement),tE=function(t){return uz?sR.createElement(t):{}},cz=Oi,hz=Vn,dz=tE,xN=!cz&&!hz(function(){return Object.defineProperty(dz("div"),"a",{get:function(){return 7}}).a!==7}),fz=Oi,gz=Mn,mz=pN,pz=Dv,wz=cg,vz=_N,yz=Hi,Cz=xN,nI=Object.getOwnPropertyDescriptor;q0.f=fz?nI:function(e,n){if(e=wz(e),n=vz(n),Cz)try{return nI(e,n)}catch{}if(yz(e,n))return pz(!gz(mz.f,e,n),e[n])};var ta={},bz=Oi,Sz=Vn,IN=bz&&Sz(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Rz=Ai,Ez=String,Tz=TypeError,xn=function(t){if(Rz(t))return t;throw new Tz(Ez(t)+" is not an object")},Mz=Oi,_z=xN,xz=IN,Kg=xn,rI=_N,Iz=TypeError,Jy=Object.defineProperty,Pz=Object.getOwnPropertyDescriptor,Zy="enumerable",Qy="configurable",eC="writable";ta.f=Mz?xz?function(e,n,r){if(Kg(e),n=rI(n),Kg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&eC in r&&!r[eC]){var i=Pz(e,n);i&&i[eC]&&(e[n]=r.value,r={configurable:Qy in r?r[Qy]:i[Qy],enumerable:Zy in r?r[Zy]:i[Zy],writable:!1})}return Jy(e,n,r)}:Jy:function(e,n,r){if(Kg(e),n=rI(n),Kg(r),_z)try{return Jy(e,n,r)}catch{}if("get"in r||"set"in r)throw new Iz("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var Oz=Oi,Az=ta,Hz=Dv,Ch=Oz?function(t,e,n){return Az.f(t,e,Hz(1,n))}:function(t,e,n){return t[e]=n,t},PN={exports:{}},aR=Oi,Nz=Hi,ON=Function.prototype,Dz=aR&&Object.getOwnPropertyDescriptor,kz=Nz(ON,"name"),$z=kz&&(!aR||aR&&Dz(ON,"name").configurable),Lz={CONFIGURABLE:$z},Fz=vn,Vz=_n,lR=eE,Bz=Fz(Function.toString);Vz(lR.inspectSource)||(lR.inspectSource=function(t){return Bz(t)});var Wz=lR.inspectSource,jz=Tn,Uz=_n,iI=jz.WeakMap,zz=Uz(iI)&&/native code/.test(String(iI)),Yz=TN,Gz=MN,oI=Yz("keys"),nE=function(t){return oI[t]||(oI[t]=Gz(t))},rE={},Kz=zz,AN=Tn,qz=Ai,Xz=Ch,tC=Hi,nC=eE,Jz=nE,Zz=rE,sI="Object already initialized",uR=AN.TypeError,Qz=AN.WeakMap,_w,Af,xw,eY=function(t){return xw(t)?Af(t):_w(t,{})},tY=function(t){return function(e){var n;if(!qz(e)||(n=Af(e)).type!==t)throw new uR("Incompatible receiver, "+t+" required");return n}};if(Kz||nC.state){var yo=nC.state||(nC.state=new Qz);yo.get=yo.get,yo.has=yo.has,yo.set=yo.set,_w=function(t,e){if(yo.has(t))throw new uR(sI);return e.facade=t,yo.set(t,e),e},Af=function(t){return yo.get(t)||{}},xw=function(t){return yo.has(t)}}else{var Bu=Jz("state");Zz[Bu]=!0,_w=function(t,e){if(tC(t,Bu))throw new uR(sI);return e.facade=t,Xz(t,Bu,e),e},Af=function(t){return tC(t,Bu)?t[Bu]:{}},xw=function(t){return tC(t,Bu)}}var HN={set:_w,get:Af,has:xw,enforce:eY,getterFor:tY},iE=vn,nY=Vn,rY=_n,qg=Hi,cR=Oi,iY=Lz.CONFIGURABLE,oY=Wz,NN=HN,sY=NN.enforce,aY=NN.get,aI=String,Lp=Object.defineProperty,lY=iE("".slice),uY=iE("".replace),cY=iE([].join),hY=cR&&!nY(function(){return Lp(function(){},"length",{value:8}).length!==8}),dY=String(String).split("String"),fY=PN.exports=function(t,e,n){lY(aI(e),0,7)==="Symbol("&&(e="["+uY(aI(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!qg(t,"name")||iY&&t.name!==e)&&(cR?Lp(t,"name",{value:e,configurable:!0}):t.name=e),hY&&n&&qg(n,"arity")&&t.length!==n.arity&&Lp(t,"length",{value:n.arity});try{n&&qg(n,"constructor")&&n.constructor?cR&&Lp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=sY(t);return qg(r,"source")||(r.source=cY(dY,typeof e=="string"?e:"")),t};Function.prototype.toString=fY(function(){return rY(this)&&aY(this).source||oY(this)},"toString");var DN=PN.exports,gY=_n,mY=ta,pY=DN,wY=Q0,oE=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(gY(n)&&pY(n,o,r),r.global)i?t[e]=n:wY(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:mY.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},kN={},vY=Math.ceil,yY=Math.floor,CY=Math.trunc||function(e){var n=+e;return(n>0?yY:vY)(n)},bY=CY,fg=function(t){var e=+t;return e!==e||e===0?0:bY(e)},SY=fg,RY=Math.max,EY=Math.min,TY=function(t,e){var n=SY(t);return n<0?RY(n+e,0):EY(n,e)},MY=fg,_Y=Math.min,xY=function(t){var e=MY(t);return e>0?_Y(e,9007199254740991):0},IY=xY,bh=function(t){return IY(t.length)},PY=cg,OY=TY,AY=bh,HY=function(t){return function(e,n,r){var i=PY(e),o=AY(i);if(o===0)return!t&&-1;var s=OY(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},NY={indexOf:HY(!1)},DY=vn,rC=Hi,kY=cg,$Y=NY.indexOf,LY=rE,lI=DY([].push),$N=function(t,e){var n=kY(t),r=0,i=[],o;for(o in n)!rC(LY,o)&&rC(n,o)&&lI(i,o);for(;e.length>r;)rC(n,o=e[r++])&&(~$Y(i,o)||lI(i,o));return i},sE=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],FY=$N,VY=sE,BY=VY.concat("length","prototype");kN.f=Object.getOwnPropertyNames||function(e){return FY(e,BY)};var LN={};LN.f=Object.getOwnPropertySymbols;var WY=vh,jY=vn,UY=kN,zY=LN,YY=xn,GY=jY([].concat),KY=WY("Reflect","ownKeys")||function(e){var n=UY.f(YY(e)),r=zY.f;return r?GY(n,r(e)):n},uI=Hi,qY=KY,XY=q0,JY=ta,FN=function(t,e,n){for(var r=qY(e),i=JY.f,o=XY.f,s=0;s<r.length;s++){var a=r[s];!uI(t,a)&&!(n&&uI(n,a))&&i(t,a,o(e,a))}},ZY=Vn,QY=_n,eG=/#|\.prototype\./,gg=function(t,e){var n=nG[tG(t)];return n===iG?!0:n===rG?!1:QY(e)?ZY(e):!!e},tG=gg.normalize=function(t){return String(t).replace(eG,".").toLowerCase()},nG=gg.data={},rG=gg.NATIVE="N",iG=gg.POLYFILL="P",oG=gg,Xg=Tn,sG=q0.f,aG=Ch,lG=oE,uG=Q0,cG=FN,hG=oG,Mt=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Xg:i?s=Xg[n]||uG(n,{}):s=Xg[n]&&Xg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=sG(s,a),l=c&&c.value):l=s[a],o=hG(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;cG(u,l)}(t.sham||l&&l.sham)&&aG(u,"sham",!0),lG(s,a,u,t)}},dG=Nv,VN=Function.prototype,cI=VN.apply,hI=VN.call,mg=typeof Reflect=="object"&&Reflect.apply||(dG?hI.bind(cI):function(){return hI.apply(cI,arguments)}),fG=vn,gG=jr,BN=function(t,e,n){try{return fG(gG(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},mG=Ai,pG=function(t){return mG(t)||t===null},wG=pG,vG=String,yG=TypeError,CG=function(t){if(wG(t))return t;throw new yG("Can't set "+vG(t)+" as a prototype")},bG=BN,SG=Ai,RG=ug,EG=CG,WN=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=bG(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return RG(i),EG(o),SG(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),TG=ta.f,MG=function(t,e,n){n in t||TG(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},_G=_n,xG=Ai,dI=WN,IG=function(t,e,n){var r,i;return dI&&_G(r=e.constructor)&&r!==n&&xG(i=r.prototype)&&i!==n.prototype&&dI(t,i),t},PG=go,OG=PG("toStringTag"),jN={};jN[OG]="z";var AG=String(jN)==="[object z]",HG=AG,NG=_n,Fp=_u,DG=go,kG=DG("toStringTag"),$G=Object,LG=Fp(function(){return arguments}())==="Arguments",FG=function(t,e){try{return t[e]}catch{}},UN=HG?Fp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=FG(e=$G(t),kG))=="string"?n:LG?Fp(e):(r=Fp(e))==="Object"&&NG(e.callee)?"Arguments":r},VG=UN,BG=String,Lv=function(t){if(VG(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return BG(t)},WG=Lv,jG=function(t,e){return t===void 0?arguments.length<2?"":e:WG(t)},UG=Ai,zG=Ch,YG=function(t,e){UG(e)&&"cause"in e&&zG(t,"cause",e.cause)},GG=vn,zN=Error,KG=GG("".replace),qG=function(t){return String(new zN(t).stack)}("zxcasd"),YN=/\n\s*at [^:]*:[^\n]*/,XG=YN.test(qG),JG=function(t,e){if(XG&&typeof t=="string"&&!zN.prepareStackTrace)for(;e--;)t=KG(t,YN,"");return t},ZG=Vn,QG=Dv,eK=!ZG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",QG(1,7)),t.stack!==7):!0}),tK=Ch,nK=JG,rK=eK,fI=Error.captureStackTrace,iK=function(t,e,n,r){rK&&(fI?fI(t,e):tK(t,"stack",nK(n,r)))},gI=vh,oK=Hi,mI=Ch,sK=hg,pI=WN,wI=FN,vI=MG,aK=IG,lK=jG,uK=YG,cK=iK,hK=Oi,dK=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=gI.apply(null,s);if(l){var u=l.prototype;if(oK(u,"cause")&&delete u.cause,!n)return l;var c=gI("Error"),h=e(function(d,f){var g=lK(r?f:d,void 0),p=r?new l(d):new l;return g!==void 0&&mI(p,"message",g),cK(p,h,p.stack,2),this&&sK(u,this)&&aK(p,this,h),arguments.length>o&&uK(p,arguments[o]),p});h.prototype=u,a!=="Error"?pI?pI(h,c):wI(h,c,{name:!0}):hK&&i in l&&(vI(h,l,i),vI(h,l,"prepareStackTrace")),wI(h,l);try{u.name!==a&&mI(u,"name",a),u.constructor=h}catch{}return h}},GN=Mt,fK=Tn,is=mg,KN=dK,hR="WebAssembly",yI=fK[hR],Iw=new Error("e",{cause:7}).cause!==7,xu=function(t,e){var n={};n[t]=KN(t,e,Iw),GN({global:!0,constructor:!0,arity:1,forced:Iw},n)},aE=function(t,e){if(yI&&yI[t]){var n={};n[t]=KN(hR+"."+t,e,Iw),GN({target:hR,stat:!0,constructor:!0,arity:1,forced:Iw},n)}};xu("Error",function(t){return function(n){return is(t,this,arguments)}});xu("EvalError",function(t){return function(n){return is(t,this,arguments)}});xu("RangeError",function(t){return function(n){return is(t,this,arguments)}});xu("ReferenceError",function(t){return function(n){return is(t,this,arguments)}});xu("SyntaxError",function(t){return function(n){return is(t,this,arguments)}});xu("TypeError",function(t){return function(n){return is(t,this,arguments)}});xu("URIError",function(t){return function(n){return is(t,this,arguments)}});aE("CompileError",function(t){return function(n){return is(t,this,arguments)}});aE("LinkError",function(t){return function(n){return is(t,this,arguments)}});aE("RuntimeError",function(t){return function(n){return is(t,this,arguments)}});var gK=_u,qN=Array.isArray||function(e){return gK(e)==="Array"},mK=Oi,pK=qN,wK=TypeError,vK=Object.getOwnPropertyDescriptor,yK=mK&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),XN=yK?function(t,e){if(pK(t)&&!vK(t,"length").writable)throw new wK("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},CK=TypeError,bK=9007199254740991,JN=function(t){if(t>bK)throw CK("Maximum allowed index exceeded");return t},SK=Mt,RK=yh,EK=bh,TK=XN,MK=JN,_K=Vn,xK=_K(function(){return[].push.call({length:4294967296},1)!==4294967297}),IK=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},PK=xK||!IK();SK({target:"Array",proto:!0,arity:1,forced:PK},{push:function(e){var n=RK(this),r=EK(n),i=arguments.length;MK(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return TK(n,r),r}});var OK=_u,AK=vn,HK=function(t){if(OK(t)==="Function")return AK(t)},CI=HK,NK=jr,DK=Nv,kK=CI(CI.bind),ZN=function(t,e){return NK(t),e===void 0?t:DK?kK(t,e):function(){return t.apply(e,arguments)}},QN={},$K=go,LK=QN,FK=$K("iterator"),VK=Array.prototype,BK=function(t){return t!==void 0&&(LK.Array===t||VK[FK]===t)},WK=UN,bI=dg,jK=X0,UK=QN,zK=go,YK=zK("iterator"),lE=function(t){if(!jK(t))return bI(t,YK)||bI(t,"@@iterator")||UK[WK(t)]},GK=Mn,KK=jr,qK=xn,XK=$v,JK=lE,ZK=TypeError,QK=function(t,e){var n=arguments.length<2?JK(t):e;if(KK(n))return qK(GK(n,t));throw new ZK(XK(t)+" is not iterable")},e3=Mn,SI=xn,t3=dg,li=function(t,e,n){var r,i;SI(t);try{if(r=t3(t,"return"),!r){if(e==="throw")throw n;return n}r=e3(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return SI(r),n},n3=ZN,r3=Mn,i3=xn,o3=$v,s3=BK,a3=bh,RI=hg,l3=QK,u3=lE,EI=li,c3=TypeError,Vp=function(t,e){this.stopped=t,this.result=e},TI=Vp.prototype,Sh=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=n3(e,r),u,c,h,d,f,g,p,C=function(y){return u&&EI(u,"normal",y),new Vp(!0,y)},E=function(y){return i?(i3(y),a?l(y[0],y[1],C):l(y[0],y[1])):a?l(y,C):l(y)};if(o)u=t.iterator;else if(s)u=t;else{if(c=u3(t),!c)throw new c3(o3(t)+" is not iterable");if(s3(c)){for(h=0,d=a3(t);d>h;h++)if(f=E(t[h]),f&&RI(TI,f))return f;return new Vp(!1)}u=l3(t,c)}for(g=o?t.next:u.next;!(p=r3(g,u)).done;){try{f=E(p.value)}catch(y){EI(u,"throw",y)}if(typeof f=="object"&&f&&RI(TI,f))return f}return new Vp(!1)},h3=Oi,d3=ta,f3=Dv,eD=function(t,e,n){h3?d3.f(t,e,f3(0,n)):t[e]=n},g3=Mt,m3=Sh,p3=eD;g3({target:"Object",stat:!0},{fromEntries:function(e){var n={};return m3(e,function(r,i){p3(n,r,i)},{AS_ENTRIES:!0}),n}});var iC=vn,Jg=Set.prototype,os={Set,add:iC(Jg.add),has:iC(Jg.has),remove:iC(Jg.delete),proto:Jg},w3=os.has,Iu=function(t){return w3(t),t},v3=Mn,Pu=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=v3(i,r)).done;)if(s=e(o.value),s!==void 0)return s},tD=vn,y3=Pu,nD=os,C3=nD.Set,rD=nD.proto,b3=tD(rD.forEach),iD=tD(rD.keys),S3=iD(new C3).next,pg=function(t,e,n){return n?y3({iterator:iD(t),next:S3},e):b3(t,e)},oD=os,R3=pg,E3=oD.Set,T3=oD.add,uE=function(t){var e=new E3;return R3(t,function(n){T3(e,n)}),e},M3=BN,_3=os,wg=M3(_3.proto,"size","get")||function(t){return t.size},ss=function(t){return{iterator:t,next:t.next,done:!1}},MI=jr,sD=xn,_I=Mn,x3=fg,I3=ss,xI="Invalid size",P3=RangeError,O3=TypeError,A3=Math.max,aD=function(t,e){this.set=t,this.size=A3(e,0),this.has=MI(t.has),this.keys=MI(t.keys)};aD.prototype={getIterator:function(){return I3(sD(_I(this.keys,this.set)))},includes:function(t){return _I(this.has,this.set,t)}};var Ou=function(t){sD(t);var e=+t.size;if(e!==e)throw new O3(xI);var n=x3(e);if(n<0)throw new P3(xI);return new aD(t,n)},H3=Iu,lD=os,N3=uE,D3=wg,k3=Ou,$3=pg,L3=Pu,F3=lD.has,II=lD.remove,V3=function(e){var n=H3(this),r=k3(e),i=N3(n);return D3(n)<=r.size?$3(n,function(o){r.includes(o)&&II(i,o)}):L3(r.getIterator(),function(o){F3(n,o)&&II(i,o)}),i},B3=vh,PI=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},OI=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},Au=function(t,e){var n=B3("Set");try{new n()[t](PI(0));try{return new n()[t](PI(-1)),!1}catch{if(!e)return!0;try{return new n()[t](OI(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](OI(1/0)))}}}catch{return!1}},W3=Mt,j3=V3,U3=Au,z3=!U3("difference",function(t){return t.size===0});W3({target:"Set",proto:!0,real:!0,forced:z3},{difference:j3});var Y3=Iu,cE=os,G3=wg,K3=Ou,q3=pg,X3=Pu,J3=cE.Set,AI=cE.add,Z3=cE.has,Q3=function(e){var n=Y3(this),r=K3(e),i=new J3;return G3(n)>r.size?X3(r.getIterator(),function(o){Z3(n,o)&&AI(i,o)}):q3(n,function(o){r.includes(o)&&AI(i,o)}),i},e5=Mt,t5=Vn,n5=Q3,r5=Au,i5=!r5("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||t5(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});e5({target:"Set",proto:!0,real:!0,forced:i5},{intersection:n5});var o5=Iu,s5=os.has,a5=wg,l5=Ou,u5=pg,c5=Pu,h5=li,d5=function(e){var n=o5(this),r=l5(e);if(a5(n)<=r.size)return u5(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return c5(i,function(o){if(s5(n,o))return h5(i,"normal",!1)})!==!1},f5=Mt,g5=d5,m5=Au,p5=!m5("isDisjointFrom",function(t){return!t});f5({target:"Set",proto:!0,real:!0,forced:p5},{isDisjointFrom:g5});var w5=Iu,v5=wg,y5=pg,C5=Ou,b5=function(e){var n=w5(this),r=C5(e);return v5(n)>r.size?!1:y5(n,function(i){if(!r.includes(i))return!1},!0)!==!1},S5=Mt,R5=b5,E5=Au,T5=!E5("isSubsetOf",function(t){return t});S5({target:"Set",proto:!0,real:!0,forced:T5},{isSubsetOf:R5});var M5=Iu,_5=os.has,x5=wg,I5=Ou,P5=Pu,O5=li,A5=function(e){var n=M5(this),r=I5(e);if(x5(n)<r.size)return!1;var i=r.getIterator();return P5(i,function(o){if(!_5(n,o))return O5(i,"normal",!1)})!==!1},H5=Mt,N5=A5,D5=Au,k5=!D5("isSupersetOf",function(t){return!t});H5({target:"Set",proto:!0,real:!0,forced:k5},{isSupersetOf:N5});var $5=Iu,hE=os,L5=uE,F5=Ou,V5=Pu,B5=hE.add,W5=hE.has,j5=hE.remove,U5=function(e){var n=$5(this),r=F5(e).getIterator(),i=L5(n);return V5(r,function(o){W5(n,o)?j5(i,o):B5(i,o)}),i},z5=Mt,Y5=U5,G5=Au;z5({target:"Set",proto:!0,real:!0,forced:!G5("symmetricDifference")},{symmetricDifference:Y5});var K5=Iu,q5=os.add,X5=uE,J5=Ou,Z5=Pu,Q5=function(e){var n=K5(this),r=J5(e).getIterator(),i=X5(n);return Z5(r,function(o){q5(i,o)}),i},eq=Mt,tq=Q5,nq=Au;eq({target:"Set",proto:!0,real:!0,forced:!nq("union")},{union:tq});var rq=hg,iq=TypeError,oq=function(t,e){if(rq(e,t))return t;throw new iq("Incorrect invocation")},sq=Vn,aq=!sq(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),lq=Hi,uq=_n,cq=yh,hq=nE,dq=aq,HI=hq("IE_PROTO"),dR=Object,fq=dR.prototype,uD=dq?dR.getPrototypeOf:function(t){var e=cq(t);if(lq(e,HI))return e[HI];var n=e.constructor;return uq(n)&&e instanceof n?n.prototype:e instanceof dR?fq:null},NI=DN,gq=ta,mq=function(t,e,n){return n.get&&NI(n.get,e,{getter:!0}),n.set&&NI(n.set,e,{setter:!0}),gq.f(t,e,n)},cD={},pq=$N,wq=sE,vq=Object.keys||function(e){return pq(e,wq)},yq=Oi,Cq=IN,bq=ta,Sq=xn,Rq=cg,Eq=vq;cD.f=yq&&!Cq?Object.defineProperties:function(e,n){Sq(e);for(var r=Rq(n),i=Eq(n),o=i.length,s=0,a;o>s;)bq.f(e,a=i[s++],r[a]);return e};var Tq=vh,hD=Tq("document","documentElement"),Mq=xn,_q=cD,DI=sE,xq=rE,Iq=hD,Pq=tE,Oq=nE,kI=">",$I="<",fR="prototype",gR="script",dD=Oq("IE_PROTO"),oC=function(){},fD=function(t){return $I+gR+kI+t+$I+"/"+gR+kI},LI=function(t){t.write(fD("")),t.close();var e=t.parentWindow.Object;return t=null,e},Aq=function(){var t=Pq("iframe"),e="java"+gR+":",n;return t.style.display="none",Iq.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(fD("document.F=Object")),n.close(),n.F},Zg,Bp=function(){try{Zg=new ActiveXObject("htmlfile")}catch{}Bp=typeof document<"u"?document.domain&&Zg?LI(Zg):Aq():LI(Zg);for(var t=DI.length;t--;)delete Bp[fR][DI[t]];return Bp()};xq[dD]=!0;var gD=Object.create||function(e,n){var r;return e!==null?(oC[fR]=Mq(e),r=new oC,oC[fR]=null,r[dD]=e):r=Bp(),n===void 0?r:_q.f(r,n)},Hq=Vn,Nq=_n,Dq=Ai,FI=uD,kq=oE,$q=go,mR=$q("iterator"),pu,sC,aC;[].keys&&(aC=[].keys(),"next"in aC&&(sC=FI(FI(aC)),sC!==Object.prototype&&(pu=sC)));var Lq=!Dq(pu)||Hq(function(){var t={};return pu[mR].call(t)!==t});Lq&&(pu={});Nq(pu[mR])||kq(pu,mR,function(){return this});var mD={IteratorPrototype:pu},Fq=Mt,Vq=Tn,Bq=oq,Wq=xn,jq=_n,Uq=uD,zq=mq,Yq=eD,Gq=Vn,dE=Hi,Kq=go,Zo=mD.IteratorPrototype,qq=Oi,lC="constructor",pD="Iterator",VI=Kq("toStringTag"),wD=TypeError,uC=Vq[pD],vD=!jq(uC)||uC.prototype!==Zo||!Gq(function(){uC({})}),fE=function(){if(Bq(this,Zo),Uq(this)===Zo)throw new wD("Abstract class Iterator not directly constructable")},yD=function(t,e){qq?zq(Zo,t,{configurable:!0,get:function(){return e},set:function(n){if(Wq(this),this===Zo)throw new wD("You can't redefine this property");dE(this,t)?this[t]=n:Yq(this,t,n)}}):Zo[t]=e};dE(Zo,VI)||yD(VI,pD);(vD||!dE(Zo,lC)||Zo[lC]===Object)&&yD(lC,fE);fE.prototype=Zo;Fq({global:!0,constructor:!0,forced:vD},{Iterator:fE});var Xq=oE,Jq=function(t,e,n){for(var r in e)Xq(t,r,e[r],n);return t},Zq=function(t,e){return{value:t,done:e}},Qq=Mn,e4=gD,t4=Ch,n4=Jq,r4=go,CD=HN,i4=dg,o4=mD.IteratorPrototype,Qg=Zq,cC=li,s4=r4("toStringTag"),bD="IteratorHelper",SD="WrapForValidIterator",a4=CD.set,RD=function(t){var e=CD.getterFor(t?SD:bD);return n4(e4(o4),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return Qg(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:Qg(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=i4(r,"return");return i?Qq(i,r):Qg(void 0,!0)}if(n.inner)try{cC(n.inner.iterator,"normal")}catch(o){return cC(r,"throw",o)}return r&&cC(r,"normal"),Qg(void 0,!0)}})},l4=RD(!0),ED=RD(!1);t4(ED,s4,"Iterator Helper");var gE=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?SD:bD,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,a4(this,s)};return r.prototype=e?l4:ED,r},u4=xn,c4=li,TD=function(t,e,n,r){try{return r?e(u4(n)[0],n[1]):e(n)}catch(i){c4(t,"throw",i)}},h4=Tn,rl=function(t,e){var n=h4.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},d4=Mt,MD=Mn,f4=jr,_D=xn,g4=ss,m4=gE,p4=TD,w4=li,v4=rl,hC=v4("filter",TypeError),y4=m4(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=_D(MD(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,p4(t,e,[o,this.counter++],!0))return o}});d4({target:"Iterator",proto:!0,real:!0,forced:hC},{filter:function(e){_D(this);try{f4(e)}catch(n){w4(this,"throw",n)}return hC?MD(hC,this,e):new y4(g4(this),{predicate:e})}});var C4=Mt,b4=Mn,S4=Sh,R4=jr,E4=xn,T4=ss,M4=li,_4=rl,dC=_4("forEach",TypeError);C4({target:"Iterator",proto:!0,real:!0,forced:dC},{forEach:function(e){E4(this);try{R4(e)}catch(i){M4(this,"throw",i)}if(dC)return b4(dC,this,e);var n=T4(this),r=0;S4(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var x4=Mt,xD=Mn,I4=jr,ID=xn,P4=ss,O4=gE,A4=TD,H4=li,N4=rl,fC=N4("map",TypeError),D4=O4(function(){var t=this.iterator,e=ID(xD(this.next,t)),n=this.done=!!e.done;if(!n)return A4(t,this.mapper,[e.value,this.counter++],!0)});x4({target:"Iterator",proto:!0,real:!0,forced:fC},{map:function(e){ID(this);try{I4(e)}catch(n){H4(this,"throw",n)}return fC?xD(fC,this,e):new D4(P4(this),{mapper:e})}});var k4=vn,mE=k4([].slice),$4=TypeError,PD=function(t,e){if(t<e)throw new $4("Not enough arguments");return t},L4=kv,F4=/(?:ipad|iphone|ipod).*applewebkit/i.test(L4),Fh=Tn,V4=kv,B4=_u,em=function(t){return V4.slice(0,t.length)===t},OD=function(){return em("Bun/")?"BUN":em("Cloudflare-Workers")?"CLOUDFLARE":em("Deno/")?"DENO":em("Node.js/")?"NODE":Fh.Bun&&typeof Bun.version=="string"?"BUN":Fh.Deno&&typeof Deno.version=="object"?"DENO":B4(Fh.process)==="process"?"NODE":Fh.window&&Fh.document?"BROWSER":"REST"}(),W4=OD,j4=W4==="NODE",ii=Tn,U4=mg,z4=ZN,BI=_n,Y4=Hi,AD=Vn,WI=hD,G4=mE,jI=tE,K4=PD,q4=F4,X4=j4,pR=ii.setImmediate,wR=ii.clearImmediate,J4=ii.process,gC=ii.Dispatch,Z4=ii.Function,UI=ii.MessageChannel,Q4=ii.String,mC=0,Qd={},zI="onreadystatechange",Hf,ul,pC,wC;AD(function(){Hf=ii.location});var pE=function(t){if(Y4(Qd,t)){var e=Qd[t];delete Qd[t],e()}},vC=function(t){return function(){pE(t)}},YI=function(t){pE(t.data)},GI=function(t){ii.postMessage(Q4(t),Hf.protocol+"//"+Hf.host)};(!pR||!wR)&&(pR=function(e){K4(arguments.length,1);var n=BI(e)?e:Z4(e),r=G4(arguments,1);return Qd[++mC]=function(){U4(n,void 0,r)},ul(mC),mC},wR=function(e){delete Qd[e]},X4?ul=function(t){J4.nextTick(vC(t))}:gC&&gC.now?ul=function(t){gC.now(vC(t))}:UI&&!q4?(pC=new UI,wC=pC.port2,pC.port1.onmessage=YI,ul=z4(wC.postMessage,wC)):ii.addEventListener&&BI(ii.postMessage)&&!ii.importScripts&&Hf&&Hf.protocol!=="file:"&&!AD(GI)?(ul=GI,ii.addEventListener("message",YI,!1)):zI in jI("script")?ul=function(t){WI.appendChild(jI("script"))[zI]=function(){WI.removeChild(this),pE(t)}}:ul=function(t){setTimeout(vC(t),0)});var HD={set:pR,clear:wR},eX=Mt,tX=Tn,KI=HD.clear;eX({global:!0,bind:!0,enumerable:!0,forced:tX.clearImmediate!==KI},{clearImmediate:KI});var ND=Tn,nX=mg,rX=_n,iX=OD,oX=kv,sX=mE,aX=PD,lX=ND.Function,uX=/MSIE .\./.test(oX)||iX==="BUN"&&function(){var t=ND.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),cX=function(t,e){var n=e?2:1;return uX?function(r,i){var o=aX(arguments.length,1)>n,s=rX(r)?r:lX(r),a=o?sX(arguments,n):[],l=o?function(){nX(s,this,a)}:s;return e?t(l,i):t(l)}:t},hX=Mt,DD=Tn,qI=HD.set,dX=cX,XI=DD.setImmediate?dX(qI,!1):qI;hX({global:!0,bind:!0,enumerable:!0,forced:DD.setImmediate!==XI},{setImmediate:XI});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:kD,setPrototypeOf:JI,isFrozen:fX,getPrototypeOf:gX,getOwnPropertyDescriptor:mX}=Object;let{freeze:yr,seal:Ii,create:$D}=Object,{apply:vR,construct:yR}=typeof Reflect<"u"&&Reflect;yr||(yr=function(e){return e});Ii||(Ii=function(e){return e});vR||(vR=function(e,n,r){return e.apply(n,r)});yR||(yR=function(e,n){return new e(...n)});const tm=Cr(Array.prototype.forEach),pX=Cr(Array.prototype.lastIndexOf),ZI=Cr(Array.prototype.pop),Vh=Cr(Array.prototype.push),wX=Cr(Array.prototype.splice),Wp=Cr(String.prototype.toLowerCase),yC=Cr(String.prototype.toString),QI=Cr(String.prototype.match),Bh=Cr(String.prototype.replace),vX=Cr(String.prototype.indexOf),yX=Cr(String.prototype.trim),Ki=Cr(Object.prototype.hasOwnProperty),lr=Cr(RegExp.prototype.test),Wh=CX(TypeError);function Cr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return vR(t,e,r)}}function CX(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return yR(t,n)}}function qe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wp;JI&&JI(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(fX(e)||(e[r]=o),i=o)}t[i]=!0}return t}function bX(t){for(let e=0;e<t.length;e++)Ki(t,e)||(t[e]=null);return t}function ql(t){const e=$D(null);for(const[n,r]of kD(t))Ki(t,n)&&(Array.isArray(r)?e[n]=bX(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=ql(r):e[n]=r);return e}function jh(t,e){for(;t!==null;){const r=mX(t,e);if(r){if(r.get)return Cr(r.get);if(typeof r.value=="function")return Cr(r.value)}t=gX(t)}function n(){return null}return n}const eP=yr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),CC=yr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),bC=yr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),SX=yr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),SC=yr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),RX=yr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tP=yr(["#text"]),nP=yr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),RC=yr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),rP=yr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),nm=yr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),EX=Ii(/\{\{[\w\W]*|[\w\W]*\}\}/gm),TX=Ii(/<%[\w\W]*|[\w\W]*%>/gm),MX=Ii(/\$\{[\w\W]*/gm),_X=Ii(/^data-[\-\w.\u00B7-\uFFFF]+$/),xX=Ii(/^aria-[\-\w]+$/),LD=Ii(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IX=Ii(/^(?:\w+script|data):/i),PX=Ii(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),FD=Ii(/^html$/i),OX=Ii(/^[a-z][.\w]*(-[.\w]+)+$/i);var iP=Object.freeze({__proto__:null,ARIA_ATTR:xX,ATTR_WHITESPACE:PX,CUSTOM_ELEMENT:OX,DATA_ATTR:_X,DOCTYPE_NAME:FD,ERB_EXPR:TX,IS_ALLOWED_URI:LD,IS_SCRIPT_OR_DATA:IX,MUSTACHE_EXPR:EX,TMPLIT_EXPR:MX});const Uh={element:1,text:3,progressingInstruction:7,comment:8,document:9},AX=function(){return typeof window>"u"?null:window},HX=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},oP=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function VD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:AX();const e=Se=>VD(Se);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==Uh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,p=jh(g,"cloneNode"),C=jh(g,"remove"),E=jh(g,"nextSibling"),y=jh(g,"childNodes"),T=jh(g,"parentNode");if(typeof s=="function"){const Se=n.createElement("template");Se.content&&Se.content.ownerDocument&&(n=Se.content.ownerDocument)}let _,P="";const{implementation:M,createNodeIterator:I,createDocumentFragment:z,getElementsByTagName:W}=n,{importNode:V}=r;let q=oP();e.isSupported=typeof kD=="function"&&typeof T=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Z,ERB_EXPR:ee,TMPLIT_EXPR:te,DATA_ATTR:he,ARIA_ATTR:Ue,IS_SCRIPT_OR_DATA:ve,ATTR_WHITESPACE:He,CUSTOM_ELEMENT:st}=iP;let{IS_ALLOWED_URI:Cn}=iP,ze=null;const m=qe({},[...eP,...CC,...bC,...SC,...tP]);let v=null;const w=qe({},[...nP,...RC,...rP,...nm]);let A=Object.seal($D(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,U=null,K=!0,J=!0,b=!1,R=!0,S=!1,$=!0,O=!1,N=!1,j=!1,H=!1,D=!1,B=!1,F=!0,G=!1;const le="user-content-";let de=!0,Ie=!1,We={},Ze=null;const xe=qe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ge=null;const Nt=qe({},["audio","video","img","source","image","track"]);let Li=null;const hs=qe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ci="http://www.w3.org/1998/Math/MathML",Dt="http://www.w3.org/2000/svg",bn="http://www.w3.org/1999/xhtml";let _t=bn,kt=!1,Ke=null;const hi=qe({},[ci,Dt,bn],yC);let sl=qe({},["mi","mo","mn","ms","mtext"]),al=qe({},["annotation-xml"]);const aB=qe({},["title","style","font","a","script"]);let Nh=null;const lB=["application/xhtml+xml","text/html"],uB="text/html";let Dn=null,Vu=null;const cB=n.createElement("form"),dx=function(k){return k instanceof RegExp||k instanceof Function},Ly=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Vu&&Vu===k)){if((!k||typeof k!="object")&&(k={}),k=ql(k),Nh=lB.indexOf(k.PARSER_MEDIA_TYPE)===-1?uB:k.PARSER_MEDIA_TYPE,Dn=Nh==="application/xhtml+xml"?yC:Wp,ze=Ki(k,"ALLOWED_TAGS")?qe({},k.ALLOWED_TAGS,Dn):m,v=Ki(k,"ALLOWED_ATTR")?qe({},k.ALLOWED_ATTR,Dn):w,Ke=Ki(k,"ALLOWED_NAMESPACES")?qe({},k.ALLOWED_NAMESPACES,yC):hi,Li=Ki(k,"ADD_URI_SAFE_ATTR")?qe(ql(hs),k.ADD_URI_SAFE_ATTR,Dn):hs,Ge=Ki(k,"ADD_DATA_URI_TAGS")?qe(ql(Nt),k.ADD_DATA_URI_TAGS,Dn):Nt,Ze=Ki(k,"FORBID_CONTENTS")?qe({},k.FORBID_CONTENTS,Dn):xe,L=Ki(k,"FORBID_TAGS")?qe({},k.FORBID_TAGS,Dn):{},U=Ki(k,"FORBID_ATTR")?qe({},k.FORBID_ATTR,Dn):{},We=Ki(k,"USE_PROFILES")?k.USE_PROFILES:!1,K=k.ALLOW_ARIA_ATTR!==!1,J=k.ALLOW_DATA_ATTR!==!1,b=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=k.SAFE_FOR_TEMPLATES||!1,$=k.SAFE_FOR_XML!==!1,O=k.WHOLE_DOCUMENT||!1,H=k.RETURN_DOM||!1,D=k.RETURN_DOM_FRAGMENT||!1,B=k.RETURN_TRUSTED_TYPE||!1,j=k.FORCE_BODY||!1,F=k.SANITIZE_DOM!==!1,G=k.SANITIZE_NAMED_PROPS||!1,de=k.KEEP_CONTENT!==!1,Ie=k.IN_PLACE||!1,Cn=k.ALLOWED_URI_REGEXP||LD,_t=k.NAMESPACE||bn,sl=k.MATHML_TEXT_INTEGRATION_POINTS||sl,al=k.HTML_INTEGRATION_POINTS||al,A=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&dx(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(A.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&dx(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(A.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(A.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(J=!1),D&&(H=!0),We&&(ze=qe({},tP),v=[],We.html===!0&&(qe(ze,eP),qe(v,nP)),We.svg===!0&&(qe(ze,CC),qe(v,RC),qe(v,nm)),We.svgFilters===!0&&(qe(ze,bC),qe(v,RC),qe(v,nm)),We.mathMl===!0&&(qe(ze,SC),qe(v,rP),qe(v,nm))),k.ADD_TAGS&&(ze===m&&(ze=ql(ze)),qe(ze,k.ADD_TAGS,Dn)),k.ADD_ATTR&&(v===w&&(v=ql(v)),qe(v,k.ADD_ATTR,Dn)),k.ADD_URI_SAFE_ATTR&&qe(Li,k.ADD_URI_SAFE_ATTR,Dn),k.FORBID_CONTENTS&&(Ze===xe&&(Ze=ql(Ze)),qe(Ze,k.FORBID_CONTENTS,Dn)),de&&(ze["#text"]=!0),O&&qe(ze,["html","head","body"]),ze.table&&(qe(ze,["tbody"]),delete L.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Wh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Wh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=k.TRUSTED_TYPES_POLICY,P=_.createHTML("")}else _===void 0&&(_=HX(f,i)),_!==null&&typeof P=="string"&&(P=_.createHTML(""));yr&&yr(k),Vu=k}},fx=qe({},[...CC,...bC,...SX]),gx=qe({},[...SC,...RX]),hB=function(k){let ie=T(k);(!ie||!ie.tagName)&&(ie={namespaceURI:_t,tagName:"template"});const we=Wp(k.tagName),jt=Wp(ie.tagName);return Ke[k.namespaceURI]?k.namespaceURI===Dt?ie.namespaceURI===bn?we==="svg":ie.namespaceURI===ci?we==="svg"&&(jt==="annotation-xml"||sl[jt]):!!fx[we]:k.namespaceURI===ci?ie.namespaceURI===bn?we==="math":ie.namespaceURI===Dt?we==="math"&&al[jt]:!!gx[we]:k.namespaceURI===bn?ie.namespaceURI===Dt&&!al[jt]||ie.namespaceURI===ci&&!sl[jt]?!1:!gx[we]&&(aB[we]||!fx[we]):!!(Nh==="application/xhtml+xml"&&Ke[k.namespaceURI]):!1},wo=function(k){Vh(e.removed,{element:k});try{T(k).removeChild(k)}catch{C(k)}},jg=function(k,ie){try{Vh(e.removed,{attribute:ie.getAttributeNode(k),from:ie})}catch{Vh(e.removed,{attribute:null,from:ie})}if(ie.removeAttribute(k),k==="is")if(H||D)try{wo(ie)}catch{}else try{ie.setAttribute(k,"")}catch{}},mx=function(k){let ie=null,we=null;if(j)k="<remove></remove>"+k;else{const Bn=QI(k,/^[\r\n\t ]+/);we=Bn&&Bn[0]}Nh==="application/xhtml+xml"&&_t===bn&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const jt=_?_.createHTML(k):k;if(_t===bn)try{ie=new d().parseFromString(jt,Nh)}catch{}if(!ie||!ie.documentElement){ie=M.createDocument(_t,"template",null);try{ie.documentElement.innerHTML=kt?P:jt}catch{}}const Gn=ie.body||ie.documentElement;return k&&we&&Gn.insertBefore(n.createTextNode(we),Gn.childNodes[0]||null),_t===bn?W.call(ie,O?"html":"body")[0]:O?ie.documentElement:Gn},px=function(k){return I.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Fy=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},wx=function(k){return typeof a=="function"&&k instanceof a};function ds(Se,k,ie){tm(Se,we=>{we.call(e,k,ie,Vu)})}const vx=function(k){let ie=null;if(ds(q.beforeSanitizeElements,k,null),Fy(k))return wo(k),!0;const we=Dn(k.nodeName);if(ds(q.uponSanitizeElement,k,{tagName:we,allowedTags:ze}),k.hasChildNodes()&&!wx(k.firstElementChild)&&lr(/<[/\w!]/g,k.innerHTML)&&lr(/<[/\w!]/g,k.textContent)||k.nodeType===Uh.progressingInstruction||$&&k.nodeType===Uh.comment&&lr(/<[/\w]/g,k.data))return wo(k),!0;if(!ze[we]||L[we]){if(!L[we]&&Cx(we)&&(A.tagNameCheck instanceof RegExp&&lr(A.tagNameCheck,we)||A.tagNameCheck instanceof Function&&A.tagNameCheck(we)))return!1;if(de&&!Ze[we]){const jt=T(k)||k.parentNode,Gn=y(k)||k.childNodes;if(Gn&&jt){const Bn=Gn.length;for(let Rr=Bn-1;Rr>=0;--Rr){const vo=p(Gn[Rr],!0);vo.__removalCount=(k.__removalCount||0)+1,jt.insertBefore(vo,E(k))}}}return wo(k),!0}return k instanceof l&&!hB(k)||(we==="noscript"||we==="noembed"||we==="noframes")&&lr(/<\/no(script|embed|frames)/i,k.innerHTML)?(wo(k),!0):(S&&k.nodeType===Uh.text&&(ie=k.textContent,tm([Z,ee,te],jt=>{ie=Bh(ie,jt," ")}),k.textContent!==ie&&(Vh(e.removed,{element:k.cloneNode()}),k.textContent=ie)),ds(q.afterSanitizeElements,k,null),!1)},yx=function(k,ie,we){if(F&&(ie==="id"||ie==="name")&&(we in n||we in cB))return!1;if(!(J&&!U[ie]&&lr(he,ie))){if(!(K&&lr(Ue,ie))){if(!v[ie]||U[ie]){if(!(Cx(k)&&(A.tagNameCheck instanceof RegExp&&lr(A.tagNameCheck,k)||A.tagNameCheck instanceof Function&&A.tagNameCheck(k))&&(A.attributeNameCheck instanceof RegExp&&lr(A.attributeNameCheck,ie)||A.attributeNameCheck instanceof Function&&A.attributeNameCheck(ie))||ie==="is"&&A.allowCustomizedBuiltInElements&&(A.tagNameCheck instanceof RegExp&&lr(A.tagNameCheck,we)||A.tagNameCheck instanceof Function&&A.tagNameCheck(we))))return!1}else if(!Li[ie]){if(!lr(Cn,Bh(we,He,""))){if(!((ie==="src"||ie==="xlink:href"||ie==="href")&&k!=="script"&&vX(we,"data:")===0&&Ge[k])){if(!(b&&!lr(ve,Bh(we,He,"")))){if(we)return!1}}}}}}return!0},Cx=function(k){return k!=="annotation-xml"&&QI(k,st)},bx=function(k){ds(q.beforeSanitizeAttributes,k,null);const{attributes:ie}=k;if(!ie||Fy(k))return;const we={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:v,forceKeepAttr:void 0};let jt=ie.length;for(;jt--;){const Gn=ie[jt],{name:Bn,namespaceURI:Rr,value:vo}=Gn,Dh=Dn(Bn);let ar=Bn==="value"?vo:yX(vo);if(we.attrName=Dh,we.attrValue=ar,we.keepAttr=!0,we.forceKeepAttr=void 0,ds(q.uponSanitizeAttribute,k,we),ar=we.attrValue,G&&(Dh==="id"||Dh==="name")&&(jg(Bn,k),ar=le+ar),$&&lr(/((--!?|])>)|<\/(style|title)/i,ar)){jg(Bn,k);continue}if(we.forceKeepAttr||(jg(Bn,k),!we.keepAttr))continue;if(!R&&lr(/\/>/i,ar)){jg(Bn,k);continue}S&&tm([Z,ee,te],Rx=>{ar=Bh(ar,Rx," ")});const Sx=Dn(k.nodeName);if(yx(Sx,Dh,ar)){if(_&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Rr)switch(f.getAttributeType(Sx,Dh)){case"TrustedHTML":{ar=_.createHTML(ar);break}case"TrustedScriptURL":{ar=_.createScriptURL(ar);break}}try{Rr?k.setAttributeNS(Rr,Bn,ar):k.setAttribute(Bn,ar),Fy(k)?wo(k):ZI(e.removed)}catch{}}}ds(q.afterSanitizeAttributes,k,null)},dB=function Se(k){let ie=null;const we=px(k);for(ds(q.beforeSanitizeShadowDOM,k,null);ie=we.nextNode();)ds(q.uponSanitizeShadowNode,ie,null),vx(ie),bx(ie),ie.content instanceof o&&Se(ie.content);ds(q.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(Se){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie=null,we=null,jt=null,Gn=null;if(kt=!Se,kt&&(Se="<!-->"),typeof Se!="string"&&!wx(Se))if(typeof Se.toString=="function"){if(Se=Se.toString(),typeof Se!="string")throw Wh("dirty is not a string, aborting")}else throw Wh("toString is not a function");if(!e.isSupported)return Se;if(N||Ly(k),e.removed=[],typeof Se=="string"&&(Ie=!1),Ie){if(Se.nodeName){const vo=Dn(Se.nodeName);if(!ze[vo]||L[vo])throw Wh("root node is forbidden and cannot be sanitized in-place")}}else if(Se instanceof a)ie=mx("<!---->"),we=ie.ownerDocument.importNode(Se,!0),we.nodeType===Uh.element&&we.nodeName==="BODY"||we.nodeName==="HTML"?ie=we:ie.appendChild(we);else{if(!H&&!S&&!O&&Se.indexOf("<")===-1)return _&&B?_.createHTML(Se):Se;if(ie=mx(Se),!ie)return H?null:B?P:""}ie&&j&&wo(ie.firstChild);const Bn=px(Ie?Se:ie);for(;jt=Bn.nextNode();)vx(jt),bx(jt),jt.content instanceof o&&dB(jt.content);if(Ie)return Se;if(H){if(D)for(Gn=z.call(ie.ownerDocument);ie.firstChild;)Gn.appendChild(ie.firstChild);else Gn=ie;return(v.shadowroot||v.shadowrootmode)&&(Gn=V.call(r,Gn,!0)),Gn}let Rr=O?ie.outerHTML:ie.innerHTML;return O&&ze["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&lr(FD,ie.ownerDocument.doctype.name)&&(Rr="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+Rr),S&&tm([Z,ee,te],vo=>{Rr=Bh(Rr,vo," ")}),_&&B?_.createHTML(Rr):Rr},e.setConfig=function(){let Se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ly(Se),N=!0},e.clearConfig=function(){Vu=null,N=!1},e.isValidAttribute=function(Se,k,ie){Vu||Ly({});const we=Dn(Se),jt=Dn(k);return yx(we,jt,ie)},e.addHook=function(Se,k){typeof k=="function"&&Vh(q[Se],k)},e.removeHook=function(Se,k){if(k!==void 0){const ie=pX(q[Se],k);return ie===-1?void 0:wX(q[Se],ie,1)[0]}return ZI(q[Se])},e.removeHooks=function(Se){q[Se]=[]},e.removeAllHooks=function(){q=oP()},e}var NX=VD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var BD;function Q(){return BD.apply(null,arguments)}function DX(t){BD=t}function co(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function cu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function ht(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function wE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(ht(t,e))return!1;return!0}function Hr(t){return t===void 0}function Xs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function vg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function WD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function $a(t,e){for(var n in e)ht(e,n)&&(t[n]=e[n]);return ht(e,"toString")&&(t.toString=e.toString),ht(e,"valueOf")&&(t.valueOf=e.valueOf),t}function as(t,e,n,r){return hk(t,e,n,r,!0).utc()}function kX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function $e(t){return t._pf==null&&(t._pf=kX()),t._pf}var CR;Array.prototype.some?CR=Array.prototype.some:CR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function vE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=$e(t),n=CR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Fv(t){var e=as(NaN);return t!=null?$a($e(e),t):$e(e).userInvalidated=!0,e}var sP=Q.momentProperties=[],EC=!1;function yE(t,e){var n,r,i,o=sP.length;if(Hr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Hr(e._i)||(t._i=e._i),Hr(e._f)||(t._f=e._f),Hr(e._l)||(t._l=e._l),Hr(e._strict)||(t._strict=e._strict),Hr(e._tzm)||(t._tzm=e._tzm),Hr(e._isUTC)||(t._isUTC=e._isUTC),Hr(e._offset)||(t._offset=e._offset),Hr(e._pf)||(t._pf=$e(e)),Hr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=sP[n],i=e[r],Hr(i)||(t[r]=i);return t}function yg(t){yE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),EC===!1&&(EC=!0,Q.updateOffset(this),EC=!1)}function ho(t){return t instanceof yg||t!=null&&t._isAMomentObject!=null}function jD(t){Q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ni(t,e){var n=!0;return $a(function(){if(Q.deprecationHandler!=null&&Q.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])ht(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}jD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var aP={};function UD(t,e){Q.deprecationHandler!=null&&Q.deprecationHandler(t,e),aP[t]||(jD(e),aP[t]=!0)}Q.suppressDeprecationWarnings=!1;Q.deprecationHandler=null;function ls(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function $X(t){var e,n;for(n in t)ht(t,n)&&(e=t[n],ls(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function bR(t,e){var n=$a({},t),r;for(r in e)ht(e,r)&&(cu(t[r])&&cu(e[r])?(n[r]={},$a(n[r],t[r]),$a(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)ht(t,r)&&!ht(e,r)&&cu(t[r])&&(n[r]=$a({},n[r]));return n}function CE(t){t!=null&&this.set(t)}var SR;Object.keys?SR=Object.keys:SR=function(t){var e,n=[];for(e in t)ht(t,e)&&n.push(e);return n};var LX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function FX(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return ls(r)?r.call(e,n):r}function ns(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var bE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,rm=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,TC={},Yc={};function Re(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Yc[t]=i),e&&(Yc[e[0]]=function(){return ns(i.apply(this,arguments),e[1],e[2])}),n&&(Yc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function VX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function BX(t){var e=t.match(bE),n,r;for(n=0,r=e.length;n<r;n++)Yc[e[n]]?e[n]=Yc[e[n]]:e[n]=VX(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=ls(e[s])?e[s].call(i,t):e[s];return o}}function jp(t,e){return t.isValid()?(e=zD(e,t.localeData()),TC[e]=TC[e]||BX(e),TC[e](t)):t.localeData().invalidDate()}function zD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(rm.lastIndex=0;n>=0&&rm.test(t);)t=t.replace(rm,r),rm.lastIndex=0,n-=1;return t}var WX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function jX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(bE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var UX="Invalid date";function zX(){return this._invalidDate}var YX="%d",GX=/\d{1,2}/;function KX(t){return this._ordinal.replace("%d",t)}var qX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function XX(t,e,n,r){var i=this._relativeTime[n];return ls(i)?i(t,e,n,r):i.replace(/%d/i,t)}function JX(t,e){var n=this._relativeTime[t>0?"future":"past"];return ls(n)?n(e):n.replace(/%s/i,e)}var lP={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Di(t){return typeof t=="string"?lP[t]||lP[t.toLowerCase()]:void 0}function SE(t){var e={},n,r;for(r in t)ht(t,r)&&(n=Di(r),n&&(e[n]=t[r]));return e}var ZX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function QX(t){var e=[],n;for(n in t)ht(t,n)&&e.push({unit:n,priority:ZX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var YD=/\d/,ui=/\d\d/,GD=/\d{3}/,RE=/\d{4}/,Vv=/[+-]?\d{6}/,Wt=/\d\d?/,KD=/\d\d\d\d?/,qD=/\d\d\d\d\d\d?/,Bv=/\d{1,3}/,EE=/\d{1,4}/,Wv=/[+-]?\d{1,6}/,Rh=/\d+/,jv=/[+-]?\d+/,e6=/Z|[+-]\d\d:?\d\d/gi,Uv=/Z|[+-]\d\d(?::?\d\d)?/gi,t6=/[+-]?\d+(\.\d{1,3})?/,Cg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Eh=/^[1-9]\d?/,TE=/^([1-9]\d|\d)/,Pw;Pw={};function ce(t,e,n){Pw[t]=ls(e)?e:function(r,i){return r&&n?n:e}}function n6(t,e){return ht(Pw,t)?Pw[t](e._strict,e._locale):new RegExp(r6(t))}function r6(t){return Ks(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Ks(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ei(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function et(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Ei(e)),n}var RR={};function Et(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Xs(e)&&(r=function(o,s){s[e]=et(o)}),i=t.length,n=0;n<i;n++)RR[t[n]]=r}function bg(t,e){Et(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function i6(t,e,n){e!=null&&ht(RR,t)&&RR[t](e,n._a,n,t)}function zv(t){return t%4===0&&t%100!==0||t%400===0}var rr=0,Vs=1,zo=2,Hn=3,ao=4,Bs=5,ru=6,o6=7,s6=8;Re("Y",0,0,function(){var t=this.year();return t<=9999?ns(t,4):"+"+t});Re(0,["YY",2],0,function(){return this.year()%100});Re(0,["YYYY",4],0,"year");Re(0,["YYYYY",5],0,"year");Re(0,["YYYYYY",6,!0],0,"year");ce("Y",jv);ce("YY",Wt,ui);ce("YYYY",EE,RE);ce("YYYYY",Wv,Vv);ce("YYYYYY",Wv,Vv);Et(["YYYYY","YYYYYY"],rr);Et("YYYY",function(t,e){e[rr]=t.length===2?Q.parseTwoDigitYear(t):et(t)});Et("YY",function(t,e){e[rr]=Q.parseTwoDigitYear(t)});Et("Y",function(t,e){e[rr]=parseInt(t,10)});function ef(t){return zv(t)?366:365}Q.parseTwoDigitYear=function(t){return et(t)+(et(t)>68?1900:2e3)};var XD=Th("FullYear",!0);function a6(){return zv(this.year())}function Th(t,e){return function(n){return n!=null?(JD(this,t,n),Q.updateOffset(this,e),this):Nf(this,t)}}function Nf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function JD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!zv(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function l6(t){return t=Di(t),ls(this[t])?this[t]():this}function u6(t,e){if(typeof t=="object"){t=SE(t);var n=QX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Di(t),ls(this[t]))return this[t](e);return this}function c6(t,e){return(t%e+e)%e}var dn;Array.prototype.indexOf?dn=Array.prototype.indexOf:dn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function ME(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=c6(e,12);return t+=(e-n)/12,n===1?zv(t)?29:28:31-n%7%2}Re("M",["MM",2],"Mo",function(){return this.month()+1});Re("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Re("MMMM",0,0,function(t){return this.localeData().months(this,t)});ce("M",Wt,Eh);ce("MM",Wt,ui);ce("MMM",function(t,e){return e.monthsShortRegex(t)});ce("MMMM",function(t,e){return e.monthsRegex(t)});Et(["M","MM"],function(t,e){e[Vs]=et(t)-1});Et(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Vs]=i:$e(n).invalidMonth=t});var h6="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ZD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),QD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,d6=Cg,f6=Cg;function g6(t,e){return t?co(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||QD).test(e)?"format":"standalone"][t.month()]:co(this._months)?this._months:this._months.standalone}function m6(t,e){return t?co(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[QD.test(e)?"format":"standalone"][t.month()]:co(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function p6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=as([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=dn.call(this._shortMonthsParse,s),i!==-1?i:null):(i=dn.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=dn.call(this._shortMonthsParse,s),i!==-1?i:(i=dn.call(this._longMonthsParse,s),i!==-1?i:null)):(i=dn.call(this._longMonthsParse,s),i!==-1?i:(i=dn.call(this._shortMonthsParse,s),i!==-1?i:null))}function w6(t,e,n){var r,i,o;if(this._monthsParseExact)return p6.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=as([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function ek(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=et(e);else if(e=t.localeData().monthsParse(e),!Xs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,ME(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function tk(t){return t!=null?(ek(this,t),Q.updateOffset(this,!0),this):Nf(this,"Month")}function v6(){return ME(this.year(),this.month())}function y6(t){return this._monthsParseExact?(ht(this,"_monthsRegex")||nk.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(ht(this,"_monthsShortRegex")||(this._monthsShortRegex=d6),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function C6(t){return this._monthsParseExact?(ht(this,"_monthsRegex")||nk.call(this),t?this._monthsStrictRegex:this._monthsRegex):(ht(this,"_monthsRegex")||(this._monthsRegex=f6),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function nk(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=as([2e3,i]),s=Ks(this.monthsShort(o,"")),a=Ks(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function b6(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Df(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Ow(t,e,n){var r=7+e-n,i=(7+Df(t,0,r).getUTCDay()-e)%7;return-i+r-1}function rk(t,e,n,r,i){var o=(7+n-r)%7,s=Ow(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=ef(l)+a):a>ef(t)?(l=t+1,u=a-ef(t)):(l=t,u=a),{year:l,dayOfYear:u}}function kf(t,e,n){var r=Ow(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+qs(s,e,n)):i>qs(t.year(),e,n)?(o=i-qs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function qs(t,e,n){var r=Ow(t,e,n),i=Ow(t+1,e,n);return(ef(t)-r+i)/7}Re("w",["ww",2],"wo","week");Re("W",["WW",2],"Wo","isoWeek");ce("w",Wt,Eh);ce("ww",Wt,ui);ce("W",Wt,Eh);ce("WW",Wt,ui);bg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=et(t)});function S6(t){return kf(t,this._week.dow,this._week.doy).week}var R6={dow:0,doy:6};function E6(){return this._week.dow}function T6(){return this._week.doy}function M6(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function _6(t){var e=kf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Re("d",0,"do","day");Re("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Re("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Re("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Re("e",0,0,"weekday");Re("E",0,0,"isoWeekday");ce("d",Wt);ce("e",Wt);ce("E",Wt);ce("dd",function(t,e){return e.weekdaysMinRegex(t)});ce("ddd",function(t,e){return e.weekdaysShortRegex(t)});ce("dddd",function(t,e){return e.weekdaysRegex(t)});bg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:$e(n).invalidWeekday=t});bg(["d","e","E"],function(t,e,n,r){e[r]=et(t)});function x6(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function I6(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function _E(t,e){return t.slice(e,7).concat(t.slice(0,e))}var P6="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ik="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),O6="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),A6=Cg,H6=Cg,N6=Cg;function D6(t,e){var n=co(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?_E(n,this._week.dow):t?n[t.day()]:n}function k6(t){return t===!0?_E(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function $6(t){return t===!0?_E(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function L6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=as([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=dn.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=dn.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=dn.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=dn.call(this._weekdaysParse,s),i!==-1||(i=dn.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=dn.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=dn.call(this._shortWeekdaysParse,s),i!==-1||(i=dn.call(this._weekdaysParse,s),i!==-1)?i:(i=dn.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=dn.call(this._minWeekdaysParse,s),i!==-1||(i=dn.call(this._weekdaysParse,s),i!==-1)?i:(i=dn.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function F6(t,e,n){var r,i,o;if(this._weekdaysParseExact)return L6.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=as([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function V6(t){if(!this.isValid())return t!=null?this:NaN;var e=Nf(this,"Day");return t!=null?(t=x6(t,this.localeData()),this.add(t-e,"d")):e}function B6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function W6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=I6(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function j6(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||xE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(ht(this,"_weekdaysRegex")||(this._weekdaysRegex=A6),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function U6(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||xE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ht(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=H6),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function z6(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||xE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ht(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=N6),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function xE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=as([2e3,1]).day(o),a=Ks(this.weekdaysMin(s,"")),l=Ks(this.weekdaysShort(s,"")),u=Ks(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function IE(){return this.hours()%12||12}function Y6(){return this.hours()||24}Re("H",["HH",2],0,"hour");Re("h",["hh",2],0,IE);Re("k",["kk",2],0,Y6);Re("hmm",0,0,function(){return""+IE.apply(this)+ns(this.minutes(),2)});Re("hmmss",0,0,function(){return""+IE.apply(this)+ns(this.minutes(),2)+ns(this.seconds(),2)});Re("Hmm",0,0,function(){return""+this.hours()+ns(this.minutes(),2)});Re("Hmmss",0,0,function(){return""+this.hours()+ns(this.minutes(),2)+ns(this.seconds(),2)});function ok(t,e){Re(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}ok("a",!0);ok("A",!1);function sk(t,e){return e._meridiemParse}ce("a",sk);ce("A",sk);ce("H",Wt,TE);ce("h",Wt,Eh);ce("k",Wt,Eh);ce("HH",Wt,ui);ce("hh",Wt,ui);ce("kk",Wt,ui);ce("hmm",KD);ce("hmmss",qD);ce("Hmm",KD);ce("Hmmss",qD);Et(["H","HH"],Hn);Et(["k","kk"],function(t,e,n){var r=et(t);e[Hn]=r===24?0:r});Et(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});Et(["h","hh"],function(t,e,n){e[Hn]=et(t),$e(n).bigHour=!0});Et("hmm",function(t,e,n){var r=t.length-2;e[Hn]=et(t.substr(0,r)),e[ao]=et(t.substr(r)),$e(n).bigHour=!0});Et("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Hn]=et(t.substr(0,r)),e[ao]=et(t.substr(r,2)),e[Bs]=et(t.substr(i)),$e(n).bigHour=!0});Et("Hmm",function(t,e,n){var r=t.length-2;e[Hn]=et(t.substr(0,r)),e[ao]=et(t.substr(r))});Et("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Hn]=et(t.substr(0,r)),e[ao]=et(t.substr(r,2)),e[Bs]=et(t.substr(i))});function G6(t){return(t+"").toLowerCase().charAt(0)==="p"}var K6=/[ap]\.?m?\.?/i,q6=Th("Hours",!0);function X6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var ak={calendar:LX,longDateFormat:WX,invalidDate:UX,ordinal:YX,dayOfMonthOrdinalParse:GX,relativeTime:qX,months:h6,monthsShort:ZD,week:R6,weekdays:P6,weekdaysMin:O6,weekdaysShort:ik,meridiemParse:K6},zt={},zh={},$f;function J6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function uP(t){return t&&t.toLowerCase().replace("_","-")}function Z6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=uP(t[e]).split("-"),n=o.length,r=uP(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Yv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&J6(o,r)>=n-1)break;n--}e++}return $f}function Q6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Yv(t){var e=null,n;if(zt[t]===void 0&&typeof dw<"u"&&dw&&dw.exports&&Q6(t))try{e=$f._abbr,n=require,n("./locale/"+t),Ua(e)}catch{zt[t]=null}return zt[t]}function Ua(t,e){var n;return t&&(Hr(e)?n=na(t):n=PE(t,e),n?$f=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),$f._abbr}function PE(t,e){if(e!==null){var n,r=ak;if(e.abbr=t,zt[t]!=null)UD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=zt[t]._config;else if(e.parentLocale!=null)if(zt[e.parentLocale]!=null)r=zt[e.parentLocale]._config;else if(n=Yv(e.parentLocale),n!=null)r=n._config;else return zh[e.parentLocale]||(zh[e.parentLocale]=[]),zh[e.parentLocale].push({name:t,config:e}),null;return zt[t]=new CE(bR(r,e)),zh[t]&&zh[t].forEach(function(i){PE(i.name,i.config)}),Ua(t),zt[t]}else return delete zt[t],null}function e7(t,e){if(e!=null){var n,r,i=ak;zt[t]!=null&&zt[t].parentLocale!=null?zt[t].set(bR(zt[t]._config,e)):(r=Yv(t),r!=null&&(i=r._config),e=bR(i,e),r==null&&(e.abbr=t),n=new CE(e),n.parentLocale=zt[t],zt[t]=n),Ua(t)}else zt[t]!=null&&(zt[t].parentLocale!=null?(zt[t]=zt[t].parentLocale,t===Ua()&&Ua(t)):zt[t]!=null&&delete zt[t]);return zt[t]}function na(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return $f;if(!co(t)){if(e=Yv(t),e)return e;t=[t]}return Z6(t)}function t7(){return SR(zt)}function OE(t){var e,n=t._a;return n&&$e(t).overflow===-2&&(e=n[Vs]<0||n[Vs]>11?Vs:n[zo]<1||n[zo]>ME(n[rr],n[Vs])?zo:n[Hn]<0||n[Hn]>24||n[Hn]===24&&(n[ao]!==0||n[Bs]!==0||n[ru]!==0)?Hn:n[ao]<0||n[ao]>59?ao:n[Bs]<0||n[Bs]>59?Bs:n[ru]<0||n[ru]>999?ru:-1,$e(t)._overflowDayOfYear&&(e<rr||e>zo)&&(e=zo),$e(t)._overflowWeeks&&e===-1&&(e=o6),$e(t)._overflowWeekday&&e===-1&&(e=s6),$e(t).overflow=e),t}var n7=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,r7=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,i7=/Z|[+-]\d\d(?::?\d\d)?/,im=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],MC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],o7=/^\/?Date\((-?\d+)/i,s7=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,a7={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function lk(t){var e,n,r=t._i,i=n7.exec(r)||r7.exec(r),o,s,a,l,u=im.length,c=MC.length;if(i){for($e(t).iso=!0,e=0,n=u;e<n;e++)if(im[e][1].exec(i[1])){s=im[e][0],o=im[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(MC[e][1].exec(i[3])){a=(i[2]||" ")+MC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(i7.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),HE(t)}else t._isValid=!1}function l7(t,e,n,r,i,o){var s=[u7(t),ZD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function u7(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function c7(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function h7(t,e,n){if(t){var r=ik.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return $e(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function d7(t,e,n){if(t)return a7[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function uk(t){var e=s7.exec(c7(t._i)),n;if(e){if(n=l7(e[4],e[3],e[2],e[5],e[6],e[7]),!h7(e[1],n,t))return;t._a=n,t._tzm=d7(e[8],e[9],e[10]),t._d=Df.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),$e(t).rfc2822=!0}else t._isValid=!1}function f7(t){var e=o7.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(lk(t),t._isValid===!1)delete t._isValid;else return;if(uk(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Q.createFromInputFallback(t)}Q.createFromInputFallback=Ni("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Mc(t,e,n){return t??e??n}function g7(t){var e=new Date(Q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function AE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=g7(t),t._w&&t._a[zo]==null&&t._a[Vs]==null&&m7(t),t._dayOfYear!=null&&(s=Mc(t._a[rr],i[rr]),(t._dayOfYear>ef(s)||t._dayOfYear===0)&&($e(t)._overflowDayOfYear=!0),n=Df(s,0,t._dayOfYear),t._a[Vs]=n.getUTCMonth(),t._a[zo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Hn]===24&&t._a[ao]===0&&t._a[Bs]===0&&t._a[ru]===0&&(t._nextDay=!0,t._a[Hn]=0),t._d=(t._useUTC?Df:b6).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Hn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&($e(t).weekdayMismatch=!0)}}function m7(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Mc(e.GG,t._a[rr],kf(Bt(),1,4).year),r=Mc(e.W,1),i=Mc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=kf(Bt(),o,s),n=Mc(e.gg,t._a[rr],u.year),r=Mc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>qs(n,o,s)?$e(t)._overflowWeeks=!0:l!=null?$e(t)._overflowWeekday=!0:(a=rk(n,r,i,o,s),t._a[rr]=a.year,t._dayOfYear=a.dayOfYear)}Q.ISO_8601=function(){};Q.RFC_2822=function(){};function HE(t){if(t._f===Q.ISO_8601){lk(t);return}if(t._f===Q.RFC_2822){uk(t);return}t._a=[],$e(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=zD(t._f,t._locale).match(bE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(n6(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&$e(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Yc[o]?(r?$e(t).empty=!1:$e(t).unusedTokens.push(o),i6(o,r,t)):t._strict&&!r&&$e(t).unusedTokens.push(o);$e(t).charsLeftOver=a-l,e.length>0&&$e(t).unusedInput.push(e),t._a[Hn]<=12&&$e(t).bigHour===!0&&t._a[Hn]>0&&($e(t).bigHour=void 0),$e(t).parsedDateParts=t._a.slice(0),$e(t).meridiem=t._meridiem,t._a[Hn]=p7(t._locale,t._a[Hn],t._meridiem),u=$e(t).era,u!==null&&(t._a[rr]=t._locale.erasConvertYear(u,t._a[rr])),AE(t),OE(t)}function p7(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function w7(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){$e(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=yE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],HE(e),vE(e)&&(s=!0),o+=$e(e).charsLeftOver,o+=$e(e).unusedTokens.length*10,$e(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));$a(t,n||e)}function v7(t){if(!t._d){var e=SE(t._i),n=e.day===void 0?e.date:e.day;t._a=WD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),AE(t)}}function y7(t){var e=new yg(OE(ck(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function ck(t){var e=t._i,n=t._f;return t._locale=t._locale||na(t._l),e===null||n===void 0&&e===""?Fv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ho(e)?new yg(OE(e)):(vg(e)?t._d=e:co(n)?w7(t):n?HE(t):C7(t),vE(t)||(t._d=null),t))}function C7(t){var e=t._i;Hr(e)?t._d=new Date(Q.now()):vg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?f7(t):co(e)?(t._a=WD(e.slice(0),function(n){return parseInt(n,10)}),AE(t)):cu(e)?v7(t):Xs(e)?t._d=new Date(e):Q.createFromInputFallback(t)}function hk(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(cu(t)&&wE(t)||co(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,y7(o)}function Bt(t,e,n,r){return hk(t,e,n,r,!1)}var b7=Ni("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Bt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Fv()}),S7=Ni("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Bt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Fv()});function dk(t,e){var n,r;if(e.length===1&&co(e[0])&&(e=e[0]),!e.length)return Bt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function R7(){var t=[].slice.call(arguments,0);return dk("isBefore",t)}function E7(){var t=[].slice.call(arguments,0);return dk("isAfter",t)}var T7=function(){return Date.now?Date.now():+new Date},Yh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function M7(t){var e,n=!1,r,i=Yh.length;for(e in t)if(ht(t,e)&&!(dn.call(Yh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Yh[r]]){if(n)return!1;parseFloat(t[Yh[r]])!==et(t[Yh[r]])&&(n=!0)}return!0}function _7(){return this._isValid}function x7(){return mo(NaN)}function Gv(t){var e=SE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=M7(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=na(),this._bubble()}function Up(t){return t instanceof Gv}function ER(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function I7(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)et(t[s])!==et(e[s])&&o++;return o+i}function fk(t,e){Re(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+ns(~~(n/60),2)+e+ns(~~n%60,2)})}fk("Z",":");fk("ZZ","");ce("Z",Uv);ce("ZZ",Uv);Et(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=NE(Uv,t)});var P7=/([\+\-]|\d\d)/gi;function NE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(P7)||["-",0,0],o=+(i[1]*60)+et(i[2]),o===0?0:i[0]==="+"?o:-o)}function DE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ho(t)||vg(t)?t.valueOf():Bt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Q.updateOffset(n,!1),n):Bt(t).local()}function TR(t){return-Math.round(t._d.getTimezoneOffset())}Q.updateOffset=function(){};function O7(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=NE(Uv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=TR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?pk(this,mo(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:TR(this)}function A7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function H7(t){return this.utcOffset(0,t)}function N7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(TR(this),"m")),this}function D7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=NE(e6,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function k7(t){return this.isValid()?(t=t?Bt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function $7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function L7(){if(!Hr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return yE(t,this),t=ck(t),t._a?(e=t._isUTC?as(t._a):Bt(t._a),this._isDSTShifted=this.isValid()&&I7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function F7(){return this.isValid()?!this._isUTC:!1}function V7(){return this.isValid()?this._isUTC:!1}function gk(){return this.isValid()?this._isUTC&&this._offset===0:!1}var B7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,W7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function mo(t,e){var n=t,r=null,i,o,s;return Up(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Xs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=B7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:et(r[zo])*i,h:et(r[Hn])*i,m:et(r[ao])*i,s:et(r[Bs])*i,ms:et(ER(r[ru]*1e3))*i}):(r=W7.exec(t))?(i=r[1]==="-"?-1:1,n={y:cl(r[2],i),M:cl(r[3],i),w:cl(r[4],i),d:cl(r[5],i),h:cl(r[6],i),m:cl(r[7],i),s:cl(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=j7(Bt(n.from),Bt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Gv(n),Up(t)&&ht(t,"_locale")&&(o._locale=t._locale),Up(t)&&ht(t,"_isValid")&&(o._isValid=t._isValid),o}mo.fn=Gv.prototype;mo.invalid=x7;function cl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function cP(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function j7(t,e){var n;return t.isValid()&&e.isValid()?(e=DE(e,t),t.isBefore(e)?n=cP(t,e):(n=cP(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function mk(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(UD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=mo(n,r),pk(this,i,t),this}}function pk(t,e,n,r){var i=e._milliseconds,o=ER(e._days),s=ER(e._months);t.isValid()&&(r=r??!0,s&&ek(t,Nf(t,"Month")+s*n),o&&JD(t,"Date",Nf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Q.updateOffset(t,o||s))}var U7=mk(1,"add"),z7=mk(-1,"subtract");function wk(t){return typeof t=="string"||t instanceof String}function Y7(t){return ho(t)||vg(t)||wk(t)||Xs(t)||K7(t)||G7(t)||t===null||t===void 0}function G7(t){var e=cu(t)&&!wE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||ht(t,o);return e&&n}function K7(t){var e=co(t),n=!1;return e&&(n=t.filter(function(r){return!Xs(r)&&wk(t)}).length===0),e&&n}function q7(t){var e=cu(t)&&!wE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||ht(t,o);return e&&n}function X7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function J7(t,e){arguments.length===1&&(arguments[0]?Y7(arguments[0])?(t=arguments[0],e=void 0):q7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Bt(),r=DE(n,this).startOf("day"),i=Q.calendarFormat(this,r)||"sameElse",o=e&&(ls(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Bt(n)))}function Z7(){return new yg(this)}function Q7(t,e){var n=ho(t)?t:Bt(t);return this.isValid()&&n.isValid()?(e=Di(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function e9(t,e){var n=ho(t)?t:Bt(t);return this.isValid()&&n.isValid()?(e=Di(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function t9(t,e,n,r){var i=ho(t)?t:Bt(t),o=ho(e)?e:Bt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function n9(t,e){var n=ho(t)?t:Bt(t),r;return this.isValid()&&n.isValid()?(e=Di(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function r9(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function i9(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function o9(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=DE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Di(e),e){case"year":o=zp(this,r)/12;break;case"month":o=zp(this,r);break;case"quarter":o=zp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Ei(o)}function zp(t,e){if(t.date()<e.date())return-zp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function s9(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function a9(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?jp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ls(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",jp(n,"Z")):jp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function l9(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function u9(t){t||(t=this.isUtc()?Q.defaultFormatUtc:Q.defaultFormat);var e=jp(this,t);return this.localeData().postformat(e)}function c9(t,e){return this.isValid()&&(ho(t)&&t.isValid()||Bt(t).isValid())?mo({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function h9(t){return this.from(Bt(),t)}function d9(t,e){return this.isValid()&&(ho(t)&&t.isValid()||Bt(t).isValid())?mo({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function f9(t){return this.to(Bt(),t)}function vk(t){var e;return t===void 0?this._locale._abbr:(e=na(t),e!=null&&(this._locale=e),this)}var yk=Ni("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function Ck(){return this._locale}var Aw=1e3,Gc=60*Aw,Hw=60*Gc,bk=(365*400+97)*24*Hw;function Kc(t,e){return(t%e+e)%e}function Sk(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-bk:new Date(t,e,n).valueOf()}function Rk(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-bk:Date.UTC(t,e,n)}function g9(t){var e,n;if(t=Di(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Rk:Sk,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Kc(e+(this._isUTC?0:this.utcOffset()*Gc),Hw);break;case"minute":e=this._d.valueOf(),e-=Kc(e,Gc);break;case"second":e=this._d.valueOf(),e-=Kc(e,Aw);break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function m9(t){var e,n;if(t=Di(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Rk:Sk,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Hw-Kc(e+(this._isUTC?0:this.utcOffset()*Gc),Hw)-1;break;case"minute":e=this._d.valueOf(),e+=Gc-Kc(e,Gc)-1;break;case"second":e=this._d.valueOf(),e+=Aw-Kc(e,Aw)-1;break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function p9(){return this._d.valueOf()-(this._offset||0)*6e4}function w9(){return Math.floor(this.valueOf()/1e3)}function v9(){return new Date(this.valueOf())}function y9(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function C9(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function b9(){return this.isValid()?this.toISOString():null}function S9(){return vE(this)}function R9(){return $a({},$e(this))}function E9(){return $e(this).overflow}function T9(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Re("N",0,0,"eraAbbr");Re("NN",0,0,"eraAbbr");Re("NNN",0,0,"eraAbbr");Re("NNNN",0,0,"eraName");Re("NNNNN",0,0,"eraNarrow");Re("y",["y",1],"yo","eraYear");Re("y",["yy",2],0,"eraYear");Re("y",["yyy",3],0,"eraYear");Re("y",["yyyy",4],0,"eraYear");ce("N",kE);ce("NN",kE);ce("NNN",kE);ce("NNNN",k9);ce("NNNNN",$9);Et(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?$e(n).era=i:$e(n).invalidEra=t});ce("y",Rh);ce("yy",Rh);ce("yyy",Rh);ce("yyyy",Rh);ce("yo",L9);Et(["y","yy","yyy","yyyy"],rr);Et(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[rr]=n._locale.eraYearOrdinalParse(t,i):e[rr]=parseInt(t,10)});function M9(t,e){var n,r,i,o=this._eras||na("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Q(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Q(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function _9(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function x9(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Q(t.since).year():Q(t.since).year()+(e-t.offset)*n}function I9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function P9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function O9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function A9(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Q(i[t].since).year())*n+i[t].offset;return this.year()}function H9(t){return ht(this,"_erasNameRegex")||$E.call(this),t?this._erasNameRegex:this._erasRegex}function N9(t){return ht(this,"_erasAbbrRegex")||$E.call(this),t?this._erasAbbrRegex:this._erasRegex}function D9(t){return ht(this,"_erasNarrowRegex")||$E.call(this),t?this._erasNarrowRegex:this._erasRegex}function kE(t,e){return e.erasAbbrRegex(t)}function k9(t,e){return e.erasNameRegex(t)}function $9(t,e){return e.erasNarrowRegex(t)}function L9(t,e){return e._eraYearOrdinalRegex||Rh}function $E(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Ks(u[i].name),a=Ks(u[i].abbr),l=Ks(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Re(0,["gg",2],0,function(){return this.weekYear()%100});Re(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Kv(t,e){Re(0,[t,t.length],0,e)}Kv("gggg","weekYear");Kv("ggggg","weekYear");Kv("GGGG","isoWeekYear");Kv("GGGGG","isoWeekYear");ce("G",jv);ce("g",jv);ce("GG",Wt,ui);ce("gg",Wt,ui);ce("GGGG",EE,RE);ce("gggg",EE,RE);ce("GGGGG",Wv,Vv);ce("ggggg",Wv,Vv);bg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=et(t)});bg(["gg","GG"],function(t,e,n,r){e[r]=Q.parseTwoDigitYear(t)});function F9(t){return Ek.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function V9(t){return Ek.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function B9(){return qs(this.year(),1,4)}function W9(){return qs(this.isoWeekYear(),1,4)}function j9(){var t=this.localeData()._week;return qs(this.year(),t.dow,t.doy)}function U9(){var t=this.localeData()._week;return qs(this.weekYear(),t.dow,t.doy)}function Ek(t,e,n,r,i){var o;return t==null?kf(this,r,i).year:(o=qs(t,r,i),e>o&&(e=o),z9.call(this,t,e,n,r,i))}function z9(t,e,n,r,i){var o=rk(t,e,n,r,i),s=Df(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Re("Q",0,"Qo","quarter");ce("Q",YD);Et("Q",function(t,e){e[Vs]=(et(t)-1)*3});function Y9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Re("D",["DD",2],"Do","date");ce("D",Wt,Eh);ce("DD",Wt,ui);ce("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Et(["D","DD"],zo);Et("Do",function(t,e){e[zo]=et(t.match(Wt)[0])});var Tk=Th("Date",!0);Re("DDD",["DDDD",3],"DDDo","dayOfYear");ce("DDD",Bv);ce("DDDD",GD);Et(["DDD","DDDD"],function(t,e,n){n._dayOfYear=et(t)});function G9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Re("m",["mm",2],0,"minute");ce("m",Wt,TE);ce("mm",Wt,ui);Et(["m","mm"],ao);var K9=Th("Minutes",!1);Re("s",["ss",2],0,"second");ce("s",Wt,TE);ce("ss",Wt,ui);Et(["s","ss"],Bs);var q9=Th("Seconds",!1);Re("S",0,0,function(){return~~(this.millisecond()/100)});Re(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Re(0,["SSS",3],0,"millisecond");Re(0,["SSSS",4],0,function(){return this.millisecond()*10});Re(0,["SSSSS",5],0,function(){return this.millisecond()*100});Re(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Re(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Re(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Re(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ce("S",Bv,YD);ce("SS",Bv,ui);ce("SSS",Bv,GD);var La,Mk;for(La="SSSS";La.length<=9;La+="S")ce(La,Rh);function X9(t,e){e[ru]=et(("0."+t)*1e3)}for(La="S";La.length<=9;La+="S")Et(La,X9);Mk=Th("Milliseconds",!1);Re("z",0,0,"zoneAbbr");Re("zz",0,0,"zoneName");function J9(){return this._isUTC?"UTC":""}function Z9(){return this._isUTC?"Coordinated Universal Time":""}var ne=yg.prototype;ne.add=U7;ne.calendar=J7;ne.clone=Z7;ne.diff=o9;ne.endOf=m9;ne.format=u9;ne.from=c9;ne.fromNow=h9;ne.to=d9;ne.toNow=f9;ne.get=l6;ne.invalidAt=E9;ne.isAfter=Q7;ne.isBefore=e9;ne.isBetween=t9;ne.isSame=n9;ne.isSameOrAfter=r9;ne.isSameOrBefore=i9;ne.isValid=S9;ne.lang=yk;ne.locale=vk;ne.localeData=Ck;ne.max=S7;ne.min=b7;ne.parsingFlags=R9;ne.set=u6;ne.startOf=g9;ne.subtract=z7;ne.toArray=y9;ne.toObject=C9;ne.toDate=v9;ne.toISOString=a9;ne.inspect=l9;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=b9;ne.toString=s9;ne.unix=w9;ne.valueOf=p9;ne.creationData=T9;ne.eraName=I9;ne.eraNarrow=P9;ne.eraAbbr=O9;ne.eraYear=A9;ne.year=XD;ne.isLeapYear=a6;ne.weekYear=F9;ne.isoWeekYear=V9;ne.quarter=ne.quarters=Y9;ne.month=tk;ne.daysInMonth=v6;ne.week=ne.weeks=M6;ne.isoWeek=ne.isoWeeks=_6;ne.weeksInYear=j9;ne.weeksInWeekYear=U9;ne.isoWeeksInYear=B9;ne.isoWeeksInISOWeekYear=W9;ne.date=Tk;ne.day=ne.days=V6;ne.weekday=B6;ne.isoWeekday=W6;ne.dayOfYear=G9;ne.hour=ne.hours=q6;ne.minute=ne.minutes=K9;ne.second=ne.seconds=q9;ne.millisecond=ne.milliseconds=Mk;ne.utcOffset=O7;ne.utc=H7;ne.local=N7;ne.parseZone=D7;ne.hasAlignedHourOffset=k7;ne.isDST=$7;ne.isLocal=F7;ne.isUtcOffset=V7;ne.isUtc=gk;ne.isUTC=gk;ne.zoneAbbr=J9;ne.zoneName=Z9;ne.dates=Ni("dates accessor is deprecated. Use date instead.",Tk);ne.months=Ni("months accessor is deprecated. Use month instead",tk);ne.years=Ni("years accessor is deprecated. Use year instead",XD);ne.zone=Ni("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",A7);ne.isDSTShifted=Ni("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",L7);function Q9(t){return Bt(t*1e3)}function e8(){return Bt.apply(null,arguments).parseZone()}function _k(t){return t}var dt=CE.prototype;dt.calendar=FX;dt.longDateFormat=jX;dt.invalidDate=zX;dt.ordinal=KX;dt.preparse=_k;dt.postformat=_k;dt.relativeTime=XX;dt.pastFuture=JX;dt.set=$X;dt.eras=M9;dt.erasParse=_9;dt.erasConvertYear=x9;dt.erasAbbrRegex=N9;dt.erasNameRegex=H9;dt.erasNarrowRegex=D9;dt.months=g6;dt.monthsShort=m6;dt.monthsParse=w6;dt.monthsRegex=C6;dt.monthsShortRegex=y6;dt.week=S6;dt.firstDayOfYear=T6;dt.firstDayOfWeek=E6;dt.weekdays=D6;dt.weekdaysMin=$6;dt.weekdaysShort=k6;dt.weekdaysParse=F6;dt.weekdaysRegex=j6;dt.weekdaysShortRegex=U6;dt.weekdaysMinRegex=z6;dt.isPM=G6;dt.meridiem=X6;function Nw(t,e,n,r){var i=na(),o=as().set(r,e);return i[n](o,t)}function xk(t,e,n){if(Xs(t)&&(e=t,t=void 0),t=t||"",e!=null)return Nw(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Nw(t,r,n,"month");return i}function LE(t,e,n,r){typeof t=="boolean"?(Xs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Xs(e)&&(n=e,e=void 0),e=e||"");var i=na(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Nw(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Nw(e,(s+o)%7,r,"day");return a}function t8(t,e){return xk(t,e,"months")}function n8(t,e){return xk(t,e,"monthsShort")}function r8(t,e,n){return LE(t,e,n,"weekdays")}function i8(t,e,n){return LE(t,e,n,"weekdaysShort")}function o8(t,e,n){return LE(t,e,n,"weekdaysMin")}Ua("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=et(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Q.lang=Ni("moment.lang is deprecated. Use moment.locale instead.",Ua);Q.langData=Ni("moment.langData is deprecated. Use moment.localeData instead.",na);var fs=Math.abs;function s8(){var t=this._data;return this._milliseconds=fs(this._milliseconds),this._days=fs(this._days),this._months=fs(this._months),t.milliseconds=fs(t.milliseconds),t.seconds=fs(t.seconds),t.minutes=fs(t.minutes),t.hours=fs(t.hours),t.months=fs(t.months),t.years=fs(t.years),this}function Ik(t,e,n,r){var i=mo(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function a8(t,e){return Ik(this,t,e,1)}function l8(t,e){return Ik(this,t,e,-1)}function hP(t){return t<0?Math.floor(t):Math.ceil(t)}function u8(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=hP(MR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Ei(t/1e3),r.seconds=i%60,o=Ei(i/60),r.minutes=o%60,s=Ei(o/60),r.hours=s%24,e+=Ei(s/24),l=Ei(Pk(e)),n+=l,e-=hP(MR(l)),a=Ei(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function Pk(t){return t*4800/146097}function MR(t){return t*146097/4800}function c8(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Di(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+Pk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(MR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function ra(t){return function(){return this.as(t)}}var Ok=ra("ms"),h8=ra("s"),d8=ra("m"),f8=ra("h"),g8=ra("d"),m8=ra("w"),p8=ra("M"),w8=ra("Q"),v8=ra("y"),y8=Ok;function C8(){return mo(this)}function b8(t){return t=Di(t),this.isValid()?this[t+"s"]():NaN}function Hu(t){return function(){return this.isValid()?this._data[t]:NaN}}var S8=Hu("milliseconds"),R8=Hu("seconds"),E8=Hu("minutes"),T8=Hu("hours"),M8=Hu("days"),_8=Hu("months"),x8=Hu("years");function I8(){return Ei(this.days()/7)}var As=Math.round,$c={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function P8(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function O8(t,e,n,r){var i=mo(t).abs(),o=As(i.as("s")),s=As(i.as("m")),a=As(i.as("h")),l=As(i.as("d")),u=As(i.as("M")),c=As(i.as("w")),h=As(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,P8.apply(null,d)}function A8(t){return t===void 0?As:typeof t=="function"?(As=t,!0):!1}function H8(t,e){return $c[t]===void 0?!1:e===void 0?$c[t]:($c[t]=e,t==="s"&&($c.ss=e-1),!0)}function N8(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=$c,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},$c,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=O8(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var _C=Math.abs;function Wu(t){return(t>0)-(t<0)||+t}function qv(){if(!this.isValid())return this.localeData().invalidDate();var t=_C(this._milliseconds)/1e3,e=_C(this._days),n=_C(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Ei(t/60),i=Ei(r/60),t%=60,r%=60,o=Ei(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Wu(this._months)!==Wu(a)?"-":"",c=Wu(this._days)!==Wu(a)?"-":"",h=Wu(this._milliseconds)!==Wu(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var ot=Gv.prototype;ot.isValid=_7;ot.abs=s8;ot.add=a8;ot.subtract=l8;ot.as=c8;ot.asMilliseconds=Ok;ot.asSeconds=h8;ot.asMinutes=d8;ot.asHours=f8;ot.asDays=g8;ot.asWeeks=m8;ot.asMonths=p8;ot.asQuarters=w8;ot.asYears=v8;ot.valueOf=y8;ot._bubble=u8;ot.clone=C8;ot.get=b8;ot.milliseconds=S8;ot.seconds=R8;ot.minutes=E8;ot.hours=T8;ot.days=M8;ot.weeks=I8;ot.months=_8;ot.years=x8;ot.humanize=N8;ot.toISOString=qv;ot.toString=qv;ot.toJSON=qv;ot.locale=vk;ot.localeData=Ck;ot.toIsoString=Ni("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",qv);ot.lang=yk;Re("X",0,0,"unix");Re("x",0,0,"valueOf");ce("x",jv);ce("X",t6);Et("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});Et("x",function(t,e,n){n._d=new Date(et(t))});//! moment.js
Q.version="2.30.1";DX(Bt);Q.fn=ne;Q.min=R7;Q.max=E7;Q.now=T7;Q.utc=as;Q.unix=Q9;Q.months=t8;Q.isDate=vg;Q.locale=Ua;Q.invalid=Fv;Q.duration=mo;Q.isMoment=ho;Q.weekdays=r8;Q.parseZone=e8;Q.localeData=na;Q.isDuration=Up;Q.monthsShort=n8;Q.weekdaysMin=o8;Q.defineLocale=PE;Q.updateLocale=e7;Q.locales=t7;Q.weekdaysShort=i8;Q.normalizeUnits=Di;Q.relativeTimeRounding=A8;Q.relativeTimeThreshold=H8;Q.calendarFormat=X7;Q.prototype=ne;Q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function Ak(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function _R(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function tf(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function In(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Xa(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Je(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function x(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function Hk(t){return In(t,(e,n)=>e+n,0)}function D8(t){return In(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function k8(t){return In(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function $8(t){return t.length?Hk(t)/t.length:0}function Nk(t){return In(t,(e,n)=>e.concat(Array.isArray(n)?Nk(n):n),[])}function Dk(t){const e=[];return x(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function xR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return x(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function L8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return x(i,s=>{o=o.filter(a=>s.includes(a))}),o}function F8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return x(i,s=>{x(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function IR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const V8=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:$8,arrayEach:x,arrayFilter:Xa,arrayFlatten:Nk,arrayMap:Je,arrayMax:D8,arrayMin:k8,arrayReduce:In,arraySum:Hk,arrayUnique:Dk,extendArray:_R,getDifferenceOfArrays:xR,getIntersectionOfArrays:L8,getUnionOfArrays:F8,pivot:tf,stringToArray:IR,to2dArray:Ak},Symbol.toStringTag,{value:"Module"}));function wt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return In(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function At(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function Vt(t){return typeof t>"u"}function en(t){return t===null||t===""||Vt(t)}function kk(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const zd="length",nf=t=>parseInt(t,16),dP=t=>parseInt(t,10),Dw=(t,e,n)=>t.substr(e,n),rf=t=>t.codePointAt(0)-65,PR=t=>`${t}`.replace(/\-/g,""),B8=t=>nf(Dw(PR(t),nf("12"),rf("F")))/(nf(Dw(PR(t),rf("B"),~~![][zd]))||9),W8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let fP=!1;const gP={invalid:()=>wt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return wt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>wt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},mP={invalid:()=>wt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return wt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>wt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function $k(t,e){const n=!en(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=PR(t||"");const l=j8(t);if(n||r||l)if(l){const u=Q("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=B8(t);o=Q((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(W8()&&(s="valid",a="valid"),!fP&&s!=="valid"&&(gP[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](gP[s]({keyValidityDate:o,hotVersion:i})),fP=!0),a!=="valid"&&e.parentNode&&mP[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=mP[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function j8(t){let e=[][zd],n=e;if(t[zd]!==rf("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=rf(i.shift());o;o=rf(i.shift()||"A"))--o<""[zd]?n=n|(dP(`${dP(nf(r)+(nf(Dw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Dw(t,o,o?i[zd]===1?9:8:6);return n===e}const U8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:$k,isDefined:ue,isEmpty:en,isRegExp:kk,isUndefined:Vt,stringify:At},Symbol.toStringTag,{value:"Module"}));function or(t){return t[0].toUpperCase()+t.substr(1)}function z8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=At(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function FE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function VE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function BE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function OR(t){return Xv(`${t}`,{ALLOWED_TAGS:[]})}function Xv(t,e){return NX.sanitize(t,e)}const Y8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:z8,isPercentValue:VE,randomString:FE,sanitize:Xv,stripTags:OR,substitute:BE,toUpperCaseFirst:or},Symbol.toStringTag,{value:"Module"})),Nu=t=>["tabindex",t],G8=()=>["role","treegrid"],Ws=()=>["role","presentation"],K8=()=>["role","gridcell"],q8=()=>["role","rowheader"],Lk=()=>["role","rowgroup"],X8=()=>["role","columnheader"],AR=()=>["role","row"],J8=()=>["role","menu"],Z8=()=>["role","menuitem"],Q8=()=>["role","menuitemcheckbox"],eJ=()=>["role","combobox"],Fk=()=>["role","listbox"],tJ=()=>["role","option"],nJ=()=>["role","checkbox"],rJ=()=>["scope","col"],iJ=()=>["scope","row"],oJ=()=>["type","text"],Lf=t=>["aria-label",t],Du=()=>["aria-hidden","true"],sJ=()=>["aria-disabled","true"],aJ=()=>["aria-multiselectable","true"],Vk=t=>["aria-haspopup",t],Bk=t=>["aria-rowcount",t],Jv=t=>["aria-colcount",t],Wk=t=>["aria-rowindex",t],WE=t=>["aria-colindex",t],_i=t=>["aria-expanded",t],lJ=t=>["aria-sort",t],pP=()=>["aria-readonly","true"],wP=()=>["aria-invalid","true"],jk=t=>["aria-checked",t],jE=()=>["aria-selected","true"],uJ=()=>["aria-autocomplete","list"],cJ=t=>["aria-controls",t],hJ=t=>["aria-activedescendant",t],dJ=t=>["aria-live",t],fJ=t=>["aria-relevant",t],gJ=t=>["aria-setsize",t],mJ=t=>["aria-posinset",t];function Uk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function of(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function zk(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function wu(t){return zk(t)&&t.parent}function pJ(t){return!!Object.getPrototypeOf(t.parent)}function Ja(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Yd(t,e,n){const r=[];let i=t;for(;i&&(i=Ja(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Yk(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function za(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Gk(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Ra(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Kk(t){return!t||!t.length?[]:t.filter(e=>!!e)}function qk(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function be(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=Kk(e),e.length>0&&t.classList.add(...e)}function ye(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=qk(e,!0);n=Kk(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function ku(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=qk(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function UE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)UE(e[n])}}function rs(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Xk=/(<(.*)>|&(.*);)/;function $u(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Xk.test(e)?t.innerHTML=n?Xv(e):e:Za(t,e)}function Za(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(rs(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function vu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return vu(r.host.impl);if(r.host)return vu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function Jk(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function zn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function zE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Zv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Qv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?zE(e):t.scrollTop}function YE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Zv(e):t.scrollLeft}function Ff(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Zk(t){return t.scrollHeight-t.clientHeight}function Qk(t){return t.scrollWidth-t.clientWidth}function sh(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Vf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function wJ(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function ln(t){return t.offsetWidth}function mn(t){return t.offsetHeight}function qc(t){return t.clientHeight||t.innerHeight}function GE(t){return t.clientWidth||t.innerWidth}function vJ(t,e,n){t.addEventListener(e,n,!1)}function yJ(t,e,n){t.removeEventListener(e,n,!1)}function KE(t){return t.selectionStart?t.selectionStart:0}function e$(t){return t.selectionEnd?t.selectionEnd:0}function CJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function HR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Sg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let xC;function bJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Nn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return xC===void 0&&(xC=bJ(t)),xC}function qE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function XE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function ey(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function SJ(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Rg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function sf(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function ty(t){return sf(t)&&t.hasAttribute("data-hot-input")===!1}function RJ(t){const e=t.ownerDocument.activeElement;ty(e)||t.select()}function JE(t){return!t.parentNode}function t$(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function ZE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ee(t,"contenteditable",!0),n&&Ee(t,...Du()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function QE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ye(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function n$(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;ZE(t,n),e(),QE(t,n)}function Qo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const EJ=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Xk,addClass:X,addEvent:vJ,clearTextSelection:HR,closest:Ja,closestDown:Yd,empty:rs,fastInnerHTML:$u,fastInnerText:Za,findFirstParentWithClass:Yk,getCaretPosition:KE,getCssTransform:SJ,getFrameElement:zk,getMaximumScrollLeft:Qk,getMaximumScrollTop:Zk,getParent:Uk,getParentWindow:wu,getScrollLeft:YE,getScrollTop:Qv,getScrollableElement:Ff,getScrollbarWidth:Nn,getSelectionEndPosition:e$,getSelectionText:CJ,getStyle:Vf,getTrimmingContainer:sh,getWindowScrollLeft:Zv,getWindowScrollTop:zE,hasAccessToParentWindow:pJ,hasClass:be,hasHorizontalScrollbar:XE,hasVerticalScrollbar:qE,hasZeroHeight:Jk,index:Gk,innerHeight:qc,innerWidth:GE,isChildOf:za,isDetached:JE,isHTMLElement:Qo,isInput:sf,isInternalElement:of,isOutsideInput:ty,isVisible:vu,makeElementContentEditableAndSelectItsContent:ZE,matchesCSSRules:wJ,observeVisibilityChangeOnce:t$,offset:zn,outerHeight:mn,outerWidth:ln,overlayContainsElement:Ra,removeAttribute:ku,removeClass:ye,removeContentEditableFromElementAndDeselect:QE,removeEvent:yJ,removeTextNodes:UE,resetCssTransform:Rg,runWithSelectedContendEditableElement:n$,selectElementIfAllowed:RJ,setAttribute:Ee,setCaretPosition:Sg,setOverlayPosition:ey},Symbol.toStringTag,{value:"Module"}));function mt(t){return typeof t=="function"}function r$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function TJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=r$(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function Eg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function MJ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return In(i,(u,c)=>c(u),r.apply(this,a))}}function eT(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function i$(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function _J(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function kw(t,e,n,r,i,o,s,a){return ue(a)?t.call(e,n,r,i,o,s,a):ue(s)?t.call(e,n,r,i,o,s):ue(o)?t.call(e,n,r,i,o):ue(i)?t.call(e,n,r,i):ue(r)?t.call(e,n,r):ue(n)?t.call(e,n):t.call(e)}const xJ=Object.freeze(Object.defineProperty({__proto__:null,curry:i$,curryRight:_J,debounce:Eg,fastCall:kw,isFunction:mt,partial:eT,pipe:MJ,throttle:r$,throttleAfterHits:TJ},Symbol.toStringTag,{value:"Module"}));var IJ=vn,vP=qN,PJ=_n,yP=_u,OJ=Lv,CP=IJ([].push),AJ=function(t){if(PJ(t))return t;if(vP(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?CP(n,i):(typeof i=="number"||yP(i)==="Number"||yP(i)==="String")&&CP(n,OJ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(vP(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},HJ=Mt,o$=vh,s$=mg,NJ=Mn,Tg=vn,a$=Vn,bP=_n,SP=Z0,l$=mE,DJ=AJ,kJ=J0,$J=String,Ya=o$("JSON","stringify"),om=Tg(/./.exec),RP=Tg("".charAt),LJ=Tg("".charCodeAt),FJ=Tg("".replace),VJ=Tg(1 .toString),BJ=/[\uD800-\uDFFF]/g,EP=/^[\uD800-\uDBFF]$/,TP=/^[\uDC00-\uDFFF]$/,MP=!kJ||a$(function(){var t=o$("Symbol")("stringify detection");return Ya([t])!=="[null]"||Ya({a:t})!=="{}"||Ya(Object(t))!=="{}"}),_P=a$(function(){return Ya("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ya("\uDEAD")!=='"\\udead"'}),WJ=function(t,e){var n=l$(arguments),r=DJ(e);if(!(!bP(r)&&(t===void 0||SP(t))))return n[1]=function(i,o){if(bP(r)&&(o=NJ(r,this,$J(i),o)),!SP(o))return o},s$(Ya,null,n)},jJ=function(t,e,n){var r=RP(n,e-1),i=RP(n,e+1);return om(EP,t)&&!om(TP,i)||om(TP,t)&&!om(EP,r)?"\\u"+VJ(LJ(t,0),16):t};Ya&&HJ({target:"JSON",stat:!0,arity:3,forced:MP||_P},{stringify:function(e,n,r){var i=l$(arguments),o=s$(MP?WJ:Ya,null,i);return _P&&typeof o=="string"?FJ(o,BJ,jJ):o}});function ah(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Fe(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=ah(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[ah(n[0])]:e[r]=[]:e[r]=null)})),e}function u$(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function pn(t,e,n){const r=Array.isArray(n);return Fe(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Mg(t,e){Fe(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Mg(t[r],e[r])):t[r]=e[r]})}function sr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function fo(t){const e={};return Fe(t,(n,r)=>{e[r]=n}),e}function bt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return x(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Fe(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let p=g;return(Array.isArray(p)||Le(p))&&(p=sr(p)),p};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function ny(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Le(t){return Object.prototype.toString.call(t)==="[object Object]"}function us(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Fe(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function c$(t,e){const n=e.split(".");let r=t;return Fe(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Yp(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(fn(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function ry(t){if(!Le(t))return 0;const e=function(n){let r=0;return Le(n)?Fe(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Br(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function fn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const UJ=Object.freeze(Object.defineProperty({__proto__:null,clone:fo,createObjectPropListener:Br,deepClone:sr,deepExtend:Mg,deepObjectSize:ry,defineGetter:us,duckSchema:ah,extend:pn,getProperty:c$,hasOwnProperty:fn,inherit:u$,isObject:Le,isObjectEqual:ny,mixin:bt,objectEach:Fe,setProperty:Yp},Symbol.toStringTag,{value:"Module"}));function Bf(t){return window.requestAnimationFrame(t)}function Wf(t){window.cancelAnimationFrame(t)}function tT(){return"ontouchstart"in window}function h$(){return typeof window<"u"}let ju;function d$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ju||(typeof Intl=="object"?ju=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?ju=(n,r)=>`${n}`.localeCompare(r):ju=(n,r)=>n===r?0:n>r?-1:1,ju)}const zJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Wf,getComparisonFunction:d$,isCSR:h$,isTouchSupported:tT,requestAnimationFrame:Bf},Symbol.toStringTag,{value:"Module"})),yi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},ia={chrome:yi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:yi(t=>/CriOS/.test(t)),edge:yi(t=>/Edge/.test(t)),edgeWebKit:yi(t=>/EdgiOS/.test(t)),firefox:yi(t=>/Firefox/.test(t)),firefoxWebKit:yi(t=>/FxiOS/.test(t)),mobile:yi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:yi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Mh={mac:yi(t=>/^Mac/.test(t)),win:yi(t=>/^Win/.test(t)),linux:yi(t=>/^Linux/.test(t)),ios:yi(t=>/iPhone|iPad|iPod/i.test(t))};function f$(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fe(ia,n=>{let{test:r}=n;return void r(t,e)})}function g$(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fe(Mh,e=>{let{test:n}=e;return void n(t)})}h$()&&(f$(),g$());function nT(){return ia.chrome.value}function m$(){return ia.chromeWebKit.value}function Gp(){return ia.firefox.value}function p$(){return ia.firefoxWebKit.value}function jf(){return ia.safari.value}function w$(){return ia.edge.value}function YJ(){return ia.edgeWebKit.value}function Jo(){return ia.mobile.value}function rT(){return Mh.ios.value}function iT(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Mh.mac.value}function NR(){return Mh.win.value}function $w(){return Mh.mac.value}function GJ(){return Mh.linux.value}const KJ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:nT,isChromeWebKit:m$,isEdge:w$,isEdgeWebKit:YJ,isFirefox:Gp,isFirefoxWebKit:p$,isIOS:rT,isIpadOS:iT,isLinuxOS:GJ,isMacOS:$w,isMobileBrowser:Jo,isSafari:jf,isWindowsOS:NR,setBrowserMeta:f$,setPlatformMeta:g$},Symbol.toStringTag,{value:"Module"})),ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Gp()?182:174,AUDIO_MUTE:Gp()?181:173,AUDIO_UP:Gp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},qJ=[ge.ALT,ge.ARROW_DOWN,ge.ARROW_LEFT,ge.ARROW_RIGHT,ge.ARROW_UP,ge.AUDIO_DOWN,ge.AUDIO_MUTE,ge.AUDIO_UP,ge.BACKSPACE,ge.CAPS_LOCK,ge.DELETE,ge.END,ge.ENTER,ge.ESCAPE,ge.F1,ge.F2,ge.F3,ge.F4,ge.F5,ge.F6,ge.F7,ge.F8,ge.F9,ge.F10,ge.F11,ge.F12,ge.F13,ge.F14,ge.F15,ge.F16,ge.F17,ge.F18,ge.F19,ge.HOME,ge.INSERT,ge.MEDIA_NEXT,ge.MEDIA_PLAY_PAUSE,ge.MEDIA_PREV,ge.MEDIA_STOP,ge.NULL,ge.NUM_LOCK,ge.PAGE_DOWN,ge.PAGE_UP,ge.PAUSE,ge.SCROLL_LOCK,ge.SHIFT,ge.TAB];function v$(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function oT(t){return qJ.includes(t)}function XJ(t){const e=[];return $w()?e.push(ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX):e.push(ge.CONTROL),e.includes(t)}function y$(t){return[ge.CONTROL,ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX].includes(t)}function _h(t,e){const n=e.split("|");let r=!1;return x(n,i=>{if(t===ge[i])return r=!0,!1}),r}const JJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ge,isCtrlKey:XJ,isCtrlMetaKey:y$,isFunctionKey:oT,isKey:_h,isPrintableChar:v$},Symbol.toStringTag,{value:"Module"}));function ki(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Oa(t){return t.isImmediatePropagationEnabled===!1}function Qa(t){return t.button===2}function iy(t){return t.button===0}function C$(t){return t instanceof TouchEvent}function b$(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!Qo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const ZJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Oa,isLeftClick:iy,isRightClick:Qa,isTouchEvent:C$,offsetRelativeTo:b$,stopImmediatePropagation:ki},Symbol.toStringTag,{value:"Module"}));function ut(){ue(console)&&console.warn(...arguments)}function sT(){ue(console)&&console.error(...arguments)}const eu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],IC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),PC=new Map([[]]);var QJ=bh,eZ=function(t,e,n){for(var r=0,i=arguments.length>2?n:QJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},tZ=Tn,nZ=function(t,e){var n=tZ[t],r=n&&n.prototype;return r&&r[e]},rZ=go,iZ=gD,oZ=ta.f,DR=rZ("unscopables"),kR=Array.prototype;kR[DR]===void 0&&oZ(kR,DR,{configurable:!0,value:iZ(null)});var oy=function(t){kR[DR][t]=!0},sZ=Mt,aZ=vn,lZ=jr,uZ=cg,cZ=eZ,hZ=nZ,dZ=oy,fZ=Array,gZ=aZ(hZ("Array","sort"));sZ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&lZ(e);var n=uZ(this),r=cZ(fZ,n);return gZ(r,e)}});dZ("toSorted");var mZ=Mt,pZ=Mn,wZ=Sh,vZ=jr,yZ=xn,CZ=ss,bZ=li,SZ=rl,OC=SZ("find",TypeError);mZ({target:"Iterator",proto:!0,real:!0,forced:OC},{find:function(e){yZ(this);try{vZ(e)}catch(i){bZ(this,"throw",i)}if(OC)return pZ(OC,this,e);var n=CZ(this),r=0;return wZ(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function RZ(t,e){S$(t,e),e.add(t)}function AC(t,e,n){S$(t,e),e.set(t,n)}function S$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xP(t,e,n){return t.set(Lw(t,e),n),n}function jn(t,e){return t.get(Lw(t,e))}function Lw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const EZ=100;var Kr=new WeakMap,_c=new WeakMap,HC=new WeakMap,NC=new WeakSet;class IP{constructor(){RZ(this,NC),AC(this,Kr,new Map),AC(this,_c,new Map),AC(this,HC,new Set),eu.forEach(e=>Lw(NC,this,PP).call(this,e))}getHooks(e){var n;return(n=jn(Kr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};jn(Kr,this).has(e)||(Lw(NC,this,PP).call(this,e),eu.push(e));const i=jn(Kr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=jn(HC,this).has(e);!u&&o!==0&&(u=!0,jn(HC,this).add(e)),u&&i.length>1&&jn(Kr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return jn(Kr,this).has(e)&&jn(Kr,this).get(e).length>0}remove(e,n){if(!jn(Kr,this).has(e))return!1;const r=jn(Kr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=jn(_c,this).get(e);return i.skip=!0,o+=1,o>EZ&&(jn(Kr,this).set(e,r.filter(s=>!s.skip)),o=0),jn(_c,this).set(e,o),!0}return!1}destroy(){jn(Kr,this).clear(),jn(_c,this).clear(),xP(Kr,this,null),xP(_c,this,null)}}function PP(t){jn(Kr,this).set(t,[]),jn(_c,this).set(t,0)}function TZ(t,e,n){return(e=MZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MZ(t){var e=_Z(t,"string");return typeof e=="symbol"?e:e+""}function _Z(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xZ=wt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class se{constructor(){TZ(this,"globalBucket",new IP)}static getSingleton(){return PZ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new IP),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?x(n,o=>this.add(e,o,r)):(IC.has(e)&&ut(BE(xZ,{hookName:e,removedInVersion:IC.get(e)})),PC.has(e)&&ut(PC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?x(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?x(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=kw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=kw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||eu.push(e)}deregister(e){this.isRegistered(e)&&eu.splice(eu.indexOf(e),1)}isDeprecated(e){return PC.has(e)||IC.has(e)}isRegistered(e){return eu.indexOf(e)>=0}getRegistered(){return eu}}const IZ=new se;function PZ(){return IZ}const DC=new Map;function po(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";DC.has(t)||DC.set(t,new Map);const e=DC.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const $R=new WeakMap,{register:OZ,getItem:R$,hasItem:E$,getNames:AZ,getValues:Q0e}=po("editors");function HZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},se.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function T$(t,e){let n;if(typeof t=="function")$R.get(t)||Nr(null,t),n=$R.get(t);else if(typeof t=="string")n=R$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Fw(t){if(typeof t=="function")return t;if(!E$(t))throw Error(`No registered editor found under "${t}" name`);return R$(t).getConstructor()}function Nr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new HZ(e);typeof t=="string"&&OZ(t,n),$R.set(e,n)}function NZ(t,e,n){return(e=DZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DZ(t){var e=kZ(t,"string");return typeof e=="symbol"?e:e+""}function kZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Kp=0;class Pi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;NZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,$Z(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Kp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Kp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Kp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function $Z(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ki(this)},t}function LZ(){return Kp}function FZ(t,e){VZ(t,e),e.add(t)}function VZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hl(t,e,n){return(e=BZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BZ(t){var e=WZ(t,"string");return typeof e=="symbol"?e:e+""}function WZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sm=new WeakSet;class LR{constructor(e,n,r){FZ(this,sm),hl(this,"hot",void 0),hl(this,"tableMeta",void 0),hl(this,"selection",void 0),hl(this,"eventManager",void 0),hl(this,"destroyed",!1),hl(this,"activeEditor",void 0),hl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Pi(e),this.hot.addHook("afterDocumentKeyDown",i=>kC(sm,this,OP).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>kC(sm,this,OP).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>kC(sm,this,jZ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=T$(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function OP(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Oa(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!oT(n)&&!y$(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function jZ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const AP=new WeakMap;LR.getInstance=function(t,e,n){let r=AP.get(t);return r||(r=new LR(t,e,n),AP.set(t,r)),r};function UZ(t,e){M$(t,e),e.add(t)}function Gh(t,e,n){M$(t,e),e.set(t,n)}function M$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(t,e){return t.get(ks(t,e))}function Kh(t,e,n){return t.set(ks(t,e),n),n}function ks(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xc=Object.freeze({CELL:"cell",MIXED:"mixed"});var En=new WeakMap,am=new WeakMap,lm=new WeakMap,um=new WeakMap,cm=new WeakMap,Ma=new WeakSet;class zZ{constructor(e){var n=this;UZ(this,Ma),Gh(this,En,void 0),Gh(this,am,void 0),Gh(this,lm,1),Gh(this,um,null),Gh(this,cm,new Map);const r=e.getSettings();Kh(En,this,e),Kh(am,this,r.imeFastEdit?Xc.MIXED:Xc.CELL),xt(En,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ks(Ma,n,GZ).call(n,...o)}),xt(En,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ks(Ma,n,HP).call(n,...o)}),xt(En,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ks(Ma,n,HP).call(n,...o)}),xt(En,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ks(Ma,n,YZ).call(n,...o)})}getFocusMode(){return xt(am,this)}setFocusMode(e){Object.values(Xc).includes(e)?Kh(am,this,e):ut(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return xt(lm,this)}setRefocusDelay(e){Kh(lm,this,e)}setRefocusElementGetter(e){Kh(um,this,e)}getRefocusElement(){var e;return typeof xt(um,this)=="function"?xt(um,this).call(this):(e=xt(En,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=xt(En,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=xt(En,this).runHooks("modifyFocusedElement",s.row,s.col,r);Qo(a)||(a=r),a&&!((o=xt(En,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):ks(Ma,this,aT).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xt(lm,this);if(xt(En,this).getSettings().imeFastEdit&&!((e=xt(En,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=xt(En,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),xt(cm,this).has(n)||xt(cm,this).set(n,Eg(()=>{if(!xt(En,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),xt(cm,this).get(n)()}}}function aT(t){var e;const n=(e=xt(En,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!xt(En,this).selection.isCellVisible(n)){t(null);return}const r=xt(En,this).getCell(n.row,n.col,!0);r===null?xt(En,this).addHookOnce("afterScroll",()=>{t(xt(En,this).getCell(n.row,n.col,!0))}):t(r)}function HP(){ks(Ma,this,aT).call(this,t=>{const{activeElement:e}=xt(En,this).rootDocument;e&&ty(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function YZ(){ks(Ma,this,aT).call(this,t=>{this.getFocusMode()===Xc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function GZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Xc.MIXED:Xc.CELL)}var KZ=Ai,qZ=_u,XZ=go,JZ=XZ("match"),ZZ=function(t){var e;return KZ(t)&&((e=t[JZ])!==void 0?!!e:qZ(t)==="RegExp")},QZ=xn,eQ=function(){var t=QZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},tQ=Mn,nQ=Hi,rQ=hg,iQ=eQ,NP=RegExp.prototype,oQ=function(t){var e=t.flags;return e===void 0&&!("flags"in NP)&&!nQ(t,"flags")&&rQ(NP,t)?tQ(iQ,t):e},lT=vn,sQ=yh,aQ=Math.floor,$C=lT("".charAt),lQ=lT("".replace),LC=lT("".slice),uQ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,cQ=/\$([$&'`]|\d{1,2})/g,hQ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=cQ;return i!==void 0&&(i=sQ(i),l=uQ),lQ(o,l,function(u,c){var h;switch($C(c,0)){case"$":return"$";case"&":return t;case"`":return LC(e,0,n);case"'":return LC(e,s);case"<":h=i[LC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=aQ(d/10);return f===0?u:f<=a?r[f-1]===void 0?$C(c,1):r[f-1]+$C(c,1):u}h=r[d-1]}return h===void 0?"":h})},dQ=Mt,fQ=Mn,uT=vn,DP=ug,gQ=_n,mQ=Ai,pQ=ZZ,qh=Lv,wQ=dg,vQ=oQ,yQ=hQ,CQ=go,bQ=CQ("replace"),SQ=TypeError,FC=uT("".indexOf);uT("".replace);var kP=uT("".slice),RQ=Math.max;dQ({target:"String",proto:!0},{replaceAll:function(e,n){var r=DP(this),i,o,s,a,l,u,c,h,d,f,g=0,p="";if(mQ(e)){if(i=pQ(e),i&&(o=qh(DP(vQ(e))),!~FC(o,"g")))throw new SQ("`.replaceAll` does not allow non-global regexes");if(s=wQ(e,bQ),s)return fQ(s,e,r,n)}for(a=qh(r),l=qh(e),u=gQ(n),u||(n=qh(n)),c=l.length,h=RQ(1,c),d=FC(a,l);d!==-1;)f=u?qh(n(l,d,a)):yQ(l,a,d,[],void 0,n),p+=kP(a,g,d)+f,g=d+c,d=d+h>a.length?-1:FC(a,l,d+h);return g<a.length&&(p+=kP(a,g)),p}});var EQ=Mt,TQ=Sh,MQ=jr,_Q=xn,xQ=ss,IQ=li,PQ=rl,OQ=mg,AQ=Vn,_$=TypeError,x$=AQ(function(){[].keys().reduce(function(){},void 0)}),VC=!x$&&PQ("reduce",_$);EQ({target:"Iterator",proto:!0,real:!0,forced:x$||VC},{reduce:function(e){_Q(this);try{MQ(e)}catch(s){IQ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(VC)return OQ(VC,this,n?[e]:[e,r]);var i=xQ(this),o=0;if(TQ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new _$("Reduce of empty iterator with no initial value");return r}});const I$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},HQ=new RegExp(Object.keys(I$).map(t=>`(${t})`).join("|"),"gi");function NQ(t){return(t&&t.nodeName||"")==="TABLE"}function FR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let C=0;C<s;C+=1){const E=!f&&n&&C===0;let y="";if(f)y=`<th>${t.getColHeader(C-c)}</th>`;else if(E)y=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][C],{hidden:_,rowspan:P,colspan:M}=t.getCellMeta(d-h,C-c);if(!_){const I=[];if(P&&I.push(`rowspan="${P}"`),M&&I.push(`colspan="${M}"`),en(T))y=`<td ${I.join(" ")}></td>`;else{const z=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y=`<td ${I.join(" ")}>${z}</td>`}}}g.push(y)}const p=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function VR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=en(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function P$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,_=>{const P=_.match(/<td\b[^>]*?>/g)[0],M=/<p.*?>/g,I=_.substring(P.length,_.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(M,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${I}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!NQ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,_)=>T+_.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(_=>{const P=_.querySelector("td")!==null;return P&&h.push(_),!P});f=T.length,d=f>0,f>1?n.nestedHeaders=Array.from(T).reduce((_,P)=>{const M=Array.from(P.cells).reduce((I,z,W)=>{if(a&&W===0)return I;const{colSpan:V,innerHTML:q}=z,Z=V>1?{label:q,colspan:V}:q;return I.push(Z),I},[]);return _.push(M),_},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((_,P,M)=>(a&&M===0||_.push(P.innerHTML),_),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const p=[...h,...Array.from(o.tBodies).reduce((T,_)=>(T.push(...Array.from(_.rows)),T),[]),...c];g=p.length;const C=new Array(g);for(let T=0;T<g;T++)C[T]=new Array(u);const E=[],y=[];for(let T=0;T<g;T++){const _=p[T],P=Array.from(_.cells),M=P.length;for(let I=0;I<M;I++){const z=P[I],{nodeName:W,innerHTML:V,rowSpan:q,colSpan:Z}=z,ee=C[T].findIndex(te=>te===void 0);if(W==="TD"){if(q>1||Z>1){for(let ve=T;ve<T+q;ve++)if(ve<g)for(let He=ee;He<ee+Z;He++)C[ve][He]=null;const he=z.getAttribute("style");he&&he.includes("mso-ignore:colspan")||E.push({col:ee,row:T,rowspan:q,colspan:Z})}let te="";s&&/excel/gi.test(s.content)?te=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[T][ee]=te.replace(HQ,he=>I$[he])}else y.push(V)}}return E.length&&(n.mergeCells=E),y.length&&(n.rowHeaders=y),C.length&&(n.data=C),n}const DQ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:VR,htmlToGridSettings:P$,instanceToHTML:FR},Symbol.toStringTag,{value:"Module"}));function er(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function O$(t){return er(t,[","])}function me(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function BR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function cT(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Qe(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const kQ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Qe,isNumeric:er,isNumericLike:O$,rangeEach:me,rangeEachReverse:BR,valueAccordingPercent:cT},Symbol.toStringTag,{value:"Module"})),WR="asc",$Q="desc",$P=new Map([[WR,[-1,1]],[$Q,[1,-1]]]),LQ=t=>`The priority '${t}' is already declared in a map.`,FQ=t=>`The priority '${t}' is not a number.`;function VQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=mt(t)?t:LQ,e=mt(e)?e:FQ;function r(o,s){if(!er(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:WR;const[s,a]=$P.get(o)||$P.get(WR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const BQ=t=>`The id '${t}' is already declared in a map.`;function sy(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=mt(t)?t:BQ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const WQ=t=>`'${t}' value is already declared in a unique set.`;function jQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=mt(t)?t:WQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const hT=t=>`There is already registered "${t}" plugin.`,UQ=t=>`There is already registered plugin on priority "${t}".`,zQ=t=>`The priority "${t}" is not a number.`,A$=VQ({errorPriorityExists:UQ,errorPriorityNaN:zQ}),H$=jQ({errorItemExists:hT}),jR=sy({errorIdExists:hT});function dT(){return[...A$.getItems(),...H$.getItems()]}function _g(t){const e=or(t);return jR.getItem(e)}function YQ(t){return!!_g(t)}function tt(t,e,n){[t,e,n]=KQ(t,e,n),_g(t)===void 0&&GQ(t,e,n)}function GQ(t,e,n){const r=or(t);if(jR.hasItem(r))throw new Error(hT(r));n===void 0?H$.addItem(r):A$.addItem(n,r),jR.addItem(r,e)}function KQ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:qQ,getItem:XQ,hasItem:N$,getNames:JQ,getValues:eEe}=po("renderers");function Vw(t){if(typeof t=="function")return t;if(!N$(t))throw Error(`No registered renderer found under "${t}" name`);return XQ(t)}function Xr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),qQ(t,e)}const{register:ZQ,getItem:QQ,hasItem:D$,getNames:eee,getValues:tEe}=po("validators");function fT(t){if(typeof t=="function")return t;if(!D$(t))throw Error(`No registered validator found under "${t}" name`);return QQ(t)}function tu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),ZQ(t,e)}var tee=Mt,nee=yh,ree=bh,iee=fg,oee=oy;tee({target:"Array",proto:!0},{at:function(e){var n=nee(this),r=ree(n),i=iee(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});oee("at");var see=Mt,aee=vn,lee=ug,uee=fg,cee=Lv,hee=Vn,dee=aee("".charAt),fee=hee(function(){return"𠮷".at(-2)!=="\uD842"});see({target:"String",proto:!0,forced:fee},{at:function(e){var n=cee(lee(this)),r=n.length,i=uee(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:dee(n,o)}});function Xh(t,e,n){return(e=gee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gee(t){var e=mee(t,"string");return typeof e=="symbol"?e:e+""}function mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pee{constructor(){Xh(this,"count",0),Xh(this,"startColumn",null),Xh(this,"endColumn",null),Xh(this,"startPosition",null),Xh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Jh(t,e,n){return(e=wee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wee(t){var e=vee(t,"string");return typeof e=="symbol"?e:e+""}function vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yee{constructor(){Jh(this,"count",0),Jh(this,"startRow",null),Jh(this,"endRow",null),Jh(this,"startPosition",null),Jh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Zh(t,e,n){return(e=Cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cee(t){var e=bee(t,"string");return typeof e=="symbol"?e:e+""}function bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k${constructor(){Zh(this,"count",0),Zh(this,"startColumn",null),Zh(this,"endColumn",null),Zh(this,"startPosition",null),Zh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Qh(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=Ree(t,"string");return typeof e=="symbol"?e:e+""}function Ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $${constructor(){Qh(this,"count",0),Qh(this,"startRow",null),Qh(this,"endRow",null),Qh(this,"startPosition",null),Qh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ed(t,e,n){return(e=Eee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eee(t){var e=Tee(t,"string");return typeof e=="symbol"?e:e+""}function Tee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mee{constructor(){ed(this,"count",0),ed(this,"startColumn",0),ed(this,"endColumn",0),ed(this,"startPosition",0),ed(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function td(t,e,n){return(e=_ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ee(t){var e=xee(t,"string");return typeof e=="symbol"?e:e+""}function xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iee{constructor(){td(this,"count",0),td(this,"startRow",0),td(this,"endRow",0),td(this,"startPosition",0),td(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function LP(t,e,n){return(e=Pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=Oee(t,"string");return typeof e=="symbol"?e:e+""}function Oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aee extends k${constructor(){super(...arguments),LP(this,"columnStartOffset",0),LP(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function FP(t,e,n){return(e=Hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hee(t){var e=Nee(t,"string");return typeof e=="symbol"?e:e+""}function Nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dee extends $${constructor(){super(...arguments),FP(this,"rowStartOffset",0),FP(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function VP(t,e,n){return(e=kee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kee(t){var e=$ee(t,"string");return typeof e=="symbol"?e:e+""}function $ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L${constructor(e){VP(this,"calculationTypes",[]),VP(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Fi(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=Fee(t,"string");return typeof e=="symbol"?e:e+""}function Fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lh=50;class Vee extends L${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Fi(this,"viewportWidth",0),Fi(this,"scrollOffset",0),Fi(this,"zeroBasedScrollOffset",0),Fi(this,"totalColumns",0),Fi(this,"columnWidthFn",null),Fi(this,"columnWidth",0),Fi(this,"overrideFn",null),Fi(this,"inlineStartOffset",0),Fi(this,"totalCalculatedWidth",0),Fi(this,"startPositions",[]),Fi(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?lh:n}}function di(t,e,n){return(e=Bee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bee(t){var e=Wee(t,"string");return typeof e=="symbol"?e:e+""}function Wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jee extends L${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),di(this,"viewportHeight",0),di(this,"scrollOffset",0),di(this,"zeroBasedScrollOffset",0),di(this,"totalRows",0),di(this,"rowHeightFn",null),di(this,"rowHeight",0),di(this,"overrideFn",null),di(this,"horizontalScrollbarHeight",0),di(this,"innerViewportHeight",0),di(this,"totalCalculatedHeight",0),di(this,"startPositions",[]),di(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function Uee(t,e,n){zee(t,e),e.set(t,n)}function zee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BP(t,e,n){return(e=Yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:e+""}function Gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uu(t,e){return t.get(F$(t,e))}function WP(t,e,n){return t.set(F$(t,e),n),n}function F$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gs=new WeakMap;class yu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;BP(this,"row",null),BP(this,"col",null),Uee(this,gs,!1),WP(gs,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Uu(gs,this)}isSouthEastOf(e){return this.row>=e.row&&(Uu(gs,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Uu(gs,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Uu(gs,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Uu(gs,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof yu&&WP(gs,this,e.isRtl()),this}clone(){return new yu(this.row,this.col,Uu(gs,this))}toObject(){return{row:this.row,col:this.col}}}function Kee(t,e,n){qee(t,e),e.set(t,n)}function qee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BC(t,e,n){return(e=Xee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xee(t){var e=Jee(t,"string");return typeof e=="symbol"?e:e+""}function Jee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fi(t,e){return t.get(V$(t,e))}function Zee(t,e,n){return t.set(V$(t,e),n),n}function V$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Er=new WeakMap;class xg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;BC(this,"highlight",null),BC(this,"from",null),BC(this,"to",null),Kee(this,Er,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Zee(Er,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return fi(Er,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return fi(Er,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return fi(Er,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return fi(Er,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return fi(Er,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return fi(Er,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return fi(Er,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return fi(Er,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof yu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(fi(Er,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(fi(Er,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new xg(this.highlight,this.from,this.to,fi(Er,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new yu(e,n,fi(Er,this))}}function Co(t,e,n){Qee(t,e),e.set(t,n)}function Qee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pe(t,e){return t.get(B$(t,e))}function la(t,e,n){return t.set(B$(t,e),n),n}function B$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gi=new WeakMap,WC=new WeakMap,kn=new WeakMap,zu=new WeakMap,hm=new WeakMap,Vi=new WeakMap,jC=new WeakMap,nd=new WeakMap,dl=new WeakMap,bo=new WeakMap;let W$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Co(this,gi,void 0),Co(this,WC,void 0),Co(this,kn,void 0),Co(this,zu,void 0),Co(this,hm,void 0),Co(this,Vi,void 0),Co(this,jC,void 0),Co(this,nd,void 0),Co(this,dl,[null,null]),Co(this,bo,[null,null]),la(gi,this,r),la(WC,this,n),la(kn,this,o),la(zu,this,s),la(hm,this,a),la(Vi,this,i),la(jC,this,e),this.registerEvents()}registerEvents(){pe(Vi,this).addEventListener(pe(kn,this).holder,"contextmenu",r=>this.onContextMenu(r)),pe(Vi,this).addEventListener(pe(kn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),pe(Vi,this).addEventListener(pe(kn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{pe(Vi,this).addEventListener(pe(kn,this).holder,"touchstart",r=>this.onTouchStart(r)),pe(Vi,this).addEventListener(pe(kn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),pe(Vi,this).addEventListener(pe(kn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||pe(gi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,pe(gi,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{pe(Vi,this).addEventListener(pe(kn,this).holder,"mouseup",r=>this.onMouseUp(r)),pe(Vi,this).addEventListener(pe(kn,this).holder,"mousedown",r=>this.onMouseDown(r))};Jo()?e():(tT()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(pe(nd,this)&&r){const[i,o]=[r.row,pe(nd,this).from.row],[s,a]=[r.col,pe(nd,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=pe(kn,this).TABLE,i=Yd(e,["TD","TH"],r);return i?(n.coords=pe(kn,this).getCoords(i),n.TD=i):be(e,"wtBorder")&&be(e,"current")?(n.coords=pe(zu,this).getFocusSelection().cellRange.highlight,n.TD=pe(kn,this).getCell(n.coords)):be(e,"wtBorder")&&be(e,"area")&&pe(zu,this).getAreaSelection().cellRange&&(n.coords=pe(zu,this).getAreaSelection().cellRange.to,n.TD=pe(kn,this).getCell(n.coords)),n}onMouseDown(e){const n=pe(WC,this).rootDocument.activeElement,r=eT(Uk,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);be(i,"corner")?pe(gi,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&pe(gi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(pe(bo,this)[0]=o.TD,clearTimeout(pe(dl,this)[0]),pe(dl,this)[0]=setTimeout(()=>{pe(bo,this)[0]=null},1e3))}onContextMenu(e){if(pe(gi,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!pe(gi,this).has("onCellMouseOver"))return;const n=pe(kn,this).TABLE,r=Yd(e.target,["TD","TH"],n),i=pe(hm,this)||this;r&&r!==i.lastMouseOver&&za(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,pe(kn,this).getCoords(r),r))}onMouseOut(e){if(!pe(gi,this).has("onCellMouseOut"))return;const n=pe(kn,this).TABLE,r=Yd(e.target,["TD","TH"],n),i=Yd(e.relatedTarget,["TD","TH"],n),o=pe(hm,this)||this;r&&r!==i&&za(r,n)&&(this.callListener("onCellMouseOut",e,pe(kn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&pe(gi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===pe(bo,this)[0]&&n.TD===pe(bo,this)[1]?(be(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),pe(bo,this)[0]=null,pe(bo,this)[1]=null):n.TD===pe(bo,this)[0]&&(pe(bo,this)[1]=n.TD,clearTimeout(pe(dl,this)[1]),pe(dl,this)[1]=setTimeout(()=>{pe(bo,this)[1]=null},500)))}onTouchStart(e){la(nd,this,pe(zu,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&pe(gi,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];rT()&&(m$()||p$())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=pe(gi,this).getSettingPure(e);o&&o(n,r,i,pe(jC,this).call(this))}destroy(){clearTimeout(pe(dl,this)[0]),clearTimeout(pe(dl,this)[1]),pe(Vi,this).destroy()}};function UC(t,e,n){return(e=ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ete(t){var e=tte(t,"string");return typeof e=="symbol"?e:e+""}function tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nte{constructor(e,n,r){UC(this,"offset",void 0),UC(this,"total",void 0),UC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function zC(t,e,n){return(e=rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ite(t,"string");return typeof e=="symbol"?e:e+""}function ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ote{constructor(e,n,r){zC(this,"offset",void 0),zC(this,"total",void 0),zC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function dm(t,e,n){return(e=ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ste(t){var e=ate(t,"string");return typeof e=="symbol"?e:e+""}function ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lte{constructor(){dm(this,"currentSize",0),dm(this,"nextSize",0),dm(this,"currentOffset",0),dm(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const ute=0,jP=1,UR=2;function YC(t,e,n){return(e=cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cte(t){var e=hte(t,"string");return typeof e=="symbol"?e:e+""}function hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dte{constructor(){YC(this,"size",new lte),YC(this,"workingSpace",ute),YC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=jP,e.workingSpace=UR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=UR,e.workingSpace=jP,this.sharedSize=e.getViewSize()}}var UP=$v,fte=TypeError,gte=function(t,e){if(!delete t[e])throw new fte("Cannot delete property "+UP(e)+" of "+UP(t))},mte=Mt,pte=yh,wte=bh,vte=XN,yte=gte,Cte=JN,bte=[].unshift(0)!==1,Ste=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},Rte=bte||!Ste();mte({target:"Array",proto:!0,arity:1,forced:Rte},{unshift:function(e){var n=pte(this),r=wte(n),i=arguments.length;if(i){Cte(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:yte(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return vte(n,r+i)}});function Ete(t,e,n){return(e=Tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zP{constructor(e,n){Ete(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function _te(t,e,n){return(e=xte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Ite(t,"string");return typeof e=="symbol"?e:e+""}function Ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pte{constructor(e){_te(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new zP(o,n),l=new zP(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(UR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Yu(t,e,n){return(e=Ote(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ote(t){var e=Ate(t,"string");return typeof e=="symbol"?e:e+""}function Ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j${constructor(e,n){Yu(this,"rootNode",void 0),Yu(this,"nodesPool",void 0),Yu(this,"sizeSet",new dte),Yu(this,"collectedNodes",[]),Yu(this,"viewDiffer",new Pte(this.sizeSet)),Yu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class U$ extends j${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function YP(t,e,n){return(e=Hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hte(t){var e=Nte(t,"string");return typeof e=="symbol"?e:e+""}function Nte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dte{constructor(e){YP(this,"nodeType",void 0),YP(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function rd(t,e,n){return(e=kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kte(t){var e=$te(t,"string");return typeof e=="symbol"?e:e+""}function $te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ig{constructor(e,n){rd(this,"nodesPool",null),rd(this,"nodeType",void 0),rd(this,"rootNode",void 0),rd(this,"table",null),rd(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Dte(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function GP(t,e,n){return(e=Lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lte(t){var e=Fte(t,"string");return typeof e=="symbol"?e:e+""}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vte extends Ig{constructor(){super("TH"),GP(this,"orderViews",new WeakMap),GP(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new U$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),ku(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ee(d,[q8(),iJ(),WE(h+1),Nu(-1)]),n[h](a,d,h)}u.end()}}}class Bte extends Ig{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&rs(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ee(this.rootNode,[Lk()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ee(s,[AR(),Wk(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),ku(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ee(u,[WE(a+1+this.table.rowHeadersCount),Nu(-1),X8(),...a>=0?[rJ()]:[AR()]]),r[n](l,u,n)}}}}let KP=!1;class Wte extends Ig{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!KP&&e>1e3&&(KP=!0,ut(wt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&X(r,"rowHeader")}}function jte(t,e,n){return(e=Ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ute(t){var e=zte(t,"string");return typeof e=="symbol"?e:e+""}function zte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let qP=!1;class Yte extends Ig{constructor(e){super("TR",e),jte(this,"orderView",void 0),this.orderView=new j$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!qP&&e>1e3&&(qP=!0,ut(wt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ee(this.rootNode,[Lk()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ee(o,[AR(),Wk(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?be(o,Gu.rowEven)||(ye(o,Gu.rowOdd),X(o,Gu.rowEven)):be(o,Gu.rowOdd)||(ye(o,Gu.rowEven),X(o,Gu.rowOdd))}this.orderView.end()}}function XP(t,e,n){return(e=Gte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:e+""}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qte extends Ig{constructor(){super("TD"),XP(this,"orderViews",new WeakMap),XP(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new U$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(be(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),ku(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;Ee(g,[...g.hasAttribute("role")?[]:[K8()],Nu(-1),WE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function Sn(t,e,n){return(e=Xte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xte(t){var e=Jte(t,"string");return typeof e=="symbol"?e:e+""}function Jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zte{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Sn(this,"rootNode",void 0),Sn(this,"rootDocument",void 0),Sn(this,"rowHeaders",null),Sn(this,"columnHeaders",null),Sn(this,"colGroup",null),Sn(this,"rows",null),Sn(this,"cells",null),Sn(this,"rowFilter",null),Sn(this,"columnFilter",null),Sn(this,"rowUtils",null),Sn(this,"columnUtils",null),Sn(this,"rowsToRender",0),Sn(this,"columnsToRender",0),Sn(this,"rowHeaderFunctions",[]),Sn(this,"rowHeadersCount",0),Sn(this,"columnHeaderFunctions",[]),Sn(this,"columnHeadersCount",0),Sn(this,"cellRenderer",void 0),Sn(this,"activeOverlayName",void 0),Sn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class Qte{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Zte(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new Vte,columnHeaders:new Bte(n),colGroup:new Wte(r),rows:new Yte(i),cells:new qte}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function GC(t,e,n){return(e=ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ene(t){var e=tne(t,"string");return typeof e=="symbol"?e:e+""}function tne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nne{constructor(e,n){GC(this,"dataAccessObject",void 0),GC(this,"wtSettings",void 0),GC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function JP(t,e,n){return(e=rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rne(t){var e=ine(t,"string");return typeof e=="symbol"?e:e+""}function ine(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class one{constructor(e,n){JP(this,"dataAccessObject",void 0),JP(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function So(t,e,n){return(e=sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sne(t){var e=ane(t,"string");return typeof e=="symbol"?e:e+""}function ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xh{constructor(e,n,r,i,o){So(this,"wtSettings",null),So(this,"domBindings",void 0),So(this,"TBODY",null),So(this,"THEAD",null),So(this,"COLGROUP",null),So(this,"hasTableHeight",!0),So(this,"hasTableWidth",!0),So(this,"isTableVisible",!1),So(this,"tableOffset",0),So(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,UE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new one(this.dataAccessObject,this.wtSettings),this.columnUtils=new nne(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Qte({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ee(r,[Ws()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ee(r,[Ws()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",Ee(r,[Nu(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ee(r.parentNode,[Ws()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ee(r,[Ws()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=zn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=zn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new ote(f,o,c),this.columnFilter=new nte(g,s,l);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),p=C.skipRender!==!0}p&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Yo)||this.is(Ga))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Yo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Yo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=qc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Yo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ja(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=Gk(r),s=n.cellIndex;Ra(Su,n,this.wtRootElement)||Ra(Cu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Ra(Ga,n,this.wtRootElement)||Ra(Yo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Ra(Su,n,this.wtRootElement)||Ra(bu,n,this.wtRootElement)||Ra(Ga,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=qc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?mn:qc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ln(this.TABLE)}getHeight(){return mn(this.TABLE)}getTotalWidth(){const e=ln(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=mn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return vu(this.TABLE)}_modifyRowHeaderWidth(e){let n=mt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const lne="stickyRowsBottom",gT={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};us(gT,"MIXIN_NAME",lne,{writable:!1,enumerable:!1});const une="stickyColumnsStart",ay={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};us(ay,"MIXIN_NAME",une,{writable:!1,enumerable:!1});class mT extends xh{constructor(e,n,r,i){super(e,n,r,i,Ga)}}bt(mT,gT);bt(mT,ay);const Cu="top",Yo="bottom",bu="inline_start",Su="top_inline_start_corner",Ga="bottom_inline_start_corner",z$=[Cu,Yo,bu,Su,Ga],cne=new Map([[Cu,`ht_clone_${Cu}`],[Yo,`ht_clone_${Yo}`],[bu,`ht_clone_${bu} ht_clone_left`],[Su,`ht_clone_${Su} ht_clone_top_left_corner`],[Ga,`ht_clone_${Ga} ht_clone_bottom_left_corner`]]);function hne(t,e){dne(t,e),e.add(t)}function dne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fne(t,e,n){return(e=gne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gne(t){var e=mne(t,"string");return typeof e=="symbol"?e:e+""}function mne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var id=new WeakSet;class pne{constructor(e){hne(this,id),fne(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Br(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Br(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return fm(id,this,QP).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return fm(id,this,QP).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return fm(id,this,ZP).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return fm(id,this,ZP).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function ZP(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=zn(r.wtRootElement).left;const u=Math.abs(YE(s,s));if(l>u){const c=GE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function QP(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=zn(n.wtRootElement),a=Qv(o,o);if(s.top>a){const l=qc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function mi(t,e,n){return(e=wne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wne(t){var e=vne(t,"string");return typeof e=="symbol"?e:e+""}function vne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pT{get eventManager(){return new Pi(this)}constructor(e,n){mi(this,"wtTable",void 0),mi(this,"wtScroll",void 0),mi(this,"wtViewport",void 0),mi(this,"wtOverlays",void 0),mi(this,"selectionManager",void 0),mi(this,"wtEvent",void 0),mi(this,"guid",`wt_${FE()}`),mi(this,"drawInterrupted",!1),mi(this,"drawn",!1),mi(this,"activeOverlayName","master"),mi(this,"domBindings",void 0),mi(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new pne(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Za(r,e[n])}])}}createCellCoords(e,n){return new yu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new xg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||Jk(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function eO(t,e,n){return(e=yne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yne(t){var e=Cne(t,"string");return typeof e=="symbol"?e:e+""}function Cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bne extends pT{constructor(e,n,r){super(e,n),eO(this,"cloneSource",void 0),eO(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new W$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function Sne(t,e,n){return(e=Rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rne(t){var e=Ene(t,"string");return typeof e=="symbol"?e:e+""}function Ene(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pg{constructor(e,n,r,i,o){Sne(this,"wtSettings",null),us(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=sh(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=sh(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Ff(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){ut(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Nn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(z$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${cne.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ee(o,[Ws()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Cu||u==="vertical"&&this.type===bu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Ff(e.TABLE),new bne(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Tne extends Pg{constructor(e,n,r,i,o,s){super(e,n,Ga,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new mT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Rg(n),this.repositionOverlay();let r=mn(this.clone.wtTable.TABLE);const i=ln(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Nn(r)),i.style.bottom=`${o}px`}}const Mne="calculatedColumns",ly={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};us(ly,"MIXIN_NAME",Mne,{writable:!1,enumerable:!1});class wT extends xh{constructor(e,n,r,i){super(e,n,r,i,Yo)}}bt(wT,gT);bt(wT,ly);function _ne(t,e,n){return(e=xne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xne(t){var e=Ine(t,"string");return typeof e=="symbol"?e:e+""}function Ine(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pne extends Pg{constructor(e,n,r,i){super(e,n,Yo,r,i),_ne(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new wT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Nn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Zv(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Nn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=mn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Nn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Qv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=be(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(ye(s,"innerBorderBottom"),o=a)}return o}}const One="calculatedRows",vT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};us(vT,"MIXIN_NAME",One,{writable:!1,enumerable:!1});class yT extends xh{constructor(e,n,r,i){super(e,n,r,i,bu)}}bt(yT,vT);bt(yT,ay);const Ane="localHooks",Yn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)kw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};us(Yn,"MIXIN_NAME",Ane,{writable:!1,enumerable:!1});let Y$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};bt(Y$,Yn);const G$="active-header",CT="header",bT="area",af="focus",Hne="fill",Nne="row",Dne="column",kne="custom-selection",ST=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var $ne=oy;$ne("flat");function Lne(t,e){K$(t,e),e.add(t)}function tO(t,e,n){K$(t,e),e.set(t,n)}function K$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e){return t.get(lf(t,e))}function nO(t,e,n){return t.set(lf(t,e),n),n}function lf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yi=new WeakMap,Jn=new WeakMap,gm=new WeakSet;class Fne{constructor(){Lne(this,gm),tO(this,Yi,void 0),tO(this,Jn,void 0)}setActiveOverlay(e){return nO(Jn,this,e),this}setActiveSelection(e){return nO(Yi,this,e),this}scan(){const e=qt(Yi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=qt(Yi,this).getCorners(),{wtTable:s}=qt(Jn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const p=qt(Jn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:qt(Yi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});p!==null&&(p!==h&&(g=s.getColumnHeader(p,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=qt(Yi,this).getCorners(),{wtTable:s}=qt(Jn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const p=qt(Jn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:qt(Yi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});p!==null&&(p!==h&&(g=s.getRowHeader(p,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=qt(Jn,this);lf(gm,this,Vne).call(this,(r,i)=>{const o=n.getCell(qt(Jn,this).createCellCoords(r,i)),s=qt(Jn,this).getSetting("onAfterDrawSelection",r,i,qt(Yi,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=qt(Yi,this).getCorners(),{wtTable:i}=qt(Jn,this);lf(gm,this,rO).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(qt(Jn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=qt(Yi,this).getCorners(),{wtTable:i}=qt(Jn,this);lf(gm,this,rO).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(qt(Jn,this).createCellCoords(o,s));e(a)}})}}function Vne(t){let[e,n,r,i]=qt(Yi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=qt(Jn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(qt(Jn,this).createCellCoords(e,n));if(!Qo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function rO(t){const{wtTable:e}=qt(Jn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class iO{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=ST(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ki(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Jo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Fe(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};Fe(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),p=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-p/4*3,10)}px`,c[l]=`${parseInt(i-p/4*3,10)}px`;const y=Math.min(parseInt(i+o,10),C-g-f*2),T=Math.min(parseInt(i+o-p/4,10),C-p-f*2);h[l]=`${y}px`,d[l]=`${T}px`;const _=Math.min(parseInt(r+s,10),E-g-f*2),P=Math.min(parseInt(r+s-p/4,10),E-p-f*2);h.top=`${_}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!Qo(g)){this.disappear();return}const p=u?s.getCell(this.wot.createCellCoords(i,o)):g,C=zn(g),E=u?zn(p):C,y=zn(s.TABLE),T=C.top,_=C.left,P=this.wot.wtSettings.getSetting("rtlMode");let M=0,I=0;if(P){const ve=ln(s.TABLE),He=ln(g),st=l.innerWidth-y.left-ve;I=_+He-E.left,M=l.innerWidth-_-He-st-1}else I=E.left+ln(p)-_,M=_-y.left-1;if(this.isEntireColumnSelected(n,i)){const ve=n,He=this.getDimensionsFromHeader("columns",r,o,ve,y);let st=null;He&&([st,M,I]=He),st&&(g=st)}let z=T-y.top-1,W=E.top+mn(p)-T;if(this.isEntireRowSelected(r,o)){const ve=r,He=this.getDimensionsFromHeader("rows",n,i,ve,y);let st=null;He&&([st,z,W]=He),st&&(g=st)}const V=l.getComputedStyle(g);parseInt(V.borderTopWidth,10)>0&&(z+=1,W=W>0?W-1:0),parseInt(V[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(M+=1,I=I>0?I-1:0);const q=P?"right":"left";this.topStyle.top=`${z}px`,this.topStyle[q]=`${M}px`,this.topStyle.width=`${I}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[q]=`${M}px`,this.startStyle.height=`${W}px`,this.startStyle.display="block";const Z=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${z+W-Z}px`,this.bottomStyle[q]=`${M}px`,this.bottomStyle.width=`${I}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[q]=`${M+I-Z}px`,this.endStyle.height=`${W+1}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[he,Ue]=[i,o];if(te&&Array.isArray(te)&&([,,he,Ue]=te),Jo()||!ee||this.isPartRange(he,Ue))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[q]=`${M+I+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ve=sh(s.TABLE);const He=ve===l;He&&(ve=a.documentElement);const st=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Cn=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),ze=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=He?p.getBoundingClientRect().left:p.offsetLeft;let v=!1,w=0;P?(w=m-parseInt(this.cornerDefaultStyle.width,10)/2,v=w<0):(w=m+ln(p)+parseInt(this.cornerDefaultStyle.width,10)/2,v=w>=GE(ve)),v&&(this.cornerStyle[q]=`${Math.floor(M+I+this.cornerCenterPointOffset-Cn-st)}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const w=(He?p.getBoundingClientRect().top:p.offsetTop)+mn(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=qc(ve),A=this.wot.stylesHandler.isClassicTheme();if(w){const L=Math.floor(z+W+this.cornerCenterPointOffset-ze-st);A?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}Jo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,z,M,I,W)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,p=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return mn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ln(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(g=l(n,C-i),p=l(r,C-i),!g||!p)return!1;const E=zn(g),y=zn(p);return g&&p&&(h=E[f]-o[f]-1,d=y[f]+u(p)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?X(this[e],"hidden"):(be(this[e],"hidden")&&ye(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?X(this[e],"hidden"):ye(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Jo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Bne(t,e){q$(t,e),e.add(t)}function Ku(t,e,n){q$(t,e),e.set(t,n)}function q$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ve(t,e){return t.get(RT(t,e))}function oO(t,e,n){return t.set(RT(t,e),n),n}function RT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zn=new WeakMap,Dr=new WeakMap,KC=new WeakMap,Gd=new WeakMap,qC=new WeakMap,fl=new WeakMap,sO=new WeakSet;class Wne{constructor(e){Bne(this,sO),Ku(this,Zn,void 0),Ku(this,Dr,void 0),Ku(this,KC,new Fne),Ku(this,Gd,new WeakMap),Ku(this,qC,new WeakSet),Ku(this,fl,new Map),oO(Dr,this,e)}setActiveOverlay(e){return oO(Zn,this,e),Ve(KC,this).setActiveOverlay(Ve(Zn,this)),Ve(Gd,this).has(Ve(Zn,this))||Ve(Gd,this).set(Ve(Zn,this),new Set),this}getFocusSelection(){return Ve(Dr,this)!==null?Ve(Dr,this).getFocus():null}getAreaSelection(){return Ve(Dr,this)!==null?Ve(Dr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ve(fl,this).has(e)){const r=Ve(fl,this).get(e);if(r.has(Ve(Zn,this)))return r.get(Ve(Zn,this));const i=new iO(Ve(Zn,this),e.settings);return r.set(Ve(Zn,this),i),i}const n=new iO(Ve(Zn,this),e.settings);return Ve(fl,this).set(e,new Map([[Ve(Zn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Ve(fl,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Ve(fl,this).get(e).forEach(n=>n.destroy()),Ve(fl,this).delete(e)}render(e){if(Ve(Dr,this)===null)return;e&&RT(sO,this,jne).call(this);const n=Array.from(Ve(Dr,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Ve(qC,this).has(s)||(Ve(qC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Ve(KC,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const p=r.get(g);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();Ve(Zn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Ve(Gd,this).get(Ve(Zn,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=Ve(Dr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ee(s,Ve(Dr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ee(o,[...i.get(o)])})}}function jne(){const t=Ve(Gd,this).get(Ve(Zn,this)),e=Ve(Zn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Ve(Zn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Ve(Dr,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Ve(Dr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Ve(Dr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Ve(Dr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ye(o[a],n),ku(o[a],s)}),t.clear()}class Une extends Pg{constructor(e,n,r,i){super(e,n,bu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new yT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),ey(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Rg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,zE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Nn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ln(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=ST(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!be(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Nn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Qk(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(YE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?ye(r,"emptyRows"):X(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=be(r,"innerBorderInlineStart");e?(X(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(ye(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const zne="stickyRowsTop",ET={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};us(ET,"MIXIN_NAME",zne,{writable:!1,enumerable:!1});class TT extends xh{constructor(e,n,r,i){super(e,n,r,i,Su)}}bt(TT,ET);bt(TT,ay);function aO(t,e,n){return(e=Yne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yne(t){var e=Gne(t,"string");return typeof e=="symbol"?e:e+""}function Gne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kne extends Pg{constructor(e,n,r,i,o,s){super(e,n,Su,r,i),aO(this,"topOverlay",void 0),aO(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new TT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();ey(e,`${i}px`,`${o}px`)}else Rg(e);let n=mn(this.clone.wtTable.TABLE);const r=ln(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class MT extends xh{constructor(e,n,r,i){super(e,n,r,i,Cu)}}bt(MT,ET);bt(MT,ly);function qne(t,e,n){return(e=Xne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xne(t){var e=Jne(t,"string");return typeof e=="symbol"?e:e+""}function Jne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zne extends Pg{constructor(e,n,r,i){super(e,n,Cu,r,i),qne(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new MT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),ey(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Rg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Zv(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Nn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=mn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=ST(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!be(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=Nn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Zk(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Qv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?ye(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=be(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(ye(i,"innerBorderTop"),a=h)}}return a}}function mm(t,e,n){Qne(t,e),e.set(t,n)}function Qne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ms(t,e,n){return(e=ere(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ere(t){var e=tre(t,"string");return typeof e=="symbol"?e:e+""}function tre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gl(t,e,n){return t.set(X$(t,e),n),n}function ps(t,e){return t.get(X$(t,e))}function X$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qu=new WeakMap,pm=new WeakMap,Xu=new WeakMap,wm=new WeakMap;class nre{constructor(e,n,r,i,o,s){ms(this,"wot",null),mm(this,qu,[]),ms(this,"topOverlay",null),ms(this,"bottomOverlay",null),ms(this,"inlineStartOverlay",null),ms(this,"topInlineStartCornerOverlay",null),ms(this,"bottomInlineStartCornerOverlay",null),ms(this,"browserLineHeight",void 0),ms(this,"wtSettings",null),mm(this,pm,!1),mm(this,Xu,0),mm(this,wm,null),ms(this,"resizeObserver",new ResizeObserver(c=>{Bf(()=>{!Array.isArray(c)||!c.length||(gl(Xu,this,ps(Xu,this)+1),ps(Xu,this)===100&&(ut("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ps(wm,this)!==null&&clearTimeout(ps(wm,this)),gl(wm,this,setTimeout(()=>{gl(Xu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Nn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Ff(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...ps(qu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Zne(...e),this.bottomOverlay=new Pne(...e),this.inlineStartOverlay=new Une(...e),this.topInlineStartCornerOverlay=new Kne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Tne(...e,this.bottomOverlay,this.inlineStartOverlay),gl(qu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){gl(pm,this,ps(qu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),ps(qu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ps(qu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!nT())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Bf(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{gl(Xu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=_h(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!ps(pm,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),gl(pm,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Ff(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),p=f()?1:0,C=g()?1:0;d.width=`${c+C}px`,d.height=`${u+p}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return x(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];x(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function lO(t,e,n){return(e=rre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rre(t){var e=ire(t,"string");return typeof e=="symbol"?e:e+""}function ire(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ore{constructor(e){lO(this,"settings",{}),lO(this,"defaults",Object.freeze(this.getDefaults())),Fe(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Za(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Fe(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class _T extends xh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=sh(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Vf(e,"height",n),o=Vf(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=vu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}bt(_T,vT);bt(_T,ly);class sre{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new Iee:new Dee],["fullyVisible",()=>new yee],["partiallyVisible",()=>new $$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new Mee:new Aee],["fullyVisible",()=>new pee],["partiallyVisible",()=>new k$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=mn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return zn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=mn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=ln(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Nn(this.domBindings.rootDocument),new jee({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Nn(this.domBindings.rootDocument)),new Vee({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){Fe(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function are(t,e){J$(t,e),e.add(t)}function ml(t,e,n){J$(t,e),e.set(t,n)}function J$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(ro(t,e))}function no(t,e,n){return t.set(ro(t,e),n),n}function ro(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uO=23;var Do=new WeakMap,$s=new WeakMap,xT=new WeakMap,zR=new WeakMap,Ea=new WeakMap,Kd=new WeakMap,Uf=new WeakMap,Lo=new WeakSet;class lre{constructor(e){are(this,Lo),ml(this,Do,void 0),ml(this,$s,void 0),ml(this,xT,void 0),ml(this,zR,void 0),ml(this,Ea,!0),ml(this,Kd,{}),ml(this,Uf,{}),no($s,this,e.rootTable.parentElement.parentElement),no(zR,this,e.rootDocument)}isClassicTheme(){return Ft(Ea,this)}getCSSVariableValue(e){var n;if(Ft(Ea,this))return null;if(Ft(Kd,this)[`--ht-${e}`])return Ft(Kd,this)[`--ht-${e}`];const r=(n=ro(Lo,this,dre).call(this,`--ht-${e}`))!==null&&n!==void 0?n:ro(Lo,this,Z$).call(this,`--ht-${e}`);if(r!==null)return Ft(Kd,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=Ft(Uf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Ft(Ea,this))return uO;const e=ro(Lo,this,ure).call(this);return!e&&be(Ft($s,this),"ht-wrapper")?(ut(`The "${Ft(Do,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),no(Ea,this,!0),this.useTheme(),uO):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){ro(Lo,this,cO).call(this),no(Ea,this,!0),no(Do,this,e||void 0);return}e&&e!==Ft(Do,this)&&(Ft(Do,this)&&ro(Lo,this,fre).call(this),no(Do,this,e),no(Ea,this,!1),ro(Lo,this,cre).call(this),ro(Lo,this,cO).call(this))}getThemeName(){return Ft(Do,this)}removeClassNames(){be(Ft($s,this),Ft(Do,this))&&ye(Ft($s,this),Ft(Do,this))}}function ure(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function cre(){ye(Ft($s,this),/ht-theme-.*/g),X(Ft($s,this),Ft(Do,this))}function cO(){this.isClassicTheme()||no(xT,this,getComputedStyle(Ft($s,this)));const t=ro(Lo,this,hre).call(this,["box-sizing","border-bottom-width"]);Ft(Uf,this).td={...Ft(Uf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function hre(t){const e=Ft(zR,this),n=Ft($s,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function dre(t){const e=Math.ceil(parseFloat(ro(Lo,this,Z$).call(this,t)));return Number.isNaN(e)?null:e}function Z$(t){const e=Ft(xT,this).getPropertyValue(t);return e===""?null:e}function fre(){no(Uf,this,{}),no(Kd,this,{}),no(Ea,this,!0)}class gre extends pT{constructor(e,n){super(e,new ore(n)),this.stylesHandler=new lre(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new _T(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new sre(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Wne(this.wtSettings.getSetting("selections")),this.wtEvent=new W$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new nre(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Fe(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),ye(this.wtTable.wtRootElement.parentNode,n),X(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!z$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class IT{constructor(e){e instanceof pT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new IT(n);return()=>r},this._wot=new gre(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function hO(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function mre(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const pre=new Map([["mousedown",hO],["mouseover",mre],["touchstart",hO]]);function dO(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;pre.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:iy(t)||t.type==="touchstart",isRightClick:Qa(t)})}const Q$=new WeakMap,PT=Symbol("rootInstance");function wre(t){Q$.set(t,!0)}function vre(t){return t===PT}function qp(t){return Q$.has(t)}function yre(t,e){eL(t,e),e.add(t)}function ua(t,e,n){eL(t,e),e.set(t,n)}function eL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ca(t,e,n){return(e=Cre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cre(t){var e=bre(t,"string");return typeof e=="symbol"?e:e+""}function bre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cn(t,e){return t.get(Jc(t,e))}function Tr(t,e,n){return t.set(Jc(t,e),n),n}function Jc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var XC=new WeakMap,vm=new WeakMap,ym=new WeakMap,ws=new WeakMap,Bi=new WeakMap,JC=new WeakMap,ZC=new WeakMap,Ju=new WeakMap,qd=new WeakSet;class Sre{constructor(e){yre(this,qd),ca(this,"hot",void 0),ca(this,"eventManager",void 0),ca(this,"settings",void 0),ca(this,"THEAD",void 0),ca(this,"TBODY",void 0),ca(this,"_wt",void 0),ca(this,"activeWt",void 0),ua(this,XC,0),ua(this,vm,0),ca(this,"postponedAdjustElementsSize",!1),ua(this,ym,!1),ua(this,ws,void 0),ua(this,Bi,void 0),ua(this,JC,0),ua(this,ZC,0),ua(this,Ju,null),this.hot=e,this.eventManager=new Pi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Jc(qd,this,Ere).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),X(e,"handsontable"),Tr(Bi,this,n.createElement("TABLE")),X(cn(Bi,this),"htCore"),this.hot.getSettings().tableClassName&&X(cn(Bi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ee(cn(Bi,this),[Ws()]),Ee(e,[G8(),Bk(-1),Jv(this.hot.countCols()),aJ()])),this.THEAD=n.createElement("THEAD"),cn(Bi,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),cn(Bi,this).appendChild(this.TBODY),this.hot.table=cn(Bi,this),this.hot.container.insertBefore(cn(Bi,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Tr(ym,this,!0),this.isTextSelectionAllowed(a.target)||(HR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Tr(ym,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{cn(ym,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&HR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&iy(a)&&r.finish(),Tr(ws,this,!1);const l=ty(n.activeElement);sf(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Qa(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&Qa(a)&&(r.finish(),Tr(ws,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),Tr(ws,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(cn(ws,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=Nn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=wu(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=wu(s);this.eventManager.addEventListener(cn(Bi,this),"selectstart",a=>{this.settings.fragmentSelection||sf(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&X(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&ye(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:cn(Bi,this),isDataViewInstance:()=>qp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Tr(vm,this,o.length),this.hot.getSettings().ariaTags&&Jc(qd,this,tL).call(this)===this.hot.countCols()&&Jc(qd,this,Rre).call(this,cn(vm,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Tr(XC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let p=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,p,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,p,f),this.hot.runHooks("afterRenderer",a,l,u,g,p,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&vu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Tr(ws,this,!0),Tr(Ju,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Oa(o)&&(dO(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Tr(ws,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Oa(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Oa(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Oa(o)&&(cn(ws,this)&&(!cn(Ju,this)||cn(Ju,this).x!==o.clientX||cn(Ju,this).y!==o.clientY)&&dO(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Tr(Ju,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Oa(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,p,C,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,1)):p,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new IT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(sf(e))return!0;const n=za(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return cn(ws,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!be(r,"relative")){rs(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;be(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",X(s,["relative",...o()])):(rs(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ee(a,...Ws()),Ee(l,...Ws())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(be(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):be(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?$u(e,r(n,i)):(Za(e," "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Tr(JC,this,e),Tr(ZC,this,n)}getLastSize(){return{width:cn(JC,this),height:cn(ZC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return cn(XC,this)}getRowHeadersCount(){return cn(vm,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function tL(){return parseInt(this.hot.rootElement.getAttribute(Jv()[0]),10)}function Rre(t){const e=Jc(qd,this,tL).call(this)+t;Ee(this.hot.rootElement,...Jv(e))}function Ere(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):ye(t,"htHasScrollY"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):ye(t,"htHasScrollX")}var Tre=Mt,Mre=Mn,_re=Sh,xre=jr,Ire=xn,Pre=ss,Ore=li,Are=rl,QC=Are("every",TypeError);Tre({target:"Iterator",proto:!0,real:!0,forced:QC},{every:function(e){Ire(this);try{xre(e)}catch(i){Ore(this,"throw",i)}if(QC)return Mre(QC,this,e);var n=Pre(this),r=0;return!_re(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const nL="ABCDEFGHIJKLMNOPQRSTUVWXYZ",YR=nL.length;function uy(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%YR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/YR,10);return n}function Hre(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=YR**r*(nL.indexOf(t[n])+1);return e-=1,e}function Nre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(uy(i)+(r+1));n.push(o)}return n}function Dre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=uy(i)+(r+1);n.push(o)}return n}function kre(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function OT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function AT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Le(t[0])&&(e=ry(t[0]))),e}function rL(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function iL(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const $re=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:AT,createEmptySpreadsheetData:kre,createSpreadsheetData:Nre,createSpreadsheetObjectData:Dre,dataRowToChangesArray:OT,isArrayOfArrays:rL,isArrayOfObjects:iL,spreadsheetColumnIndex:Hre,spreadsheetColumnLabel:uy},Symbol.toStringTag,{value:"Module"}));function od(t,e,n){return(e=Lre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lre(t){var e=Fre(t,"string");return typeof e=="symbol"?e:e+""}function Fre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];od(this,"hot",void 0),od(this,"data",void 0),od(this,"dataType","array"),od(this,"colToProp",()=>{}),od(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return x(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):me(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Le(a)||mt(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;me(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Yp(l,d,f):l[d]=f}})}else Fe(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Yp(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Br(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Yp(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?c$(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Br(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return me(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return AT(this.data)}destroy(){this.data=null,this.hot=null}}var Bre=Mt,Wre=Mn,jre=Sh,Ure=jr,zre=xn,Yre=ss,Gre=li,Kre=rl,eb=Kre("some",TypeError);Bre({target:"Iterator",proto:!0,real:!0,forced:eb},{some:function(e){zre(this);try{Ure(e)}catch(i){Gre(this,"throw",i)}if(eb)return Wre(eb,this,e);var n=Yre(this),r=0;return jre(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function fO(t,e,n){return(e=qre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qre(t){var e=Xre(t,"string");return typeof e=="symbol"?e:e+""}function Xre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;fO(this,"indexedValues",[]),fO(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,mt(this.initValueOrFn)?me(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}bt(Lu,Yn);function HT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>mt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function NT(t,e){return Xa(t,(n,r)=>e.includes(r)===!1)}class il extends Lu{insert(e,n){this.indexedValues=HT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=NT(this.indexedValues,e),super.remove(e)}}class cy extends il{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return In(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function DT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function zf(t,e){return Xa(t,n=>e.includes(n)===!1)}function kT(t,e){return Je(t,n=>n-e.filter(r=>r<n).length)}function $T(t,e){const n=e[0],r=e.length;return Je(t,i=>i>=n?i+r:i)}function Jre(t,e,n){return(e=Zre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zre(t){var e=Qre(t,"string");return typeof e=="symbol"?e:e+""}function Qre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hy extends Lu{constructor(){super(...arguments),Jre(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=zf(this.orderOfIndexes,[e]),mt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=HT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=$T(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=NT(this.indexedValues,e),this.orderOfIndexes=zf(this.orderOfIndexes,e),this.orderOfIndexes=kT(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Og extends il{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return In(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const gO=new Map([["indexesSequence",{getListWithInsertedItems:DT,getListWithRemovedItems:zf}],["physicallyIndexed",{getListWithInsertedItems:HT,getListWithRemovedItems:NT}]]),oL=t=>{if(gO.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return gO.get(t)};class sL extends Lu{constructor(){super(e=>e)}insert(e,n){const r=$T(this.indexedValues,n);this.indexedValues=DT(r,e,n),super.insert(e,n)}remove(e){const n=zf(this.indexedValues,e);this.indexedValues=kT(n,e),super.remove(e)}}const mO=new Map([["hiding",cy],["index",Lu],["linkedPhysicalIndexToValue",hy],["physicalIndexToValue",il],["trimming",Og]]);function eie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!mO.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(mO.get(t))(e)}function tie(t,e,n){return(e=nie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nie(t){var e=rie(t,"string");return typeof e=="symbol"?e:e+""}function rie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let GR=0;class LT{constructor(){tie(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),GR+=1)}unregister(e){const n=this.collection.get(e);ue(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),GR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Vt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}bt(LT,Yn);function iie(){return GR}function tb(t,e,n){return(e=oie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oie(t){var e=sie(t,"string");return typeof e=="symbol"?e:e+""}function sie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pO extends LT{constructor(e,n){super(),tb(this,"mergedValuesCache",[]),tb(this,"aggregationFunction",void 0),tb(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Je(this.get(),o=>o.getValues()),r=[],i=ue(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Je(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ue(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function aie(t,e,n){lie(t,e),e.set(t,n)}function lie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uie(t,e,n){return t.set(aL(t,e),n),n}function cie(t,e){return t.get(aL(t,e))}function aL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nb=new WeakMap;class lL{constructor(){aie(this,nb,[])}subscribe(e){return this.addLocalHook("change",e),this._write(cie(nb,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){uie(nb,this,e)}}bt(lL,Yn);function wO(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function sd(t,e,n){hie(t,e),e.set(t,n)}function hie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pi(t,e){return t.get(uL(t,e))}function Cm(t,e,n){return t.set(uL(t,e),n),n}function uL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bm=new WeakMap,ad=new WeakMap,Sm=new WeakMap,Rm=new WeakMap,Em=new WeakMap;class die{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};sd(this,bm,new Set),sd(this,ad,[]),sd(this,Sm,[]),sd(this,Rm,!1),sd(this,Em,!1),Cm(Em,this,e??!1)}createObserver(){const e=new lL;return pi(bm,this).add(e),e.addLocalHook("unsubscribe",()=>{pi(bm,this).delete(e)}),e._writeInitialChanges(wO(pi(ad,this),pi(Sm,this))),e}emit(e){let n=pi(Sm,this);(!pi(Rm,this)||pi(ad,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(pi(Em,this)):Cm(ad,this,new Array(e.length).fill(pi(Em,this))),pi(Rm,this)||(Cm(Rm,this,!0),n=pi(ad,this)));const r=wO(n,e);pi(bm,this).forEach(i=>i._write(r)),Cm(Sm,this,e)}}function ur(t,e,n){return(e=fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fie(t){var e=gie(t,"string");return typeof e=="symbol"?e:e+""}function gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KR{constructor(){ur(this,"indexesSequence",new sL),ur(this,"trimmingMapsCollection",new pO(e=>e.some(n=>n===!0),!1)),ur(this,"hidingMapsCollection",new pO(e=>e.some(n=>n===!0),!1)),ur(this,"variousMapsCollection",new LT),ur(this,"hidingChangesObservable",new die({initialIndexValue:!1})),ur(this,"notTrimmedIndexesCache",[]),ur(this,"notHiddenIndexesCache",[]),ur(this,"isBatched",!1),ur(this,"indexesSequenceChanged",!1),ur(this,"indexesChangeSource",void 0),ur(this,"trimmedIndexesChanged",!1),ur(this,"hiddenIndexesChanged",!1),ur(this,"renderablePhysicalIndexesCache",[]),ur(this,"fromPhysicalToVisualIndexesCache",new Map),ur(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,eie(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Og?this.trimmingMapsCollection.register(e,n):n instanceof cy?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ue(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ue(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ue(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ue(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Je(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=zf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(DT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ue(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Je(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}bt(KR,Yn);function mie(t,e){return Fe(e,(n,r)=>{Vt(t[r])&&(t[r]=n)}),t}function cL(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function hL(t){ue(t)&&sT(wt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function pie(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:wie,getValues:vie}=po("phraseFormatters");function yie(t,e){wie(t,e)}function Cie(){return vie()}yie("pluralize",pie);const dL="ContextMenu:items",Ae=dL,FT=`${Ae}.noItems`,VT=`${Ae}.insertRowAbove`,BT=`${Ae}.insertRowBelow`,WT=`${Ae}.insertColumnOnTheLeft`,jT=`${Ae}.insertColumnOnTheRight`,UT=`${Ae}.removeRow`,zT=`${Ae}.removeColumn`,YT=`${Ae}.undo`,GT=`${Ae}.redo`,Bw=`${Ae}.readOnly`,KT=`${Ae}.clearColumn`,qT=`${Ae}.copy`,XT=`${Ae}.copyWithHeaders`,JT=`${Ae}.copyWithGroupHeaders`,ZT=`${Ae}.copyHeadersOnly`,QT=`${Ae}.cut`,eM=`${Ae}.freezeColumn`,tM=`${Ae}.unfreezeColumn`,nM=`${Ae}.mergeCells`,rM=`${Ae}.unmergeCells`,iM=`${Ae}.addComment`,oM=`${Ae}.editComment`,sM=`${Ae}.removeComment`,aM=`${Ae}.readOnlyComment`,lM=`${Ae}.align`,uM=`${Ae}.align.left`,cM=`${Ae}.align.center`,hM=`${Ae}.align.right`,dM=`${Ae}.align.justify`,fM=`${Ae}.align.top`,gM=`${Ae}.align.middle`,mM=`${Ae}.align.bottom`,pM=`${Ae}.borders`,wM=`${Ae}.borders.top`,vM=`${Ae}.borders.right`,yM=`${Ae}.borders.bottom`,CM=`${Ae}.borders.left`,bM=`${Ae}.borders.remove`,SM=`${Ae}.nestedHeaders.insertChildRow`,RM=`${Ae}.nestedHeaders.detachFromParent`,EM=`${Ae}.hideColumn`,TM=`${Ae}.showColumn`,MM=`${Ae}.hideRow`,_M=`${Ae}.showRow`,Sr="Filters:",tn=`${Sr}conditions`,dy=`${tn}.none`,xM=`${tn}.isEmpty`,IM=`${tn}.isNotEmpty`,PM=`${tn}.isEqualTo`,OM=`${tn}.isNotEqualTo`,AM=`${tn}.beginsWith`,HM=`${tn}.endsWith`,NM=`${tn}.contains`,DM=`${tn}.doesNotContain`,bie=`${tn}.byValue`,kM=`${tn}.greaterThan`,$M=`${tn}.greaterThanOrEqualTo`,LM=`${tn}.lessThan`,FM=`${tn}.lessThanOrEqualTo`,VM=`${tn}.isBetween`,BM=`${tn}.isNotBetween`,WM=`${tn}.after`,jM=`${tn}.before`,UM=`${tn}.today`,zM=`${tn}.tomorrow`,YM=`${tn}.yesterday`,GM=`${Sr}labels.filterByCondition`,KM=`${Sr}labels.filterByValue`,qM=`${Sr}labels.conjunction`,fy=`${Sr}labels.disjunction`,Ww=`${Sr}values.blankCells`,XM=`${Sr}buttons.selectAll`,JM=`${Sr}buttons.clear`,ZM=`${Sr}buttons.ok`,QM=`${Sr}buttons.cancel`,e_=`${Sr}buttons.placeholder.search`,t_=`${Sr}buttons.placeholder.value`,n_=`${Sr}buttons.placeholder.secondValue`,r_="CheckboxRenderer:",i_=`${r_}checked`,o_=`${r_}unchecked`,Sie=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:i_,CHECKBOX_RENDERER_NAMESPACE:r_,CHECKBOX_UNCHECKED:o_,CONTEXTMENU_ITEMS_ADD_COMMENT:iM,CONTEXTMENU_ITEMS_ALIGNMENT:lM,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:mM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:cM,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:dM,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:uM,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:gM,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:hM,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:fM,CONTEXTMENU_ITEMS_BORDERS:pM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:yM,CONTEXTMENU_ITEMS_BORDERS_LEFT:CM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:vM,CONTEXTMENU_ITEMS_BORDERS_TOP:wM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:KT,CONTEXTMENU_ITEMS_COPY:qT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:ZT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:JT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:XT,CONTEXTMENU_ITEMS_CUT:QT,CONTEXTMENU_ITEMS_EDIT_COMMENT:oM,CONTEXTMENU_ITEMS_FREEZE_COLUMN:eM,CONTEXTMENU_ITEMS_HIDE_COLUMN:EM,CONTEXTMENU_ITEMS_HIDE_ROW:MM,CONTEXTMENU_ITEMS_INSERT_LEFT:WT,CONTEXTMENU_ITEMS_INSERT_RIGHT:jT,CONTEXTMENU_ITEMS_MERGE_CELLS:nM,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:RM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:SM,CONTEXTMENU_ITEMS_NO_ITEMS:FT,CONTEXTMENU_ITEMS_READ_ONLY:Bw,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:aM,CONTEXTMENU_ITEMS_REDO:GT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:bM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:zT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:sM,CONTEXTMENU_ITEMS_REMOVE_ROW:UT,CONTEXTMENU_ITEMS_ROW_ABOVE:VT,CONTEXTMENU_ITEMS_ROW_BELOW:BT,CONTEXTMENU_ITEMS_SHOW_COLUMN:TM,CONTEXTMENU_ITEMS_SHOW_ROW:_M,CONTEXTMENU_ITEMS_UNDO:YT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:tM,CONTEXTMENU_ITEMS_UNMERGE_CELLS:rM,CONTEXT_MENU_ITEMS_NAMESPACE:dL,FILTERS_BUTTONS_CANCEL:QM,FILTERS_BUTTONS_CLEAR:JM,FILTERS_BUTTONS_OK:ZM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:e_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:n_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:t_,FILTERS_BUTTONS_SELECT_ALL:XM,FILTERS_CONDITIONS_AFTER:WM,FILTERS_CONDITIONS_BEFORE:jM,FILTERS_CONDITIONS_BEGINS_WITH:AM,FILTERS_CONDITIONS_BETWEEN:VM,FILTERS_CONDITIONS_BY_VALUE:bie,FILTERS_CONDITIONS_CONTAINS:NM,FILTERS_CONDITIONS_EMPTY:xM,FILTERS_CONDITIONS_ENDS_WITH:HM,FILTERS_CONDITIONS_EQUAL:PM,FILTERS_CONDITIONS_GREATER_THAN:kM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:$M,FILTERS_CONDITIONS_LESS_THAN:LM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:FM,FILTERS_CONDITIONS_NAMESPACE:tn,FILTERS_CONDITIONS_NONE:dy,FILTERS_CONDITIONS_NOT_BETWEEN:BM,FILTERS_CONDITIONS_NOT_CONTAIN:DM,FILTERS_CONDITIONS_NOT_EMPTY:IM,FILTERS_CONDITIONS_NOT_EQUAL:OM,FILTERS_CONDITIONS_TODAY:UM,FILTERS_CONDITIONS_TOMORROW:zM,FILTERS_CONDITIONS_YESTERDAY:YM,FILTERS_DIVS_FILTER_BY_CONDITION:GM,FILTERS_DIVS_FILTER_BY_VALUE:KM,FILTERS_LABELS_CONJUNCTION:qM,FILTERS_LABELS_DISJUNCTION:fy,FILTERS_NAMESPACE:Sr,FILTERS_VALUES_BLANK_CELLS:Ww},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const fL={languageCode:"en-US",[FT]:"No available options",[VT]:"Insert row above",[BT]:"Insert row below",[WT]:"Insert column left",[jT]:"Insert column right",[UT]:["Remove row","Remove rows"],[zT]:["Remove column","Remove columns"],[YT]:"Undo",[GT]:"Redo",[Bw]:"Read only",[KT]:"Clear column",[lM]:"Alignment",[uM]:"Left",[cM]:"Center",[hM]:"Right",[dM]:"Justify",[fM]:"Top",[gM]:"Middle",[mM]:"Bottom",[eM]:"Freeze column",[tM]:"Unfreeze column",[pM]:"Borders",[wM]:"Top",[vM]:"Right",[yM]:"Bottom",[CM]:"Left",[bM]:"Remove border(s)",[iM]:"Add comment",[oM]:"Edit comment",[sM]:"Delete comment",[aM]:"Read-only comment",[nM]:"Merge cells",[rM]:"Unmerge cells",[qT]:"Copy",[XT]:["Copy with header","Copy with headers"],[JT]:["Copy with group header","Copy with group headers"],[ZT]:["Copy header only","Copy headers only"],[QT]:"Cut",[SM]:"Insert child row",[RM]:"Detach from parent",[EM]:["Hide column","Hide columns"],[TM]:["Show column","Show columns"],[MM]:["Hide row","Hide rows"],[_M]:["Show row","Show rows"],[dy]:"None",[xM]:"Is empty",[IM]:"Is not empty",[PM]:"Is equal to",[OM]:"Is not equal to",[AM]:"Begins with",[HM]:"Ends with",[NM]:"Contains",[DM]:"Does not contain",[kM]:"Greater than",[$M]:"Greater than or equal to",[LM]:"Less than",[FM]:"Less than or equal to",[VM]:"Is between",[BM]:"Is not between",[WM]:"After",[jM]:"Before",[UM]:"Today",[zM]:"Tomorrow",[YM]:"Yesterday",[Ww]:"Blank cells",[GM]:"Filter by condition",[KM]:"Filter by value",[qM]:"And",[fy]:"Or",[XM]:"Select all",[JM]:"Clear",[ZM]:"OK",[QM]:"Cancel",[e_]:"Search",[t_]:"Value",[n_]:"Second value",[i_]:"Checked",[o_]:"Unchecked"},Rie=Sie,qR=fL.languageCode,{register:Eie,getItem:gL,hasItem:Tie,getValues:Mie}=po("languagesDictionaries");mL(fL);function mL(t,e){let n=t,r=e;return Le(t)&&(r=t,n=r.languageCode),_ie(n,r),Eie(n,sr(r)),sr(r)}function _ie(t,e){t!==qR&&mie(e,gL(qR))}function pL(t){return s_(t)?sr(gL(t)):null}function s_(t){return Tie(t)}function xie(){return Mie()}function wL(t,e,n){const r=pL(t);if(r===null)return null;const i=r[e];if(Vt(i))return null;const o=Iie(i,n);return Array.isArray(o)?o[0]:o}function Iie(t,e){let n=t;return x(Cie(),r=>{n=r(t,e)}),n}function Pie(t){let e=cL(t);return s_(e)||(e=qR,hL(t)),e}function Oie(t,e,n){return(e=Aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aie(t){var e=Hie(t,"string");return typeof e=="symbol"?e:e+""}function Hie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oa extends Y${constructor(e,n){super(e,null),Oie(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function rb(t){let{activeHeaderClassName:e,...n}=t;return new oa({className:e,...n,selectionType:G$})}function Nie(t){let{areaCornerVisible:e,...n}=t;return new oa({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:bT})}function Die(t){let{...e}=t;return new oa({className:"highlight",...e,selectionType:bT})}function kie(t){let{columnClassName:e,...n}=t;return new oa({className:e,...n,selectionType:Dne})}function $ie(t){let{cellCornerVisible:e,...n}=t;return new oa({className:"current",headerAttributes:[jE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:af})}function Lie(t){let{border:e,visualCellRange:n,...r}=t;return new oa({...e,...r,selectionType:kne},n)}function Fie(t){let{...e}=t;return new oa({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Hne})}function vO(t){let{headerClassName:e,...n}=t;return new oa({className:e,...n,selectionType:CT})}function Vie(t){let{rowClassName:e,...n}=t;return new oa({className:e,...n,selectionType:Nne})}function Bie(t,e){Wie(t,e),e.add(t)}function Wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e,n){return(e=jie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jie(t){var e=Uie(t,"string");return typeof e=="symbol"?e:e+""}function Uie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ro=new WeakSet;class zie{constructor(e){Bie(this,Ro),Mr(this,"options",void 0),Mr(this,"layerLevel",0),Mr(this,"focus",void 0),Mr(this,"fill",void 0),Mr(this,"layeredAreas",new Map),Mr(this,"areas",new Map),Mr(this,"rowHeaders",new Map),Mr(this,"columnHeaders",new Map),Mr(this,"activeRowHeaders",new Map),Mr(this,"activeColumnHeaders",new Map),Mr(this,"activeCornerHeaders",new Map),Mr(this,"rowHighlights",new Map),Mr(this,"columnHighlights",new Map),Mr(this,"customSelections",[]),this.options=e,this.focus=$ie(e),this.fill=Fie(e)}isEnabledFor(e,n){let r=e;e===af&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return vs(Ro,this,ys).call(this,this.layeredAreas,Nie)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return vs(Ro,this,ys).call(this,this.areas,Die)}getAreas(){return[...this.areas.values()]}createRowHeader(){return vs(Ro,this,ys).call(this,this.rowHeaders,vO)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return vs(Ro,this,ys).call(this,this.columnHeaders,vO)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return vs(Ro,this,ys).call(this,this.activeRowHeaders,rb)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return vs(Ro,this,ys).call(this,this.activeColumnHeaders,rb)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return vs(Ro,this,ys).call(this,this.activeCornerHeaders,rb)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return vs(Ro,this,ys).call(this,this.rowHighlights,Vie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return vs(Ro,this,ys).call(this,this.columnHighlights,kie)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Lie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),x(this.areas.values(),e=>void e.clear()),x(this.layeredAreas.values(),e=>void e.clear()),x(this.rowHeaders.values(),e=>void e.clear()),x(this.columnHeaders.values(),e=>void e.clear()),x(this.activeRowHeaders.values(),e=>void e.clear()),x(this.activeColumnHeaders.values(),e=>void e.clear()),x(this.activeCornerHeaders.values(),e=>void e.clear()),x(this.rowHighlights.values(),e=>void e.clear()),x(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ys(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function yO(t,e,n){return(e=Yie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yie(t){var e=Gie(t,"string");return typeof e=="symbol"?e:e+""}function Gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kie{constructor(e){yO(this,"ranges",[]),yO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function qie(t,e){vL(t,e),e.add(t)}function ib(t,e,n){vL(t,e),e.set(t,n)}function vL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function it(t,e){return t.get(Rn(t,e))}function Tm(t,e,n){return t.set(Rn(t,e),n),n}function Rn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mm=new WeakMap,It=new WeakMap,lo=new WeakMap,On=new WeakSet;class XR{constructor(e,n){qie(this,On),ib(this,Mm,void 0),ib(this,It,void 0),ib(this,lo,{x:0,y:0}),Tm(Mm,this,e),Tm(It,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=it(It,this).createCellCoords(e,n);let o=it(Mm,this).current().highlight;const s=it(It,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Rn(On,this,yL).call(this),{row:h,col:d}=Rn(On,this,bO).call(this,o),f=it(It,this).fixedRowsBottom(),g=it(It,this).minSpareRows(),p=it(It,this).minSpareCols(),C=it(It,this).autoWrapRow(),E=it(It,this).autoWrapCol(),y=it(It,this).createCellCoords(h+i.row,d+i.col);if(y.row>=c){const P=Br(r&&g>0&&f===0),M=y.col+1,I=it(It,this).createCellCoords(y.row-c,M>=u?M-u:M);this.runLocalHooks("beforeColumnWrap",P,Rn(On,this,Zu).call(this,I),M>=u),P.value?this.runLocalHooks("insertRowRequire",it(It,this).countRenderableRows()):E&&y.assign(I)}else if(y.row<0){const P=Br(E),M=y.col-1,I=it(It,this).createCellCoords(c+y.row,M<0?u+M:M);this.runLocalHooks("beforeColumnWrap",P,Rn(On,this,Zu).call(this,I),M<0),E&&y.assign(I)}if(y.col>=u){const P=Br(r&&p>0),M=y.row+1,I=it(It,this).createCellCoords(M>=c?M-c:M,y.col-u);this.runLocalHooks("beforeRowWrap",P,Rn(On,this,Zu).call(this,I),M>=c),P.value?this.runLocalHooks("insertColRequire",it(It,this).countRenderableColumns()):C&&y.assign(I)}else if(y.col<0){const P=Br(C),M=y.row-1,I=it(It,this).createCellCoords(M<0?c+M:M,u+y.col);this.runLocalHooks("beforeRowWrap",P,Rn(On,this,Zu).call(this,I),M<0),C&&y.assign(I)}const{rowDir:T,colDir:_}=Rn(On,this,CO).call(this,y);a=T,l=_,o=Rn(On,this,Zu).call(this,y)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=it(It,this).createCellCoords(e,n),i=it(Mm,this).current(),o=it(It,this).visualToRenderableCoords(i.highlight),s=Rn(On,this,ob).call(this,i.to.row,i.from.row),a=Rn(On,this,sb).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Rn(On,this,bO).call(this,i.highlight),f=it(It,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),p=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const _=f.col-d;f.col=Rn(On,this,sb).call(this,g.col,p.col)+_}else if(r.col>0&&a<=d&&f.col>d){const _=Rn(On,this,sb).call(this,p.col,g.col),P=Math.max(f.col-_,1);f.col=_+P}if(r.row<0&&s>=h&&f.row<h){const _=f.row-h;f.row=Rn(On,this,ob).call(this,g.row,C.row)+_}else if(r.row>0&&s<=h&&f.row>h){const _=Rn(On,this,ob).call(this,C.row,g.row),P=Math.max(f.row-_,1);f.row=_+P}const{rowDir:E,colDir:y}=Rn(On,this,CO).call(this,f);u=E,c=y;const T=Rn(On,this,Zu).call(this,f);r.row===0&&r.col!==0?l.col=T.col:r.row!==0&&r.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;Tm(lo,this,{x:n,y:r})}resetOffsetSize(){Tm(lo,this,{x:0,y:0})}}function CO(t){const{width:e,height:n}=Rn(On,this,yL).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function yL(){return{width:it(lo,this).x+it(It,this).countRenderableColumns(),height:it(lo,this).y+it(It,this).countRenderableRows()}}function ob(t,e){const n=it(It,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:it(lo,this).y+n}function sb(t,e){const n=it(It,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:it(lo,this).x+n}function bO(t){const{row:e,col:n}=it(It,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return it(It,this).createCellCoords(it(lo,this).y+e,it(lo,this).x+n)}function Zu(t){const e=t.clone();return e.col=t.col-it(lo,this).x,e.row=t.row-it(lo,this).y,it(It,this).renderableToVisualCoords(e)}bt(XR,Yn);const gy=0,my=1,CL=2,a_=3,Xie=[a_,CL],Jie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],ab=Symbol("root"),SO=Symbol("child");function uh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ab;if(e!==ab&&e!==SO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===ab;let i=gy;if(n){const o=t[0];t.length===0?i=my:r&&o instanceof xg?i=a_:r&&Array.isArray(o)?i=uh(o,SO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Jie[l].includes(typeof a))&&(i=CL)}return i}function Yf(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Xie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===a_;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Vt(u)&&(u=a),Vt(c)&&(c=l),!r){const f=a,g=l,p=u,C=c;a=Math.min(f,p),l=Math.min(g,C),u=Math.max(f,p),c=Math.max(g,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Zie(t){const e=uh(t.getSelected());if(e===gy||e===my)return[];const n=Yf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;x(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;x(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return In(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Qie(t){const e=uh(t.getSelected());if(e===gy||e===my)return[];const n=Yf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;x(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;x(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return In(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Qu(t,e,n){eoe(t,e),e.set(t,n)}function eoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pl(t,e,n){return(e=toe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function toe(t){var e=noe(t,"string");return typeof e=="symbol"?e:e+""}function noe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $t(t,e){return t.get(bL(t,e))}function Eo(t,e,n){return t.set(bL(t,e),n),n}function bL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Kn=new WeakMap,wl=new WeakMap,_m=new WeakMap,ld=new WeakMap,xm=new WeakMap,ud=new WeakMap;class SL{constructor(e,n){var r=this;pl(this,"settings",void 0),pl(this,"tableProps",void 0),pl(this,"inProgress",!1),pl(this,"selectedRange",new Kie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),pl(this,"highlight",void 0),Qu(this,Kn,void 0),Qu(this,wl,void 0),pl(this,"selectedByRowHeader",new Set),pl(this,"selectedByColumnHeader",new Set),Qu(this,_m,!1),Qu(this,ld,!1),Qu(this,xm,"unknown"),Qu(this,ud,-1),this.settings=e,this.tableProps=n,this.highlight=new zie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[jE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Eo(Kn,this,new XR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Eo(wl,this,new XR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),$t(Kn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),$t(Kn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),$t(Kn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),$t(Kn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),$t(Kn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),$t(Kn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),$t(Kn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),$t(Kn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),$t(wl,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),$t(wl,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Eo(xm,this,e)}markEndSource(){Eo(xm,this,"unknown")}getSelectionSource(){return $t(xm,this)}setExpectedLayers(e){Eo(ud,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Eo(ud,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Vt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Eo(_m,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Vt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=$t(ud,this)===-1||this.selectedRange.size()===$t(ud,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(x(this.highlight.getAreas(),g=>void g.clear()),x(this.highlight.getLayeredAreas(),g=>void g.clear()),x(this.highlight.getRowHeaders(),g=>void g.clear()),x(this.highlight.getColumnHeaders(),g=>void g.clear()),x(this.highlight.getActiveRowHeaders(),g=>void g.clear()),x(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),x(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),x(this.highlight.getRowHighlights(),g=>void g.clear()),x(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(bT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(CT,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),y=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(y).commit(),d.add(C).commit(),f.add(y).commit()):(a.add(C).add(E).commit(),l.add(y).add(T).commit(),d.add(C).add(E).commit(),f.add(y).add(T).commit())}const g=!$t(ld,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),p=!$t(ld,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&p&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(af,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(Eo(_m,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?$t(Kn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):$t(Kn,this).resetOffsetSize(),this.setRangeStart($t(Kn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?$t(Kn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):$t(Kn,this).resetOffsetSize(),this.setRangeEnd($t(Kn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?$t(wl,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):$t(wl,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=$t(wl,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Qe(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Qe(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Qe(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Qe(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Qe(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Qe(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Br(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&$t(_m,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Eo(ld,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Qe(d.row,u,o-1),Qe(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),p=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.finish(),Eo(ld,this,!1)}selectCells(e){var n=this;const r=uh(e);if(r===my)return!1;if(r===gy)throw new Error(wt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Yf(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),x(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Qe(r.row,u,s-1),g=Qe(r.col,Math.min(i,o),Math.max(i,o))):(f=Qe(r,u,s-1),g=i);const p=this.tableProps.createCellCoords(f,g),C=l===0?0:Qe(p.row,u,-1),E=s-1,y=this.tableProps.createCellCoords(C,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",y,T,p),y.row=C,T.row=E,this.setRangeStartOnly(y,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",y,T,p),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Qe(r.row,Math.min(e,n),Math.max(e,n)),d=Qe(r.col,a,o-1)):(h=e,d=Qe(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Qe(f.col,a,-1),p=o-1,C=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,p);this.runLocalHooks("beforeSelectRows",C,E,f),C.col=g,E.col=p,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",C,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Qe(s.row,-1/0,e-1),col:Qe(s.col,-1/0,n-1)}),i.assign({row:Qe(i.row,-1/0,e-1),col:Qe(i.col,-1/0,n-1)}),o.assign({row:Qe(o.row,0,e-1),col:Qe(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(af,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(af,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}bt(SL,Yn);const RO=/^(\r\n|\n\r|\r|\n)/,roe=/^[^\t\r\n]+/,EO=/^\t/;function ioe(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(EO))t=t.replace(EO,""),n+=1,e[r][n]="";else if(t.match(RO))t=t.replace(RO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(roe);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function uf(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function vl(t,e,n){return(e=ooe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ooe(t){var e=soe(t,"string");return typeof e=="symbol"?e:e+""}function soe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){vl(this,"hot",void 0),vl(this,"metaManager",void 0),vl(this,"tableMeta",void 0),vl(this,"dataSource",void 0),vl(this,"duckSchema",void 0),vl(this,"colToPropCache",void 0),vl(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=ry(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Le(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return AT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Fe(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ue(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ue(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ah(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=sr(this.getSchema()):(g=[],me(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},Mg(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const p=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(p,n));const C=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",C,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:p}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];_R(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return Ak(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];_R(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&fn(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Br(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Br(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&fn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Lc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Lc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return uf(this.getRange(e,n,Lc.DESTINATION_RENDERER))}getCopyableText(e,n){return uf(this.getRange(e,n,Lc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:aoe,getItem:loe,hasItem:RL,getNames:uoe,getValues:iEe}=po("cellTypes");function l_(t){if(!RL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return loe(t)}function wi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Nr(t,n),r&&Xr(t,r),i&&tu(t,i),aoe(t,e)}function coe(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!fn(e,t)}function py(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?l_(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Fe(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Le(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Fe(r,(o,s)=>{if(coe(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),pn(t,i)}function hoe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}u$(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Xp(t){return Number.isInteger(t)&&t>=0}function Jp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Im(t){return t==null}const EL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),en(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),en(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),ny(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function TO(t,e,n){return(e=doe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function doe(t){var e=foe(t,"string");return typeof e=="symbol"?e:e+""}function foe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function goe(){return class{}}class moe{constructor(e){TO(this,"metaCtor",goe()),TO(this,"meta",void 0),this.meta=this.metaCtor.prototype,pn(this.meta,EL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;pn(this.meta,e),py(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function poe(t,e,n){return(e=woe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function woe(t){var e=voe(t,"string");return typeof e=="symbol"?e:e+""}function voe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yoe{constructor(e){poe(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){pn(this.meta,e),py(this.meta,e,e)}}function Pm(t,e,n){return(e=Coe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Coe(t){var e=boe(t,"string");return typeof e=="symbol"?e:e+""}function boe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jw{constructor(e){Pm(this,"valueFactory",void 0),Pm(this,"data",[]),Pm(this,"index",[]),Pm(this,"holes",new Set),this.valueFactory=e}obtain(e){Jp(()=>Xp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Jp(()=>Xp(e)||Im(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Im(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Jp(()=>Xp(e)||Im(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Im(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function MO(t,e,n){return(e=Soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Soe(t){var e=Roe(t,"string");return typeof e=="symbol"?e:e+""}function Roe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Eoe=["data","width"];class Toe{constructor(e){MO(this,"globalMeta",void 0),MO(this,"metas",new jw(()=>this._createMeta())),this.globalMeta=e,this.metas=new jw(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);pn(r,n),py(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return hoe(this.globalMeta.getMetaConstructor(),Eoe).prototype}}function _O(t,e,n){return(e=Moe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Moe(t){var e=_oe(t,"string");return typeof e=="symbol"?e:e+""}function _oe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xoe{constructor(e){_O(this,"columnMeta",void 0),_O(this,"metas",new jw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);pn(i,r),py(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ue(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Jp(()=>Xp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new jw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class TL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new moe(e),this.tableMeta=new yoe(this.globalMeta),this.columnMeta=new Toe(this.globalMeta),this.cellMeta=new xoe(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}bt(TL,Yn);function xO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=or(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":mt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Lc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let p,C=0,E=0;for(C=0,E=d.startRows;C<E;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)p=sr(g),t.push(p);else if(i.dataType==="array")p=sr(g[0]),t.push(p);else{p=[];for(let y=0,T=d.startCols;y<T;y++)p.push(null);t.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ee(i.rootElement,[Bk(-1),Jv(i.countCols()+(i.view?i.countRowHeaders():0))])}function IO(t,e,n){return(e=Ioe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ioe(t){var e=Poe(t,"string");return typeof e=="symbol"?e:e+""}function Poe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ooe{constructor(e){var n=this;IO(this,"metaManager",void 0),IO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),se.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=fn(e,"type")?e.type:null;let c=mt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Aoe(t,e,n){Hoe(t,e),e.set(t,n)}function Hoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lb(t,e,n){return(e=Noe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Noe(t){var e=Doe(t,"string");return typeof e=="symbol"?e:e+""}function Doe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function koe(t,e){return t.get($oe(t,e))}function $oe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var PO=new WeakMap;class Loe{constructor(e){lb(this,"metaManager",void 0),lb(this,"usageTracker",new Set),lb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Aoe(this,PO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,koe(PO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const ML="gridDefault",ol="editorManager.handlingEditor",Foe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Voe="hooksRefRegisterer",_L={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){x(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Fe(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};us(_L,"MIXIN_NAME",Voe,{writable:!1,enumerable:!1});function Wi(t,e,n){return(e=Boe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Boe(t){var e=Woe(t,"string");return typeof e=="symbol"?e:e+""}function Woe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const joe="base",sn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Ih{static get EDITOR_TYPE(){return joe}constructor(e){Wi(this,"hot",void 0),Wi(this,"state",sn.VIRGIN),Wi(this,"_opened",!1),Wi(this,"_fullEditMode",!1),Wi(this,"_closeCallback",null),Wi(this,"TD",null),Wi(this,"row",null),Wi(this,"col",null),Wi(this,"prop",null),Wi(this,"originalValue",null),Wi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:sn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==sn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=sn.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:At(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===sn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===sn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=sn.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=sn.FINISHED,this.discardEditor(s)}):(this.state=sn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=sn.FINISHED,this.discardEditor()}discardEditor(e){this.state===sn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=sn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=sn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===sn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=zn(n),a=ln(n),l=zn(this.hot.rootElement),u=ln(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:p}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=p.name,E=["master","inline_start"].includes(C)?d:0,y=["master","top","bottom"].includes(C)?f:0,T=s.top===l.top?0:1;let _=s.top-l.top-T-E,P=0;this.hot.isRtl()?P=o.innerWidth-s.left-a-g-1+y:P=s.left-l.left-1-y,["top","top_inline_start_corner"].includes(C)&&(_+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(P+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const M=this.hot.hasColHeaders(),I=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),V=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(M&&I<=0||I===V)&&(_+=1),z<=0&&(P+=1);const q=i.rowsRenderCalculator.startPosition,Z=i.columnsRenderCalculator.startPosition,ee=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),he=Nn(this.hot.rootDocument);let Ue=n.offsetTop;if(["inline_start","master"].includes(C)&&(Ue+=q-te),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:K,wtTable:J}=r.bottomOverlay.clone;Ue+=K.getWorkspaceHeight()-J.getHeight()-he}let ve=n.offsetLeft;this.hot.isRtl()?(ve>=0?ve=p.getWidth()-n.offsetLeft:ve=Math.abs(ve),ve+=Z-ee-a):["top","master","bottom"].includes(C)&&(ve+=Z-ee);const He=o.getComputedStyle(this.TD),st=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Cn=parseInt(He[st],10)>0?0:1,ze=parseInt(He.borderTopWidth,10)>0?0:1,m=ln(n)+Cn,v=mn(n)+ze,w=qE(c)?he:0,A=XE(h)?he:0,L=this.hot.view.maximumVisibleElementWidth(ve)-w+Cn,U=Math.max(this.hot.view.maximumVisibleElementHeight(Ue)-A+ze,this.hot.view.getDefaultRowHeight());return{top:_,start:P,height:v,maxHeight:U,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}bt(Ih,_L);const Uoe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===sn.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},zoe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},Yoe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Goe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Koe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),ki(e))}};function qoe(){return[Foe,Uoe,zoe,Yoe,Goe,Koe]}const Xoe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},Joe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},Zoe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},Qoe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},ese={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},tse={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},nse={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},rse={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},ise={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},ose={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},sse={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},ase={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},lse={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},use={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function cse(){return[Xoe,Joe,Zoe,Qoe,ese,tse,nse,rse,ise,ose,sse,ase,lse,use]}const hse={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},dse={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},fse={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},gse={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},mse={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},pse={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},wse={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},vse={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},yse={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Cse={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},bse={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Sse={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Rse={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},Ese={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},Tse={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Mse={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function _se(){return[hse,dse,fse,gse,mse,pse,wse,vse,yse,Cse,bse,Sse,Rse,Ese,Tse,Mse]}const xse={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Ise={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Pse={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Ose={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Ase={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Hse=[...qoe(),...cse(),..._se(),xse,Ise,Pse,Ose,Ase];function xL(t){const e={};return Hse.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Nse(t){const e=t.getShortcutManager().addContext("editor"),n=xL(t),r={group:ol};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function Dse(t){const e=t.getShortcutManager().addContext("grid"),n=xL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:ML};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:ol,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function kse(t){[Dse,Nse].forEach(e=>e(t))}function $se(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=OO(t),i=OO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function OO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ee(n,[Lf("Focus catcher")]),n}function Lse(t){const e=Fse(t);let n;const{activate:r,deactivate:i}=$se(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:JR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:ZR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,p)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,p.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:ML,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?JR(t):ZR(t)),u(),!1;h.preventDefault()},position:"after"}])}function JR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function ZR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function Fse(t){return e=>{if(!e)return null;const n=JR(t),r=ZR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Ph(t){Qo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function wy(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,p=f<=h,C=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:p&&C?r.highlight.row:p?f:C?g:E.row}}}function Vse(t){return e=>{const n=wy(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Ph(t.getCell(r?-1:0,n,!0))})}}function Bse(){return()=>{}}function Wse(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Ph(t.getCell(n,r,!0))})}}function jse(t){return e=>{const n=wy(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Ph(t.getCell(i,o,!0))})}}function Use(t){return e=>{const n=wy(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Ph(t.getCell(i,o,!0))})}}function zse(t){return e=>{const n=wy(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Ph(t.getCell(n,r?-1:0,!0))})}}function Yse(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Ph(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function Gse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=Wse(t):e.isSelectedByCorner()?s=Bse():e.isSelectedByRowHeader()?s=zse(t):e.isSelectedByColumnHeader()?s=Vse(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=jse(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=Yse(t):e.getSelectedRange().size()>1&&(s=Use(t)),(o=s)===null||o===void 0||o(i)}}}const AO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Om=t=>t.map(e=>{const n=e.toLowerCase();return AO.has(n)?AO.get(n):n}).sort().join("+"),Kse=t=>t.split("+"),HO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),ub=t=>{let{which:e,key:n}=t;if(HO.has(e))return HO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},IL=Symbol("shortcut-context");function PL(t){return Le(t)&&t.__kindOf===IL}const qse=t=>{const e=sy({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:p,position:C,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Vt(c))throw new Error("You need to define the shortcut's group.");if(mt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(wt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const y={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};ue(p)&&(y.relativeToGroup=p,y.position=C),PL(E)&&(y.forwardToContext=E),l.forEach(T=>{const _=Om(T);if(e.hasItem(_)){const M=e.getItem(_);let I=M.findIndex(z=>z.group===p);I!==-1?C==="before"?I-=1:I+=1:I=M.length,M.splice(I,0,y)}else e.addItem(_,[y])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Fe(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Om(l);e.removeItem(u)};return{__kindOf:IL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Om(l),c=e.getItem(u);return ue(c)?c.slice():[]},hasShortcut:l=>{const u=Om(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(Kse(h)):(d.length=0,d.push(...f))})}}};function Xse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Jse=["meta","alt","shift","control"],cd=Xse(),hd=[];let Am=0;function Zse(t,e,n,r,i){const o=f=>Jse.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),g&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Oa(f))return;const p=ub(f);let C=[];o(p)||(C=s(f));const E=[p].concat(C);!i(f,E)&&($w()&&C.includes("meta")||!$w()&&C.includes("control"))&&i(f,[p].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=ub(f);o(g)&&cd.press(g)}},u=f=>{if(typeof f.key=="string"){const g=ub(f);o(g)&&cd.release(g)}},c=()=>{cd.releaseAll()};return{mount:()=>{let f=t;for(Am+=1;f;)Am===1&&(f.document.documentElement.addEventListener("keydown",l),hd.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),hd.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=wu(f)},unmount:()=>{let f=t;for(Am-=1;f;){if(Am===0){for(let g=0;g<hd.length;g++){const{event:p,listener:C}=hd[g];f.document.documentElement.removeEventListener(p,C)}hd.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=wu(f)}},isPressed:f=>cd.isPressed(f),releasePressedKeys:()=>cd.releaseAll()}}const Qse=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=sy({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const p=qse(g);return o.addItem(g,p),p},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(wt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,p){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=PL(C)?C:u(C);let y=!1;if(!E.hasShortcut(p))return y;const T=E.getShortcuts(p);for(let _=0;_<T.length;_++){const{callback:P,runOnlyIf:M,preventDefault:I,stopPropagation:z,captureCtrl:W,forwardToContext:V}=T[_];if(M(g)===!0){if(h=W,y=P(g,p)===!1,h=!1,I&&g.preventDefault(),z&&(ki(g),g.stopPropagation()),y)break;V&&d(g,p,V)}}return y},f=Zse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function NO(t){const{classNames:e}=Yk(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let cb=null;const hb=new Map;function OL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Pi(o);let a,l,u,c,h,d,f=!0;vre(i)&&wre(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",p=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=Pie(e.language);const C=Object.fromEntries(Object.entries(e).filter(m=>{let[v]=m;return!(se.getSingleton().isRegistered(v)||se.getSingleton().isDeprecated(v))})),E=new TL(o,C,[Ooe,Loe]),y=E.getTableMeta(),T=E.getGlobalMeta(),_=sy();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),qp(this)&&($k(e.licenseKey,t),X(t,"ht-wrapper")),this.guid=`ht_${FE()}`,hb.set(this.guid,this),this.columnIndexMapper=new KR,this.rowIndexMapper=new KR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new Vre(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=m=>{const{row:v,col:w}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getRenderableFromVisualIndex(v):v,w>=0?o.columnIndexMapper.getRenderableFromVisualIndex(w):w)},M=m=>{const{row:v,col:w}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getVisualFromRenderableIndex(v):v,w>=0?o.columnIndexMapper.getVisualFromRenderableIndex(w):w)},I=(m,v)=>{const w=v>m?1:-1,A=Math.min(m,v),L=Math.max(m,v),U=o.rowIndexMapper.getNearestNotHiddenIndex(m,w);return U===null||w===1&&U>L||w===-1&&U<A?null:U>=0?o.rowIndexMapper.getRenderableFromVisualIndex(U):U},z=(m,v)=>{const w=v>m?1:-1,A=Math.min(m,v),L=Math.max(m,v),U=o.columnIndexMapper.getNearestNotHiddenIndex(m,w);return U===null||w===1&&U>L||w===-1&&U<A?null:U>=0?o.columnIndexMapper.getRenderableFromVisualIndex(U):U};let W=new SL(y,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,v)=>o._createCellCoords(m,v),createCellRange:(m,v,w)=>o._createCellRange(m,v,w),visualToRenderableCoords:P,renderableToVisualCoords:M,findFirstNonHiddenRenderableRow:I,findFirstNonHiddenRenderableColumn:z,isDisabledCellSelection:(m,v)=>m<0||v<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,v).disableVisualSelection});this.selection=W;const V=m=>{let{hiddenIndexesChanged:v}=m;this.forceFullRender=!0,v&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("afterSetRangeEnd",(m,v)=>{const w=Br(!1),A=this.selection.getSelectedRange(),{from:L,to:U}=A.current(),K=A.size()-1;this.runHooks("afterSelection",L.row,L.col,U.row,U.col,w,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),U.row,o.colToProp(U.col),w,K),v&&(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m);const J=W.isSelectedByRowHeader(),b=W.isSelectedByColumnHeader();J&&b?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(ye(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):b?(ye(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):ye(this.rootElement,["ht__selection--rows","ht__selection--columns"]),W.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const v=Br(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,v),(!v.isTouched()||v.isTouched()&&!v.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const v=m.length-1,{from:w,to:A}=m[v];this.runHooks("afterSelectionEnd",w.row,w.col,A.row,A.col,v),this.runHooks("afterSelectionEndByProp",w.row,o.colToProp(w.col),A.row,o.colToProp(A.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const v=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=v)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),ye(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...v)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...v)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...v)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSelectColumns",...v)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterSelectColumns",...v)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSelectRows",...v)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterSelectRows",...v)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformStart",...v)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...v)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformFocus",...v)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformFocus",...v)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformEnd",...v)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...v)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeRowWrap",...v)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeColumnWrap",...v)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const U=K=>{if(K.length===0)return[];const J=[...K];return J.sort((R,S)=>{let[$]=R,[O]=S;return $===O?0:$>O?1:-1}),In(J,(R,S)=>{let[$,O]=S;const N=R[R.length-1],[j,H]=N,D=j+H;if($<=D){const B=Math.max(O-(D-$),0);N[1]+=B}else R.push([$,O]);return R},[J[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(y.maxRows===K)return;const J=m==="insert_row_below"?"below":"above";v=v??(J==="below"?K:0);const{delta:b,startPhysicalIndex:R}=a.createRow(v,w,{source:A,mode:J});W.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";v=v??(S==="end"?o.countSourceCols():0);const{delta:$,startPhysicalIndex:O}=a.createCol(v,w,{source:A,mode:S});if($){if(Array.isArray(y.colHeaders)){const H=[o.toVisualColumn(O),0];H.length+=$,Array.prototype.splice.apply(y.colHeaders,H)}W.shiftColumns(o.toVisualColumn(O),$)}break;case"remove_row":const N=H=>{let D=0;x(H,B=>{let[F,G]=B;const le=en(F)?o.countRows()-1:Math.max(F-D,0);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeRow(F,G,A))return;if(W.isSelected()){const{row:xe}=o.getSelectedRangeLast().highlight;xe>=F&&xe<=F+G-1&&c.closeEditor(!0)}const Ie=o.countRows(),We=y.fixedRowsTop;We>=le+1&&(y.fixedRowsTop-=Math.min(G,We-le));const Ze=y.fixedRowsBottom;Ze&&le>=Ie-Ze&&(y.fixedRowsBottom-=Math.min(G,Ze)),Ie===0?W.deselect():A==="ContextMenu.removeRow"?W.refresh():W.shiftRows(F,-G),D+=G})};Array.isArray(v)?N(U(v)):N([[v,w]]);break;case"remove_col":const j=H=>{let D=0;x(H,B=>{let[F,G]=B;const le=en(F)?o.countCols()-1:Math.max(F-D,0);let de=o.toPhysicalColumn(le);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeCol(F,G,A))return;if(W.isSelected()){const{col:xe}=o.getSelectedRangeLast().highlight;xe>=F&&xe<=F+G-1&&c.closeEditor(!0)}o.countCols()===0?W.deselect():A==="ContextMenu.removeColumn"?W.refresh():W.shiftColumns(F,-G);const Ze=y.fixedColumnsStart;Ze>=le+1&&(y.fixedColumnsStart-=Math.min(G,Ze-le)),Array.isArray(y.colHeaders)&&(typeof de>"u"&&(de=-1),y.colHeaders.splice(de,G)),D+=G})};Array.isArray(v)?j(U(v)):j([[v,w]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=y.minRows,v=y.minSpareRows,w=y.minCols,A=y.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(v){const L=o.countEmptyRows(!0);if(L<v){const U=v-L,K=Math.min(U,y.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(w||A)&&(L=o.countEmptyCols(!0));let U=o.countCols();if(w&&!y.columns&&U<w){const K=w-U;L+=K,a.createCol(U,K,{source:"auto"})}if(A&&!y.columns&&o.dataType==="array"&&L<A){U=o.countCols();const K=A-L,J=Math.min(K,y.maxCols-U);a.createCol(U,J,{source:"auto"})}}},populateFromArray(m,v,w,A,L){let U,K,J,b;const R=[],S={},$=[],O=m.row,N=m.col;if(K=v.length,K===0)return!1;let j=0,H=0;switch(Le(w)&&(j=w.col-N+1,H=w.row-O+1),L){case"shift_down":const D=tf(v),B=D.length,F=Math.max(B,j),G=o.getData().slice(O),le=tf(G).slice(N,N+F);for(J=0;J<F;J+=1)if(J<B){for(U=0,K=D[J].length;U<H-K;U+=1)D[J].push(D[J][U%K]);J<le.length?$.push(D[J].concat(le[J])):$.push(D[J].concat(new Array(G.length).fill(null)))}else $.push(D[J%B].concat(le[J]));o.populateFromArray(O,N,tf($));break;case"shift_right":const de=v.length,Ie=Math.max(de,H),We=o.getData().slice(O).map(Dt=>Dt.slice(N));for(U=0;U<Ie;U+=1)if(U<de){for(J=0,b=v[U].length;J<j-b;J+=1)v[U].push(v[U][J%b]);if(U<We.length)for(let Dt=0;Dt<We[U].length;Dt+=1)v[U].push(We[U][Dt]);else v[U].push(...new Array(We[0].length).fill(null))}else v.push(v[U%K].slice(0,Ie).concat(We[U]));o.populateFromArray(O,N,v);break;case"overwrite":default:S.row=m.row,S.col=m.col;let Ze=0,xe=0,Ge=!0,Nt;const Li=function(bn){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const kt=v[bn%v.length];return _t!==null?kt[_t%kt.length]:kt},hs=v.length,ci=w?w.row-m.row+1:0;for(w?K=ci:K=Math.max(hs,ci),U=0;U<K&&!(w&&S.row>w.row&&ci>hs||!y.allowInsertRow&&S.row>o.countRows()-1||S.row>=y.maxRows);U++){const Dt=U-Ze,bn=Li(Dt).length,_t=w?w.col-m.col+1:0;if(w?b=_t:b=Math.max(bn,_t),S.col=m.col,Nt=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&Nt.skipRowOnPaste){Ze+=1,S.row+=1,K+=1;continue}for(xe=0,J=0;J<b&&!(w&&S.col>w.col&&_t>bn||!y.allowInsertColumn&&S.col>o.countCols()-1||S.col>=y.maxCols);J++){if(Nt=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&Nt.skipColumnOnPaste){xe+=1,S.col+=1,b+=1;continue}if(Nt.readOnly&&A!=="UndoRedo.undo"){S.col+=1;continue}const kt=J-xe;let Ke=Li(Dt,kt),hi=o.getDataAtCell(S.row,S.col);if(Ke!==null&&typeof Ke=="object")if(Array.isArray(Ke)&&hi===null&&(hi=[]),hi===null||typeof hi!="object")Ge=!1;else{const sl=ah(Array.isArray(hi)?hi:hi[0]||hi),al=ah(Array.isArray(Ke)?Ke:Ke[0]||Ke);ny(sl,al)||Array.isArray(sl)&&Array.isArray(al)?Ke=sr(Ke):Ge=!1}else hi!==null&&typeof hi=="object"&&(Ge=!1);Ge&&R.push([S.row,S.col,Ke]),Ge=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,A||"populateFromArray");break}}};function q(m){const v=cL(m);s_(v)?(o.runHooks("beforeLanguageChange",v),T.language=v,o.runHooks("afterLanguageChange",v)):hL(m)}function Z(m,v){const w=m==="className"?o.rootElement:o.table;if(f)X(w,v);else{let A=[],L=[];T[m]&&(A=Array.isArray(T[m])?T[m]:IR(T[m])),v&&(L=Array.isArray(v)?v:IR(v));const U=xR(A,L),K=xR(L,A);U.length&&ye(w,U),K.length&&X(w,K)}T[m]=v}this.init=function(){l.setData(y.data),o.runHooks("beforeInit"),(Jo()||iT())&&X(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Sre(this);const m=y.themeName||NO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=LR.getInstance(o,y,W),d=Gse(o),h=new zZ(o),qp(this)&&Lse(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&t$(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function ee(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const v=m.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):m}function he(m,v,w){if(!m.length){w();return}const A=o.getActiveEditor(),L=new ee;let U=!0;L.onQueueEmpty=()=>{A&&U&&A.cancelChanges(),w()};for(let K=m.length-1;K>=0;K--){const[J,b]=m[K],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(J,R):S={...Object.getPrototypeOf(y),...y},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function($,O){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&O.allowInvalid===!1&&(U=!1,m.splice($,1),O.valid=!0),L.removeValidatorFormQueue()}}(K,S),v))}L.checkIfQueueIsEmpty()}function Ue(m,v){for(let A=m.length-1;A>=0;A--){let L=!1;if(m[A]===null){m.splice(A,1);continue}if(!((m[A][2]===null||m[A][2]===void 0)&&(m[A][3]===null||m[A][3]===void 0))){if(y.allowInsertRow)for(;m[A][0]>o.countRows()-1;){const{delta:U}=a.createRow(void 0,void 0,{source:"auto"});if(U===0){L=!0;break}}if(o.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(m[A][1])>o.countCols()-1;){const{delta:U}=a.createCol(void 0,void 0,{source:"auto"});if(U===0){L=!0;break}}L||a.set(m[A][0],m[A][1],m[A][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,v),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,v||"edit");const A=o.getActiveEditor();A&&ue(A.refreshValue)&&A.refreshValue()}else o.render()}this._createCellCoords=function(m,v){return o.view._wt.createCellCoords(m,v)},this._createCellRange=function(m,v,w){return o.view._wt.createCellRange(m,v,w)},this.validateCell=function(m,v,w,A){let L=o.getCellValidator(v);function U(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||v.hidden===!0){w(K);return}const b=v.visualCol,R=v.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const $=o.rowIndexMapper.getRenderableFromVisualIndex(R),O=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",$,O,S)}w(K)}kk(L)&&(L=function(K){return function(J,b){b(K.test(J))}}(L)),mt(L)?(m=o.runHooks("beforeValidate",m,v.visualRow,v.prop,A),o._registerImmediate(()=>{L.call(v,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,v.visualRow,v.prop,A),v.valid=K,U(K),o.runHooks("postAfterValidate",K,m,v.visualRow,v.prop,A))})})):o._registerImmediate(()=>{v.valid=!0,U(v.valid,!1)})};function ve(m,v,w){return Array.isArray(m)?m:[[m,v,w]]}function He(m,v){const w=o.runHooks("beforeChange",m,v||"edit"),A=m.filter(U=>U!==null);if(w===!1||A.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let U=A.length-1;U>=0;U--){const[K,J,,b]=A[U],R=a.propToCol(J);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(y),...y};const{type:$,checkedTemplate:O,uncheckedTemplate:N}=S;if($==="numeric"&&typeof b=="string"&&O$(b)&&(A[U][3]=te(b)),$==="checkbox"){const j=At(b),H=j===At(O),D=j===At(N);(H||D)&&(A[U][3]=H?O:N)}}return A}this.setDataAtCell=function(m,v,w,A){const L=ve(m,v,w),U=[];let K=A,J,b,R;for(J=0,b=L.length;J<b;J++){if(typeof L[J]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[J][1]>=this.countCols()?R=L[J][1]:R=a.colToProp(L[J][1]),U.push([L[J][0],R,l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]])}!K&&typeof m=="object"&&(K=v);const S=He(U,K);o.runHooks("afterSetDataAtCell",S,K),he(S,K,()=>{Ue(S,K)})},this.setDataAtRowProp=function(m,v,w,A){const L=ve(m,v,w),U=[];let K=A,J,b;for(J=0,b=L.length;J<b;J++)U.push([L[J][0],L[J][1],l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]]);!K&&typeof m=="object"&&(K=v);const R=He(U,A);o.runHooks("afterSetDataAtRowProp",R,K),he(R,K,()=>{Ue(R,K)})},this.listen=function(){o&&!o.isListening()&&(hb.forEach(m=>{o!==m&&m.unlisten()}),cb=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(cb=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return cb===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),v&&W.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,v,w,A,L,U,K){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const J=typeof A=="number"?o._createCellCoords(A,L):null;return u.populateFromArray(o._createCellCoords(m,v),w,J,U,K)},this.spliceCol=function(m,v,w){for(var A=arguments.length,L=new Array(A>3?A-3:0),U=3;U<A;U++)L[U-3]=arguments[U];return a.spliceCol(m,v,w,...L)},this.spliceRow=function(m,v,w){for(var A=arguments.length,L=new Array(A>3?A-3:0),U=3;U<A;U++)L[U-3]=arguments[U];return a.spliceRow(m,v,w,...L)},this.getSelected=function(){if(W.isSelected())return Je(W.getSelectedRange(),m=>{let{from:v,to:w}=m;return[v.row,v.col,w.row,w.col]})},this.getSelectedLast=function(){const m=this.getSelected();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.getSelectedRange=function(){if(W.isSelected())return Array.from(W.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.emptySelectedCells=function(m){if(!W.isSelected()||this.countRows()===0||this.countCols()===0)return;const v=[];x(W.getSelectedRange(),w=>{if(w.isSingleHeader())return;const A=w.getTopStartCorner(),L=w.getBottomEndCorner();me(A.row,L.row,U=>{me(A.col,L.col,K=>{this.getCellMeta(U,K).readOnly||v.push([U,K,null])})})}),v.length>0&&this.setDataAtCell(v,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const v=m();return this.resumeRender(),v},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(v,0),(!this.isExecutionSuspended()&&v===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=m();return this.resumeExecution(v),w},this.batch=function(m){this.suspendRender(),this.suspendExecution();const v=m();return this.resumeExecution(),this.resumeRender(),v},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:v,height:w}=m.getLastSize(),{width:A,height:L}=o.rootElement.getBoundingClientRect(),U=A!==v||L!==w;o.runHooks("beforeRefreshDimensions",{width:v,height:w},{width:A,height:L},U)!==!1&&((U||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(A,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:v,height:w},{width:A,height:L},U))},this.updateData=function(m,v){xO(m,w=>{a=w},w=>{a=w,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),W.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:v,metaManager:E,firstRun:f})},this.loadData=function(m,v){xO(m,w=>{a=w},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),W.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:v,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=y.columns;let v=0;if(Array.isArray(m))v=m.length;else if(mt(m))if(o.dataType==="array"){const w=this.countSourceCols();for(let A=0;A<w;A+=1)m(A)&&(v+=1)}else(o.dataType==="object"||o.dataType==="function")&&(v=a.colToPropCache.length);else if(ue(y.dataSchema)){const w=a.getSchema();v=Array.isArray(w)?w.length:ry(w)}else v=this.countSourceCols();return v},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,v,w,A){return Vt(m)?a.getAll():a.getRange(o._createCellCoords(m,v),o._createCellCoords(w,A),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,v,w,A){return a.getCopyableText(o._createCellCoords(m,v),o._createCellCoords(w,A))},this.getCopyableData=function(m,v){return a.getCopyable(m,a.colToProp(v))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(f?o.loadData:o.updateData).bind(this);let A=!1,L,U;if(ue(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&q(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")Z("className",m.className);else if(L==="tableClassName"&&o.table)Z("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(se.getSingleton().isRegistered(L)||se.getSingleton().isDeprecated(L)){const S=m[L];mt(S)?(se.getSingleton().addAsFixed(L,S,o),y[L]=S):Array.isArray(S)&&(se.getSingleton().add(L,S,o),y[L]=S)}else!v&&fn(m,L)&&(T[L]=m[L]);m.data===void 0&&y.data===void 0?w(null,"updateSettings"):m.data!==void 0?w(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),J=y.columns;if(J&&mt(J)&&(A=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),K>0)for(L=0,U=0;L<K;L++){if(J){const S=A?J(L):J[U];S&&E.updateColumnMeta(U,S)}U+=1}ue(m.cell)&&Fe(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(mt(R)&&(R=R()),v&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;mt(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!v){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),$=fn(m,"themeName");S&&$&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const O=$&&m.themeName||NO(o.rootElement);o.useTheme(O),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!v&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(y.getValue){if(mt(y.getValue))return y.getValue.call(o);if(m)return o.getData()[m[0][0]][y.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,v,w,A,L){u.alter(m,v,w,A,L)},this.getCell=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=v,L=m;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||A===null||L===void 0||A===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,A),w)},this.getCoords=function(m){const v=this.view._wt.wtTable.getCoords(m);if(v===null)return null;const{row:w,col:A}=v;let L=w,U=A;return w>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(w)),A>=0&&(U=this.columnIndexMapper.getVisualFromRenderableIndex(A)),o._createCellCoords(L,U)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,v){return a.get(m,a.colToProp(v))},this.getDataAtRowProp=function(m,v){return a.get(m,v)},this.getDataAtCol=function(m){const v=[],w=a.getRange(o._createCellCoords(0,m),o._createCellCoords(y.data.length-1,m),a.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let L=0;L<w[A].length;L+=1)v.push(w[A][L]);return v},this.getDataAtProp=function(m){const v=[],w=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(y.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let L=0;L<w[A].length;L+=1)v.push(w[A][L]);return v},this.getSourceData=function(m,v,w,A){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(w,A)),L},this.getSourceDataArray=function(m,v,w,A){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(w,A),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,v,w,A){const L=ve(m,v,w),U=this.hasHook("afterSetSourceDataAtCell"),K=[];U&&x(L,b=>{let[R,S,$]=b;K.push([R,S,l.getAtCell(R,S),$])}),x(L,b=>{let[R,S,$]=b;l.setAtCell(R,S,$)}),U&&this.runHooks("afterSetSourceDataAtCell",K,A),this.render();const J=o.getActiveEditor();J&&ue(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,v){return l.getAtCell(m,v)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,v,w,A){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,v,w,A],[U,K]=L;let[,,J,b]=L,R=null,S=null;J===void 0&&(J=U),b===void 0&&(b=K);let $="mixed";return me(Math.max(Math.min(U,J),0),Math.max(U,J),O=>{let N=!0;return me(Math.max(Math.min(K,b),0),Math.max(K,b),j=>(S=this.getCellMeta(O,j).type,R?N=R===S:R=S,N)),$=N?S:"mixed",N}),$},this.removeCellMeta=function(m,v,w){const[A,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(v)];let U=E.getCellMetaKeyValue(A,L,w);o.runHooks("beforeRemoveCellMeta",m,v,w,U)!==!1&&(E.removeCellMeta(A,L,w),o.runHooks("afterRemoveCellMeta",m,v,w,U)),U=null},this.spliceCellsMeta=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,A=new Array(w>2?w-2:0),L=2;L<w;L++)A[L-2]=arguments[L];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&E.removeRow(this.toPhysicalRow(m),v),A.length>0&&x(A.reverse(),U=>{E.createRow(this.toPhysicalRow(m)),x(U,(K,J)=>this.setCellMetaObject(m,J,K))}),o.render()},this.setCellMetaObject=function(m,v,w){typeof w=="object"&&Fe(w,(A,L)=>{this.setCellMeta(m,v,L,A)})},this.setCellMeta=function(m,v,w,A){if(o.runHooks("beforeSetCellMeta",m,v,w,A)===!1)return;let U=m,K=v;m<this.countRows()&&(U=this.toPhysicalRow(m)),v<this.countCols()&&(K=this.toPhysicalColumn(v)),E.setCellMeta(U,K,w,A),o.runHooks("afterSetCellMeta",m,v,w,A)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},A=this.toPhysicalRow(m),L=this.toPhysicalColumn(v);return A===null&&(A=m),L===null&&(L=v),E.getCellMeta(A,L,{visualRow:m,visualColumn:v,...w})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||y.columns)},this.getCellRenderer=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).renderer:m.renderer;return typeof w=="string"?Vw(w):Vt(w)?Vw("text"):w},this.getCellEditor=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).editor:m.editor;return typeof w=="string"?Fw(w):Vt(w)?Fw("text"):w},this.getCellValidator=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).validator:m.validator;return typeof w=="string"?fT(w):w},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,v){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,m)},this.validateColumns=function(m,v){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,m)},this._validateCells=function(m,v,w){const A=new ee;m&&(A.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(v!==void 0&&v.indexOf(L)===-1){L-=1;continue}let U=o.countCols()-1;for(;U>=0;){if(w!==void 0&&w.indexOf(U)===-1){U-=1;continue}A.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,U),o.getCellMeta(L,U),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),U-=1}L-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let v=y.rowHeaders,w=m;return w!==void 0&&(w=o.runHooks("modifyRowHeader",w)),w===void 0?(v=[],me(o.countRows()-1,A=>{v.push(o.getRowHeader(A))})):Array.isArray(v)&&v[w]!==void 0?v=v[w]:mt(v)?v=v(w):v&&typeof v!="string"&&typeof v!="number"&&(v=w+1),v},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let m=0,v=o.countCols();m<v;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=o.runHooks("modifyColHeader",m);if(w===void 0){const J=[],b=o.countCols();for(let R=0;R<b;R++)J.push(o.getColHeader(R));return J}let A=y.colHeaders;const L=function(J){const b=[],R=o.countCols();let S=0;for(;S<R;S++)mt(y.columns)&&y.columns(S)&&b.push(S);return b[J]},U=o.toPhysicalColumn(w),K=L(U);return y.colHeaders===!1?A=null:y.columns&&mt(y.columns)&&y.columns(K)&&y.columns(K).title?A=y.columns(K).title:y.columns&&y.columns[U]&&y.columns[U].title?A=y.columns[U].title:Array.isArray(y.colHeaders)&&y.colHeaders[U]!==void 0?A=y.colHeaders[U]:mt(y.colHeaders)?A=y.colHeaders(U):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(A=uy(w)),A=o.runHooks("modifyColumnHeaderValue",A,m,v),A},this._getColWidthFromSettings=function(m){let v;if(m>=0&&(v=o.getCellMeta(0,m).width),(v===void 0||v===y.width)&&(v=y.colWidths),v!=null){switch(typeof v){case"object":v=v[m];break;case"function":v=v(m);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(m,v){let w=o._getColWidthFromSettings(m);return w=o.runHooks("modifyColWidth",w,m,v),w===void 0&&(w=lh),w},this._getRowHeightFromSettings=function(m){const v=this.view.getDefaultRowHeight();let w=y.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w!=null&&w<v?v:w},this.getRowHeight=function(m,v){let w=o._getRowHeightFromSettings(m);return w=o.runHooks("modifyRowHeight",w,m,v),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=y.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,v)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return BR(o.countRows()-1,w=>{if(o.isEmptyRow(w))v+=1;else if(m===!0)return!1}),v},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return BR(o.countCols()-1,w=>{if(o.isEmptyCol(w))v+=1;else if(m===!0)return!1}),v},this.isEmptyRow=function(m){return y.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return y.isEmptyCol.call(o,m)},this.selectCell=function(m,v,w,A){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,U=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Vt(m)||Vt(v)?!1:this.selectCells([[m,v,w,A]],L,U)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;v===!1&&d.suspend();const A=W.selectCells(m);return A&&w&&o.listen(),d.resume(),A},this.selectColumns=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;return W.selectColumns(m,v,w)},this.selectRows=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;return W.selectRows(m,v,w)},this.deselectCell=function(){W.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),W.selectAll(m,v,w)};const st=(m,v)=>m.getNearestNotHiddenIndex(v,1,!0);this.scrollViewportTo=function(m,v){if(typeof m=="number"){var w;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:A,col:L,considerHiddenIndexes:U}=m??{};let K=A,J=L;if(mt(v)&&this.addHookOnce("afterScroll",v),U===void 0||U){const $=Number.isInteger(A)&&A>=0,O=Number.isInteger(L)&&L>=0,N=$?st(this.rowIndexMapper,A):void 0,j=O?st(this.columnIndexMapper,L):void 0;if(N===null||j===null)return!1;K=$?o.rowIndexMapper.getRenderableFromVisualIndex(N):A,J=O?o.columnIndexMapper.getRenderableFromVisualIndex(j):L}const b=Number.isInteger(K),R=Number.isInteger(J);let S=!1;return b&&K>=0&&R&&J>=0?S=o.view.scrollViewport(o._createCellCoords(K,J),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(R&&J<0||!R)?S=o.view.scrollViewportVertically(K,m.verticalSnap):R&&J>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(J,m.horizontalSnap)),mt(v)&&(S?this.view.render():(this.removeHook("afterScroll",v),this._registerMicrotask(()=>v()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;mt(m)&&this.addHookOnce("afterScroll",m);const{highlight:v}=this.getSelectedRangeLast(),w=this.scrollViewportTo(v.toObject());return w?this.view.render():mt(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),w},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),hb.delete(this.guid),qp(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}rs(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(m=>{let[,v]=m;v.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),se.getSingleton().destroy(o),Fe(o,(m,v,w)=>{mt(m)?w[v]=Cn(v):v!=="guid"&&(w[v]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,W=null,c=null,o=null};function Cn(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return _.getItem(or(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,v,w){se.getSingleton().add(m,v,o,w)},this.hasHook=function(m){return se.getSingleton().has(m,o)||se.getSingleton().has(m)},this.addHookOnce=function(m,v,w){se.getSingleton().once(m,v,o,w)},this.removeHook=function(m,v){se.getSingleton().remove(m,v,o)},this.runHooks=function(m,v,w,A,L,U,K){return se.getSingleton().run(o,m,v,w,A,L,U,K)},this.getTranslatedPhrase=function(m,v){return wL(y.language,m,v)},this.toHTML=()=>FR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",FR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=m;typeof w=="function"&&(w=setTimeout(w,v)),this.timeouts.push(w)},this._clearTimeouts=function(){x(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){x(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const ze=Qse({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&ze.releasePressedKeys()}),this.getShortcutManager=function(){return ze},this.getFocusManager=function(){return h},dT().forEach(m=>{const v=_g(m);_.addItem(m,new v(this))}),kse(o),ze.setActiveContextName("grid"),se.getSingleton().run(o,"construct")}function DO(t,e,n){t.addEventListener(e,n,!1)}function kO(t,e,n){t.removeEventListener(e,n,!1)}function Hm(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function AL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Hm(s).fontSize,o.style.fontFamily=Hm(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Hm(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=Hm(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),p=o.clientWidth+f+g+1;r.removeChild(o);const C=s.style;C.height=`${n.minHeight}px`,n.minWidth>p?C.width=`${n.minWidth}px`:p>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${p}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?C.height=`${n.minHeight}px`:n.maxHeight<E?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(DO(s,"input",a),DO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){kO(s,"input",a),kO(s,"keydown",l)}}}function $O(t,e){const n=KE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Sg(e,i)}function yl(t,e,n){return(e=eae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eae(t){var e=tae(t,"string");return typeof e=="symbol"?e:e+""}function tae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nae="ht_editor_visible",Nm="ht_editor_hidden",LO="textEditor",rae="text";class Fu extends Ih{static get EDITOR_TYPE(){return rae}constructor(e){super(e),yl(this,"eventManager",new Pi(this)),yl(this,"autoResize",AL(this.hot.rootDocument)),yl(this,"TEXTAREA",void 0),yl(this,"textareaStyle",void 0),yl(this,"TEXTAREA_PARENT",void 0),yl(this,"textareaParentStyle",void 0),yl(this,"layerClass",void 0),this.eventManager=new Pi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),of(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==sn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===sn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Sg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ee(this.TEXTAREA,[["data-hot-input",""],Nu(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),be(this.TEXTAREA_PARENT,this.layerClass)&&ye(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Nm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){w$()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ye(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Nm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;me(e.length-1,r=>{const i=e[r];if(be(i,"handsontableEditor"))return n=!0,!1}),be(this.TEXTAREA_PARENT,Nm)&&ye(this.TEXTAREA_PARENT,Nm),n?(this.layerClass=nae,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==sn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){rT()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===sn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===sn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ue(this.hot.getSelected()),group:LO},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;$O(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;$O(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(LO)}}const iae="base";function Ag(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(pP())):a&&c.push(pP()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(wP())):(u.push(s.invalidCellClassName),a&&c.push(wP()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),ye(e,u),X(e,l),ku(e,c),Ee(e,h)}Ag.RENDERER_TYPE=iae;const oae="text";function sa(t,e,n,r,i,o,s){Ag.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=At(a),s.trimWhitespace&&(a=a.trim()),Za(e,a)}sa.RENDERER_TYPE=oae;const sae="text",HL={CELL_TYPE:sae,editor:Fu,renderer:sa};wi(HL);_e.editors={BaseEditor:Ih};function _e(t,e){const n=new OL(t,e||{},PT);return n.init(),n}_e.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new OL(t,e,PT)};_e.DefaultSettings=EL();_e.hooks=se.getSingleton();_e.CellCoords=yu;_e.CellRange=xg;_e.packageName="handsontable";_e.buildDate="24/04/2025 10:59:00";_e.version="15.3.0";_e.languages={dictionaryKeys:Rie,getLanguageDictionary:pL,getLanguagesDictionaries:xie,registerLanguageDictionary:mL,getTranslatedPhrase:wL};const FO="handsontableEditor",aae="handsontable";class u_ extends Fu{static get EDITOR_TYPE(){return aae}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Sg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&pn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:FO,relativeToGroup:ol,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),ki(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FO)}}function lae(t,e){NL(t,e),e.add(t)}function VO(t,e,n){NL(t,e),e.set(t,n)}function NL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dm(t,e,n){return(e=uae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uae(t){var e=cae(t,"string");return typeof e=="symbol"?e:e+""}function cae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function db(t,e){return t.get(QR(t,e))}function QR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hae="autocomplete";var fb=new WeakMap,BO=new WeakMap,gb=new WeakSet;class c_ extends u_{constructor(){super(...arguments),lae(this,gb),Dm(this,"query",null),Dm(this,"strippedChoices",[]),Dm(this,"rawChoices",[]),VO(this,fb,this.hot.guid.slice(0,9)),VO(this,BO,Eg(()=>{this.focus()},100)),Dm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=OR(At(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return hae}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),X(this.htContainer,"autocompleteEditor"),X(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[oJ(),eJ(),Vk("listbox"),uJ()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[_i("false"),cJ(`${db(fb,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",db(BO,this)),this.htEditor.updateSettings({colWidths:e?[ln(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{sa(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:p,locale:C}=this.cellProperties,E=this.query;let y=At(d),T,_;y&&!p&&(T=g===!0?y.indexOf(E):y.toLocaleLowerCase(C).indexOf(E.toLocaleLowerCase(C)),T!==-1&&(_=y.substr(T,E.length),y=y.replace(_,`<strong>${_}</strong>`))),n&&Ee(l,[tJ(),...r?[gJ(i)]:[],...r?[mJ(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=y},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{Ee(h,[jE()]),Ee(this.TEXTAREA,...hJ(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(Ee(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ws()),Ee(this.htEditor.rootElement,[Fk(),dJ("polite"),fJ("text"),["id",`${db(fb,this)}-listbox-${o}-${s}`]]),Ee(this.TEXTAREA,..._i("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[_i("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=KE(this.TEXTAREA),r=e$(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(tf([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Sg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),QR(gb,this,WO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),QR(gb,this,WO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Je(e,o=>At(o));return Je(r,o=>n?o:OR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===ge.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===ge.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(v$(e.keyCode)||e.keyCode===ge.BACKSPACE||e.keyCode===ge.DELETE||e.keyCode===ge.INSERT){let n=10;if(e.keyCode===ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function WO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+Nn(this.hot.rootDocument)})}const dae="checkbox";class DL extends Ih{static get EDITOR_TYPE(){return dae}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');be(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Fa=()=>window,Ri=()=>window.document,e0=(t,e)=>window.setTimeout(t,e),ko=function(t,e,n,r){t.addEventListener(e,n,!!r)},Cs=function(t,e,n,r){t.removeEventListener(e,n,!!r)},fae=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},qr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},mb=function(t,e){qr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},pb=function(t,e){t.className=fae((" "+t.className+" ").replace(" "+e+" "," "))},h_=function(t){return/Array/.test(Object.prototype.toString.call(t))},Qr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},gae=function(t){let e=t.getDay();return e===0||e===6},mae=function(t){return t%4===0&&t%100!==0||t%400===0},jO=function(t,e){return[31,mae(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},km=function(t){Qr(t)&&t.setHours(0,0,0,0)},$m=function(t,e){return t.getTime()===e.getTime()},Uw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Qr(e[r])?n&&(t[r]=new Date(e[r].getTime())):h_(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Uw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},UO=function(t,e,n){let r=Ri().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Uw(r,n),t.dispatchEvent(r)},zO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},To={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},YO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},pae=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},wae=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},vae=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():wae(o,i))+"</td>"},yae=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Cae=function(t){return"<tbody>"+t.join("")+"</tbody>"},bae=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+YO(t,e)+'">'+YO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Sae=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,p=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",h_(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(p=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},Rae=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+bae(t)+Cae(e)+"</table>"};function t0(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Fa().event;let o=i.target||i.srcElement;if(o)if(qr(o,"is-disabled")||(qr(o,"pika-button")&&!qr(o,"is-empty")&&!qr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&e0(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):qr(o,"pika-prev")?e.prevMonth():qr(o,"pika-next")&&e.nextMonth()),qr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Fa().event;let o=i.target||i.srcElement;o&&(qr(o,"pika-select-month")?e.gotoMonth(o.value):qr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Fa().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Qr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Ri().activeElement;do if(qr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=e0(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Fa().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&qr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),ko(o,"change",e._onChange)));do if(qr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Ri().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),ko(e.el,"mousedown",e._onMouseDown,!0),ko(e.el,"touchend",e._onMouseDown,!0),ko(e.el,"change",e._onChange),n.keyboardInput&&ko(Ri(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Ri().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),ko(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Qr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",ko(n.trigger,"click",e._onInputClick),ko(n.trigger,"focus",e._onInputFocus),ko(n.trigger,"blur",e._onInputBlur)):this.show()}t0.prototype={config:function(t){this._o||(this._o=Uw({},To,!0));let e=Uw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Qr(e.minDate)||(e.minDate=!1),Qr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),h_(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||To.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Qr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Qr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",UO(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Qr(t))return;let n=this._o.minDate,r=this._o.maxDate;Qr(n)&&t<n?t=n:Qr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),km(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),UO(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Qr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=zO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=zO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(km(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=To.minDate,this._o.minYear=To.minYear,this._o.minMonth=To.minMonth,this._o.startRange=To.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(km(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=To.maxDate,this._o.maxYear=To.maxYear,this._o.maxMonth=To.maxMonth,this._o.endRange=To.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Sae(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&e0(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Fa().innerWidth||Ri().documentElement.clientWidth,i=Fa().innerHeight||Ri().documentElement.clientHeight,o=Ri().body.scrollTop||Ri().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Fa().pageXOffset,a=l.bottom+Fa().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",mb(this.el,u?"left-aligned":"right-aligned"),mb(this.el,c?"bottom-aligned":"top-aligned"),pb(this.el,u?"right-aligned":"left-aligned"),pb(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=jO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];km(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=jO(h,u),g=o+s,p=g;for(;p>7;)p-=7;g+=7-p;let C=!1;for(let E=0,y=0;E<g;E++){let T=new Date(t,e,1+(E-s)),_=Qr(this._d)?$m(T,this._d):!1,P=$m(T,i),M=r.events.indexOf(T.toDateString())!==-1,I=E<s||E>=o+s,z=1+(E-s),W=e,V=t,q=r.startRange&&$m(r.startRange,T),Z=r.endRange&&$m(r.endRange,T),ee=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,te=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&gae(T)||r.disableDayFn&&r.disableDayFn(T);I&&(E<s?(z=f+z,W=u,V=h):(z=z-o,W=c,V=d));let he={day:z,month:W,year:V,hasEvent:M,isSelected:_,isToday:P,isDisabled:te,isEmpty:I,isStartRange:q,isEndRange:Z,isInRange:ee,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&_&&(C=!0),l.push(pae(he)),++y===7&&(r.showWeekNumber&&l.unshift(vae(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(yae(l,r.isRTL,r.pickWholeWeek,C)),l=[],y=0,C=!1)}return Rae(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),pb(this.el,"is-hidden"),this._o.bound&&(ko(Ri(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Cs(Ri(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),mb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Cs(this.el,"mousedown",this._onMouseDown,!0),Cs(this.el,"touchend",this._onMouseDown,!0),Cs(this.el,"change",this._onChange),t.keyboardInput&&Cs(Ri(),"keydown",this._onKeyChange),t.field&&(Cs(t.field,"change",this._onInputChange),t.bound&&(Cs(t.trigger,"click",this._onInputClick),Cs(t.trigger,"focus",this._onInputFocus),Cs(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Eae(t,e){Tae(t,e),e.add(t)}function Tae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GO(t,e,n){return(e=Mae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mae(t){var e=_ae(t,"string");return typeof e=="symbol"?e:e+""}function _ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kL="date",KO="dateEditor",xae="DD/MM/YYYY";var Lm=new WeakSet;class $L extends Fu{constructor(){super(...arguments),Eae(this,Lm),GO(this,"parentDestroyed",!1),GO(this,"$datePicker",null)}static get EDITOR_TYPE(){return kL}init(){if(typeof Q!="function")throw new Error("You need to include moment.js to your project.");if(typeof t0!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(ye(this.datePicker,/ht-theme-.*/g),X(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),X(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();ye(this.datePicker,/ht-theme-.*/g),X(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{be(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:KO})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(KO),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=wb(Lm,this,vb).call(this),r=this.hot.view.isMouseDown(),i=e?oT(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new t0(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Q),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Q(o,n,!0).isValid()&&this.$datePicker.setMoment(Q(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Q(o,n,!0).isValid()&&this.$datePicker.setMoment(Q(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&Mg(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:wb(Lm,this,vb).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Q(a).format(wb(Lm,this,vb).call(this))),this.setValue(a),i&&i(),Jo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==sn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+mn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-ln(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function vb(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:xae}const Iae="dropdown";class LL extends c_{static get EDITOR_TYPE(){return Iae}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const Pae="numeric";class FL extends Fu{static get EDITOR_TYPE(){return Pae}}function Oae(t,e,n){return(e=Aae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aae(t){var e=Hae(t,"string");return typeof e=="symbol"?e:e+""}function Hae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Nae="password";class VL extends Fu{constructor(){super(...arguments),Oae(this,"autoResize",AL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Nae}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,rs(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const yb="ht_editor_visible",qO="selectEditor",Dae="select";class BL extends Ih{static get EDITOR_TYPE(){return Dae}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Du()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),X(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",be(this.selectWrapper,yb)&&ye(this.selectWrapper,yb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),rs(this.select),Fe(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,$u(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==sn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",X(this.selectWrapper,yb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:qO};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(qO)}}const kae="time";class WL extends Fu{static get EDITOR_TYPE(){return kae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function $ae(){Nr(Ih),Nr(c_),Nr(DL),Nr($L),Nr(LL),Nr(u_),Nr(FL),Nr(VL),Nr(BL),Nr(Fu),Nr(WL)}const Lae="html";function d_(t,e,n,r,i,o,s){Ag.apply(this,[t,e,n,r,i,o,s]),$u(e,o??"",!1)}d_.RENDERER_TYPE=Lae;const Fae="autocomplete";function Oh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?d_:sa,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Du()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),X(e,"htAutocomplete"),!t.acArrowListener){const h=new Pi(t);t.acArrowListener=function(d){be(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Oh.RENDERER_TYPE=Fae;const Vae="dropdown";function f_(t,e,n,r,i,o,s){Oh.apply(this,[t,e,n,r,i,o,s])}f_.RENDERER_TYPE=Vae;const XO=new WeakMap,JO=new WeakMap,Bae="htBadValue",ch="data-row",hh="data-col",Wae="checkboxRenderer",jL="checkbox";se.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===jL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function g_(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Ag.apply(this,[t,e,n,r,i,o,s]),jae(t);let u=Uae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),rs(e),o===s.checkedTemplate||At(o).toLocaleLowerCase(s.locale)===At(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||At(o).toLocaleLowerCase(s.locale)===At(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:en(o)?X(u,"noValue"):(u.style.display="none",X(u,Bae),h=!0),Ee(u,[[ch,n],[hh,r]]),l&&Ee(u,[Lf(u.checked?t.getTranslatedPhrase(i_):t.getTranslatedPhrase(o_)),jk(u.checked),nJ()]),!h&&c){let p="";if(c.value)p=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);p=E!==null?E:""}const C=zae(a,p,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),XO.has(t)||(XO.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),E={group:Wae,relativeToGroup:ol,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const y=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(y==null?void 0:y.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}}],E)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),E=[],y=new Map;let T=[],_=0;if(C){for(let P=0;P<C.length;P++){const{row:M,col:I}=C[P].getTopStartCorner(),{row:z,col:W}=C[P].getBottomEndCorner();for(let V=M;V<=z;V+=1)for(let q=I;q<=W;q+=1){const Z=t.getCellMeta(V,q);if(Z.hidden)continue;const ee={checkedTemplate:Z.checkedTemplate,uncheckedTemplate:Z.uncheckedTemplate};if(Z.type!=="checkbox"){p===!0&&!Z.readOnly&&(y.has(E.length)?y.set(E.length,[...y.get(E.length),[V,q,null]]):y.set(E.length,[[V,q,null]]));continue}if(Z.readOnly===!0)continue;typeof Z.checkedTemplate>"u"&&(Z.checkedTemplate=!0),typeof Z.uncheckedTemplate>"u"&&(Z.uncheckedTemplate=!1);const te=t.getDataAtCell(V,q);p===!1?[Z.checkedTemplate,Z.checkedTemplate.toString()].includes(te)?T.push([V,q,Z.uncheckedTemplate,ee]):[Z.uncheckedTemplate,Z.uncheckedTemplate.toString(),null,void 0].includes(te)&&T.push([V,q,Z.checkedTemplate,ee]):T.push([V,q,Z.uncheckedTemplate,ee]),_+=1}E.push(_),_=0}T.every(P=>{let[,,M]=P;return M===T[0][2]})?T=T.map(P=>{let[M,I,z]=P;return[M,I,z]}):T=T.map(P=>{let[M,I,,z]=P;return[M,I,z.checkedTemplate]}),T.length>0&&E.forEach((P,M)=>{let I=T.splice(0,P);y.size&&y.has(M)&&(I=[...I,...y.get(M)]),t.setDataAtCell(I)})}}function g(){const p=t.getSelectedRange();if(p){for(let C=0;C<p.length;C++){const E=p[C].getTopStartCorner(),y=p[C].getBottomEndCorner();for(let T=E.row;T<=y.row;T++)for(let _=E.col;_<=y.col;_++){if(t.getCellMeta(T,_).readOnly)continue;const M=t.getCell(T,_);if(Qo(M)&&M.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}g_.RENDERER_TYPE=jL;function jae(t){let e=JO.get(t);if(!e){const{rootElement:n}=t;e=new Pi(t),e.addEventListener(n,"click",r=>Gae(r,t)),e.addEventListener(n,"mouseup",r=>Yae(r,t)),e.addEventListener(n,"change",r=>Kae(r,t)),JO.set(t,e)}return e}function Uae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function zae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function Yae(t,e){const{target:n}=t;m_(n)&&(!n.hasAttribute(ch)||!n.hasAttribute(hh)||setTimeout(e.listen,10))}function Gae(t,e){const{target:n}=t;if(!m_(n)||!n.hasAttribute(ch)||!n.hasAttribute(hh))return;const r=parseInt(n.getAttribute(ch),10),i=parseInt(n.getAttribute(hh),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function Kae(t,e){const{target:n}=t;if(!m_(n)||!n.hasAttribute(ch)||!n.hasAttribute(hh))return;const r=parseInt(n.getAttribute(ch),10),i=parseInt(n.getAttribute(hh),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function m_(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const qae="handsontable";function p_(t,e,n,r,i,o,s){Oh.apply(this,[t,e,n,r,i,o,s])}p_.RENDERER_TYPE=qae;var Xae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Cb,ZO;function Zae(){return ZO||(ZO=1,Cb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Cb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var bb,QO;function UL(){if(QO)return bb;QO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let p="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let M=0;M<t.length;M++){let I=t[M];if(p=l.replace(RegExp(`([0-9 ])(${I.key})$`),"$1"),p!==l)return n(p,u,c,h,d,f)*I.factor}if(p=l.replace("%",""),p!==l)return n(p,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let y=h(E);if(y&&y!=="."&&(p=l.replace(new RegExp(`${e(y)}$`),""),p!==l))return n(p,u,c,h,d,f);let T={};Object.keys(f).forEach(M=>{T[f[M]]=M});let _=Object.keys(T).sort().reverse(),P=_.length;for(let M=0;M<P;M++){let I=_[M],z=T[I];if(p=l.replace(I,""),p!==l){let W;switch(z){case"thousand":W=Math.pow(10,3);break;case"million":W=Math.pow(10,6);break;case"billion":W=Math.pow(10,9);break;case"trillion":W=Math.pow(10,12);break}return n(p,u,c,h,d,f)*W}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let p=r(l,u,c);return n(p,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=y_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),p=c.currentAbbreviations(),C;if(typeof l=="string")o(l,h)?C=s(l):C=i(l,h,d,f,g,p);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return bb={unformat:a},bb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Sb,eA;function w_(){if(eA)return Sb;eA=1;let t=UL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,E){let y=d(C),T=g(E);return y&&T}function d(C){return t.unformat(C)!==void 0}function f(C,E,y,T=!1){let _=Object.keys(C).map(P=>{if(!E[P])return console.error(`${y} Invalid key: ${P}`),!1;let M=C[P],I=E[P];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!f(M,u,`[Validate ${P}]`,!0))return!1}else if(typeof M!==I.type)return console.error(`${y} ${P} type mismatched: "${I.type}" expected, "${typeof M}" provided`),!1;if(I.restrictions&&I.restrictions.length){let z=I.restrictions.length;for(let W=0;W<z;W++){let{restriction:V,message:q}=I.restrictions[W];if(!V(M,C))return console.error(`${y} ${P} invalid value: ${q}`),!1}}return I.restriction&&!I.restriction(M,C)?(console.error(`${y} ${P} invalid value: ${I.message}`),!1):I.validValues&&I.validValues.indexOf(M)===-1?(console.error(`${y} ${P} invalid value: must be among ${JSON.stringify(I.validValues)}, "${M}" provided`),!1):!(I.children&&!f(M,I.children,`[Validate ${P}]`))});return T||_.push(...Object.keys(E).map(P=>{let M=E[P];if(typeof M=="string"&&(M={type:M}),M.mandatory){let I=M.mandatory;if(typeof I=="function"&&(I=I(C)),I&&C[P]===void 0)return console.error(`${y} Missing mandatory key "${P}"`),!1}return!0})),_.reduce((P,M)=>P&&M,!0)}function g(C){return f(C,u,"[Validate format]")}function p(C){return f(C,c,"[Validate language]")}return Sb={validate:h,validateFormat:g,validateInput:d,validateLanguage:p},Sb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Qae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function ele(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function tle(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function nle(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function rle(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function ile(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function ole(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function sle(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function ale(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function lle(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function ule(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function cle(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function hle(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function dle(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function fle(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function gle(t,e={}){return typeof t!="string"?t:(t=Qae(t,e),t=ele(t,e),tle(t,e),ile(t,e),ole(t,e),hle(t,e),lle(t,e),ule(t,e),sle(t,e),cle(t,e),ale(t,e),nle(t,e),rle(t,e),dle(t,e),fle(t,e),e)}var v_={parseFormat:gle};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Rb,tA;function y_(){if(tA)return Rb;tA=1;const t=Zae(),e=w_(),n=v_;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,Rb=r,Rb}function mle(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function ple(t,e){t.forEach(n=>{let r;try{r=mle(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var wle=t=>({loadLanguagesInNode:e=>ple(e,t)}),zL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(M){var I,z,W,V=w.prototype={constructor:w,toString:null,valueOf:null},q=new w(1),Z=20,ee=4,te=-7,he=21,Ue=-1e7,ve=1e7,He=!1,st=1,Cn=0,ze={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",v=!0;function w(b,R){var S,$,O,N,j,H,D,B,F=this;if(!(F instanceof w))return new w(b,R);if(R==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>ve?F.c=F.e=null:b.e<Ue?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((H=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(N=0,j=b;j>=10;j/=10,N++);N>ve?F.c=F.e=null:(F.e=N,F.c=[b]);return}B=String(b)}else{if(!r.test(B=String(b)))return W(F,B,H);F.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(N=B.indexOf("."))>-1&&(B=B.replace(".","")),(j=B.search(/e/i))>0?(N<0&&(N=j),N+=+B.slice(j+1),B=B.substring(0,j)):N<0&&(N=B.length)}else{if(y(R,2,m.length,"Base"),R==10&&v)return F=new w(b),K(F,Z+F.e+1,ee);if(B=String(b),H=typeof b=="number"){if(b*0!=0)return W(F,B,H,R);if(F.s=1/b<0?(B=B.slice(1),-1):1,w.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(S=m.slice(0,R),N=j=0,D=B.length;j<D;j++)if(S.indexOf($=B.charAt(j))<0){if($=="."){if(j>N){N=D;continue}}else if(!O&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){O=!0,j=-1,N=0;continue}return W(F,String(b),H,R)}H=!1,B=z(B,R,10,F.s),(N=B.indexOf("."))>-1?B=B.replace(".",""):N=B.length}for(j=0;B.charCodeAt(j)===48;j++);for(D=B.length;B.charCodeAt(--D)===48;);if(B=B.slice(j,++D)){if(D-=j,H&&w.DEBUG&&D>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((N=N-j-1)>ve)F.c=F.e=null;else if(N<Ue)F.c=[F.e=0];else{if(F.e=N,F.c=[],j=(N+1)%u,N<0&&(j+=u),j<D){for(j&&F.c.push(+B.slice(0,j)),D-=u;j<D;)F.c.push(+B.slice(j,j+=u));j=u-(B=B.slice(j)).length}else j-=D;for(;j--;B+="0");F.c.push(+B)}}else F.c=[F.e=0]}w.clone=g,w.ROUND_UP=0,w.ROUND_DOWN=1,w.ROUND_CEIL=2,w.ROUND_FLOOR=3,w.ROUND_HALF_UP=4,w.ROUND_HALF_DOWN=5,w.ROUND_HALF_EVEN=6,w.ROUND_HALF_CEIL=7,w.ROUND_HALF_FLOOR=8,w.EUCLID=9,w.config=w.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],y(S,0,f,R),Z=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],y(S,0,8,R),ee=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(y(S[0],-1e9,0,R),y(S[1],0,f,R),te=S[0],he=S[1]):(y(S,-1e9,f,R),te=-(he=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)y(S[0],-1e9,-1,R),y(S[1],1,f,R),Ue=S[0],ve=S[1];else if(y(S,-1e9,f,R),S)Ue=-(ve=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))He=S;else throw He=!S,Error(s+"crypto unavailable");else He=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],y(S,0,9,R),st=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],y(S,0,f,R),Cn=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")ze=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))v=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:Z,ROUNDING_MODE:ee,EXPONENTIAL_AT:[te,he],RANGE:[Ue,ve],CRYPTO:He,MODULO_MODE:st,POW_PRECISION:Cn,FORMAT:ze,ALPHABET:m}},w.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!w.DEBUG)return!0;var R,S,$=b.c,O=b.e,N=b.s;e:if({}.toString.call($)=="[object Array]"){if((N===1||N===-1)&&O>=-1e9&&O<=f&&O===o(O)){if($[0]===0){if(O===0&&$.length===1)return!0;break e}if(R=(O+1)%u,R<1&&(R+=u),String($[0]).length==R){for(R=0;R<$.length;R++)if(S=$[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if($===null&&O===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},w.maximum=w.max=function(){return L(arguments,-1)},w.minimum=w.min=function(){return L(arguments,1)},w.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var $,O,N,j,H,D=0,B=[],F=new w(q);if(S==null?S=Z:y(S,0,f),j=i(S/u),He)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(j*=2));D<j;)H=$[D]*131072+($[D+1]>>>11),H>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),$[D]=O[0],$[D+1]=O[1]):(B.push(H%1e14),D+=2);D=j/2}else if(crypto.randomBytes){for($=crypto.randomBytes(j*=7);D<j;)H=($[D]&31)*281474976710656+$[D+1]*1099511627776+$[D+2]*4294967296+$[D+3]*16777216+($[D+4]<<16)+($[D+5]<<8)+$[D+6],H>=9e15?crypto.randomBytes(7).copy($,D):(B.push(H%1e14),D+=7);D=j/7}else throw He=!1,Error(s+"crypto unavailable");if(!He)for(;D<j;)H=R(),H<9e15&&(B[D++]=H%1e14);for(j=B[--D],S%=u,j&&S&&(H=h[u-S],B[D]=o(j/H)*H);B[D]===0;B.pop(),D--);if(D<0)B=[N=0];else{for(N=-1;B[0]===0;B.splice(0,1),N-=u);for(D=1,H=B[0];H>=10;H/=10,D++);D<u&&(N-=u-D)}return F.e=N,F.c=B,F}}(),w.sum=function(){for(var b=1,R=arguments,S=new w(R[0]);b<R.length;)S=S.plus(R[b++]);return S},z=function(){var b="0123456789";function R(S,$,O,N){for(var j,H=[0],D,B=0,F=S.length;B<F;){for(D=H.length;D--;H[D]*=$);for(H[0]+=N.indexOf(S.charAt(B++)),j=0;j<H.length;j++)H[j]>O-1&&(H[j+1]==null&&(H[j+1]=0),H[j+1]+=H[j]/O|0,H[j]%=O)}return H.reverse()}return function(S,$,O,N,j){var H,D,B,F,G,le,de,Ie,We=S.indexOf("."),Ze=Z,xe=ee;for(We>=0&&(F=Cn,Cn=0,S=S.replace(".",""),Ie=new w($),le=Ie.pow(S.length-We),Cn=F,Ie.c=R(P(C(le.c),le.e,"0"),10,O,b),Ie.e=Ie.c.length),de=R(S,$,O,j?(H=m,b):(H=b,m)),B=F=de.length;de[--F]==0;de.pop());if(!de[0])return H.charAt(0);if(We<0?--B:(le.c=de,le.e=B,le.s=N,le=I(le,Ie,Ze,xe,O),de=le.c,G=le.r,B=le.e),D=B+Ze+1,We=de[D],F=O/2,G=G||D<0||de[D+1]!=null,G=xe<4?(We!=null||G)&&(xe==0||xe==(le.s<0?3:2)):We>F||We==F&&(xe==4||G||xe==6&&de[D-1]&1||xe==(le.s<0?8:7)),D<1||!de[0])S=G?P(H.charAt(1),-Ze,H.charAt(0)):H.charAt(0);else{if(de.length=D,G)for(--O;++de[--D]>O;)de[D]=0,D||(++B,de=[1].concat(de));for(F=de.length;!de[--F];);for(We=0,S="";We<=F;S+=H.charAt(de[We++]));S=P(S,B,H.charAt(0))}return S}}(),I=function(){function b($,O,N){var j,H,D,B,F=0,G=$.length,le=O%d,de=O/d|0;for($=$.slice();G--;)D=$[G]%d,B=$[G]/d|0,j=de*D+B*le,H=le*D+j%d*d+F,F=(H/N|0)+(j/d|0)+de*B,$[G]=H%N;return F&&($=[F].concat($)),$}function R($,O,N,j){var H,D;if(N!=j)D=N>j?1:-1;else for(H=D=0;H<N;H++)if($[H]!=O[H]){D=$[H]>O[H]?1:-1;break}return D}function S($,O,N,j){for(var H=0;N--;)$[N]-=H,H=$[N]<O[N]?1:0,$[N]=H*j+$[N]-O[N];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,O,N,j,H){var D,B,F,G,le,de,Ie,We,Ze,xe,Ge,Nt,Li,hs,ci,Dt,bn,_t=$.s==O.s?1:-1,kt=$.c,Ke=O.c;if(!kt||!kt[0]||!Ke||!Ke[0])return new w(!$.s||!O.s||(kt?Ke&&kt[0]==Ke[0]:!Ke)?NaN:kt&&kt[0]==0||!Ke?_t*0:_t/0);for(We=new w(_t),Ze=We.c=[],B=$.e-O.e,_t=N+B+1,H||(H=l,B=p($.e/u)-p(O.e/u),_t=_t/u|0),F=0;Ke[F]==(kt[F]||0);F++);if(Ke[F]>(kt[F]||0)&&B--,_t<0)Ze.push(1),G=!0;else{for(hs=kt.length,Dt=Ke.length,F=0,_t+=2,le=o(H/(Ke[0]+1)),le>1&&(Ke=b(Ke,le,H),kt=b(kt,le,H),Dt=Ke.length,hs=kt.length),Li=Dt,xe=kt.slice(0,Dt),Ge=xe.length;Ge<Dt;xe[Ge++]=0);bn=Ke.slice(),bn=[0].concat(bn),ci=Ke[0],Ke[1]>=H/2&&ci++;do{if(le=0,D=R(Ke,xe,Dt,Ge),D<0){if(Nt=xe[0],Dt!=Ge&&(Nt=Nt*H+(xe[1]||0)),le=o(Nt/ci),le>1)for(le>=H&&(le=H-1),de=b(Ke,le,H),Ie=de.length,Ge=xe.length;R(de,xe,Ie,Ge)==1;)le--,S(de,Dt<Ie?bn:Ke,Ie,H),Ie=de.length,D=1;else le==0&&(D=le=1),de=Ke.slice(),Ie=de.length;if(Ie<Ge&&(de=[0].concat(de)),S(xe,de,Ge,H),Ge=xe.length,D==-1)for(;R(Ke,xe,Dt,Ge)<1;)le++,S(xe,Dt<Ge?bn:Ke,Ge,H),Ge=xe.length}else D===0&&(le++,xe=[0]);Ze[F++]=le,xe[0]?xe[Ge++]=kt[Li]||0:(xe=[kt[Li]],Ge=1)}while((Li++<hs||xe[0]!=null)&&_t--);G=xe[0]!=null,Ze[0]||Ze.splice(0,1)}if(H==l){for(F=1,_t=Ze[0];_t>=10;_t/=10,F++);K(We,N+(We.e=F+B*u-1)+1,j,G)}else We.e=B,We.r=+G;return We}}();function A(b,R,S,$){var O,N,j,H,D;if(S==null?S=ee:y(S,0,8),!b.c)return b.toString();if(O=b.c[0],j=b.e,R==null)D=C(b.c),D=$==1||$==2&&(j<=te||j>=he)?_(D,j):P(D,j,"0");else if(b=K(new w(b),R,S),N=b.e,D=C(b.c),H=D.length,$==1||$==2&&(R<=N||N<=te)){for(;H<R;D+="0",H++);D=_(D,N)}else if(R-=j,D=P(D,N,"0"),N+1>H){if(--R>0)for(D+=".";R--;D+="0");}else if(R+=N-H,R>0)for(N+1==H&&(D+=".");R--;D+="0");return b.s<0&&O?"-"+D:D}function L(b,R){for(var S,$,O=1,N=new w(b[0]);O<b.length;O++)$=new w(b[O]),(!$.s||(S=E(N,$))===R||S===0&&N.s===R)&&(N=$);return N}function U(b,R,S){for(var $=1,O=R.length;!R[--O];R.pop());for(O=R[0];O>=10;O/=10,$++);return(S=$+S*u-1)>ve?b.c=b.e=null:S<Ue?b.c=[b.e=0]:(b.e=S,b.c=R),b}W=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,j,H,D){var B,F=H?j:j.replace(O,"");if($.test(F))N.s=isNaN(F)?null:F<0?-1:1;else{if(!H&&(F=F.replace(b,function(G,le,de){return B=(de=de.toLowerCase())=="x"?16:de=="b"?2:8,!D||D==B?le:G}),D&&(B=D,F=F.replace(R,"$1").replace(S,"0.$1")),j!=F))return new w(F,B);if(w.DEBUG)throw Error(s+"Not a"+(D?" base "+D:"")+" number: "+j);N.s=null}N.c=N.e=null}}();function K(b,R,S,$){var O,N,j,H,D,B,F,G=b.c,le=h;if(G){e:{for(O=1,H=G[0];H>=10;H/=10,O++);if(N=R-O,N<0)N+=u,j=R,D=G[B=0],F=o(D/le[O-j-1]%10);else if(B=i((N+1)/u),B>=G.length)if($){for(;G.length<=B;G.push(0));D=F=0,O=1,N%=u,j=N-u+1}else break e;else{for(D=H=G[B],O=1;H>=10;H/=10,O++);N%=u,j=N-u+O,F=j<0?0:o(D/le[O-j-1]%10)}if($=$||R<0||G[B+1]!=null||(j<0?D:D%le[O-j-1]),$=S<4?(F||$)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||$||S==6&&(N>0?j>0?D/le[O-j]:0:G[B-1])%10&1||S==(b.s<0?8:7)),R<1||!G[0])return G.length=0,$?(R-=b.e+1,G[0]=le[(u-R%u)%u],b.e=-R||0):G[0]=b.e=0,b;if(N==0?(G.length=B,H=1,B--):(G.length=B+1,H=le[u-N],G[B]=j>0?o(D/le[O-j]%le[j])*H:0),$)for(;;)if(B==0){for(N=1,j=G[0];j>=10;j/=10,N++);for(j=G[0]+=H,H=1;j>=10;j/=10,H++);N!=H&&(b.e++,G[0]==l&&(G[0]=1));break}else{if(G[B]+=H,G[B]!=l)break;G[B--]=0,H=1}for(N=G.length;G[--N]===0;G.pop());}b.e>ve?b.c=b.e=null:b.e<Ue&&(b.c=[b.e=0])}return b}function J(b){var R,S=b.e;return S===null?b.toString():(R=C(b.c),R=S<=te||S>=he?_(R,S):P(R,S,"0"),b.s<0?"-"+R:R)}return V.absoluteValue=V.abs=function(){var b=new w(this);return b.s<0&&(b.s=1),b},V.comparedTo=function(b,R){return E(this,new w(b,R))},V.decimalPlaces=V.dp=function(b,R){var S,$,O,N=this;if(b!=null)return y(b,0,f),R==null?R=ee:y(R,0,8),K(new w(N),b+N.e+1,R);if(!(S=N.c))return null;if($=((O=S.length-1)-p(this.e/u))*u,O=S[O])for(;O%10==0;O/=10,$--);return $<0&&($=0),$},V.dividedBy=V.div=function(b,R){return I(this,new w(b,R),Z,ee)},V.dividedToIntegerBy=V.idiv=function(b,R){return I(this,new w(b,R),0,1)},V.exponentiatedBy=V.pow=function(b,R){var S,$,O,N,j,H,D,B,F,G=this;if(b=new w(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+J(b));if(R!=null&&(R=new w(R)),H=b.e>14,!G.c||!G.c[0]||G.c[0]==1&&!G.e&&G.c.length==1||!b.c||!b.c[0])return F=new w(Math.pow(+J(G),H?b.s*(2-T(b)):+J(b))),R?F.mod(R):F;if(D=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new w(NaN);$=!D&&G.isInteger()&&R.isInteger(),$&&(G=G.mod(R))}else{if(b.e>9&&(G.e>0||G.e<-1||(G.e==0?G.c[0]>1||H&&G.c[1]>=24e7:G.c[0]<8e13||H&&G.c[0]<=9999975e7)))return N=G.s<0&&T(b)?-0:0,G.e>-1&&(N=1/N),new w(D?1/N:N);Cn&&(N=i(Cn/u+2))}for(H?(S=new w(.5),D&&(b.s=1),B=T(b)):(O=Math.abs(+J(b)),B=O%2),F=new w(q);;){if(B){if(F=F.times(G),!F.c)break;N?F.c.length>N&&(F.c.length=N):$&&(F=F.mod(R))}if(O){if(O=o(O/2),O===0)break;B=O%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)B=T(b);else{if(O=+J(b),O===0)break;B=O%2}G=G.times(G),N?G.c&&G.c.length>N&&(G.c.length=N):$&&(G=G.mod(R))}return $?F:(D&&(F=q.div(F)),R?F.mod(R):N?K(F,Cn,ee,j):F)},V.integerValue=function(b){var R=new w(this);return b==null?b=ee:y(b,0,8),K(R,R.e+1,b)},V.isEqualTo=V.eq=function(b,R){return E(this,new w(b,R))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(b,R){return E(this,new w(b,R))>0},V.isGreaterThanOrEqualTo=V.gte=function(b,R){return(R=E(this,new w(b,R)))===1||R===0},V.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},V.isLessThan=V.lt=function(b,R){return E(this,new w(b,R))<0},V.isLessThanOrEqualTo=V.lte=function(b,R){return(R=E(this,new w(b,R)))===-1||R===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(b,R){var S,$,O,N,j=this,H=j.s;if(b=new w(b,R),R=b.s,!H||!R)return new w(NaN);if(H!=R)return b.s=-R,j.plus(b);var D=j.e/u,B=b.e/u,F=j.c,G=b.c;if(!D||!B){if(!F||!G)return F?(b.s=-R,b):new w(G?j:NaN);if(!F[0]||!G[0])return G[0]?(b.s=-R,b):new w(F[0]?j:ee==3?-0:0)}if(D=p(D),B=p(B),F=F.slice(),H=D-B){for((N=H<0)?(H=-H,O=F):(B=D,O=G),O.reverse(),R=H;R--;O.push(0));O.reverse()}else for($=(N=(H=F.length)<(R=G.length))?H:R,H=R=0;R<$;R++)if(F[R]!=G[R]){N=F[R]<G[R];break}if(N&&(O=F,F=G,G=O,b.s=-b.s),R=($=G.length)-(S=F.length),R>0)for(;R--;F[S++]=0);for(R=l-1;$>H;){if(F[--$]<G[$]){for(S=$;S&&!F[--S];F[S]=R);--F[S],F[$]+=l}F[$]-=G[$]}for(;F[0]==0;F.splice(0,1),--B);return F[0]?U(b,F,B):(b.s=ee==3?-1:1,b.c=[b.e=0],b)},V.modulo=V.mod=function(b,R){var S,$,O=this;return b=new w(b,R),!O.c||!b.s||b.c&&!b.c[0]?new w(NaN):!b.c||O.c&&!O.c[0]?new w(O):(st==9?($=b.s,b.s=1,S=I(O,b,0,3),b.s=$,S.s*=$):S=I(O,b,0,st),b=O.minus(S.times(b)),!b.c[0]&&st==1&&(b.s=O.s),b)},V.multipliedBy=V.times=function(b,R){var S,$,O,N,j,H,D,B,F,G,le,de,Ie,We,Ze,xe=this,Ge=xe.c,Nt=(b=new w(b,R)).c;if(!Ge||!Nt||!Ge[0]||!Nt[0])return!xe.s||!b.s||Ge&&!Ge[0]&&!Nt||Nt&&!Nt[0]&&!Ge?b.c=b.e=b.s=null:(b.s*=xe.s,!Ge||!Nt?b.c=b.e=null:(b.c=[0],b.e=0)),b;for($=p(xe.e/u)+p(b.e/u),b.s*=xe.s,D=Ge.length,G=Nt.length,D<G&&(Ie=Ge,Ge=Nt,Nt=Ie,O=D,D=G,G=O),O=D+G,Ie=[];O--;Ie.push(0));for(We=l,Ze=d,O=G;--O>=0;){for(S=0,le=Nt[O]%Ze,de=Nt[O]/Ze|0,j=D,N=O+j;N>O;)B=Ge[--j]%Ze,F=Ge[j]/Ze|0,H=de*B+F*le,B=le*B+H%Ze*Ze+Ie[N]+S,S=(B/We|0)+(H/Ze|0)+de*F,Ie[N--]=B%We;Ie[N]=S}return S?++$:Ie.splice(0,1),U(b,Ie,$)},V.negated=function(){var b=new w(this);return b.s=-b.s||null,b},V.plus=function(b,R){var S,$=this,O=$.s;if(b=new w(b,R),R=b.s,!O||!R)return new w(NaN);if(O!=R)return b.s=-R,$.minus(b);var N=$.e/u,j=b.e/u,H=$.c,D=b.c;if(!N||!j){if(!H||!D)return new w(O/0);if(!H[0]||!D[0])return D[0]?b:new w(H[0]?$:O*0)}if(N=p(N),j=p(j),H=H.slice(),O=N-j){for(O>0?(j=N,S=D):(O=-O,S=H),S.reverse();O--;S.push(0));S.reverse()}for(O=H.length,R=D.length,O-R<0&&(S=D,D=H,H=S,R=O),O=0;R;)O=(H[--R]=H[R]+D[R]+O)/l|0,H[R]=l===H[R]?0:H[R]%l;return O&&(H=[O].concat(H),++j),U(b,H,j)},V.precision=V.sd=function(b,R){var S,$,O,N=this;if(b!=null&&b!==!!b)return y(b,1,f),R==null?R=ee:y(R,0,8),K(new w(N),b,R);if(!(S=N.c))return null;if(O=S.length-1,$=O*u+1,O=S[O]){for(;O%10==0;O/=10,$--);for(O=S[0];O>=10;O/=10,$++);}return b&&N.e+1>$&&($=N.e+1),$},V.shiftedBy=function(b){return y(b,-9007199254740991,c),this.times("1e"+b)},V.squareRoot=V.sqrt=function(){var b,R,S,$,O,N=this,j=N.c,H=N.s,D=N.e,B=Z+4,F=new w("0.5");if(H!==1||!j||!j[0])return new w(!H||H<0&&(!j||j[0])?NaN:j?N:1/0);if(H=Math.sqrt(+J(N)),H==0||H==1/0?(R=C(j),(R.length+D)%2==0&&(R+="0"),H=Math.sqrt(+R),D=p((D+1)/2)-(D<0||D%2),H==1/0?R="5e"+D:(R=H.toExponential(),R=R.slice(0,R.indexOf("e")+1)+D),S=new w(R)):S=new w(H+""),S.c[0]){for(D=S.e,H=D+B,H<3&&(H=0);;)if(O=S,S=F.times(O.plus(I(N,O,B,1))),C(O.c).slice(0,H)===(R=C(S.c)).slice(0,H))if(S.e<D&&--H,R=R.slice(H-3,H+1),R=="9999"||!$&&R=="4999"){if(!$&&(K(O,O.e+Z+2,0),O.times(O).eq(N))){S=O;break}B+=4,H+=4,$=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(K(S,S.e+Z+2,1),b=!S.times(S).eq(N));break}}return K(S,S.e+Z+1,ee,b)},V.toExponential=function(b,R){return b!=null&&(y(b,0,f),b++),A(this,b,R,1)},V.toFixed=function(b,R){return b!=null&&(y(b,0,f),b=b+this.e+1),A(this,b,R)},V.toFormat=function(b,R,S){var $,O=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=ze;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if($=O.toFixed(b,R),O.c){var N,j=$.split("."),H=+S.groupSize,D=+S.secondaryGroupSize,B=S.groupSeparator||"",F=j[0],G=j[1],le=O.s<0,de=le?F.slice(1):F,Ie=de.length;if(D&&(N=H,H=D,D=N,Ie-=N),H>0&&Ie>0){for(N=Ie%H||H,F=de.substr(0,N);N<Ie;N+=H)F+=B+de.substr(N,H);D>0&&(F+=B+de.slice(N)),le&&(F="-"+F)}$=G?F+(S.decimalSeparator||"")+((D=+S.fractionGroupSize)?G.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):G):F}return(S.prefix||"")+$+(S.suffix||"")},V.toFraction=function(b){var R,S,$,O,N,j,H,D,B,F,G,le,de=this,Ie=de.c;if(b!=null&&(H=new w(b),!H.isInteger()&&(H.c||H.s!==1)||H.lt(q)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+J(H));if(!Ie)return new w(de);for(R=new w(q),B=S=new w(q),$=D=new w(q),le=C(Ie),N=R.e=le.length-de.e-1,R.c[0]=h[(j=N%u)<0?u+j:j],b=!b||H.comparedTo(R)>0?N>0?R:B:H,j=ve,ve=1/0,H=new w(le),D.c[0]=0;F=I(H,R,0,1),O=S.plus(F.times($)),O.comparedTo(b)!=1;)S=$,$=O,B=D.plus(F.times(O=B)),D=O,R=H.minus(F.times(O=R)),H=O;return O=I(b.minus(S),$,0,1),D=D.plus(O.times(B)),S=S.plus(O.times($)),D.s=B.s=de.s,N=N*2,G=I(B,$,N,ee).minus(de).abs().comparedTo(I(D,S,N,ee).minus(de).abs())<1?[B,$]:[D,S],ve=j,G},V.toNumber=function(){return+J(this)},V.toPrecision=function(b,R){return b!=null&&y(b,1,f),A(this,b,R,2)},V.toString=function(b){var R,S=this,$=S.s,O=S.e;return O===null?$?(R="Infinity",$<0&&(R="-"+R)):R="NaN":(b==null?R=O<=te||O>=he?_(C(S.c),O):P(C(S.c),O,"0"):b===10&&v?(S=K(new w(S),Z+O+1,ee),R=P(C(S.c),S.e,"0")):(y(b,2,m.length,"Base"),R=z(P(C(S.c),O,"0"),10,b,$,!0)),$<0&&S.c[0]&&(R="-"+R)),R},V.valueOf=V.toJSON=function(){return J(this)},V._isBigNumber=!0,M!=null&&w.set(M),w}function p(M){var I=M|0;return M>0||M===I?I:I-1}function C(M){for(var I,z,W=1,V=M.length,q=M[0]+"";W<V;){for(I=M[W++]+"",z=u-I.length;z--;I="0"+I);q+=I}for(V=q.length;q.charCodeAt(--V)===48;);return q.slice(0,V+1||1)}function E(M,I){var z,W,V=M.c,q=I.c,Z=M.s,ee=I.s,te=M.e,he=I.e;if(!Z||!ee)return null;if(z=V&&!V[0],W=q&&!q[0],z||W)return z?W?0:-ee:Z;if(Z!=ee)return Z;if(z=Z<0,W=te==he,!V||!q)return W?0:!V^z?1:-1;if(!W)return te>he^z?1:-1;for(ee=(te=V.length)<(he=q.length)?te:he,Z=0;Z<ee;Z++)if(V[Z]!=q[Z])return V[Z]>q[Z]^z?1:-1;return te==he?0:te>he^z?1:-1}function y(M,I,z,W){if(M<I||M>z||M!==o(M))throw Error(s+(W||"Argument")+(typeof M=="number"?M<I||M>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(M))}function T(M){var I=M.c.length-1;return p(M.e/u)==I&&M.c[I]%2!=0}function _(M,I){return(M.length>1?M.charAt(0)+"."+M.slice(1):M)+(I<0?"e":"e+")+I}function P(M,I,z){var W,V;if(I<0){for(V=z+".";++I;V+=z);M=V+M}else if(W=M.length,++I>W){for(V=z,I-=W;--I;V+=z);M+=V}else I<W&&(M=M.slice(0,I)+"."+M.slice(I));return M}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Xae)})(zL);var YL=zL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const qi=y_(),vle=w_(),yle=v_,Cle=YL,Wn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Hg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:GL,decimalSuffixes:zw}=qi.currentBytes(),C_={general:{scale:1024,suffixes:zw},binary:{scale:1024,suffixes:GL},decimal:{scale:1e3,suffixes:zw}};function ble(t,e={},n){if(typeof e=="string"&&(e=yle.parseFormat(e)),!vle.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=Sle(t,e,n);return s=Ble(s,i),s=Wle(s,o),s}function Sle(t,e,n){switch(e.output){case"currency":return e=xc(e,qi.currentCurrencyDefaultFormat()),Ple(t,e,qi);case"percent":return e=xc(e,qi.currentPercentageDefaultFormat()),Ile(t,e,qi,n);case"byte":return e=xc(e,qi.currentByteDefaultFormat()),Mle(t,e,qi,n);case"time":return e=xc(e,qi.currentTimeDefaultFormat()),xle(t);case"ordinal":return e=xc(e,qi.currentOrdinalDefaultFormat()),_le(t,e,qi);case"number":default:return Ng({instance:t,providedFormat:e})}}function Rle(t){let e=C_.decimal;return vy(t._value,e.suffixes,e.scale).suffix}function Ele(t){let e=C_.binary;return vy(t._value,e.suffixes,e.scale).suffix}function Tle(t){let e=C_.general;return vy(t._value,e.suffixes,e.scale).suffix}function vy(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function Mle(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Hg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||zw,marker:"bd"},binary:{scale:1024,suffixes:s||GL,marker:"b"},decimal:{scale:1e3,suffixes:a||zw,marker:"d"}}[i],{value:c,suffix:h}=vy(t._value,u.suffixes,u.scale);return`${Ng({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function _le(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Hg,e),o=Ng({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function xle(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function Ile(t,e,n,r){let i=e.prefixSymbol,o=Ng({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Hg,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function Ple(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Hg,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Ng({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function Ole({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Wn[e]?(a=r[e],t=t/Wn[e]):l>=Wn.trillion||n&&s(l/Wn.trillion)===1?(a=r.trillion,t=t/Wn.trillion):l<Wn.trillion&&l>=Wn.billion||n&&s(l/Wn.billion)===1?(a=r.billion,t=t/Wn.billion):l<Wn.billion&&l>=Wn.million||n&&s(l/Wn.million)===1?(a=r.million,t=t/Wn.million):(l<Wn.million&&l>=Wn.thousand||n&&s(l/Wn.thousand)===1)&&(a=r.thousand,t=t/Wn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function Ale({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Fm(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function Hle(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Fm(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Fm(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Fm(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Fm(e)}`),n}function Nle(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?Hle(t,e):new Cle(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function Dle(t,e,n,r,i,o){if(r===-1)return t;let s=Nle(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function kle(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function $le(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function Lle(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),$le(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function Fle(t,e){return t+e}function Vle(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function Ble(t,e){return e+t}function Wle(t,e){return t+e}function Ng({instance:t,providedFormat:e,state:n=qi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Hg,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,p=s.trimMantissa,C=s.thousandSeparated,E=s.spaceSeparated,y=s.negative,T=s.forceSign,_=s.exponential,P=s.roundingFunction,M="";if(d){let z=Ole({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:P,totalLength:a});o=z.value,M+=z.abbreviation,a&&(f=z.mantissaPrecision)}if(_){let z=Ale({value:o,characteristicPrecision:l});o=z.value,M=z.abbreviation+M}let I=Dle(o.toString(),o,g,f,p,P);return I=kle(I,o,u,l),I=Lle(I,o,C,n,r),(d||_)&&(I=Fle(I,M)),(T||o<0)&&(I=Vle(I,o,y)),I}function xc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var jle=t=>({format:(...e)=>ble(...e,t),getByteUnit:(...e)=>Tle(...e,t),getBinaryByteUnit:(...e)=>Ele(...e,t),getDecimalByteUnit:(...e)=>Rle(...e,t),formatOrDefault:xc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Js=YL;function Ule(t,e,n){let r=new Js(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Js(i),t._value=r.plus(i).toNumber(),t}function KL(t,e,n){let r=new Js(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Js(i),t._value=r.minus(i).toNumber(),t}function zle(t,e,n){let r=new Js(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Js(i),t._value=r.times(i).toNumber(),t}function Yle(t,e,n){let r=new Js(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Js(i),t._value=r.dividedBy(i).toNumber(),t}function Gle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function Kle(t,e,n){let r=n(t._value);return KL(r,e,n),Math.abs(r._value)}var qle=t=>({add:(e,n)=>Ule(e,n,t),subtract:(e,n)=>KL(e,n,t),multiply:(e,n)=>zle(e,n,t),divide:(e,n)=>Yle(e,n,t),set:(e,n)=>Gle(e,n,t),difference:(e,n)=>Kle(e,n,t),BigNumber:Js});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Xle="2.5.0",cs=y_(),Jle=w_(),Zle=wle(un),Qle=UL();let Cl=jle(un),Xl=qle(un);const eue=v_;class qL{constructor(e){this._value=e}clone(){return un(this._value)}format(e={}){return Cl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=eue.parseFormat(e)),e=Cl.formatOrDefault(e,cs.currentCurrencyDefaultFormat()),e.output="currency",Cl.format(this,e)}formatTime(e={}){return e.output="time",Cl.format(this,e)}binaryByteUnits(){return Cl.getBinaryByteUnit(this)}decimalByteUnits(){return Cl.getDecimalByteUnit(this)}byteUnits(){return Cl.getByteUnit(this)}difference(e){return Xl.difference(this,e)}add(e){return Xl.add(this,e)}subtract(e){return Xl.subtract(this,e)}multiply(e){return Xl.multiply(this,e)}divide(e){return Xl.divide(this,e)}set(e){return Xl.set(this,XL(e))}value(){return this._value}valueOf(){return this._value}}function XL(t){let e=t;return un.isNumbro(t)?e=t._value:typeof t=="string"?e=un.unformat(t):isNaN(t)&&(e=NaN),e}function un(t){return new qL(XL(t))}un.version=Xle;un.isNumbro=function(t){return t instanceof qL};un.language=cs.currentLanguage;un.registerLanguage=cs.registerLanguage;un.setLanguage=cs.setLanguage;un.languages=cs.languages;un.languageData=cs.languageData;un.zeroFormat=cs.setZeroFormat;un.defaultFormat=cs.currentDefaults;un.setDefaults=cs.setDefaults;un.defaultCurrencyFormat=cs.currentCurrencyDefaultFormat;un.validate=Jle.validate;un.loadLanguagesInNode=Zle.loadLanguagesInNode;un.unformat=Qle.unformat;un.BigNumber=Xl.BigNumber;var tue=un,bl=Jae(tue);const nue="numeric";function JL(t,e){if(er(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!bl.languages()[r]){const o=r.replace("-",""),s=bl.allLanguages?bl.allLanguages[r]:bl[o];s&&bl.registerLanguage(s)}bl.setLanguage(r),t=bl(t).format(i||"0")}return t}function b_(t,e,n,r,i,o,s){let a=o;if(er(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=JL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}sa(t,e,n,r,i,a,s)}b_.RENDERER_TYPE=nue;const rue="password";function S_(t,e,n,r,i,o,s){sa.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";me(a-1,()=>{u+=l}),$u(e,u)}S_.RENDERER_TYPE=rue;const iue="select";function R_(t,e,n,r,i,o,s){sa.apply(this,[t,e,n,r,i,o,s])}R_.RENDERER_TYPE=iue;const oue="time";function E_(t,e,n,r,i,o,s){sa.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}E_.RENDERER_TYPE=oue;function sue(){Xr(Oh),Xr(Ag),Xr(g_),Xr(f_),Xr(p_),Xr(d_),Xr(b_),Xr(S_),Xr(R_),Xr(sa),Xr(E_)}const aue="autocomplete";function yy(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,nA(n,e)):nA(n,e)(this.source):e(!0)}yy.VALIDATOR_TYPE=aue;function nA(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function ZL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const lue=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:ZL},Symbol.toStringTag,{value:"Module"})),uue="date";function T_(t,e){const n=T$(kL,this.instance);let r=t,i=!0;r==null&&(r="");let o=Q(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Q(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=cue(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}T_.VALIDATOR_TYPE=uue;function cue(t,e){const n=Q(ZL(t)),r=Q(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const hue="dropdown";function M_(t,e){yy.apply(this,[t,e])}M_.VALIDATOR_TYPE=hue;const due="numeric";function __(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:er(t))}__.VALIDATOR_TYPE=due;const fue=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],gue="time";function x_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Q(i,fue,!0).isValid()?Q(i):Q(i,n);let a=s.isValid(),l=Q(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}x_.VALIDATOR_TYPE=gue;function mue(){tu(yy),tu(M_),tu(T_),tu(__),tu(x_)}const pue="autocomplete",wue={CELL_TYPE:pue,editor:c_,renderer:Oh,validator:yy},vue="checkbox",yue={CELL_TYPE:vue,editor:DL,renderer:g_},Cue="date";function QL(t,e,n,r,i,o,s){Oh.apply(this,[t,e,n,r,i,o,s])}QL.RENDERER_TYPE=Cue;const bue="date",Sue={CELL_TYPE:bue,editor:$L,renderer:QL,validator:T_},Rue="dropdown",Eue={CELL_TYPE:Rue,editor:LL,renderer:f_,validator:M_,filter:!1,strict:!0},Tue="handsontable",Mue={CELL_TYPE:Tue,editor:u_,renderer:p_},_ue="numeric",xue={CELL_TYPE:_ue,editor:FL,renderer:b_,validator:__,dataType:"number"},Iue="password",Pue={CELL_TYPE:Iue,editor:VL,renderer:S_,copyable:!1},Oue="select",Aue={CELL_TYPE:Oue,editor:BL,renderer:R_},Hue="time",Nue={CELL_TYPE:Hue,editor:WL,renderer:E_,validator:x_};function Due(){wi(wue),wi(yue),wi(Sue),wi(Eue),wi(Mue),wi(xue),wi(Pue),wi(Aue),wi(HL),wi(Nue)}function kue(t,e){eF(t,e),e.add(t)}function $ue(t,e,n){eF(t,e),e.set(t,n)}function eF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ec(t,e,n){return(e=Lue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lue(t){var e=Fue(t,"string");return typeof e=="symbol"?e:e+""}function Fue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tc(t,e){return t.get(tF(t,e))}function tF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rA=new Map([["plugin",YQ],["cell-type",RL],["editor",E$],["renderer",N$],["validator",D$]]),nF=Symbol("mainSetting"),Vue="base",Vm=[];let Sl=null;var Rl=new WeakMap,iA=new WeakSet;class nt{static get PLUGIN_KEY(){return Vue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){kue(this,iA),ec(this,"eventManager",new Pi(this)),ec(this,"pluginName",null),ec(this,"pluginsInitializedCallbacks",[]),ec(this,"isPluginsReady",!1),ec(this,"enabled",!1),ec(this,"initialized",!1),$ue(this,Rl,{}),us(this,"hot",e,{writable:!1}),Sl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!rA.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);rA.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Vm.push(o)}}if(Sl||(Sl=dT()),Sl.indexOf(this.pluginName)>=0&&Sl.splice(Sl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Sl.length===0){if(Vm.length>0){const i=[`${Vm.join(`
`)}
`,"You have to import and register them manually."].join("");throw Vm.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||Le(n))&&r[nF]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(Le(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){tc(Rl,this)[e]=tc(Rl,this)[e]||[];const i=tc(Rl,this)[e];this.hot.addHook(e,n,r),i.push(n),tc(Rl,this)[e]=i}removeHooks(e){x(tc(Rl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=tc(Rl,this);Fe(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){x(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=tF(iA,this,Bue).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Fe(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function Bue(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function El(t,e,n){return(e=Wue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wue(t){var e=jue(t,"string");return typeof e=="symbol"?e:e+""}function jue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let I_=class{constructor(e){El(this,"hot",null),El(this,"container",null),El(this,"injected",!1),El(this,"rows",[]),El(this,"columns",[]),El(this,"samples",null),El(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),x(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),x(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{x(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{x(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{x(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),x(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{x(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Bm(t,e,n){return(e=Uue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uue(t){var e=zue(t,"string");return typeof e=="symbol"?e:e+""}function zue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cy{static get SAMPLE_COUNT(){return 3}constructor(e){Bm(this,"samples",null),Bm(this,"dataFactory",null),Bm(this,"customSampleCount",null),Bm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Cy.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return me(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return me(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Le(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${At(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function Yue(t,e){rF(t,e),e.add(t)}function Eb(t,e,n){rF(t,e),e.set(t,n)}function rF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){return(e=Gue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gue(t){var e=Kue(t,"string");return typeof e=="symbol"?e:e+""}function Kue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Va(t,e){return t.get($r(t,e))}function Yw(t,e,n){return t.set($r(t,e),n),n}function $r(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("modifyAutoColumnSizeSeed");const Tb="autoColumnSize",que=10,Xue="autoColumnSize";var P_=new WeakMap,Ic=new WeakMap,dh=new WeakMap,Jr=new WeakSet;class cf extends nt{static get PLUGIN_KEY(){return Tb}static get PLUGIN_PRIORITY(){return que}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Yue(this,Jr),dd(this,"ghostTable",new I_(this.hot)),dd(this,"samplesGenerator",new Cy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),dd(this,"inProgress",!1),dd(this,"measuredColumns",0),dd(this,"columnWidthsMap",new il),Eb(this,P_,!1),Eb(this,Ic,[]),Eb(this,dh,[]),this.hot.columnIndexMapper.registerMap(Xue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>$r(Jr,this,oA).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Tb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $r(Jr,e,Que).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $r(Jr,e,ece).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $r(Jr,e,nce).call(e,...i)}),this.addHook("beforeRender",()=>$r(Jr,this,Zue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>$r(Jr,this,tce).call(this)),super.enablePlugin()}updatePlugin(){Yw(dh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>$r(Jr,this,oA).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;me(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&$r(Jr,this,iF).call(this,s,o)}),this.ghostTable.columns.length&&($r(Jr,this,oF).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Wf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+cf.CALCULATION_STEP,i)},e,n),r=r+cf.CALCULATION_STEP+1,r<i?o=Bf(s):(Wf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Tb];let n=cf.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Le(e)&&(n=e.syncLimit,VE(n)?n=cT(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,lh))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Va(Ic,this).length;return(s-1<o||Va(Ic,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Va(Ic,this).push(i):Va(Ic,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Jue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||$r(Jr,this,iF).call(this,n,e))}),this.ghostTable.columns.length&&($r(Jr,this,oF).call(this),this.ghostTable.clean())}function iF(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function oF(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function Zue(){this.calculateVisibleColumnsWidth(),this.inProgress||($r(Jr,this,Jue).call(this,Va(dh,this)),Yw(dh,this,[]))}function Que(t,e){e||this.recalculateAllColumnsWidth()}function ece(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Va(dh,this).push(...e)}function oA(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function tce(){Yw(Ic,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Yw(P_,this,!0)}function nce(t){if(!Va(P_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Va(dh,this).push(...e)}const iu={horizontal:"horizontal",vertical:"vertical"};function rce(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function ice(t){const e={};return t===!0?(e.directions=Object.keys(iu),e.autoInsertRow=!0):Le(t)?(ue(t.autoInsertRow)?t.direction===iu.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(iu)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function oce(t,e){sce(t,e),e.add(t)}function sce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nc(t,e,n){return(e=ace(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ace(t){var e=lce(t,"string");return typeof e=="symbol"?e:e+""}function lce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("modifyAutofillRange");se.getSingleton().register("beforeAutofill");se.getSingleton().register("afterAutofill");const sA="autofill",uce=20,cce=["fillHandle"],hce="insert_row_below",dce=200;var rc=new WeakSet;class fce extends nt{constructor(){super(...arguments),oce(this,rc),nc(this,"addingStarted",!1),nc(this,"mouseDownOnCellCorner",!1),nc(this,"mouseDragOutside",!1),nc(this,"handleDraggedCells",0),nc(this,"directions",[]),nc(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return sA}static get PLUGIN_PRIORITY(){return uce}static get SETTING_KEYS(){return[sA,...cce]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>fd(rc,this,mce).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>fd(rc,this,gce).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>fd(rc,this,pce).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return x(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),x(a,c=>{const h=[];x(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=rce(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),p=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,g,p,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=C;const y=C;if(["up","left"].indexOf(c)>-1&&!(y.length===1&&y[0].length===0))if(E=[],c==="up"){const T=d.row-h.row+1,_=T%y.length;for(let P=0;P<T;P++)E.push(y[(P+(y.length-_))%y.length])}else{const T=d.col-h.col+1,_=T%y[0].length;for(let P=0;P<y.length;P++){E.push([]);for(let M=0;M<T;M++)E[P].push(y[P][(M+(y[P].length-_))%y[P].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,p,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(iu.vertical)&&this.directions.includes(iu.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(iu.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(iu.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(hce,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},dce)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!en(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!en(s)||!en(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Je(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=zn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+mn(this.hot.table),i=zn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ln(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>fd(rc,this,wce).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>fd(rc,this,vce).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=ice(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function gce(){this.selectAdjacent()&&this.fillIn()}function mce(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function pce(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function wce(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function vce(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function yce(t,e){sF(t,e),e.add(t)}function aA(t,e,n){sF(t,e),e.set(t,n)}function sF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ic(t,e,n){return(e=Cce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cce(t){var e=bce(t,"string");return typeof e=="symbol"?e:e+""}function bce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aF(t,e,n){return t.set(jo(t,e),n),n}function Gw(t,e){return t.get(jo(t,e))}function jo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Mb="autoRowSize",Sce=40,Rce="autoRowSize";var Gf=new WeakMap,O_=new WeakMap,xs=new WeakSet;class hf extends nt{static get PLUGIN_KEY(){return Mb}static get PLUGIN_PRIORITY(){return Sce}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),yce(this,xs),ic(this,"headerHeight",null),ic(this,"ghostTable",new I_(this.hot)),ic(this,"samplesGenerator",new Cy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),ic(this,"inProgress",!1),ic(this,"measuredRows",0),ic(this,"rowHeightsMap",new il),aA(this,Gf,[]),aA(this,O_,!1),this.hot.rowIndexMapper.registerMap(Rce,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>jo(xs,this,lA).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Mb];return e===!0||Le(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jo(xs,e,Mce).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jo(xs,e,_ce).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jo(xs,e,Ice).call(e,...i)}),this.addHook("beforeRender",()=>jo(xs,this,Tce).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>jo(xs,this,xce).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>jo(xs,this,lA).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}me(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Wf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+hf.CALCULATION_STEP,i)},e,n),r=r+hf.CALCULATION_STEP+1,r<i?o=Bf(s):(Wf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Mb];let n=hf.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Le(e)&&(n=e.syncLimit,VE(n)?n=cT(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Ece(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Tce(){this.calculateVisibleRowsHeight(),this.inProgress||(jo(xs,this,Ece).call(this,Gw(Gf,this)),aF(Gf,this,[]))}function lA(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Mce(t,e){e||this.recalculateAllRowsHeight()}function _ce(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Gw(Gf,this).push(...e)}function xce(){this.recalculateAllRowsHeight(),aF(O_,this,!0)}function Ice(t){if(!Gw(O_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Gw(Gf,this).push(...e)}const{getListWithInsertedItems:Pce,getListWithRemovedItems:Oce}=oL("physicallyIndexed");class Ace extends Lu{constructor(){super(e=>e)}insert(e,n){const r=$T(this.indexedValues,n);this.indexedValues=Pce(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Oce(this.indexedValues,e);this.indexedValues=kT(n,e),super.remove(e)}}const{getListWithInsertedItems:Hce,getListWithRemovedItems:Nce}=oL("physicallyIndexed");class Dce extends Lu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Hce(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=Nce(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function kce(t,e){$ce(t,e),e.add(t)}function $ce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lce(t,e,n){return(e=Fce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fce(t){var e=Vce(t,"string");return typeof e=="symbol"?e:e+""}function Vce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uA="bindRowsWithHeaders",Wce=210,jce="loose",cA=new Map([["loose",Ace],["strict",Dce]]);var hA=new WeakSet;class Uce extends nt{constructor(){super(...arguments),kce(this,hA),Lce(this,"headerIndexes",null)}static get PLUGIN_KEY(){return uA}static get PLUGIN_PRIORITY(){return Wce}isEnabled(){return!!this.hot.getSettings()[uA]}enablePlugin(){var e;if(this.enabled)return;const n=(e=cA.get(this.getSetting()))!==null&&e!==void 0?e:cA.get(jce);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>Bce(hA,this,zce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function zce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Yce(t,e){lF(t,e),e.add(t)}function Gce(t,e,n){lF(t,e),e.set(t,n)}function lF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dA(t,e,n){return(e=Kce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kce(t){var e=qce(t,"string");return typeof e=="symbol"?e:e+""}function qce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fA(t,e){return t.get(Fc(t,e))}function _b(t,e,n){return t.set(Fc(t,e),n),n}function Fc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zp="collapsibleColumns",Xce=290,Jce=["nestedHeaders"],Zc="collapsibleIndicator",gA=Zp,mA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var oc=new WeakMap,gd=new WeakSet;class Zce extends nt{constructor(){super(...arguments),Yce(this,gd),dA(this,"nestedHeadersPlugin",null),dA(this,"headerStateManager",null),Gce(this,oc,null)}static get PLUGIN_KEY(){return Zp}static get PLUGIN_PRIORITY(){return Xce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Zp,...Jce]}isEnabled(){return!!this.hot.getSettings()[Zp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||ut("You need to configure the Nested Headers plugin in order to use collapsible headers."),_b(oc,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Fc(gd,this,the).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Fc(gd,e,nhe).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Fc(gd,e,Qce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Fc(gd,this,ehe).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_b(oc,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:gA,relativeToGroup:ol,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};me(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;me(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Zc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Zc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Zc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!mA.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Xa(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;x(r,f=>{var g;let{row:p,col:C}=f;const{collapsible:E,isCollapsed:y}=(g=this.headerStateManager.getHeaderSettings(p,C))!==null&&g!==void 0?g:{};if(!E||y&&n==="collapse"||!y&&n==="expand")return i=!1,!1});const o=[],s=[];i&&x(r,f=>{let{row:g,col:p}=f;const{colspanCompensation:C,affectedColumns:E,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,g,p);C>0&&(s.push(...E),o.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=Dk([...a,...s]):n==="expand"&&(l=Xa(a,f=>!s.includes(f)));const u=mA.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){x(o,f=>{f()});return}this.hot.batchExecution(()=>{x(s,f=>{fA(oc,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;C!==null&&E!==null&&this.hot.selectCell(C,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return fA(oc,this).getHiddenIndexes()}destroy(){_b(oc,this,null),super.destroy()}}function Qce(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Zc}`);if(ku(e,[_i("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),X(u,Zc),e.querySelector("div:first-child").appendChild(u)),ye(u,["collapsed","expanded"]),s?(X(u,"collapsed"),Za(u,"+"),l&&Ee(e,..._i(!1))):(X(u,"expanded"),Za(u,"-"),l&&Ee(e,..._i(!0))),l&&Ee(u,...Du());else{var c;(c=u)===null||c===void 0||c.remove()}}function ehe(t,e){be(t.target,Zc)&&(be(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):be(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ki(t))}function the(){this.updatePlugin()}function nhe(t,e){e||this.updatePlugin()}function Tl(t,e,n){return(e=rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rhe(t){var e=ihe(t,"string");return typeof e=="symbol"?e:e+""}function ihe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ohe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],she=!1,ahe=!0,lhe=!0;class uhe{constructor(e,n){Tl(this,"hot",void 0),Tl(this,"sortingStates",new hy),Tl(this,"sortEmptyCells",she),Tl(this,"indicator",ahe),Tl(this,"headerAction",lhe),Tl(this,"compareFunctionFactory",void 0),Tl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Le(e)&&Fe(e,(n,r)=>{ohe.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Le(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ue(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function uF(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?es:en(i)?en(o)?es:s&&t==="asc"?Zt:Qt:en(o)?s&&t==="asc"?Qt:Zt:isNaN(i)&&!isNaN(o)?t==="asc"?Qt:Zt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Zt:Qt:i>o?t==="asc"?Qt:Zt:es}}const cF="default";function che(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return es;if(a){if(en(r))return t==="asc"?Zt:Qt;if(en(i))return t==="asc"?Qt:Zt}return isNaN(o)?Qt:isNaN(s)?Zt:o<s?t==="asc"?Zt:Qt:o>s?t==="asc"?Qt:Zt:es}}const hhe="numeric";function dhe(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=en(s),u=en(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Qt;if(l===!1&&u)return Zt}return d===!1&&f?t==="asc"?Zt:Qt:d&&f===!1?t==="asc"?Qt:Zt:d===!1&&f===!1?uF(t,e,n)(s,a):c===i&&h===r?t==="asc"?Zt:Qt:c===r&&h===i?t==="asc"?Qt:Zt:es}}const fhe="checkbox";function ghe(t,e,n){return pF(t,e.dateFormat,n)}const mhe="date";function phe(t,e,n){return pF(t,e.timeFormat,n)}const whe="time",{register:Dg,getItem:pA,hasItem:vhe}=po("sorting.compareFunctionFactory"),{register:hF,getItem:yhe}=po("sorting.mainSortComparator");function dF(t){return vhe(t)?pA(t):pA(cF)}Dg(fhe,dhe);Dg(mhe,ghe);Dg(cF,uF);Dg(hhe,che);Dg(whe,phe);const es=0,Zt=-1,Qt=1;function Che(t,e){const n=yhe(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Kw="asc",qw="desc",fF="colHeader";function bhe(t){if(Le(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Kw,qw].includes(n)}function She(t){if(t.some(n=>bhe(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function wA(t){if(t!==qw)return t===Kw?qw:Kw}function gF(t){return t.querySelector(`.${fF}`)}function mF(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function A_(t,e,n){return t===-1&&e>=0&&Qa(n)===!1}function pF(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return es;if(en(r))return en(i)?es:o&&t==="asc"?Zt:Qt;if(en(i))return o&&t==="asc"?Qt:Zt;const s=Q(r,e),a=Q(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Zt:Qt:a.isBefore(s)?t==="asc"?Qt:Zt:es:Zt:Qt}}function Rhe(t,e){ut(wt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const Ehe="ascending",The="descending",wF="indicatorDisabled",vF="columnSorting",yF="sortAction",CF=new Map([[Kw,Ehe],[qw,The]]);function Mhe(t,e,n,r){const i=[vF];if(r&&i.push(yF),n===!1)return i.push(wF),i;const o=t.getSortOrderOfColumn(e);return ue(o)&&i.push(CF.get(o)),i}function _he(){return Array.from(CF.values()).concat(yF,wF,vF)}function xhe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:dF(u.type))(l,u,d)(c,h)}(0)}}function Ihe(t,e){Phe(t,e),e.add(t)}function Phe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wm(t,e,n){return(e=Ohe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ohe(t){var e=Ahe(t,"string");return typeof e=="symbol"?e:e+""}function Ahe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xw="columnSorting",Hhe=50,Jw="append",Nhe="replace",vA=Xw;hF(Xw,xhe);se.getSingleton().register("beforeColumnSort");se.getSingleton().register("afterColumnSort");const md=new WeakMap;var Jl=new WeakSet;class bF extends nt{constructor(){super(...arguments),Ihe(this,Jl),Wm(this,"columnStatesManager",null),Wm(this,"columnMetaCache",null),Wm(this,"pluginKey",Xw),Wm(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Xw}static get PLUGIN_PRIORITY(){return Hhe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(md.has(this.hot)&&md.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),Rhe(md.get(this.hot),this.pluginKey);return}this.enabled||(md.set(this.hot,this.pluginKey),this.columnStatesManager=new uhe(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new il(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Pc(Jl,this,Dhe).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pc(Jl,e,$he).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Pc(Jl,this,n0).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pc(Jl,e,khe).call(e,...r)}),this.hot.view&&Pc(Jl,this,n0).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=gF(r);mF(n,r)===!1||i===null||this.updateHeaderClasses(i)};md.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:ol,position:"before",group:vA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vA)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new sL),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return She(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Je(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ue(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Je(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ue(n)){const i=wA(n);return ue(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:wA()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Vt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Jw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Nhe)return[...o.slice(0,r),s,...o.slice(r+1)]}return ue(s)?o.concat(s):o}getPluginColumnConfig(e){if(Le(e)){const n=e[this.pluginKey];if(Le(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):mt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Je(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Je(n,u=>u[0]);Che(n,this.pluginKey,Je(e,u=>u.sortOrder),Je(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Je(n,u=>u[0]),a=new Map(Je(o,(u,c)=>[u,s[c]])),l=Je(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Le(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Le(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ye(e,_he()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];X(e,Mhe(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&be(e.target,fF)}onAfterOnCellMouseDown(e,n){if(A_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function n0(){const t=this.getAllSavedSortSettings();if(Le(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Dhe(t,e){const n=gF(e);if(mF(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ee(e,...lJ(s?`${s}ending`:"none"))}}function khe(t){t===!0&&this.hot.view&&Pc(Jl,this,n0).call(this)}function $he(t,e,n,r){A_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Ml(t,e,n){return(e=Lhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lhe(t){var e=Fhe(t,"string");return typeof e=="symbol"?e:e+""}function Fhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vhe{constructor(e,n){Ml(this,"plugin",void 0),Ml(this,"hot",void 0),Ml(this,"endpoints",[]),Ml(this,"settings",void 0),Ml(this,"settingsType","array"),Ml(this,"currentEndpoint",null),Ml(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),x(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();x(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;x(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?x(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):x(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){x(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];x(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),x(i,o=>{let s=[];x(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,x(e.ranges,r=>{x(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],x(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],x(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],x(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&x(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),x(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ut("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function xb(t){return t==null||isNaN(t)}function Bhe(t,e){Whe(t,e),e.add(t)}function Whe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jhe(t,e,n){return(e=Uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uhe(t){var e=zhe(t,"string");return typeof e=="symbol"?e:e+""}function zhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ib="columnSummary",Yhe=220;var pd=new WeakSet;class Ghe extends nt{constructor(){super(...arguments),Bhe(this,pd),jhe(this,"endpoints",null)}static get PLUGIN_KEY(){return Ib}static get PLUGIN_PRIORITY(){return Yhe}isEnabled(){return!!this.hot.getSettings()[Ib]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Ib],this.endpoints=new Vhe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jm(pd,e,Khe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jm(pd,e,Xhe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jm(pd,e,qhe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jm(pd,e,Jhe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Fe(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=xb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Fe(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=xb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=xb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Fe(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(wt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Khe(){this.endpoints.initEndpoints()}function qhe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Xhe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Jhe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Zhe(t,e){SF(t,e),e.add(t)}function Pb(t,e,n){SF(t,e),e.set(t,n)}function SF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oc(t,e){return t.get(H_(t,e))}function r0(t,e,n){return t.set(H_(t,e),n),n}function H_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zw=new WeakMap,Um=new WeakMap,zm=new WeakMap,yA=new WeakSet;class RF{constructor(){Zhe(this,yA),Pb(this,Zw,!0),Pb(this,Um,null),Pb(this,zm,new ResizeObserver(e=>H_(yA,this,Qhe).call(this,e)))}setObservedElement(e){r0(Um,this,e)}unobserve(){Oc(zm,this).unobserve(Oc(Um,this))}observe(){r0(Zw,this,!0),Oc(zm,this).observe(Oc(Um,this))}destroy(){Oc(zm,this).disconnect()}}function Qhe(t){if(Oc(Zw,this)||!Array.isArray(t)||!t.length){r0(Zw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}bt(RF,Yn);function _l(t,e,n){ede(t,e),e.set(t,n)}function ede(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(t,e){return t.get(EF(t,e))}function bs(t,e,n){return t.set(EF(t,e),n),n}function EF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xl=new WeakMap,Ob=new WeakMap,Ss=new WeakMap,ha=new WeakMap,da=new WeakMap,Ym=new WeakMap,sc=new WeakMap;class ou{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;_l(this,xl,void 0),_l(this,Ob,!1),_l(this,Ss,null),_l(this,ha,void 0),_l(this,da,void 0),_l(this,Ym,!0),_l(this,sc,new RF),bs(xl,this,e),bs(Ob,this,n),bs(ha,this,this.createEditor()),bs(da,this,St(ha,this).style),St(sc,this).setObservedElement(this.getInputElement()),St(sc,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){St(da,this).left=`${e}px`,St(da,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ln(this.getInputElement()),height:mn(this.getInputElement())}}observeSize(){St(sc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){St(da,this).display="block",bs(Ym,this,!1)}hide(){St(sc,this).unobserve(),St(Ym,this)||(St(da,this).display="none"),bs(Ym,this,!0)}isVisible(){return St(da,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return St(xl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=St(xl,this).createElement("div"),n=St(xl,this).createElement("textarea");return e.style.display="none",bs(Ss,this,St(xl,this).createElement("div")),St(Ss,this).setAttribute("dir",St(Ob,this)?"rtl":"ltr"),X(St(Ss,this),ou.CLASS_EDITOR_CONTAINER),St(xl,this).body.appendChild(St(Ss,this)),X(e,ou.CLASS_EDITOR),X(n,ou.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),St(Ss,this).appendChild(e),e}getInputElement(){return St(ha,this).querySelector(`.${ou.CLASS_INPUT}`)}getEditorElement(){return St(ha,this)}destroy(){const e=St(Ss,this)?St(Ss,this).parentNode:null;St(ha,this).parentNode.removeChild(St(ha,this)),bs(ha,this,null),bs(da,this,null),St(sc,this).destroy(),e&&e.removeChild(St(Ss,this))}}bt(ou,Yn);function Ab(t,e,n){return(e=tde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tde(t){var e=nde(t,"string");return typeof e=="symbol"?e:e+""}function nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rde=250,ide=250;class TF{constructor(e){Ab(this,"wasLastActionShow",!0),Ab(this,"showDebounced",null),Ab(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},ide)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rde;this.showDebounced=Eg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}bt(TF,Yn);function ode(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function sde(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Il(t,e){const n={};return x(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Ta(t,e,n,r,i){x(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&ade(s,a,e,n,r,i)})})}function ade(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=ode(s.className,r):a=sde(s.className,r)),o(t,e,"className",a)}function MF(t){return`<span class="selected">✓</span>${t}`}function Qp(t,e){let n=!1;return Array.isArray(t)&&x(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function by(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Be="---------";function lde(){return{name:Be}}const Ci="alignment";function ude(){return{key:Ci,name(){return this.getTranslatedPhrase(lM)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ci}:left`,name(){return this.getTranslatedPhrase(uM)},callback(){const t=this.getSelectedRange(),e=Il(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Ta(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ci}:center`,name(){return this.getTranslatedPhrase(cM)},callback(){const t=this.getSelectedRange(),e=Il(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Ta(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ci}:right`,name(){return this.getTranslatedPhrase(hM)},callback(){const t=this.getSelectedRange(),e=Il(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Ta(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ci}:justify`,name(){return this.getTranslatedPhrase(dM)},callback(){const t=this.getSelectedRange(),e=Il(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Ta(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Be},{key:`${Ci}:top`,name(){return this.getTranslatedPhrase(fM)},callback(){const t=this.getSelectedRange(),e=Il(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Ta(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ci}:middle`,name(){return this.getTranslatedPhrase(gM)},callback(){const t=this.getSelectedRange(),e=Il(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Ta(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ci}:bottom`,name(){return this.getTranslatedPhrase(mM)},callback(){const t=this.getSelectedRange(),e=Il(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Ta(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Sy="clear_column";function cde(){return{key:Sy,name(){return this.getTranslatedPhrase(KT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const kg="col_left";function hde(){return{key:kg,name(){return this.getTranslatedPhrase(WT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const $g="col_right";function dde(){return{key:$g,name(){return this.getTranslatedPhrase(jT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Lg="make_read_only";function fde(){return{key:Lg,checkable:!0,ariaChecked(){return Qp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Bw)},name(){let t=this.getTranslatedPhrase(Bw);return Qp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=MF(t)),t},callback(){const t=this.getSelectedRange(),e=Qp(t,(n,r)=>this.getCellMeta(n,r).readOnly);x(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Ry="redo";function gde(){return{key:Ry,name(){return this.getTranslatedPhrase(GT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Fg="remove_col";function mde(){return{key:Fg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(zT,e)},callback(){this.alter("remove_col",Zie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Ey="remove_row";function pde(){return{key:Ey,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(UT,e)},callback(){this.alter("remove_row",Qie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Ty="row_above";function wde(){return{key:Ty,name(){return this.getTranslatedPhrase(VT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const My="row_below";function vde(){return{key:My,name(){return this.getTranslatedPhrase(BT)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Kf="no_items";function yde(){return{key:Kf,name(){return this.getTranslatedPhrase(FT)},disabled:!0,isCommand:!1}}const _y="undo";function Cde(){return{key:_y,name(){return this.getTranslatedPhrase(YT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const bde=[Ty,My,kg,$g,Sy,Ey,Fg,_y,Ry,Lg,Ci,Be,Kf],Sde={[Be]:lde,[Kf]:yde,[Ty]:wde,[My]:vde,[kg]:hde,[$g]:dde,[Sy]:cde,[Ey]:pde,[Fg]:mde,[_y]:Cde,[Ry]:gde,[Lg]:fde,[Ci]:ude};function _F(){const t={};return Fe(Sde,(e,n)=>{t[n]=e()}),t}function Rde(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(oM):this.getTranslatedPhrase(iM)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Ede(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(sM)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Tde(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(aM);return Qp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,ew))?MF(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,ew);t.updateCommentMeta(n,r,{[ew]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Mde(t,e){xF(t,e),e.add(t)}function ac(t,e,n){xF(t,e),e.set(t,n)}function xF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _de(t,e,n){return(e=xde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xde(t){var e=Ide(t,"string");return typeof e=="symbol"?e:e+""}function Ide(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ba(t,e,n){return t.set(Or(t,e),n),n}function ke(t,e){return t.get(Or(t,e))}function Or(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qw="comments",Pde=60,Hs="comment",Xd="value",IF="style",ew="readOnly",wd=Qw,i0=`plugin:${Qw}`;var yt=new WeakMap,Fo=new WeakMap,xy=new WeakMap,tw=new WeakMap,o0=new WeakMap,ev=new WeakMap,Ur=new WeakSet;class Ode extends nt{constructor(){super(...arguments),Mde(this,Ur),_de(this,"range",{}),ac(this,yt,null),ac(this,Fo,null),ac(this,xy,!1),ac(this,tw,!1),ac(this,o0,null),ac(this,ev,"")}static get PLUGIN_KEY(){return Qw}static get PLUGIN_PRIORITY(){return Pde}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Qw]}enablePlugin(){var e=this;this.enabled||(ke(yt,this)||(Ba(yt,this,new ou(this.hot.rootDocument,this.hot.isRtl())),ke(yt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Or(Ur,e,Fde).call(e,...r)})),ke(Fo,this)||Ba(Fo,this,new TF(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Or(Ur,this,kde).call(this,n,a)),this.addHook("afterScroll",()=>Or(Ur,this,Vde).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Or(Ur,this,CA).call(this,n)),this.addHook("beforeCompositionStart",n=>Or(Ur,this,CA).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Or(Ur,e,Bde).call(e,...r)}),ke(Fo,this).addLocalHook("hide",()=>this.hide()),ke(Fo,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){ke(Fo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(i0);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Ba(tw,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(i0),this.hot._registerTimeout(()=>{Ba(tw,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:wd}),r.addShortcut({keys:[["Escape"]],callback:()=>{ke(yt,this).setValue(ke(ev,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>ke(yt,this).isVisible()&&ke(yt,this).isFocused(),group:wd}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>ke(yt,this).isVisible()&&ke(yt,this).isFocused(),group:wd}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{ke(yt,this).setValue(ke(yt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:wd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wd)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Or(Ur,this,Nde).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Or(Ur,this,Ade).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Or(Ur,this,Dde).call(this)),this.eventManager.addEventListener(n,"focus",()=>Or(Ur,this,Lde).call(this)),this.eventManager.addEventListener(n,"blur",()=>Or(Ur,this,$de).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Or(Ur,this,Hde).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Ja(e.target,"TD","TBODY");return!!(n&&be(n,"htCommentCell")&&Ja(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=ke(yt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Xd]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Hs),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Xd)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Xd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return ke(Fo,this).cancelHiding(),ke(yt,this).setValue((e=i[Hs]?i[Hs][Xd]:null)!==null&&e!==void 0?e:""),ke(yt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){ke(yt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!ke(yt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;ke(yt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),p=this.getCommentMeta(i,o,IF);p?ke(yt,this).setSize(p.width,p.height):ke(yt,this).resetSize();const C=c?0:f.getColumnWidth(a),E=l&&!u?mn(g):0,{left:y,top:T,width:_,height:P}=g.getBoundingClientRect(),{width:M,height:I}=ke(yt,this).getSize(),{innerWidth:z,innerHeight:W}=this.hot.rootWindow,V=this.hot.rootDocument.documentElement,q=Nn(this.hot.rootDocument),Z=qE(this.hot.rootWindow)?q:0,ee=XE(this.hot.rootWindow)?q:0;let te=y+h.scrollX+C,he=T+h.scrollY+E;this.hot.isRtl()&&(te-=M+C),this.hot.isLtr()&&y+_+M>z-Z?te=y+h.scrollX-M-1:this.hot.isRtl()&&te<-(V.scrollWidth-V.clientWidth)&&(te=y+h.scrollX+C+1),T+I>W-ee&&(he-=I-P+1),ke(yt,this).setPosition(te,he),ke(yt,this).setReadOnlyState(this.getCommentMeta(i,o,ew)),ke(yt,this).observeSize()}focusEditor(){ke(yt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Hs];let o;i?(o=sr(i),Mg(o,r)):o=r,this.hot.setCellMeta(e,n,Hs,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Hs])return i[Hs][r]}addToContextMenu(e){e.items.push({name:Be},Rde(this),Ede(this),Tde(this))}getEditorInputElement(){return ke(yt,this).getInputElement()}destroy(){var e,n;(e=ke(yt,this))===null||e===void 0||e.destroy(),(n=ke(Fo,this))===null||n===void 0||n.destroy(),super.destroy()}}function Ade(t){if(!(!this.hot.view||!this.hot.view._wt)&&!ke(xy,this)&&!this.targetIsCommentTextArea(t)){const e=Ja(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Hde(t){t.stopPropagation()}function Nde(t){const{rootDocument:e}=this.hot;if(!(ke(xy,this)||ke(yt,this).isFocused()||be(t.target,"wtBorder")||ke(o0,this)===t.target||!ke(yt,this)))if(Ba(o0,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));ke(Fo,this).show(n)}else za(t.target,e)&&!this.targetIsCommentTextArea(t)&&ke(Fo,this).hide()}function Dde(){Ba(xy,this,!1)}function kde(t,e){e[Hs]&&e[Hs][Xd]&&X(t,e.commentedCellClassName)}function $de(){Ba(ev,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Lde(){Ba(ev,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(i0)}function Fde(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[IF]:{width:t,height:e}})}function CA(t){ke(yt,this).isFocused()&&ki(t)}function Vde(){ke(tw,this)||this.hide()}function Bde(){const t=ke(yt,this).getEditorElement();ye(t,/ht-theme-.*/g),X(t,this.hot.getCurrentThemeName())}function Hb(t,e,n){return(e=Wde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wde(t){var e=jde(t,"string");return typeof e=="symbol"?e:e+""}function jde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PF{constructor(e){Hb(this,"hot",void 0),Hb(this,"commands",{}),Hb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Ude(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||fn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),x(u,c=>c.apply(this.hot,r))}}function Ude(t,e){let n;return x(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Nb(t,e,n){return(e=zde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zde(t){var e=Yde(t,"string");return typeof e=="symbol"?e:e+""}function Yde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Nb(this,"hot",void 0),Nb(this,"predefinedItems",_F()),Nb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Fe(e,(r,i)=>{let o="";r.name===Be?(n[Be]=r,o=Be):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Gde(e,this.defaultOrderPattern,this.predefinedItems)}}function Gde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Le(i)?Fe(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Le(o)?pn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):x(i,(o,s)=>{let a=n[o];!a&&bde.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Le(o)&&pn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function fa(t,e,n){return(e=Kde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kde(t){var e=qde(t,"string");return typeof e=="symbol"?e:e+""}function qde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xde{constructor(e,n){fa(this,"top",void 0),fa(this,"topRelative",void 0),fa(this,"left",void 0),fa(this,"leftRelative",void 0),fa(this,"scrollTop",void 0),fa(this,"scrollLeft",void 0),fa(this,"cellHeight",void 0),fa(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function vd(t,e,n){Jde(t,e),e.set(t,n)}function Jde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ne(t,e){return t.get(AF(t,e))}function Gm(t,e,n){return t.set(AF(t,e),n),n}function AF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cr=new WeakMap,_r=new WeakMap,xr=new WeakMap,Db=new WeakMap,lc=new WeakMap;class Zde{constructor(e){vd(this,cr,void 0),vd(this,_r,void 0),vd(this,xr,void 0),vd(this,Db,!1),vd(this,lc,{above:0,below:0,left:0,right:0}),Gm(Db,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ne(lc,this)[e]=n,this}setElement(e){return Gm(cr,this,e),this}setParentElement(e){return Gm(_r,this,e),this}updatePosition(e){Gm(xr,this,new Xde(e,Ne(cr,this).ownerDocument.defaultView)),Ne(Db,this)?(Ne(xr,this).fitsBelow(Ne(cr,this))?this.setPositionBelowCursor():Ne(xr,this).fitsAbove(Ne(cr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ne(cr,this).dir==="rtl"?Ne(xr,this).fitsOnLeft(Ne(cr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ne(xr,this).fitsOnRight(Ne(cr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ne(lc,this).above+Ne(xr,this).top-Ne(cr,this).offsetHeight;if(Ne(_r,this)){const r=Ne(_r,this).ownerDocument.defaultView.getComputedStyle(Ne(_r,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ne(xr,this).top+Ne(xr,this).cellHeight-Ne(cr,this).scrollHeight+i+o}Ne(cr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Ne(lc,this).below+Ne(xr,this).top+1;if(Ne(_r,this)){const r=Ne(_r,this).ownerDocument.defaultView.getComputedStyle(Ne(_r,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ne(xr,this).top-i-o-1}Ne(cr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ne(xr,this).left;if(Ne(_r,this)){const n=Ne(_r,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ne(_r,this).querySelector(".htCore")).borderRightWidth,10);e+=Ne(xr,this).cellWidth+r}else e+=Ne(lc,this).right;Ne(cr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ne(lc,this).left+Ne(xr,this).left-Ne(cr,this).offsetWidth;if(Ne(_r,this)){const n=Ne(_r,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ne(_r,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Ne(cr,this).style.left=`${e}px`}}function HF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Qe(e,-1,g()-1);function a(C,E){const y=g()-1;return C<0&&(C=y),C>y&&(C=0),o.has(C)?-1:(o.add(C),r(C,!1)===!1&&(C=a(E===1?++C:--C,E)),C)}function l(C){C>-1&&C<g()&&r(C,!0)!==!1&&(s=C)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function p(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:p}}function Qde(t){return Je(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function s0(t){return fn(t,"submenu")}function a0(t){return new RegExp(Be,"i").test(t.name)}function nw(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function bA(t){return fn(t,"disableSelection")}function efe(t){return be(t,"htSeparator")}function tfe(t){return be(t,"htSubmenu")}function nfe(t){return be(t,"htDisabled")}function rfe(t){return be(t,"htSelectionDisabled")}function ife(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function NF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function ofe(t,e){let n=t.slice(0);return n.reverse(),n=NF(n,e),n.reverse(),n}function sfe(t){const e=[];return x(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function afe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Be,n=t.slice(0);return n=NF(n,e),n=ofe(n,e),n=sfe(n),n}function lfe(t){return t.checkable===!0}function ufe(t){return HF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||efe(r)||nfe(r)||rfe(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function cfe(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const DF="menu",SA=DF;function hfe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(cfe(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:DF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${SA}:${u}`:SA}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function dfe(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(rs(n),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!nw(a,t)&&!bA(a)&&!a0(a);Ee(n,[...lfe(a)?[Q8(),Lf(c),jk(h)]:[Z8(),Lf(u)],...d?[Nu(-1)]:[],...nw(a,t)?[sJ()]:[],...s0(a)?[_i(!1)]:[]])}n.className="",n.appendChild(l),a0(a)?X(n,"htSeparator"):typeof a.renderer=="function"?(X(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):$u(l,u),nw(a,t)?X(n,"htDisabled"):bA(a)?X(n,"htSelectionDisabled"):s0(a)&&X(n,"htSubmenu")}}function kb(t,e,n){ffe(t,e),e.set(t,n)}function ffe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mo(t,e,n){return(e=gfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gfe(t){var e=mfe(t,"string");return typeof e=="symbol"?e:e+""}function mfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $b(t,e,n){return t.set(kF(t,e),n),n}function Pl(t,e){return t.get(kF(t,e))}function kF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RA=215;var yd=new WeakMap,Km=new WeakMap,qm=new WeakMap;class Ah{get tableBorderWidth(){return Pl(qm,this)===void 0&&this.hotMenu&&$b(qm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Pl(qm,this)}constructor(e,n){var r=this;Mo(this,"hot",void 0),Mo(this,"options",void 0),Mo(this,"eventManager",new Pi(this)),Mo(this,"container",void 0),Mo(this,"positioner",void 0),Mo(this,"hotMenu",null),Mo(this,"hotSubMenus",{}),Mo(this,"parentMenu",void 0),Mo(this,"menuItems",null),Mo(this,"origOutsideClickDeselects",null),kb(this,yd,void 0),kb(this,Km,void 0),kb(this,qm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:RA,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Zde(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=wu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Pl(yd,this)}getKeyboardShortcutsCtrl(){return Pl(Km,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Eg(a=>this.openSubMenu(a),300),n=this.options.minWidth||RA;let r=!1,i=Xa(this.menuItems,a=>(a.key===Kf&&(r=!0),ife(a,this.hot)));if(i.length<1&&!r)i.push(_F()[Kf]);else if(i.length===0)return;i=afe(i,Be);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:dfe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Pl(yd,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),NR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!NR()||!Qa(a))&&o&&this.hasSelectedItem()&&(Jo()||iT()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),$b(yd,this,ufe(this.hotMenu)),$b(Km,this,hfe(this)),Pl(Km,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Pl(yd,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ee(r,[_i(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!tfe(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Ah(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ee(n,[_i(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ee(i,[_i(!1)])}}closeAllSubMenus(){x(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Qde(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||a0(e)||nw(e,this.hot)||s0(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=In(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?mn(this.hotMenu.getCell(c,0)):0;return l+(u.name===Be?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(mt(r)&&(r=r.call(this.hot),r===null||Vt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),r&&X(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ee(this.hotMenu.rootElement,[J8(),Nu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!za(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!za(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&be(e.target,"htCore")&&za(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}bt(Ah,Yn);function pfe(t,e){wfe(t,e),e.add(t)}function wfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lb(t,e,n){return(e=vfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vfe(t){var e=yfe(t,"string");return typeof e=="symbol"?e:e+""}function yfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jd="contextMenu",Cfe=70,EA=Jd;se.getSingleton().register("afterContextMenuDefaultOptions");se.getSingleton().register("beforeContextMenuShow");se.getSingleton().register("afterContextMenuShow");se.getSingleton().register("afterContextMenuHide");se.getSingleton().register("afterContextMenuExecute");var Cd=new WeakSet;class Iy extends nt{constructor(){super(...arguments),pfe(this,Cd),Lb(this,"commandExecutor",new PF(this.hot)),Lb(this,"itemsFactory",null),Lb(this,"menu",null)}static get PLUGIN_KEY(){return Jd}static get PLUGIN_PRIORITY(){return Cfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ty,My,Be,kg,$g,Be,Ey,Fg,Be,_y,Ry,Be,Lg,Be,Ci]}isEnabled(){return!!this.hot.getSettings()[Jd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Jd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Ah(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Xm(Cd,this,Sfe).call(this)),this.menu.addLocalHook("afterOpen",()=>Xm(Cd,this,Rfe).call(this)),this.menu.addLocalHook("afterClose",()=>Xm(Cd,this,Efe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Xm(Cd,this,bfe).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=by(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:EA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(EA)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Fe(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new OF(this.hot,Iy.DEFAULT_ITEMS);const e=this.hot.getSettings()[Jd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),x(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function bfe(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),be(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(be(o,"current")&&be(o,"wtBorder"))))return;const s=by(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Sfe(){this.hot.runHooks("beforeContextMenuShow",this)}function Rfe(){this.hot.runHooks("afterContextMenuShow",this)}function Efe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Iy.SEPARATOR={name:Be};function Tfe(t){return{key:"copy",name(){return this.getTranslatedPhrase(qT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Mfe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Qe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ZT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function _fe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Qe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(JT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function xfe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Qe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(XT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Ife(t){return{key:"cut",name(){return this.getTranslatedPhrase(QT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Pfe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Ofe{constructor(){this.clipboardData=new Pfe}preventDefault(){}composedPath(){return[]}}function Afe(t,e){$F(t,e),e.add(t)}function uc(t,e,n){$F(t,e),e.set(t,n)}function $F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(t,e){return t.get(Vc(t,e))}function cc(t,e,n){return t.set(Vc(t,e),n),n}function Vc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ga=new WeakMap,Fb=new WeakMap,bd=new WeakMap,l0=new WeakMap,u0=new WeakMap,Sd=new WeakMap,Rd=new WeakSet;class Hfe{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Afe(this,Rd),uc(this,ga,void 0),uc(this,Fb,void 0),uc(this,bd,void 0),uc(this,l0,void 0),uc(this,u0,void 0),uc(this,Sd,void 0),cc(Fb,this,n),cc(bd,this,r),cc(l0,this,i),cc(u0,this,o),cc(Sd,this,s)}setSelectedRange(e){cc(ga,this,e)}getCellsRange(){if(gr(Fb,this).call(this)===0||gr(bd,this).call(this)===0)return null;const{row:e,col:n}=gr(ga,this).getTopStartCorner(),{row:r,col:i}=gr(ga,this).getBottomEndCorner(),o=Vc(Rd,this,Nfe).call(this,e,r),s=Vc(Rd,this,Vb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(gr(bd,this).call(this)===0||gr(Sd,this).call(this)===0)return null;const{col:e}=gr(ga,this).getTopStartCorner(),{col:n}=gr(ga,this).getBottomEndCorner(),r=Vc(Rd,this,Vb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(gr(bd,this).call(this)===0||gr(Sd,this).call(this)===0)return null;const{col:e}=gr(ga,this).getTopStartCorner(),{col:n}=gr(ga,this).getBottomEndCorner(),r=Vc(Rd,this,Vb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-gr(Sd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Vb(t,e){return Math.min(e,Math.max(t+gr(u0,this).call(this)-1,t))}function Nfe(t,e){return Math.min(e,Math.max(t+gr(l0,this).call(this)-1,t))}function LF(t){const e=[],n=[];return x(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);me(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);me(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Dfe(t,e){FF(t,e),e.add(t)}function ma(t,e,n){FF(t,e),e.set(t,n)}function FF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ed(t,e,n){return(e=kfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kfe(t){var e=$fe(t,"string");return typeof e=="symbol"?e:e+""}function $fe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kr(t,e){return t.get(Lr(t,e))}function Gi(t,e,n){return t.set(Lr(t,e),n),n}function Lr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("afterCopyLimit");se.getSingleton().register("modifyCopyableRange");se.getSingleton().register("beforeCut");se.getSingleton().register("afterCut");se.getSingleton().register("beforePaste");se.getSingleton().register("afterPaste");se.getSingleton().register("beforeCopy");se.getSingleton().register("afterCopy");const Bb="copyPaste",Lfe=80,Ffe=["fragmentSelection"],TA=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var c0=new WeakMap,h0=new WeakMap,d0=new WeakMap,hc=new WeakMap,Jm=new WeakMap,Zm=new WeakMap,dc=new WeakMap,tv=new WeakMap,Zr=new WeakSet;class Vfe extends nt{constructor(){super(...arguments),Dfe(this,Zr),Ed(this,"columnsLimit",1/0),Ed(this,"rowsLimit",1/0),Ed(this,"pasteMode","overwrite"),Ed(this,"uiContainer",this.hot.rootDocument.body),ma(this,c0,!1),ma(this,h0,!1),ma(this,d0,!1),ma(this,hc,"cells-only"),ma(this,Jm,!1),ma(this,Zm,!1),ma(this,dc,new Hfe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),ma(this,tv,!1),Ed(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Bb}static get SETTING_KEYS(){return[Bb,...Ffe]}static get PLUGIN_PRIORITY(){return Lfe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Bb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Gi(c0,this,this.getSetting("copyColumnHeaders")),Gi(h0,this,this.getSetting("copyColumnGroupHeaders")),Gi(d0,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Lr(Zr,this,jfe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Lr(Zr,r,Ufe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Lr(Zr,this,zfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),jf()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Lr(Zr,r,Yfe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Lr(Zr,r,Gfe).call(r,...o)}),this.addHook("afterSelection",()=>Lr(Zr,this,Kfe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Gi(hc,this,e),Gi(Jm,this,!0),Lr(Zr,this,MA).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Gi(Zm,this,!0),Lr(Zr,this,MA).call(this,"cut")}getRangedCopyableData(e){return uf(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=LF(e);return x(r,o=>{const s=[];x(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Ofe;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}kr(dc,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);kr(hc,this)==="column-headers-only"?n.set("headers",kr(dc,this).getMostBottomColumnHeadersRange()):(kr(hc,this)==="with-column-headers"?n.set("headers",kr(dc,this).getMostBottomColumnHeadersRange()):kr(hc,this)==="with-column-group-headers"&&n.set("headers",kr(dc,this).getAllColumnHeadersRange()),n.set("cells",kr(dc,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:p}=this.hot.getCellMeta(c,a);if(c=p+1,g===!0)continue;d=p,h=a;const C=[],E=o.length%r;for(;C.length<i||h<=u;){const{skipColumnOnPaste:y,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,y===!0)continue;f=T;const _=C.length%i;C.push(e[E][_])}o.push(C)}return Gi(tv,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!kr(Jm,this)||this.isEditorOpened()||Qo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!of(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Gi(Jm,this,!1);const o=this.getRangedData(this.copyableRanges),s=Lr(Zr,this,Bfe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=uf(o);if(e&&e.clipboardData){const u=VR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[TA,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Gi(hc,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!kr(Zm,this)||this.isEditorOpened()||Qo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!of(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Gi(Zm,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=uf(o);if(e&&e.clipboardData){const l=VR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[TA,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Qo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!of(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Xv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=P$(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=ioe(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function MA(t){if(jf()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&n$(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Bfe(t){const{rows:e}=LF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Wfe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&ZE(r)}}}function VF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&QE(r)}}}function jfe(t){t.items.push({name:"---------"},Tfe(this)),kr(c0,this)&&t.items.push(xfe(this)),kr(h0,this)&&t.items.push(_fe(this)),kr(d0,this)&&t.items.push(Mfe(this)),t.items.push(Ife(this))}function Ufe(t,e,n,r,i){kr(tv,this)&&(i.value=!0),Gi(tv,this,!1)}function zfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Yfe(){Lr(Zr,this,VF).call(this)}function Gfe(){Lr(Zr,this,Wfe).call(this)}function Kfe(){Lr(Zr,this,VF).call(this)}function BF(t,e){return`border_row${t}col${e}`}function Zd(){return{width:1,color:"#000"}}function js(){return{hide:!0}}function qfe(){return{width:1,color:"#000",cornerVisible:!1}}function Wb(t){if(ue(t.start)||ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ue(t.end)||ue(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Td(t){return ue(t.start)&&(t.left=t.start),ue(t.end)&&(t.right=t.end),t}function jb(t,e){return{id:BF(t,e),border:qfe(),row:t,col:e,top:js(),bottom:js(),start:js(),end:js()}}function Xfe(t,e){return fn(e,"border")&&e.border&&(t.border=e.border),fn(e,"top")&&ue(e.top)&&(e.top?(Le(e.top)||(e.top=Zd()),t.top=e.top):(e.top=js(),t.top=e.top)),fn(e,"bottom")&&ue(e.bottom)&&(e.bottom?(Le(e.bottom)||(e.bottom=Zd()),t.bottom=e.bottom):(e.bottom=js(),t.bottom=e.bottom)),fn(e,"start")&&ue(e.start)&&(e.start?(Le(e.start)||(e.start=Zd()),t.start=e.start):(e.start=js(),t.start=e.start)),fn(e,"end")&&ue(e.end)&&(e.end?(Le(e.end)||(e.end=Zd()),t.end=e.end):(e.end=js(),t.end=e.end)),t}function Zs(t,e){let n=!1;return x(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!fn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Py(t){return`<span class="selected">✓</span>${t}`}function Jfe(t){return t.some(e=>ue(e.left)||ue(e.right))}function Zfe(t){return t.some(e=>ue(e.start)||ue(e.end))}const Qfe=new Map([["left","start"],["right","end"]]);function ege(t){var e;return(e=Qfe.get(t))!==null&&e!==void 0?e:t}function tge(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(yM);return Zs(this,"bottom")&&(e=Py(e)),e},callback(e,n){const r=Zs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function nge(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(CM);return Zs(this,e)&&(n=Py(n)),n},callback(n,r){const i=Zs(this,e);t.prepareBorder(r,e,i)}}}function rge(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(bM)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Zs(this)}}}function ige(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(vM);return Zs(this,e)&&(n=Py(n)),n},callback(n,r){const i=Zs(this,e);t.prepareBorder(r,e,i)}}}function oge(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(wM);return Zs(this,"top")&&(e=Py(e)),e},callback(e,n){const r=Zs(this,"top");t.prepareBorder(n,"top",r)}}}function sge(t,e){age(t,e),e.add(t)}function age(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lge(t,e,n){return(e=uge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uge(t){var e=cge(t,"string");return typeof e=="symbol"?e:e+""}function cge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _A(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rw="customBorders",hge=90;var Ub=new WeakSet;class dge extends nt{constructor(){super(...arguments),sge(this,Ub),lge(this,"savedBorders",[])}static get PLUGIN_KEY(){return rw}static get PLUGIN_PRIORITY(){return hge}isEnabled(){return!!this.hot.getSettings()[rw]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_A(Ub,this,fge).call(this,e)),this.addHook("init",()=>_A(Ub,this,gge).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Wb(n));const o=uh(e),s=Yf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});x(e,a=>{s(a).forAll((l,u)=>{x(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,ege(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=uh(e),r=Yf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return x(e,o=>{r(o).forAll((s,a)=>{x(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Td(l))})})}),i}clearBorders(e){e?this.setBorders(e):(x(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=jb(e,n);r&&(a=Xfe(a,r),x(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Td(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,r,o=>{me(e.from.col,i,s=>{const a=jb(o,s);let l=0;o===e.from.row&&fn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&fn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&fn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&fn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Td(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=BF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=jb(e,n):o=Wb(o),i?(o[r]=js(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Td(o)))):(o[r]=Zd(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Td(o)))}prepareBorder(e,n,r){x(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":me(o.col,s.col,a=>{me(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":me(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":me(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":me(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){x(e,n=>{const r=Wb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return In([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Je(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){x(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){x(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Je(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):x(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return x(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return x(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):x(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);x(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[rw];if(Array.isArray(e)){const n=sr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Jfe(e),r=Zfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function fge(t){this.hot.getSettings()[rw]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(pM)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[oge(this),ige(this),tge(this),nge(this),rge(this)]}})}function gge(){this.changeBorderSettings()}function mge(t,e){pge(t,e),e.add(t)}function pge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zb(t,e,n){return(e=wge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wge(t){var e=vge(t,"string");return typeof e=="symbol"?e:e+""}function vge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IA="dragToScroll",yge=100;var Yb=new WeakSet;class Cge extends nt{constructor(){super(...arguments),mge(this,Yb),zb(this,"boundaries",null),zb(this,"callback",null),zb(this,"listening",!1)}static get PLUGIN_KEY(){return IA}static get PLUGIN_PRIORITY(){return yge}isEnabled(){return!!this.hot.getSettings()[IA]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>xA(Yb,this,PA).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>xA(Yb,this,PA).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=wu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function PA(t){if(Qa(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function bge(t,e){WF(t,e),e.add(t)}function Sge(t,e,n){WF(t,e),e.set(t,n)}function WF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gb(t,e,n){return(e=Rge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rge(t){var e=Ege(t,"string");return typeof e=="symbol"?e:e+""}function Ege(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tge(t,e){return t.get(bi(t,e))}function jF(t,e,n){return t.set(bi(t,e),n),n}function bi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("afterDropdownMenuDefaultOptions");se.getSingleton().register("beforeDropdownMenuShow");se.getSingleton().register("afterDropdownMenuShow");se.getSingleton().register("afterDropdownMenuHide");se.getSingleton().register("afterDropdownMenuExecute");const iw="dropdownMenu",Mge=230,qf="changeType",Kb=iw;var Oy=new WeakMap,Xi=new WeakSet;class Ay extends nt{static get PLUGIN_KEY(){return iw}static get PLUGIN_PRIORITY(){return Mge}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[kg,$g,Be,Fg,Be,Sy,Be,Lg,Be,Ci]}constructor(e){super(e),bge(this,Xi),Gb(this,"commandExecutor",new PF(this.hot)),Gb(this,"itemsFactory",null),Gb(this,"menu",null),Sge(this,Oy,!1),this.hot.addHook("afterGetColHeader",(n,r)=>bi(Xi,this,xge).call(this,n,r))}isEnabled(){return this.hot.getSettings()[iw]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new OF(this.hot,Ay.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return bi(Xi,e,Nge).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return bi(Xi,e,Hge).call(e,...o)});const n=this.hot.getSettings()[iw],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Ah(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>bi(Xi,this,Ige).call(this)),this.menu.addLocalHook("afterOpen",()=>bi(Xi,this,Pge).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>bi(Xi,this,Oge).call(this,o)),this.menu.addLocalHook("afterClose",()=>bi(Xi,this,Age).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),x(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=by(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${qf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Kb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Kb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Kb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>bi(Xi,this,_ge).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Fe(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function UF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _ge(t){if(be(t.target,qf)){const e=by(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),jF(Oy,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function xge(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${qf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=qf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ee(s,[Du(),Lf(" ")]),Ee(e,[Vk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Ige(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Pge(){this.hot.runHooks("afterDropdownMenuShow",this),bi(Xi,this,UF).call(this,this.menu)}function Oge(t){bi(Xi,this,UF).call(this,t)}function Age(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Hge(t){return Tge(Oy,this)?null:t}function Nge(t){be(t.target,qf)&&jF(Oy,this,!0)}Ay.SEPARATOR={name:Be};function OA(t,e,n){return(e=Dge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dge(t){var e=kge(t,"string");return typeof e=="symbol"?e:e+""}function kge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ge{constructor(e){OA(this,"hot",void 0),OA(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return me(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(me(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();me(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();me(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function AA(t,e,n){return(e=Lge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lge(t){var e=Fge(t,"string");return typeof e=="symbol"?e:e+""}function Fge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){AA(this,"dataProvider",void 0),AA(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=fo(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=pn(fo(N_.DEFAULT_OPTIONS),n),n=pn(n,e),n.filename=BE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function Vge(t,e){Bge(t,e),e.add(t)}function Bge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zF="\r",Wge='"',jge=`
`,Uge="=",zge="+",Yge="-",Gge="@",Kge="	";var qb=new WeakSet;class qge extends N_{constructor(){super(...arguments),Vge(this,qb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Je(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),x(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=At(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=HA(qb,this,Jge).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=HA(qb,this,Xge).call(this,i)),(n||i.indexOf(zF)>=0||i.indexOf(Wge)>=0||i.indexOf(jge)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Xge(t){return t.startsWith(Uge)||t.startsWith(zge)||t.startsWith(Yge)||t.startsWith(Gge)||t.startsWith(Kge)||t.startsWith(zF)?`'${t}`:t}function Jge(t,e){return e.test(t)?`'${t}`:t}const Zge="csv",f0={[Zge]:qge};function Qge(t,e,n){return typeof f0[t]=="function"?new f0[t](e,n):null}const eme="exportFile",tme=240;class nme extends nt{static get PLUGIN_KEY(){return eme}static get PLUGIN_PRIORITY(){return tme}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!f0[e])throw new Error(`Export format type "${e}" is not supported.`);return Qge(e,new $ge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function fc(t,e,n){return(e=rme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rme(t){var e=ime(t,"string");return typeof e=="symbol"?e:e+""}function ime(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vg{constructor(e,n){let{id:r,stateless:i=!0}=n;fc(this,"hot",void 0),fc(this,"id",void 0),fc(this,"elements",[]),fc(this,"hidden",!1),fc(this,"stateId",""),fc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new hy)}getElements(){return this.elements}reset(){x(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),x(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}bt(Vg,Yn);const Xf={};function el(t,e){if(!Xf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Xf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function su(t){if(!Xf[t])throw Error(`Filter condition "${t}" does not exist.`);return Xf[t].descriptor}function yn(t,e,n){n.key=t,Xf[t]={condition:e,descriptor:n}}const Ln="none";function ome(){return!0}yn(Ln,ome,{name:dy,inputsCount:0,showOperators:!1});const df="empty";function sme(t){return en(t.value)}yn(df,sme,{name:xM,inputsCount:0,showOperators:!0});const ow="not_empty";function ame(t,e){return!el(df,e)(t)}yn(ow,ame,{name:IM,inputsCount:0,showOperators:!0});const ff="eq";function lme(t,e){let[n]=e;return At(t.value).toLocaleLowerCase(t.meta.locale)===At(n)}yn(ff,lme,{name:PM,inputsCount:1,showOperators:!0});const sw="neq";function ume(t,e){return!el(ff,e)(t)}yn(sw,ume,{name:OM,inputsCount:1,showOperators:!0});const YF="gt";function cme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}yn(YF,cme,{name:kM,inputsCount:1,showOperators:!0});const GF="gte";function hme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}yn(GF,hme,{name:$M,inputsCount:1,showOperators:!0});const KF="lt";function dme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}yn(KF,dme,{name:LM,inputsCount:1,showOperators:!0});const qF="lte";function fme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}yn(qF,fme,{name:FM,inputsCount:1,showOperators:!0});const D_="date_after";function gme(t,e){let[n]=e;const r=Q(t.value,t.meta.dateFormat),i=Q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}yn(D_,gme,{name:WM,inputsCount:1,showOperators:!0});const k_="date_before";function mme(t,e){let[n]=e;const r=Q(t.value,t.meta.dateFormat),i=Q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}yn(k_,mme,{name:jM,inputsCount:1,showOperators:!0});const nv="between";function pme(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=el(k_,[o]),a=el(D_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}yn(nv,pme,{name:VM,inputsCount:2,showOperators:!0});const XF="not_between";function wme(t,e){return!el(nv,e)(t)}yn(XF,wme,{name:BM,inputsCount:2,showOperators:!0});const JF="begins_with";function vme(t,e){let[n]=e;return At(t.value).toLocaleLowerCase(t.meta.locale).startsWith(At(n))}yn(JF,vme,{name:AM,inputsCount:1,showOperators:!0});const ZF="ends_with";function yme(t,e){let[n]=e;return At(t.value).toLocaleLowerCase(t.meta.locale).endsWith(At(n))}yn(ZF,yme,{name:HM,inputsCount:1,showOperators:!0});const $_="contains";function Cme(t,e){let[n]=e;return At(t.value).toLocaleLowerCase(t.meta.locale).indexOf(At(n))>=0}yn($_,Cme,{name:NM,inputsCount:1,showOperators:!0});const QF="not_contains";function bme(t,e){return!el($_,e)(t)}yn(QF,bme,{name:DM,inputsCount:1,showOperators:!0});const eV="date_tomorrow";function Sme(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(-1,"days").startOf("day"),"d"):!1}yn(eV,Sme,{name:zM,inputsCount:0});const tV="date_today";function Rme(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().startOf("day"),"d"):!1}yn(tV,Rme,{name:UM,inputsCount:0});const nV="date_yesterday";function Eme(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(1,"days").startOf("day"),"d"):!1}yn(nV,Eme,{name:YM,inputsCount:0});d$();function Tme(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Bg(t){const e=new Set(t);return function(n){return e.has(n)}}function L_(t){return t??""}function g0(t){return Array.from(new Set(t)).map(e=>L_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function NA(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Bg(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Tme(a,n)};r&&r(u),i.push(u)}),i}const au="by_value";function Mme(t,e){let[n]=e;return n(t.value)}yn(au,Mme,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Bg(e)]},showOperators:!1});const Jf={};function _me(t){if(!Jf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Jf[t].func;return function(n,r){return e(n,r)}}function xme(t){return Jf[t].name}function F_(t,e,n){Jf[t]={name:e,func:n}}const Ka="conjunction",Ime=qM;function Pme(t,e){return t.every(n=>n.func(e))}F_(Ka,Ime,Pme);const rv="disjunction",Ome=fy;function Ame(t,e){return t.some(n=>n.func(e))}F_(rv,Ome,Ame);const V_="disjunctionWithExtraCondition",Hme=fy;function Nme(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}F_(V_,Hme,Nme);const Dme="numeric",rV="text",kme="date",DA={[Dme]:[Ln,Be,df,ow,Be,ff,sw,Be,YF,GF,KF,qF,nv,XF],[rV]:[Ln,Be,df,ow,Be,ff,sw,Be,JF,ZF,Be,$_,QF],[kme]:[Ln,Be,df,ow,Be,ff,sw,Be,k_,D_,nv,Be,eV,tV,nV]};function $me(t){const e=[];let n=t;return DA[n]||(n=rV),x(DA[n],r=>{let i;r===Be?i={name:Be}:i=fo(su(r)),e.push(i)}),e}function Md(t,e,n){return(e=Lme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lme(t){var e=Fme(t,"string");return typeof e=="symbol"?e:e+""}function Fme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xb="built",Jb="building",kA=["click","input","keydown","keypress","keyup","focus","blur","change"];let uo=class iV{static get DEFAULTS(){return fo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Md(this,"hot",void 0),Md(this,"eventManager",new Pi(this)),Md(this,"options",void 0),Md(this,"_element",void 0),Md(this,"buildState",void 0),this.hot=e,this.options=pn(iV.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Jb?this._element:this.buildState===Xb?(this.update(),this._element):(this.buildState=Jb,this.build(),this.buildState=Xb,this._element)}isBuilt(){return this.buildState===Xb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Sr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Jb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&X(this._element,this.options.className),this.options.children.length)x(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Fe(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),x(kA,r=>e(n,r))}else x(kA,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};bt(uo,Yn);function Vme(t,e){oV(t,e),e.add(t)}function Bme(t,e,n){oV(t,e),e.set(t,n)}function oV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qm(t,e){return t.get(B_(t,e))}function Wme(t,e,n){return t.set(B_(t,e),n),n}function B_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gc=new WeakMap,$A=new WeakSet;class qa extends uo{static get DEFAULTS(){return fo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,pn(qa.DEFAULTS,n)),Vme(this,$A),Bme(this,gc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>B_($A,this,jme).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Wme(gc,this,this._element.firstChild),X(this._element,"htUIInput"),X(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Qm(gc,this).type=this.options.type,Qm(gc,this).placeholder=this.translateIfPossible(this.options.placeholder),Qm(gc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Qm(gc,this).focus()}}function jme(t){this.options.value=t.target.value}function Ume(t,e){sV(t,e),e.add(t)}function _d(t,e,n){sV(t,e),e.set(t,n)}function sV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mc(t,e,n){return t.set(gf(t,e),n),n}function Yt(t,e){return t.get(gf(t,e))}function gf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pn=new WeakMap,ep=new WeakMap,tp=new WeakMap,Zb=new WeakMap,np=new WeakMap,rp=new WeakSet;class Zf extends uo{static get DEFAULTS(){return fo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,pn(Zf.DEFAULTS,n)),Ume(this,rp),_d(this,Pn,null),_d(this,ep,[]),_d(this,tp,void 0),_d(this,Zb,void 0),_d(this,np,void 0),this.registerHooks()}getMenu(){return Yt(Pn,this)}registerHooks(){this.addLocalHook("click",()=>gf(rp,this,Gme).call(this))}setItems(e){mc(ep,this,this.translateNames(e)),Yt(Pn,this)&&Yt(Pn,this).setMenuItems(Yt(ep,this))}translateNames(e){return x(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),mc(Pn,this,new Ah(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Yt(Pn,this).setMenuItems(Yt(ep,this));const e=new uo(this.hot,{className:"htUISelectCaption"}),n=new uo(this.hot,{className:"htUISelectDropdown"});mc(tp,this,e),mc(Zb,this,e.element),mc(np,this,n),this.hot.getSettings().ariaTags&&(Ee(n.element,[Du()]),Ee(this._element,[Fk()])),x([e,n],r=>this._element.appendChild(r.element)),Yt(Pn,this).addLocalHook("select",r=>gf(rp,this,zme).call(this,r)),Yt(Pn,this).addLocalHook("afterClose",()=>gf(rp,this,Yme).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Yt(Pn,this).hot.getTranslatedPhrase(dy),Yt(Zb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Yt(Pn,this)&&(Yt(Pn,this).open(),Yt(Pn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Yt(Pn,this).getNavigator().toFirstItem(),Yt(Pn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Yt(Pn,this)&&Yt(Pn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Yt(Pn,this)&&(Yt(Pn,this).destroy(),mc(Pn,this,null)),Yt(tp,this)&&Yt(tp,this).destroy(),Yt(np,this)&&Yt(np,this).destroy(),super.destroy()}}function zme(t){t.name!==Be&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Yme(){this.runLocalHooks("afterClose")}function Gme(){this.openOptions()}function Kme(t,e){qme(t,e),e.add(t)}function qme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LA(t,e,n){return(e=Xme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xme(t){var e=Jme(t,"string");return typeof e=="symbol"?e:e+""}function Jme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qb=new WeakSet;class m0 extends Vg{constructor(e,n){super(e,{id:n.id,stateless:!1}),Kme(this,Qb),LA(this,"name",""),LA(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Zf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new qa(this.hot,{placeholder:t_})),this.elements.push(new qa(this.hot,{placeholder:n_})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>FA(Qb,this,Zme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),x(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>FA(Qb,this,Qme).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=fo(e.command);n.name.startsWith(tn)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),x(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||su(Ln),n=[];return x(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=su(e?e.name:Ln);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||x(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Zf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof qa)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&X(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||x(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[su(Ln)];if(e!==null){const{visualIndex:r}=e;n=$me(this.hot.getDataType(0,r,this.hot.countRows(),r))}x(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Zme(t){x(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Qme(t){_h(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ki(t))}function VA(t,e,n){epe(t,e),e.set(t,n)}function epe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xd(t,e){return t.get(aV(t,e))}function BA(t,e,n){return t.set(aV(t,e),n),n}function aV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pc=new WeakMap,eS=new WeakMap;class iv extends uo{static get DEFAULTS(){return fo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,pn(iv.DEFAULTS,n)),VA(this,pc,void 0),VA(this,eS,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),BA(eS,this,e),BA(pc,this,this._element.firstChild),xd(pc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(xd(eS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?xd(pc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(xd(pc,this).checked=e)}focus(){this.isBuilt()&&xd(pc,this).focus()}}function tpe(t,e){npe(t,e),e.add(t)}function npe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rpe(t,e,n){return(e=ipe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ipe(t){var e=ope(t,"string");return typeof e=="symbol"?e:e+""}function ope(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function spe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const WA=0;var jA=new WeakSet;class ape extends Vg{constructor(e,n){super(e,{id:n.id,stateless:!1}),tpe(this,jA),rpe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuOperators"),x(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Ka,rv];x(e,n=>{const r=new iv(this.hot,{name:"operator",label:{htmlFor:n,textContent:xme(n)},value:n,checked:n===e[WA],id:n});r.addLocalHook("change",i=>spe(jA,this,lpe).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(wt`Radio button with index ${e} doesn't exist.`);x(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof iv&&n.isChecked());return e?e.getValue():Ka}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&x(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ka,n=arguments.length>1?arguments[1]:void 0,r=e;r===V_&&(r=rv),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(WA)}}function lpe(t){this.setState(t.target.value)}function upe(t,e,n){cpe(t,e),e.set(t,n)}function cpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tS(t,e){return t.get(lV(t,e))}function hpe(t,e,n){return t.set(lV(t,e),n),n}function lV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Id=new WeakMap;class Qf extends uo{static get DEFAULTS(){return fo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,pn(Qf.DEFAULTS,n)),upe(this,Id,void 0)}build(){super.build(),hpe(Id,this,this._element.firstChild)}update(){this.isBuilt()&&(tS(Id,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&tS(Id,this).focus()}activate(){tS(Id,this).click()}}function dpe(t,e){uV(t,e),e.add(t)}function wc(t,e,n){uV(t,e),e.set(t,n)}function uV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(Bc(t,e))}function ji(t,e,n){return t.set(Bc(t,e),n),n}function Bc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const UA="multipleSelect.itemBox";var Ji=new WeakMap,on=new WeakMap,nS=new WeakMap,Rs=new WeakMap,pa=new WeakMap,wa=new WeakMap,Pd=new WeakSet;class eg extends uo{static get DEFAULTS(){return fo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,pn(eg.DEFAULTS,n)),dpe(this,Pd),wc(this,Ji,[]),wc(this,on,void 0),wc(this,nS,void 0),wc(this,Rs,void 0),wc(this,pa,void 0),wc(this,wa,void 0),ji(Rs,this,new qa(this.hot,{placeholder:e_,className:"htUIMultipleSelectSearch"})),ji(pa,this,new Qf(this.hot,{textContent:XM,className:"htUISelectAll"})),ji(wa,this,new Qf(this.hot,{textContent:JM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Oe(on,this)}registerHooks(){Oe(Rs,this).addLocalHook("keydown",e=>Bc(Pd,this,gpe).call(this,e)),Oe(Rs,this).addLocalHook("input",e=>Bc(Pd,this,fpe).call(this,e)),Oe(pa,this).addLocalHook("click",e=>Bc(Pd,this,mpe).call(this,e)),Oe(wa,this).addLocalHook("click",e=>Bc(Pd,this,ppe).call(this,e))}setItems(e){var n;ji(Ji,this,e),(n=Oe(on,this))===null||n===void 0||n.loadData(Oe(Ji,this))}setLocale(e){ji(nS,this,e)}getLocale(){return Oe(nS,this)}getItems(){return[...Oe(Ji,this)]}getValue(){return vpe(Oe(Ji,this))}getSearchInputElement(){return Oe(Rs,this)}getSelectAllElement(){return Oe(pa,this)}getClearAllElement(){return Oe(wa,this)}isSelectedAllValues(){return Oe(Ji,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new uo(this.hot,{className:"htUISelectionControls",children:[Oe(pa,this),Oe(wa,this)]});this._element.appendChild(Oe(Rs,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Oe(on,this))===null||s===void 0||s.destroy(),X(o,"htUIMultipleSelectHot"),ji(on,this,new this.hot.constructor(o,{data:Oe(Ji,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Oe(on,this).listen()},modifyColWidth:u=>{const c=Oe(on,this).container.scrollWidth-Nn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Oe(on,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Oe(on,this).useTheme(u)});const l=Oe(on,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:UA}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Oe(on,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:UA})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Oe(on,this).listen()}reset(){Oe(Rs,this).reset(),Oe(pa,this).reset(),Oe(wa,this).reset()}update(){this.isBuilt()&&(Oe(on,this).loadData(wpe(Oe(Ji,this),this.options.value)),super.update())}destroy(){var e;(e=Oe(on,this))===null||e===void 0||e.destroy(),Oe(Rs,this).destroy(),Oe(wa,this).destroy(),Oe(pa,this).destroy(),ji(Rs,this,null),ji(wa,this,null),ji(pa,this,null),ji(on,this,null),ji(Ji,this,null),super.destroy()}}function fpe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Oe(Ji,this)]:n=Oe(Ji,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Oe(on,this).loadData(n)}function gpe(t){this.runLocalHooks("keydown",t,this),eT(_h,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),ki(t),Oe(on,this).listen(),Oe(on,this).selectCell(0,0))}function mpe(t){const e=[];t.preventDefault(),Oe(on,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(OT(n,r)[0])}),Oe(on,this).setSourceDataAtCell(e)}function ppe(t){const e=[];t.preventDefault(),Oe(on,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(OT(n,r)[0])}),Oe(on,this).setSourceDataAtCell(e)}function wpe(t,e){const n=Bg(e);return t.map(r=>(r.checked=n(r.value),r))}function vpe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function ype(t,e){Cpe(t,e),e.add(t)}function Cpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bpe(t,e,n){return(e=Spe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Spe(t){var e=Rpe(t,"string");return typeof e=="symbol"?e:e+""}function Rpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ip(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Od=new WeakSet;class Epe extends Vg{constructor(e,n){super(e,{id:n.id,stateless:!1}),ype(this,Od),bpe(this,"name",""),this.name=n.name,this.elements.push(new eg(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>ip(Od,this,Tpe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>ip(Od,this,Mpe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===au){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Ln:au},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Xa(i,h=>h.name===au),u={},c=this.hot.getTranslatedPhrase(Ww);if(l){const h=s(r,a),d=Je(h,y=>y.value),f=new Map(h.map(y=>[y.value,this.hot.getCellMeta(y.meta.visualRow,y.meta.visualCol)])),g=g0(d);o&&(l.args[0]=o);const p=[],C=NA(g,l.args[0],c,y=>{y.checked&&p.push(y.value),ip(Od,this,zA).call(this,y,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[p],u.command=su(au),u.itemsSnapshot=C}else u.args=[],u.command=su(Ln);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof eg)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||x(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Ww),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=g0(r),s=NA(o,o,e,l=>{ip(Od,this,zA).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Je(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:L_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Tpe(t){_h(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ki(t))}function zA(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Mpe(t,e){switch(e.type){case"numeric":return JL(t,e);default:return t}}var cV;function _pe(t,e){xpe(t,e),e.add(t)}function xpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ipe(t,e,n){return(e=Ppe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ppe(t){var e=Ope(t,"string");return typeof e=="symbol"?e:e+""}function Ope(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ape(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var YA=new WeakSet;class tg extends Vg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),_pe(this,YA),Ipe(this,"name",""),this.name=n.name,this.elements.push(new qa(this.hot,{type:"button",value:ZM,className:"htUIButton htUIButtonOK",identifier:tg.BUTTON_OK})),this.elements.push(new qa(this.hot,{type:"button",value:QM,className:"htUIButton htUIButtonCancel",identifier:tg.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){x(this.elements,e=>{e.addLocalHook("click",(n,r)=>Ape(YA,this,Hpe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuActionBar"),x(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}cV=tg;function Hpe(t,e){e.options.identifier===cV.BUTTON_OK?this.accept():this.cancel()}function rS(t,e,n){return(e=Npe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Npe(t){var e=Dpe(t,"string");return typeof e=="symbol"?e:e+""}function Dpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const GA="ConditionCollection.filteringStates";class W_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;rS(this,"hot",void 0),rS(this,"isMapRegistrable",void 0),rS(this,"filteringStates",new hy),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(GA,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ka;return e.length?_me(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ka,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(wt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Vt(Jf[r]))throw new Error(wt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:el(a,s)}]},i):u.push({name:a,args:s,func:el(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(GA),this.filteringStates=null,this.clearLocalHooks()}}bt(W_,Yn);function KA(t,e,n){return(e=kpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kpe(t){var e=$pe(t,"string");return typeof e=="symbol"?e:e+""}function $pe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];KA(this,"conditionCollection",void 0),KA(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return x(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return x(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return x(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function Lpe(t,e){Fpe(t,e),e.add(t)}function Fpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ol(t,e,n){return(e=Vpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vpe(t){var e=Bpe(t,"string");return typeof e=="symbol"?e:e+""}function Bpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var op=new WeakSet;class dV{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Lpe(this,op),Ol(this,"hot",void 0),Ol(this,"conditionCollection",void 0),Ol(this,"columnDataFactory",void 0),Ol(this,"changes",[]),Ol(this,"grouping",!1),Ol(this,"latestEditedColumnPosition",-1),Ol(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>iS(op,this,Wpe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>iS(op,this,jpe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>iS(op,this,Upe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,x(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=i$(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new W_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const p=r.columnDataFactory(h);let C;f.isEmpty()?C=p:C=new hV(f,y=>r.columnDataFactory(y)).filter(),C=Je(C,y=>y.meta.visualRow);const E=Bg(C);return f.destroy(),Xa(p,y=>E(y.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Fe(this,(e,n)=>{this[n]=null})}}function Wpe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function jpe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Upe(){x(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}bt(dV,Yn);function zpe(t){return HF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof eg)return r;if(i.element&&!vu(i.element))return!1;i.focus()}})}const Ad="filters";function Ype(t,e){let n=-1,r;const i=zpe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Ad),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof uo&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Ad),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Ad)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const p=r.getNavigator();p.getCurrentPage()>-1&&(n=p.getCurrentPage()),p.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const p=e[i.getCurrentPage()];p instanceof Zf&&(p.openOptions(),g.preventDefault()),p instanceof Qf&&(p.activate(),g.preventDefault()),p instanceof uo||g.preventDefault()}}],Ad)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Ad)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Gpe(t,e){fV(t,e),e.add(t)}function oS(t,e,n){fV(t,e),e.set(t,n)}function fV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hd(t,e,n){return(e=Kpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kpe(t){var e=qpe(t,"string");return typeof e=="symbol"?e:e+""}function qpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aw(t,e,n){return t.set(Ar(t,e),n),n}function Si(t,e){return t.get(Ar(t,e))}function Ar(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const p0="filters",Xpe=250,qA=p0;var Is=new WeakMap,w0=new WeakMap,nu=new WeakMap,zr=new WeakSet;class Jpe extends nt{static get PLUGIN_KEY(){return p0}static get PLUGIN_PRIORITY(){return Xpe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Gpe(this,zr),Hd(this,"dropdownMenuPlugin",null),Hd(this,"conditionCollection",null),Hd(this,"conditionUpdateObserver",null),Hd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Hd(this,"filtersRowsMap",null),oS(this,Is,void 0),oS(this,w0,new WeakSet),oS(this,nu,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ar(zr,n,iwe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[p0]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Og),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>Ar(zr,this,XA).call(this,"accept")),a.addLocalHook("cancel",()=>Ar(zr,this,XA).call(this,"cancel")),a.addLocalHook("change",l=>Ar(zr,this,rwe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(GM)}:`,s=()=>`${this.hot.getTranslatedPhrase(KM)}:`;if(!this.components.get("filter_by_condition")){const a=new m0(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Ar(zr,this,JA).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ape(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new m0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Ar(zr,this,JA).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Epe(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new tg(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new W_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new dV(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Ar(zr,this,owe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Ar(zr,e,nwe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Ar(zr,this,twe).call(this)),this.addHook("afterDropdownMenuShow",()=>Ar(zr,this,Qpe).call(this)),this.addHook("afterDropdownMenuHide",()=>Ar(zr,this,ewe).call(this)),this.addHook("afterChange",a=>Ar(zr,this,Zpe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Si(Is,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=Si(Is,this).getMenu(),c=u.getNavigator(),h=Si(Is,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];aw(Is,this,Ype(this.dropdownMenuPlugin.menu,a));const l=u=>{Si(Is,this).listen(),u.preventDefault(),_h(u.keyCode,"TAB")&&(u.shiftKey?Si(Is,this).toPreviousItem():Si(Is,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:qA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qA)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ka;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,Si(nu,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Je(n.filter(),u=>u.meta.visualRow);const l=Bg(i);me(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),x(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),aw(nu,this,this.exportConditions())}else s!==!1&&!r?(aw(nu,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Si(nu,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return x(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),p=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:L_(p)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=g0(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===rv&&n.command.key!==Ln&&r.command.key!==Ln&&i.command.key!==Ln?o=V_:i.command.key!==Ln&&(n.command.key===Ln||r.command.key===Ln)&&(o=Ka),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new hV(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return x(i,s=>{x(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Zpe(t){t&&x(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Qpe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function ewe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function twe(){const t=this.dropdownMenuPlugin.menu;Si(w0,this).has(t)||Si(Is,this).setMenu(t),Si(w0,this).add(t)}function nwe(t){t.items.push({name:Be}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function XA(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==Ln&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==Ln&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Ln&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function rwe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===m0&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function JA(){this.setListeningDropdownMenu()}function iwe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?X(e,"htFiltersActive"):ye(e,"htFiltersActive")}function owe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&aw(nu,this,Si(nu,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===au),s=n.filter(a=>a.name!==au);if(o.length>=2||s.length>=3)ut(wt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const gV="internal-use-in-handsontable",v0={licenseKey:gV,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function mV(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[tr])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function pV(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function swe(t){var e;const n=t[tr],r=pV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=mV(t);return{...v0,...r,...i}}function awe(t){var e;const n=t[tr],r=pV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=mV(t);return{...r,...i}}function lwe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Hy(){const t="engine_relationship",e=po(tr);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function j_(){const t="shared_engine_usage",e=po(tr);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function uwe(t){const e=t.getSettings(),n=e[tr],r=n==null?void 0:n.engine;if(n===!0||Vt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return cwe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Vt(r.hyperformula)){const o=Hy(),s=j_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:gV}),(r.getConfig().leapYear1900!==v0.leapYear1900||ny(r.getConfig().nullDate,v0.nullDate)===!1)&&ut(wt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function cwe(t,e,n){const r=e[tr],i=swe(e),o=Hy(),s=j_();hwe(t,r.functions),dwe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),fwe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function ZA(t){var e;const n=Hy(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function QA(t,e){if(t){const n=Hy(),r=n.get(t),i=j_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function hwe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){ut(s.message)}})}function dwe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){ut(r.message)}}}function fwe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){ut(a.message)}}),t.resumeEvaluation())}function gwe(t,e){return(Vt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const wV="DD/MM/YYYY";function mwe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function pwe(t){return mwe(t)?t.substr(1):t}function wwe(t){return typeof t=="string"&&t.startsWith("=")}function U_(t,e){return typeof t=="string"&&e==="date"}function vV(t,e){return Q(t,e,!0).isValid()}function yV(t,e){return Q(t,e,!0).format(wV)}function vwe(t,e){return Q(t,wV,!0).format(e)}function CV(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Q(r).format(e)}function ywe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Cwe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function bwe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function z_(t,e,n){const r=Cwe(t,ywe(t,e,n));return bwe(r)}function Al(t,e,n){Swe(t,e),e.set(t,n)}function Swe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lt(t,e){return t.get(bV(t,e))}function va(t,e,n){return t.set(bV(t,e),n),n}function bV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nd=new WeakMap,ya=new WeakMap,Yr=new WeakMap,sp=new WeakMap,sS=new WeakMap,aS=new WeakMap,ap=new WeakMap;class e1{constructor(e,n,r){Al(this,Nd,void 0),Al(this,ya,void 0),Al(this,Yr,void 0),Al(this,sp,[]),Al(this,sS,[]),Al(this,aS,void 0),Al(this,ap,[]),va(Nd,this,e),va(ya,this,n),va(Yr,this,r)}setRemovedHfIndexes(e){return va(ap,this,e.map(n=>{const r=Lt(ya,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Lt(ap,this)}getRemovedHfIndexes(){return Lt(ap,this)}getHfIndexFromVisualIndex(e){const n=Lt(ya,this).getIndexesSequence(),r=Lt(ya,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${or(Lt(Nd,this))}s`;Lt(Yr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Lt(Yr,this).getEngine()[r](Lt(Yr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(va(sS,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),va(aS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Lt(Yr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=z_(Lt(sS,this),Lt(aS,this),Lt(ya,this).getNumberOfIndexes());Lt(Yr,this).getSheetId()===null?Lt(Yr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${or(Lt(Nd,this))}Order`;return n=>{if(Lt(Yr,this).isPerformingUndoRedo())return;const r=Lt(ya,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Lt(sp,this).map(l=>r.indexOf(l)),o=Lt(Yr,this).getEngine().getSheetDimensions(Lt(Yr,this).getSheetId());let s;Lt(Nd,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Lt(Yr,this).getEngine()[e](Lt(Yr,this).getSheetId(),i)}va(sp,this,r)}}init(){va(sp,this,Lt(ya,this).getIndexesSequence())}}function Hl(t,e,n){Rwe(t,e),e.set(t,n)}function Rwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Es(t,e){return t.get(SV(t,e))}function Nl(t,e,n){return t.set(SV(t,e),n),n}function SV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lp=new WeakMap,up=new WeakMap,lS=new WeakMap,uS=new WeakMap,cS=new WeakMap,hS=new WeakMap,dS=new WeakMap;class Ewe{constructor(e,n,r){Hl(this,lp,void 0),Hl(this,up,void 0),Hl(this,lS,void 0),Hl(this,uS,!1),Hl(this,cS,!1),Hl(this,hS,null),Hl(this,dS,null),Nl(lp,this,new e1("row",e,this)),Nl(up,this,new e1("column",n,this)),Nl(lS,this,r)}getForAxis(e){return e==="row"?Es(lp,this):Es(up,this)}setPerformUndo(e){Nl(uS,this,e)}setPerformRedo(e){Nl(cS,this,e)}isPerformingUndoRedo(){return Es(uS,this)||Es(cS,this)}getSheetId(){return Es(dS,this)}getEngine(){return Es(hS,this)}getPostponeAction(){return Es(lS,this)}setupSyncEndpoint(e,n){Nl(hS,this,e),Nl(dS,this,n),Es(lp,this).init(),Es(up,this).init()}}function Twe(t,e){RV(t,e),e.add(t)}function Dl(t,e,n){return(e=Mwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mwe(t){var e=_we(t,"string");return typeof e=="symbol"?e:e+""}function _we(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fS(t,e,n){RV(t,e),e.set(t,n)}function RV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tl(t,e,n){return t.set(rt(t,e),n),n}function hu(t,e){return t.get(rt(t,e))}function rt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tr="formulas",xwe=["maxRows","maxColumns","language"],Iwe=260;se.getSingleton().register("afterNamedExpressionAdded");se.getSingleton().register("afterNamedExpressionRemoved");se.getSingleton().register("afterSheetAdded");se.getSingleton().register("afterSheetRemoved");se.getSingleton().register("afterSheetRenamed");se.getSingleton().register("afterFormulasValuesUpdate");const Hh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Qs=new WeakMap,Ny=new WeakMap,Dd=new WeakMap,at=new WeakSet;class Pwe extends nt{constructor(){var e;super(...arguments),e=this,Twe(this,at),fS(this,Qs,!1),fS(this,Ny,!1),fS(this,Dd,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(at,e,Ywe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(at,e,Gwe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(at,e,Kwe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(at,e,qwe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(at,e,Xwe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(at,e,Jwe).call(e,...r)}]]),Dl(this,"staticRegister",po("formulas")),Dl(this,"engine",null),Dl(this,"sheetId",null),Dl(this,"sheetName",null),Dl(this,"indexSyncer",null),Dl(this,"rowAxisSyncer",null),Dl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return tr}static get PLUGIN_PRIORITY(){return Iwe}static get SETTING_KEYS(){return[tr,...xwe]}isEnabled(){return!!this.hot.getSettings()[tr]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=uwe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){ut("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&rt(at,this,mf).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,t1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,n1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,t1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,n1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Nwe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Dwe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Owe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,kwe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,r1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,r1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,$we).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Lwe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Bwe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Wwe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Fwe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Vwe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,jwe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Uwe).call(n,...i)}),this.indexSyncer=new Ewe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Hwe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,zwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rt(at,n,Awe).call(n,...i)}),hu(Dd,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){hu(Dd,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),QA(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=awe(this.hot.getSettings());lwe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[tr];if(ue(r)&&ue(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[tr].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());rt(at,this,mf).call(this,o)}}super.updatePlugin(e)}destroy(){hu(Dd,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),tl(Dd,this,null),QA(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ue(n)&&!rL(n))return ut("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return ut("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return ut(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){sT(`The sheet named \`${e}\` does not exist, switch aborted.`);return}rt(at,this,mf).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${or(tr)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),ZA(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ue(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ue(l)===!1||ue(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=ZA(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){ut(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return U_(r,o.type)&&(vV(r,o.dateFormat)?r=yV(r,o.dateFormat):wwe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function mf(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function Owe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&er(s)&&(s=CV(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Awe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:p}=h.start,{row:C,col:E}=h.end,y=C-g+1,T=E-p+1;for(let _=0;_<f.length;_+=1)for(let P=0;P<f[_].length;P+=1){const M=f[_][P],I=g+_%y,z=p+P%T,W=this.hot.getCellMeta(I,z);U_(M,W.type)&&(M.startsWith("'")?f[_][P]=M.slice(1):this.isFormulaCellType(I,z,this.sheetId)===!1&&(f[_][P]=vwe(M,W.dateFormat)))}return f}function t1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(or(tr))||tl(Ny,this,Vt(this.hot.getSettings().data))}function Hwe(){if(hu(Ny,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;U_(i,s.type)&&(vV(i,a)?t[r][o]=yV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),tl(Qs,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),tl(Qs,this,!1)}function n1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(or(tr)))return;const r=gwe(this.engine,this.hot.getSettings()[tr].sheetName);if(rt(at,this,mf).call(this,r),n!=="updateSettings")if(hu(Ny,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){tl(Qs,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),tl(Qs,this,!1)}}}function Nwe(t,e,n,r){if(r!=="get"||hu(Qs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=pwe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&er(a)&&(a=CV(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function Dwe(t,e,n,r){if(r!=="get"||hu(Qs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function r1(t,e){if(Hh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function kwe(t,e){if(Hh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!er(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){ut(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function $we(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Lwe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Fwe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Vwe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Bwe(t,e,n){if(Hh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Wwe(t,e,n){if(Hh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function jwe(t,e,n,r){if(Hh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Uwe(t,e,n,r){if(Hh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function zwe(t,e,n){var r;tl(Qs,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());tl(Qs,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Ywe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Gwe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Kwe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function qwe(t){this.hot.runHooks("afterSheetAdded",t)}function Xwe(t,e){rt(at,this,mf).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Jwe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Zwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(EM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Qwe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(TM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Je(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return x(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function eve(t,e){EV(t,e),e.add(t)}function tve(t,e,n){EV(t,e),e.set(t,n)}function EV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kl(t,e){return t.get(_a(t,e))}function i1(t,e,n){return t.set(_a(t,e),n),n}function _a(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeHideColumns");se.getSingleton().register("afterHideColumns");se.getSingleton().register("beforeUnhideColumns");se.getSingleton().register("afterUnhideColumns");const o1="hiddenColumns",nve=310;var _o=new WeakMap,$l=new WeakSet;class rve extends nt{constructor(){super(...arguments),eve(this,$l),tve(this,_o,null)}static get PLUGIN_KEY(){return o1}static get PLUGIN_PRIORITY(){return nve}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[o1]}enablePlugin(){var e=this;this.enabled||(i1(_o,this,new cy),kl(_o,this).addLocalHook("init",()=>_a($l,this,uve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,kl(_o,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _a($l,e,lve).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>_a($l,this,ove).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>_a($l,this,ive).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _a($l,e,ave).call(e,...r)}),this.addHook("modifyCopyableRange",n=>_a($l,this,sve).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=kl(_o,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));x(l,u=>{o[u]=!1}),i=In(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&kl(_o,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{kl(_o,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Je(kl(_o,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return kl(_o,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){x(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){i1(_o,this,null),super.destroy()}}function ive(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function ove(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function sve(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return x(t,r=>{let i=!0,o=0;me(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function ave(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),X(e,n)}function lve(t){t.items.push({name:Be},Zwe(this),Qwe(this))}function uve(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function cve(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(MM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function hve(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(_M,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Je(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return x(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function dve(t,e){TV(t,e),e.add(t)}function fve(t,e,n){TV(t,e),e.set(t,n)}function TV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ll(t,e){return t.get(xa(t,e))}function s1(t,e,n){return t.set(xa(t,e),n),n}function xa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeHideRows");se.getSingleton().register("afterHideRows");se.getSingleton().register("beforeUnhideRows");se.getSingleton().register("afterUnhideRows");const a1="hiddenRows",gve=320;var xo=new WeakMap,Fl=new WeakSet;class mve extends nt{constructor(){super(...arguments),dve(this,Fl),fve(this,xo,null)}static get PLUGIN_KEY(){return a1}static get PLUGIN_PRIORITY(){return gve}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[a1]}enablePlugin(){var e=this;this.enabled||(s1(xo,this,new cy),Ll(xo,this).addLocalHook("init",()=>xa(Fl,this,bve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ll(xo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xa(Fl,e,Cve).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>xa(Fl,this,wve).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>xa(Fl,this,pve).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xa(Fl,e,yve).call(e,...r)}),this.addHook("modifyCopyableRange",n=>xa(Fl,this,vve).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Ll(xo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));x(l,u=>{o[u]=!1}),i=In(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Ll(xo,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{Ll(xo,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Je(Ll(xo,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ll(xo,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){x(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){s1(xo,this,null),super.destroy()}}function pve(t,e){return this.isHidden(e)?0:t}function wve(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function vve(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return x(t,r=>{let i=!0,o=0;me(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function yve(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),X(e,n)}function Cve(t){t.items.push({name:Be},cve(this),hve(this))}function bve(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Sve(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(eM)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Rve(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(tM)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Eve(t,e){MV(t,e),e.add(t)}function Tve(t,e,n){MV(t,e),e.set(t,n)}function MV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y0(t,e){return t.get(ov(t,e))}function gS(t,e,n){return t.set(ov(t,e),n),n}function ov(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeColumnFreeze");se.getSingleton().register("afterColumnFreeze");se.getSingleton().register("beforeColumnUnfreeze");se.getSingleton().register("afterColumnUnfreeze");const l1="manualColumnFreeze",Mve=110;var Zl=new WeakMap,mS=new WeakSet;class _ve extends nt{constructor(){super(...arguments),Eve(this,mS),Tve(this,Zl,!1)}static get PLUGIN_KEY(){return l1}static get PLUGIN_PRIORITY(){return Mve}isEnabled(){return!!this.hot.getSettings()[l1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>ov(mS,this,xve).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>ov(mS,this,Ive).call(this,e,n)),super.enablePlugin())}disablePlugin(){gS(Zl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;y0(Zl,this)||gS(Zl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;y0(Zl,this)||gS(Zl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function xve(t){t.items.push({name:"---------"},Sve(this),Rve(this))}function Ive(t,e){if(y0(Zl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function cp(t,e,n){return(e=Pve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pve(t){var e=Ove(t,"string");return typeof e=="symbol"?e:e+""}function Ove(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pS=0,u1=1,c1=2,vc="px";let _V=class{constructor(e){cp(this,"hot",void 0),cp(this,"_element",null),cp(this,"state",pS),cp(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=c1}build(){this.state===pS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=u1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=pS}isAppended(){return this.state===c1}isBuilt(){return this.state>=u1}setPosition(e,n){er(e)&&(this._element.style.top=e+vc),er(n)&&(this._element.style[this.inlineProperty]=n+vc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){er(e)&&(this._element.style.width=e+vc),er(n)&&(this._element.style.height=n+vc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){er(e)&&(this._element.style.marginTop=e+vc),er(n)&&(this._element.style[`margin${or(this.inlineProperty)}`]=n+vc)}getOffset(){const e=this._element.style,n=`margin${or(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Ave="ht__manualColumnMove--backlight";let Hve=class extends _V{build(){super.build(),X(this._element,Ave)}};const Nve="ht__manualColumnMove--guideline";let Dve=class extends _V{build(){super.build(),X(this._element,Nve)}};function kve(t,e){xV(t,e),e.add(t)}function Ui(t,e,n){xV(t,e),e.set(t,n)}function xV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fr(t,e,n){return t.set(Ia(t,e),n),n}function fe(t,e){return t.get(Ia(t,e))}function Ia(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeColumnMove");se.getSingleton().register("afterColumnMove");const wS="manualColumnMove",$ve=120,h1="ht__manualColumnMove",sv="show-ui",C0="on-moving--columns",b0="after-selection--columns";var pr=new WeakMap,Aa=new WeakMap,Us=new WeakMap,lw=new WeakMap,Wa=new WeakMap,mr=new WeakMap,hp=new WeakMap,vi=new WeakMap,Ac=new WeakMap,av=new WeakMap,pf=new WeakMap,Vl=new WeakSet;class Lve extends nt{constructor(){super(...arguments),kve(this,Vl),Ui(this,pr,new Hve(this.hot)),Ui(this,Aa,new Dve(this.hot)),Ui(this,Us,[]),Ui(this,lw,0),Ui(this,Wa,!1),Ui(this,mr,{}),Ui(this,hp,void 0),Ui(this,vi,void 0),Ui(this,Ac,void 0),Ui(this,av,void 0),Ui(this,pf,void 0)}static get PLUGIN_KEY(){return wS}static get PLUGIN_PRIORITY(){return $ve}isEnabled(){return!!this.hot.getSettings()[wS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ia(Vl,e,Fve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ia(Vl,e,Bve).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ia(Vl,this,jve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ia(Vl,e,Uve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,h1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ye(this.hot.rootElement,h1),this.unregisterEvents(),fe(pr,this).destroy(),fe(Aa,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=fe(hp,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Fr(hp,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Fr(hp,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=In(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[wS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return me(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(fe(vi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,fe(vi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=fe(pr,this).getOffset().start,u=fe(pr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,p=ln(this.hot.rootElement),C=g.innerWidth-fe(Ac,this)-p;h=g.innerWidth-fe(mr,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=fe(mr,this).eventPageX-(fe(Ac,this)-(r.scrollX===void 0?i:0));if(fe(av,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(fe(vi,this))&&(o+=i),o+=c,fe(vi,this)<0)fe(pf,this)>0?fe(mr,this).col=0:fe(mr,this).col=e>0?e-1:e;else if(fe(mr,this).TD.offsetWidth/2+o<=h){const g=fe(vi,this)>=fe(lw,this)?fe(lw,this)-1:fe(vi,this);fe(mr,this).col=g+1,o+=fe(mr,this).TD.offsetWidth}else fe(mr,this).col=fe(vi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&fe(vi,this)<fe(pf,this)&&(f-=fe(Ac,this)<=r.scrollX?fe(Ac,this):0),fe(pr,this).setPosition(null,d),fe(Aa,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ia(Vl,this,Vve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ia(Vl,this,Wve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){fe(pr,this).build(),fe(Aa,this).build()}destroy(){fe(pr,this).destroy(),fe(Aa,this).destroy(),super.destroy()}}function Fve(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=be(t.target,"sortAction");if(!s||!o||fe(Wa,this)||t.button!==0||a){Fr(Wa,this,!1),fe(Us,this).length=0,ye(this.hot.rootElement,[C0,sv]);return}const l=fe(Aa,this).isBuilt()&&!fe(Aa,this).isAppended(),u=fe(pr,this).isBuilt()&&!fe(pr,this).isAppended();l&&u&&(fe(Aa,this).appendTo(i.hider),fe(pr,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Fr(Wa,this,!0);const g=n.firstChild?b$(t,n.firstChild).x:t.offsetX;fe(mr,this).eventPageX=t.pageX,Fr(vi,this,e.col),fe(mr,this).TD=n,fe(mr,this).col=e.col,Fr(Us,this,this.prepareColumnsToMoving(d,f)),Fr(av,this,!!this.hot.getSettings().rowHeaders),Fr(lw,this,this.hot.countCols()),Fr(pf,this,this.hot.getSettings().fixedColumnsStart),Fr(Ac,this,zn(this.hot.rootElement).left);const p=fe(av,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<fe(pf,this),y=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),_=this.getColumnsWidth(d,e.col-1)+T,P=this.getColumnsWidth(p,d-1)+(E?y:0)+_;fe(pr,this).setPosition(C,P),fe(pr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),fe(pr,this).setOffset(null,-_),X(this.hot.rootElement,C0)}else ye(this.hot.rootElement,b0),Fr(Wa,this,!1),fe(Us,this).length=0}function Vve(t){fe(Wa,this)&&(fe(mr,this).eventPageX=t.pageX,this.refreshPositions())}function Bve(t,e,n,r){!this.hot.getSelectedRangeLast()||!fe(Wa,this)||(fe(Us,this).indexOf(e.col)>-1?ye(this.hot.rootElement,sv):X(this.hot.rootElement,sv),r.row=!0,r.column=!0,r.cell=!0,Fr(vi,this,e.col),fe(mr,this).TD=n)}function Wve(){const t=fe(mr,this).col,e=fe(Us,this).length;if(Fr(vi,this,void 0),Fr(Wa,this,!1),ye(this.hot.rootElement,[C0,sv,b0]),this.hot.selection.isSelectedByColumnHeader()&&X(this.hot.rootElement,b0),e<1||t===void 0)return;const n=fe(Us,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(fe(Us,this),t);if(fe(Us,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function jve(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;fe(pr,this).setPosition(r),fe(pr,this).setSize(null,t.hider.offsetHeight-r)}function Uve(){this.moveBySettingsOrLoad()}function zve(t,e){IV(t,e),e.add(t)}function qn(t,e,n){IV(t,e),e.set(t,n)}function IV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function an(t,e,n){return t.set(Zi(t,e),n),n}function ae(t,e){return t.get(Zi(t,e))}function Zi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lv="manualColumnResize",Yve=130,d1="manualColumnWidths";var Ns=new WeakMap,dp=new WeakMap,ei=new WeakMap,uv=new WeakMap,Go=new WeakMap,Gve=new WeakMap,Qc=new WeakMap,fp=new WeakMap,Pr=new WeakMap,Ps=new WeakMap,Ru=new WeakMap,cv=new WeakMap,wf=new WeakMap,vf=new WeakMap,ni=new WeakMap,yf=new WeakMap,Io=new WeakSet;class Kve extends nt{static get PLUGIN_KEY(){return lv}static get PLUGIN_PRIORITY(){return Yve}constructor(e){super(e),zve(this,Io),qn(this,Ns,null),qn(this,dp,null),qn(this,ei,[]),qn(this,uv,null),qn(this,Go,null),qn(this,Gve,null),qn(this,Qc,null),qn(this,fp,null),qn(this,Pr,this.hot.rootDocument.createElement("DIV")),qn(this,Ps,this.hot.rootDocument.createElement("DIV")),qn(this,Ru,null),qn(this,cv,!1),qn(this,wf,0),qn(this,vf,null),qn(this,ni,void 0),qn(this,yf,void 0),X(ae(Pr,this),"manualColumnResizer"),X(ae(Ps,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[lv]}enablePlugin(){var e=this;this.enabled||(an(ni,this,new il),ae(ni,this).addLocalHook("init",()=>Zi(Io,this,qve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ae(ni,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zi(Io,e,tye).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zi(Io,e,nye).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zi(Io,e,rye).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){an(yf,this,ae(ni,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",d1,ae(ni,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",d1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ae(ni,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ae(ni,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;an(Ns,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ae(Ns,this)),i=r.col;if(i<0)return;const o=mn(ae(Ns,this)),s=ae(Ns,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(Ns,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ae(Ns,this),r.row,r.col)),an(dp,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),an(ei,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();x(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;me(d,f,g=>{ae(ei,this).includes(g)||ae(ei,this).push(g)})})}ae(ei,this).includes(ae(dp,this))||an(ei,this,[ae(dp,this)]),an(fp,this,l.start-6),an(Qc,this,parseInt(s.width,10)),ae(Pr,this).style.top=`${l.top}px`,ae(Pr,this).style[this.inlineDir]=`${ae(fp,this)+ae(Qc,this)}px`,ae(Pr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ae(Pr,this))}refreshHandlePosition(){ae(Pr,this).style[this.inlineDir]=`${ae(fp,this)+ae(uv,this)}px`}setupGuidePosition(){const e=parseInt(mn(ae(Pr,this)),10),n=parseInt(ae(Pr,this).style.top,10)+e,r=this.hot.view.getTableHeight();X(ae(Pr,this),"active"),X(ae(Ps,this),"active"),ae(Ps,this).style.top=`${n}px`,this.refreshGuidePosition(),ae(Ps,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ae(Ps,this))}refreshGuidePosition(){ae(Ps,this).style[this.inlineDir]=ae(Pr,this).style[this.inlineDir]}hideHandleAndGuide(){ye(ae(Pr,this),"active"),ye(ae(Ps,this),"active")}checkIfColumnHeader(e){const n=Ja(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ae(Go,this),r,!0);o!==void 0&&an(Go,this,o),this.setManualSize(r,ae(Go,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(Go,this),r,!0),i&&e()};ae(wf,this)>=2&&(ae(ei,this).length>1?(x(ae(ei,this),i=>{n(i)}),e()):x(ae(ei,this),i=>{n(i,!0)})),an(wf,this,0),an(vf,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Zi(Io,this,Xve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Zi(Io,this,Jve).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Zi(Io,this,Zve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Zi(Io,this,Qve).call(this)),this.eventManager.addEventListener(ae(Pr,this),"contextmenu",()=>Zi(Io,this,eye).call(this))}destroy(){super.destroy()}}function qve(){const t=this.hot.getSettings()[lv],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ae(ni,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ae(ni,this).setValueAtIndex(r,n)})},!0),an(yf,this,t)):t===!0&&Array.isArray(ae(yf,this))&&this.hot.batchExecution(()=>{ae(yf,this).forEach((n,r)=>{ae(ni,this).setValueAtIndex(r,n)})},!0)}function Xve(t){if(!JE(t.target)&&ae(cv,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ae(Ru,this)||this.setupHandlePosition(e))}}function Jve(t){t.target.parentNode===this.hot.rootElement&&be(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ae(Ns,this)),this.setupGuidePosition(),an(Ru,this,!0),ae(vf,this)===null&&(an(vf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(vf,this))),an(wf,this,ae(wf,this)+1),this.startX=t.pageX,an(Go,this,ae(Qc,this)))}function Zve(t){if(ae(Ru,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();an(uv,this,ae(Qc,this)+e),x(ae(ei,this),n=>{an(Go,this,this.setManualSize(n,ae(uv,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Qve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ae(Go,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(Go,this),n,!1)};ae(Ru,this)&&(this.hideHandleAndGuide(),an(Ru,this,!1),ae(Go,this)!==ae(Qc,this)&&(ae(ei,this).length>1?(x(ae(ei,this),r=>{e(r)}),t()):x(ae(ei,this),r=>{e(r,!0)})),this.setupHandlePosition(ae(Ns,this)))}function eye(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(Pr,this)),this.hot.rootElement.removeChild(ae(Ps,this)),an(Ru,this,!1),an(cv,this,!0),this.hot._registerImmediate(()=>{an(cv,this,!1)})}function tye(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ae(ni,this).getValueAtIndex(r);this.hot.getSettings()[lv]&&i&&(n=i)}return n}function nye(t,e){const n=ae(ni,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function rye(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function vS(t,e,n){return(e=iye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iye(t){var e=oye(t,"string");return typeof e=="symbol"?e:e+""}function oye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yS=0,f1=1,g1=2,yc="px";let PV=class{constructor(e){vS(this,"hot",void 0),vS(this,"_element",null),vS(this,"state",yS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=g1}build(){this.state===yS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=f1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=yS}isAppended(){return this.state===g1}isBuilt(){return this.state>=f1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+yc),n!==void 0&&(this._element.style.left=n+yc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+yc),n&&(this._element.style.height=n+yc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+yc),n&&(this._element.style.marginLeft=n+yc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const sye="ht__manualRowMove--backlight";class aye extends PV{build(){super.build(),X(this._element,sye)}}const lye="ht__manualRowMove--guideline";class uye extends PV{build(){super.build(),X(this._element,lye)}}function cye(t,e){OV(t,e),e.add(t)}function Cc(t,e,n){OV(t,e),e.set(t,n)}function OV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lu(t,e,n){return t.set(Pa(t,e),n),n}function Pe(t,e){return t.get(Pa(t,e))}function Pa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeRowMove");se.getSingleton().register("afterRowMove");const CS="manualRowMove",hye=140,m1="ht__manualRowMove",hv="show-ui",S0="on-moving--rows",R0="after-selection--rows";var wr=new WeakMap,Ha=new WeakMap,zs=new WeakMap,ja=new WeakMap,Vr=new WeakMap,gp=new WeakMap,Bl=new WeakSet;class dye extends nt{constructor(){super(...arguments),cye(this,Bl),Cc(this,wr,new aye(this.hot)),Cc(this,Ha,new uye(this.hot)),Cc(this,zs,[]),Cc(this,ja,void 0),Cc(this,Vr,{}),Cc(this,gp,void 0)}static get PLUGIN_KEY(){return CS}static get PLUGIN_PRIORITY(){return hye}isEnabled(){return!!this.hot.getSettings()[CS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pa(Bl,e,fye).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pa(Bl,e,mye).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Pa(Bl,this,wye).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pa(Bl,e,vye).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,m1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ye(this.hot.rootElement,m1),this.unregisterEvents(),Pe(wr,this).destroy(),Pe(Ha,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Pe(gp,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(lu(gp,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return lu(gp,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=In(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[CS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return me(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Pe(Vr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Pe(Vr,this).TD,a=this.hot.rootElement,l=zn(a),u=sh(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Pe(Vr,this).eventPageY-d+c,g=o.hider.offsetHeight,p=o.TBODY.offsetTop,C=Pe(wr,this).getOffset().top,E=Pe(wr,this).getSize().height,y=s.offsetHeight/2,T=s.offsetHeight;let _=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=f>=_+y;this.isFixedRowTop(e.row)&&(_+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Pe(Vr,this).row=n>0?n-1:n:P?(Pe(Vr,this).row=e.row+1,_+=e.row===0?T-1:T):Pe(Vr,this).row=e.row;let M=f,I=_;f+E+C>=g?M=g-E-C:f+C<p&&(M=p+Math.abs(C)),_>=g-1&&(I=g-1),Pe(wr,this).setPosition(M),Pe(Ha,this).setPosition(I)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Pa(Bl,this,gye).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Pa(Bl,this,pye).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(wr,this).build(),Pe(Ha,this).build()}destroy(){Pe(wr,this).destroy(),Pe(Ha,this).destroy(),super.destroy()}}function fye(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Pe(ja,this)||t.button!==0){lu(ja,this,!1),Pe(zs,this).length=0,ye(this.hot.rootElement,[S0,hv]);return}const l=Pe(Ha,this).isBuilt()&&!Pe(Ha,this).isAppended(),u=Pe(wr,this).isBuilt()&&!Pe(wr,this).isAppended();l&&u&&(Pe(Ha,this).appendTo(i.hider),Pe(wr,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,lu(ja,this,!0),Pe(Vr,this).eventPageY=t.pageY,Pe(Vr,this).coords=e,Pe(Vr,this).TD=n,lu(zs,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),p=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Pe(wr,this).setPosition(null,g),Pe(wr,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Pe(wr,this).setOffset(-p,null),X(this.hot.rootElement,S0),this.refreshPositions()}else ye(this.hot.rootElement,R0),lu(ja,this,!1),Pe(zs,this).length=0}function gye(t){Pe(ja,this)&&(Pe(Vr,this).eventPageY=t.pageY,this.refreshPositions())}function mye(t,e,n,r){!this.hot.getSelectedRangeLast()||!Pe(ja,this)||(Pe(zs,this).indexOf(e.row)>-1?ye(this.hot.rootElement,hv):X(this.hot.rootElement,hv),r.row=!0,r.column=!0,r.cell=!0,Pe(Vr,this).coords=e,Pe(Vr,this).TD=n)}function pye(){const t=Pe(Vr,this).row,e=Pe(zs,this).length;if(lu(ja,this,!1),ye(this.hot.rootElement,[S0,hv,R0]),this.hot.selection.isSelectedByRowHeader()&&X(this.hot.rootElement,R0),e<1||t===void 0)return;const n=Pe(zs,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Pe(zs,this),t);if(Pe(zs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function wye(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Pe(wr,this).setPosition(null,r),Pe(wr,this).setSize(t.hider.offsetWidth-r)}function vye(){this.moveBySettingsOrLoad()}function yye(t,e){AV(t,e),e.add(t)}function Xn(t,e,n){AV(t,e),e.set(t,n)}function AV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(t,e,n){return t.set(Ds(t,e),n),n}function oe(t,e){return t.get(Ds(t,e))}function Ds(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dv="manualRowResize",Cye=30,p1="manualRowHeights";var Vo=new WeakMap,mp=new WeakMap,ti=new WeakMap,Cf=new WeakMap,Na=new WeakMap,Y_=new WeakMap,eh=new WeakMap,pp=new WeakMap,fr=new WeakMap,$o=new WeakMap,Eu=new WeakMap,fv=new WeakMap,bf=new WeakMap,Sf=new WeakMap,io=new WeakMap,Rf=new WeakMap,Ca=new WeakSet;class bye extends nt{static get PLUGIN_KEY(){return dv}static get PLUGIN_PRIORITY(){return Cye}constructor(e){super(e),yye(this,Ca),Xn(this,Vo,null),Xn(this,mp,null),Xn(this,ti,[]),Xn(this,Cf,null),Xn(this,Na,null),Xn(this,Y_,null),Xn(this,eh,null),Xn(this,pp,null),Xn(this,fr,this.hot.rootDocument.createElement("DIV")),Xn(this,$o,this.hot.rootDocument.createElement("DIV")),Xn(this,Eu,!1),Xn(this,fv,!1),Xn(this,bf,0),Xn(this,Sf,null),Xn(this,io,void 0),Xn(this,Rf,void 0),X(oe(fr,this),"manualRowResizer"),X(oe($o,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[dv]}enablePlugin(){this.enabled||(Xt(io,this,new il),oe(io,this).addLocalHook("init",()=>Ds(Ca,this,xye).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,oe(io,this)),this.addHook("modifyRowHeight",(e,n)=>Ds(Ca,this,_ye).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Xt(Rf,this,oe(io,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",p1,oe(io,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",p1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return oe(io,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return oe(Cf,this)}setupHandlePosition(e){Xt(Vo,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(oe(Vo,this)),o=i.row;if(o<0)return;const s=ln(oe(Vo,this)),a=oe(Vo,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(Vo,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(oe(Vo,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(oe(Vo,this),i.row,i.col)),Xt(mp,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Xt(ti,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();x(d,f=>{const g=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;me(g,p,C=>{oe(ti,this).includes(C)||oe(ti,this).push(C)})})}oe(ti,this).includes(oe(mp,this))||Xt(ti,this,[oe(mp,this)]),Xt(pp,this,c.top-6),Xt(eh,this,parseInt(a.height,10)),oe(fr,this).style.top=`${oe(pp,this)+oe(eh,this)}px`,oe(fr,this).style[this.inlineDir]=`${c.start}px`,oe(fr,this).style.width=`${s}px`,this.hot.rootElement.appendChild(oe(fr,this))}refreshHandlePosition(){oe(fr,this).style.top=`${oe(pp,this)+oe(Cf,this)}px`}setupGuidePosition(){const e=parseInt(ln(oe(fr,this)),10),n=parseInt(oe(fr,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();X(oe(fr,this),"active"),X(oe($o,this),"active"),oe($o,this).style.top=oe(fr,this).style.top,oe($o,this).style[this.inlineDir]=`${n}px`,oe($o,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(oe($o,this))}refreshGuidePosition(){oe($o,this).style.top=oe(fr,this).style.top}hideHandleAndGuide(){ye(oe(fr,this),"active"),ye(oe($o,this),"active")}checkIfRowHeader(e){const n=Ja(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&oe(Na,this)<n?n:oe(Na,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Xt(Na,this,o),this.setManualSize(r,oe(Na,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};oe(bf,this)>=2&&(oe(ti,this).length>1?(x(oe(ti,this),i=>{n(i)}),e()):x(oe(ti,this),i=>{n(i,!0)})),Xt(bf,this,0),Xt(Sf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ds(Ca,this,Sye).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ds(Ca,this,Rye).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Ds(Ca,this,Eye).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Ds(Ca,this,Tye).call(this)),this.eventManager.addEventListener(oe(fr,this),"contextmenu",()=>Ds(Ca,this,Mye).call(this))}destroy(){super.destroy()}}function Sye(t){if(!JE(t.target)&&oe(fv,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(oe(Eu,this)||this.setupHandlePosition(e))}}function Rye(t){be(t.target,"manualRowResizer")&&(this.setupHandlePosition(oe(Vo,this)),this.setupGuidePosition(),Xt(Eu,this,!0),oe(Sf,this)===null&&(Xt(Sf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(Sf,this))),Xt(bf,this,oe(bf,this)+1),Xt(Y_,this,t.pageY),Xt(Na,this,oe(eh,this)))}function Eye(t){oe(Eu,this)&&(Xt(Cf,this,oe(eh,this)+(t.pageY-oe(Y_,this))),x(oe(ti,this),e=>{Xt(Na,this,this.setManualSize(e,oe(Cf,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Tye(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};oe(Eu,this)&&(this.hideHandleAndGuide(),Xt(Eu,this,!1),oe(Na,this)!==oe(eh,this)&&(oe(ti,this).length>1?(x(oe(ti,this),r=>{e(r)}),t()):x(oe(ti,this),r=>{e(r,!0)})),this.setupHandlePosition(oe(Vo,this)))}function Mye(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(fr,this)),this.hot.rootElement.removeChild(oe($o,this)),Xt(Eu,this,!1),Xt(fv,this,!0),this.hot._registerImmediate(()=>{Xt(fv,this,!1)})}function _ye(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=oe(io,this).getValueAtIndex(r);this.hot.getSettings()[dv]&&i&&(n=i)}return n}function xye(){const t=this.hot.getSettings()[dv],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{oe(io,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{oe(io,this).setValueAtIndex(r,n)}),Xt(Rf,this,t)):t===!0&&Array.isArray(oe(Rf,this))&&oe(Rf,this).forEach((n,r)=>{oe(io,this).setValueAtIndex(r,n)})},!0)}var Iye=oy;Iye("flatMap");var Pye=Mn,w1=xn,Oye=ss,Aye=lE,Hye=function(t,e){(!e||typeof t!="string")&&w1(t);var n=Aye(t);return Oye(w1(n!==void 0?Pye(n,t):t))},Nye=Mt,E0=Mn,Dye=jr,T0=xn,kye=ss,$ye=Hye,Lye=gE,M0=li,Fye=rl,bS=Fye("flatMap",TypeError),Vye=Lye(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=T0(E0(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){M0(t,"throw",i)}if(n=T0(E0(this.next,t)),this.done=!!n.done)return;try{this.inner=$ye(e(n.value,this.counter++),!1)}catch(i){M0(t,"throw",i)}}});Nye({target:"Iterator",proto:!0,real:!0,forced:bS},{flatMap:function(e){T0(this);try{Dye(e)}catch(n){M0(this,"throw",n)}return bS?E0(bS,this,e):new Vye(kye(this),{mapper:e,inner:null})}});function Bye(t,e,n){Wye(t,e),e.set(t,n)}function Wye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wl(t,e,n){return(e=jye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jye(t){var e=Uye(t,"string");return typeof e=="symbol"?e:e+""}function Uye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v1(t,e){return t.get(HV(t,e))}function wp(t,e,n){return t.set(HV(t,e),n),n}function HV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jl=new WeakMap;class Bo{constructor(e,n,r,i,o,s){Wl(this,"row",void 0),Wl(this,"col",void 0),Wl(this,"rowspan",void 0),Wl(this,"colspan",void 0),Wl(this,"removed",!1),Wl(this,"cellCoordsFactory",void 0),Wl(this,"cellRangeFactory",void 0),Bye(this,jl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return wt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return wt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return wt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return wt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),wp(jl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,wp(jl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return wp(jl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return v1(jl,this)||wp(jl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),v1(jl,this)}}function zye(t,e){Yye(t,e),e.add(t)}function Yye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vp(t,e,n){return(e=Gye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gye(t){var e=Kye(t,"string");return typeof e=="symbol"?e:e+""}function Kye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ul(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ba=new WeakSet;class gv{constructor(e){zye(this,ba),vp(this,"plugin",void 0),vp(this,"mergedCells",[]),vp(this,"mergedCellsMatrix",new Map),vp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return wt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){ut(gv.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Bo(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Ul(ba,this,y1).call(this,a),a):(u&&ut(gv.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Ul(ba,this,qye).call(this,r),r):!1}clear(){x(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;me(n,n+i,s=>{me(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Qe(u,i,i+s-1),d=Qe(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Ul(ba,this,yp).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Ul(ba,this,yp).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Ul(ba,this,yp).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Ul(ba,this,yp).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Ul(ba,this,y1).call(this,s)})}}function yp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function y1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function qye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function SS(t,e,n){return(e=Xye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xye(t){var e=Jye(t,"string");return typeof e=="symbol"?e:e+""}function Jye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zye{constructor(e){SS(this,"plugin",void 0),SS(this,"mergedCellsCollection",void 0),SS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,p=this.getFarthestCollection(e,n,r,i);if(p){if(r==="down"){const C=p.row+p.rowspan-a-g;o[2]+C>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?C:0}else if(r==="right"){const C=p.col+p.colspan-l-g;o[3]+C>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?C:0}else if(r==="up"){const C=u-g-p.row+1;o[0]+C<0?o[0]+=g:o[0]-=g?C:0}else if(r==="left"){const C=c-g-p.col+1;o[1]+C<0?o[1]+=g:o[1]-=g?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),pn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,p=d-g;let C=null,E=null,y=null;switch(r){case"up":C="includesVertically",y=c-p+1;break;case"left":C="includesHorizontally",y=c-p+1;break;case"down":C="includesVertically",y=h+p-1;break;case"right":C="includesHorizontally",y=h+p-1;break}return x(i,T=>{T[C](y)&&T.isFarther(E,r)&&(E=T)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return x(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:p}=g;return p===h.getWidth()}):!f.every(g=>{let{rowspan:p}=g;return p===h.getHeight()})}}function RS(t,e,n){return(e=Qye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qye(t){var e=eCe(t,"string");return typeof e=="symbol"?e:e+""}function eCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tCe{constructor(e){RS(this,"plugin",void 0),RS(this,"hot",void 0),RS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function nCe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(rM)}return this.getTranslatedPhrase(nM)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Bo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Ef(t,e,n){return(e=rCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rCe(t){var e=iCe(t,"string");return typeof e=="symbol"?e:e+""}function iCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C1{constructor(e){Ef(this,"data",void 0),Ef(this,"next",null),Ef(this,"prev",null),this.data=e}}class Cp{constructor(){Ef(this,"first",null),Ef(this,"last",null)}push(e){const n=new C1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new C1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function oCe(t,e){NV(t,e),e.add(t)}function zl(t,e,n){NV(t,e),e.set(t,n)}function NV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ft(t,e){return t.get(mv(t,e))}function Gr(t,e,n){return t.set(mv(t,e),n),n}function mv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Po=new WeakMap,Oo=new WeakMap,Ao=new WeakMap,Ho=new WeakMap,_0=new WeakMap,bp=new WeakMap,Sp=new WeakMap,ES=new WeakSet;class sCe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;oCe(this,ES),zl(this,Po,new Cp),zl(this,Oo,new Cp),zl(this,Ao,null),zl(this,Ho,null),zl(this,_0,null),zl(this,bp,null),zl(this,Sp,null),Gr(_0,this,n),Gr(bp,this,r),Gr(Sp,this,i)}getCurrentVerticalNode(){return ft(Ho,this).data}getFirstVerticalNode(){return ft(Oo,this).first.data}getNextVerticalNode(){return ft(Ho,this).next.data}getPrevVerticalNode(){return ft(Ho,this).prev.data}getCurrentHorizontalNode(){return ft(Ao,this).data}getFirstHorizontalNode(){return ft(Po,this).first.data}getNextHorizontalNode(){return ft(Ao,this).next.data}getPrevHorizontalNode(){return ft(Ao,this).prev.data}setPrevNodeAsActive(){Gr(Ho,this,ft(Ho,this).prev),Gr(Ao,this,ft(Ao,this).prev)}setNextNodeAsActive(){Gr(Ho,this,ft(Ho,this).next),Gr(Ao,this,ft(Ao,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Gr(Po,this,new Cp);for(let s=n.row;s<=r.row;s++)if(!ft(bp,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(ft(Sp,this).isHidden(a))continue;const l=mv(ES,this,b1).call(this,e,ft(Po,this),i,s,a);l&&Gr(Ao,this,l)}ft(Po,this).first&&(ft(Po,this).first.prev=ft(Po,this).last,ft(Po,this).last.next=ft(Po,this).first);const o=new WeakSet;Gr(Oo,this,new Cp);for(let s=n.col;s<=r.col;s++)if(!ft(Sp,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(ft(bp,this).isHidden(a))continue;const l=mv(ES,this,b1).call(this,e,ft(Oo,this),o,a,s);l&&Gr(Ho,this,l)}ft(Oo,this).first&&(ft(Oo,this).first.prev=ft(Oo,this).last,ft(Oo,this).last.next=ft(Oo,this).first)}setActiveNode(e,n){return ft(Po,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Gr(Ao,this,r),!1}),ft(Oo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Gr(Ho,this,r),!1}),this}}function b1(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=ft(_0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function DV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function aCe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Le(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),jf()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[p,C]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if(jf()&&d===0&&!e.getSettings().rowHeaders){const V=DV(e,h,g);i.set(l,V/g)}const y=n.getRenderableFromVisualIndex(l),T=r.getRenderableFromVisualIndex(u),_=p-y+1,P=C-T+1;let M=n.getNearestNotHiddenIndex(h,1),I=r.getNearestNotHiddenIndex(d,1);if(E){const V=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(V)||(M=Math.max(M,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(V)||(I=Math.max(I,e.getFirstRenderedVisibleColumn()))}const z=Math.min(g,_),W=Math.min(f,P);M===l&&I===u?(a.setAttribute("rowspan",z),a.setAttribute("colspan",W)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function lCe(t,e){kV(t,e),e.add(t)}function Rp(t,e,n){kV(t,e),e.set(t,n)}function kV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TS(t,e,n){return(e=uCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uCe(t){var e=cCe(t,"string");return typeof e=="symbol"?e:e+""}function cCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ng(t,e,n){return t.set(vt(t,e),n),n}function Tt(t,e){return t.get(vt(t,e))}function vt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeMergeCells");se.getSingleton().register("afterMergeCells");se.getSingleton().register("beforeUnmergeCells");se.getSingleton().register("afterUnmergeCells");const x0="mergeCells",hCe=150,S1=x0;var Ti=new WeakMap,Mi=new WeakMap,Ko=new WeakMap,R1=new WeakMap,Rt=new WeakSet;class dCe extends nt{constructor(){super(...arguments),lCe(this,Rt),TS(this,"mergedCellsCollection",null),TS(this,"autofillCalculations",null),TS(this,"selectionCalculations",null),Rp(this,Ti,null),Rp(this,Mi,{row:0,col:0}),Rp(this,Ko,new sCe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Rp(this,R1,aCe(this))}static get PLUGIN_KEY(){return x0}static get PLUGIN_PRIORITY(){return hCe}static get DEFAULT_SETTINGS(){return{[nF]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[x0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new gv(this),this.autofillCalculations=new Zye(this),this.selectionCalculations=new tCe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,fCe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,mCe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,pCe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,wCe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,vCe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,T1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,T1).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,CCe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,bCe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,SCe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,E1).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,E1).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,gCe).call(e,...r)}),this.addHook("afterRenderer",function(){return Tt(R1,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,yCe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,RCe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,ECe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,TCe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,MCe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,_Ce).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,xCe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,ICe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,PCe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,OCe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,ACe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,HCe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,NCe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,DCe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vt(Rt,e,kCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!nT())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Vf(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Vf(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Bo.containsNegativeValues(e)?(ut(Bo.NEGATIVE_VALUES_WARNING(e)),!1):Bo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ut(Bo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Bo.isSingleCell(e)?(ut(Bo.IS_SINGLE_CELL(e)),!1):Bo.containsZeroSpan(e)?(ut(Bo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),me(0,s.rowspan-1,c=>{me(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),x(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),me(0,i.rowspan-1,o=>{me(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:S1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(S1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Le(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Le(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Le(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Le(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function fCe(){this.generateFromSettings(),this.hot.render()}function gCe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function mCe(t){Tt(Mi,this).row=t.row,Tt(Mi,this).col=t.col}function pCe(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;Tt(Ti,this)&&(i.getRenderableFromVisualIndex(Tt(Ti,this).row)!==null&&(n.row=Tt(Ti,this).row),r.getRenderableFromVisualIndex(Tt(Ti,this).col)!==null&&(n.col=Tt(Ti,this).col),ng(Ti,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function wCe(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function vCe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){ng(Ti,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);ng(Ti,this,e.clone()),n&&e.assign(n)}function E1(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),p=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Qe(g,u,h),Qe(p,c,d),Qe(this.hot.getLastRenderedVisibleRow(),u,h),Qe(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function yCe(t){t.items.push({name:"---------"},nCe(this))}function T1(){ng(Ti,this,null)}function CCe(){if(Tt(Ti,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=Tt(Ti,this).clone().normalize();Tt(Ko,this).setActiveNode(r.row,r.col),Tt(Mi,this).row>0||Tt(Mi,this).col>0?Tt(Ko,this).setPrevNodeAsActive():(n==="E-W"&&Tt(Mi,this).col<0||e==="S-N"&&Tt(Mi,this).row<0)&&Tt(Ko,this).setNextNodeAsActive()}function bCe(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(Tt(Mi,this).col<0){const{rowEnd:a,colEnd:l}=Tt(Ko,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(Tt(Mi,this).col>0){const{rowStart:a,colStart:l}=Tt(Ko,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(Tt(Mi,this).row<0){const{rowEnd:a,colEnd:l}=Tt(Ko,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(Tt(Mi,this).row>0){const{rowStart:a,colStart:l}=Tt(Ko,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}Tt(Ko,this).setActiveNode(t,e),ng(Mi,this,{row:0,col:0})}function SCe(){this.hot.getSelectedRangeLast().isHeader()||Tt(Ko,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function RCe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function ECe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function TCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function MCe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function _Ce(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function xCe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function ICe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function PCe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function OCe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function ACe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);x(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function HCe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function NCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function DCe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function kCe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,DV(this.hot,e,g))}),t}function $Ce(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:dF(u.type))(l,u,d)(c,h);if(g===es){const p=a+1;if(typeof e[p]<"u")return s(p)}return g}(0)}}const $V="sort";function LCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${$V}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function FCe(t){const e=t.className.split(" "),n=new RegExp(`^${$V}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function VCe(t,e,n){return(e=BCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BCe(t){var e=WCe(t,"string");return typeof e=="symbol"?e:e+""}function WCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pv="multiColumnSorting",jCe=170,M1=pv;hF(pv,$Ce);class UCe extends bF{constructor(){super(...arguments),VCe(this,"pluginKey",pv)}static get PLUGIN_KEY(){return pv}static get PLUGIN_PRIORITY(){return jCe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Jw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:ol,position:"before",group:M1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(M1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),ye(e,FCe(e)),this.enabled!==!1&&X(e,LCe(...r))}onAfterOnCellMouseDown(e,n){A_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Jw))):this.sort(this.getColumnNextConfig(n.col)))}}function _1(t,e,n){return(e=zCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zCe(t){var e=YCe(t,"string");return typeof e=="symbol"?e:e+""}function YCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const GCe="multipleSelectionHandles",KCe=160;class qCe extends nt{constructor(){super(...arguments),_1(this,"dragged",[]),_1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return GCe}static get PLUGIN_PRIORITY(){return KCe}isEnabled(){return Jo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(be(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(be(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(be(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(be(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function I0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function LV(){return{label:"",isPlaceholder:!0}}function XCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;x(t,i=>{const o=[];let s=0;n.push(o),x(i,a=>{const l=I0();if(Le(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=At(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=At(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(LV());return!u})});const r=Math.max(...Je(n,i=>i.length));return x(n,i=>{if(i.length<r){const o=Je(new Array(r-i.length),()=>I0());i.splice(i.length,0,...o)}}),n}function MS(t,e,n){JCe(t,e),e.set(t,n)}function JCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zi(t,e){return t.get(FV(t,e))}function kd(t,e,n){return t.set(FV(t,e),n),n}function FV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const x1=["label","collapsible"];var Ts=new WeakMap,Yl=new WeakMap,_S=new WeakMap;class ZCe{constructor(){MS(this,Ts,[]),MS(this,Yl,0),MS(this,_S,1/0)}setColumnsLimit(e){kd(_S,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];kd(Ts,this,XCe(e,zi(_S,this))),kd(Yl,this,zi(Ts,this).length)}getData(){return zi(Ts,this)}mergeWith(e){x(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&pn(s,o,x1)})}map(e){x(zi(Ts,this),n=>{x(n,r=>{const i=e({...r});Le(i)&&pn(r,i,x1)})})}getHeaderSettings(e,n){var r;if(e>=zi(Yl,this)||e<0)return null;const i=zi(Ts,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=zi(Yl,this)||e<0)return i;const o=zi(Ts,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return zi(Yl,this)}getColumnsCount(){return zi(Yl,this)>0?zi(Ts,this)[0].length:0}clear(){kd(Ts,this,[]),kd(Yl,this,0)}}function xS(t,e,n){return(e=QCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QCe(t){var e=ebe(t,"string");return typeof e=="symbol"?e:e+""}function ebe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const VV="DF-pre-order";function BV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=BV.call(this.childs[r],t,e)}return n}const tbe="DF-post-order";function WV(t,e){for(let n=0;n<this.childs.length;n++)if(WV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const jV="BF";function nbe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const rbe=jV,I1=new Map([[VV,BV],[tbe,WV],[jV,nbe]]);class wv{constructor(e){xS(this,"data",{}),xS(this,"parent",null),xS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new wv({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rbe;if(!I1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);I1.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function IS(t,e,n){ibe(t,e),e.set(t,n)}function ibe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(t,e){return t.get(UV(t,e))}function obe(t,e,n){return t.set(UV(t,e),n),n}function UV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bc=new WeakMap,Gl=new WeakMap,Sc=new WeakMap;class sbe{constructor(e){IS(this,bc,new Map),IS(this,Gl,new Map),IS(this,Sc,null),obe(Sc,this,e)}getRoots(){return Array.from(hr(bc,this).values())}getRootByColumn(e){let n;return hr(Gl,this).has(e)&&(n=hr(bc,this).get(hr(Gl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-hr(Gl,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;hr(Gl,this).clear(),x(hr(bc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)hr(Gl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=hr(Sc,this).getColumnsCount();let n=0;for(;n<e;){const r=hr(Sc,this).getHeaderSettings(0,n),i=new wv;hr(bc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=hr(Sc,this).getHeadersSettings(r,n,i);r+=1,x(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new wv(a),e.addChild(l)),r<hr(Sc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){hr(bc,this).clear(),hr(Gl,this).clear()}}function zV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function vv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function yv(t){return vv(t,"origColspan")===t.data.origColspan}function G_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(yv(t))return G_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)x(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,zV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):yv(a)&&(l.isCollapsed=vv(a,"isCollapsed"))}),{rollbackModification:()=>K_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function K_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(yv(t))return K_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)x(o,l=>{zV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=vv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):yv(l)&&(u.isCollapsed=vv(l,"isCollapsed"))}),{rollbackModification:()=>G_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function abe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(wt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function lbe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(wt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const P1=new Map([["collapse",K_],["expand",G_],["hide-column",abe],["show-column",lbe]]);function ube(t,e,n){if(!P1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return P1.get(t)(e,n)}function Ep(t){const e=[];return x(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=hbe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(LV());else{const f=cbe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function cbe(t){const{crossHiddenColumns:e,...n}=I0(t);return n}function hbe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function PS(t,e,n){dbe(t,e),e.set(t,n)}function dbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $d(t,e,n){return t.set(YV(t,e),n),n}function Gt(t,e){return t.get(YV(t,e))}function YV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var No=new WeakMap,Ir=new WeakMap,Kl=new WeakMap;class fbe{constructor(){PS(this,No,new ZCe),PS(this,Ir,new sbe(Gt(No,this))),PS(this,Kl,[[]])}setState(e){Gt(No,this).setData(e);let n=!1;try{Gt(Ir,this).buildTree()}catch{Gt(Ir,this).clear(),Gt(No,this).clear(),n=!0}return $d(Kl,this,Ep(Gt(Ir,this).getRoots())),n}setColumnsLimit(e){Gt(No,this).setColumnsLimit(e)}mergeStateWith(e){const n=Je(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Gt(No,this).mergeWith(n),Gt(Ir,this).buildTree(),$d(Kl,this,Ep(Gt(Ir,this).getRoots()))}mapState(e){Gt(No,this).map(e),Gt(Ir,this).buildTree(),$d(Kl,this,Ep(Gt(Ir,this).getRoots()))}mapNodes(e){return In(Gt(Ir,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Gt(Ir,this).getNode(n,r);let o;return i&&(o=ube(e,i,r),$d(Kl,this,Ep(Gt(Ir,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Gt(Kl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Gt(Ir,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Gt(Ir,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},VV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Gt(No,this).getLayersCount()}getColumnsCount(){return Gt(No,this).getColumnsCount()}clear(){$d(Kl,this,[]),Gt(No,this).clear(),Gt(Ir,this).clear()}}function Ld(t,e,n){return(e=gbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gbe(t){var e=mbe(t,"string");return typeof e=="symbol"?e:e+""}function mbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pbe{constructor(e,n){Ld(this,"hot",void 0),Ld(this,"nestedHeaderSettingsGetter",void 0),Ld(this,"layersCount",0),Ld(this,"container",void 0),Ld(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),$u(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function wbe(t,e){GV(t,e),e.add(t)}function O1(t,e,n){return(e=vbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vbe(t){var e=ybe(t,"string");return typeof e=="symbol"?e:e+""}function ybe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fd(t,e,n){GV(t,e),e.set(t,n)}function GV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ys(t,e,n){return t.set(Kt(t,e),n),n}function Xe(t,e){return t.get(Kt(t,e))}function Kt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const A1="nestedHeaders",Cbe=280;var Ct=new WeakMap,Sa=new WeakMap,Tf=new WeakMap,Dy=new WeakMap,Cv=new WeakMap,nn=new WeakSet;class bbe extends nt{constructor(){super(...arguments),wbe(this,nn),Fd(this,Ct,new fbe),Fd(this,Sa,null),Fd(this,Tf,null),Fd(this,Dy,!1),Fd(this,Cv,null),O1(this,"ghostTable",new pbe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),O1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return A1}static get PLUGIN_PRIORITY(){return Cbe}isEnabled(){return!!this.hot.getSettings()[A1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&ut(wt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Kt(nn,this,$be).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Lbe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Tbe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Mbe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,_be).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,xbe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Ibe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Pbe).call(e,...i)}),this.addHook("afterSelection",()=>Kt(nn,this,Tp).call(this)),this.addHook("afterSelectionFocusSet",()=>Kt(nn,this,Tp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Sbe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Kt(nn,this,Abe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Nbe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Dbe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Rbe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Ebe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Obe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,Hbe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Kt(nn,e,kbe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Kt(nn,this,Tp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Kt(nn,this,Tp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Xe(Ct,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Xe(Ct,this).setState(e)),this.detectedOverlappedHeaders&&ut(wt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Xe(Ct,this).triggerColumnModification(i,r)}),!Xe(Sa,this)&&this.enabled&&Ys(Sa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";Xe(Ct,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Xe(Ct,this).clear(),Xe(Sa,this).unsubscribe(),Ys(Sa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Xe(Ct,this)}getLayersCount(){return Xe(Ct,this).getLayersCount()}getHeaderSettings(e,n){return Xe(Ct,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),ye(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),ye(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ye(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),ye(o,"hiddenHeader"),ye(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Xe(Ct,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)X(o,"hiddenHeader");else if(c>1){var g,p,C;const{wtOverlays:E}=l._wt,y=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),T=(p=E.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o);((C=E.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&u<r&&X(o,"hiddenHeaderText");const P=y||T?Math.min(c,r-i):c;P>1&&o.setAttribute("colspan",P)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(ye(E,this.hot.getColumnMeta(u).headerClassName),X(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=Xe(Ct,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Ys(Ct,this,null),Xe(Sa,this)!==null&&(Xe(Sa,this).unsubscribe(),Ys(Sa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Xe(Ct,this).getHeaderTreeNodeData(e.row,e.col)}}function Tp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=Xe(Ct,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Sbe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=Xe(Cv,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(Ys(Cv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Xe(Ct,this).findLeftMostColumnIndex(a,l),g=Xe(Ct,this).findRightMostColumnIndex(a,l),p=g-f+1;if(f<c&&g>h)return f;if(s){let C=null;return f>=c&&g>h?p>d?(e.value="start",C=f):(e.value="end",C=g):f<c&&g<=h&&(p>d?(e.value="end",C=g):(e.value="start",C=f)),C}return f<=c?f:g}function Rbe(t,e,n){const r=Xe(Ct,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Xe(Ct,this).getHeaderSettings(e,t);if(o===CT){if(!a)return r.columnIndex}else if(o===G$&&(l>s-i||!a))return null;return t}function Ebe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,p=d-a;if(p===0)continue;((i=Xe(Ct,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][p]="")}}}function Tbe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Mbe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Ys(Tf,this,e.clone()),Ys(Dy,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(iy(t)||Qa(t)&&l||C$(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function _be(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Qe(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function xbe(){Ys(Dy,this,!1)}function Ibe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Xe(Dy,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=Xe(Ct,this).getHeaderTreeNodeData(Xe(Tf,this).row,Xe(Tf,this).col);if(e.setHighlight(Xe(Tf,this)),o>e.getWidth()||i<n||i+o-1>r){const s=Xe(Ct,this).findTopMostEntireHeaderLevel(Qe(n,i,i+o-1),Qe(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Pbe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Xe(Ct,this).findLeftMostColumnIndex(n.row,n.col),o=Xe(Ct,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Obe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Ys(Cv,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function Abe(t){if(Xe(Ct,this).getLayersCount()>0){t.length=0;for(let e=0;e<Xe(Ct,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function Hbe(t){const e=Xe(Ct,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=Xe(Ct,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),er(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?Xe(Ct,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Nbe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Dbe(t,e,n){var r;const{label:i}=(r=Xe(Ct,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function kbe(t,e){if(t<0)return this.hot.getCell(t,Xe(Ct,this).findLeftMostColumnIndex(t,e),!0)}function $be(){this.updatePlugin()}function Lbe(t,e){e||this.updatePlugin()}function Vd(t,e,n){return(e=Fbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fbe(t){var e=Vbe(t,"string");return typeof e=="symbol"?e:e+""}function Vbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bbe{constructor(e,n){Vd(this,"hot",void 0),Vd(this,"data",null),Vd(this,"plugin",void 0),Vd(this,"parentReference",new WeakMap),Vd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&x(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&x(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Fe(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(x(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(me(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),me(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];x(r,o=>{i.push(this.getDataObject(o))}),x(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function H1(t,e,n){return(e=Wbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wbe(t){var e=jbe(t,"string");return typeof e=="symbol"?e:e+""}function jbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q_{constructor(e,n){H1(this,"hot",void 0),H1(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Uo extends q_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(x(l,c=>{c&&s.removeChild(c)}),X(n,Uo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",me(0,i-1,()=>{const d=c.createElement("SPAN");X(d,Uo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ee(c,[Du()]),X(n,Uo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(X(c,`${Uo.CSS_CLASSES.button} ${Uo.CSS_CLASSES.expandButton}`),u&&Ee(n,[_i(!1)])):(X(c,`${Uo.CSS_CLASSES.button} ${Uo.CSS_CLASSES.collapseButton}`),u&&Ee(n,[_i(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class Ube extends q_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),x(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{me(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&x(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];x(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return x(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);x(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return x(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);x(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&x(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];x(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];x(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];x(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{x(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{x(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&x(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);be(e.target,Uo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),ki(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function zbe(t,e,n){Ybe(t,e),e.set(t,n)}function Ybe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gbe(t,e,n){return(e=Kbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kbe(t){var e=qbe(t,"string");return typeof e=="symbol"?e:e+""}function qbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xbe(t,e){return t.get(Jbe(t,e))}function Jbe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var N1=new WeakMap;class Zbe extends q_{constructor(){super(...arguments),Gbe(this,"dataManager",this.plugin.dataManager),zbe(this,N1,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(SM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(RM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,r=>{if(r===0)return x(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return me(0,e.items.length-1,n=>{const r=Xbe(N1,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function Mp(t,e,n){return(e=Qbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qbe(t){var e=eSe(t,"string");return typeof e=="symbol"?e:e+""}function eSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tSe{constructor(e){Mp(this,"plugin",void 0),Mp(this,"hot",void 0),Mp(this,"dataManager",void 0),Mp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(p,a),p}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Vt(i)&&(ut(wt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function nSe(t,e){KV(t,e),e.add(t)}function D1(t,e,n){KV(t,e),e.set(t,n)}function KV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OS(t,e,n){return(e=rSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rSe(t){var e=iSe(t,"string");return typeof e=="symbol"?e:e+""}function iSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uw(t,e){return t.get(An(t,e))}function bv(t,e,n){return t.set(An(t,e),n),n}function An(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sv="nestedRows",oSe=300,k1=Sv,sSe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var ky=new WeakMap,Rc=new WeakMap,$n=new WeakSet;class aSe extends nt{constructor(){super(...arguments),nSe(this,$n),OS(this,"dataManager",null),OS(this,"headersUI",null),OS(this,"collapsedRowsMap",null),D1(this,ky,!1),D1(this,Rc,!1)}static get PLUGIN_KEY(){return Sv}static get PLUGIN_PRIORITY(){return oSe}isEnabled(){return!!this.hot.getSettings()[Sv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Og),this.dataManager=new Bbe(this,this.hot),this.collapsingUI=new Ube(this,this.hot),this.headersUI=new Uo(this,this.hot),this.contextMenuUI=new Zbe(this,this.hot),this.rowMoveController=new tSe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,bSe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,SSe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,cSe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,hSe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,dSe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,uSe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,mSe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,gSe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,pSe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,wSe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,vSe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,ySe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,fSe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,CSe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An($n,e,lSe).call(e,...r)}),this.addHook("beforeLoadData",n=>An($n,this,$1).call(this,n)),this.addHook("beforeUpdateData",n=>An($n,this,$1).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:k1,relativeToGroup:ol,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(k1)}disableCoreAPIModifiers(){bv(Rc,this,!0)}enableCoreAPIModifiers(){bv(Rc,this,!1)}onModifyRowData(e){if(!uw(Rc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!uw(Rc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return uw(Rc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function lSe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function uSe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function cSe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),bv(ky,this,!0),this.dataManager.getData().slice()}function hSe(t){return this.contextMenuUI.appendOptions(t)}function dSe(t,e){this.headersUI.appendLevelIndicators(t,e)}function fSe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function gSe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{bv(ky,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function mSe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function pSe(){this.collapsingUI.collapsedRowsStash.stash()}function wSe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function vSe(){this.collapsingUI.collapsedRowsStash.stash()}function ySe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function CSe(){this.dataManager.rewriteCache()}function bSe(){this.headersUI.updateRowHeaderWidth()}function SSe(t,e){uw(ky,this)&&(e.skipRender=!0)}function $1(t){if(!iL(t)){sT(sSe),this.hot.getSettings()[Sv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function AS(t,e,n){return(e=RSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RSe(t){var e=ESe(t,"string");return typeof e=="symbol"?e:e+""}function ESe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TSe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;AS(this,"rootWindow",void 0),AS(this,"prefix",void 0),AS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){x(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function MSe(t,e,n){return(e=_Se(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Se(t){var e=xSe(t,"string");return typeof e=="symbol"?e:e+""}function xSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}se.getSingleton().register("persistentStateSave");se.getSingleton().register("persistentStateLoad");se.getSingleton().register("persistentStateReset");const L1="persistentState",ISe=0;class PSe extends nt{constructor(){super(...arguments),MSe(this,"storage",void 0)}static get PLUGIN_KEY(){return L1}static get PLUGIN_PRIORITY(){return ISe}isEnabled(){return!!this.hot.getSettings()[L1]}enablePlugin(){this.enabled||(this.storage||(this.storage=new TSe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function OSe(t,e){ASe(t,e),e.add(t)}function ASe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HS(t,e,n){return(e=HSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HSe(t){var e=NSe(t,"string");return typeof e=="symbol"?e:e+""}function NSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function F1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const NS="search",DSe=190,kSe="htSearchResult",$Se=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},LSe=function(t,e,n){return Vt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Vt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var DS=new WeakSet;class FSe extends nt{constructor(){super(...arguments),OSe(this,DS),HS(this,"callback",$Se),HS(this,"queryMethod",LSe),HS(this,"searchResultClass",kSe)}static get PLUGIN_KEY(){return NS}static get PLUGIN_PRIORITY(){return DSe}isEnabled(){return this.hot.getSettings()[NS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[NS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return F1(DS,e,V1).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return F1(DS,e,V1).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return me(0,i-1,l=>{me(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const p={row:l,col:u,data:c};s.push(p)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Le(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function V1(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function _p(t,e,n){return(e=VSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VSe(t){var e=BSe(t,"string");return typeof e=="symbol"?e:e+""}function BSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qV{constructor(e){_p(this,"viewportWidth",void 0),_p(this,"overwriteColumnWidthFn",void 0),_p(this,"baseWidths",new Map),_p(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class WSe extends qV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=lh?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=lh){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,p=g;o.includes(f)||(p=Math.round(g*l)),this.stretchedWidths.set(f,p),u=f,d<i.length-1&&(c+=p)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function B1(t,e,n){jSe(t,e),e.set(t,n)}function jSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kS(t,e){return t.get(XV(t,e))}function xp(t,e,n){return t.set(XV(t,e),n),n}function XV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ip=new WeakMap,Bd=new WeakMap;class USe extends qV{constructor(){super(...arguments),B1(this,Ip,0),B1(this,Bd,-1)}prepare(e){super.prepare(e),xp(Ip,this,0),xp(Bd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),xp(Bd,this,e),xp(Ip,this,n)}calculate(){if(kS(Bd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+kS(Ip,this),0);this.stretchedWidths.set(kS(Bd,this),n)}}function zSe(t,e){JV(t,e),e.add(t)}function Pp(t,e,n){JV(t,e),e.set(t,n)}function JV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(t,e){return t.get(Wc(t,e))}function $S(t,e,n){return t.set(Wc(t,e),n),n}function Wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const YSe="stretchColumns";var Qn=new WeakMap,Ec=new WeakMap,LS=new WeakMap,Op=new WeakMap,Wd=new WeakSet;class GSe{constructor(e){zSe(this,Wd),Pp(this,Qn,void 0),Pp(this,Ec,void 0),Pp(this,LS,new Map([["all",new WSe(Wc(Wd,this,W1).bind(this))],["last",new USe(Wc(Wd,this,W1).bind(this))]])),Pp(this,Op,"none"),$S(Qn,this,e),$S(Ec,this,rn(Qn,this).columnIndexMapper.createAndRegisterIndexMap(YSe,"physicalIndexToValue"))}useStrategy(e){$S(Op,this,rn(LS,this).has(e)?e:"none")}refreshStretching(){if(rn(Op,this)==="none"){rn(Ec,this).clear();return}rn(Qn,this).batchExecution(()=>{rn(Ec,this).clear();const e=rn(LS,this).get(rn(Op,this));let r=rn(Qn,this).view.getViewportWidth();Wc(Wd,this,KSe).call(this)&&(r-=Nn(rn(Qn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<rn(Qn,this).countCols();i++)rn(Qn,this).columnIndexMapper.isHidden(rn(Qn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Wc(Wd,this,qSe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;rn(Ec,this).setValueAtIndex(rn(Qn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return rn(Ec,this).getValueAtIndex(rn(Qn,this).toPhysicalColumn(e))}}function KSe(){const{view:t}=rn(Qn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=rn(Qn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=rn(Qn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function qSe(t){var e;return(e=rn(Qn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:lh}function W1(t,e){return rn(Qn,this).runHooks("beforeStretchingColumnWidth",t,e)}function XSe(t,e){ZV(t,e),e.add(t)}function FS(t,e,n){ZV(t,e),e.set(t,n)}function ZV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VS(t,e,n){return t.set(Rv(t,e),n),n}function Os(t,e){return t.get(Rv(t,e))}function Rv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JSe="stretchColumns",ZSe=155;var Hc=new WeakMap,Ap=new WeakMap,jd=new WeakMap,BS=new WeakSet;class QSe extends nt{constructor(){super(...arguments),XSe(this,BS),FS(this,Hc,new GSe(this.hot)),FS(this,Ap,null),FS(this,jd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Os(Ap,this)!==null&&Os(Ap,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),VS(Ap,this,i.width)})})}))}static get PLUGIN_KEY(){return JSe}static get PLUGIN_PRIORITY(){return ZSe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Os(Hc,this).useStrategy(this.hot.getSettings().stretchH),Os(jd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rv(BS,e,tRe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rv(BS,e,eRe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Os(Hc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Os(jd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Os(Hc,this).getStretchedWidth(e)}destroy(){Os(jd,this).disconnect(),VS(jd,this,null),VS(Hc,this,null),super.destroy()}}function eRe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function tRe(t){t&&Os(Hc,this).refreshStretching()}function nRe(t,e){rRe(t,e),e.add(t)}function rRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hp(t,e,n){return(e=iRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iRe(t){var e=oRe(t,"string");return typeof e=="symbol"?e:e+""}function oRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sRe="touchScroll",aRe=200;var Np=new WeakSet;class lRe extends nt{constructor(){super(...arguments),nRe(this,Np),Hp(this,"scrollbars",[]),Hp(this,"clones",[]),Hp(this,"lockedCollection",!1),Hp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return sRe}static get PLUGIN_PRIORITY(){return aRe}static get SETTING_KEYS(){return!0}isEnabled(){return tT()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>WS(Np,this,uRe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>WS(Np,this,cRe).call(this)),this.addHook("afterMomentumScroll",()=>WS(Np,this,hRe).call(this))}}function uRe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function cRe(){this.freezeOverlays=!0,x(this.clones,t=>{X(t,"hide-tween")})}function hRe(){this.freezeOverlays=!1,x(this.clones,t=>{ye(t,"hide-tween"),X(t,"show-tween")}),this.hot._registerTimeout(()=>{x(this.clones,t=>{ye(t,"show-tween")})},400),x(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function dRe(t,e){fRe(t,e),e.add(t)}function fRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gRe(t,e,n){return(e=mRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mRe(t){var e=pRe(t,"string");return typeof e=="symbol"?e:e+""}function pRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wRe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cw="trimRows",vRe=330;var j1=new WeakSet;class yRe extends nt{constructor(){super(...arguments),dRe(this,j1),gRe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return cw}static get PLUGIN_PRIORITY(){return vRe}isEnabled(){return!!this.hot.getSettings()[cw]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Og),this.trimmedRowsMap.addLocalHook("init",()=>wRe(j1,this,CRe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[cw];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),x(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(x(e,l=>{o[l]=!1}),i=In(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function CRe(){const t=this.hot.getSettings()[cw];Array.isArray(t)&&this.hot.batchExecution(()=>{x(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function bRe(t,e,n){return(e=SRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SRe(t){var e=RRe(t,"string");return typeof e=="symbol"?e:e+""}function RRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $i{constructor(e){bRe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Dp(t,e,n){return(e=ERe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ERe(t){var e=TRe(t,"string");return typeof e=="symbol"?e:e+""}function TRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X_ extends $i{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Dp(this,"stateBefore",void 0),Dp(this,"range",void 0),Dp(this,"type",void 0),Dp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new X_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){x(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Ta(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function U1(t,e,n){return(e=MRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MRe(t){var e=_Re(t,"string");return typeof e=="symbol"?e:e+""}function _Re(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J_ extends $i{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),U1(this,"columns",void 0),U1(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new J_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),z_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function z1(t,e,n){return(e=xRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xRe(t){var e=IRe(t,"string");return typeof e=="symbol"?e:e+""}function IRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z_ extends $i{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),z1(this,"previousSortState",void 0),z1(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new Z_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function Y1(t,e,n){return(e=PRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PRe(t){var e=ORe(t,"string");return typeof e=="symbol"?e:e+""}function ORe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q_ extends $i{constructor(e){let{index:n,amount:r}=e;super("insert_col"),Y1(this,"index",void 0),Y1(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new Q_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function G1(t,e,n){return(e=ARe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ARe(t){var e=HRe(t,"string");return typeof e=="symbol"?e:e+""}function HRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ex extends $i{constructor(e){let{index:n,amount:r}=e;super("insert_row"),G1(this,"index",void 0),G1(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new ex({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function kp(t,e,n){return(e=NRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NRe(t){var e=DRe(t,"string");return typeof e=="symbol"?e:e+""}function DRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tx extends $i{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),kp(this,"changes",void 0),kp(this,"selected",void 0),kp(this,"countCols",void 0),kp(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new tx({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=sr(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=sr(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function K1(t,e,n){return(e=kRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kRe(t){var e=$Re(t,"string");return typeof e=="symbol"?e:e+""}function $Re(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nx extends $i{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),K1(this,"conditionsStack",void 0),K1(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new nx({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function LRe(t,e,n){return(e=FRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FRe(t){var e=VRe(t,"string");return typeof e=="symbol"?e:e+""}function VRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rx extends $i{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),LRe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new rx({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function QV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return me(r,i,l=>{me(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Ms(t,e,n){return(e=BRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BRe(t){var e=WRe(t,"string");return typeof e=="symbol"?e:e+""}function WRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ix extends $i{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Ms(this,"index",void 0),Ms(this,"indexes",void 0),Ms(this,"data",void 0),Ms(this,"amount",void 0),Ms(this,"headers",void 0),Ms(this,"columnPositions",void 0),Ms(this,"rowPositions",void 0),Ms(this,"fixedColumnsStart",void 0),Ms(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return me(l.length-1,g=>{const p=[],C=l[g];me(u,c,E=>{p.push(C[e.toPhysicalColumn(E)])}),h.push(p)}),me(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&me(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new ix({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:QV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Je(this.data[c],o));const l=Je(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),x(e.getSourceDataArray(),(c,h)=>{x(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&x(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Tc(t,e,n){return(e=jRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jRe(t){var e=URe(t,"string");return typeof e=="symbol"?e:e+""}function URe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ox extends $i{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Tc(this,"index",void 0),Tc(this,"data",void 0),Tc(this,"fixedRowsBottom",void 0),Tc(this,"fixedRowsTop",void 0),Tc(this,"rowIndexesSequence",void 0),Tc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=sr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new ox({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:QV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function q1(t,e,n){return(e=zRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zRe(t){var e=YRe(t,"string");return typeof e=="symbol"?e:e+""}function YRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sx extends $i{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),q1(this,"rows",void 0),q1(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new sx({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),z_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function GRe(t,e,n){return(e=KRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KRe(t){var e=qRe(t,"string");return typeof e=="symbol"?e:e+""}function qRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ax extends $i{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),GRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new ax({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function XRe(t,e){[X_,J_,Z_,Q_,ex,tx,nx,rx,ix,ox,sx,ax].forEach(n=>n.startRegisteringEvents(t,e))}function JRe(t,e){ZRe(t,e),e.add(t)}function ZRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jS(t,e,n){return(e=QRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QRe(t){var e=e0e(t,"string");return typeof e=="symbol"?e:e+""}function e0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function US(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const X1="undoRedo",t0e="undoRedo",n0e=1e3;se.getSingleton().register("beforeUndo");se.getSingleton().register("afterUndo");se.getSingleton().register("beforeRedo");se.getSingleton().register("afterRedo");const J1=new Set;var $p=new WeakSet;class r0e extends nt{static get PLUGIN_KEY(){return t0e}static get PLUGIN_PRIORITY(){return n0e}static get SETTING_KEYS(){return!0}constructor(e){super(e),JRe(this,$p),jS(this,"doneActions",[]),jS(this,"undoneActions",[]),jS(this,"ignoreNewActions",!1),XRe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return US($p,e,i0e).call(e,...r)}),this.registerShortcuts(),US($p,this,o0e).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),US($p,this,s0e).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:X1};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(X1)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=sr(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=sr(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function i0e(t,e){e==="loadData"&&this.clear()}function o0e(){const t=e=>{J1.has(e)||(ut(wt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),J1.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function s0e(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function a0e(){tt(cf),tt(fce),tt(hf),tt(Uce),tt(Zce),tt(bF),tt(Ghe),tt(Ode),tt(Iy),tt(Vfe),tt(dge),tt(Cge),tt(Ay),tt(nme),tt(Jpe),tt(Pwe),tt(rve),tt(mve),tt(_ve),tt(Lve),tt(Kve),tt(dye),tt(bye),tt(dCe),tt(UCe),tt(qCe),tt(bbe),tt(aSe),tt(PSe),tt(FSe),tt(QSe),tt(lRe),tt(yRe),tt(r0e)}function l0e(){$ae(),sue(),mue(),Due(),a0e()}function u0e(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var zS,YS,GS,KS,qS;l0e();u0e(_e);_e.__GhostTable=I_;_e._getListenersCounter=LZ;_e._getRegisteredMapsCounter=iie;_e.EventManager=Pi;const c0e=[V8,KJ,$re,lue,zJ,xJ,U8,kQ,UJ,Y8,JJ,DQ],h0e=[EJ,ZJ];_e.helper={};_e.dom={};x(c0e,t=>{x(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(_e.helper[e]=t[e])})});x(h0e,t=>{x(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(_e.dom[e]=t[e])})});_e.cellTypes=(zS=_e.cellTypes)!==null&&zS!==void 0?zS:{};x(uoe(),t=>{_e.cellTypes[t]=l_(t)});_e.cellTypes.registerCellType=wi;_e.cellTypes.getCellType=l_;_e.editors=(YS=_e.editors)!==null&&YS!==void 0?YS:{};x(AZ(),t=>{_e.editors[`${or(t)}Editor`]=Fw(t)});_e.editors.registerEditor=Nr;_e.editors.getEditor=Fw;_e.renderers=(GS=_e.renderers)!==null&&GS!==void 0?GS:{};x(JQ(),t=>{const e=Vw(t);t==="base"&&(_e.renderers.cellDecorator=e),_e.renderers[`${or(t)}Renderer`]=e});_e.renderers.registerRenderer=Xr;_e.renderers.getRenderer=Vw;_e.validators=(KS=_e.validators)!==null&&KS!==void 0?KS:{};x(eee(),t=>{_e.validators[`${or(t)}Validator`]=fT(t)});_e.validators.registerValidator=tu;_e.validators.getValidator=fT;_e.plugins=(qS=_e.plugins)!==null&&qS!==void 0?qS:{};x(dT(),t=>{_e.plugins[t]=_g(t)});_e.plugins[`${or(nt.PLUGIN_KEY)}Plugin`]=nt;_e.plugins.registerPlugin=tt;_e.plugins.getPlugin=_g;function Qi(t){if(typeof t!="object"||t===null)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){if(console.warn("JSON.stringify를 사용한 deepClone 실패, 수동 클론 시도:",e),Array.isArray(t))return t.map(r=>Qi(r));const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=Qi(t[r]));return n}}let Mf=null,Ut=new Map,Nc={row:-1,col:-1,time:0};function _s(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return t===void 0?(o="undefined",s.readOnly=!1):typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function dr(t,e,n){let r=[],i=!0,o=new Map;const s={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback},a=n.dataPathString||"";if(Array.isArray(t)){const l=t.length>0?t[0]:null;if(l&&typeof l=="object"&&l!==null&&!Array.isArray(l)){let u=Object.keys(l);if(u.length===0){for(let c=1;c<t.length;c++)if(t[c]&&typeof t[c]=="object"&&Object.keys(t[c]).length>0){u=Object.keys(t[c]);break}}i=u.length>0?u:t.length>0?["(내용 없음)"]:["새 열"],t.forEach((c,h)=>{const d=[],f=typeof c=="object"&&c!==null?c:{};i.forEach((g,p)=>{const C=f[g],E=`${a}[${h}]`,{displayValue:y,cellMeta:T}=_s(C,E,g,!1,s);d.push(y),o.set(`${h}-${p}`,T)}),r.push(d)})}else i=["Index","Value"],r=t.map((u,c)=>{const h=a,{displayValue:d,cellMeta:f}=_s(c,h,String(c),!0,s),{displayValue:g,cellMeta:p}=_s(u,h,String(c),!1,s);return o.set(`${c}-0`,f),o.set(`${c}-1`,p),[d,g]})}else if(typeof t=="object"&&t!==null){const l=Object.keys(t);if(l.length>0&&l.every(c=>Array.isArray(t[c]))){let c=0;l.forEach(d=>{c=Math.max(c,t[d].length)});const h=["항목 (Key)"];for(let d=0;d<c;d++)h.push(String(d));i=h,r=l.map((d,f)=>{const g=t[d],p=[],C=a,{displayValue:E,cellMeta:y}=_s(d,C,d,!0,s);p.push(E),o.set(`${f}-0`,y);for(let T=0;T<c;T++)if(T<g.length){const _=g[T],P=`${a?a+".":""}${d}`,{displayValue:M,cellMeta:I}=_s(_,P,String(T),!1,s);p.push(M),o.set(`${f}-${1+T}`,I)}else p.push(""),o.set(`${f}-${1+T}`,{readOnly:!0,originalValue:null,isPadding:!0});return p})}else i=["항목 (Key)","값 (Value)"],r=l.map((c,h)=>{const d=t[c],f=a,{displayValue:g,cellMeta:p}=_s(c,f,c,!0,s),{displayValue:C,cellMeta:E}=_s(d,f,c,!1,s);return o.set(`${h}-0`,p),o.set(`${h}-1`,E),[g,C]})}else{i=["항목","값"];const l=e||(t==null?String(t):"Value"),u=a,{displayValue:c,cellMeta:h}=_s(l,u,"",!0,s),{displayValue:d,cellMeta:f}=_s(t,u,"",!1,s);o.set("0-0",h),o.set("0-1",f),r=[[c,d]]}return{preparedHotData:r,preparedColHeaders:i,preparedCellMetaMap:o}}function eB(){return Mf&&(Mf.destroy(),Mf=null),Ut.clear(),Nc={row:-1,col:-1,time:0},null}function d0e(t,e,n){const r=n.tableViewDomElement;eB(),r&&(r.innerHTML="");const{preparedHotData:i,preparedColHeaders:o,preparedCellMetaMap:s}=dr(t,e,n);return Ut=s,r?(Mf=new _e(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{view_key_content:{name:"내용 보기 (View Content)",hidden:function(){const l=this.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row;if(u.col!==0||typeof t!="object"||t===null||Array.isArray(t))return!0;const d=Object.keys(t);if(c>=d.length)return!0;const f=d[c],g=t[f];return!(typeof g=="object"&&g!==null)},callback:function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start){console.error("View Content callback: 유효하지 않은 selection 객체입니다.",l);return}const h=l[0].start.row,d=Object.keys(t);if(h>=d.length){console.error("View Content callback: 행 인덱스가 범위를 벗어났습니다.",h,d);return}const f=d[h],g=t[f];if(typeof g!="object"||g===null){Ce({title:"오류",text:"내용을 볼 수 있는 대상(객체/배열)이 아닙니다.",icon:"error",showCancelButton:!1,hotInstance:u});return}const p=n.dataPathString||"",C=p?`${p}.${f}`:f;n.displayTableCallback(g,f,n.rootJsonData,C)}},row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입",hidden:function(){const a=this,l=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(c=>Array.isArray(t[c])),u=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(l){const c=a.getSelectedRangeLast();return!c||c.from.col===0}return!u},callback:async function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start)return;const c=l[0].start.col,h=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(f=>Array.isArray(t[f])),d=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(h){if(c===0){Ce({title:"알림",text:"'항목 (Key)' 열 왼쪽에는 열을 추가할 수 없습니다.",icon:"info",hotInstance:u});return}const f=c-1;let g=!1;if(Object.keys(t).forEach(p=>{Array.isArray(t[p])&&f>=0&&f<=t[p].length&&(t[p].splice(f,0,null),g=!0)}),g){n.refreshTreeViewCallback("col_inserted_expanded_array_view");const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=dr(t,e,n);Ut=E,u.updateSettings({colHeaders:C}),u.loadData(p)}}else d?u.alter("insert_col_start",c,1,"custom_insert_col_left_array_of_objects"):Ce({title:"작업 불가",text:"현재 데이터 보기 방식에서는 이 열 삽입 작업을 지원하지 않습니다.",icon:"error",hotInstance:u})}},col_right:{name:"오른쪽에 열 삽입",hidden:function(){const a=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(u=>Array.isArray(t[u])),l=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);return!(a||l)},callback:async function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start)return;const c=l[0].start.col,h=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(f=>Array.isArray(t[f])),d=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(h){const f=c===0?0:c;let g=!1;if(Object.keys(t).forEach(p=>{Array.isArray(t[p])&&(t[p].splice(f,0,null),g=!0)}),g){n.refreshTreeViewCallback("col_inserted_expanded_array_view");const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=dr(t,e,n);Ut=E,u.updateSettings({colHeaders:C}),u.loadData(p)}}else d?u.alter("insert_col_start",c+1,1,"custom_insert_col_right_array_of_objects"):Ce({title:"작업 불가",text:"현재 데이터 보기 방식에서는 이 열 삽입 작업을 지원하지 않습니다.",icon:"error",hotInstance:u})}},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const u=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(h=>Array.isArray(t[h])),c=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(u){if(l.from.col===0)return!0;const h=Object.keys(t).find(d=>Array.isArray(t[d]));return!!(h&&t[h]&&l.from.col>t[h].length)}if(c){const h=a.getColHeader();return!(Array.isArray(h)&&h.length>0&&l.from.col<h.length)}return!0},callback:async function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start)return;const c=l[0].start.col,h=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(f=>Array.isArray(t[f])),d=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(h){if(c===0){Ce({title:"오류",text:"'항목 (Key)' 열은 삭제할 수 없습니다.",icon:"error",hotInstance:u});return}const f=c-1;let g=!1;if(Object.keys(t).forEach(p=>{Array.isArray(t[p])&&f>=0&&f<t[p].length&&(t[p].splice(f,1),g=!0)}),g){n.refreshTreeViewCallback("col_removed_expanded_array_view");const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=dr(t,e,n);Ut=E,u.updateSettings({colHeaders:C}),u.loadData(p)}}else d?u.alter("remove_col",c,1,"custom_remove_col_array_of_objects"):Ce({title:"작업 불가",text:"현재 데이터 보기 방식에서는 이 열 삭제 작업을 지원하지 않습니다.",icon:"error",hotInstance:u})}},duplicate_row:{name:"선택 행 복제",hidden:function(){return!this.getSelectedRangeLast()||!(Array.isArray(t)||typeof t=="object"&&t!==null&&!Array.isArray(t))},callback:async function(a,l){const u=this,c=l[0].start.row;if(Array.isArray(t)){if(c>=0&&c<t.length){const h=Qi(t[c]);t.splice(c+1,0,h),n.refreshTreeViewCallback("row_duplicated_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=dr(t,e,n);Ut=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}else if(typeof t=="object"&&t!==null){const h=Object.keys(t);if(c<0||c>=h.length)return;const d=h[c];let f=d+"_복제본",g=f,p=1;for(;t.hasOwnProperty(g);)g=`${f}_${p++}`;const C=await to({title:"새 키 입력 (행 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:E=>{const y=E.trim();return y?y!==d&&t.hasOwnProperty(y)?"이미 사용 중인 키입니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u});if(C.isConfirmed&&C.value!==void 0){const E=C.value.trim(),y=Qi(t[d]),T={};for(const I of Object.keys(t))T[I]=t[I],I===d&&(T[E]=y);Object.keys(t).forEach(I=>delete t[I]),Object.assign(t,T),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered");const{preparedHotData:_,preparedColHeaders:P,preparedCellMetaMap:M}=dr(t,e,n);Ut=M,u.updateSettings({colHeaders:P}),u.loadData(_)}}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return!this.getSelectedRangeLast()||!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]))},callback:async function(a,l){const u=this,c=l[0].start.col,h=u.getColHeader();if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])&&Array.isArray(h)&&c>=0&&c<h.length){const d=h[c];if(typeof d!="string")return;let f=d+"_복제본",g=f,p=1;for(;t[0].hasOwnProperty(g);)g=`${f}_${p++}`;const C=await to({title:"새 열 키 입력 (열 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:E=>{const y=E.trim();return y?t.length>0&&t[0].hasOwnProperty(y)&&y!==d?"첫 번째 객체에 이미 해당 키가 존재합니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u});if(C.isConfirmed&&C.value!==void 0){const E=C.value.trim();t.forEach(P=>{if(typeof P=="object"&&P!==null){const M=P.hasOwnProperty(d)?Qi(P[d]):null,I={};let z=!1;for(const W in P)P.hasOwnProperty(W)&&(I[W]=P[W],W===d&&(I[E]=M,z=!0));z||(I[E]=M),Object.keys(P).forEach(W=>delete P[W]),Object.assign(P,I)}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered");const{preparedHotData:y,preparedColHeaders:T,preparedCellMetaMap:_}=dr(t,e,n);Ut=_,u.updateSettings({colHeaders:T}),u.loadData(y)}}}},"---------":_e.plugins.ContextMenu.SEPARATOR,set_template:{name:"템플릿으로 채우기",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=Ut.get(`${c}-${h}`);if(d&&d.isPadding)return!0;const f=a.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Ut};return Ud(c,h,g)===null},callback:async function(a,l){const u=this;u&&typeof u.deselectCell=="function"&&u.deselectCell();const c=n.getTemplates();if(!c||c.length===0){Ce({title:"알림",text:"사용 가능한 템플릿이 없습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}const h={};c.forEach((P,M)=>{h[`tpl_idx_${M}`]=P.name});const{value:d}=await ri.fire({title:"템플릿 선택",input:"select",inputOptions:h,inputPlaceholder:"적용할 템플릿을 선택하세요",showCancelButton:!0,confirmButtonText:"다음",cancelButtonText:"취소",customClass:{popup:"custom-swal-popup"}});if(!d){Ce({title:"취소됨",text:"템플릿 선택이 취소되었습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}const f=parseInt(d.replace("tpl_idx_",""),10),g=c[f],p=g.value,C=await ri.fire({title:"템플릿 적용 방식",text:`"${g.name}" 템플릿을 선택한 셀에 어떻게 적용하시겠습니까?`,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"완전 덮어쓰기",denyButtonText:"병합 (규칙 적용)",cancelButtonText:"취소",icon:"question",customClass:{popup:"custom-swal-popup"}});let E=null;if(C.isConfirmed)E="overwrite";else if(C.isDenied)E="merge";else{Ce({title:"취소됨",text:"템플릿 적용 방식 선택이 취소되었습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}const y=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;let T=!1;const _=u.getColHeader();for(const P of l){const M=P.start,I=P.end;if(!M||!I){console.warn("Skipping invalid range object in selection:",P);continue}const z=Math.min(M.row,I.row),W=Math.max(M.row,I.row),V=Math.min(M.col,I.col),q=Math.max(M.col,I.col);for(let Z=z;Z<=W;Z++)for(let ee=V;ee<=q;ee++){const te={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(_)?_:_===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Ut},he=Ud(Z,ee,te);if(he===null)continue;const Ue=n.getObjectByPathCallback(y,he);let ve;if(E==="overwrite")ve=Qi(p);else{const He=typeof Ue=="object"&&Ue!==null&&!Array.isArray(Ue),st=typeof p=="object"&&p!==null&&!Array.isArray(p);if(He&&st){ve={};const Cn=Object.keys(p);for(const ze of Cn)Object.prototype.hasOwnProperty.call(p,ze)&&(Object.prototype.hasOwnProperty.call(Ue,ze)?ve[ze]=Qi(Ue[ze]):ve[ze]=Qi(p[ze]))}else ve=Qi(p)}n.updateJsonDataCallback(he,JSON.stringify(ve),!0),T=!0}}if(T){let P=t;n.dataPathString?P=n.getObjectByPathCallback(y,n.dataPathString):P=y,P===void 0&&(P={});const{preparedHotData:M,preparedColHeaders:I,preparedCellMetaMap:z}=dr(P,e,n);Ut=z,u.updateSettings({colHeaders:I}),u.loadData(M),n.refreshTreeViewCallback("template_applied_batch"),Ce({title:"완료",text:"선택한 셀에 템플릿이 적용되었습니다.",icon:"success",showCancelButton:!1,hotInstance:u})}else Ce({title:"알림",text:"템플릿을 적용할 유효한 셀이 없거나 변경사항이 없습니다.",icon:"info",showCancelButton:!1,hotInstance:u})}},add_as_template:{name:"선택 셀 값을 템플릿에 추가",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=a.getColHeader(),f={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(d)?d:d===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Ut},g=Ud(c,h,f);if(g===null)return!0;const p=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,C=n.getObjectByPathCallback(p,g);return!(typeof C=="object"&&C!==null)},callback:async function(a,l){const u=this,c=l[0].start,h=c.row,d=c.col,f=u.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Ut},p=Ud(h,d,g);if(p===null)return;const C=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,E=n.getObjectByPathCallback(C,p);if(!(typeof E=="object"&&E!==null)){Ce({title:"알림",text:"객체 또는 배열 형식의 값만 템플릿으로 추가할 수 있습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}u&&typeof u.deselectCell=="function"&&u.deselectCell();const{value:y}=await to({title:"새 템플릿 이름 입력 (셀 값)",inputLabel:"저장할 템플릿의 이름을 입력하세요:",inputValue:"",confirmButtonText:"추가",inputValidator:T=>{const _=T.trim();return _?n.getTemplates().some(P=>P.name===_)?"이미 사용중인 템플릿 이름입니다.":null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:u});if(y&&y.trim()){const T=Array.isArray(E)?"array":"object",_=Qi(E),P=n.addTemplate(y.trim(),T,_);Ce(P===!0?{title:"성공",text:`템플릿 "${y.trim()}"이(가) 추가되었습니다.`,icon:"success",showCancelButton:!1,hotInstance:u}:P==="duplicate_name"?{title:"오류",text:`템플릿 이름 "${y.trim()}"이(가) 이미 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:u}:{title:"오류",text:"템플릿 추가에 실패했습니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},add_current_view_as_template:{name:"현재 테이블 뷰를 템플릿에 추가",hidden:function(){return!(typeof t=="object"&&t!==null)},callback:async function(){const a=this;if(a&&typeof a.deselectCell=="function"&&a.deselectCell(),!(typeof t=="object"&&t!==null)){Ce({title:"알림",text:"템플릿으로 추가할 수 있는 데이터(객체/배열)가 아닙니다.",icon:"info",showCancelButton:!1,hotInstance:a});return}const{value:l}=await to({title:"새 템플릿 이름 입력 (현재 뷰)",inputLabel:"저장할 템플릿의 이름을 입력하세요:",inputValue:e?`${e}_view_template`:"current_view_template",confirmButtonText:"추가",inputValidator:u=>{const c=u.trim();return c?n.getTemplates().some(h=>h.name===c)?"이미 사용중인 템플릿 이름입니다.":null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:a});if(l&&l.trim()){const u=Array.isArray(t)?"array":"object",c=Qi(t),h=n.addTemplate(l.trim(),u,c);Ce(h===!0?{title:"성공",text:`템플릿 "${l.trim()}"이(가) 현재 뷰를 기반으로 추가되었습니다.`,icon:"success",showCancelButton:!1,hotInstance:a}:h==="duplicate_name"?{title:"오류",text:`템플릿 이름 "${l.trim()}"이(가) 이미 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:a}:{title:"오류",text:"템플릿 추가에 실패했습니다.",icon:"error",showCancelButton:!1,hotInstance:a})}}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(a,l,u){const c={},h=Ut.get(`${a}-${l}`);return h&&(c.readOnly=h.readOnly,h.isDrillable&&(c.renderer=function(d,f,g,p,C,E){_e.renderers.TextRenderer.apply(this,arguments),f.style.color="#007bff",f.style.textDecoration="underline",f.style.cursor="pointer"})),c},afterOnCellMouseDown:function(a,l,u){if(a.button!==0)return;const c=new Date().getTime(),{row:h,col:d}=l,f=Ut.get(`${h}-${d}`),g=300;let p=!1;if(f&&h===Nc.row&&d===Nc.col&&c-Nc.time<g?(p=!0,Nc={row:-1,col:-1,time:0}):Nc={row:h,col:d,time:c},p){let C=!1;const E=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(E)&&E.length>0&&E[0]==="항목 (Key)"&&d===0&&f&&(C=!0),C){const y=f.originalKey,T=t,_=n.dataPathString;to({title:`키 이름 변경: "${y}"`,inputValue:y,confirmButtonText:"저장",inputValidator:P=>{const M=P.trim();return M?T.hasOwnProperty(M)&&M!==y?"이미 사용 중인 키입니다!":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:this}).then(P=>{if(P.isConfirmed&&P.value!==void 0){const M=P.value.trim();M!==y&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(_,y,M,T)}});return}}if(f&&f.isDrillable&&f.originalValue!==void 0){const C=typeof t=="object"&&t!==null&&!Array.isArray(t)&&d===0&&f&&f.isDrillable;(!p||p&&!C&&f.drillPath)&&typeof f.originalValue=="object"&&f.originalValue!==null&&n.displayTableCallback(f.originalValue,f.originalKey,n.rootJsonData,f.drillPath)}},afterChange:function(a,l){if(l==="loadData"||!a||!Array.isArray(a)||a.length===0)return;const u=l==="CopyPaste.paste"||l==="Autofill.fill"||a.length>1,c=this.getColHeader();a.forEach(([h,d,f,g])=>{let p=-1;if(typeof d=="number"?p=d:typeof d=="string"&&Array.isArray(c)&&(p=c.indexOf(d)),p===-1)if(typeof d=="number"&&c===!0)p=d;else{console.warn("afterChange: 컬럼 인덱스 결정 불가:",h,d,c);return}const C={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(c)?c:c===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Ut};let E=Ud(h,p,C);E!==null&&n.updateJsonDataCallback(E,String(g),u,f)}),u&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_update_handsontable_afterChange")},afterCreateRow:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)){const f=c.getColHeader();for(let g=0;g<l;g++){let p=null;Array.isArray(f)&&f.length>0&&(f.length!==2||f[0]!=="Index"||f[1]!=="Value")&&(p={},f.forEach(C=>{typeof C=="string"&&(p[C]=null)})),h.splice(a+g,0,p)}d=!0,d&&n.refreshTreeViewCallback("row_added_array_hot")}else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){(async()=>{let f={...h},g=0;for(let y=0;y<l;y++){const T=a+y,_=await to({title:`새 항목 키 입력 (${y+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:P=>{const M=P.trim();return M?f.hasOwnProperty(M)?"이미 사용 중인 키입니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(_.isConfirmed&&_.value!==void 0){const P=_.value.trim(),M=null,I=Object.keys(f),z={};let W=!1;for(let V=0;V<I.length;V++)V===T&&!W&&(z[P]=M,W=!0),z[I[V]]=f[I[V]];W||(z[P]=M),f=z,g++}else break}g>0&&(Object.keys(h).forEach(y=>delete h[y]),Object.assign(h,f),d=!0,n.refreshTreeViewCallback("key_added_object_hot_ordered"));const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=dr(h,e,n);Ut=E,c.updateSettings({colHeaders:C}),c.loadData(p)})();return}if(d||u!=="loadData"){const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=dr(h,e,n);Ut=p,c.updateSettings({colHeaders:g}),c.loadData(f)}},afterCreateCol:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){(async()=>{for(let C=0;C<l;C++){const E=a+C,y=await to({title:`새 열(속성)의 키 입력 (${C+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:T=>{const _=T.trim();return _?h[0].hasOwnProperty(_)?"첫 번째 객체에 이미 해당 키가 존재합니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(y.isConfirmed&&y.value!==void 0){const T=y.value.trim();h.forEach(_=>{if(typeof _=="object"&&_!==null){const P=Object.keys(_),M={};let I=!1;if(E>=P.length)_[T]=null;else{for(let z=0;z<P.length;z++)z===E&&!I&&(M[T]=null,I=!0),M[P[z]]=_[P[z]];I||(M[T]=null),Object.keys(_).forEach(z=>delete _[z]),Object.assign(_,M)}}}),d=!0}else break}d&&n.refreshTreeViewCallback("col_added_array_of_obj_hot_ordered");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=dr(h,e,n);Ut=p,c.updateSettings({colHeaders:g}),c.loadData(f)})();return}else if(typeof h=="object"&&h!==null&&!Array.isArray(h))Ce({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c}).then(()=>{const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=dr(h,e,n);Ut=p,c.updateSettings({colHeaders:g}),c.loadData(f)});else{Ce({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c});const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=dr(h,e,n);Ut=p,c.updateSettings({colHeaders:g}),c.loadData(f)}},beforeRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;if(u.sort((d,f)=>f-d),Array.isArray(h))u.forEach(d=>{d>=0&&d<h.length&&h.splice(d,1)});else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=Object.keys(h),f=u.map(g=>d[g]).filter(g=>g!==void 0);f.length>0&&f.forEach(g=>{delete h[g]})}else return!1;return!0},afterRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef||c==="ContextMenu.remove_row_custom")return;const h=this;let d=t;n.refreshTreeViewCallback("row_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=dr(d,e,n);Ut=p,h.updateSettings({colHeaders:g}),h.loadData(f)},beforeRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;const d=this.getColHeader();if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){if(!Array.isArray(d))return Ce({title:"오류",text:"열 헤더 정보를 가져올 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1;u.sort((f,g)=>g-f),u.forEach(f=>{if(f>=0&&f<d.length){const g=d[f];typeof g=="string"&&h.forEach(p=>{typeof p=="object"&&p!==null&&delete p[g]})}})}else return typeof h=="object"&&h!==null&&!Array.isArray(h)?(Ce({title:"오류",text:"이 뷰에서 특정 열 부분 삭제는 지원되지 않습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1):(Ce({title:"오류",text:"현재 데이터 구조에서는 열을 삭제할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1);return!0},afterRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return;const h=this;let d=t;n.refreshTreeViewCallback("col_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=dr(d,e,n);Ut=p,h.updateSettings({colHeaders:g}),h.loadData(f)}}),Mf):(console.error("Handsontable 컨테이너를 찾을 수 없습니다."),null)}function Ud(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a,cellMetaMap:l}=n;let u="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const c=o[e];u=`[${t}].${c}`}else return null;else if(e===1)u=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){const c=l.get(`${t}-0`);if(!c||c.originalKey===void 0)return null;const h=c.originalKey;if(e===0)return null;const d=Array.isArray(o)&&o.length>1&&o[0]==="항목 (Key)"&&!isNaN(parseInt(o[1],10)),f=Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)";if(d)if(e>0&&e<o.length){const g=o[e],p=r[h];if(Array.isArray(p)){const C=l.get(`${t}-${e}`);if(C&&C.isPadding)return null;u=`.${h}[${g}]`}else return null}else return null;else if(f)if(e===1)u=`.${h}`;else return null;else return Object.keys(r).length===0&&Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)",null}else return t===0&&e===1?i||"":null;return i?u.startsWith(".")||u.startsWith("[")?i+u:u?i+"."+u:i:u.startsWith(".")?u.substring(1):u}let eo=[],so=-1;const f0e=30;let lx=!1;function g0e(){eo=[],so=-1,lx=!1}function m0e(t){if(lx)return;const{dataPathString:e,dataKeyName:n}=t,r=eo[so];r&&r.dataPathString===e&&r.dataKeyName===n||(so<eo.length-1&&(eo=eo.slice(0,so+1)),eo.push({dataPathString:e,dataKeyName:n}),so=eo.length-1,eo.length>f0e&&(eo.shift(),so--))}function p0e(t){let e=!1,n=so;return t==="back"&&so>0?(n--,e=!0):t==="forward"&&so<eo.length-1&&(n++,e=!0),e?(so=n,eo[so]):null}function Z1(t){lx=t}function w0e(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function v0e(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=w0e(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function Q1(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}const tB="userJsonEditorTemplates_v1";let gn=[];const qo=[{name:"Null 값 (Null Value)",type:"null",value:null,isDefault:!0},{name:"빈 객체 (Empty Object)",type:"object",value:{},isDefault:!0},{name:"빈 배열 (Empty Array)",type:"array",value:[],isDefault:!0}];function ux(){try{const t=localStorage.getItem(tB);if(t){const e=JSON.parse(t);if(Array.isArray(e)){const n=e.filter(s=>!s.isDefault),r=new Set(qo.map(s=>s.name)),i=[],o=new Set;n.forEach(s=>{!r.has(s.name)&&!o.has(s.name)&&(i.push({...s,isDefault:!1}),o.add(s.name))}),gn=[...qo,...i]}else gn=[...qo]}else gn=[...qo]}catch(t){console.error("Error loading templates from localStorage:",t),gn=[...qo]}return Wg(),gn}function nB(){return gn.length===0&&ux(),[...gn]}function y0e(t,e,n){if(!t||!e||n===void 0)return!1;const r=t.trim();if(gn.some(o=>o.name===r))return"duplicate_name";if(qo.some(o=>o.name===r))return"default_conflict";const i={name:r,type:e,value:JSON.parse(JSON.stringify(n)),isDefault:!1};return gn.push(i),Wg(),!0}function Wg(){try{const t=gn.map(e=>({...e,isDefault:qo.some(n=>n.name===e.name&&n.isDefault)}));localStorage.setItem(tB,JSON.stringify(t))}catch(t){console.error("Error saving templates to localStorage:",t)}}function C0e(t){if(!Array.isArray(t))return 0;const n=t.map(s=>{const a=s.type==="object"||s.type==="array"?s.type:"object";return{name:String(s.name||`템플릿_${Date.now()}`).trim(),type:a,value:JSON.parse(JSON.stringify(s.value||(a==="array"?[]:{}))),isDefault:!1}}).filter(s=>s.name).filter(s=>!qo.some(a=>a.name===s.name)),r=gn.filter(s=>!s.isDefault),i=new Map;r.forEach(s=>i.set(s.name,s)),n.forEach(s=>i.set(s.name,{...s,isDefault:!1}));const o=Array.from(i.values());return gn=[...qo,...o],Wg(),n.length}function _f(){return gn.length===0&&ux(),gn.filter(t=>!t.isDefault)}function b0e(t,e){const n=t.trim(),r=e.trim();if(!r)return"empty_name";const i=gn.findIndex(o=>o.name===n&&!o.isDefault);return i===-1?"not_found":gn.some((o,s)=>o.name===r&&s!==i)?"duplicate_name":qo.some(o=>o.name===r)?"default_conflict":(gn[i].name=r,Wg(),!0)}function S0e(t){const e=t.trim(),n=gn.filter(i=>!i.isDefault).length;return gn=gn.filter(i=>!(!i.isDefault&&i.name===e)),gn.filter(i=>!i.isDefault).length<n?(Wg(),!0):!1}ux();const rB="selected_theme_json_editor",Ev=[{buttonId:"theme-btn-1",themeClass:"theme-soft-dark",name:"Soft Dark"},{buttonId:"theme-btn-2",themeClass:"theme-classic-purple",name:"Classic Purple Light"},{buttonId:"theme-btn-3",themeClass:"theme-soft-mint",name:"Soft Mint"}],iB="theme-classic-purple";let XS=null,du=null,Dc=null;function P0(t){Dc||(Dc=document.body),Ev.forEach(n=>{Dc.classList.contains(n.themeClass)&&Dc.classList.remove(n.themeClass)});let e=iB;t&&Ev.some(n=>n.themeClass===t)&&(e=t),Dc.classList.add(e),localStorage.setItem(rB,e),R0e(e)}function R0e(t){du&&du.forEach(e=>{const n=Ev.find(r=>r.buttonId===e.id);n&&n.themeClass===t?e.classList.add("active-theme"):e.classList.remove("active-theme")})}function E0e(){du&&du.forEach(t=>{t.addEventListener("click",()=>{const e=Ev.find(n=>n.buttonId===t.id);e&&P0(e.themeClass)})})}function T0e(){if(Dc=document.body,XS=document.querySelector(".theme-switcher"),!XS){console.warn("Theme switcher element not found by theme-switcher.js during initialization.");return}if(du=XS.querySelectorAll(".theme-button"),!du||du.length===0){console.warn("Theme buttons not found by theme-switcher.js during initialization.");return}E0e();const t=localStorage.getItem(rB);P0(t!==null?t:iB),console.log("Theme switcher initialized.")}function O0(t){if(typeof t!="object"||t===null)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){if(console.warn("JSON.stringify를 사용한 deepClone 실패, 수동 클론 시도:",e),Array.isArray(t))return t.map(r=>O0(r));const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=O0(t[r]));return n}}let re={},Jt=null,Ls=null;const cx=["string","number","integer","object","array","boolean","null"];function lt(t,e=[],n={},r=""){const i=document.createElement(t);Array.isArray(e)?i.classList.add(...e.filter(o=>o)):e&&i.classList.add(e);for(const o in n)i.setAttribute(o,n[o]);return r&&(i.textContent=r),i}function M0e(){if(!Ls)return[];const t=re.type||"object",e=re.description||"",n=lt("select",["p-2","border","rounded-md","shadow-sm","mr-2"],{id:"visualRootSchemaType"});cx.forEach(s=>{const a=lt("option",[],{value:s},s.charAt(0).toUpperCase()+s.slice(1));s===t&&(a.selected=!0),n.appendChild(a)}),n.addEventListener("change",s=>{re.type=s.target.value,re.type==="object"?(re.properties||(re.properties={}),delete re.items,delete re.minItems,delete re.maxItems):re.type==="array"?(re.items||(re.items={type:"string"}),delete re.properties,delete re.additionalProperties):(delete re.properties,delete re.items,delete re.minItems,delete re.maxItems,delete re.additionalProperties),th(),Jt&&Jt(re)});const r=lt("input",["w-full","p-2","border","rounded-md","shadow-sm","text-sm"],{type:"text",id:"visualRootSchemaDescription",placeholder:"스키마 전체에 대한 설명을 입력하세요..."});r.value=e,r.addEventListener("input",s=>{s.target.value.trim()?re.description=s.target.value.trim():delete re.description,Jt&&Jt(re)});const i=lt("div",["flex","items-center","space-x-2","mb-3"]);i.appendChild(lt("label",["font-semibold","text-gray-700"],{for:"visualRootSchemaType"},"루트 타입:")),i.appendChild(n);const o=lt("div",["mb-4"]);return o.appendChild(lt("label",["block","font-semibold","text-gray-700","mb-1"],{for:"visualRootSchemaDescription"},"스키마 설명:")),o.appendChild(r),[i,o]}function _0e(){if(!Ls||re.type!=="object")return null;const t=lt("div",["mt-4","p-4","border","rounded","bg-gray-50"],{id:"visualObjectEditorControls"});t.appendChild(lt("h3",["text-lg","font-semibold","text-gray-700","mb-2"],{},"객체 속성 편집:"));const e=lt("div",["space-y-3","bg-white","p-3","rounded-md","border","border-gray-200"],{id:"visualPropertiesList"});if(re.properties)for(const r in re.properties)Object.prototype.hasOwnProperty.call(re.properties,r)&&e.appendChild(x0e(r,re.properties[r]));t.appendChild(e);const n=lt("button",["mt-3","px-4","py-2","bg-blue-500","text-white","rounded","hover:bg-blue-600","text-sm","font-medium","add-property-btn"],{},"+ 새 속성 추가");return n.addEventListener("click",()=>{const r=`newProperty${Object.keys(re.properties||{}).length+1}`;re.properties||(re.properties={}),re.properties[r]={type:"string",description:""},th(),Jt&&Jt(re)}),t.appendChild(n),t}function x0e(t,e){const n=lt("div",["property-editor-item","flex","items-center","space-x-2","p-2","border-b","border-gray-200"]);n.dataset.key=t;const r=lt("input",["p-1","border","rounded-md","w-2/6","text-sm","prop-name"],{type:"text",value:t,placeholder:"속성 이름"});r.addEventListener("input",a=>{const l=n.dataset.key,u=a.target.value.trim();if(u&&u!==l){if(re.properties&&re.properties[l]){const c=re.properties[l];delete re.properties[l],re.properties[u]=c,n.dataset.key=u}}else if(!u&&l){a.target.value=l;return}Jt&&Jt(re)}),r.addEventListener("blur",a=>{const l=n.dataset.key,u=a.target.value.trim();u&&u!==l?th():!u&&l&&(a.target.value=l)});const i=lt("select",["p-1","border","rounded-md","w-1/4","text-sm","prop-type"]);cx.forEach(a=>{const l=lt("option",[],{value:a},a.charAt(0).toUpperCase()+a.slice(1));a===(e.type||"string")&&(l.selected=!0),i.appendChild(l)}),i.addEventListener("change",a=>{const l=n.dataset.key;re.properties&&re.properties[l]&&(re.properties[l].type=a.target.value,a.target.value==="object"?re.properties[l].properties={}:a.target.value==="array"?re.properties[l].items={type:"string"}:(delete re.properties[l].properties,delete re.properties[l].items),Jt&&Jt(re),th())});const o=lt("input",["p-1","border","rounded-md","w-2/6","text-sm","prop-description"],{type:"text",value:e.description||"",placeholder:"설명"});o.addEventListener("input",a=>{const l=n.dataset.key;re.properties&&re.properties[l]&&(a.target.value.trim()?re.properties[l].description=a.target.value.trim():delete re.properties[l].description,Jt&&Jt(re))});const s=lt("button",["px-2","py-1","bg-red-500","text-white","rounded","hover:bg-red-600","text-xs","ml-auto"],{},"X");return s.addEventListener("click",()=>{const a=n.dataset.key;re.properties&&re.properties[a]&&(delete re.properties[a],th(),Jt&&Jt(re))}),n.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(s),n}function I0e(){if(!Ls||re.type!=="array")return null;const t=lt("div",["mt-4","p-4","border","rounded","bg-gray-50"],{id:"visualArrayEditorControls"});t.appendChild(lt("h3",["text-lg","font-semibold","text-gray-700","mb-2"],{},"배열 항목 편집:"));const e=re.items||{type:"string",description:""},n=re.minItems!==void 0?re.minItems:"",r=re.maxItems!==void 0?re.maxItems:"",i=lt("div",["flex","items-center","space-x-2","mb-2"]);i.appendChild(lt("label",["font-semibold","text-gray-700"],{for:"visualArrayItemType"},"항목 타입:"));const o=lt("select",["p-1","border","rounded-md","text-sm"],{id:"visualArrayItemType"});cx.forEach(d=>{const f=lt("option",[],{value:d},d.charAt(0).toUpperCase()+d.slice(1));d===e.type&&(f.selected=!0),o.appendChild(f)}),o.addEventListener("change",d=>{re.items||(re.items={}),re.items.type=d.target.value,Jt&&Jt(re)}),i.appendChild(o),t.appendChild(i);const s=lt("div",["mb-2"]);s.appendChild(lt("label",["block","font-semibold","text-gray-700","mb-1"],{for:"visualArrayItemDesc"},"항목 설명:"));const a=lt("input",["w-full","p-2","border","rounded-md","shadow-sm","text-sm"],{type:"text",id:"visualArrayItemDesc",placeholder:"배열 항목에 대한 설명"});a.value=e.description||"",a.addEventListener("input",d=>{re.items||(re.items={}),d.target.value.trim()?re.items.description=d.target.value.trim():delete re.items.description,Jt&&Jt(re)}),s.appendChild(a),t.appendChild(s);const l=lt("div",["flex","items-center","space-x-2","mb-2"]);l.appendChild(lt("label",["font-semibold","text-gray-700"],{for:"visualArrayMinItems"},"최소 항목 수:"));const u=lt("input",["p-1","border","rounded-md","w-20","text-sm"],{type:"number",id:"visualArrayMinItems",placeholder:"예: 0"});u.value=n,u.addEventListener("input",d=>{const f=d.target.value;f===""||isNaN(parseInt(f))?delete re.minItems:re.minItems=parseInt(f),Jt&&Jt(re)}),l.appendChild(u),t.appendChild(l);const c=lt("div",["flex","items-center","space-x-2","mb-2"]);c.appendChild(lt("label",["font-semibold","text-gray-700"],{for:"visualArrayMaxItems"},"최대 항목 수:"));const h=lt("input",["p-1","border","rounded-md","w-20","text-sm"],{type:"number",id:"visualArrayMaxItems",placeholder:"예: 10"});return h.value=r,h.addEventListener("input",d=>{const f=d.target.value;f===""||isNaN(parseInt(f))?delete re.maxItems:re.maxItems=parseInt(f),Jt&&Jt(re)}),c.appendChild(h),t.appendChild(c),t}function th(){if(!Ls)return;if(Ls.innerHTML="",M0e().forEach(e=>Ls.appendChild(e)),re.type==="object"){const e=_0e();e&&Ls.appendChild(e)}else if(re.type==="array"){const e=I0e();e&&Ls.appendChild(e)}}function P0e(t,e,n){if(!t){console.error("Visual schema editor container not provided!");return}Ls=t,Jt=n,e&&typeof e=="object"?(re=O0(e),re.type||(re.type="object"),re.type==="object"&&!re.properties&&(re.properties={}),re.type==="array"&&!re.items&&(re.items={type:"string"}),re.$schema||(re.$schema="http://json-schema.org/draft-07/schema#")):re={$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{},description:""},th()}let Te=null,fu=null,Fs,xf,nr,De=null;const Tv=document.querySelector(".main-layout-triple-panel"),Mv=document.getElementById("schemaEditorPanelContainer"),fh=document.getElementById("toggleSchemaEditorBtn");let hx=!1;function O0e(t){if(typeof t!="string")throw new TypeError("입력값은 문자열이어야 합니다.");try{return encodeURIComponent(t)}catch(e){throw console.error("URL 인코딩 중 오류 발생:",e),e}}function A0e(t){if(typeof t!="string")throw new TypeError("입력값은 문자열이어야 합니다.");try{return decodeURIComponent(t)}catch(e){throw console.error("URL 디코딩 중 오류 발생:",e),e}}async function oB(){const t=async(n="",r="success")=>{n&&je&&Ot(je,n,2500),await new Promise(i=>setTimeout(i,50)),oB()},e=_f();await jj({userTemplates:e,callbacks:{onViewRequest:async n=>{const r=_f().find(i=>i.name===n);r&&await Wj({templateName:r.name,templateValue:r.value,hotInstance:De}),await t("템플릿 내용을 확인했습니다.","info")},onRenameRequest:async n=>{if(!_f().find(o=>o.name===n)){await t("변경할 템플릿을 찾지 못했습니다.","error");return}const i=await to({title:`'${n}' 템플릿 이름 변경`,inputLabel:"새로운 템플릿 이름을 입력하세요:",inputValue:n,confirmButtonText:"변경 저장",inputValidator:o=>{const s=o.trim();return s?s===n?null:nB().some(a=>a.name===s)?`'${s}' 이름은 이미 사용 중입니다.`:null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:De});if(i.isConfirmed&&typeof i.value=="string"){const o=i.value.trim();if(o===n){await t("이름이 변경되지 않았습니다.","info");return}const s=b0e(n,o);if(s===!0)await t(`템플릿 '${n}'이(가) '${o}'(으)로 변경되었습니다.`);else{let a="알 수 없는 오류로 이름 변경에 실패했습니다.";s==="empty_name"?a="새 템플릿 이름은 비워둘 수 없습니다.":s==="not_found"?a=`템플릿 '${n}'을(를) 찾을 수 없습니다.`:s==="duplicate_name"?a=`새 이름 '${o}'은(는) 이미 사용 중입니다.`:s==="default_conflict"&&(a=`새 이름 '${o}'은(는) 기본 템플릿 이름과 충돌합니다.`),await Ce({title:"이름 변경 오류",text:a,icon:"error",showCancelButton:!1,hotInstance:De}),await t("이름 변경 중 문제가 발생했습니다.","error")}}else await t("이름 변경이 취소되었습니다.","info")},onDeleteRequest:async n=>{(await Ce({title:`'${n}' 템플릿 삭제`,text:`정말로 '${n}' 템플릿을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`,icon:"warning",showCancelButton:!0,confirmButtonText:"삭제",cancelButtonText:"취소",hotInstance:De})).isConfirmed?S0e(n)?await t(`템플릿 '${n}'이(가) 삭제되었습니다.`):(await Ce({title:"삭제 오류",text:`템플릿 '${n}' 삭제에 실패했습니다.`,icon:"error",showCancelButton:!1,hotInstance:De}),await t("삭제 중 문제가 발생했습니다.","error")):await t("삭제가 취소되었습니다.","info")}},hotInstance:De})}function H0e(){Tv&&(Tv.style.display="flex"),Mv&&(Mv.style.display="none"),fh&&(fh.textContent="📜 스키마 편집기"),hx=!1}function N0e(){if(Tv&&(Tv.style.display="none"),Mv){Mv.style.display="flex";const t=document.getElementById("schema-editor-content-area"),e=document.getElementById("jsonSchema");let n={$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{},description:""};if(e&&e.value)try{const r=JSON.parse(e.value);typeof r=="object"&&r!==null?n=r:console.warn("메인 스키마 텍스트 영역의 내용이 유효한 객체가 아니므로 기본 스키마로 초기화합니다.")}catch(r){console.warn("메인 스키마 텍스트 영역 파싱 실패, 기본 스키마로 시각적 편집기 초기화:",r.message)}t?P0e(t,n,r=>{e&&(e.value=JSON.stringify(r,null,2))}):console.error("Schema editor content area ('schema-editor-content-area') not found.")}fh&&(fh.textContent="JSON 편집기로 돌아가기"),hx=!0}function D0e(){const t=document.getElementById("loadBtn");t&&t.addEventListener("click",$y);const e=document.getElementById("saveBtn");e&&e.addEventListener("click",G0e);const n=document.getElementById("minifyBtn");n&&n.addEventListener("click",()=>{if(gt&&gt.value)try{gt.value=gB(gt.value)}catch(y){Ye&&(Ye.textContent="Minify 오류: "+y.message)}else gt&&(gt.value="")});const r=document.getElementById("uglifyBtn");r&&r.addEventListener("click",()=>{if(gt&&gt.value)try{gt.value=mB(gt.value)}catch(y){Ye&&(Ye.textContent="Uglify(포맷팅) 오류: "+y.message)}else gt&&(gt.value="")});const i=document.getElementById("diffBtn");i&&i.addEventListener("click",()=>{if(!fu&&!Te){Ce({title:"알림",text:"먼저 JSON 데이터를 로드해주세요.",icon:"info",showCancelButton:!1,hotInstance:De});return}if(!fu){Ce({title:"알림",text:"로드 시점의 원본 JSON 데이터가 없습니다.",icon:"info",showCancelButton:!1,hotInstance:De});return}Bj({title:"JSON 데이터 변경사항",jsonDiffData:{left:fu,right:Te===null?{}:Te},buttons:[{text:"닫기",role:"confirm"}],hotInstance:De}).catch(T=>{Ce({title:"오류",text:"변경점 확인 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:De})})});const o=document.getElementById("loadFromFileBtn");o&&o.addEventListener("click",j0e);const s=document.getElementById("saveToFileBtn");s&&s.addEventListener("click",U0e);const a=document.getElementById("saveToCSV");a&&a.addEventListener("click",W0e);const l=document.getElementById("loadFromCSV");l&&l.addEventListener("click",V0e);const u=document.getElementById("loadTemplatesFromFileBtn");u&&u.addEventListener("click",z0e);const c=document.getElementById("saveTemplatesToFileBtn");c&&c.addEventListener("click",Y0e);const h=document.getElementById("manageTemplatesBtn");h&&h.addEventListener("click",oB);const d=document.getElementById("encodeUrlBtn");d&&d.addEventListener("click",async()=>{const y=gt?gt.value:"";try{const T=await Vx({title:"URL 인코딩",initialInputValue:y,inputLabel:"인코딩할 원본 문자열:",outputLabel:"인코딩된 결과:",actionButtonText:"인코딩 실행",onExecuteAction:_=>{try{return O0e(_)}catch(P){return`오류: ${P.message}`}},confirmButtonText:"결과를 메인 편집기에 복사",cancelButtonText:"팝업 닫기",hotInstance:De});T.isConfirmed&&T.formData&&T.formData!==!1?gt&&(gt.value=T.formData,je&&Ot(je,"결과가 메인 편집기에 복사되었습니다.",2e3)):T.isDismissed&&T.dismiss==="cancel"&&je&&Ot(je,"URL 인코딩 작업창을 닫았습니다.",1500,"info")}catch(T){Ye&&(Ye.textContent="URL 인코딩 팝업 오류: "+T.message),je&&Ot(je,"URL 인코딩 팝업 처리 중 문제가 발생했습니다.",3e3)}});const f=document.getElementById("decodeUrlBtn");f&&f.addEventListener("click",async()=>{const y=gt?gt.value:"";try{const T=await Vx({title:"URL 디코딩",initialInputValue:y,inputLabel:"디코딩할 URL 인코딩된 문자열:",outputLabel:"디코딩된 결과:",actionButtonText:"디코딩 실행",onExecuteAction:_=>{try{return A0e(_)}catch(P){return`오류: ${P.message}`}},confirmButtonText:"결과를 메인 편집기에 복사",cancelButtonText:"팝업 닫기",hotInstance:De});T.isConfirmed&&T.formData&&T.formData!==!1?gt&&(gt.value=T.formData,je&&Ot(je,"결과가 메인 편집기에 복사되었습니다.",2e3)):T.isDismissed&&T.dismiss==="cancel"&&je&&Ot(je,"URL 디코딩 작업창을 닫았습니다.",1500,"info")}catch(T){Ye&&(Ye.textContent="URL 디코딩 팝업 오류: "+T.message),je&&Ot(je,"URL 디코딩 팝업 처리 중 문제가 발생했습니다.",3e3)}}),Fs=document.getElementById("searchInput"),xf=document.getElementById("searchTargetSelect"),nr=document.getElementById("searchResultsDropdown"),Fs&&Fs.addEventListener("input",tH),xf&&xf.addEventListener("change",tH),document.addEventListener("click",y=>{nr&&Fs&&!Fs.contains(y.target)&&!nr.contains(y.target)&&(nr.style.display="none")}),nr&&nr.addEventListener("click",y=>y.stopPropagation()),window.addEventListener("mouseup",y=>{(y.button===3||y.button===4)&&(y.preventDefault(),y.button===3?iH("back"):y.button===4&&iH("forward"))}),window.addEventListener("contextmenu",y=>{y.preventDefault()});const g=document.querySelector(".json-control-panel");g?(g.addEventListener("dragover",k0e),g.addEventListener("dragleave",$0e),g.addEventListener("drop",L0e)):console.warn(".json-control-panel 요소를 찾을 수 없어 드래그앤드롭 기능을 활성화할 수 없습니다.");const p=document.querySelector(".main-layout-triple-panel"),C=[document.querySelector(".json-control-panel"),document.querySelector(".tree-view-panel"),document.querySelector(".table-view-panel")],E=[document.getElementById("resizer-1"),document.getElementById("resizer-2")];p&&C.every(y=>y)&&E.every(y=>y)?(eH(p,C,E),window.addEventListener("resize",()=>eH(p,C,E)),E.forEach((y,T)=>{let _=!1,P=0,M=[];y.addEventListener("mousedown",W=>{W.preventDefault(),_=!0,P=W.clientX,M=[C[T].offsetWidth,C[T+1].offsetWidth],document.addEventListener("mousemove",I),document.addEventListener("mouseup",z)});function I(W){if(!_)return;const V=W.clientX-P,q=50;let Z=M[0]+V,ee=M[1]-V;Z<q&&(Z=q,ee=M[0]+M[1]-Z),ee<q&&(ee=q,Z=M[0]+M[1]-ee),C[T].style.flexBasis=`${Z}px`,C[T+1].style.flexBasis=`${ee}px`}function z(){_&&(_=!1,document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",z))}})):console.warn("3-패널 레이아웃에 필요한 요소를 모두 찾을 수 없습니다. 리사이저가 동작하지 않을 수 있습니다."),fh&&fh.addEventListener("click",()=>{hx?H0e():N0e()}),T0e()}function k0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.add("dragover-active"),t.dataTransfer.dropEffect="copy"}function $0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active")}function L0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active");const e=t.dataTransfer.files;if(e.length>0){const n=e[0];if(n.type==="application/json"||n.name.toLowerCase().endsWith(".json")){const r=new FileReader;r.onload=i=>{try{const o=i.target.result;gt?(gt.value=o,$y(),Ot(je,`${n.name} 파일이 드롭되어 로드되었습니다.`,3e3)):Ce({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:De})}catch(o){Ye&&(Ye.textContent=`파일 오류 (드롭): ${o.message}`),Ce({title:"파일 로드 오류 (드롭)",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:De})}},r.onerror=()=>{Ye&&(Ye.textContent="파일을 읽는 중 오류가 발생했습니다 (드롭)."),Ce({title:"파일 읽기 오류 (드롭)",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:De})},r.readAsText(n)}else Ce({title:"잘못된 파일 타입",text:"JSON 파일(.json)만 드롭해주세요.",icon:"warning",showCancelButton:!1,hotInstance:De})}}function eH(t,e,n){const r=t.offsetWidth,i=n.reduce((l,u)=>l+u.offsetWidth,0),o=r-i,s=[.15,.15,.7],a=50;if(o>0){let l=Math.max(a,Math.floor(o*s[0])),u=Math.max(a,Math.floor(o*s[1])),c=Math.max(a,o-l-u);if(l+u+c>o&&(c=o-l-u,c<a)){c=a;const h=o-c;l=Math.floor(h*(s[0]/(s[0]+s[1]))),u=h-l,l<a&&(l=a,u=h-l),u<a&&(u=a,l=h-u)}e[0].style.flexBasis=`${l}px`,e[1].style.flexBasis=`${u}px`,e[2].style.flexBasis=`${c}px`}}function tH(){if(!Fs||!xf||!nr)return;const t=Fs.value.trim().toLowerCase(),e=xf.value;if(!t){nr.innerHTML="",nr.style.display="none";return}if(Te==null){Q1([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],nr,t,nH);return}const n=v0e(t,e,Te);Q1(n,nr,t,nH)}function nH(t){t&&typeof nl=="function"&&t.data!==void 0&&(nl(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString||""),nr&&(nr.style.display="none"))}function JS(t){const e=[];let n="",r=!1;for(let i=0;i<t.length;i++){const o=t[i];o==='"'?r&&i+1<t.length&&t[i+1]==='"'?(n+='"',i++):r=!r:o===","&&!r?(e.push(n),n=""):n+=o}return e.push(n),e}function rH(t){if(typeof t!="string")return t;const e=t.trim();if(e.toLowerCase()==="null")return null;if(e.toLowerCase()==="true")return!0;if(e.toLowerCase()==="false")return!1;if(e==="")return null;if(e!==""&&!isNaN(Number(e))&&(e.includes(".")||/^-?\d+$/.test(e)||String(Number(e))===e.replace(/^0+(?=\d)/,"")))return Number(e);if(e.startsWith("[")&&e.endsWith("]")||e.startsWith("{")&&e.endsWith("}"))try{return JSON.parse(e)}catch{return e}return e}function F0e(t){const e=t.trim().split(/\r\n|\n|\r/);if(e.length===0)return[];let n=-1;for(let l=0;l<e.length;l++)if(e[l].trim()!==""){n=l;break}if(n===-1)return[];let r=JS(e[n]).map((l,u)=>{const c=l.trim();return c===""?`column_${u+1}`:c});const i=r.map(l=>l.toLowerCase()),o=["key","property","name","field","item"];if(r.length===2&&o.includes(i[0])&&i[1]==="value"){const l={};for(let u=n+1;u<e.length;u++){const c=e[u];if(c.trim()==="")continue;const h=JS(c);if(!h.every(d=>d.trim()==="")&&h.length>=2){const d=h[0].trim();if(d==="")continue;const f=h[1];l[d]=rH(f)}}return l}else{const l=[];for(let u=n+1;u<e.length;u++){const c=e[u];if(c.trim()==="")continue;const h=JS(c);if(h.every(p=>p.trim()===""))continue;const d={};let f=!1;const g=Math.max(r.length,h.length);for(let p=0;p<g;p++){const C=p<r.length&&r[p]?r[p]:`column_${p+1}`,E=h[p]!==void 0?h[p]:"",y=rH(E);d[C]=y,y!==null&&String(y).trim()!==""&&(f=!0)}f&&l.push(d)}return l}}async function V0e(){const t=document.createElement("input");t.type="file",t.accept=".csv,text/csv",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=i=>{try{const o=i.target.result,s=F0e(o);let a,l=`${n.name} CSV 로드 완료.`;Array.isArray(s)?s.length>0?(a=s[0],s.length>1&&(l=`${n.name} CSV 로드됨 (주의: 여러 레코드 중 첫 번째만 표시).`)):a=[]:typeof s=="object"&&s!==null?(a=s,l=`${n.name} Key-Value CSV가 단일 JSON 객체로 로드되었습니다.`):(a={},l=`${n.name} CSV 변환 중 예상치 못한 결과.`);const u=JSON.stringify(a,null,2);gt?(gt.value=u,$y(),Ot(je,l,5e3)):Ce({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:De})}catch(o){Ye&&(Ye.textContent=`CSV 파일 파싱 오류: ${o.message}`),Ce({title:"CSV 파일 파싱 오류",text:`CSV 파일을 JSON으로 변환 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:De})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{Ye&&(Ye.textContent="CSV 파일을 읽는 중 오류."),Ce({title:"CSV 파일 읽기 오류",text:"CSV 파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:De}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}function B0e(t){if(t==null)throw new Error("데이터가 없어 CSV로 변환할 수 없습니다.");let e="";const n=r=>{if(r==null)return"";let i;return typeof r=="object"?i=JSON.stringify(r):i=String(r),(i.includes(",")||i.includes(`
`)||i.includes("\r")||i.includes('"'))&&(i='"'+i.replace(/"/g,'""')+'"'),i};if(Array.isArray(t)){if(t.length===0)return"";if(typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])){const r=[];if(t.forEach(i=>{typeof i=="object"&&i!==null&&Object.keys(i).forEach(o=>{r.includes(o)||r.push(o)})}),r.length>0)e+=r.map(n).join(",")+`\r
`;else if(t.every(i=>typeof i!="object"||i===null))return e+=`value\r
`,t.forEach(i=>{e+=n(i)+`\r
`}),e;t.forEach(i=>{if(typeof i=="object"&&i!==null){const o=r.map(s=>n(i[s]));e+=o.join(",")+`\r
`}else{const o=r.map(()=>n(null));e+=o.join(",")+`\r
`}})}else e+=`value\r
`,t.forEach(r=>{e+=n(r)+`\r
`})}else typeof t=="object"&&t!==null?(e+=`key,value\r
`,Object.keys(t).forEach(r=>{e+=n(r)+","+n(t[r])+`\r
`})):(e+=`value\r
`,e+=n(t)+`\r
`);return e}async function W0e(){if(Te==null){Ot(je,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await to({title:"CSV 파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.csv 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:De});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".csv")||(e+=".csv");const n=B0e(Te),r="\uFEFF",i=new Blob([r+n],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(i),s=document.createElement("a");s.href=o,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o),Ot(je,`${e} 파일이 성공적으로 CSV로 저장되었습니다!`,3e3)}else Ot(je,"CSV 파일 저장이 취소되었습니다.",3e3)}catch(t){Ye&&(Ye.textContent="CSV 파일 저장/변환 오류: "+t.message),Ce({title:"CSV 저장/변환 오류",text:`JSON 데이터를 CSV로 저장/변환 중 오류: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:De})}}function j0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=i=>{try{const o=i.target.result;gt?(gt.value=o,$y(),Ot(je,`${n.name} 파일이 로드되었습니다.`,3e3)):Ce({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:De})}catch(o){Ye&&(Ye.textContent=`파일 오류: ${o.message}`),Ce({title:"파일 로드 오류",text:`파일을 로드하거나 파싱하는 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:De})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{Ye&&(Ye.textContent="파일을 읽는 중 오류."),Ce({title:"파일 읽기 오류",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:De}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}async function U0e(){if(Te==null){Ot(je,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await to({title:"파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:De});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".json")||(e+=".json");const n=JSON.stringify(Te,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),Ot(je,`${e} 파일이 성공적으로 저장되었습니다!`,3e3)}else Ot(je,"파일 저장이 취소되었습니다.",3e3)}catch(t){Ye&&(Ye.textContent="JSON 파일 저장 오류: "+t.message),Ce({title:"파일 저장 오류",text:`JSON 데이터를 파일로 저장 중 오류: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:De})}}async function z0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",async e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=async i=>{try{const o=i.target.result,s=JSON.parse(o);if(!Array.isArray(s))throw new Error("템플릿 파일은 배열 형태여야 합니다.");const a=_f().map(u=>u.name),l=await gN({title:`'${n.name}' 파일에서 템플릿 불러오기`,templates:s,message:'아래 목록에서 불러올 템플릿을 선택하세요. <span style="color: var(--color-warning, orange); font-weight:bold;">(덮어씀)</span> 표시는 이름이 같은 기존 사용자 템플릿을 이 파일의 내용으로 변경함을 의미합니다.',confirmButtonText:"선택한 템플릿 불러오기",cancelButtonText:"취소",hotInstance:De,existingUserTemplateNames:a});if(l.isConfirmed)if(l.selectedTemplates.length>0){const u=C0e(l.selectedTemplates);Ot(je,`선택된 ${u}개의 사용자 템플릿을 '${n.name}'에서 로드 및 병합했습니다.`,3e3)}else Ot(je,"선택된 템플릿이 없어 아무것도 로드하지 않았습니다.",3e3,"info");else Ot(je,"템플릿 파일 로드가 취소되었습니다.",3e3,"info")}catch(o){Ye&&(Ye.textContent=`템플릿 파일 처리 오류: ${o.message}`),Ce({title:"템플릿 파일 처리 오류",text:`템플릿 파일을 처리하는 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:De})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{Ye&&(Ye.textContent="템플릿 파일을 읽는 중 오류."),Ce({title:"파일 읽기 오류",text:"템플릿 파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:De}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}async function Y0e(){const t=_f();if(!t||t.length===0){Ot(je,"저장할 사용자 정의 템플릿이 없습니다.",3e3);return}try{const e=await gN({title:"파일로 저장할 템플릿 선택",templates:t,message:"파일로 저장할 사용자 정의 템플릿을 선택하세요.",confirmButtonText:"선택한 템플릿 저장하기",cancelButtonText:"취소",hotInstance:De});if(e.isConfirmed&&e.selectedTemplates.length>0){const n=e.selectedTemplates.map(({name:i,type:o,value:s})=>({name:i,type:o,value:s})),r=await to({title:"템플릿 파일 이름 입력",inputLabel:"저장할 템플릿 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"user_templates",confirmButtonText:"저장",inputValidator:i=>!i||i.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:De});if(r.isConfirmed&&r.value){let i=r.value.trim();i.toLowerCase().endsWith(".json")||(i+=".json");const o=JSON.stringify(n,null,2),s=new Blob([o],{type:"application/json"}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a),Ot(je,`선택된 사용자 템플릿이 ${i} 파일로 성공적으로 저장되었습니다!`,3e3)}else Ot(je,"템플릿 파일 이름 입력이 취소되어 저장이 중단되었습니다.",3e3,"info")}else e.isConfirmed&&e.selectedTemplates.length===0?Ot(je,"선택된 템플릿이 없어 아무것도 저장하지 않았습니다.",3e3,"info"):e.isDismissed&&Ot(je,"템플릿 파일 저장이 취소되었습니다.",3e3,"info")}catch(e){Ye&&(Ye.textContent="템플릿 파일 저장 오류: "+e.message),Ce({title:"템플릿 파일 저장 오류",text:`템플릿을 파일로 저장하는 중 오류: ${e.message}`,icon:"error",showCancelButton:!1,hotInstance:De})}}function $y(){K0e(),g0e();try{const t=gt.value.trim();if(!t){Te=null,fu=null,zc(null,If),hw();return}Te=JSON.parse(t),fu=JSON.parse(JSON.stringify(Te));const e=sB();if(Pt&&(Pt.innerHTML=""),typeof Te=="object"&&Te!==null)Of(Te,Pt,"",Te,0,e);else{const r={["value"]:Te};Of(r,Pt,"",r,0,e)}hw(),zc(null,If)}catch(t){Ye&&(Ye.textContent="JSON 파싱 오류: "+t.message),Te=null,fu=null,Pt&&(Pt.innerHTML=""),hw(),zc(null,If)}}function G0e(){if(Ye&&(Ye.textContent=""),Te!=null)try{const t=JSON.stringify(Te,null,2);gt&&(gt.value=t),je&&Ot(je,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){Ye&&(Ye.textContent="JSON 문자열 변환 오류: "+t.message),je&&(je.textContent="")}else gt&&(gt.value=""),je&&Ot(je,"저장할 JSON 데이터가 없습니다.",3e3)}function K0e(){Uj(),hw(),Te=null,fu=null,oh(null),nr&&(nr.innerHTML="",nr.style.display="none"),Fs&&(Fs.value=""),Pt&&(Pt.innerHTML=""),zc(null,If)}function hw(){De=eB()}function q0e(t,e,n=!1){if(Te==null)return;const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Te:s=mu(Te,o),o===""&&t===i&&(typeof Te!="object"||Te===null)){if(Te=iR(e,Te),n)return;_v(t),nl(Te,"value",Te,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){Ce({title:"오류",text:"데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).",icon:"error",showCancelButton:!1,hotInstance:De});return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){Ce({title:"오류",text:"배열 인덱스 범위를 벗어났습니다.",icon:"error",showCancelButton:!1,hotInstance:De});return}let l=!0;const u=s[a],c=iR(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&Pt){const f=Pt.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(mN(g,c),l=!1)}}!n&&l&&_v(t)}}function X0e(t,e,n,r){let i;if(r&&(t===""||mu(Te,t)===r)?i=r:i=t===""?Te:mu(Te,t),typeof i!="object"||i===null||Array.isArray(i)){Ce({title:"오류",text:"키를 업데이트할 부모 객체를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:De});return}if(!Object.prototype.hasOwnProperty.call(i,e)){Ce({title:"오류",text:`기존 키 "${e}"를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:De});return}if(n===e){Ce({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다.",showCancelButton:!1,hotInstance:De});return}if(Object.prototype.hasOwnProperty.call(i,n)){Ce({title:"오류",text:`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:De});return}const o={},s=i[e];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&delete i[a];for(const a in o)Object.prototype.hasOwnProperty.call(o,a)&&(i[a]=o[a]);Ce({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`,showCancelButton:!1,hotInstance:De}),_v(`key_renamed_in_parent:${t}`),nl(i,n,Te,t)}function _v(t="N/A"){if(Pt&&Te!=null){const e=Gj(),n=Kj(Pt);Pt.innerHTML="";const r=sB();if(typeof Te=="object"&&Te!==null)Of(Te,Pt,"",Te,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Te};Of(o,Pt,"",o,0,r)}if(qj(Pt,n),e){const i=Pt.querySelector(`.tree-node[data-path="${e}"]`);i&&oh(i)}}else Pt&&(Pt.innerHTML="")}function sB(){return{displayTableCallback:nl,getObjectByPathCallback:mu,rootJsonData:Te}}function If(t){const e=mu(Te,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}nl(e,n,Te,t,{syncTreeView:!0})}else Ce({title:"오류",text:`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:De})}function nl(t,e,n,r,i={syncTreeView:!0}){if(m0e({dataPathString:r,dataKeyName:e}),zc(r,If),De=d0e(t,e,{tableViewDomElement:rR,updateJsonDataCallback:q0e,updateJsonKeyCallback:X0e,refreshTreeViewCallback:_v,getObjectByPathCallback:mu,convertToTypedValueCallback:iR,rootJsonData:n,currentJsonDataRef:()=>Te,dataPathString:r,displayTableCallback:nl,getTemplates:nB,addTemplate:y0e}),i.syncTreeView&&Pt&&r!==void 0&&r!==null){const s=Pt.querySelector(`.tree-node[data-path="${r}"]`);s?(oh(s),setTimeout(()=>{const a=Pt.querySelector(`.tree-node[data-path="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},50)):r===""&&(oh(null),Pt.firstChild&&(Pt.scrollTop=0))}}function iH(t){const e=p0e(t);if(e){Z1(!0);try{const n=mu(Te,e.dataPathString);nl(n,e.dataKeyName,Te,e.dataPathString,{syncTreeView:!1})}catch{Ce({title:"오류",text:"히스토리 복원 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:De})}finally{Z1(!1)}}}document.addEventListener("DOMContentLoaded",D0e)});export default J0e();
