var XV=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var T0e=XV((V0e,nw)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function JV(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function ZV(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function zA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function QV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cx(t,e){return t.get(zA(t,e))}function eB(t,e,n){QV(t,e),e.set(t,n)}function tB(t,e,n){return t.set(zA(t,e),n),n}const nB=100,Re={},rB=()=>{Re.previousActiveElement instanceof HTMLElement?(Re.previousActiveElement.focus(),Re.previousActiveElement=null):document.body&&document.body.focus()},iB=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Re.restoreFocusTimeout=setTimeout(()=>{rB(),e()},nB),window.scrollTo(n,r)}),YA="swal2-",oB=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],z=oB.reduce((t,e)=>(t[e]=YA+e,t),{}),sB=["success","warning","info","question","error"],rw=sB.reduce((t,e)=>(t[e]=YA+e,t),{}),GA="SweetAlert2:",C0=t=>t.charAt(0).toUpperCase()+t.slice(1),dr=t=>{console.warn(`${GA} ${typeof t=="object"?t.join(" "):t}`)},yu=t=>{console.error(`${GA} ${t}`)},hx=[],aB=t=>{hx.includes(t)||(hx.push(t),dr(t))},KA=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;aB(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},vv=t=>typeof t=="function"?t():t,b0=t=>t&&typeof t.toPromise=="function",Kf=t=>b0(t)?t.toPromise():Promise.resolve(t),S0=t=>t&&Promise.resolve(t)===t,mr=()=>document.body.querySelector(`.${z.container}`),qf=t=>{const e=mr();return e?e.querySelector(t):null},ei=t=>qf(`.${t}`),st=()=>ei(z.popup),sh=()=>ei(z.icon),lB=()=>ei(z["icon-content"]),qA=()=>ei(z.title),R0=()=>ei(z["html-container"]),XA=()=>ei(z.image),E0=()=>ei(z["progress-steps"]),yv=()=>ei(z["validation-message"]),Ko=()=>qf(`.${z.actions} .${z.confirm}`),ah=()=>qf(`.${z.actions} .${z.cancel}`),Cu=()=>qf(`.${z.actions} .${z.deny}`),uB=()=>ei(z["input-label"]),lh=()=>qf(`.${z.loader}`),Xf=()=>ei(z.actions),JA=()=>ei(z.footer),Cv=()=>ei(z["timer-progress-bar"]),T0=()=>ei(z.close),cB=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,M0=()=>{const t=st();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(cB),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>$r(o))},_0=()=>Vs(document.body,z.shown)&&!Vs(document.body,z["toast-shown"])&&!Vs(document.body,z["no-backdrop"]),bv=()=>{const t=st();return t?Vs(t,z.toast):!1},hB=()=>{const t=st();return t?t.hasAttribute("data-loading"):!1},ti=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},Vs=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},dB=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(z).includes(n)&&!Object.values(rw).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Qr=(t,e,n)=>{if(dB(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){dr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}gt(t,r)}},Sv=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${z.popup} > .${z[e]}`);case"checkbox":return t.querySelector(`.${z.popup} > .${z.checkbox} input`);case"radio":return t.querySelector(`.${z.popup} > .${z.radio} input:checked`)||t.querySelector(`.${z.popup} > .${z.radio} input:first-child`);case"range":return t.querySelector(`.${z.popup} > .${z.range} input`);default:return t.querySelector(`.${z.popup} > .${z.input}`)}},ZA=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},QA=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},gt=(t,e)=>{QA(t,e,!0)},Ei=(t,e)=>{QA(t,e,!1)},Pa=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&Vs(i,e))return i}},ru=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},Dn=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},Qn=t=>{t&&(t.style.display="none")},x0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{Jf(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},dx=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},Jf=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?Dn(t,n):Qn(t)},$r=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),fB=()=>!$r(Ko())&&!$r(Cu())&&!$r(ah()),fx=t=>t.scrollHeight>t.clientHeight,eH=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},P0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=Cv();n&&$r(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},gB=()=>{const t=Cv();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},mB=()=>typeof window>"u"||typeof document>"u",pB=`
 <div aria-labelledby="${z.title}" aria-describedby="${z["html-container"]}" class="${z.popup}" tabindex="-1">
   <button type="button" class="${z.close}"></button>
   <ul class="${z["progress-steps"]}"></ul>
   <div class="${z.icon}"></div>
   <img class="${z.image}" />
   <h2 class="${z.title}" id="${z.title}"></h2>
   <div class="${z["html-container"]}" id="${z["html-container"]}"></div>
   <input class="${z.input}" id="${z.input}" />
   <input type="file" class="${z.file}" />
   <div class="${z.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${z.select}" id="${z.select}"></select>
   <div class="${z.radio}"></div>
   <label class="${z.checkbox}">
     <input type="checkbox" id="${z.checkbox}" />
     <span class="${z.label}"></span>
   </label>
   <textarea class="${z.textarea}" id="${z.textarea}"></textarea>
   <div class="${z["validation-message"]}" id="${z["validation-message"]}"></div>
   <div class="${z.actions}">
     <div class="${z.loader}"></div>
     <button type="button" class="${z.confirm}"></button>
     <button type="button" class="${z.deny}"></button>
     <button type="button" class="${z.cancel}"></button>
   </div>
   <div class="${z.footer}"></div>
   <div class="${z["timer-progress-bar-container"]}">
     <div class="${z["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),wB=()=>{const t=mr();return t?(t.remove(),Ei([document.documentElement,document.body],[z["no-backdrop"],z["toast-shown"],z["has-column"]]),!0):!1},nl=()=>{Re.currentInstance.resetValidationMessage()},vB=()=>{const t=st(),e=Pa(t,z.input),n=Pa(t,z.file),r=t.querySelector(`.${z.range} input`),i=t.querySelector(`.${z.range} output`),o=Pa(t,z.select),s=t.querySelector(`.${z.checkbox} input`),a=Pa(t,z.textarea);e.oninput=nl,n.onchange=nl,o.onchange=nl,s.onchange=nl,a.oninput=nl,r.oninput=()=>{nl(),i.value=r.value},r.onchange=()=>{nl(),i.value=r.value}},yB=t=>typeof t=="string"?document.querySelector(t):t,CB=t=>{const e=st();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},bB=t=>{window.getComputedStyle(t).direction==="rtl"&&gt(mr(),z.rtl)},SB=t=>{const e=wB();if(mB()){yu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=z.container,e&&gt(n,z["no-transition"]),ti(n,pB),n.dataset.swal2Theme=t.theme;const r=yB(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),CB(t),bB(r),vB()},I0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?RB(t,e):t&&ti(e,t)},RB=(t,e)=>{t.jquery?EB(e,t):ti(e,t.toString())},EB=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},TB=(t,e)=>{const n=Xf(),r=lh();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?Qn(n):Dn(n),Qr(n,e,"actions"),MB(n,r,e),ti(r,e.loaderHtml||""),Qr(r,e,"loader"))};function MB(t,e,n){const r=Ko(),i=Cu(),o=ah();!r||!i||!o||(Iy(r,"confirm",n),Iy(i,"deny",n),Iy(o,"cancel",n),_B(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function _B(t,e,n,r){if(!r.buttonsStyling){Ei([t,e,n],z.styled);return}gt([t,e,n],z.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),Py(t),Py(e),Py(n)}function Py(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function Iy(t,e,n){const r=C0(e);Jf(t,n[`show${r}Button`],"inline-block"),ti(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=z[e],Qr(t,n,`${e}Button`)}const xB=(t,e)=>{const n=T0();n&&(ti(n,e.closeButtonHtml||""),Qr(n,e,"closeButton"),Jf(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},PB=(t,e)=>{const n=mr();n&&(IB(n,e.backdrop),OB(n,e.position),AB(n,e.grow),Qr(n,e,"container"))};function IB(t,e){typeof e=="string"?t.style.background=e:e||gt([document.documentElement,document.body],z["no-backdrop"])}function OB(t,e){e&&(e in z?gt(t,z[e]):(dr('The "position" parameter is not valid, defaulting to "center"'),gt(t,z.center)))}function AB(t,e){e&&gt(t,z[`grow-${e}`])}var It={innerParams:new WeakMap,domCache:new WeakMap};const HB=["input","file","range","select","radio","checkbox","textarea"],NB=(t,e)=>{const n=st();if(!n)return;const r=It.innerParams.get(t),i=!r||e.input!==r.input;HB.forEach(o=>{const s=Pa(n,z[o]);s&&($B(o,e.inputAttributes),s.className=z[o],i&&Qn(s))}),e.input&&(i&&DB(e),LB(e))},DB=t=>{if(!t.input)return;if(!an[t.input]){yu(`Unexpected type of input! Expected ${Object.keys(an).join(" | ")}, got "${t.input}"`);return}const e=tH(t.input);if(!e)return;const n=an[t.input](e,t);Dn(e),t.inputAutoFocus&&setTimeout(()=>{ZA(n)})},kB=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},$B=(t,e)=>{const n=st();if(!n)return;const r=Sv(n,t);if(r){kB(r);for(const i in e)r.setAttribute(i,e[i])}},LB=t=>{if(!t.input)return;const e=tH(t.input);e&&Qr(e,t,"input")},O0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},Zf=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=z["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&gt(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},tH=t=>{const e=st();if(e)return Pa(e,z[t]||z.input)},iw=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:S0(e)||dr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},an={};an.text=an.email=an.password=an.number=an.tel=an.url=an.search=an.date=an["datetime-local"]=an.time=an.week=an.month=(t,e)=>(iw(t,e.inputValue),Zf(t,t,e),O0(t,e),t.type=e.input,t);an.file=(t,e)=>(Zf(t,t,e),O0(t,e),t);an.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return iw(n,e.inputValue),n.type=e.input,iw(r,e.inputValue),Zf(n,t,e),t};an.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");ti(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return Zf(t,t,e),t};an.radio=t=>(t.textContent="",t);an.checkbox=(t,e)=>{const n=Sv(st(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return ti(r,e.inputPlaceholder||e.inputLabel),n};an.textarea=(t,e)=>{iw(t,e.inputValue),O0(t,e),Zf(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(st()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?st().style.width=`${o}px`:ru(st(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const FB=(t,e)=>{const n=R0();n&&(x0(n),Qr(n,e,"htmlContainer"),e.html?(I0(e.html,n),Dn(n,"block")):e.text?(n.textContent=e.text,Dn(n,"block")):Qn(n),NB(t,e))},VB=(t,e)=>{const n=JA();n&&(x0(n),Jf(n,e.footer,"block"),e.footer&&I0(e.footer,n),Qr(n,e,"footer"))},BB=(t,e)=>{const n=It.innerParams.get(t),r=sh();if(!r)return;if(n&&e.icon===n.icon){mx(r,e),gx(r,e);return}if(!e.icon&&!e.iconHtml){Qn(r);return}if(e.icon&&Object.keys(rw).indexOf(e.icon)===-1){yu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),Qn(r);return}Dn(r),mx(r,e),gx(r,e),gt(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",nH)},gx=(t,e)=>{for(const[n,r]of Object.entries(rw))e.icon!==n&&Ei(t,r);gt(t,e.icon&&rw[e.icon]),UB(t,e),nH(),Qr(t,e,"icon")},nH=()=>{const t=st();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},WB=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,jB=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,mx=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=px(e.iconHtml):e.icon==="success"?(r=WB,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=jB:e.icon&&(r=px({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&ti(t,r)},UB=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])dx(t,n,"background-color",e.iconColor);dx(t,".swal2-success-ring","border-color",e.iconColor)}},px=t=>`<div class="${z["icon-content"]}">${t}</div>`,zB=(t,e)=>{const n=XA();if(n){if(!e.imageUrl){Qn(n);return}Dn(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),ru(n,"width",e.imageWidth),ru(n,"height",e.imageHeight),n.className=z.image,Qr(n,e,"image")}};let A0=!1,rH=0,iH=0,oH=0,sH=0;const YB=t=>{t.addEventListener("mousedown",ow),document.body.addEventListener("mousemove",sw),t.addEventListener("mouseup",aw),t.addEventListener("touchstart",ow),document.body.addEventListener("touchmove",sw),t.addEventListener("touchend",aw)},GB=t=>{t.removeEventListener("mousedown",ow),document.body.removeEventListener("mousemove",sw),t.removeEventListener("mouseup",aw),t.removeEventListener("touchstart",ow),document.body.removeEventListener("touchmove",sw),t.removeEventListener("touchend",aw)},ow=t=>{const e=st();if(t.target===e||sh().contains(t.target)){A0=!0;const n=aH(t);rH=n.clientX,iH=n.clientY,oH=parseInt(e.style.insetInlineStart)||0,sH=parseInt(e.style.insetBlockStart)||0,gt(e,"swal2-dragging")}},sw=t=>{const e=st();if(A0){let{clientX:n,clientY:r}=aH(t);e.style.insetInlineStart=`${oH+(n-rH)}px`,e.style.insetBlockStart=`${sH+(r-iH)}px`}},aw=()=>{const t=st();A0=!1,Ei(t,"swal2-dragging")},aH=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},KB=(t,e)=>{const n=mr(),r=st();if(!(!n||!r)){if(e.toast){ru(n,"width",e.width),r.style.width="100%";const i=lh();i&&r.insertBefore(i,sh())}else ru(r,"width",e.width);ru(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),Qn(yv()),qB(r,e),e.draggable&&!e.toast?(gt(r,z.draggable),YB(r)):(Ei(r,z.draggable),GB(r))}},qB=(t,e)=>{const n=e.showClass||{};t.className=`${z.popup} ${$r(t)?n.popup:""}`,e.toast?(gt([document.documentElement,document.body],z["toast-shown"]),gt(t,z.toast)):gt(t,z.modal),Qr(t,e,"popup"),typeof e.customClass=="string"&&gt(t,e.customClass),e.icon&&gt(t,z[`icon-${e.icon}`])},XB=(t,e)=>{const n=E0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){Qn(n);return}Dn(n),n.textContent="",i>=r.length&&dr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=JB(o);if(n.appendChild(a),s===i&&gt(a,z["active-progress-step"]),s!==r.length-1){const l=ZB(e);n.appendChild(l)}})},JB=t=>{const e=document.createElement("li");return gt(e,z["progress-step"]),ti(e,t),e},ZB=t=>{const e=document.createElement("li");return gt(e,z["progress-step-line"]),t.progressStepsDistance&&ru(e,"width",t.progressStepsDistance),e},QB=(t,e)=>{const n=qA();n&&(x0(n),Jf(n,e.title||e.titleText,"block"),e.title&&I0(e.title,n),e.titleText&&(n.innerText=e.titleText),Qr(n,e,"title"))},lH=(t,e)=>{KB(t,e),PB(t,e),XB(t,e),BB(t,e),zB(t,e),QB(t,e),xB(t,e),FB(t,e),TB(t,e),VB(t,e);const n=st();typeof e.didRender=="function"&&n&&e.didRender(n),Re.eventEmitter.emit("didRender",n)},eW=()=>$r(st()),uH=()=>{var t;return(t=Ko())===null||t===void 0?void 0:t.click()},tW=()=>{var t;return(t=Cu())===null||t===void 0?void 0:t.click()},nW=()=>{var t;return(t=ah())===null||t===void 0?void 0:t.click()},uh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),cH=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},rW=(t,e,n)=>{cH(t),e.toast||(t.keydownHandler=r=>oW(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:st(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},BS=(t,e)=>{var n;const r=M0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=st())===null||n===void 0||n.focus()},hH=["ArrowRight","ArrowDown"],iW=["ArrowLeft","ArrowUp"],oW=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?sW(e,t):e.key==="Tab"?aW(e):[...hH,...iW].includes(e.key)?lW(e.key):e.key==="Escape"&&uW(e,t,n)))},sW=(t,e)=>{if(!vv(e.allowEnterKey))return;const n=Sv(st(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;uH(),t.preventDefault()}},aW=t=>{const e=t.target,n=M0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?BS(r,-1):BS(r,1),t.stopPropagation(),t.preventDefault()},lW=t=>{const e=Xf(),n=Ko(),r=Cu(),i=ah();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=hH.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&$r(a))break}a instanceof HTMLButtonElement&&a.focus()}},uW=(t,e,n)=>{vv(e.allowEscapeKey)&&(t.preventDefault(),n(uh.esc))};var qc={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const cW=()=>{const t=mr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},dH=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},fH=typeof window<"u"&&!!window.GestureEvent,hW=()=>{if(fH&&!Vs(document.body,z.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,gt(document.body,z.iosfix),dW()}},dW=()=>{const t=mr();if(!t)return;let e;t.ontouchstart=n=>{e=fW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},fW=t=>{const e=t.target,n=mr(),r=R0();return!n||!r||gW(t)||mW(t)?!1:e===n||!fx(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(fx(r)&&r.contains(e))},gW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",mW=t=>t.touches&&t.touches.length>1,pW=()=>{if(Vs(document.body,z.iosfix)){const t=parseInt(document.body.style.top,10);Ei(document.body,z.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},wW=()=>{const t=document.createElement("div");t.className=z["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let $c=null;const vW=t=>{$c===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&($c=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${$c+wW()}px`)},yW=()=>{$c!==null&&(document.body.style.paddingRight=`${$c}px`,$c=null)};function gH(t,e,n,r){bv()?wx(t,r):(iB(n).then(()=>wx(t,r)),cH(Re)),fH?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),_0()&&(yW(),pW(),dH()),CW()}function CW(){Ei([document.documentElement,document.body],[z.shown,z["height-auto"],z["no-backdrop"],z["toast-shown"]])}function Ia(t){t=SW(t);const e=qc.swalPromiseResolve.get(this),n=bW(this);this.isAwaitingPromise?t.isDismissed||(Qf(this),e(t)):n&&e(t)}const bW=t=>{const e=st();if(!e)return!1;const n=It.innerParams.get(t);if(!n||Vs(e,n.hideClass.popup))return!1;Ei(e,n.showClass.popup),gt(e,n.hideClass.popup);const r=mr();return Ei(r,n.showClass.backdrop),gt(r,n.hideClass.backdrop),RW(t,e,n),!0};function mH(t){const e=qc.swalPromiseReject.get(this);Qf(this),e&&e(t)}const Qf=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,It.innerParams.get(t)||t._destroy())},SW=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),RW=(t,e,n)=>{var r;const i=mr(),o=eH(e);typeof n.willClose=="function"&&n.willClose(e),(r=Re.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?EW(t,e,i,n.returnFocus,n.didClose):gH(t,i,n.returnFocus,n.didClose)},EW=(t,e,n,r,i)=>{Re.swalCloseEventFinishedCallback=gH.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Re.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Re),delete Re.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},wx=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Re.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Xc=t=>{let e=st();if(e||new bi,e=st(),!e)return;const n=lh();bv()?Qn(sh()):TW(e,t),Dn(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},TW=(t,e)=>{const n=Xf(),r=lh();!n||!r||(!e&&$r(Ko())&&(e=Ko()),Dn(n),e&&(Qn(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),gt([t,n],z.loading))},MW=(t,e)=>{e.input==="select"||e.input==="radio"?OW(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(b0(e.inputValue)||S0(e.inputValue))&&(Xc(Ko()),AW(t,e))},_W=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return xW(n);case"radio":return PW(n);case"file":return IW(n);default:return e.inputAutoTrim?n.value.trim():n.value}},xW=t=>t.checked?1:0,PW=t=>t.checked?t.value:null,IW=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,OW=(t,e)=>{const n=st();if(!n)return;const r=i=>{e.input==="select"?HW(n,lw(i),e):e.input==="radio"&&NW(n,lw(i),e)};b0(e.inputOptions)||S0(e.inputOptions)?(Xc(Ko()),Kf(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):yu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},AW=(t,e)=>{const n=t.getInput();n&&(Qn(n),Kf(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,Dn(n),n.focus(),t.hideLoading()}).catch(r=>{yu(`Error in inputValue promise: ${r}`),n.value="",Dn(n),n.focus(),t.hideLoading()}))};function HW(t,e,n){const r=Pa(t,z.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,ti(l,s),l.selected=pH(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function NW(t,e,n){const r=Pa(t,z.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=z.radio,l.value=s,pH(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");ti(c,a),c.className=z.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const lw=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=lw(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=lw(r)),e.push([n,r])}),e},pH=(t,e)=>!!e&&e.toString()===t.toString(),DW=t=>{const e=It.innerParams.get(t);t.disableButtons(),e.input?wH(t,"confirm"):N0(t,!0)},kW=t=>{const e=It.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?wH(t,"deny"):H0(t,!1)},$W=(t,e)=>{t.disableButtons(),e(uh.cancel)},wH=(t,e)=>{const n=It.innerParams.get(t);if(!n.input){yu(`The "input" parameter is needed to be set when using returnInputValueOn${C0(e)}`);return}const r=t.getInput(),i=_W(t,n);n.inputValidator?LW(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?H0(t,i):N0(t,i)},LW=(t,e,n)=>{const r=It.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Kf(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?H0(t,e):N0(t,e)})},H0=(t,e)=>{const n=It.innerParams.get(t||void 0);n.showLoaderOnDeny&&Xc(Cu()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Kf(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),Qf(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>vH(t||void 0,i))):t.close({isDenied:!0,value:e})},vx=(t,e)=>{t.close({isConfirmed:!0,value:e})},vH=(t,e)=>{t.rejectPromise(e)},N0=(t,e)=>{const n=It.innerParams.get(t||void 0);n.showLoaderOnConfirm&&Xc(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Kf(n.preConfirm(e,n.validationMessage))).then(i=>{$r(yv())||i===!1?(t.hideLoading(),Qf(t)):vx(t,typeof i>"u"?e:i)}).catch(i=>vH(t||void 0,i))):vx(t,e)};function uw(){const t=It.innerParams.get(this);if(!t)return;const e=It.domCache.get(this);Qn(e.loader),bv()?t.icon&&Dn(sh()):FW(e),Ei([e.popup,e.actions],z.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const FW=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?Dn(e[0],"inline-block"):fB()&&Qn(t.actions)};function yH(){const t=It.innerParams.get(this),e=It.domCache.get(this);return e?Sv(e.popup,t.input):null}function CH(t,e,n){const r=It.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function bH(t,e){const n=st();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${z.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function SH(){CH(this,["confirmButton","denyButton","cancelButton"],!1)}function RH(){CH(this,["confirmButton","denyButton","cancelButton"],!0)}function EH(){bH(this.getInput(),!1)}function TH(){bH(this.getInput(),!0)}function MH(t){const e=It.domCache.get(this),n=It.innerParams.get(this);ti(e.validationMessage,t),e.validationMessage.className=z["validation-message"],n.customClass&&n.customClass.validationMessage&&gt(e.validationMessage,n.customClass.validationMessage),Dn(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",z["validation-message"]),ZA(r),gt(r,z.inputerror))}function _H(){const t=It.domCache.get(this);t.validationMessage&&Qn(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Ei(e,z.inputerror))}const Lc={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},VW=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],BW={allowEnterKey:void 0},WW=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],xH=t=>Object.prototype.hasOwnProperty.call(Lc,t),PH=t=>VW.indexOf(t)!==-1,IH=t=>BW[t],jW=t=>{xH(t)||dr(`Unknown parameter "${t}"`)},UW=t=>{WW.includes(t)&&dr(`The parameter "${t}" is incompatible with toasts`)},zW=t=>{const e=IH(t);e&&KA(t,e)},OH=t=>{t.backdrop===!1&&t.allowOutsideClick&&dr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&dr(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)jW(e),t.toast&&UW(e),zW(e)};function AH(t){const e=mr(),n=st(),r=It.innerParams.get(this);if(!n||Vs(n,r.hideClass.popup)){dr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=YW(t),o=Object.assign({},r,i);OH(o),e.dataset.swal2Theme=o.theme,lH(this,o),It.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const YW=t=>{const e={};return Object.keys(t).forEach(n=>{PH(n)?e[n]=t[n]:dr(`Invalid parameter to update: ${n}`)}),e};function HH(){const t=It.domCache.get(this),e=It.innerParams.get(this);if(!e){NH(this);return}t.popup&&Re.swalCloseEventFinishedCallback&&(Re.swalCloseEventFinishedCallback(),delete Re.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Re.eventEmitter.emit("didDestroy"),GW(this)}const GW=t=>{NH(t),delete t.params,delete Re.keydownHandler,delete Re.keydownTarget,delete Re.currentInstance},NH=t=>{t.isAwaitingPromise?(Oy(It,t),t.isAwaitingPromise=!0):(Oy(qc,t),Oy(It,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},Oy=(t,e)=>{for(const n in t)t[n].delete(e)};var KW=Object.freeze({__proto__:null,_destroy:HH,close:Ia,closeModal:Ia,closePopup:Ia,closeToast:Ia,disableButtons:RH,disableInput:TH,disableLoading:uw,enableButtons:SH,enableInput:EH,getInput:yH,handleAwaitingPromise:Qf,hideLoading:uw,rejectPromise:mH,resetValidationMessage:_H,showValidationMessage:MH,update:AH});const qW=(t,e,n)=>{t.toast?XW(t,e,n):(ZW(e),QW(e),e2(t,e,n))},XW=(t,e,n)=>{e.popup.onclick=()=>{t&&(JW(t)||t.timer||t.input)||n(uh.close)}},JW=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let cw=!1;const ZW=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(cw=!0)}}},QW=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(cw=!0)}}},e2=(t,e,n)=>{e.container.onclick=r=>{if(cw){cw=!1;return}r.target===e.container&&vv(t.allowOutsideClick)&&n(uh.backdrop)}},t2=t=>typeof t=="object"&&t.jquery,yx=t=>t instanceof Element||t2(t),n2=t=>{const e={};return typeof t[0]=="object"&&!yx(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||yx(i)?e[n]=i:i!==void 0&&yu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function r2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function i2(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const o2=()=>Re.timeout&&Re.timeout.getTimerLeft(),DH=()=>{if(Re.timeout)return gB(),Re.timeout.stop()},kH=()=>{if(Re.timeout){const t=Re.timeout.start();return P0(t),t}},s2=()=>{const t=Re.timeout;return t&&(t.running?DH():kH())},a2=t=>{if(Re.timeout){const e=Re.timeout.increase(t);return P0(e,!0),e}},l2=()=>!!(Re.timeout&&Re.timeout.isRunning());let Cx=!1;const WS={};function u2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";WS[t]=this,Cx||(document.body.addEventListener("click",c2),Cx=!0)}const c2=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in WS){const r=e.getAttribute(n);if(r){WS[n].fire({template:r});return}}};class h2{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Re.eventEmitter=new h2;const d2=(t,e)=>{Re.eventEmitter.on(t,e)},f2=(t,e)=>{Re.eventEmitter.once(t,e)},g2=(t,e)=>{if(!t){Re.eventEmitter.reset();return}e?Re.eventEmitter.removeListener(t,e):Re.eventEmitter.removeAllListeners(t)};var m2=Object.freeze({__proto__:null,argsToParams:n2,bindClickHandler:u2,clickCancel:nW,clickConfirm:uH,clickDeny:tW,enableLoading:Xc,fire:r2,getActions:Xf,getCancelButton:ah,getCloseButton:T0,getConfirmButton:Ko,getContainer:mr,getDenyButton:Cu,getFocusableElements:M0,getFooter:JA,getHtmlContainer:R0,getIcon:sh,getIconContent:lB,getImage:XA,getInputLabel:uB,getLoader:lh,getPopup:st,getProgressSteps:E0,getTimerLeft:o2,getTimerProgressBar:Cv,getTitle:qA,getValidationMessage:yv,increaseTimer:a2,isDeprecatedParameter:IH,isLoading:hB,isTimerRunning:l2,isUpdatableParameter:PH,isValidParameter:xH,isVisible:eW,mixin:i2,off:g2,on:d2,once:f2,resumeTimer:kH,showLoading:Xc,stopTimer:DH,toggleTimer:s2});class p2{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const $H=["swal-title","swal-html","swal-footer"],w2=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return T2(n),Object.assign(v2(n),y2(n),C2(n),b2(n),S2(n),R2(n),E2(n,$H))},v2=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{lu(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof Lc[i]=="boolean"?e[i]=o!=="false":typeof Lc[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},y2=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},C2=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{lu(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${C0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},b2=t=>{const e={},n=t.querySelector("swal-image");return n&&(lu(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},S2=t=>{const e={},n=t.querySelector("swal-icon");return n&&(lu(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},R2=t=>{const e={},n=t.querySelector("swal-input");n&&(lu(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{lu(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},E2=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(lu(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},T2=t=>{const e=$H.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||dr(`Unrecognized element <${r}>`)})},lu=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&dr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},LH=10,M2=t=>{const e=mr(),n=st();typeof t.willOpen=="function"&&t.willOpen(n),Re.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;P2(e,n,t),setTimeout(()=>{_2(e,n)},LH),_0()&&(x2(e,t.scrollbarPadding,i),cW()),!bv()&&!Re.previousActiveElement&&(Re.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Re.eventEmitter.emit("didOpen",n),Ei(e,z["no-transition"])},hw=t=>{const e=st();if(t.target!==e)return;const n=mr();e.removeEventListener("animationend",hw),e.removeEventListener("transitionend",hw),n.style.overflowY="auto"},_2=(t,e)=>{eH(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",hw),e.addEventListener("transitionend",hw)):t.style.overflowY="auto"},x2=(t,e,n)=>{hW(),e&&n!=="hidden"&&vW(n),setTimeout(()=>{t.scrollTop=0})},P2=(t,e,n)=>{gt(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),Dn(e,"grid"),setTimeout(()=>{gt(e,n.showClass.popup),e.style.removeProperty("opacity")},LH)):Dn(e,"grid"),gt([document.documentElement,document.body],z.shown),n.heightAuto&&n.backdrop&&!n.toast&&gt([document.documentElement,document.body],z["height-auto"])};var bx={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function I2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=bx.email),t.input==="url"&&(t.inputValidator=bx.url))}function O2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(dr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function A2(t){I2(t),t.showLoaderOnConfirm&&!t.preConfirm&&dr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),O2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),SB(t)}let ko;var Ng=new WeakMap;class fn{constructor(){if(eB(this,Ng,void 0),typeof window>"u")return;ko=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,tB(Ng,this,this._main(ko.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(OH(Object.assign({},n,e)),Re.currentInstance){const o=qc.swalPromiseResolve.get(Re.currentInstance),{isAwaitingPromise:s}=Re.currentInstance;Re.currentInstance._destroy(),s||o({isDismissed:!0}),_0()&&dH()}Re.currentInstance=ko;const r=N2(e,n);A2(r),Object.freeze(r),Re.timeout&&(Re.timeout.stop(),delete Re.timeout),clearTimeout(Re.restoreFocusTimeout);const i=D2(ko);return lH(ko,r),It.innerParams.set(ko,r),H2(ko,i,r)}then(e){return cx(Ng,this).then(e)}finally(e){return cx(Ng,this).finally(e)}}const H2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};qc.swalPromiseResolve.set(t,r),qc.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{DW(t)},e.denyButton.onclick=()=>{kW(t)},e.cancelButton.onclick=()=>{$W(t,o)},e.closeButton.onclick=()=>{o(uh.close)},qW(n,e,o),rW(Re,n,o),MW(t,n),M2(n),k2(Re,n,o),$2(e,n),setTimeout(()=>{e.container.scrollTop=0})}),N2=(t,e)=>{const n=w2(t),r=Object.assign({},Lc,e,n,t);return r.showClass=Object.assign({},Lc.showClass,r.showClass),r.hideClass=Object.assign({},Lc.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},D2=t=>{const e={popup:st(),container:mr(),actions:Xf(),confirmButton:Ko(),denyButton:Cu(),cancelButton:ah(),loader:lh(),closeButton:T0(),validationMessage:yv(),progressSteps:E0()};return It.domCache.set(t,e),e},k2=(t,e,n)=>{const r=Cv();Qn(r),e.timer&&(t.timeout=new p2(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(Dn(r),Qr(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&P0(e.timer)})))},$2=(t,e)=>{if(!e.toast){if(!vv(e.allowEnterKey)){KA("allowEnterKey"),V2();return}L2(t)||F2(t,e)||BS(-1,1)}},L2=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&$r(n))return n.focus(),!0;return!1},F2=(t,e)=>e.focusDeny&&$r(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&$r(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&$r(t.confirmButton)?(t.confirmButton.focus(),!0):!1,V2=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}fn.prototype.disableButtons=RH;fn.prototype.enableButtons=SH;fn.prototype.getInput=yH;fn.prototype.disableInput=TH;fn.prototype.enableInput=EH;fn.prototype.hideLoading=uw;fn.prototype.disableLoading=uw;fn.prototype.showValidationMessage=MH;fn.prototype.resetValidationMessage=_H;fn.prototype.close=Ia;fn.prototype.closePopup=Ia;fn.prototype.closeModal=Ia;fn.prototype.closeToast=Ia;fn.prototype.rejectPromise=mH;fn.prototype.update=AH;fn.prototype._destroy=HH;Object.assign(fn,m2);Object.keys(KW).forEach(t=>{fn[t]=function(){return ko&&ko[t]?ko[t](...arguments):null}});fn.DismissReason=uh;fn.version="11.21.0";const bi=fn;bi.default=bi;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var Gs=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(x){if(x=o.postProcess(x,r),i){setTimeout(function(){i(x)},0);return}else return x},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],w=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&w+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var C=-1/0,R=1/0,y=function(){for(var x=Math.max(C,-c);x<=Math.min(R,c);x+=2){var _=void 0,T=g[x-1],I=g[x+1];T&&(g[x-1]=void 0);var Y=!1;if(I){var U=I.oldPos-x;Y=I&&0<=U&&U<l}var V=T&&T.oldPos+1<u;if(!Y&&!V){g[x]=void 0;continue}if(!V||Y&&T.oldPos<I.oldPos?_=o.addToPath(I,!0,!1,0,r):_=o.addToPath(T,!1,!0,1,r),w=o.extractCommon(_,n,e,x,r),_.oldPos+1>=u&&w+1>=l)return a(o.buildValues(_.lastComponent,n,e))||!0;g[x]=_,_.oldPos+1>=u&&(R=Math.min(R,x-1)),w+1>=l&&(C=Math.max(C,x+1))}c++};if(i)(function x(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);y()||x()},0)})();else for(;c<=h&&Date.now()<=f;){var M=y();if(M)return M}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),B2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),W2=function(t){B2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Gs),FH=new W2;function j2(t,e,n){return FH.diff(t,e,n)}function Sx(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function Rx(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function jS(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function US(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function xh(t,e){return jS(t,e,"")}function Dg(t,e){return US(t,e,"")}function Ex(t,e){return e.slice(0,U2(t,e))}function U2(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function z2(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function Y2(t){return!t.includes(`\r
`)&&t.includes(`
`)}function Ph(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function ea(t){var e=t.match(/^\s*/);return e?e[0]:""}var VH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),dw="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",G2=new RegExp("[".concat(dw,"]+|\\s+|[^").concat(dw,"]"),"ug"),K2=function(t){VH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(G2)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&Tx(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&Tx(i,s,o,null),n},e}(Gs),BH=new K2;function q2(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?jH(t,e,n):BH.diff(t,e,n)}function Tx(t,e,n,r){if(e&&n){var i=ea(e.value),o=Ph(e.value),s=ea(n.value),a=Ph(n.value);if(t){var l=Sx(i,s);t.value=US(t.value,s,l),e.value=xh(e.value,l),n.value=xh(n.value,l)}if(r){var u=Rx(o,a);r.value=jS(r.value,a,u),e.value=Dg(e.value,u),n.value=Dg(n.value,u)}}else if(n){if(t){var c=ea(n.value);n.value=n.value.substring(c.length)}if(r){var c=ea(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=ea(r.value),d=ea(e.value),f=Ph(e.value),g=Sx(h,d);e.value=xh(e.value,g);var w=Rx(xh(h,g),f);e.value=Dg(e.value,w),r.value=jS(r.value,h,w),t.value=US(t.value,h,h.slice(0,h.length-w.length))}else if(r){var C=ea(r.value),R=Ph(e.value),y=Ex(R,C);e.value=Dg(e.value,y)}else if(t){var M=Ph(t.value),x=ea(e.value),y=Ex(M,x);e.value=xh(e.value,y)}}var X2=function(t){VH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(dw,"]+|[^\\S\\n\\r]+|[^").concat(dw,"]"),"ug");return n.match(r)||[]},e}(Gs),WH=new X2;function jH(t,e,n){return WH.diff(t,e,n)}function J2(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var Z2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Q2=function(t){Z2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=UH,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}(Gs),D0=new Q2;function bf(t,e,n){return D0.diff(t,e,n)}function ej(t,e,n){return n=J2(n,{ignoreWhitespace:!0}),D0.diff(t,e,n)}function UH(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var tj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),nj=function(t){tj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}(Gs),zH=new nj;function rj(t,e,n){return zH.diff(t,e,n)}var ij=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),oj=function(t){ij(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}(Gs),YH=new oj;function sj(t,e,n){return YH.diff(t,e,n)}var aj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),lj=function(t){aj(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=UH,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(fw(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}(Gs),GH=new lj;function uj(t,e,n){return GH.diff(t,e,n)}function fw(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=fw(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=fw(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var cj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),hj=function(t){cj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}(Gs),KH=new hj;function dj(t,e,n){return KH.diff(t,e,n)}var jo=function(){return jo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},jo.apply(this,arguments)};function qH(t){return Array.isArray(t)?t.map(function(e){return qH(e)}):jo(jo({},t),{hunks:t.hunks.map(function(e){return jo(jo({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function XH(t){return Array.isArray(t)?t.map(function(e){return XH(e)}):jo(jo({},t),{hunks:t.hunks.map(function(e){return jo(jo({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function fj(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function gj(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function k0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function mj(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function JH(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=k0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return pj(t,r[0],n)}function pj(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(z2(t)&&fj(e)?e=qH(e):Y2(t)&&gj(e)&&(e=XH(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(Y,U,V,q){return U===q},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(Y,U,V,q,ee,Q,ne){q===void 0&&(q=0),ee===void 0&&(ee=!0),Q===void 0&&(Q=[]),ne===void 0&&(ne=0);for(var pe=0,it=!1;q<Y.length;q++){var Ee=Y[q],Ae=Ee.length>0?Ee[0]:" ",ut=Ee.length>0?Ee.substr(1):Ee;if(Ae==="-")if(o(U+1,r[U],Ae,ut))U++,pe=0;else return!V||r[U]==null?null:(Q[ne]=r[U],f(Y,U+1,V-1,q,!1,Q,ne+1));if(Ae==="+"){if(!ee)return null;Q[ne]=ut,ne++,pe=0,it=!0}if(Ae===" ")if(pe++,Q[ne]=r[U],o(U+1,r[U],Ae,ut))ne++,ee=!0,it=!1,U++;else return it||!V?null:r[U]&&(f(Y,U+1,V-1,q+1,!1,Q,ne+1)||f(Y,U+1,V-1,q,!1,Q,ne+1))||f(Y,U,V-1,q+1,!1,Q,ne)}return ne-=pe,U-=pe,Q.length=ne,{patchedLines:Q,oldLineLastI:U-1}}for(var g=[],w=0,h=0;h<i.length;h++){for(var C=i[h],R=void 0,y=r.length-C.oldLines+s,M=void 0,x=0;x<=s;x++){M=C.oldStart+w-1;for(var _=mj(M,a,y);M!==void 0&&(R=f(C.lines,M,x),!R);M=_());if(R)break}if(!R)return!1;for(var T=a;T<M;T++)g.push(r[T]);for(var I=0;I<R.patchedLines.length;I++){var d=R.patchedLines[I];g.push(d)}a=R.oldLineLastI+1,w=M+1-C.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function wj(t,e){var n=typeof t=="string"?k0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=JH(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var gw=function(){return gw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},gw.apply(this,arguments)};function ZH(t){return Array.isArray(t)?t.map(function(e){return ZH(e)}).reverse():gw(gw({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var Jc=function(){return Jc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Jc.apply(this,arguments)};function zS(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;bf(n,r,Jc(Jc({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(bf(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(Ae){return Ae.map(function(ut){return" "+ut})}for(var f=[],g=0,w=0,C=[],R=1,y=1,M=0;M<h.length;M++){var x=h[M],_=x.lines||yj(x.value);if(x.lines=_,x.added||x.removed){if(!g){var T=h[M-1];g=R,w=y,T&&(C=l>0?d(T.lines.slice(-l)):[],g-=C.length,w-=C.length)}for(var I=0,Y=_;I<Y.length;I++){var U=Y[I];C.push((x.added?"+":"-")+U)}x.added?y+=_.length:R+=_.length}else{if(g)if(_.length<=l*2&&M<h.length-2)for(var V=0,q=d(_);V<q.length;V++){var U=q[V];C.push(U)}else{for(var ee=Math.min(_.length,l),Q=0,ne=d(_.slice(0,ee));Q<ne.length;Q++){var U=ne[Q];C.push(U)}var pe={oldStart:g,oldLines:R-g+ee,newStart:w,newLines:y-w+ee,lines:C};f.push(pe),g=0,w=0,C=[]}R+=_.length,y+=_.length}}for(var it=0,Ee=f;it<Ee.length;it++)for(var pe=Ee[it],M=0;M<pe.lines.length;M++)pe.lines[M].endsWith(`
`)?pe.lines[M]=pe.lines[M].slice(0,-1):(pe.lines.splice(M+1,0,"\\ No newline at end of file"),M++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function mw(t){if(Array.isArray(t))return t.map(mw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function QH(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;zS(t,e,n,r,i,o,Jc(Jc({},s),{callback:function(u){l(u?mw(u):void 0)}}))}else{var a=zS(t,e,n,r,i,o,s);return a?mw(a):void 0}}function vj(t,e,n,r,i,o){return QH(t,t,e,n,r,i,o)}function yj(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function Cj(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function bj(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(Sj(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function Sj(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const Rj=Object.freeze(Object.defineProperty({__proto__:null,Diff:Gs,applyPatch:JH,applyPatches:wj,arrayDiff:KH,canonicalize:fw,characterDiff:FH,convertChangesToDMP:Cj,convertChangesToXML:bj,createPatch:vj,createTwoFilesPatch:QH,cssDiff:YH,diffArrays:dj,diffChars:j2,diffCss:sj,diffJson:uj,diffLines:bf,diffSentences:rj,diffTrimmedLines:ej,diffWords:q2,diffWordsWithSpace:jH,formatPatch:mw,jsonDiff:GH,lineDiff:D0,parsePatch:k0,reversePatch:ZH,sentenceDiff:zH,structuredPatch:zS,wordDiff:BH,wordsWithSpaceDiff:WH},Symbol.toStringTag,{value:"Module"}));function Ej(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[],hotInstance:i}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();let o="",s="",a=[];const l=(h,d=2)=>{const f=g=>{if(typeof g!="object"||g===null)return g;if(Array.isArray(g))return g.map(f);const w={};return Object.keys(g).forEach(C=>{w[C]=f(g[C])}),w};try{return JSON.stringify(f(h),null,d)}catch(g){return console.error("Error stringifying object while preserving key order:",g),JSON.stringify(h,null,d)}};function u(h){return h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}if(n&&n.left!==void 0&&n.right!==void 0)if(typeof Rj>"u"||typeof bf!="function")s='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다. (Diff is not defined)</p>',o='<div class="diff-popup-header error">라이브러리 오류</div>';else try{const h=l(n.left),d=l(n.right),f=bf(h,d);let g=0,w=0;f.forEach(V=>{const q=V.value||"",ee=q.split(`
`);let Q=ee.length;ee[ee.length-1]===""&&q.length>0&&Q--,q===""&&(Q=0),V.added?g+=Q:V.removed&&(w+=Q)});const C=[];let R=1,y=1;f.forEach((V,q)=>{const ee=V.value||"",Q=ee.split(`
`);let ne=Q.length;Q[Q.length-1]===""&&ee.length>0&&ne--,ee===""&&(ne=0),V.removed?(C.push({originalPartIndex:q,part:V,sourceType:"del",lineNumber:R,numLines:ne}),R+=ne):V.added?(C.push({originalPartIndex:q,part:V,sourceType:"ins",lineNumber:y,numLines:ne}),y+=ne):(R+=ne,y+=ne)}),a=[];let M=[...C],x=null;for(M.length>0&&(M.sort((V,q)=>V.lineNumber!==q.lineNumber?V.lineNumber-q.lineNumber:V.sourceType==="del"&&q.sourceType!=="del"?-1:V.sourceType!=="del"&&q.sourceType==="del"?1:V.originalPartIndex-q.originalPartIndex),x=M[0],a.push(x),M=M.filter(V=>V.originalPartIndex!==x.originalPartIndex));M.length>0&&x;){const V=x.lineNumber;let q=null,ee=[];for(const Q of M)Q.lineNumber>=V&&ee.push({...Q,diff:Q.lineNumber-V});if(ee.length>0)ee.sort((Q,ne)=>Q.diff!==ne.diff?Q.diff-ne.diff:Q.sourceType==="del"&&ne.sourceType!=="del"?-1:Q.sourceType!=="del"&&ne.sourceType==="del"?1:Q.originalPartIndex-ne.originalPartIndex),q=ee[0];else{let Q=[];for(const ne of M)Q.push({...ne,absDiff:Math.abs(ne.lineNumber-V)});Q.length>0&&(Q.sort((ne,pe)=>ne.absDiff!==pe.absDiff?ne.absDiff-pe.absDiff:ne.lineNumber!==pe.lineNumber?ne.lineNumber-pe.lineNumber:ne.sourceType==="del"&&pe.sourceType!=="del"?-1:ne.sourceType!=="del"&&pe.sourceType==="del"?1:ne.originalPartIndex-pe.originalPartIndex),q=Q[0])}if(q)a.push(q),x=q,M=M.filter(Q=>Q.originalPartIndex!==q.originalPartIndex);else break}let _="",T="",I=1,Y=1;const U=new Map;if(a.forEach((V,q)=>U.set(V.originalPartIndex,q)),f.forEach((V,q)=>{const ee=V.value||"",Q=ee.replace(/\n$/,"").split(`
`);Q.length===1&&Q[0]===""&&ee===""||Q.forEach((ne,pe)=>{let it="";(V.added||V.removed)&&pe===0&&U.has(q)&&(it=`id="diff-nav-target-${U.get(q)}"`),V.added?(_+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,T+=`<div ${it} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${Y++}</span><span class="diff-sbs-line-content">${u(ne)}</span></div>
`):V.removed?(_+=`<div ${it} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${I++}</span><span class="diff-sbs-line-content">${u(ne)}</span></div>
`,T+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(_+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${I++}</span><span class="diff-sbs-line-content">${u(ne)}</span></div>
`,T+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${Y++}</span><span class="diff-sbs-line-content">${u(ne)}</span></div>
`)})}),s=`<div class="diff-sbs-container"><div class="diff-sbs-pane" id="diff-left-pane">${_}</div><div class="diff-sbs-pane" id="diff-right-pane">${T}</div></div>`,a.length>0||g>0||w>0){let V="";(g>0||w>0)&&(V=`<span class="diff-summary"><strong class="diff-summary-added">+${g}</strong> <strong class="diff-summary-removed">-${w}</strong></span>`),o=`<div class="diff-popup-header">JSON 비교 결과</div><div id="diff-navigation">${V}<button id="prev-change-btn" class="swal2-styled">이전 변경점</button><button id="next-change-btn" class="swal2-styled">다음 변경점</button><span id="current-change-info"></span></div>`}else o='<div class="diff-popup-header">JSON 비교 결과</div>',h===d?s='<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':s='<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>'}catch(h){s=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${h.message}</p>`,o='<div class="diff-popup-header error">오류 발생</div>'}else s='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',o='<div class="diff-popup-header error">데이터 오류</div>';const c=`${o}<div id="diff-container">${s}</div>`;return eN({title:e,html:c,buttons:r,width:"95%",customClass:{popup:"custom-swal-popup-wider-text-diff",htmlContainer:"custom-swal-html-container-text-diff"},didOpen:h=>{const d=[];if(a&&a.length>0)for(let _=0;_<a.length;_++){const T=document.getElementById(`diff-nav-target-${_}`);T&&d.push(T)}let f=-1,g=null;const w=document.getElementById("diff-navigation"),C=document.getElementById("next-change-btn"),R=document.getElementById("prev-change-btn"),y=document.getElementById("current-change-info");function M(){if(!w)return;const _=d.length===0;C&&(C.style.display=_?"none":"inline-block"),R&&(R.style.display=_?"none":"inline-block"),y&&(y.textContent=_?totalAdded>0||totalRemoved>0?"0 / 0":"변경점 없음":`${f+1} / ${d.length}`),C&&(C.disabled=f>=d.length-1),R&&(R.disabled=f<=0)}function x(_){if(_<0||_>=d.length)return;g&&g.classList.remove("diff-navigation-highlight");const T=d[_];if(T){const I=document.getElementById("diff-container");if(I){const Y=T.offsetTop;I.scrollTop=Y-I.clientHeight/2+T.clientHeight/2}else T.scrollIntoView({block:"center"});T.classList.add("diff-navigation-highlight"),g=T}f=_,M()}d.length>0?x(0):M(),C&&C.addEventListener("click",()=>{f<d.length-1&&x(f+1)}),R&&R.addEventListener("click",()=>{f>0&&x(f-1)}),h.addEventListener("keydown",_=>{d.length===0||!C||!R||(_.key==="ArrowDown"||_.key==="PageDown"?(_.preventDefault(),C.disabled||C.click()):(_.key==="ArrowUp"||_.key==="PageUp")&&(_.preventDefault(),R.disabled||R.click()))}),M()}})}async function Ps(t){const{title:e,inputLabel:n,inputValue:r="",inputPlaceholder:i="",inputValidator:o,confirmButtonText:s="확인",cancelButtonText:a="취소",showCancelButton:l=!0,customClass:u={},html:c,hotInstance:h}=t;h&&typeof h.deselectCell=="function"&&h.deselectCell();let d=c||"";return n&&!c&&(d=`<label style="display: block; text-align: left; margin-bottom: .5em; font-weight: normal;">${n}</label>`),bi.fire({title:e,html:d,input:"text",inputValue:r,inputPlaceholder:i,inputValidator:o,showCancelButton:l,confirmButtonText:s,cancelButtonText:a,customClass:u,didOpen:()=>{const f=bi.getInput();f&&(f.focus(),typeof f.select=="function"&&f.select())}})}async function Ve(t){const{title:e,text:n="",html:r="",icon:i="warning",confirmButtonText:o="확인",cancelButtonText:s="취소",showCancelButton:a=!0,customClass:l={},hotInstance:u}=t;return u&&typeof u.deselectCell=="function"&&u.deselectCell(),bi.fire({title:e,text:n,html:r,icon:i,showCancelButton:a,confirmButtonText:o,cancelButtonText:s,customClass:l})}async function Mx(t){const{title:e="URL 작업",initialInputValue:n="",inputLabel:r="입력:",outputLabel:i="결과:",actionButtonText:o="실행",confirmButtonText:s="결과를 메인 편집기에 복사",cancelButtonText:a="팝업 닫기",onExecuteAction:l,hotInstance:u}=t,c=Date.now(),h=`popup-url-input-${c}`,d=`popup-url-output-${c}`,f=`popup-execute-action-${c}`,g=`popup-url-validation-${c}`,w=`
        <div style="text-align: left; display: flex; flex-direction: column; gap: 0.8em;">
            <div>
                <label for="${h}" style="display: block; margin-bottom: .3em; font-weight: normal;">${r}</label>
                <textarea id="${h}" class="swal2-textarea" style="width: 98%; min-height: 80px; box-sizing: border-box;" placeholder="여기에 문자열을 입력하세요...">${n}</textarea>
            </div>
            <div style="text-align: center;">
                <button type="button" id="${f}" class="swal2-styled" style="padding: 0.5em 1em; margin-top: 0.5em; margin-bottom: 0.5em;">${o}</button>
            </div>
            <div>
                <label for="${d}" style="display: block; margin-bottom: .3em; font-weight: normal;">${i}</label>
                <textarea id="${d}" class="swal2-textarea" style="width: 98%; min-height: 80px; box-sizing: border-box;" readonly placeholder="결과가 여기에 표시됩니다..."></textarea>
            </div>
            <div id="${g}" style="color: red; text-align: center; min-height: 1.2em; margin-top: .5em; font-size: 0.9em;"></div>
        </div>
    `;return eN({title:e,html:w,width:"50em",padding:"1em",customClass:{popup:"custom-swal-popup-wider-text-diff",htmlContainer:"custom-swal-html-container-url-ops"},buttons:[{text:s,role:"confirm"},{text:a,role:"cancel"}],didOpen:C=>{const R=C.querySelector(`#${h}`),y=C.querySelector(`#${d}`),M=C.querySelector(`#${f}`),x=C.querySelector(`#${g}`);R&&R.focus(),M&&R&&y&&x&&M.addEventListener("click",()=>{const _=R.value;if(x.textContent="",_.trim()===""){y.value="",x.textContent="입력값이 비어있습니다.";return}if(typeof l=="function")try{const T=l(_);y.value=T}catch(T){const I=`실행 중 예외: ${T.message}`;y.value=I,x.textContent=I,console.error("onExecuteAction 콜백에서 예외 발생:",T)}else{const T="오류: 실행할 작업(onExecuteAction)이 정의되지 않았습니다.";y.value=T,x.textContent=T}})},preConfirm:()=>{const C=document.getElementById(d),R=document.getElementById(g);return R&&(R.textContent=""),C&&C.value.trim()!==""?C.value.startsWith("오류:")||C.value.startsWith("실행 중 예외:")?(R&&(R.textContent="오류가 있는 결과는 복사할 수 없습니다."),!1):C.value:(R&&(R.textContent="메인 편집기에 복사할 결과가 없습니다."),!1)}})}function eN(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u}=t,c={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:a,preConfirm:l,didOpen:u},h=i.find(g=>g.role==="confirm"||!g.role&&i.indexOf(g)===0),d=i.find(g=>g.role==="cancel");return h?(c.showConfirmButton=!0,c.confirmButtonText=h.text||bi.getConfirmButton().innerText,h.color&&(c.confirmButtonColor=h.color)):i.length>0||l?!i.some(g=>g.role!=="cancel")&&!l&&(c.showConfirmButton=!1):c.showConfirmButton=!1,d&&(c.showCancelButton=!0,c.cancelButtonText=d.text||bi.getCancelButton().innerText,d.color&&(c.cancelButtonColor=d.color)),typeof bi>"u"?Promise.reject("SweetAlert2 is not imported"):bi.fire(c).then(g=>{let w={...g,formData:{}};return g.isConfirmed&&l&&(w.formData=g.value||{}),g.isConfirmed&&h&&typeof h.action=="function"&&!l?h.action():g.isDismissed&&d&&typeof d.action=="function"&&g.dismiss===bi.DismissReason.cancel&&d.action(),w})}const dt=document.getElementById("json-input"),rt=document.getElementById("save-message"),Ke=document.getElementById("json-error"),xt=document.getElementById("tree-view"),YS=document.getElementById("table-view");function un(t,e,n){t&&(t.textContent=e,setTimeout(()=>{t.textContent=""},n))}function Fc(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent&&a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(i.appendChild(document.createTextNode(o)),e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));if(t&&t!==""){let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u;for(;(u=l.exec(t))!==null;){const c=u[0];let h=c;if(a===""?a=c:c.startsWith("[")?a+=c:a+="."+c,i.appendChild(document.createTextNode(" > ")),e){const d=document.createElement("a");d.href="#",d.textContent=h,d.style.textDecoration="underline",d.style.cursor="pointer",d.onclick=(f=>g=>{g.preventDefault(),e(f)})(a),i.appendChild(d)}else i.appendChild(document.createTextNode(h))}}i.appendChild(document.createTextNode(s))}function Tj(){xt&&(xt.innerHTML=""),YS&&(YS.innerHTML=""),Ke&&(Ke.textContent=""),rt&&(rt.textContent=""),Fc(null,null)}function uu(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function GS(t,e){if(typeof t=="string"){const n=t.trim();if(n.toLowerCase()==="null")return null;if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1;if(n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,"")))return Number(n);if(n.startsWith("[")&&n.endsWith("]")||n.startsWith("{")&&n.endsWith("}"))try{return JSON.parse(n)}catch{return t}return t}return t}function tN(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let Gl=null;function Zc(t){Gl&&Gl.classList.remove("selected-node"),Gl=t,Gl&&Gl.classList.add("selected-node")}function Mj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),Zc(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),tN(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),Zc(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function _j(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),Sf(e,o,n,r.rootJsonData,r.depth+1,r),o}function Sf(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=Mj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=_j(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function xj(){return Gl?Gl.dataset.path:null}function Pj(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function Ij(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var kg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ih=function(t){return t&&t.Math===Math&&t},Cn=Ih(typeof globalThis=="object"&&globalThis)||Ih(typeof window=="object"&&window)||Ih(typeof self=="object"&&self)||Ih(typeof kg=="object"&&kg)||Ih(typeof kg=="object"&&kg)||function(){return this}()||Function("return this")(),$0={},kn=function(t){try{return!!t()}catch{return!0}},Oj=kn,_i=!Oj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Aj=kn,Rv=!Aj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Hj=Rv,$g=Function.prototype.call,bn=Hj?$g.bind($g):function(){return $g.apply($g,arguments)},nN={},rN={}.propertyIsEnumerable,iN=Object.getOwnPropertyDescriptor,Nj=iN&&!rN.call({1:2},1);nN.f=Nj?function(e){var n=iN(this,e);return!!n&&n.enumerable}:rN;var Ev=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},oN=Rv,sN=Function.prototype,KS=sN.call,Dj=oN&&sN.bind.bind(KS,KS),gn=oN?Dj:function(t){return function(){return KS.apply(t,arguments)}},aN=gn,kj=aN({}.toString),$j=aN("".slice),bu=function(t){return $j(kj(t),8,-1)},Lj=gn,Fj=kn,Vj=bu,Ay=Object,Bj=Lj("".split),Wj=Fj(function(){return!Ay("z").propertyIsEnumerable(0)})?function(t){return Vj(t)==="String"?Bj(t,""):Ay(t)}:Ay,L0=function(t){return t==null},jj=L0,Uj=TypeError,eg=function(t){if(jj(t))throw new Uj("Can't call method on "+t);return t},zj=Wj,Yj=eg,tg=function(t){return zj(Yj(t))},Hy=typeof document=="object"&&document.all,Sn=typeof Hy>"u"&&Hy!==void 0?function(t){return typeof t=="function"||t===Hy}:function(t){return typeof t=="function"},Gj=Sn,xi=function(t){return typeof t=="object"?t!==null:Gj(t)},Ny=Cn,Kj=Sn,qj=function(t){return Kj(t)?t:void 0},ch=function(t,e){return arguments.length<2?qj(Ny[t]):Ny[t]&&Ny[t][e]},Xj=gn,ng=Xj({}.isPrototypeOf),Jj=Cn,_x=Jj.navigator,xx=_x&&_x.userAgent,Tv=xx?String(xx):"",lN=Cn,Dy=Tv,Px=lN.process,Ix=lN.Deno,Ox=Px&&Px.versions||Ix&&Ix.version,Ax=Ox&&Ox.v8,Qi,pw;Ax&&(Qi=Ax.split("."),pw=Qi[0]>0&&Qi[0]<4?1:+(Qi[0]+Qi[1]));!pw&&Dy&&(Qi=Dy.match(/Edge\/(\d+)/),(!Qi||Qi[1]>=74)&&(Qi=Dy.match(/Chrome\/(\d+)/),Qi&&(pw=+Qi[1])));var Zj=pw,Hx=Zj,Qj=kn,eU=Cn,tU=eU.String,F0=!!Object.getOwnPropertySymbols&&!Qj(function(){var t=Symbol("symbol detection");return!tU(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Hx&&Hx<41}),nU=F0,uN=nU&&!Symbol.sham&&typeof Symbol.iterator=="symbol",rU=ch,iU=Sn,oU=ng,sU=uN,aU=Object,V0=sU?function(t){return typeof t=="symbol"}:function(t){var e=rU("Symbol");return iU(e)&&oU(e.prototype,aU(t))},lU=String,Mv=function(t){try{return lU(t)}catch{return"Object"}},uU=Sn,cU=Mv,hU=TypeError,Lr=function(t){if(uU(t))return t;throw new hU(cU(t)+" is not a function")},dU=Lr,fU=L0,rg=function(t,e){var n=t[e];return fU(n)?void 0:dU(n)},ky=bn,$y=Sn,Ly=xi,gU=TypeError,mU=function(t,e){var n,r;if(e==="string"&&$y(n=t.toString)&&!Ly(r=ky(n,t))||$y(n=t.valueOf)&&!Ly(r=ky(n,t))||e!=="string"&&$y(n=t.toString)&&!Ly(r=ky(n,t)))return r;throw new gU("Can't convert object to primitive value")},cN={exports:{}},Nx=Cn,pU=Object.defineProperty,B0=function(t,e){try{pU(Nx,t,{value:e,configurable:!0,writable:!0})}catch{Nx[t]=e}return e},wU=Cn,vU=B0,Dx="__core-js_shared__",kx=cN.exports=wU[Dx]||vU(Dx,{});(kx.versions||(kx.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var W0=cN.exports,$x=W0,hN=function(t,e){return $x[t]||($x[t]=e||{})},yU=eg,CU=Object,hh=function(t){return CU(yU(t))},bU=gn,SU=hh,RU=bU({}.hasOwnProperty),Pi=Object.hasOwn||function(e,n){return RU(SU(e),n)},EU=gn,TU=0,MU=Math.random(),_U=EU(1 .toString),dN=function(t){return"Symbol("+(t===void 0?"":t)+")_"+_U(++TU+MU,36)},xU=Cn,PU=hN,Lx=Pi,IU=dN,OU=F0,AU=uN,Ic=xU.Symbol,Fy=PU("wks"),HU=AU?Ic.for||Ic:Ic&&Ic.withoutSetter||IU,ao=function(t){return Lx(Fy,t)||(Fy[t]=OU&&Lx(Ic,t)?Ic[t]:HU("Symbol."+t)),Fy[t]},NU=bn,Fx=xi,Vx=V0,DU=rg,kU=mU,$U=ao,LU=TypeError,FU=$U("toPrimitive"),VU=function(t,e){if(!Fx(t)||Vx(t))return t;var n=DU(t,FU),r;if(n){if(e===void 0&&(e="default"),r=NU(n,t,e),!Fx(r)||Vx(r))return r;throw new LU("Can't convert object to primitive value")}return e===void 0&&(e="number"),kU(t,e)},BU=VU,WU=V0,fN=function(t){var e=BU(t,"string");return WU(e)?e:e+""},jU=Cn,Bx=xi,qS=jU.document,UU=Bx(qS)&&Bx(qS.createElement),j0=function(t){return UU?qS.createElement(t):{}},zU=_i,YU=kn,GU=j0,gN=!zU&&!YU(function(){return Object.defineProperty(GU("div"),"a",{get:function(){return 7}}).a!==7}),KU=_i,qU=bn,XU=nN,JU=Ev,ZU=tg,QU=fN,ez=Pi,tz=gN,Wx=Object.getOwnPropertyDescriptor;$0.f=KU?Wx:function(e,n){if(e=ZU(e),n=QU(n),tz)try{return Wx(e,n)}catch{}if(ez(e,n))return JU(!qU(XU.f,e,n),e[n])};var Ks={},nz=_i,rz=kn,mN=nz&&rz(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),iz=xi,oz=String,sz=TypeError,Rn=function(t){if(iz(t))return t;throw new sz(oz(t)+" is not an object")},az=_i,lz=gN,uz=mN,Lg=Rn,jx=fN,cz=TypeError,Vy=Object.defineProperty,hz=Object.getOwnPropertyDescriptor,By="enumerable",Wy="configurable",jy="writable";Ks.f=az?uz?function(e,n,r){if(Lg(e),n=jx(n),Lg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&jy in r&&!r[jy]){var i=hz(e,n);i&&i[jy]&&(e[n]=r.value,r={configurable:Wy in r?r[Wy]:i[Wy],enumerable:By in r?r[By]:i[By],writable:!1})}return Vy(e,n,r)}:Vy:function(e,n,r){if(Lg(e),n=jx(n),Lg(r),lz)try{return Vy(e,n,r)}catch{}if("get"in r||"set"in r)throw new cz("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var dz=_i,fz=Ks,gz=Ev,dh=dz?function(t,e,n){return fz.f(t,e,gz(1,n))}:function(t,e,n){return t[e]=n,t},pN={exports:{}},XS=_i,mz=Pi,wN=Function.prototype,pz=XS&&Object.getOwnPropertyDescriptor,wz=mz(wN,"name"),vz=wz&&(!XS||XS&&pz(wN,"name").configurable),yz={CONFIGURABLE:vz},Cz=gn,bz=Sn,JS=W0,Sz=Cz(Function.toString);bz(JS.inspectSource)||(JS.inspectSource=function(t){return Sz(t)});var Rz=JS.inspectSource,Ez=Cn,Tz=Sn,Ux=Ez.WeakMap,Mz=Tz(Ux)&&/native code/.test(String(Ux)),_z=hN,xz=dN,zx=_z("keys"),U0=function(t){return zx[t]||(zx[t]=xz(t))},z0={},Pz=Mz,vN=Cn,Iz=xi,Oz=dh,Uy=Pi,zy=W0,Az=U0,Hz=z0,Yx="Object already initialized",ZS=vN.TypeError,Nz=vN.WeakMap,ww,Rf,vw,Dz=function(t){return vw(t)?Rf(t):ww(t,{})},kz=function(t){return function(e){var n;if(!Iz(e)||(n=Rf(e)).type!==t)throw new ZS("Incompatible receiver, "+t+" required");return n}};if(Pz||zy.state){var fo=zy.state||(zy.state=new Nz);fo.get=fo.get,fo.has=fo.has,fo.set=fo.set,ww=function(t,e){if(fo.has(t))throw new ZS(Yx);return e.facade=t,fo.set(t,e),e},Rf=function(t){return fo.get(t)||{}},vw=function(t){return fo.has(t)}}else{var Du=Az("state");Hz[Du]=!0,ww=function(t,e){if(Uy(t,Du))throw new ZS(Yx);return e.facade=t,Oz(t,Du,e),e},Rf=function(t){return Uy(t,Du)?t[Du]:{}},vw=function(t){return Uy(t,Du)}}var yN={set:ww,get:Rf,has:vw,enforce:Dz,getterFor:kz},Y0=gn,$z=kn,Lz=Sn,Fg=Pi,QS=_i,Fz=yz.CONFIGURABLE,Vz=Rz,CN=yN,Bz=CN.enforce,Wz=CN.get,Gx=String,xp=Object.defineProperty,jz=Y0("".slice),Uz=Y0("".replace),zz=Y0([].join),Yz=QS&&!$z(function(){return xp(function(){},"length",{value:8}).length!==8}),Gz=String(String).split("String"),Kz=pN.exports=function(t,e,n){jz(Gx(e),0,7)==="Symbol("&&(e="["+Uz(Gx(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Fg(t,"name")||Fz&&t.name!==e)&&(QS?xp(t,"name",{value:e,configurable:!0}):t.name=e),Yz&&n&&Fg(n,"arity")&&t.length!==n.arity&&xp(t,"length",{value:n.arity});try{n&&Fg(n,"constructor")&&n.constructor?QS&&xp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=Bz(t);return Fg(r,"source")||(r.source=zz(Gz,typeof e=="string"?e:"")),t};Function.prototype.toString=Kz(function(){return Lz(this)&&Wz(this).source||Vz(this)},"toString");var bN=pN.exports,qz=Sn,Xz=Ks,Jz=bN,Zz=B0,G0=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(qz(n)&&Jz(n,o,r),r.global)i?t[e]=n:Zz(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:Xz.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},SN={},Qz=Math.ceil,eY=Math.floor,tY=Math.trunc||function(e){var n=+e;return(n>0?eY:Qz)(n)},nY=tY,ig=function(t){var e=+t;return e!==e||e===0?0:nY(e)},rY=ig,iY=Math.max,oY=Math.min,sY=function(t,e){var n=rY(t);return n<0?iY(n+e,0):oY(n,e)},aY=ig,lY=Math.min,uY=function(t){var e=aY(t);return e>0?lY(e,9007199254740991):0},cY=uY,fh=function(t){return cY(t.length)},hY=tg,dY=sY,fY=fh,gY=function(t){return function(e,n,r){var i=hY(e),o=fY(i);if(o===0)return!t&&-1;var s=dY(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},mY={indexOf:gY(!1)},pY=gn,Yy=Pi,wY=tg,vY=mY.indexOf,yY=z0,Kx=pY([].push),RN=function(t,e){var n=wY(t),r=0,i=[],o;for(o in n)!Yy(yY,o)&&Yy(n,o)&&Kx(i,o);for(;e.length>r;)Yy(n,o=e[r++])&&(~vY(i,o)||Kx(i,o));return i},K0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],CY=RN,bY=K0,SY=bY.concat("length","prototype");SN.f=Object.getOwnPropertyNames||function(e){return CY(e,SY)};var EN={};EN.f=Object.getOwnPropertySymbols;var RY=ch,EY=gn,TY=SN,MY=EN,_Y=Rn,xY=EY([].concat),PY=RY("Reflect","ownKeys")||function(e){var n=TY.f(_Y(e)),r=MY.f;return r?xY(n,r(e)):n},qx=Pi,IY=PY,OY=$0,AY=Ks,TN=function(t,e,n){for(var r=IY(e),i=AY.f,o=OY.f,s=0;s<r.length;s++){var a=r[s];!qx(t,a)&&!(n&&qx(n,a))&&i(t,a,o(e,a))}},HY=kn,NY=Sn,DY=/#|\.prototype\./,og=function(t,e){var n=$Y[kY(t)];return n===FY?!0:n===LY?!1:NY(e)?HY(e):!!e},kY=og.normalize=function(t){return String(t).replace(DY,".").toLowerCase()},$Y=og.data={},LY=og.NATIVE="N",FY=og.POLYFILL="P",VY=og,Vg=Cn,BY=$0.f,WY=dh,jY=G0,UY=B0,zY=TN,YY=VY,Et=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Vg:i?s=Vg[n]||UY(n,{}):s=Vg[n]&&Vg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=BY(s,a),l=c&&c.value):l=s[a],o=YY(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;zY(u,l)}(t.sham||l&&l.sham)&&WY(u,"sham",!0),jY(s,a,u,t)}},GY=Rv,MN=Function.prototype,Xx=MN.apply,Jx=MN.call,sg=typeof Reflect=="object"&&Reflect.apply||(GY?Jx.bind(Xx):function(){return Jx.apply(Xx,arguments)}),KY=gn,qY=Lr,_N=function(t,e,n){try{return KY(qY(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},XY=xi,JY=function(t){return XY(t)||t===null},ZY=JY,QY=String,eG=TypeError,tG=function(t){if(ZY(t))return t;throw new eG("Can't set "+QY(t)+" as a prototype")},nG=_N,rG=xi,iG=eg,oG=tG,xN=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=nG(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return iG(i),oG(o),rG(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),sG=Ks.f,aG=function(t,e,n){n in t||sG(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},lG=Sn,uG=xi,Zx=xN,cG=function(t,e,n){var r,i;return Zx&&lG(r=e.constructor)&&r!==n&&uG(i=r.prototype)&&i!==n.prototype&&Zx(t,i),t},hG=ao,dG=hG("toStringTag"),PN={};PN[dG]="z";var fG=String(PN)==="[object z]",gG=fG,mG=Sn,Pp=bu,pG=ao,wG=pG("toStringTag"),vG=Object,yG=Pp(function(){return arguments}())==="Arguments",CG=function(t,e){try{return t[e]}catch{}},IN=gG?Pp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=CG(e=vG(t),wG))=="string"?n:yG?Pp(e):(r=Pp(e))==="Object"&&mG(e.callee)?"Arguments":r},bG=IN,SG=String,_v=function(t){if(bG(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return SG(t)},RG=_v,EG=function(t,e){return t===void 0?arguments.length<2?"":e:RG(t)},TG=xi,MG=dh,_G=function(t,e){TG(e)&&"cause"in e&&MG(t,"cause",e.cause)},xG=gn,ON=Error,PG=xG("".replace),IG=function(t){return String(new ON(t).stack)}("zxcasd"),AN=/\n\s*at [^:]*:[^\n]*/,OG=AN.test(IG),AG=function(t,e){if(OG&&typeof t=="string"&&!ON.prepareStackTrace)for(;e--;)t=PG(t,AN,"");return t},HG=kn,NG=Ev,DG=!HG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",NG(1,7)),t.stack!==7):!0}),kG=dh,$G=AG,LG=DG,Qx=Error.captureStackTrace,FG=function(t,e,n,r){LG&&(Qx?Qx(t,e):kG(t,"stack",$G(n,r)))},eP=ch,VG=Pi,tP=dh,BG=ng,nP=xN,rP=TN,iP=aG,WG=cG,jG=EG,UG=_G,zG=FG,YG=_i,GG=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=eP.apply(null,s);if(l){var u=l.prototype;if(VG(u,"cause")&&delete u.cause,!n)return l;var c=eP("Error"),h=e(function(d,f){var g=jG(r?f:d,void 0),w=r?new l(d):new l;return g!==void 0&&tP(w,"message",g),zG(w,h,w.stack,2),this&&BG(u,this)&&WG(w,this,h),arguments.length>o&&UG(w,arguments[o]),w});h.prototype=u,a!=="Error"?nP?nP(h,c):rP(h,c,{name:!0}):YG&&i in l&&(iP(h,l,i),iP(h,l,"prepareStackTrace")),rP(h,l);try{u.name!==a&&tP(u,"name",a),u.constructor=h}catch{}return h}},HN=Et,KG=Cn,Jo=sg,NN=GG,eR="WebAssembly",oP=KG[eR],yw=new Error("e",{cause:7}).cause!==7,Su=function(t,e){var n={};n[t]=NN(t,e,yw),HN({global:!0,constructor:!0,arity:1,forced:yw},n)},q0=function(t,e){if(oP&&oP[t]){var n={};n[t]=NN(eR+"."+t,e,yw),HN({target:eR,stat:!0,constructor:!0,arity:1,forced:yw},n)}};Su("Error",function(t){return function(n){return Jo(t,this,arguments)}});Su("EvalError",function(t){return function(n){return Jo(t,this,arguments)}});Su("RangeError",function(t){return function(n){return Jo(t,this,arguments)}});Su("ReferenceError",function(t){return function(n){return Jo(t,this,arguments)}});Su("SyntaxError",function(t){return function(n){return Jo(t,this,arguments)}});Su("TypeError",function(t){return function(n){return Jo(t,this,arguments)}});Su("URIError",function(t){return function(n){return Jo(t,this,arguments)}});q0("CompileError",function(t){return function(n){return Jo(t,this,arguments)}});q0("LinkError",function(t){return function(n){return Jo(t,this,arguments)}});q0("RuntimeError",function(t){return function(n){return Jo(t,this,arguments)}});var qG=bu,DN=Array.isArray||function(e){return qG(e)==="Array"},XG=_i,JG=DN,ZG=TypeError,QG=Object.getOwnPropertyDescriptor,eK=XG&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),kN=eK?function(t,e){if(JG(t)&&!QG(t,"length").writable)throw new ZG("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},tK=TypeError,nK=9007199254740991,$N=function(t){if(t>nK)throw tK("Maximum allowed index exceeded");return t},rK=Et,iK=hh,oK=fh,sK=kN,aK=$N,lK=kn,uK=lK(function(){return[].push.call({length:4294967296},1)!==4294967297}),cK=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},hK=uK||!cK();rK({target:"Array",proto:!0,arity:1,forced:hK},{push:function(e){var n=iK(this),r=oK(n),i=arguments.length;aK(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return sK(n,r),r}});var dK=bu,fK=gn,gK=function(t){if(dK(t)==="Function")return fK(t)},sP=gK,mK=Lr,pK=Rv,wK=sP(sP.bind),LN=function(t,e){return mK(t),e===void 0?t:pK?wK(t,e):function(){return t.apply(e,arguments)}},FN={},vK=ao,yK=FN,CK=vK("iterator"),bK=Array.prototype,SK=function(t){return t!==void 0&&(yK.Array===t||bK[CK]===t)},RK=IN,aP=rg,EK=L0,TK=FN,MK=ao,_K=MK("iterator"),X0=function(t){if(!EK(t))return aP(t,_K)||aP(t,"@@iterator")||TK[RK(t)]},xK=bn,PK=Lr,IK=Rn,OK=Mv,AK=X0,HK=TypeError,NK=function(t,e){var n=arguments.length<2?AK(t):e;if(PK(n))return IK(xK(n,t));throw new HK(OK(t)+" is not iterable")},DK=bn,lP=Rn,kK=rg,ni=function(t,e,n){var r,i;lP(t);try{if(r=kK(t,"return"),!r){if(e==="throw")throw n;return n}r=DK(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return lP(r),n},$K=LN,LK=bn,FK=Rn,VK=Mv,BK=SK,WK=fh,uP=ng,jK=NK,UK=X0,cP=ni,zK=TypeError,Ip=function(t,e){this.stopped=t,this.result=e},hP=Ip.prototype,gh=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=$K(e,r),u,c,h,d,f,g,w,C=function(y){return u&&cP(u,"normal",y),new Ip(!0,y)},R=function(y){return i?(FK(y),a?l(y[0],y[1],C):l(y[0],y[1])):a?l(y,C):l(y)};if(o)u=t.iterator;else if(s)u=t;else{if(c=UK(t),!c)throw new zK(VK(t)+" is not iterable");if(BK(c)){for(h=0,d=WK(t);d>h;h++)if(f=R(t[h]),f&&uP(hP,f))return f;return new Ip(!1)}u=jK(t,c)}for(g=o?t.next:u.next;!(w=LK(g,u)).done;){try{f=R(w.value)}catch(y){cP(u,"throw",y)}if(typeof f=="object"&&f&&uP(hP,f))return f}return new Ip(!1)},YK=_i,GK=Ks,KK=Ev,VN=function(t,e,n){YK?GK.f(t,e,KK(0,n)):t[e]=n},qK=Et,XK=gh,JK=VN;qK({target:"Object",stat:!0},{fromEntries:function(e){var n={};return XK(e,function(r,i){JK(n,r,i)},{AS_ENTRIES:!0}),n}});var Gy=gn,Bg=Set.prototype,Zo={Set,add:Gy(Bg.add),has:Gy(Bg.has),remove:Gy(Bg.delete),proto:Bg},ZK=Zo.has,Ru=function(t){return ZK(t),t},QK=bn,Eu=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=QK(i,r)).done;)if(s=e(o.value),s!==void 0)return s},BN=gn,e3=Eu,WN=Zo,t3=WN.Set,jN=WN.proto,n3=BN(jN.forEach),UN=BN(jN.keys),r3=UN(new t3).next,ag=function(t,e,n){return n?e3({iterator:UN(t),next:r3},e):n3(t,e)},zN=Zo,i3=ag,o3=zN.Set,s3=zN.add,J0=function(t){var e=new o3;return i3(t,function(n){s3(e,n)}),e},a3=_N,l3=Zo,lg=a3(l3.proto,"size","get")||function(t){return t.size},Qo=function(t){return{iterator:t,next:t.next,done:!1}},dP=Lr,YN=Rn,fP=bn,u3=ig,c3=Qo,gP="Invalid size",h3=RangeError,d3=TypeError,f3=Math.max,GN=function(t,e){this.set=t,this.size=f3(e,0),this.has=dP(t.has),this.keys=dP(t.keys)};GN.prototype={getIterator:function(){return c3(YN(fP(this.keys,this.set)))},includes:function(t){return fP(this.has,this.set,t)}};var Tu=function(t){YN(t);var e=+t.size;if(e!==e)throw new d3(gP);var n=u3(e);if(n<0)throw new h3(gP);return new GN(t,n)},g3=Ru,KN=Zo,m3=J0,p3=lg,w3=Tu,v3=ag,y3=Eu,C3=KN.has,mP=KN.remove,b3=function(e){var n=g3(this),r=w3(e),i=m3(n);return p3(n)<=r.size?v3(n,function(o){r.includes(o)&&mP(i,o)}):y3(r.getIterator(),function(o){C3(n,o)&&mP(i,o)}),i},S3=ch,pP=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},wP=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},Mu=function(t,e){var n=S3("Set");try{new n()[t](pP(0));try{return new n()[t](pP(-1)),!1}catch{if(!e)return!0;try{return new n()[t](wP(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](wP(1/0)))}}}catch{return!1}},R3=Et,E3=b3,T3=Mu,M3=!T3("difference",function(t){return t.size===0});R3({target:"Set",proto:!0,real:!0,forced:M3},{difference:E3});var _3=Ru,Z0=Zo,x3=lg,P3=Tu,I3=ag,O3=Eu,A3=Z0.Set,vP=Z0.add,H3=Z0.has,N3=function(e){var n=_3(this),r=P3(e),i=new A3;return x3(n)>r.size?O3(r.getIterator(),function(o){H3(n,o)&&vP(i,o)}):I3(n,function(o){r.includes(o)&&vP(i,o)}),i},D3=Et,k3=kn,$3=N3,L3=Mu,F3=!L3("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||k3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});D3({target:"Set",proto:!0,real:!0,forced:F3},{intersection:$3});var V3=Ru,B3=Zo.has,W3=lg,j3=Tu,U3=ag,z3=Eu,Y3=ni,G3=function(e){var n=V3(this),r=j3(e);if(W3(n)<=r.size)return U3(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return z3(i,function(o){if(B3(n,o))return Y3(i,"normal",!1)})!==!1},K3=Et,q3=G3,X3=Mu,J3=!X3("isDisjointFrom",function(t){return!t});K3({target:"Set",proto:!0,real:!0,forced:J3},{isDisjointFrom:q3});var Z3=Ru,Q3=lg,e5=ag,t5=Tu,n5=function(e){var n=Z3(this),r=t5(e);return Q3(n)>r.size?!1:e5(n,function(i){if(!r.includes(i))return!1},!0)!==!1},r5=Et,i5=n5,o5=Mu,s5=!o5("isSubsetOf",function(t){return t});r5({target:"Set",proto:!0,real:!0,forced:s5},{isSubsetOf:i5});var a5=Ru,l5=Zo.has,u5=lg,c5=Tu,h5=Eu,d5=ni,f5=function(e){var n=a5(this),r=c5(e);if(u5(n)<r.size)return!1;var i=r.getIterator();return h5(i,function(o){if(!l5(n,o))return d5(i,"normal",!1)})!==!1},g5=Et,m5=f5,p5=Mu,w5=!p5("isSupersetOf",function(t){return!t});g5({target:"Set",proto:!0,real:!0,forced:w5},{isSupersetOf:m5});var v5=Ru,Q0=Zo,y5=J0,C5=Tu,b5=Eu,S5=Q0.add,R5=Q0.has,E5=Q0.remove,T5=function(e){var n=v5(this),r=C5(e).getIterator(),i=y5(n);return b5(r,function(o){R5(n,o)?E5(i,o):S5(i,o)}),i},M5=Et,_5=T5,x5=Mu;M5({target:"Set",proto:!0,real:!0,forced:!x5("symmetricDifference")},{symmetricDifference:_5});var P5=Ru,I5=Zo.add,O5=J0,A5=Tu,H5=Eu,N5=function(e){var n=P5(this),r=A5(e).getIterator(),i=O5(n);return H5(r,function(o){I5(i,o)}),i},D5=Et,k5=N5,$5=Mu;D5({target:"Set",proto:!0,real:!0,forced:!$5("union")},{union:k5});var L5=ng,F5=TypeError,V5=function(t,e){if(L5(e,t))return t;throw new F5("Incorrect invocation")},B5=kn,W5=!B5(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),j5=Pi,U5=Sn,z5=hh,Y5=U0,G5=W5,yP=Y5("IE_PROTO"),tR=Object,K5=tR.prototype,qN=G5?tR.getPrototypeOf:function(t){var e=z5(t);if(j5(e,yP))return e[yP];var n=e.constructor;return U5(n)&&e instanceof n?n.prototype:e instanceof tR?K5:null},CP=bN,q5=Ks,X5=function(t,e,n){return n.get&&CP(n.get,e,{getter:!0}),n.set&&CP(n.set,e,{setter:!0}),q5.f(t,e,n)},XN={},J5=RN,Z5=K0,Q5=Object.keys||function(e){return J5(e,Z5)},eq=_i,tq=mN,nq=Ks,rq=Rn,iq=tg,oq=Q5;XN.f=eq&&!tq?Object.defineProperties:function(e,n){rq(e);for(var r=iq(n),i=oq(n),o=i.length,s=0,a;o>s;)nq.f(e,a=i[s++],r[a]);return e};var sq=ch,JN=sq("document","documentElement"),aq=Rn,lq=XN,bP=K0,uq=z0,cq=JN,hq=j0,dq=U0,SP=">",RP="<",nR="prototype",rR="script",ZN=dq("IE_PROTO"),Ky=function(){},QN=function(t){return RP+rR+SP+t+RP+"/"+rR+SP},EP=function(t){t.write(QN("")),t.close();var e=t.parentWindow.Object;return t=null,e},fq=function(){var t=hq("iframe"),e="java"+rR+":",n;return t.style.display="none",cq.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(QN("document.F=Object")),n.close(),n.F},Wg,Op=function(){try{Wg=new ActiveXObject("htmlfile")}catch{}Op=typeof document<"u"?document.domain&&Wg?EP(Wg):fq():EP(Wg);for(var t=bP.length;t--;)delete Op[nR][bP[t]];return Op()};uq[ZN]=!0;var eD=Object.create||function(e,n){var r;return e!==null?(Ky[nR]=aq(e),r=new Ky,Ky[nR]=null,r[ZN]=e):r=Op(),n===void 0?r:lq.f(r,n)},gq=kn,mq=Sn,pq=xi,TP=qN,wq=G0,vq=ao,iR=vq("iterator"),cu,qy,Xy;[].keys&&(Xy=[].keys(),"next"in Xy&&(qy=TP(TP(Xy)),qy!==Object.prototype&&(cu=qy)));var yq=!pq(cu)||gq(function(){var t={};return cu[iR].call(t)!==t});yq&&(cu={});mq(cu[iR])||wq(cu,iR,function(){return this});var tD={IteratorPrototype:cu},Cq=Et,bq=Cn,Sq=V5,Rq=Rn,Eq=Sn,Tq=qN,Mq=X5,_q=VN,xq=kn,eE=Pi,Pq=ao,zo=tD.IteratorPrototype,Iq=_i,Jy="constructor",nD="Iterator",MP=Pq("toStringTag"),rD=TypeError,Zy=bq[nD],iD=!Eq(Zy)||Zy.prototype!==zo||!xq(function(){Zy({})}),tE=function(){if(Sq(this,zo),Tq(this)===zo)throw new rD("Abstract class Iterator not directly constructable")},oD=function(t,e){Iq?Mq(zo,t,{configurable:!0,get:function(){return e},set:function(n){if(Rq(this),this===zo)throw new rD("You can't redefine this property");eE(this,t)?this[t]=n:_q(this,t,n)}}):zo[t]=e};eE(zo,MP)||oD(MP,nD);(iD||!eE(zo,Jy)||zo[Jy]===Object)&&oD(Jy,tE);tE.prototype=zo;Cq({global:!0,constructor:!0,forced:iD},{Iterator:tE});var Oq=G0,Aq=function(t,e,n){for(var r in e)Oq(t,r,e[r],n);return t},Hq=function(t,e){return{value:t,done:e}},Nq=bn,Dq=eD,kq=dh,$q=Aq,Lq=ao,sD=yN,Fq=rg,Vq=tD.IteratorPrototype,jg=Hq,Qy=ni,Bq=Lq("toStringTag"),aD="IteratorHelper",lD="WrapForValidIterator",Wq=sD.set,uD=function(t){var e=sD.getterFor(t?lD:aD);return $q(Dq(Vq),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return jg(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:jg(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=Fq(r,"return");return i?Nq(i,r):jg(void 0,!0)}if(n.inner)try{Qy(n.inner.iterator,"normal")}catch(o){return Qy(r,"throw",o)}return r&&Qy(r,"normal"),jg(void 0,!0)}})},jq=uD(!0),cD=uD(!1);kq(cD,Bq,"Iterator Helper");var nE=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?lD:aD,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,Wq(this,s)};return r.prototype=e?jq:cD,r},Uq=Rn,zq=ni,hD=function(t,e,n,r){try{return r?e(Uq(n)[0],n[1]):e(n)}catch(i){zq(t,"throw",i)}},Yq=Cn,Ja=function(t,e){var n=Yq.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},Gq=Et,dD=bn,Kq=Lr,fD=Rn,qq=Qo,Xq=nE,Jq=hD,Zq=ni,Qq=Ja,eC=Qq("filter",TypeError),e4=Xq(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=fD(dD(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,Jq(t,e,[o,this.counter++],!0))return o}});Gq({target:"Iterator",proto:!0,real:!0,forced:eC},{filter:function(e){fD(this);try{Kq(e)}catch(n){Zq(this,"throw",n)}return eC?dD(eC,this,e):new e4(qq(this),{predicate:e})}});var t4=Et,n4=bn,r4=gh,i4=Lr,o4=Rn,s4=Qo,a4=ni,l4=Ja,tC=l4("forEach",TypeError);t4({target:"Iterator",proto:!0,real:!0,forced:tC},{forEach:function(e){o4(this);try{i4(e)}catch(i){a4(this,"throw",i)}if(tC)return n4(tC,this,e);var n=s4(this),r=0;r4(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var u4=Et,gD=bn,c4=Lr,mD=Rn,h4=Qo,d4=nE,f4=hD,g4=ni,m4=Ja,nC=m4("map",TypeError),p4=d4(function(){var t=this.iterator,e=mD(gD(this.next,t)),n=this.done=!!e.done;if(!n)return f4(t,this.mapper,[e.value,this.counter++],!0)});u4({target:"Iterator",proto:!0,real:!0,forced:nC},{map:function(e){mD(this);try{c4(e)}catch(n){g4(this,"throw",n)}return nC?gD(nC,this,e):new p4(h4(this),{mapper:e})}});var w4=gn,rE=w4([].slice),v4=TypeError,pD=function(t,e){if(t<e)throw new v4("Not enough arguments");return t},y4=Tv,C4=/(?:ipad|iphone|ipod).*applewebkit/i.test(y4),Oh=Cn,b4=Tv,S4=bu,Ug=function(t){return b4.slice(0,t.length)===t},wD=function(){return Ug("Bun/")?"BUN":Ug("Cloudflare-Workers")?"CLOUDFLARE":Ug("Deno/")?"DENO":Ug("Node.js/")?"NODE":Oh.Bun&&typeof Bun.version=="string"?"BUN":Oh.Deno&&typeof Deno.version=="object"?"DENO":S4(Oh.process)==="process"?"NODE":Oh.window&&Oh.document?"BROWSER":"REST"}(),R4=wD,E4=R4==="NODE",Zr=Cn,T4=sg,M4=LN,_P=Sn,_4=Pi,vD=kn,xP=JN,x4=rE,PP=j0,P4=pD,I4=C4,O4=E4,oR=Zr.setImmediate,sR=Zr.clearImmediate,A4=Zr.process,rC=Zr.Dispatch,H4=Zr.Function,IP=Zr.MessageChannel,N4=Zr.String,iC=0,zd={},OP="onreadystatechange",Ef,rl,oC,sC;vD(function(){Ef=Zr.location});var iE=function(t){if(_4(zd,t)){var e=zd[t];delete zd[t],e()}},aC=function(t){return function(){iE(t)}},AP=function(t){iE(t.data)},HP=function(t){Zr.postMessage(N4(t),Ef.protocol+"//"+Ef.host)};(!oR||!sR)&&(oR=function(e){P4(arguments.length,1);var n=_P(e)?e:H4(e),r=x4(arguments,1);return zd[++iC]=function(){T4(n,void 0,r)},rl(iC),iC},sR=function(e){delete zd[e]},O4?rl=function(t){A4.nextTick(aC(t))}:rC&&rC.now?rl=function(t){rC.now(aC(t))}:IP&&!I4?(oC=new IP,sC=oC.port2,oC.port1.onmessage=AP,rl=M4(sC.postMessage,sC)):Zr.addEventListener&&_P(Zr.postMessage)&&!Zr.importScripts&&Ef&&Ef.protocol!=="file:"&&!vD(HP)?(rl=HP,Zr.addEventListener("message",AP,!1)):OP in PP("script")?rl=function(t){xP.appendChild(PP("script"))[OP]=function(){xP.removeChild(this),iE(t)}}:rl=function(t){setTimeout(aC(t),0)});var yD={set:oR,clear:sR},D4=Et,k4=Cn,NP=yD.clear;D4({global:!0,bind:!0,enumerable:!0,forced:k4.clearImmediate!==NP},{clearImmediate:NP});var CD=Cn,$4=sg,L4=Sn,F4=wD,V4=Tv,B4=rE,W4=pD,j4=CD.Function,U4=/MSIE .\./.test(V4)||F4==="BUN"&&function(){var t=CD.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),z4=function(t,e){var n=e?2:1;return U4?function(r,i){var o=W4(arguments.length,1)>n,s=L4(r)?r:j4(r),a=o?B4(arguments,n):[],l=o?function(){$4(s,this,a)}:s;return e?t(l,i):t(l)}:t},Y4=Et,bD=Cn,DP=yD.set,G4=z4,kP=bD.setImmediate?G4(DP,!1):DP;Y4({global:!0,bind:!0,enumerable:!0,forced:bD.setImmediate!==kP},{setImmediate:kP});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:SD,setPrototypeOf:$P,isFrozen:K4,getPrototypeOf:q4,getOwnPropertyDescriptor:X4}=Object;let{freeze:fr,seal:Ti,create:RD}=Object,{apply:aR,construct:lR}=typeof Reflect<"u"&&Reflect;fr||(fr=function(e){return e});Ti||(Ti=function(e){return e});aR||(aR=function(e,n,r){return e.apply(n,r)});lR||(lR=function(e,n){return new e(...n)});const zg=gr(Array.prototype.forEach),J4=gr(Array.prototype.lastIndexOf),LP=gr(Array.prototype.pop),Ah=gr(Array.prototype.push),Z4=gr(Array.prototype.splice),Ap=gr(String.prototype.toLowerCase),lC=gr(String.prototype.toString),FP=gr(String.prototype.match),Hh=gr(String.prototype.replace),Q4=gr(String.prototype.indexOf),eX=gr(String.prototype.trim),Ui=gr(Object.prototype.hasOwnProperty),rr=gr(RegExp.prototype.test),Nh=tX(TypeError);function gr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return aR(t,e,r)}}function tX(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return lR(t,n)}}function je(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ap;$P&&$P(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(K4(e)||(e[r]=o),i=o)}t[i]=!0}return t}function nX(t){for(let e=0;e<t.length;e++)Ui(t,e)||(t[e]=null);return t}function jl(t){const e=RD(null);for(const[n,r]of SD(t))Ui(t,n)&&(Array.isArray(r)?e[n]=nX(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=jl(r):e[n]=r);return e}function Dh(t,e){for(;t!==null;){const r=X4(t,e);if(r){if(r.get)return gr(r.get);if(typeof r.value=="function")return gr(r.value)}t=q4(t)}function n(){return null}return n}const VP=fr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),uC=fr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),cC=fr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),rX=fr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),hC=fr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),iX=fr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),BP=fr(["#text"]),WP=fr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),dC=fr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),jP=fr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Yg=fr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),oX=Ti(/\{\{[\w\W]*|[\w\W]*\}\}/gm),sX=Ti(/<%[\w\W]*|[\w\W]*%>/gm),aX=Ti(/\$\{[\w\W]*/gm),lX=Ti(/^data-[\-\w.\u00B7-\uFFFF]+$/),uX=Ti(/^aria-[\-\w]+$/),ED=Ti(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),cX=Ti(/^(?:\w+script|data):/i),hX=Ti(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),TD=Ti(/^html$/i),dX=Ti(/^[a-z][.\w]*(-[.\w]+)+$/i);var UP=Object.freeze({__proto__:null,ARIA_ATTR:uX,ATTR_WHITESPACE:hX,CUSTOM_ELEMENT:dX,DATA_ATTR:lX,DOCTYPE_NAME:TD,ERB_EXPR:sX,IS_ALLOWED_URI:ED,IS_SCRIPT_OR_DATA:cX,MUSTACHE_EXPR:oX,TMPLIT_EXPR:aX});const kh={element:1,text:3,progressingInstruction:7,comment:8,document:9},fX=function(){return typeof window>"u"?null:window},gX=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},zP=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function MD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fX();const e=ye=>MD(ye);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==kh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,w=Dh(g,"cloneNode"),C=Dh(g,"remove"),R=Dh(g,"nextSibling"),y=Dh(g,"childNodes"),M=Dh(g,"parentNode");if(typeof s=="function"){const ye=n.createElement("template");ye.content&&ye.content.ownerDocument&&(n=ye.content.ownerDocument)}let x,_="";const{implementation:T,createNodeIterator:I,createDocumentFragment:Y,getElementsByTagName:U}=n,{importNode:V}=r;let q=zP();e.isSupported=typeof SD=="function"&&typeof M=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ee,ERB_EXPR:Q,TMPLIT_EXPR:ne,DATA_ATTR:pe,ARIA_ATTR:it,IS_SCRIPT_OR_DATA:Ee,ATTR_WHITESPACE:Ae,CUSTOM_ELEMENT:ut}=UP;let{IS_ALLOWED_URI:In}=UP,ct=null;const m=je({},[...VP,...uC,...cC,...hC,...BP]);let v=null;const p=je({},[...WP,...dC,...jP,...Yg]);let A=Object.seal(RD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,j=null,K=!0,J=!0,b=!1,E=!0,S=!1,$=!0,O=!1,N=!1,W=!1,H=!1,D=!1,B=!1,F=!0,G=!1;const ae="user-content-";let ce=!0,_e=!1,Fe={},Ye=null;const Me=je({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Be=null;const Ot=je({},["audio","video","img","source","image","track"]);let Ni=null;const is=je({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ii="http://www.w3.org/1998/Math/MathML",At="http://www.w3.org/2000/svg",pn="http://www.w3.org/1999/xhtml";let Tt=pn,Ht=!1,We=null;const oi=je({},[ii,At,pn],lC);let el=je({},["mi","mo","mn","ms","mtext"]),tl=je({},["annotation-xml"]);const UV=je({},["title","style","font","a","script"]);let Mh=null;const zV=["application/xhtml+xml","text/html"],YV="text/html";let On=null,Nu=null;const GV=n.createElement("form"),Z_=function(k){return k instanceof RegExp||k instanceof Function},_y=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Nu&&Nu===k)){if((!k||typeof k!="object")&&(k={}),k=jl(k),Mh=zV.indexOf(k.PARSER_MEDIA_TYPE)===-1?YV:k.PARSER_MEDIA_TYPE,On=Mh==="application/xhtml+xml"?lC:Ap,ct=Ui(k,"ALLOWED_TAGS")?je({},k.ALLOWED_TAGS,On):m,v=Ui(k,"ALLOWED_ATTR")?je({},k.ALLOWED_ATTR,On):p,We=Ui(k,"ALLOWED_NAMESPACES")?je({},k.ALLOWED_NAMESPACES,lC):oi,Ni=Ui(k,"ADD_URI_SAFE_ATTR")?je(jl(is),k.ADD_URI_SAFE_ATTR,On):is,Be=Ui(k,"ADD_DATA_URI_TAGS")?je(jl(Ot),k.ADD_DATA_URI_TAGS,On):Ot,Ye=Ui(k,"FORBID_CONTENTS")?je({},k.FORBID_CONTENTS,On):Me,L=Ui(k,"FORBID_TAGS")?je({},k.FORBID_TAGS,On):{},j=Ui(k,"FORBID_ATTR")?je({},k.FORBID_ATTR,On):{},Fe=Ui(k,"USE_PROFILES")?k.USE_PROFILES:!1,K=k.ALLOW_ARIA_ATTR!==!1,J=k.ALLOW_DATA_ATTR!==!1,b=k.ALLOW_UNKNOWN_PROTOCOLS||!1,E=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=k.SAFE_FOR_TEMPLATES||!1,$=k.SAFE_FOR_XML!==!1,O=k.WHOLE_DOCUMENT||!1,H=k.RETURN_DOM||!1,D=k.RETURN_DOM_FRAGMENT||!1,B=k.RETURN_TRUSTED_TYPE||!1,W=k.FORCE_BODY||!1,F=k.SANITIZE_DOM!==!1,G=k.SANITIZE_NAMED_PROPS||!1,ce=k.KEEP_CONTENT!==!1,_e=k.IN_PLACE||!1,In=k.ALLOWED_URI_REGEXP||ED,Tt=k.NAMESPACE||pn,el=k.MATHML_TEXT_INTEGRATION_POINTS||el,tl=k.HTML_INTEGRATION_POINTS||tl,A=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&Z_(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(A.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&Z_(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(A.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(A.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(J=!1),D&&(H=!0),Fe&&(ct=je({},BP),v=[],Fe.html===!0&&(je(ct,VP),je(v,WP)),Fe.svg===!0&&(je(ct,uC),je(v,dC),je(v,Yg)),Fe.svgFilters===!0&&(je(ct,cC),je(v,dC),je(v,Yg)),Fe.mathMl===!0&&(je(ct,hC),je(v,jP),je(v,Yg))),k.ADD_TAGS&&(ct===m&&(ct=jl(ct)),je(ct,k.ADD_TAGS,On)),k.ADD_ATTR&&(v===p&&(v=jl(v)),je(v,k.ADD_ATTR,On)),k.ADD_URI_SAFE_ATTR&&je(Ni,k.ADD_URI_SAFE_ATTR,On),k.FORBID_CONTENTS&&(Ye===Me&&(Ye=jl(Ye)),je(Ye,k.FORBID_CONTENTS,On)),ce&&(ct["#text"]=!0),O&&je(ct,["html","head","body"]),ct.table&&(je(ct,["tbody"]),delete L.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Nh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Nh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=k.TRUSTED_TYPES_POLICY,_=x.createHTML("")}else x===void 0&&(x=gX(f,i)),x!==null&&typeof _=="string"&&(_=x.createHTML(""));fr&&fr(k),Nu=k}},Q_=je({},[...uC,...cC,...rX]),ex=je({},[...hC,...iX]),KV=function(k){let re=M(k);(!re||!re.tagName)&&(re={namespaceURI:Tt,tagName:"template"});const me=Ap(k.tagName),Vt=Ap(re.tagName);return We[k.namespaceURI]?k.namespaceURI===At?re.namespaceURI===pn?me==="svg":re.namespaceURI===ii?me==="svg"&&(Vt==="annotation-xml"||el[Vt]):!!Q_[me]:k.namespaceURI===ii?re.namespaceURI===pn?me==="math":re.namespaceURI===At?me==="math"&&tl[Vt]:!!ex[me]:k.namespaceURI===pn?re.namespaceURI===At&&!tl[Vt]||re.namespaceURI===ii&&!el[Vt]?!1:!ex[me]&&(UV[me]||!Q_[me]):!!(Mh==="application/xhtml+xml"&&We[k.namespaceURI]):!1},co=function(k){Ah(e.removed,{element:k});try{M(k).removeChild(k)}catch{C(k)}},Hg=function(k,re){try{Ah(e.removed,{attribute:re.getAttributeNode(k),from:re})}catch{Ah(e.removed,{attribute:null,from:re})}if(re.removeAttribute(k),k==="is")if(H||D)try{co(re)}catch{}else try{re.setAttribute(k,"")}catch{}},tx=function(k){let re=null,me=null;if(W)k="<remove></remove>"+k;else{const $n=FP(k,/^[\r\n\t ]+/);me=$n&&$n[0]}Mh==="application/xhtml+xml"&&Tt===pn&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const Vt=x?x.createHTML(k):k;if(Tt===pn)try{re=new d().parseFromString(Vt,Mh)}catch{}if(!re||!re.documentElement){re=T.createDocument(Tt,"template",null);try{re.documentElement.innerHTML=Ht?_:Vt}catch{}}const Wn=re.body||re.documentElement;return k&&me&&Wn.insertBefore(n.createTextNode(me),Wn.childNodes[0]||null),Tt===pn?U.call(re,O?"html":"body")[0]:O?re.documentElement:Wn},nx=function(k){return I.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},xy=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},rx=function(k){return typeof a=="function"&&k instanceof a};function os(ye,k,re){zg(ye,me=>{me.call(e,k,re,Nu)})}const ix=function(k){let re=null;if(os(q.beforeSanitizeElements,k,null),xy(k))return co(k),!0;const me=On(k.nodeName);if(os(q.uponSanitizeElement,k,{tagName:me,allowedTags:ct}),k.hasChildNodes()&&!rx(k.firstElementChild)&&rr(/<[/\w!]/g,k.innerHTML)&&rr(/<[/\w!]/g,k.textContent)||k.nodeType===kh.progressingInstruction||$&&k.nodeType===kh.comment&&rr(/<[/\w]/g,k.data))return co(k),!0;if(!ct[me]||L[me]){if(!L[me]&&sx(me)&&(A.tagNameCheck instanceof RegExp&&rr(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me)))return!1;if(ce&&!Ye[me]){const Vt=M(k)||k.parentNode,Wn=y(k)||k.childNodes;if(Wn&&Vt){const $n=Wn.length;for(let wr=$n-1;wr>=0;--wr){const ho=w(Wn[wr],!0);ho.__removalCount=(k.__removalCount||0)+1,Vt.insertBefore(ho,R(k))}}}return co(k),!0}return k instanceof l&&!KV(k)||(me==="noscript"||me==="noembed"||me==="noframes")&&rr(/<\/no(script|embed|frames)/i,k.innerHTML)?(co(k),!0):(S&&k.nodeType===kh.text&&(re=k.textContent,zg([ee,Q,ne],Vt=>{re=Hh(re,Vt," ")}),k.textContent!==re&&(Ah(e.removed,{element:k.cloneNode()}),k.textContent=re)),os(q.afterSanitizeElements,k,null),!1)},ox=function(k,re,me){if(F&&(re==="id"||re==="name")&&(me in n||me in GV))return!1;if(!(J&&!j[re]&&rr(pe,re))){if(!(K&&rr(it,re))){if(!v[re]||j[re]){if(!(sx(k)&&(A.tagNameCheck instanceof RegExp&&rr(A.tagNameCheck,k)||A.tagNameCheck instanceof Function&&A.tagNameCheck(k))&&(A.attributeNameCheck instanceof RegExp&&rr(A.attributeNameCheck,re)||A.attributeNameCheck instanceof Function&&A.attributeNameCheck(re))||re==="is"&&A.allowCustomizedBuiltInElements&&(A.tagNameCheck instanceof RegExp&&rr(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me))))return!1}else if(!Ni[re]){if(!rr(In,Hh(me,Ae,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&k!=="script"&&Q4(me,"data:")===0&&Be[k])){if(!(b&&!rr(Ee,Hh(me,Ae,"")))){if(me)return!1}}}}}}return!0},sx=function(k){return k!=="annotation-xml"&&FP(k,ut)},ax=function(k){os(q.beforeSanitizeAttributes,k,null);const{attributes:re}=k;if(!re||xy(k))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:v,forceKeepAttr:void 0};let Vt=re.length;for(;Vt--;){const Wn=re[Vt],{name:$n,namespaceURI:wr,value:ho}=Wn,_h=On($n);let nr=$n==="value"?ho:eX(ho);if(me.attrName=_h,me.attrValue=nr,me.keepAttr=!0,me.forceKeepAttr=void 0,os(q.uponSanitizeAttribute,k,me),nr=me.attrValue,G&&(_h==="id"||_h==="name")&&(Hg($n,k),nr=ae+nr),$&&rr(/((--!?|])>)|<\/(style|title)/i,nr)){Hg($n,k);continue}if(me.forceKeepAttr||(Hg($n,k),!me.keepAttr))continue;if(!E&&rr(/\/>/i,nr)){Hg($n,k);continue}S&&zg([ee,Q,ne],ux=>{nr=Hh(nr,ux," ")});const lx=On(k.nodeName);if(ox(lx,_h,nr)){if(x&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!wr)switch(f.getAttributeType(lx,_h)){case"TrustedHTML":{nr=x.createHTML(nr);break}case"TrustedScriptURL":{nr=x.createScriptURL(nr);break}}try{wr?k.setAttributeNS(wr,$n,nr):k.setAttribute($n,nr),xy(k)?co(k):LP(e.removed)}catch{}}}os(q.afterSanitizeAttributes,k,null)},qV=function ye(k){let re=null;const me=nx(k);for(os(q.beforeSanitizeShadowDOM,k,null);re=me.nextNode();)os(q.uponSanitizeShadowNode,re,null),ix(re),ax(re),re.content instanceof o&&ye(re.content);os(q.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(ye){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,me=null,Vt=null,Wn=null;if(Ht=!ye,Ht&&(ye="<!-->"),typeof ye!="string"&&!rx(ye))if(typeof ye.toString=="function"){if(ye=ye.toString(),typeof ye!="string")throw Nh("dirty is not a string, aborting")}else throw Nh("toString is not a function");if(!e.isSupported)return ye;if(N||_y(k),e.removed=[],typeof ye=="string"&&(_e=!1),_e){if(ye.nodeName){const ho=On(ye.nodeName);if(!ct[ho]||L[ho])throw Nh("root node is forbidden and cannot be sanitized in-place")}}else if(ye instanceof a)re=tx("<!---->"),me=re.ownerDocument.importNode(ye,!0),me.nodeType===kh.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?re=me:re.appendChild(me);else{if(!H&&!S&&!O&&ye.indexOf("<")===-1)return x&&B?x.createHTML(ye):ye;if(re=tx(ye),!re)return H?null:B?_:""}re&&W&&co(re.firstChild);const $n=nx(_e?ye:re);for(;Vt=$n.nextNode();)ix(Vt),ax(Vt),Vt.content instanceof o&&qV(Vt.content);if(_e)return ye;if(H){if(D)for(Wn=Y.call(re.ownerDocument);re.firstChild;)Wn.appendChild(re.firstChild);else Wn=re;return(v.shadowroot||v.shadowrootmode)&&(Wn=V.call(r,Wn,!0)),Wn}let wr=O?re.outerHTML:re.innerHTML;return O&&ct["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&rr(TD,re.ownerDocument.doctype.name)&&(wr="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+wr),S&&zg([ee,Q,ne],ho=>{wr=Hh(wr,ho," ")}),x&&B?x.createHTML(wr):wr},e.setConfig=function(){let ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_y(ye),N=!0},e.clearConfig=function(){Nu=null,N=!1},e.isValidAttribute=function(ye,k,re){Nu||_y({});const me=On(ye),Vt=On(k);return ox(me,Vt,re)},e.addHook=function(ye,k){typeof k=="function"&&Ah(q[ye],k)},e.removeHook=function(ye,k){if(k!==void 0){const re=J4(q[ye],k);return re===-1?void 0:Z4(q[ye],re,1)[0]}return LP(q[ye])},e.removeHooks=function(ye){q[ye]=[]},e.removeAllHooks=function(){q=zP()},e}var mX=MD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var _D;function Z(){return _D.apply(null,arguments)}function pX(t){_D=t}function io(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function iu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function at(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function oE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(at(t,e))return!1;return!0}function _r(t){return t===void 0}function js(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function ug(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function xD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Oa(t,e){for(var n in e)at(e,n)&&(t[n]=e[n]);return at(e,"toString")&&(t.toString=e.toString),at(e,"valueOf")&&(t.valueOf=e.valueOf),t}function es(t,e,n,r){return JD(t,e,n,r,!0).utc()}function wX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ne(t){return t._pf==null&&(t._pf=wX()),t._pf}var uR;Array.prototype.some?uR=Array.prototype.some:uR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function sE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ne(t),n=uR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function xv(t){var e=es(NaN);return t!=null?Oa(Ne(e),t):Ne(e).userInvalidated=!0,e}var YP=Z.momentProperties=[],fC=!1;function aE(t,e){var n,r,i,o=YP.length;if(_r(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),_r(e._i)||(t._i=e._i),_r(e._f)||(t._f=e._f),_r(e._l)||(t._l=e._l),_r(e._strict)||(t._strict=e._strict),_r(e._tzm)||(t._tzm=e._tzm),_r(e._isUTC)||(t._isUTC=e._isUTC),_r(e._offset)||(t._offset=e._offset),_r(e._pf)||(t._pf=Ne(e)),_r(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=YP[n],i=e[r],_r(i)||(t[r]=i);return t}function cg(t){aE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),fC===!1&&(fC=!0,Z.updateOffset(this),fC=!1)}function oo(t){return t instanceof cg||t!=null&&t._isAMomentObject!=null}function PD(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ii(t,e){var n=!0;return Oa(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])at(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}PD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var GP={};function ID(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),GP[t]||(PD(e),GP[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function ts(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function vX(t){var e,n;for(n in t)at(t,n)&&(e=t[n],ts(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function cR(t,e){var n=Oa({},t),r;for(r in e)at(e,r)&&(iu(t[r])&&iu(e[r])?(n[r]={},Oa(n[r],t[r]),Oa(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)at(t,r)&&!at(e,r)&&iu(t[r])&&(n[r]=Oa({},n[r]));return n}function lE(t){t!=null&&this.set(t)}var hR;Object.keys?hR=Object.keys:hR=function(t){var e,n=[];for(e in t)at(t,e)&&n.push(e);return n};var yX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function CX(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return ts(r)?r.call(e,n):r}function qo(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var uE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Gg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,gC={},Vc={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Vc[t]=i),e&&(Vc[e[0]]=function(){return qo(i.apply(this,arguments),e[1],e[2])}),n&&(Vc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function bX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function SX(t){var e=t.match(uE),n,r;for(n=0,r=e.length;n<r;n++)Vc[e[n]]?e[n]=Vc[e[n]]:e[n]=bX(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=ts(e[s])?e[s].call(i,t):e[s];return o}}function Hp(t,e){return t.isValid()?(e=OD(e,t.localeData()),gC[e]=gC[e]||SX(e),gC[e](t)):t.localeData().invalidDate()}function OD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Gg.lastIndex=0;n>=0&&Gg.test(t);)t=t.replace(Gg,r),Gg.lastIndex=0,n-=1;return t}var RX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function EX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(uE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var TX="Invalid date";function MX(){return this._invalidDate}var _X="%d",xX=/\d{1,2}/;function PX(t){return this._ordinal.replace("%d",t)}var IX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function OX(t,e,n,r){var i=this._relativeTime[n];return ts(i)?i(t,e,n,r):i.replace(/%d/i,t)}function AX(t,e){var n=this._relativeTime[t>0?"future":"past"];return ts(n)?n(e):n.replace(/%s/i,e)}var KP={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Oi(t){return typeof t=="string"?KP[t]||KP[t.toLowerCase()]:void 0}function cE(t){var e={},n,r;for(r in t)at(t,r)&&(n=Oi(r),n&&(e[n]=t[r]));return e}var HX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function NX(t){var e=[],n;for(n in t)at(t,n)&&e.push({unit:n,priority:HX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var AD=/\d/,ri=/\d\d/,HD=/\d{3}/,hE=/\d{4}/,Pv=/[+-]?\d{6}/,Ft=/\d\d?/,ND=/\d\d\d\d?/,DD=/\d\d\d\d\d\d?/,Iv=/\d{1,3}/,dE=/\d{1,4}/,Ov=/[+-]?\d{1,6}/,mh=/\d+/,Av=/[+-]?\d+/,DX=/Z|[+-]\d\d:?\d\d/gi,Hv=/Z|[+-]\d\d(?::?\d\d)?/gi,kX=/[+-]?\d+(\.\d{1,3})?/,hg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ph=/^[1-9]\d?/,fE=/^([1-9]\d|\d)/,Cw;Cw={};function ue(t,e,n){Cw[t]=ts(e)?e:function(r,i){return r&&n?n:e}}function $X(t,e){return at(Cw,t)?Cw[t](e._strict,e._locale):new RegExp(LX(t))}function LX(t){return Bs(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Bs(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function yi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=yi(e)),n}var dR={};function St(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),js(e)&&(r=function(o,s){s[e]=qe(o)}),i=t.length,n=0;n<i;n++)dR[t[n]]=r}function dg(t,e){St(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function FX(t,e,n){e!=null&&at(dR,t)&&dR[t](e,n._a,n,t)}function Nv(t){return t%4===0&&t%100!==0||t%400===0}var Zn=0,Hs=1,Fo=2,xn=3,to=4,Ns=5,Jl=6,VX=7,BX=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?qo(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ue("Y",Av);ue("YY",Ft,ri);ue("YYYY",dE,hE);ue("YYYYY",Ov,Pv);ue("YYYYYY",Ov,Pv);St(["YYYYY","YYYYYY"],Zn);St("YYYY",function(t,e){e[Zn]=t.length===2?Z.parseTwoDigitYear(t):qe(t)});St("YY",function(t,e){e[Zn]=Z.parseTwoDigitYear(t)});St("Y",function(t,e){e[Zn]=parseInt(t,10)});function Yd(t){return Nv(t)?366:365}Z.parseTwoDigitYear=function(t){return qe(t)+(qe(t)>68?1900:2e3)};var kD=wh("FullYear",!0);function WX(){return Nv(this.year())}function wh(t,e){return function(n){return n!=null?($D(this,t,n),Z.updateOffset(this,e),this):Tf(this,t)}}function Tf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function $D(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Nv(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function jX(t){return t=Oi(t),ts(this[t])?this[t]():this}function UX(t,e){if(typeof t=="object"){t=cE(t);var n=NX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Oi(t),ts(this[t]))return this[t](e);return this}function zX(t,e){return(t%e+e)%e}var ln;Array.prototype.indexOf?ln=Array.prototype.indexOf:ln=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function gE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=zX(e,12);return t+=(e-n)/12,n===1?Nv(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Ft,ph);ue("MM",Ft,ri);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});St(["M","MM"],function(t,e){e[Hs]=qe(t)-1});St(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Hs]=i:Ne(n).invalidMonth=t});var YX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),LD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),FD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,GX=hg,KX=hg;function qX(t,e){return t?io(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||FD).test(e)?"format":"standalone"][t.month()]:io(this._months)?this._months:this._months.standalone}function XX(t,e){return t?io(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[FD.test(e)?"format":"standalone"][t.month()]:io(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function JX(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=es([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=ln.call(this._shortMonthsParse,s),i!==-1?i:null):(i=ln.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=ln.call(this._shortMonthsParse,s),i!==-1?i:(i=ln.call(this._longMonthsParse,s),i!==-1?i:null)):(i=ln.call(this._longMonthsParse,s),i!==-1?i:(i=ln.call(this._shortMonthsParse,s),i!==-1?i:null))}function ZX(t,e,n){var r,i,o;if(this._monthsParseExact)return JX.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=es([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function VD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=qe(e);else if(e=t.localeData().monthsParse(e),!js(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,gE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function BD(t){return t!=null?(VD(this,t),Z.updateOffset(this,!0),this):Tf(this,"Month")}function QX(){return gE(this.year(),this.month())}function e6(t){return this._monthsParseExact?(at(this,"_monthsRegex")||WD.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=GX),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function t6(t){return this._monthsParseExact?(at(this,"_monthsRegex")||WD.call(this),t?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=KX),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function WD(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=es([2e3,i]),s=Bs(this.monthsShort(o,"")),a=Bs(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function n6(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Mf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function bw(t,e,n){var r=7+e-n,i=(7+Mf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function jD(t,e,n,r,i){var o=(7+n-r)%7,s=bw(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Yd(l)+a):a>Yd(t)?(l=t+1,u=a-Yd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function _f(t,e,n){var r=bw(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Ws(s,e,n)):i>Ws(t.year(),e,n)?(o=i-Ws(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Ws(t,e,n){var r=bw(t,e,n),i=bw(t+1,e,n);return(Yd(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ue("w",Ft,ph);ue("ww",Ft,ri);ue("W",Ft,ph);ue("WW",Ft,ri);dg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=qe(t)});function r6(t){return _f(t,this._week.dow,this._week.doy).week}var i6={dow:0,doy:6};function o6(){return this._week.dow}function s6(){return this._week.doy}function a6(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function l6(t){var e=_f(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ue("d",Ft);ue("e",Ft);ue("E",Ft);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});dg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ne(n).invalidWeekday=t});dg(["d","e","E"],function(t,e,n,r){e[r]=qe(t)});function u6(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function c6(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function mE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var h6="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),UD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),d6="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),f6=hg,g6=hg,m6=hg;function p6(t,e){var n=io(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?mE(n,this._week.dow):t?n[t.day()]:n}function w6(t){return t===!0?mE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function v6(t){return t===!0?mE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function y6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=es([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=ln.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=ln.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=ln.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=ln.call(this._weekdaysParse,s),i!==-1||(i=ln.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=ln.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=ln.call(this._shortWeekdaysParse,s),i!==-1||(i=ln.call(this._weekdaysParse,s),i!==-1)?i:(i=ln.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=ln.call(this._minWeekdaysParse,s),i!==-1||(i=ln.call(this._weekdaysParse,s),i!==-1)?i:(i=ln.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function C6(t,e,n){var r,i,o;if(this._weekdaysParseExact)return y6.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=es([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function b6(t){if(!this.isValid())return t!=null?this:NaN;var e=Tf(this,"Day");return t!=null?(t=u6(t,this.localeData()),this.add(t-e,"d")):e}function S6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function R6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=c6(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function E6(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||pE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=f6),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function T6(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||pE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=g6),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function M6(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||pE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=m6),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function pE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=es([2e3,1]).day(o),a=Bs(this.weekdaysMin(s,"")),l=Bs(this.weekdaysShort(s,"")),u=Bs(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function wE(){return this.hours()%12||12}function _6(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,wE);Ce("k",["kk",2],0,_6);Ce("hmm",0,0,function(){return""+wE.apply(this)+qo(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+wE.apply(this)+qo(this.minutes(),2)+qo(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+qo(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+qo(this.minutes(),2)+qo(this.seconds(),2)});function zD(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}zD("a",!0);zD("A",!1);function YD(t,e){return e._meridiemParse}ue("a",YD);ue("A",YD);ue("H",Ft,fE);ue("h",Ft,ph);ue("k",Ft,ph);ue("HH",Ft,ri);ue("hh",Ft,ri);ue("kk",Ft,ri);ue("hmm",ND);ue("hmmss",DD);ue("Hmm",ND);ue("Hmmss",DD);St(["H","HH"],xn);St(["k","kk"],function(t,e,n){var r=qe(t);e[xn]=r===24?0:r});St(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});St(["h","hh"],function(t,e,n){e[xn]=qe(t),Ne(n).bigHour=!0});St("hmm",function(t,e,n){var r=t.length-2;e[xn]=qe(t.substr(0,r)),e[to]=qe(t.substr(r)),Ne(n).bigHour=!0});St("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[xn]=qe(t.substr(0,r)),e[to]=qe(t.substr(r,2)),e[Ns]=qe(t.substr(i)),Ne(n).bigHour=!0});St("Hmm",function(t,e,n){var r=t.length-2;e[xn]=qe(t.substr(0,r)),e[to]=qe(t.substr(r))});St("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[xn]=qe(t.substr(0,r)),e[to]=qe(t.substr(r,2)),e[Ns]=qe(t.substr(i))});function x6(t){return(t+"").toLowerCase().charAt(0)==="p"}var P6=/[ap]\.?m?\.?/i,I6=wh("Hours",!0);function O6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var GD={calendar:yX,longDateFormat:RX,invalidDate:TX,ordinal:_X,dayOfMonthOrdinalParse:xX,relativeTime:IX,months:YX,monthsShort:LD,week:i6,weekdays:h6,weekdaysMin:d6,weekdaysShort:UD,meridiemParse:P6},Bt={},$h={},xf;function A6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function qP(t){return t&&t.toLowerCase().replace("_","-")}function H6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=qP(t[e]).split("-"),n=o.length,r=qP(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Dv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&A6(o,r)>=n-1)break;n--}e++}return xf}function N6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Dv(t){var e=null,n;if(Bt[t]===void 0&&typeof nw<"u"&&nw&&nw.exports&&N6(t))try{e=xf._abbr,n=require,n("./locale/"+t),La(e)}catch{Bt[t]=null}return Bt[t]}function La(t,e){var n;return t&&(_r(e)?n=qs(t):n=vE(t,e),n?xf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),xf._abbr}function vE(t,e){if(e!==null){var n,r=GD;if(e.abbr=t,Bt[t]!=null)ID("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Bt[t]._config;else if(e.parentLocale!=null)if(Bt[e.parentLocale]!=null)r=Bt[e.parentLocale]._config;else if(n=Dv(e.parentLocale),n!=null)r=n._config;else return $h[e.parentLocale]||($h[e.parentLocale]=[]),$h[e.parentLocale].push({name:t,config:e}),null;return Bt[t]=new lE(cR(r,e)),$h[t]&&$h[t].forEach(function(i){vE(i.name,i.config)}),La(t),Bt[t]}else return delete Bt[t],null}function D6(t,e){if(e!=null){var n,r,i=GD;Bt[t]!=null&&Bt[t].parentLocale!=null?Bt[t].set(cR(Bt[t]._config,e)):(r=Dv(t),r!=null&&(i=r._config),e=cR(i,e),r==null&&(e.abbr=t),n=new lE(e),n.parentLocale=Bt[t],Bt[t]=n),La(t)}else Bt[t]!=null&&(Bt[t].parentLocale!=null?(Bt[t]=Bt[t].parentLocale,t===La()&&La(t)):Bt[t]!=null&&delete Bt[t]);return Bt[t]}function qs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return xf;if(!io(t)){if(e=Dv(t),e)return e;t=[t]}return H6(t)}function k6(){return hR(Bt)}function yE(t){var e,n=t._a;return n&&Ne(t).overflow===-2&&(e=n[Hs]<0||n[Hs]>11?Hs:n[Fo]<1||n[Fo]>gE(n[Zn],n[Hs])?Fo:n[xn]<0||n[xn]>24||n[xn]===24&&(n[to]!==0||n[Ns]!==0||n[Jl]!==0)?xn:n[to]<0||n[to]>59?to:n[Ns]<0||n[Ns]>59?Ns:n[Jl]<0||n[Jl]>999?Jl:-1,Ne(t)._overflowDayOfYear&&(e<Zn||e>Fo)&&(e=Fo),Ne(t)._overflowWeeks&&e===-1&&(e=VX),Ne(t)._overflowWeekday&&e===-1&&(e=BX),Ne(t).overflow=e),t}var $6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,L6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,F6=/Z|[+-]\d\d(?::?\d\d)?/,Kg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],mC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],V6=/^\/?Date\((-?\d+)/i,B6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,W6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function KD(t){var e,n,r=t._i,i=$6.exec(r)||L6.exec(r),o,s,a,l,u=Kg.length,c=mC.length;if(i){for(Ne(t).iso=!0,e=0,n=u;e<n;e++)if(Kg[e][1].exec(i[1])){s=Kg[e][0],o=Kg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(mC[e][1].exec(i[3])){a=(i[2]||" ")+mC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(F6.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),bE(t)}else t._isValid=!1}function j6(t,e,n,r,i,o){var s=[U6(t),LD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function U6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function z6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Y6(t,e,n){if(t){var r=UD.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ne(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function G6(t,e,n){if(t)return W6[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function qD(t){var e=B6.exec(z6(t._i)),n;if(e){if(n=j6(e[4],e[3],e[2],e[5],e[6],e[7]),!Y6(e[1],n,t))return;t._a=n,t._tzm=G6(e[8],e[9],e[10]),t._d=Mf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ne(t).rfc2822=!0}else t._isValid=!1}function K6(t){var e=V6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(KD(t),t._isValid===!1)delete t._isValid;else return;if(qD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=Ii("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Cc(t,e,n){return t??e??n}function q6(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function CE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=q6(t),t._w&&t._a[Fo]==null&&t._a[Hs]==null&&X6(t),t._dayOfYear!=null&&(s=Cc(t._a[Zn],i[Zn]),(t._dayOfYear>Yd(s)||t._dayOfYear===0)&&(Ne(t)._overflowDayOfYear=!0),n=Mf(s,0,t._dayOfYear),t._a[Hs]=n.getUTCMonth(),t._a[Fo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[xn]===24&&t._a[to]===0&&t._a[Ns]===0&&t._a[Jl]===0&&(t._nextDay=!0,t._a[xn]=0),t._d=(t._useUTC?Mf:n6).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[xn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ne(t).weekdayMismatch=!0)}}function X6(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Cc(e.GG,t._a[Zn],_f(Lt(),1,4).year),r=Cc(e.W,1),i=Cc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=_f(Lt(),o,s),n=Cc(e.gg,t._a[Zn],u.year),r=Cc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Ws(n,o,s)?Ne(t)._overflowWeeks=!0:l!=null?Ne(t)._overflowWeekday=!0:(a=jD(n,r,i,o,s),t._a[Zn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function bE(t){if(t._f===Z.ISO_8601){KD(t);return}if(t._f===Z.RFC_2822){qD(t);return}t._a=[],Ne(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=OD(t._f,t._locale).match(uE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match($X(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ne(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Vc[o]?(r?Ne(t).empty=!1:Ne(t).unusedTokens.push(o),FX(o,r,t)):t._strict&&!r&&Ne(t).unusedTokens.push(o);Ne(t).charsLeftOver=a-l,e.length>0&&Ne(t).unusedInput.push(e),t._a[xn]<=12&&Ne(t).bigHour===!0&&t._a[xn]>0&&(Ne(t).bigHour=void 0),Ne(t).parsedDateParts=t._a.slice(0),Ne(t).meridiem=t._meridiem,t._a[xn]=J6(t._locale,t._a[xn],t._meridiem),u=Ne(t).era,u!==null&&(t._a[Zn]=t._locale.erasConvertYear(u,t._a[Zn])),CE(t),yE(t)}function J6(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function Z6(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ne(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=aE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],bE(e),sE(e)&&(s=!0),o+=Ne(e).charsLeftOver,o+=Ne(e).unusedTokens.length*10,Ne(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Oa(t,n||e)}function Q6(t){if(!t._d){var e=cE(t._i),n=e.day===void 0?e.date:e.day;t._a=xD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),CE(t)}}function e7(t){var e=new cg(yE(XD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function XD(t){var e=t._i,n=t._f;return t._locale=t._locale||qs(t._l),e===null||n===void 0&&e===""?xv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),oo(e)?new cg(yE(e)):(ug(e)?t._d=e:io(n)?Z6(t):n?bE(t):t7(t),sE(t)||(t._d=null),t))}function t7(t){var e=t._i;_r(e)?t._d=new Date(Z.now()):ug(e)?t._d=new Date(e.valueOf()):typeof e=="string"?K6(t):io(e)?(t._a=xD(e.slice(0),function(n){return parseInt(n,10)}),CE(t)):iu(e)?Q6(t):js(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function JD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(iu(t)&&oE(t)||io(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,e7(o)}function Lt(t,e,n,r){return JD(t,e,n,r,!1)}var n7=Ii("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Lt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:xv()}),r7=Ii("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Lt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:xv()});function ZD(t,e){var n,r;if(e.length===1&&io(e[0])&&(e=e[0]),!e.length)return Lt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function i7(){var t=[].slice.call(arguments,0);return ZD("isBefore",t)}function o7(){var t=[].slice.call(arguments,0);return ZD("isAfter",t)}var s7=function(){return Date.now?Date.now():+new Date},Lh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function a7(t){var e,n=!1,r,i=Lh.length;for(e in t)if(at(t,e)&&!(ln.call(Lh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Lh[r]]){if(n)return!1;parseFloat(t[Lh[r]])!==qe(t[Lh[r]])&&(n=!0)}return!0}function l7(){return this._isValid}function u7(){return lo(NaN)}function kv(t){var e=cE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=a7(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=qs(),this._bubble()}function Np(t){return t instanceof kv}function fR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function c7(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)qe(t[s])!==qe(e[s])&&o++;return o+i}function QD(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+qo(~~(n/60),2)+e+qo(~~n%60,2)})}QD("Z",":");QD("ZZ","");ue("Z",Hv);ue("ZZ",Hv);St(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=SE(Hv,t)});var h7=/([\+\-]|\d\d)/gi;function SE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(h7)||["-",0,0],o=+(i[1]*60)+qe(i[2]),o===0?0:i[0]==="+"?o:-o)}function RE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(oo(t)||ug(t)?t.valueOf():Lt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Lt(t).local()}function gR(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function d7(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=SE(Hv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=gR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?nk(this,lo(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:gR(this)}function f7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function g7(t){return this.utcOffset(0,t)}function m7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(gR(this),"m")),this}function p7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=SE(DX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function w7(t){return this.isValid()?(t=t?Lt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function v7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function y7(){if(!_r(this._isDSTShifted))return this._isDSTShifted;var t={},e;return aE(t,this),t=XD(t),t._a?(e=t._isUTC?es(t._a):Lt(t._a),this._isDSTShifted=this.isValid()&&c7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function C7(){return this.isValid()?!this._isUTC:!1}function b7(){return this.isValid()?this._isUTC:!1}function ek(){return this.isValid()?this._isUTC&&this._offset===0:!1}var S7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,R7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function lo(t,e){var n=t,r=null,i,o,s;return Np(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:js(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=S7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:qe(r[Fo])*i,h:qe(r[xn])*i,m:qe(r[to])*i,s:qe(r[Ns])*i,ms:qe(fR(r[Jl]*1e3))*i}):(r=R7.exec(t))?(i=r[1]==="-"?-1:1,n={y:il(r[2],i),M:il(r[3],i),w:il(r[4],i),d:il(r[5],i),h:il(r[6],i),m:il(r[7],i),s:il(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=E7(Lt(n.from),Lt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new kv(n),Np(t)&&at(t,"_locale")&&(o._locale=t._locale),Np(t)&&at(t,"_isValid")&&(o._isValid=t._isValid),o}lo.fn=kv.prototype;lo.invalid=u7;function il(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function XP(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function E7(t,e){var n;return t.isValid()&&e.isValid()?(e=RE(e,t),t.isBefore(e)?n=XP(t,e):(n=XP(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function tk(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(ID(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=lo(n,r),nk(this,i,t),this}}function nk(t,e,n,r){var i=e._milliseconds,o=fR(e._days),s=fR(e._months);t.isValid()&&(r=r??!0,s&&VD(t,Tf(t,"Month")+s*n),o&&$D(t,"Date",Tf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var T7=tk(1,"add"),M7=tk(-1,"subtract");function rk(t){return typeof t=="string"||t instanceof String}function _7(t){return oo(t)||ug(t)||rk(t)||js(t)||P7(t)||x7(t)||t===null||t===void 0}function x7(t){var e=iu(t)&&!oE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||at(t,o);return e&&n}function P7(t){var e=io(t),n=!1;return e&&(n=t.filter(function(r){return!js(r)&&rk(t)}).length===0),e&&n}function I7(t){var e=iu(t)&&!oE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||at(t,o);return e&&n}function O7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function A7(t,e){arguments.length===1&&(arguments[0]?_7(arguments[0])?(t=arguments[0],e=void 0):I7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Lt(),r=RE(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(ts(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Lt(n)))}function H7(){return new cg(this)}function N7(t,e){var n=oo(t)?t:Lt(t);return this.isValid()&&n.isValid()?(e=Oi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function D7(t,e){var n=oo(t)?t:Lt(t);return this.isValid()&&n.isValid()?(e=Oi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function k7(t,e,n,r){var i=oo(t)?t:Lt(t),o=oo(e)?e:Lt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function $7(t,e){var n=oo(t)?t:Lt(t),r;return this.isValid()&&n.isValid()?(e=Oi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function L7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function F7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function V7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=RE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Oi(e),e){case"year":o=Dp(this,r)/12;break;case"month":o=Dp(this,r);break;case"quarter":o=Dp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:yi(o)}function Dp(t,e){if(t.date()<e.date())return-Dp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function B7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function W7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Hp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ts(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Hp(n,"Z")):Hp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function j7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function U7(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Hp(this,t);return this.localeData().postformat(e)}function z7(t,e){return this.isValid()&&(oo(t)&&t.isValid()||Lt(t).isValid())?lo({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Y7(t){return this.from(Lt(),t)}function G7(t,e){return this.isValid()&&(oo(t)&&t.isValid()||Lt(t).isValid())?lo({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function K7(t){return this.to(Lt(),t)}function ik(t){var e;return t===void 0?this._locale._abbr:(e=qs(t),e!=null&&(this._locale=e),this)}var ok=Ii("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function sk(){return this._locale}var Sw=1e3,Bc=60*Sw,Rw=60*Bc,ak=(365*400+97)*24*Rw;function Wc(t,e){return(t%e+e)%e}function lk(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-ak:new Date(t,e,n).valueOf()}function uk(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-ak:Date.UTC(t,e,n)}function q7(t){var e,n;if(t=Oi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?uk:lk,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Wc(e+(this._isUTC?0:this.utcOffset()*Bc),Rw);break;case"minute":e=this._d.valueOf(),e-=Wc(e,Bc);break;case"second":e=this._d.valueOf(),e-=Wc(e,Sw);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function X7(t){var e,n;if(t=Oi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?uk:lk,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Rw-Wc(e+(this._isUTC?0:this.utcOffset()*Bc),Rw)-1;break;case"minute":e=this._d.valueOf(),e+=Bc-Wc(e,Bc)-1;break;case"second":e=this._d.valueOf(),e+=Sw-Wc(e,Sw)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function J7(){return this._d.valueOf()-(this._offset||0)*6e4}function Z7(){return Math.floor(this.valueOf()/1e3)}function Q7(){return new Date(this.valueOf())}function e9(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function t9(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function n9(){return this.isValid()?this.toISOString():null}function r9(){return sE(this)}function i9(){return Oa({},Ne(this))}function o9(){return Ne(this).overflow}function s9(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ue("N",EE);ue("NN",EE);ue("NNN",EE);ue("NNNN",w9);ue("NNNNN",v9);St(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ne(n).era=i:Ne(n).invalidEra=t});ue("y",mh);ue("yy",mh);ue("yyy",mh);ue("yyyy",mh);ue("yo",y9);St(["y","yy","yyy","yyyy"],Zn);St(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Zn]=n._locale.eraYearOrdinalParse(t,i):e[Zn]=parseInt(t,10)});function a9(t,e){var n,r,i,o=this._eras||qs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function l9(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function u9(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function c9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function h9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function d9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function f9(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function g9(t){return at(this,"_erasNameRegex")||TE.call(this),t?this._erasNameRegex:this._erasRegex}function m9(t){return at(this,"_erasAbbrRegex")||TE.call(this),t?this._erasAbbrRegex:this._erasRegex}function p9(t){return at(this,"_erasNarrowRegex")||TE.call(this),t?this._erasNarrowRegex:this._erasRegex}function EE(t,e){return e.erasAbbrRegex(t)}function w9(t,e){return e.erasNameRegex(t)}function v9(t,e){return e.erasNarrowRegex(t)}function y9(t,e){return e._eraYearOrdinalRegex||mh}function TE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Bs(u[i].name),a=Bs(u[i].abbr),l=Bs(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function $v(t,e){Ce(0,[t,t.length],0,e)}$v("gggg","weekYear");$v("ggggg","weekYear");$v("GGGG","isoWeekYear");$v("GGGGG","isoWeekYear");ue("G",Av);ue("g",Av);ue("GG",Ft,ri);ue("gg",Ft,ri);ue("GGGG",dE,hE);ue("gggg",dE,hE);ue("GGGGG",Ov,Pv);ue("ggggg",Ov,Pv);dg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=qe(t)});dg(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function C9(t){return ck.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function b9(t){return ck.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function S9(){return Ws(this.year(),1,4)}function R9(){return Ws(this.isoWeekYear(),1,4)}function E9(){var t=this.localeData()._week;return Ws(this.year(),t.dow,t.doy)}function T9(){var t=this.localeData()._week;return Ws(this.weekYear(),t.dow,t.doy)}function ck(t,e,n,r,i){var o;return t==null?_f(this,r,i).year:(o=Ws(t,r,i),e>o&&(e=o),M9.call(this,t,e,n,r,i))}function M9(t,e,n,r,i){var o=jD(t,e,n,r,i),s=Mf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ue("Q",AD);St("Q",function(t,e){e[Hs]=(qe(t)-1)*3});function _9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ue("D",Ft,ph);ue("DD",Ft,ri);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});St(["D","DD"],Fo);St("Do",function(t,e){e[Fo]=qe(t.match(Ft)[0])});var hk=wh("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Iv);ue("DDDD",HD);St(["DDD","DDDD"],function(t,e,n){n._dayOfYear=qe(t)});function x9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ue("m",Ft,fE);ue("mm",Ft,ri);St(["m","mm"],to);var P9=wh("Minutes",!1);Ce("s",["ss",2],0,"second");ue("s",Ft,fE);ue("ss",Ft,ri);St(["s","ss"],Ns);var I9=wh("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Iv,AD);ue("SS",Iv,ri);ue("SSS",Iv,HD);var Aa,dk;for(Aa="SSSS";Aa.length<=9;Aa+="S")ue(Aa,mh);function O9(t,e){e[Jl]=qe(("0."+t)*1e3)}for(Aa="S";Aa.length<=9;Aa+="S")St(Aa,O9);dk=wh("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function A9(){return this._isUTC?"UTC":""}function H9(){return this._isUTC?"Coordinated Universal Time":""}var te=cg.prototype;te.add=T7;te.calendar=A7;te.clone=H7;te.diff=V7;te.endOf=X7;te.format=U7;te.from=z7;te.fromNow=Y7;te.to=G7;te.toNow=K7;te.get=jX;te.invalidAt=o9;te.isAfter=N7;te.isBefore=D7;te.isBetween=k7;te.isSame=$7;te.isSameOrAfter=L7;te.isSameOrBefore=F7;te.isValid=r9;te.lang=ok;te.locale=ik;te.localeData=sk;te.max=r7;te.min=n7;te.parsingFlags=i9;te.set=UX;te.startOf=q7;te.subtract=M7;te.toArray=e9;te.toObject=t9;te.toDate=Q7;te.toISOString=W7;te.inspect=j7;typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});te.toJSON=n9;te.toString=B7;te.unix=Z7;te.valueOf=J7;te.creationData=s9;te.eraName=c9;te.eraNarrow=h9;te.eraAbbr=d9;te.eraYear=f9;te.year=kD;te.isLeapYear=WX;te.weekYear=C9;te.isoWeekYear=b9;te.quarter=te.quarters=_9;te.month=BD;te.daysInMonth=QX;te.week=te.weeks=a6;te.isoWeek=te.isoWeeks=l6;te.weeksInYear=E9;te.weeksInWeekYear=T9;te.isoWeeksInYear=S9;te.isoWeeksInISOWeekYear=R9;te.date=hk;te.day=te.days=b6;te.weekday=S6;te.isoWeekday=R6;te.dayOfYear=x9;te.hour=te.hours=I6;te.minute=te.minutes=P9;te.second=te.seconds=I9;te.millisecond=te.milliseconds=dk;te.utcOffset=d7;te.utc=g7;te.local=m7;te.parseZone=p7;te.hasAlignedHourOffset=w7;te.isDST=v7;te.isLocal=C7;te.isUtcOffset=b7;te.isUtc=ek;te.isUTC=ek;te.zoneAbbr=A9;te.zoneName=H9;te.dates=Ii("dates accessor is deprecated. Use date instead.",hk);te.months=Ii("months accessor is deprecated. Use month instead",BD);te.years=Ii("years accessor is deprecated. Use year instead",kD);te.zone=Ii("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",f7);te.isDSTShifted=Ii("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",y7);function N9(t){return Lt(t*1e3)}function D9(){return Lt.apply(null,arguments).parseZone()}function fk(t){return t}var lt=lE.prototype;lt.calendar=CX;lt.longDateFormat=EX;lt.invalidDate=MX;lt.ordinal=PX;lt.preparse=fk;lt.postformat=fk;lt.relativeTime=OX;lt.pastFuture=AX;lt.set=vX;lt.eras=a9;lt.erasParse=l9;lt.erasConvertYear=u9;lt.erasAbbrRegex=m9;lt.erasNameRegex=g9;lt.erasNarrowRegex=p9;lt.months=qX;lt.monthsShort=XX;lt.monthsParse=ZX;lt.monthsRegex=t6;lt.monthsShortRegex=e6;lt.week=r6;lt.firstDayOfYear=s6;lt.firstDayOfWeek=o6;lt.weekdays=p6;lt.weekdaysMin=v6;lt.weekdaysShort=w6;lt.weekdaysParse=C6;lt.weekdaysRegex=E6;lt.weekdaysShortRegex=T6;lt.weekdaysMinRegex=M6;lt.isPM=x6;lt.meridiem=O6;function Ew(t,e,n,r){var i=qs(),o=es().set(r,e);return i[n](o,t)}function gk(t,e,n){if(js(t)&&(e=t,t=void 0),t=t||"",e!=null)return Ew(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Ew(t,r,n,"month");return i}function ME(t,e,n,r){typeof t=="boolean"?(js(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,js(e)&&(n=e,e=void 0),e=e||"");var i=qs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Ew(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Ew(e,(s+o)%7,r,"day");return a}function k9(t,e){return gk(t,e,"months")}function $9(t,e){return gk(t,e,"monthsShort")}function L9(t,e,n){return ME(t,e,n,"weekdays")}function F9(t,e,n){return ME(t,e,n,"weekdaysShort")}function V9(t,e,n){return ME(t,e,n,"weekdaysMin")}La("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=Ii("moment.lang is deprecated. Use moment.locale instead.",La);Z.langData=Ii("moment.langData is deprecated. Use moment.localeData instead.",qs);var ss=Math.abs;function B9(){var t=this._data;return this._milliseconds=ss(this._milliseconds),this._days=ss(this._days),this._months=ss(this._months),t.milliseconds=ss(t.milliseconds),t.seconds=ss(t.seconds),t.minutes=ss(t.minutes),t.hours=ss(t.hours),t.months=ss(t.months),t.years=ss(t.years),this}function mk(t,e,n,r){var i=lo(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function W9(t,e){return mk(this,t,e,1)}function j9(t,e){return mk(this,t,e,-1)}function JP(t){return t<0?Math.floor(t):Math.ceil(t)}function U9(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=JP(mR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=yi(t/1e3),r.seconds=i%60,o=yi(i/60),r.minutes=o%60,s=yi(o/60),r.hours=s%24,e+=yi(s/24),l=yi(pk(e)),n+=l,e-=JP(mR(l)),a=yi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function pk(t){return t*4800/146097}function mR(t){return t*146097/4800}function z9(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Oi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+pk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(mR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Xs(t){return function(){return this.as(t)}}var wk=Xs("ms"),Y9=Xs("s"),G9=Xs("m"),K9=Xs("h"),q9=Xs("d"),X9=Xs("w"),J9=Xs("M"),Z9=Xs("Q"),Q9=Xs("y"),e8=wk;function t8(){return lo(this)}function n8(t){return t=Oi(t),this.isValid()?this[t+"s"]():NaN}function _u(t){return function(){return this.isValid()?this._data[t]:NaN}}var r8=_u("milliseconds"),i8=_u("seconds"),o8=_u("minutes"),s8=_u("hours"),a8=_u("days"),l8=_u("months"),u8=_u("years");function c8(){return yi(this.days()/7)}var Ts=Math.round,Oc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function h8(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function d8(t,e,n,r){var i=lo(t).abs(),o=Ts(i.as("s")),s=Ts(i.as("m")),a=Ts(i.as("h")),l=Ts(i.as("d")),u=Ts(i.as("M")),c=Ts(i.as("w")),h=Ts(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,h8.apply(null,d)}function f8(t){return t===void 0?Ts:typeof t=="function"?(Ts=t,!0):!1}function g8(t,e){return Oc[t]===void 0?!1:e===void 0?Oc[t]:(Oc[t]=e,t==="s"&&(Oc.ss=e-1),!0)}function m8(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Oc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Oc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=d8(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var pC=Math.abs;function ku(t){return(t>0)-(t<0)||+t}function Lv(){if(!this.isValid())return this.localeData().invalidDate();var t=pC(this._milliseconds)/1e3,e=pC(this._days),n=pC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=yi(t/60),i=yi(r/60),t%=60,r%=60,o=yi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ku(this._months)!==ku(a)?"-":"",c=ku(this._days)!==ku(a)?"-":"",h=ku(this._milliseconds)!==ku(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var tt=kv.prototype;tt.isValid=l7;tt.abs=B9;tt.add=W9;tt.subtract=j9;tt.as=z9;tt.asMilliseconds=wk;tt.asSeconds=Y9;tt.asMinutes=G9;tt.asHours=K9;tt.asDays=q9;tt.asWeeks=X9;tt.asMonths=J9;tt.asQuarters=Z9;tt.asYears=Q9;tt.valueOf=e8;tt._bubble=U9;tt.clone=t8;tt.get=n8;tt.milliseconds=r8;tt.seconds=i8;tt.minutes=o8;tt.hours=s8;tt.days=a8;tt.weeks=c8;tt.months=l8;tt.years=u8;tt.humanize=m8;tt.toISOString=Lv;tt.toString=Lv;tt.toJSON=Lv;tt.locale=ik;tt.localeData=sk;tt.toIsoString=Ii("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Lv);tt.lang=ok;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ue("x",Av);ue("X",kX);St("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});St("x",function(t,e,n){n._d=new Date(qe(t))});//! moment.js
Z.version="2.30.1";pX(Lt);Z.fn=te;Z.min=i7;Z.max=o7;Z.now=s7;Z.utc=es;Z.unix=N9;Z.months=k9;Z.isDate=ug;Z.locale=La;Z.invalid=xv;Z.duration=lo;Z.isMoment=oo;Z.weekdays=L9;Z.parseZone=D9;Z.localeData=qs;Z.isDuration=Np;Z.monthsShort=$9;Z.weekdaysMin=V9;Z.defineLocale=vE;Z.updateLocale=D6;Z.locales=k6;Z.weekdaysShort=F9;Z.normalizeUnits=Oi;Z.relativeTimeRounding=f8;Z.relativeTimeThreshold=g8;Z.calendarFormat=O7;Z.prototype=te;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function vk(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function pR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Gd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function En(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Ua(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function ze(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function P(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function yk(t){return En(t,(e,n)=>e+n,0)}function p8(t){return En(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function w8(t){return En(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function v8(t){return t.length?yk(t)/t.length:0}function Ck(t){return En(t,(e,n)=>e.concat(Array.isArray(n)?Ck(n):n),[])}function bk(t){const e=[];return P(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function wR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function y8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>s.includes(a))}),o}function C8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return P(i,s=>{P(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function vR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const b8=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:v8,arrayEach:P,arrayFilter:Ua,arrayFlatten:Ck,arrayMap:ze,arrayMax:p8,arrayMin:w8,arrayReduce:En,arraySum:yk,arrayUnique:bk,extendArray:pR,getDifferenceOfArrays:wR,getIntersectionOfArrays:y8,getUnionOfArrays:C8,pivot:Gd,stringToArray:vR,to2dArray:vk},Symbol.toStringTag,{value:"Module"}));function mt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return En(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Pt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function $t(t){return typeof t>"u"}function qt(t){return t===null||t===""||$t(t)}function Sk(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const $d="length",Kd=t=>parseInt(t,16),ZP=t=>parseInt(t,10),Tw=(t,e,n)=>t.substr(e,n),qd=t=>t.codePointAt(0)-65,yR=t=>`${t}`.replace(/\-/g,""),S8=t=>Kd(Tw(yR(t),Kd("12"),qd("F")))/(Kd(Tw(yR(t),qd("B"),~~![][$d]))||9),R8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let QP=!1;const eI={invalid:()=>mt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return mt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>mt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},tI={invalid:()=>mt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return mt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>mt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Rk(t,e){const n=!qt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=yR(t||"");const l=E8(t);if(n||r||l)if(l){const u=Z("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=S8(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(R8()&&(s="valid",a="valid"),!QP&&s!=="valid"&&(eI[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](eI[s]({keyValidityDate:o,hotVersion:i})),QP=!0),a!=="valid"&&e.parentNode&&tI[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=tI[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function E8(t){let e=[][$d],n=e;if(t[$d]!==qd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=qd(i.shift());o;o=qd(i.shift()||"A"))--o<""[$d]?n=n|(ZP(`${ZP(Kd(r)+(Kd(Tw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Tw(t,o,o?i[$d]===1?9:8:6);return n===e}const T8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:Rk,isDefined:le,isEmpty:qt,isRegExp:Sk,isUndefined:$t,stringify:Pt},Symbol.toStringTag,{value:"Module"}));function er(t){return t[0].toUpperCase()+t.substr(1)}function M8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Pt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function _E(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function xE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function PE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function CR(t){return Fv(`${t}`,{ALLOWED_TAGS:[]})}function Fv(t,e){return mX.sanitize(t,e)}const _8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:M8,isPercentValue:xE,randomString:_E,sanitize:Fv,stripTags:CR,substitute:PE,toUpperCaseFirst:er},Symbol.toStringTag,{value:"Module"})),xu=t=>["tabindex",t],x8=()=>["role","treegrid"],Ds=()=>["role","presentation"],P8=()=>["role","gridcell"],I8=()=>["role","rowheader"],Ek=()=>["role","rowgroup"],O8=()=>["role","columnheader"],bR=()=>["role","row"],A8=()=>["role","menu"],H8=()=>["role","menuitem"],N8=()=>["role","menuitemcheckbox"],D8=()=>["role","combobox"],Tk=()=>["role","listbox"],k8=()=>["role","option"],$8=()=>["role","checkbox"],L8=()=>["scope","col"],F8=()=>["scope","row"],V8=()=>["type","text"],Pf=t=>["aria-label",t],Pu=()=>["aria-hidden","true"],B8=()=>["aria-disabled","true"],W8=()=>["aria-multiselectable","true"],Mk=t=>["aria-haspopup",t],_k=t=>["aria-rowcount",t],Vv=t=>["aria-colcount",t],xk=t=>["aria-rowindex",t],IE=t=>["aria-colindex",t],Ri=t=>["aria-expanded",t],j8=t=>["aria-sort",t],nI=()=>["aria-readonly","true"],rI=()=>["aria-invalid","true"],Pk=t=>["aria-checked",t],OE=()=>["aria-selected","true"],U8=()=>["aria-autocomplete","list"],z8=t=>["aria-controls",t],Y8=t=>["aria-activedescendant",t],G8=t=>["aria-live",t],K8=t=>["aria-relevant",t],q8=t=>["aria-setsize",t],X8=t=>["aria-posinset",t];function Ik(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Xd(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function Ok(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function hu(t){return Ok(t)&&t.parent}function J8(t){return!!Object.getPrototypeOf(t.parent)}function za(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Ld(t,e,n){const r=[];let i=t;for(;i&&(i=za(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Ak(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Fa(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Hk(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function pa(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Nk(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Dk(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=Nk(e),e.length>0&&t.classList.add(...e)}function we(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Dk(e,!0);n=Nk(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function be(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Iu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Dk(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function AE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)AE(e[n])}}function Xo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const kk=/(<(.*)>|&(.*);)/;function Ou(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;kk.test(e)?t.innerHTML=n?Fv(e):e:Ya(t,e)}function Ya(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Xo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function du(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return du(r.host.impl);if(r.host)return du(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function $k(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Vn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function HE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Bv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Wv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?HE(e):t.scrollTop}function NE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Bv(e):t.scrollLeft}function If(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Lk(t){return t.scrollHeight-t.clientHeight}function Fk(t){return t.scrollWidth-t.clientWidth}function Qc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Of(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Z8(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function nn(t){return t.offsetWidth}function hn(t){return t.offsetHeight}function jc(t){return t.clientHeight||t.innerHeight}function DE(t){return t.clientWidth||t.innerWidth}function Q8(t,e,n){t.addEventListener(e,n,!1)}function eJ(t,e,n){t.removeEventListener(e,n,!1)}function kE(t){return t.selectionStart?t.selectionStart:0}function Vk(t){return t.selectionEnd?t.selectionEnd:0}function tJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function SR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function fg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let wC;function nJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Pn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return wC===void 0&&(wC=nJ(t)),wC}function $E(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function LE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function jv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function rJ(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function gg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Jd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Uv(t){return Jd(t)&&t.hasAttribute("data-hot-input")===!1}function iJ(t){const e=t.ownerDocument.activeElement;Uv(e)||t.select()}function FE(t){return!t.parentNode}function Bk(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function VE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();be(t,"contenteditable",!0),n&&be(t,...Pu()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function BE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&we(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function Wk(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;VE(t,n),e(),BE(t,n)}function Yo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const oJ=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:kk,addClass:X,addEvent:Q8,clearTextSelection:SR,closest:za,closestDown:Ld,empty:Xo,fastInnerHTML:Ou,fastInnerText:Ya,findFirstParentWithClass:Ak,getCaretPosition:kE,getCssTransform:rJ,getFrameElement:Ok,getMaximumScrollLeft:Fk,getMaximumScrollTop:Lk,getParent:Ik,getParentWindow:hu,getScrollLeft:NE,getScrollTop:Wv,getScrollableElement:If,getScrollbarWidth:Pn,getSelectionEndPosition:Vk,getSelectionText:tJ,getStyle:Of,getTrimmingContainer:Qc,getWindowScrollLeft:Bv,getWindowScrollTop:HE,hasAccessToParentWindow:J8,hasClass:ve,hasHorizontalScrollbar:LE,hasVerticalScrollbar:$E,hasZeroHeight:$k,index:Hk,innerHeight:jc,innerWidth:DE,isChildOf:Fa,isDetached:FE,isHTMLElement:Yo,isInput:Jd,isInternalElement:Xd,isOutsideInput:Uv,isVisible:du,makeElementContentEditableAndSelectItsContent:VE,matchesCSSRules:Z8,observeVisibilityChangeOnce:Bk,offset:Vn,outerHeight:hn,outerWidth:nn,overlayContainsElement:pa,removeAttribute:Iu,removeClass:we,removeContentEditableFromElementAndDeselect:BE,removeEvent:eJ,removeTextNodes:AE,resetCssTransform:gg,runWithSelectedContendEditableElement:Wk,selectElementIfAllowed:iJ,setAttribute:be,setCaretPosition:fg,setOverlayPosition:jv},Symbol.toStringTag,{value:"Module"}));function ft(t){return typeof t=="function"}function jk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function sJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=jk(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function mg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function aJ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return En(i,(u,c)=>c(u),r.apply(this,a))}}function WE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function Uk(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function lJ(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Mw(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const uJ=Object.freeze(Object.defineProperty({__proto__:null,curry:Uk,curryRight:lJ,debounce:mg,fastCall:Mw,isFunction:ft,partial:WE,pipe:aJ,throttle:jk,throttleAfterHits:sJ},Symbol.toStringTag,{value:"Module"}));var cJ=gn,iI=DN,hJ=Sn,oI=bu,dJ=_v,sI=cJ([].push),fJ=function(t){if(hJ(t))return t;if(iI(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?sI(n,i):(typeof i=="number"||oI(i)==="Number"||oI(i)==="String")&&sI(n,dJ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(iI(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},gJ=Et,zk=ch,Yk=sg,mJ=bn,pg=gn,Gk=kn,aI=Sn,lI=V0,Kk=rE,pJ=fJ,wJ=F0,vJ=String,Va=zk("JSON","stringify"),qg=pg(/./.exec),uI=pg("".charAt),yJ=pg("".charCodeAt),CJ=pg("".replace),bJ=pg(1 .toString),SJ=/[\uD800-\uDFFF]/g,cI=/^[\uD800-\uDBFF]$/,hI=/^[\uDC00-\uDFFF]$/,dI=!wJ||Gk(function(){var t=zk("Symbol")("stringify detection");return Va([t])!=="[null]"||Va({a:t})!=="{}"||Va(Object(t))!=="{}"}),fI=Gk(function(){return Va("\uDF06\uD834")!=='"\\udf06\\ud834"'||Va("\uDEAD")!=='"\\udead"'}),RJ=function(t,e){var n=Kk(arguments),r=pJ(e);if(!(!aI(r)&&(t===void 0||lI(t))))return n[1]=function(i,o){if(aI(r)&&(o=mJ(r,this,vJ(i),o)),!lI(o))return o},Yk(Va,null,n)},EJ=function(t,e,n){var r=uI(n,e-1),i=uI(n,e+1);return qg(cI,t)&&!qg(hI,i)||qg(hI,t)&&!qg(cI,r)?"\\u"+bJ(yJ(t,0),16):t};Va&&gJ({target:"JSON",stat:!0,arity:3,forced:dI||fI},{stringify:function(e,n,r){var i=Kk(arguments),o=Yk(dI?RJ:Va,null,i);return fI&&typeof o=="string"?CJ(o,SJ,EJ):o}});function eh(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ke(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=eh(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[eh(n[0])]:e[r]=[]:e[r]=null)})),e}function qk(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function dn(t,e,n){const r=Array.isArray(n);return ke(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function wg(t,e){ke(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),wg(t[r],e[r])):t[r]=e[r]})}function tr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function so(t){const e={};return ke(t,(n,r)=>{e[r]=n}),e}function yt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return P(n,i=>{t.MIXINS.push(i.MIXIN_NAME),ke(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let w=g;return(Array.isArray(w)||De(w))&&(w=tr(w)),w};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function zv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function De(t){return Object.prototype.toString.call(t)==="[object Object]"}function ns(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function ke(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Xk(t,e){const n=e.split(".");let r=t;return ke(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function kp(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(cn(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function Yv(t){if(!De(t))return 0;const e=function(n){let r=0;return De(n)?ke(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function kr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function cn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const TJ=Object.freeze(Object.defineProperty({__proto__:null,clone:so,createObjectPropListener:kr,deepClone:tr,deepExtend:wg,deepObjectSize:Yv,defineGetter:ns,duckSchema:eh,extend:dn,getProperty:Xk,hasOwnProperty:cn,inherit:qk,isObject:De,isObjectEqual:zv,mixin:yt,objectEach:ke,setProperty:kp},Symbol.toStringTag,{value:"Module"}));function Af(t){return window.requestAnimationFrame(t)}function Hf(t){window.cancelAnimationFrame(t)}function jE(){return"ontouchstart"in window}function Jk(){return typeof window<"u"}let $u;function Zk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return $u||(typeof Intl=="object"?$u=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?$u=(n,r)=>`${n}`.localeCompare(r):$u=(n,r)=>n===r?0:n>r?-1:1,$u)}const MJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Hf,getComparisonFunction:Zk,isCSR:Jk,isTouchSupported:jE,requestAnimationFrame:Af},Symbol.toStringTag,{value:"Module"})),gi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Js={chrome:gi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:gi(t=>/CriOS/.test(t)),edge:gi(t=>/Edge/.test(t)),edgeWebKit:gi(t=>/EdgiOS/.test(t)),firefox:gi(t=>/Firefox/.test(t)),firefoxWebKit:gi(t=>/FxiOS/.test(t)),mobile:gi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:gi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},vh={mac:gi(t=>/^Mac/.test(t)),win:gi(t=>/^Win/.test(t)),linux:gi(t=>/^Linux/.test(t)),ios:gi(t=>/iPhone|iPad|iPod/i.test(t))};function Qk(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(Js,n=>{let{test:r}=n;return void r(t,e)})}function e$(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(vh,e=>{let{test:n}=e;return void n(t)})}Jk()&&(Qk(),e$());function UE(){return Js.chrome.value}function t$(){return Js.chromeWebKit.value}function $p(){return Js.firefox.value}function n$(){return Js.firefoxWebKit.value}function Nf(){return Js.safari.value}function r$(){return Js.edge.value}function _J(){return Js.edgeWebKit.value}function Uo(){return Js.mobile.value}function zE(){return vh.ios.value}function YE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&vh.mac.value}function RR(){return vh.win.value}function _w(){return vh.mac.value}function xJ(){return vh.linux.value}const PJ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:UE,isChromeWebKit:t$,isEdge:r$,isEdgeWebKit:_J,isFirefox:$p,isFirefoxWebKit:n$,isIOS:zE,isIpadOS:YE,isLinuxOS:xJ,isMacOS:_w,isMobileBrowser:Uo,isSafari:Nf,isWindowsOS:RR,setBrowserMeta:Qk,setPlatformMeta:e$},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:$p()?182:174,AUDIO_MUTE:$p()?181:173,AUDIO_UP:$p()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},IJ=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function i$(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function GE(t){return IJ.includes(t)}function OJ(t){const e=[];return _w()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function o$(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function yh(t,e){const n=e.split("|");let r=!1;return P(n,i=>{if(t===de[i])return r=!0,!1}),r}const AJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:OJ,isCtrlMetaKey:o$,isFunctionKey:GE,isKey:yh,isPrintableChar:i$},Symbol.toStringTag,{value:"Module"}));function Ai(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ea(t){return t.isImmediatePropagationEnabled===!1}function Ga(t){return t.button===2}function Gv(t){return t.button===0}function s$(t){return t instanceof TouchEvent}function a$(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!Yo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const HJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ea,isLeftClick:Gv,isRightClick:Ga,isTouchEvent:s$,offsetRelativeTo:a$,stopImmediatePropagation:Ai},Symbol.toStringTag,{value:"Module"}));function ot(){le(console)&&console.warn(...arguments)}function KE(){le(console)&&console.error(...arguments)}const Kl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],vC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),yC=new Map([[]]);var NJ=fh,DJ=function(t,e,n){for(var r=0,i=arguments.length>2?n:NJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},kJ=Cn,$J=function(t,e){var n=kJ[t],r=n&&n.prototype;return r&&r[e]},LJ=ao,FJ=eD,VJ=Ks.f,ER=LJ("unscopables"),TR=Array.prototype;TR[ER]===void 0&&VJ(TR,ER,{configurable:!0,value:FJ(null)});var Kv=function(t){TR[ER][t]=!0},BJ=Et,WJ=gn,jJ=Lr,UJ=tg,zJ=DJ,YJ=$J,GJ=Kv,KJ=Array,qJ=WJ(YJ("Array","sort"));BJ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&jJ(e);var n=UJ(this),r=zJ(KJ,n);return qJ(r,e)}});GJ("toSorted");var XJ=Et,JJ=bn,ZJ=gh,QJ=Lr,eZ=Rn,tZ=Qo,nZ=ni,rZ=Ja,CC=rZ("find",TypeError);XJ({target:"Iterator",proto:!0,real:!0,forced:CC},{find:function(e){eZ(this);try{QJ(e)}catch(i){nZ(this,"throw",i)}if(CC)return JJ(CC,this,e);var n=tZ(this),r=0;return ZJ(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function iZ(t,e){l$(t,e),e.add(t)}function bC(t,e,n){l$(t,e),e.set(t,n)}function l$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gI(t,e,n){return t.set(xw(t,e),n),n}function Fn(t,e){return t.get(xw(t,e))}function xw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const oZ=100;var jr=new WeakMap,bc=new WeakMap,SC=new WeakMap,RC=new WeakSet;class mI{constructor(){iZ(this,RC),bC(this,jr,new Map),bC(this,bc,new Map),bC(this,SC,new Set),Kl.forEach(e=>xw(RC,this,pI).call(this,e))}getHooks(e){var n;return(n=Fn(jr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Fn(jr,this).has(e)||(xw(RC,this,pI).call(this,e),Kl.push(e));const i=Fn(jr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Fn(SC,this).has(e);!u&&o!==0&&(u=!0,Fn(SC,this).add(e)),u&&i.length>1&&Fn(jr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Fn(jr,this).has(e)&&Fn(jr,this).get(e).length>0}remove(e,n){if(!Fn(jr,this).has(e))return!1;const r=Fn(jr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Fn(bc,this).get(e);return i.skip=!0,o+=1,o>oZ&&(Fn(jr,this).set(e,r.filter(s=>!s.skip)),o=0),Fn(bc,this).set(e,o),!0}return!1}destroy(){Fn(jr,this).clear(),Fn(bc,this).clear(),gI(jr,this,null),gI(bc,this,null)}}function pI(t){Fn(jr,this).set(t,[]),Fn(bc,this).set(t,0)}function sZ(t,e,n){return(e=aZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aZ(t){var e=lZ(t,"string");return typeof e=="symbol"?e:e+""}function lZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uZ=mt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class oe{constructor(){sZ(this,"globalBucket",new mI)}static getSingleton(){return hZ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new mI),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?P(n,o=>this.add(e,o,r)):(vC.has(e)&&ot(PE(uZ,{hookName:e,removedInVersion:vC.get(e)})),yC.has(e)&&ot(yC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?P(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?P(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Mw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Mw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Kl.push(e)}deregister(e){this.isRegistered(e)&&Kl.splice(Kl.indexOf(e),1)}isDeprecated(e){return yC.has(e)||vC.has(e)}isRegistered(e){return Kl.indexOf(e)>=0}getRegistered(){return Kl}}const cZ=new oe;function hZ(){return cZ}const EC=new Map;function uo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";EC.has(t)||EC.set(t,new Map);const e=EC.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const MR=new WeakMap,{register:dZ,getItem:u$,hasItem:c$,getNames:fZ,getValues:_0e}=uo("editors");function gZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},oe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function h$(t,e){let n;if(typeof t=="function")MR.get(t)||xr(null,t),n=MR.get(t);else if(typeof t=="string")n=u$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Pw(t){if(typeof t=="function")return t;if(!c$(t))throw Error(`No registered editor found under "${t}" name`);return u$(t).getConstructor()}function xr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new gZ(e);typeof t=="string"&&dZ(t,n),MR.set(e,n)}function mZ(t,e,n){return(e=pZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pZ(t){var e=wZ(t,"string");return typeof e=="symbol"?e:e+""}function wZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Lp=0;class Mi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;mZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,vZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Lp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Lp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Lp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function vZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ai(this)},t}function yZ(){return Lp}function CZ(t,e){bZ(t,e),e.add(t)}function bZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ol(t,e,n){return(e=SZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SZ(t){var e=RZ(t,"string");return typeof e=="symbol"?e:e+""}function RZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xg=new WeakSet;class _R{constructor(e,n,r){CZ(this,Xg),ol(this,"hot",void 0),ol(this,"tableMeta",void 0),ol(this,"selection",void 0),ol(this,"eventManager",void 0),ol(this,"destroyed",!1),ol(this,"activeEditor",void 0),ol(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Mi(e),this.hot.addHook("afterDocumentKeyDown",i=>TC(Xg,this,wI).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>TC(Xg,this,wI).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>TC(Xg,this,EZ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=h$(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function wI(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ea(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!GE(n)&&!o$(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function EZ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const vI=new WeakMap;_R.getInstance=function(t,e,n){let r=vI.get(t);return r||(r=new _R(t,e,n),vI.set(t,r)),r};function TZ(t,e){d$(t,e),e.add(t)}function Fh(t,e,n){d$(t,e),e.set(t,n)}function d$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(Is(t,e))}function Vh(t,e,n){return t.set(Is(t,e),n),n}function Is(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Uc=Object.freeze({CELL:"cell",MIXED:"mixed"});var yn=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,Qg=new WeakMap,em=new WeakMap,ya=new WeakSet;class MZ{constructor(e){var n=this;TZ(this,ya),Fh(this,yn,void 0),Fh(this,Jg,void 0),Fh(this,Zg,1),Fh(this,Qg,null),Fh(this,em,new Map);const r=e.getSettings();Vh(yn,this,e),Vh(Jg,this,r.imeFastEdit?Uc.MIXED:Uc.CELL),Mt(yn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Is(ya,n,xZ).call(n,...o)}),Mt(yn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Is(ya,n,yI).call(n,...o)}),Mt(yn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Is(ya,n,yI).call(n,...o)}),Mt(yn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Is(ya,n,_Z).call(n,...o)})}getFocusMode(){return Mt(Jg,this)}setFocusMode(e){Object.values(Uc).includes(e)?Vh(Jg,this,e):ot(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Mt(Zg,this)}setRefocusDelay(e){Vh(Zg,this,e)}setRefocusElementGetter(e){Vh(Qg,this,e)}getRefocusElement(){var e;return typeof Mt(Qg,this)=="function"?Mt(Qg,this).call(this):(e=Mt(yn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Mt(yn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Mt(yn,this).runHooks("modifyFocusedElement",s.row,s.col,r);Yo(a)||(a=r),a&&!((o=Mt(yn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Is(ya,this,qE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mt(Zg,this);if(Mt(yn,this).getSettings().imeFastEdit&&!((e=Mt(yn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=Mt(yn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),Mt(em,this).has(n)||Mt(em,this).set(n,mg(()=>{if(!Mt(yn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),Mt(em,this).get(n)()}}}function qE(t){var e;const n=(e=Mt(yn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Mt(yn,this).selection.isCellVisible(n)){t(null);return}const r=Mt(yn,this).getCell(n.row,n.col,!0);r===null?Mt(yn,this).addHookOnce("afterScroll",()=>{t(Mt(yn,this).getCell(n.row,n.col,!0))}):t(r)}function yI(){Is(ya,this,qE).call(this,t=>{const{activeElement:e}=Mt(yn,this).rootDocument;e&&Uv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function _Z(){Is(ya,this,qE).call(this,t=>{this.getFocusMode()===Uc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function xZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Uc.MIXED:Uc.CELL)}var PZ=xi,IZ=bu,OZ=ao,AZ=OZ("match"),HZ=function(t){var e;return PZ(t)&&((e=t[AZ])!==void 0?!!e:IZ(t)==="RegExp")},NZ=Rn,DZ=function(){var t=NZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},kZ=bn,$Z=Pi,LZ=ng,FZ=DZ,CI=RegExp.prototype,VZ=function(t){var e=t.flags;return e===void 0&&!("flags"in CI)&&!$Z(t,"flags")&&LZ(CI,t)?kZ(FZ,t):e},XE=gn,BZ=hh,WZ=Math.floor,MC=XE("".charAt),jZ=XE("".replace),_C=XE("".slice),UZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,zZ=/\$([$&'`]|\d{1,2})/g,YZ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=zZ;return i!==void 0&&(i=BZ(i),l=UZ),jZ(o,l,function(u,c){var h;switch(MC(c,0)){case"$":return"$";case"&":return t;case"`":return _C(e,0,n);case"'":return _C(e,s);case"<":h=i[_C(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=WZ(d/10);return f===0?u:f<=a?r[f-1]===void 0?MC(c,1):r[f-1]+MC(c,1):u}h=r[d-1]}return h===void 0?"":h})},GZ=Et,KZ=bn,JE=gn,bI=eg,qZ=Sn,XZ=xi,JZ=HZ,Bh=_v,ZZ=rg,QZ=VZ,eQ=YZ,tQ=ao,nQ=tQ("replace"),rQ=TypeError,xC=JE("".indexOf);JE("".replace);var SI=JE("".slice),iQ=Math.max;GZ({target:"String",proto:!0},{replaceAll:function(e,n){var r=bI(this),i,o,s,a,l,u,c,h,d,f,g=0,w="";if(XZ(e)){if(i=JZ(e),i&&(o=Bh(bI(QZ(e))),!~xC(o,"g")))throw new rQ("`.replaceAll` does not allow non-global regexes");if(s=ZZ(e,nQ),s)return KZ(s,e,r,n)}for(a=Bh(r),l=Bh(e),u=qZ(n),u||(n=Bh(n)),c=l.length,h=iQ(1,c),d=xC(a,l);d!==-1;)f=u?Bh(n(l,d,a)):eQ(l,a,d,[],void 0,n),w+=SI(a,g,d)+f,g=d+c,d=d+h>a.length?-1:xC(a,l,d+h);return g<a.length&&(w+=SI(a,g)),w}});var oQ=Et,sQ=gh,aQ=Lr,lQ=Rn,uQ=Qo,cQ=ni,hQ=Ja,dQ=sg,fQ=kn,f$=TypeError,g$=fQ(function(){[].keys().reduce(function(){},void 0)}),PC=!g$&&hQ("reduce",f$);oQ({target:"Iterator",proto:!0,real:!0,forced:g$||PC},{reduce:function(e){lQ(this);try{aQ(e)}catch(s){cQ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(PC)return dQ(PC,this,n?[e]:[e,r]);var i=uQ(this),o=0;if(sQ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new f$("Reduce of empty iterator with no initial value");return r}});const m$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},gQ=new RegExp(Object.keys(m$).map(t=>`(${t})`).join("|"),"gi");function mQ(t){return(t&&t.nodeName||"")==="TABLE"}function xR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let C=0;C<s;C+=1){const R=!f&&n&&C===0;let y="";if(f)y=`<th>${t.getColHeader(C-c)}</th>`;else if(R)y=`<th>${t.getRowHeader(d-h)}</th>`;else{const M=i[d][C],{hidden:x,rowspan:_,colspan:T}=t.getCellMeta(d-h,C-c);if(!x){const I=[];if(_&&I.push(`rowspan="${_}"`),T&&I.push(`colspan="${T}"`),qt(M))y=`<td ${I.join(" ")}></td>`;else{const Y=M.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y=`<td ${I.join(" ")}>${Y}</td>`}}}g.push(y)}const w=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function PR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=qt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function p$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const M=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,x=>{const _=x.match(/<td\b[^>]*?>/g)[0],T=/<p.*?>/g,I=x.substring(_.length,x.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(T,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${_}${I}</td>`});i.insertAdjacentHTML("afterbegin",`${M}`),o=i.querySelector("table")}if(!o||!mQ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((M,x)=>M+x.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const M=Array.from(o.tHead.rows).filter(x=>{const _=x.querySelector("td")!==null;return _&&h.push(x),!_});f=M.length,d=f>0,f>1?n.nestedHeaders=Array.from(M).reduce((x,_)=>{const T=Array.from(_.cells).reduce((I,Y,U)=>{if(a&&U===0)return I;const{colSpan:V,innerHTML:q}=Y,ee=V>1?{label:q,colspan:V}:q;return I.push(ee),I},[]);return x.push(T),x},[]):d&&(n.colHeaders=Array.from(M[0].children).reduce((x,_,T)=>(a&&T===0||x.push(_.innerHTML),x),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const w=[...h,...Array.from(o.tBodies).reduce((M,x)=>(M.push(...Array.from(x.rows)),M),[]),...c];g=w.length;const C=new Array(g);for(let M=0;M<g;M++)C[M]=new Array(u);const R=[],y=[];for(let M=0;M<g;M++){const x=w[M],_=Array.from(x.cells),T=_.length;for(let I=0;I<T;I++){const Y=_[I],{nodeName:U,innerHTML:V,rowSpan:q,colSpan:ee}=Y,Q=C[M].findIndex(ne=>ne===void 0);if(U==="TD"){if(q>1||ee>1){for(let Ee=M;Ee<M+q;Ee++)if(Ee<g)for(let Ae=Q;Ae<Q+ee;Ae++)C[Ee][Ae]=null;const pe=Y.getAttribute("style");pe&&pe.includes("mso-ignore:colspan")||R.push({col:Q,row:M,rowspan:q,colspan:ee})}let ne="";s&&/excel/gi.test(s.content)?ne=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ne=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[M][Q]=ne.replace(gQ,pe=>m$[pe])}else y.push(V)}}return R.length&&(n.mergeCells=R),y.length&&(n.rowHeaders=y),C.length&&(n.data=C),n}const pQ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:PR,htmlToGridSettings:p$,instanceToHTML:xR},Symbol.toStringTag,{value:"Module"}));function qn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function w$(t){return qn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function IR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function ZE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ge(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const wQ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ge,isNumeric:qn,isNumericLike:w$,rangeEach:fe,rangeEachReverse:IR,valueAccordingPercent:ZE},Symbol.toStringTag,{value:"Module"})),OR="asc",vQ="desc",RI=new Map([[OR,[-1,1]],[vQ,[1,-1]]]),yQ=t=>`The priority '${t}' is already declared in a map.`,CQ=t=>`The priority '${t}' is not a number.`;function bQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ft(t)?t:yQ,e=ft(e)?e:CQ;function r(o,s){if(!qn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OR;const[s,a]=RI.get(o)||RI.get(OR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const SQ=t=>`The id '${t}' is already declared in a map.`;function qv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ft(t)?t:SQ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const RQ=t=>`'${t}' value is already declared in a unique set.`;function EQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ft(t)?t:RQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const QE=t=>`There is already registered "${t}" plugin.`,TQ=t=>`There is already registered plugin on priority "${t}".`,MQ=t=>`The priority "${t}" is not a number.`,v$=bQ({errorPriorityExists:TQ,errorPriorityNaN:MQ}),y$=EQ({errorItemExists:QE}),AR=qv({errorIdExists:QE});function eT(){return[...v$.getItems(),...y$.getItems()]}function vg(t){const e=er(t);return AR.getItem(e)}function _Q(t){return!!vg(t)}function Xe(t,e,n){[t,e,n]=PQ(t,e,n),vg(t)===void 0&&xQ(t,e,n)}function xQ(t,e,n){const r=er(t);if(AR.hasItem(r))throw new Error(QE(r));n===void 0?y$.addItem(r):v$.addItem(n,r),AR.addItem(r,e)}function PQ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:IQ,getItem:OQ,hasItem:C$,getNames:AQ,getValues:x0e}=uo("renderers");function Iw(t){if(typeof t=="function")return t;if(!C$(t))throw Error(`No registered renderer found under "${t}" name`);return OQ(t)}function zr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),IQ(t,e)}const{register:HQ,getItem:NQ,hasItem:b$,getNames:DQ,getValues:P0e}=uo("validators");function tT(t){if(typeof t=="function")return t;if(!b$(t))throw Error(`No registered validator found under "${t}" name`);return NQ(t)}function ql(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),HQ(t,e)}var kQ=Et,$Q=hh,LQ=fh,FQ=ig,VQ=Kv;kQ({target:"Array",proto:!0},{at:function(e){var n=$Q(this),r=LQ(n),i=FQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});VQ("at");var BQ=Et,WQ=gn,jQ=eg,UQ=ig,zQ=_v,YQ=kn,GQ=WQ("".charAt),KQ=YQ(function(){return"𠮷".at(-2)!=="\uD842"});BQ({target:"String",proto:!0,forced:KQ},{at:function(e){var n=zQ(jQ(this)),r=n.length,i=UQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:GQ(n,o)}});function Wh(t,e,n){return(e=qQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qQ(t){var e=XQ(t,"string");return typeof e=="symbol"?e:e+""}function XQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JQ{constructor(){Wh(this,"count",0),Wh(this,"startColumn",null),Wh(this,"endColumn",null),Wh(this,"startPosition",null),Wh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function jh(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=QQ(t,"string");return typeof e=="symbol"?e:e+""}function QQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eee{constructor(){jh(this,"count",0),jh(this,"startRow",null),jh(this,"endRow",null),jh(this,"startPosition",null),jh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Uh(t,e,n){return(e=tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tee(t){var e=nee(t,"string");return typeof e=="symbol"?e:e+""}function nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S${constructor(){Uh(this,"count",0),Uh(this,"startColumn",null),Uh(this,"endColumn",null),Uh(this,"startPosition",null),Uh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function zh(t,e,n){return(e=ree(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ree(t){var e=iee(t,"string");return typeof e=="symbol"?e:e+""}function iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R${constructor(){zh(this,"count",0),zh(this,"startRow",null),zh(this,"endRow",null),zh(this,"startPosition",null),zh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Yh(t,e,n){return(e=oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=see(t,"string");return typeof e=="symbol"?e:e+""}function see(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aee{constructor(){Yh(this,"count",0),Yh(this,"startColumn",0),Yh(this,"endColumn",0),Yh(this,"startPosition",0),Yh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Gh(t,e,n){return(e=lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lee(t){var e=uee(t,"string");return typeof e=="symbol"?e:e+""}function uee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cee{constructor(){Gh(this,"count",0),Gh(this,"startRow",0),Gh(this,"endRow",0),Gh(this,"startPosition",0),Gh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function EI(t,e,n){return(e=hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hee(t){var e=dee(t,"string");return typeof e=="symbol"?e:e+""}function dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fee extends S${constructor(){super(...arguments),EI(this,"columnStartOffset",0),EI(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function TI(t,e,n){return(e=gee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gee(t){var e=mee(t,"string");return typeof e=="symbol"?e:e+""}function mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pee extends R${constructor(){super(...arguments),TI(this,"rowStartOffset",0),TI(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function MI(t,e,n){return(e=wee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wee(t){var e=vee(t,"string");return typeof e=="symbol"?e:e+""}function vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E${constructor(e){MI(this,"calculationTypes",[]),MI(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Di(t,e,n){return(e=yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:e+""}function Cee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const th=50;class bee extends E${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Di(this,"viewportWidth",0),Di(this,"scrollOffset",0),Di(this,"zeroBasedScrollOffset",0),Di(this,"totalColumns",0),Di(this,"columnWidthFn",null),Di(this,"columnWidth",0),Di(this,"overrideFn",null),Di(this,"inlineStartOffset",0),Di(this,"totalCalculatedWidth",0),Di(this,"startPositions",[]),Di(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?th:n}}function si(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=Ree(t,"string");return typeof e=="symbol"?e:e+""}function Ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eee extends E${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),si(this,"viewportHeight",0),si(this,"scrollOffset",0),si(this,"zeroBasedScrollOffset",0),si(this,"totalRows",0),si(this,"rowHeightFn",null),si(this,"rowHeight",0),si(this,"overrideFn",null),si(this,"horizontalScrollbarHeight",0),si(this,"innerViewportHeight",0),si(this,"totalCalculatedHeight",0),si(this,"startPositions",[]),si(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function Tee(t,e,n){Mee(t,e),e.set(t,n)}function Mee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _I(t,e,n){return(e=_ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ee(t){var e=xee(t,"string");return typeof e=="symbol"?e:e+""}function xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lu(t,e){return t.get(T$(t,e))}function xI(t,e,n){return t.set(T$(t,e),n),n}function T$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var as=new WeakMap;class fu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_I(this,"row",null),_I(this,"col",null),Tee(this,as,!1),xI(as,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Lu(as,this)}isSouthEastOf(e){return this.row>=e.row&&(Lu(as,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Lu(as,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Lu(as,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Lu(as,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof fu&&xI(as,this,e.isRtl()),this}clone(){return new fu(this.row,this.col,Lu(as,this))}toObject(){return{row:this.row,col:this.col}}}function Pee(t,e,n){Iee(t,e),e.set(t,n)}function Iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IC(t,e,n){return(e=Oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oee(t){var e=Aee(t,"string");return typeof e=="symbol"?e:e+""}function Aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ai(t,e){return t.get(M$(t,e))}function Hee(t,e,n){return t.set(M$(t,e),n),n}function M$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vr=new WeakMap;class yg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;IC(this,"highlight",null),IC(this,"from",null),IC(this,"to",null),Pee(this,vr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Hee(vr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ai(vr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ai(vr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ai(vr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ai(vr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ai(vr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ai(vr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ai(vr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ai(vr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof fu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(ai(vr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(ai(vr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new yg(this.highlight,this.from,this.to,ai(vr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new fu(e,n,ai(vr,this))}}function go(t,e,n){Nee(t,e),e.set(t,n)}function Nee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(_$(t,e))}function ta(t,e,n){return t.set(_$(t,e),n),n}function _$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var li=new WeakMap,OC=new WeakMap,An=new WeakMap,Fu=new WeakMap,tm=new WeakMap,ki=new WeakMap,AC=new WeakMap,Kh=new WeakMap,sl=new WeakMap,mo=new WeakMap;let x$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;go(this,li,void 0),go(this,OC,void 0),go(this,An,void 0),go(this,Fu,void 0),go(this,tm,void 0),go(this,ki,void 0),go(this,AC,void 0),go(this,Kh,void 0),go(this,sl,[null,null]),go(this,mo,[null,null]),ta(li,this,r),ta(OC,this,n),ta(An,this,o),ta(Fu,this,s),ta(tm,this,a),ta(ki,this,i),ta(AC,this,e),this.registerEvents()}registerEvents(){ge(ki,this).addEventListener(ge(An,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(ki,this).addEventListener(ge(An,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(ki,this).addEventListener(ge(An,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(ki,this).addEventListener(ge(An,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(ki,this).addEventListener(ge(An,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(ki,this).addEventListener(ge(An,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(li,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(li,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(ki,this).addEventListener(ge(An,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(ki,this).addEventListener(ge(An,this).holder,"mousedown",r=>this.onMouseDown(r))};Uo()?e():(jE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(Kh,this)&&r){const[i,o]=[r.row,ge(Kh,this).from.row],[s,a]=[r.col,ge(Kh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(An,this).TABLE,i=Ld(e,["TD","TH"],r);return i?(n.coords=ge(An,this).getCoords(i),n.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(n.coords=ge(Fu,this).getFocusSelection().cellRange.highlight,n.TD=ge(An,this).getCell(n.coords)):ve(e,"wtBorder")&&ve(e,"area")&&ge(Fu,this).getAreaSelection().cellRange&&(n.coords=ge(Fu,this).getAreaSelection().cellRange.to,n.TD=ge(An,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(OC,this).rootDocument.activeElement,r=WE(Ik,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ve(i,"corner")?ge(li,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(li,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(mo,this)[0]=o.TD,clearTimeout(ge(sl,this)[0]),ge(sl,this)[0]=setTimeout(()=>{ge(mo,this)[0]=null},1e3))}onContextMenu(e){if(ge(li,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(li,this).has("onCellMouseOver"))return;const n=ge(An,this).TABLE,r=Ld(e.target,["TD","TH"],n),i=ge(tm,this)||this;r&&r!==i.lastMouseOver&&Fa(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(An,this).getCoords(r),r))}onMouseOut(e){if(!ge(li,this).has("onCellMouseOut"))return;const n=ge(An,this).TABLE,r=Ld(e.target,["TD","TH"],n),i=Ld(e.relatedTarget,["TD","TH"],n),o=ge(tm,this)||this;r&&r!==i&&Fa(r,n)&&(this.callListener("onCellMouseOut",e,ge(An,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(li,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(mo,this)[0]&&n.TD===ge(mo,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(mo,this)[0]=null,ge(mo,this)[1]=null):n.TD===ge(mo,this)[0]&&(ge(mo,this)[1]=n.TD,clearTimeout(ge(sl,this)[1]),ge(sl,this)[1]=setTimeout(()=>{ge(mo,this)[1]=null},500)))}onTouchStart(e){ta(Kh,this,ge(Fu,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(li,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];zE()&&(t$()||n$())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(li,this).getSettingPure(e);o&&o(n,r,i,ge(AC,this).call(this))}destroy(){clearTimeout(ge(sl,this)[0]),clearTimeout(ge(sl,this)[1]),ge(ki,this).destroy()}};function HC(t,e,n){return(e=Dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ee{constructor(e,n,r){HC(this,"offset",void 0),HC(this,"total",void 0),HC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function NC(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=Fee(t,"string");return typeof e=="symbol"?e:e+""}function Fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vee{constructor(e,n,r){NC(this,"offset",void 0),NC(this,"total",void 0),NC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function nm(t,e,n){return(e=Bee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bee(t){var e=Wee(t,"string");return typeof e=="symbol"?e:e+""}function Wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jee{constructor(){nm(this,"currentSize",0),nm(this,"nextSize",0),nm(this,"currentOffset",0),nm(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Uee=0,PI=1,HR=2;function DC(t,e,n){return(e=zee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zee(t){var e=Yee(t,"string");return typeof e=="symbol"?e:e+""}function Yee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gee{constructor(){DC(this,"size",new jee),DC(this,"workingSpace",Uee),DC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=PI,e.workingSpace=HR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=HR,e.workingSpace=PI,this.sharedSize=e.getViewSize()}}var II=Mv,Kee=TypeError,qee=function(t,e){if(!delete t[e])throw new Kee("Cannot delete property "+II(e)+" of "+II(t))},Xee=Et,Jee=hh,Zee=fh,Qee=kN,ete=qee,tte=$N,nte=[].unshift(0)!==1,rte=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},ite=nte||!rte();Xee({target:"Array",proto:!0,arity:1,forced:ite},{unshift:function(e){var n=Jee(this),r=Zee(n),i=arguments.length;if(i){tte(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:ete(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return Qee(n,r+i)}});function ote(t,e,n){return(e=ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ste(t){var e=ate(t,"string");return typeof e=="symbol"?e:e+""}function ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OI{constructor(e,n){ote(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function lte(t,e,n){return(e=ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ute(t){var e=cte(t,"string");return typeof e=="symbol"?e:e+""}function cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hte{constructor(e){lte(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new OI(o,n),l=new OI(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(HR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Vu(t,e,n){return(e=dte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dte(t){var e=fte(t,"string");return typeof e=="symbol"?e:e+""}function fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P${constructor(e,n){Vu(this,"rootNode",void 0),Vu(this,"nodesPool",void 0),Vu(this,"sizeSet",new Gee),Vu(this,"collectedNodes",[]),Vu(this,"viewDiffer",new hte(this.sizeSet)),Vu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class I$ extends P${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function AI(t,e,n){return(e=gte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gte(t){var e=mte(t,"string");return typeof e=="symbol"?e:e+""}function mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pte{constructor(e){AI(this,"nodeType",void 0),AI(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function qh(t,e,n){return(e=wte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wte(t){var e=vte(t,"string");return typeof e=="symbol"?e:e+""}function vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cg{constructor(e,n){qh(this,"nodesPool",null),qh(this,"nodeType",void 0),qh(this,"rootNode",void 0),qh(this,"table",null),qh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new pte(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function HI(t,e,n){return(e=yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yte(t){var e=Cte(t,"string");return typeof e=="symbol"?e:e+""}function Cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bte extends Cg{constructor(){super("TH"),HI(this,"orderViews",new WeakMap),HI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new I$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Iu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(d,[I8(),F8(),IE(h+1),xu(-1)]),n[h](a,d,h)}u.end()}}}class Ste extends Cg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Xo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&be(this.rootNode,[Ek()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&be(s,[bR(),xk(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Iu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(u,[IE(a+1+this.table.rowHeadersCount),xu(-1),O8(),...a>=0?[L8()]:[bR()]]),r[n](l,u,n)}}}}let NI=!1;class Rte extends Cg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!NI&&e>1e3&&(NI=!0,ot(mt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&X(r,"rowHeader")}}function Ete(t,e,n){return(e=Tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Bu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let DI=!1;class _te extends Cg{constructor(e){super("TR",e),Ete(this,"orderView",void 0),this.orderView=new P$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!DI&&e>1e3&&(DI=!0,ot(mt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&be(this.rootNode,[Ek()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;be(o,[bR(),xk(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ve(o,Bu.rowEven)||(we(o,Bu.rowOdd),X(o,Bu.rowEven)):ve(o,Bu.rowOdd)||(we(o,Bu.rowEven),X(o,Bu.rowOdd))}this.orderView.end()}}function kI(t,e,n){return(e=xte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Pte(t,"string");return typeof e=="symbol"?e:e+""}function Pte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ite extends Cg{constructor(){super("TD"),kI(this,"orderViews",new WeakMap),kI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new I$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(ve(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Iu(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;be(g,[...g.hasAttribute("role")?[]:[P8()],xu(-1),IE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function wn(t,e,n){return(e=Ote(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ote(t){var e=Ate(t,"string");return typeof e=="symbol"?e:e+""}function Ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hte{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wn(this,"rootNode",void 0),wn(this,"rootDocument",void 0),wn(this,"rowHeaders",null),wn(this,"columnHeaders",null),wn(this,"colGroup",null),wn(this,"rows",null),wn(this,"cells",null),wn(this,"rowFilter",null),wn(this,"columnFilter",null),wn(this,"rowUtils",null),wn(this,"columnUtils",null),wn(this,"rowsToRender",0),wn(this,"columnsToRender",0),wn(this,"rowHeaderFunctions",[]),wn(this,"rowHeadersCount",0),wn(this,"columnHeaderFunctions",[]),wn(this,"columnHeadersCount",0),wn(this,"cellRenderer",void 0),wn(this,"activeOverlayName",void 0),wn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class Nte{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Hte(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new bte,columnHeaders:new Ste(n),colGroup:new Rte(r),rows:new _te(i),cells:new Ite}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function kC(t,e,n){return(e=Dte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dte(t){var e=kte(t,"string");return typeof e=="symbol"?e:e+""}function kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $te{constructor(e,n){kC(this,"dataAccessObject",void 0),kC(this,"wtSettings",void 0),kC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function $I(t,e,n){return(e=Lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lte(t){var e=Fte(t,"string");return typeof e=="symbol"?e:e+""}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vte{constructor(e,n){$I(this,"dataAccessObject",void 0),$I(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function po(t,e,n){return(e=Bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bte(t){var e=Wte(t,"string");return typeof e=="symbol"?e:e+""}function Wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ch{constructor(e,n,r,i,o){po(this,"wtSettings",null),po(this,"domBindings",void 0),po(this,"TBODY",null),po(this,"THEAD",null),po(this,"COLGROUP",null),po(this,"hasTableHeight",!0),po(this,"hasTableWidth",!0),po(this,"isTableVisible",!1),po(this,"tableOffset",0),po(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,AE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Vte(this.dataAccessObject,this.wtSettings),this.columnUtils=new $te(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Nte({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&be(r,[Ds()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[Ds()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",be(r,[xu(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&be(r.parentNode,[Ds()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[Ds()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Vn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Vn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Vee(f,o,c),this.columnFilter=new $ee(g,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),w=C.skipRender!==!0}w&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Vo)||this.is(Ba))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Vo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Vo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=jc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Vo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=za(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=Hk(r),s=n.cellIndex;pa(pu,n,this.wtRootElement)||pa(gu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):pa(Ba,n,this.wtRootElement)||pa(Vo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),pa(pu,n,this.wtRootElement)||pa(mu,n,this.wtRootElement)||pa(Ba,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=jc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?hn:jc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return nn(this.TABLE)}getHeight(){return hn(this.TABLE)}getTotalWidth(){const e=nn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=hn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return du(this.TABLE)}_modifyRowHeaderWidth(e){let n=ft(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const jte="stickyRowsBottom",nT={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ns(nT,"MIXIN_NAME",jte,{writable:!1,enumerable:!1});const Ute="stickyColumnsStart",Xv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ns(Xv,"MIXIN_NAME",Ute,{writable:!1,enumerable:!1});class rT extends Ch{constructor(e,n,r,i){super(e,n,r,i,Ba)}}yt(rT,nT);yt(rT,Xv);const gu="top",Vo="bottom",mu="inline_start",pu="top_inline_start_corner",Ba="bottom_inline_start_corner",O$=[gu,Vo,mu,pu,Ba],zte=new Map([[gu,`ht_clone_${gu}`],[Vo,`ht_clone_${Vo}`],[mu,`ht_clone_${mu} ht_clone_left`],[pu,`ht_clone_${pu} ht_clone_top_left_corner`],[Ba,`ht_clone_${Ba} ht_clone_bottom_left_corner`]]);function Yte(t,e){Gte(t,e),e.add(t)}function Gte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kte(t,e,n){return(e=qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Xte(t,"string");return typeof e=="symbol"?e:e+""}function Xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xh=new WeakSet;class Jte{constructor(e){Yte(this,Xh),Kte(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=kr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=kr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return rm(Xh,this,FI).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return rm(Xh,this,FI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return rm(Xh,this,LI).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return rm(Xh,this,LI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function LI(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Vn(r.wtRootElement).left;const u=Math.abs(NE(s,s));if(l>u){const c=DE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function FI(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Vn(n.wtRootElement),a=Wv(o,o);if(s.top>a){const l=jc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function ui(t,e,n){return(e=Zte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zte(t){var e=Qte(t,"string");return typeof e=="symbol"?e:e+""}function Qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iT{get eventManager(){return new Mi(this)}constructor(e,n){ui(this,"wtTable",void 0),ui(this,"wtScroll",void 0),ui(this,"wtViewport",void 0),ui(this,"wtOverlays",void 0),ui(this,"selectionManager",void 0),ui(this,"wtEvent",void 0),ui(this,"guid",`wt_${_E()}`),ui(this,"drawInterrupted",!1),ui(this,"drawn",!1),ui(this,"activeOverlayName","master"),ui(this,"domBindings",void 0),ui(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Jte(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Ya(r,e[n])}])}}createCellCoords(e,n){return new fu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new yg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||$k(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function VI(t,e,n){return(e=ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ene(t){var e=tne(t,"string");return typeof e=="symbol"?e:e+""}function tne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nne extends iT{constructor(e,n,r){super(e,n),VI(this,"cloneSource",void 0),VI(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new x$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function rne(t,e,n){return(e=ine(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ine(t){var e=one(t,"string");return typeof e=="symbol"?e:e+""}function one(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bg{constructor(e,n,r,i,o){rne(this,"wtSettings",null),ns(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Qc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Qc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=If(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){ot(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Pn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(O$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${zte.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&be(o,[Ds()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===gu||u==="vertical"&&this.type===mu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=If(e.TABLE),new nne(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class sne extends bg{constructor(e,n,r,i,o,s){super(e,n,Ba,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new rT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else gg(n),this.repositionOverlay();let r=hn(this.clone.wtTable.TABLE);const i=nn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Pn(r)),i.style.bottom=`${o}px`}}const ane="calculatedColumns",Jv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ns(Jv,"MIXIN_NAME",ane,{writable:!1,enumerable:!1});class oT extends Ch{constructor(e,n,r,i){super(e,n,r,i,Vo)}}yt(oT,nT);yt(oT,Jv);function lne(t,e,n){return(e=une(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function une(t){var e=cne(t,"string");return typeof e=="symbol"?e:e+""}function cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hne extends bg{constructor(e,n,r,i){super(e,n,Vo,r,i),lne(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new oT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Pn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Bv(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Pn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=hn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Pn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Wv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(we(s,"innerBorderBottom"),o=a)}return o}}const dne="calculatedRows",sT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ns(sT,"MIXIN_NAME",dne,{writable:!1,enumerable:!1});class aT extends Ch{constructor(e,n,r,i){super(e,n,r,i,mu)}}yt(aT,sT);yt(aT,Xv);const fne="localHooks",Bn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Mw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ns(Bn,"MIXIN_NAME",fne,{writable:!1,enumerable:!1});let A$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};yt(A$,Bn);const H$="active-header",lT="header",uT="area",Zd="focus",gne="fill",mne="row",pne="column",wne="custom-selection",cT=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var vne=Kv;vne("flat");function yne(t,e){N$(t,e),e.add(t)}function BI(t,e,n){N$(t,e),e.set(t,n)}function N$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e){return t.get(Qd(t,e))}function WI(t,e,n){return t.set(Qd(t,e),n),n}function Qd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wi=new WeakMap,Yn=new WeakMap,im=new WeakSet;class Cne{constructor(){yne(this,im),BI(this,Wi,void 0),BI(this,Yn,void 0)}setActiveOverlay(e){return WI(Yn,this,e),this}setActiveSelection(e){return WI(Wi,this,e),this}scan(){const e=zt(Wi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=zt(Wi,this).getCorners(),{wtTable:s}=zt(Yn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const w=zt(Yn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:zt(Wi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});w!==null&&(w!==h&&(g=s.getColumnHeader(w,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=zt(Wi,this).getCorners(),{wtTable:s}=zt(Yn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const w=zt(Yn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:zt(Wi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});w!==null&&(w!==h&&(g=s.getRowHeader(w,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=zt(Yn,this);Qd(im,this,bne).call(this,(r,i)=>{const o=n.getCell(zt(Yn,this).createCellCoords(r,i)),s=zt(Yn,this).getSetting("onAfterDrawSelection",r,i,zt(Wi,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=zt(Wi,this).getCorners(),{wtTable:i}=zt(Yn,this);Qd(im,this,jI).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(zt(Yn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=zt(Wi,this).getCorners(),{wtTable:i}=zt(Yn,this);Qd(im,this,jI).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(zt(Yn,this).createCellCoords(o,s));e(a)}})}}function bne(t){let[e,n,r,i]=zt(Wi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=zt(Yn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(zt(Yn,this).createCellCoords(e,n));if(!Yo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function jI(t){const{wtTable:e}=zt(Yn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class UI{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=cT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ai(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Uo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};ke(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};ke(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),w=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),R=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-w/4*3,10)}px`,c[l]=`${parseInt(i-w/4*3,10)}px`;const y=Math.min(parseInt(i+o,10),C-g-f*2),M=Math.min(parseInt(i+o-w/4,10),C-w-f*2);h[l]=`${y}px`,d[l]=`${M}px`;const x=Math.min(parseInt(r+s,10),R-g-f*2),_=Math.min(parseInt(r+s-w/4,10),R-w-f*2);h.top=`${x}px`,d.top=`${_}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!Yo(g)){this.disappear();return}const w=u?s.getCell(this.wot.createCellCoords(i,o)):g,C=Vn(g),R=u?Vn(w):C,y=Vn(s.TABLE),M=C.top,x=C.left,_=this.wot.wtSettings.getSetting("rtlMode");let T=0,I=0;if(_){const Ee=nn(s.TABLE),Ae=nn(g),ut=l.innerWidth-y.left-Ee;I=x+Ae-R.left,T=l.innerWidth-x-Ae-ut-1}else I=R.left+nn(w)-x,T=x-y.left-1;if(this.isEntireColumnSelected(n,i)){const Ee=n,Ae=this.getDimensionsFromHeader("columns",r,o,Ee,y);let ut=null;Ae&&([ut,T,I]=Ae),ut&&(g=ut)}let Y=M-y.top-1,U=R.top+hn(w)-M;if(this.isEntireRowSelected(r,o)){const Ee=r,Ae=this.getDimensionsFromHeader("rows",n,i,Ee,y);let ut=null;Ae&&([ut,Y,U]=Ae),ut&&(g=ut)}const V=l.getComputedStyle(g);parseInt(V.borderTopWidth,10)>0&&(Y+=1,U=U>0?U-1:0),parseInt(V[_?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,I=I>0?I-1:0);const q=_?"right":"left";this.topStyle.top=`${Y}px`,this.topStyle[q]=`${T}px`,this.topStyle.width=`${I}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[q]=`${T}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const ee=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Y+U-ee}px`,this.bottomStyle[q]=`${T}px`,this.bottomStyle.width=`${I}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[q]=`${T+I-ee}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let Q=this.settings.border.cornerVisible;Q=typeof Q=="function"?Q(this.settings.layerLevel):Q;const ne=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[pe,it]=[i,o];if(ne&&Array.isArray(ne)&&([,,pe,it]=ne),Uo()||!Q||this.isPartRange(pe,it))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[q]=`${T+I+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ee=Qc(s.TABLE);const Ae=Ee===l;Ae&&(Ee=a.documentElement);const ut=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,In=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),ct=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ae?w.getBoundingClientRect().left:w.offsetLeft;let v=!1,p=0;_?(p=m-parseInt(this.cornerDefaultStyle.width,10)/2,v=p<0):(p=m+nn(w)+parseInt(this.cornerDefaultStyle.width,10)/2,v=p>=DE(Ee)),v&&(this.cornerStyle[q]=`${Math.floor(T+I+this.cornerCenterPointOffset-In-ut)}px`,this.cornerStyle[_?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const p=(Ae?w.getBoundingClientRect().top:w.offsetTop)+hn(w)+parseInt(this.cornerDefaultStyle.height,10)/2>=jc(Ee),A=this.wot.stylesHandler.isClassicTheme();if(p){const L=Math.floor(Y+U+this.cornerCenterPointOffset-ct-ut);A?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}Uo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,Y,T,I,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return hn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return nn(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(g=l(n,C-i),w=l(r,C-i),!g||!w)return!1;const R=Vn(g),y=Vn(w);return g&&w&&(h=R[f]-o[f]-1,d=y[f]+u(w)-R[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?X(this[e],"hidden"):(ve(this[e],"hidden")&&we(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?X(this[e],"hidden"):we(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Uo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Sne(t,e){D$(t,e),e.add(t)}function Wu(t,e,n){D$(t,e),e.set(t,n)}function D$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(hT(t,e))}function zI(t,e,n){return t.set(hT(t,e),n),n}function hT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gn=new WeakMap,Pr=new WeakMap,$C=new WeakMap,Fd=new WeakMap,LC=new WeakMap,al=new WeakMap,YI=new WeakSet;class Rne{constructor(e){Sne(this,YI),Wu(this,Gn,void 0),Wu(this,Pr,void 0),Wu(this,$C,new Cne),Wu(this,Fd,new WeakMap),Wu(this,LC,new WeakSet),Wu(this,al,new Map),zI(Pr,this,e)}setActiveOverlay(e){return zI(Gn,this,e),$e($C,this).setActiveOverlay($e(Gn,this)),$e(Fd,this).has($e(Gn,this))||$e(Fd,this).set($e(Gn,this),new Set),this}getFocusSelection(){return $e(Pr,this)!==null?$e(Pr,this).getFocus():null}getAreaSelection(){return $e(Pr,this)!==null?$e(Pr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if($e(al,this).has(e)){const r=$e(al,this).get(e);if(r.has($e(Gn,this)))return r.get($e(Gn,this));const i=new UI($e(Gn,this),e.settings);return r.set($e(Gn,this),i),i}const n=new UI($e(Gn,this),e.settings);return $e(al,this).set(e,new Map([[$e(Gn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=$e(al,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){$e(al,this).get(e).forEach(n=>n.destroy()),$e(al,this).delete(e)}render(e){if($e(Pr,this)===null)return;e&&hT(YI,this,Ene).call(this);const n=Array.from($e(Pr,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;$e(LC,this).has(s)||($e(LC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&$e($C,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const w=r.get(g);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();$e(Gn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>$e(Fd,this).get($e(Gn,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=$e(Pr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&be(s,$e(Pr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{be(o,[...i.get(o)])})}}function Ene(){const t=$e(Fd,this).get($e(Gn,this)),e=$e(Gn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=$e(Gn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=$e(Pr,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=$e(Pr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=$e(Pr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...$e(Pr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)we(o[a],n),Iu(o[a],s)}),t.clear()}class Tne extends bg{constructor(e,n,r,i){super(e,n,mu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new aT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),jv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),gg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,HE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Pn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=nn(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=cT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Pn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Fk(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(NE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?we(r,"emptyRows"):X(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(r,"innerBorderInlineStart");e?(X(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(we(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const Mne="stickyRowsTop",dT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ns(dT,"MIXIN_NAME",Mne,{writable:!1,enumerable:!1});class fT extends Ch{constructor(e,n,r,i){super(e,n,r,i,pu)}}yt(fT,dT);yt(fT,Xv);function GI(t,e,n){return(e=_ne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ne(t){var e=xne(t,"string");return typeof e=="symbol"?e:e+""}function xne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pne extends bg{constructor(e,n,r,i,o,s){super(e,n,pu,r,i),GI(this,"topOverlay",void 0),GI(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new fT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();jv(e,`${i}px`,`${o}px`)}else gg(e);let n=hn(this.clone.wtTable.TABLE);const r=nn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class gT extends Ch{constructor(e,n,r,i){super(e,n,r,i,gu)}}yt(gT,dT);yt(gT,Jv);function Ine(t,e,n){return(e=One(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function One(t){var e=Ane(t,"string");return typeof e=="symbol"?e:e+""}function Ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hne extends bg{constructor(e,n,r,i){super(e,n,gu,r,i),Ine(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new gT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),jv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),gg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Bv(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Pn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=hn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=cT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=Pn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Lk(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Wv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?we(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(we(i,"innerBorderTop"),a=h)}}return a}}function om(t,e,n){Nne(t,e),e.set(t,n)}function Nne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ls(t,e,n){return(e=Dne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dne(t){var e=kne(t,"string");return typeof e=="symbol"?e:e+""}function kne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ll(t,e,n){return t.set(k$(t,e),n),n}function us(t,e){return t.get(k$(t,e))}function k$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ju=new WeakMap,sm=new WeakMap,Uu=new WeakMap,am=new WeakMap;class $ne{constructor(e,n,r,i,o,s){ls(this,"wot",null),om(this,ju,[]),ls(this,"topOverlay",null),ls(this,"bottomOverlay",null),ls(this,"inlineStartOverlay",null),ls(this,"topInlineStartCornerOverlay",null),ls(this,"bottomInlineStartCornerOverlay",null),ls(this,"browserLineHeight",void 0),ls(this,"wtSettings",null),om(this,sm,!1),om(this,Uu,0),om(this,am,null),ls(this,"resizeObserver",new ResizeObserver(c=>{Af(()=>{!Array.isArray(c)||!c.length||(ll(Uu,this,us(Uu,this)+1),us(Uu,this)===100&&(ot("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),us(am,this)!==null&&clearTimeout(us(am,this)),ll(am,this,setTimeout(()=>{ll(Uu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Pn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:If(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...us(ju,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Hne(...e),this.bottomOverlay=new hne(...e),this.inlineStartOverlay=new Tne(...e),this.topInlineStartCornerOverlay=new Pne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new sne(...e,this.bottomOverlay,this.inlineStartOverlay),ll(ju,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ll(sm,this,us(ju,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),us(ju,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),us(ju,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!UE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Af(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ll(Uu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=yh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!us(sm,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),ll(sm,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=If(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),w=f()?1:0,C=g()?1:0;d.width=`${c+C}px`,d.height=`${u+w}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return P(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];P(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function KI(t,e,n){return(e=Lne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lne(t){var e=Fne(t,"string");return typeof e=="symbol"?e:e+""}function Fne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vne{constructor(e){KI(this,"settings",{}),KI(this,"defaults",Object.freeze(this.getDefaults())),ke(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Ya(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?ke(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class mT extends Ch{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Qc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Of(e,"height",n),o=Of(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=du(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}yt(mT,sT);yt(mT,Jv);class Bne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new cee:new pee],["fullyVisible",()=>new eee],["partiallyVisible",()=>new R$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new aee:new fee],["fullyVisible",()=>new JQ],["partiallyVisible",()=>new S$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=hn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Vn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=hn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=nn(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Pn(this.domBindings.rootDocument),new Eee({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Pn(this.domBindings.rootDocument)),new bee({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){ke(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function Wne(t,e){$$(t,e),e.add(t)}function ul(t,e,n){$$(t,e),e.set(t,n)}function $$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(Ji(t,e))}function Xi(t,e,n){return t.set(Ji(t,e),n),n}function Ji(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qI=23;var Po=new WeakMap,Os=new WeakMap,pT=new WeakMap,NR=new WeakMap,wa=new WeakMap,Vd=new WeakMap,Df=new WeakMap,Ao=new WeakSet;class jne{constructor(e){Wne(this,Ao),ul(this,Po,void 0),ul(this,Os,void 0),ul(this,pT,void 0),ul(this,NR,void 0),ul(this,wa,!0),ul(this,Vd,{}),ul(this,Df,{}),Xi(Os,this,e.rootTable.parentElement.parentElement),Xi(NR,this,e.rootDocument)}isClassicTheme(){return kt(wa,this)}getCSSVariableValue(e){var n;if(kt(wa,this))return null;if(kt(Vd,this)[`--ht-${e}`])return kt(Vd,this)[`--ht-${e}`];const r=(n=Ji(Ao,this,Gne).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Ji(Ao,this,L$).call(this,`--ht-${e}`);if(r!==null)return kt(Vd,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=kt(Df,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(kt(wa,this))return qI;const e=Ji(Ao,this,Une).call(this);return!e&&ve(kt(Os,this),"ht-wrapper")?(ot(`The "${kt(Po,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Xi(wa,this,!0),this.useTheme(),qI):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Ji(Ao,this,XI).call(this),Xi(wa,this,!0),Xi(Po,this,e||void 0);return}e&&e!==kt(Po,this)&&(kt(Po,this)&&Ji(Ao,this,Kne).call(this),Xi(Po,this,e),Xi(wa,this,!1),Ji(Ao,this,zne).call(this),Ji(Ao,this,XI).call(this))}getThemeName(){return kt(Po,this)}removeClassNames(){ve(kt(Os,this),kt(Po,this))&&we(kt(Os,this),kt(Po,this))}}function Une(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function zne(){we(kt(Os,this),/ht-theme-.*/g),X(kt(Os,this),kt(Po,this))}function XI(){this.isClassicTheme()||Xi(pT,this,getComputedStyle(kt(Os,this)));const t=Ji(Ao,this,Yne).call(this,["box-sizing","border-bottom-width"]);kt(Df,this).td={...kt(Df,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Yne(t){const e=kt(NR,this),n=kt(Os,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function Gne(t){const e=Math.ceil(parseFloat(Ji(Ao,this,L$).call(this,t)));return Number.isNaN(e)?null:e}function L$(t){const e=kt(pT,this).getPropertyValue(t);return e===""?null:e}function Kne(){Xi(Df,this,{}),Xi(Vd,this,{}),Xi(wa,this,!0)}class qne extends iT{constructor(e,n){super(e,new Vne(n)),this.stylesHandler=new jne(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new mT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Bne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Rne(this.wtSettings.getSetting("selections")),this.wtEvent=new x$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new $ne(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];ke(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),we(this.wtTable.wtRootElement.parentNode,n),X(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!O$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class wT{constructor(e){e instanceof iT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new wT(n);return()=>r},this._wot=new qne(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function JI(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Xne(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const Jne=new Map([["mousedown",JI],["mouseover",Xne],["touchstart",JI]]);function ZI(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;Jne.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Gv(t)||t.type==="touchstart",isRightClick:Ga(t)})}const F$=new WeakMap,vT=Symbol("rootInstance");function Zne(t){F$.set(t,!0)}function Qne(t){return t===vT}function Fp(t){return F$.has(t)}function ere(t,e){V$(t,e),e.add(t)}function na(t,e,n){V$(t,e),e.set(t,n)}function V$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ra(t,e,n){return(e=tre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tre(t){var e=nre(t,"string");return typeof e=="symbol"?e:e+""}function nre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function on(t,e){return t.get(zc(t,e))}function yr(t,e,n){return t.set(zc(t,e),n),n}function zc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var FC=new WeakMap,lm=new WeakMap,um=new WeakMap,cs=new WeakMap,$i=new WeakMap,VC=new WeakMap,BC=new WeakMap,zu=new WeakMap,Bd=new WeakSet;class rre{constructor(e){ere(this,Bd),ra(this,"hot",void 0),ra(this,"eventManager",void 0),ra(this,"settings",void 0),ra(this,"THEAD",void 0),ra(this,"TBODY",void 0),ra(this,"_wt",void 0),ra(this,"activeWt",void 0),na(this,FC,0),na(this,lm,0),ra(this,"postponedAdjustElementsSize",!1),na(this,um,!1),na(this,cs,void 0),na(this,$i,void 0),na(this,VC,0),na(this,BC,0),na(this,zu,null),this.hot=e,this.eventManager=new Mi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),zc(Bd,this,ore).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),X(e,"handsontable"),yr($i,this,n.createElement("TABLE")),X(on($i,this),"htCore"),this.hot.getSettings().tableClassName&&X(on($i,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(be(on($i,this),[Ds()]),be(e,[x8(),_k(-1),Vv(this.hot.countCols()),W8()])),this.THEAD=n.createElement("THEAD"),on($i,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),on($i,this).appendChild(this.TBODY),this.hot.table=on($i,this),this.hot.container.insertBefore(on($i,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{yr(um,this,!0),this.isTextSelectionAllowed(a.target)||(SR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{yr(um,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{on(um,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&SR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&Gv(a)&&r.finish(),yr(cs,this,!1);const l=Uv(n.activeElement);Jd(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Ga(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&Ga(a)&&(r.finish(),yr(cs,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),yr(cs,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(on(cs,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=Pn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=hu(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=hu(s);this.eventManager.addEventListener(on($i,this),"selectstart",a=>{this.settings.fragmentSelection||Jd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&X(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&we(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:on($i,this),isDataViewInstance:()=>Fp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),yr(lm,this,o.length),this.hot.getSettings().ariaTags&&zc(Bd,this,B$).call(this)===this.hot.countCols()&&zc(Bd,this,ire).call(this,on(lm,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),yr(FC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,w,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,w,f),this.hot.runHooks("afterRenderer",a,l,u,g,w,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&du(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,yr(cs,this,!0),yr(zu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ea(o)&&(ZI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,yr(cs,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ea(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ea(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ea(o)&&(on(cs,this)&&(!on(zu,this)||on(zu,this).x!==o.clientX||on(zu,this).y!==o.clientY)&&ZI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,yr(zu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ea(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,w,C,R]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,R>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(R,-1)):R]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new wT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Jd(e))return!0;const n=Fa(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return on(cs,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ve(r,"relative")){Xo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",X(s,["relative",...o()])):(Xo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(be(a,...Ds()),be(l,...Ds())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ou(e,r(n,i)):(Ya(e," "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){yr(VC,this,e),yr(BC,this,n)}getLastSize(){return{width:on(VC,this),height:on(BC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return on(FC,this)}getRowHeadersCount(){return on(lm,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function B$(){return parseInt(this.hot.rootElement.getAttribute(Vv()[0]),10)}function ire(t){const e=zc(Bd,this,B$).call(this)+t;be(this.hot.rootElement,...Vv(e))}function ore(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):we(t,"htHasScrollY"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):we(t,"htHasScrollX")}var sre=Et,are=bn,lre=gh,ure=Lr,cre=Rn,hre=Qo,dre=ni,fre=Ja,WC=fre("every",TypeError);sre({target:"Iterator",proto:!0,real:!0,forced:WC},{every:function(e){cre(this);try{ure(e)}catch(i){dre(this,"throw",i)}if(WC)return are(WC,this,e);var n=hre(this),r=0;return!lre(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const W$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",DR=W$.length;function Zv(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%DR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/DR,10);return n}function gre(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=DR**r*(W$.indexOf(t[n])+1);return e-=1,e}function mre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Zv(i)+(r+1));n.push(o)}return n}function pre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Zv(i)+(r+1);n.push(o)}return n}function wre(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function yT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function CT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&De(t[0])&&(e=Yv(t[0]))),e}function j$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function U$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const vre=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:CT,createEmptySpreadsheetData:wre,createSpreadsheetData:mre,createSpreadsheetObjectData:pre,dataRowToChangesArray:yT,isArrayOfArrays:j$,isArrayOfObjects:U$,spreadsheetColumnIndex:gre,spreadsheetColumnLabel:Zv},Symbol.toStringTag,{value:"Module"}));function Jh(t,e,n){return(e=yre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yre(t){var e=Cre(t,"string");return typeof e=="symbol"?e:e+""}function Cre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Jh(this,"hot",void 0),Jh(this,"data",void 0),Jh(this,"dataType","array"),Jh(this,"colToProp",()=>{}),Jh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return P(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(De(a)||ft(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?kp(l,d,f):l[d]=f}})}else ke(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?kp(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=kr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:kp(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Xk(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=kr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return CT(this.data)}destroy(){this.data=null,this.hot=null}}var Sre=Et,Rre=bn,Ere=gh,Tre=Lr,Mre=Rn,_re=Qo,xre=ni,Pre=Ja,jC=Pre("some",TypeError);Sre({target:"Iterator",proto:!0,real:!0,forced:jC},{some:function(e){Mre(this);try{Tre(e)}catch(i){xre(this,"throw",i)}if(jC)return Rre(jC,this,e);var n=_re(this),r=0;return Ere(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function QI(t,e,n){return(e=Ire(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ire(t){var e=Ore(t,"string");return typeof e=="symbol"?e:e+""}function Ore(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Au{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;QI(this,"indexedValues",[]),QI(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ft(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}yt(Au,Bn);function bT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>ft(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function ST(t,e){return Ua(t,(n,r)=>e.includes(r)===!1)}class Za extends Au{insert(e,n){this.indexedValues=bT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=ST(this.indexedValues,e),super.remove(e)}}class Qv extends Za{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return En(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function RT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function kf(t,e){return Ua(t,n=>e.includes(n)===!1)}function ET(t,e){return ze(t,n=>n-e.filter(r=>r<n).length)}function TT(t,e){const n=e[0],r=e.length;return ze(t,i=>i>=n?i+r:i)}function Are(t,e,n){return(e=Hre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hre(t){var e=Nre(t,"string");return typeof e=="symbol"?e:e+""}function Nre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ey extends Au{constructor(){super(...arguments),Are(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=kf(this.orderOfIndexes,[e]),ft(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=bT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=TT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=ST(this.indexedValues,e),this.orderOfIndexes=kf(this.orderOfIndexes,e),this.orderOfIndexes=ET(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Sg extends Za{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return En(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const eO=new Map([["indexesSequence",{getListWithInsertedItems:RT,getListWithRemovedItems:kf}],["physicallyIndexed",{getListWithInsertedItems:bT,getListWithRemovedItems:ST}]]),z$=t=>{if(eO.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return eO.get(t)};class Y$ extends Au{constructor(){super(e=>e)}insert(e,n){const r=TT(this.indexedValues,n);this.indexedValues=RT(r,e,n),super.insert(e,n)}remove(e){const n=kf(this.indexedValues,e);this.indexedValues=ET(n,e),super.remove(e)}}const tO=new Map([["hiding",Qv],["index",Au],["linkedPhysicalIndexToValue",ey],["physicalIndexToValue",Za],["trimming",Sg]]);function Dre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!tO.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(tO.get(t))(e)}function kre(t,e,n){return(e=$re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $re(t){var e=Lre(t,"string");return typeof e=="symbol"?e:e+""}function Lre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let kR=0;class MT{constructor(){kre(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),kR+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),kR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return $t(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}yt(MT,Bn);function Fre(){return kR}function UC(t,e,n){return(e=Vre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vre(t){var e=Bre(t,"string");return typeof e=="symbol"?e:e+""}function Bre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nO extends MT{constructor(e,n){super(),UC(this,"mergedValuesCache",[]),UC(this,"aggregationFunction",void 0),UC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=ze(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return ze(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Wre(t,e,n){jre(t,e),e.set(t,n)}function jre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ure(t,e,n){return t.set(G$(t,e),n),n}function zre(t,e){return t.get(G$(t,e))}function G$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zC=new WeakMap;class K${constructor(){Wre(this,zC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(zre(zC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Ure(zC,this,e)}}yt(K$,Bn);function rO(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Zh(t,e,n){Yre(t,e),e.set(t,n)}function Yre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ci(t,e){return t.get(q$(t,e))}function cm(t,e,n){return t.set(q$(t,e),n),n}function q$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hm=new WeakMap,Qh=new WeakMap,dm=new WeakMap,fm=new WeakMap,gm=new WeakMap;class Gre{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zh(this,hm,new Set),Zh(this,Qh,[]),Zh(this,dm,[]),Zh(this,fm,!1),Zh(this,gm,!1),cm(gm,this,e??!1)}createObserver(){const e=new K$;return ci(hm,this).add(e),e.addLocalHook("unsubscribe",()=>{ci(hm,this).delete(e)}),e._writeInitialChanges(rO(ci(Qh,this),ci(dm,this))),e}emit(e){let n=ci(dm,this);(!ci(fm,this)||ci(Qh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(ci(gm,this)):cm(Qh,this,new Array(e.length).fill(ci(gm,this))),ci(fm,this)||(cm(fm,this,!0),n=ci(Qh,this)));const r=rO(n,e);ci(hm,this).forEach(i=>i._write(r)),cm(dm,this,e)}}function ir(t,e,n){return(e=Kre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kre(t){var e=qre(t,"string");return typeof e=="symbol"?e:e+""}function qre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $R{constructor(){ir(this,"indexesSequence",new Y$),ir(this,"trimmingMapsCollection",new nO(e=>e.some(n=>n===!0),!1)),ir(this,"hidingMapsCollection",new nO(e=>e.some(n=>n===!0),!1)),ir(this,"variousMapsCollection",new MT),ir(this,"hidingChangesObservable",new Gre({initialIndexValue:!1})),ir(this,"notTrimmedIndexesCache",[]),ir(this,"notHiddenIndexesCache",[]),ir(this,"isBatched",!1),ir(this,"indexesSequenceChanged",!1),ir(this,"indexesChangeSource",void 0),ir(this,"trimmedIndexesChanged",!1),ir(this,"hiddenIndexesChanged",!1),ir(this,"renderablePhysicalIndexesCache",[]),ir(this,"fromPhysicalToVisualIndexesCache",new Map),ir(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,Dre(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Sg?this.trimmingMapsCollection.register(e,n):n instanceof Qv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=ze(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=kf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(RT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=ze(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}yt($R,Bn);function Xre(t,e){return ke(e,(n,r)=>{$t(t[r])&&(t[r]=n)}),t}function X$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function J$(t){le(t)&&KE(mt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Jre(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Zre,getValues:Qre}=uo("phraseFormatters");function eie(t,e){Zre(t,e)}function tie(){return Qre()}eie("pluralize",Jre);const Z$="ContextMenu:items",Ie=Z$,_T=`${Ie}.noItems`,xT=`${Ie}.insertRowAbove`,PT=`${Ie}.insertRowBelow`,IT=`${Ie}.insertColumnOnTheLeft`,OT=`${Ie}.insertColumnOnTheRight`,AT=`${Ie}.removeRow`,HT=`${Ie}.removeColumn`,NT=`${Ie}.undo`,DT=`${Ie}.redo`,Ow=`${Ie}.readOnly`,kT=`${Ie}.clearColumn`,$T=`${Ie}.copy`,LT=`${Ie}.copyWithHeaders`,FT=`${Ie}.copyWithGroupHeaders`,VT=`${Ie}.copyHeadersOnly`,BT=`${Ie}.cut`,WT=`${Ie}.freezeColumn`,jT=`${Ie}.unfreezeColumn`,UT=`${Ie}.mergeCells`,zT=`${Ie}.unmergeCells`,YT=`${Ie}.addComment`,GT=`${Ie}.editComment`,KT=`${Ie}.removeComment`,qT=`${Ie}.readOnlyComment`,XT=`${Ie}.align`,JT=`${Ie}.align.left`,ZT=`${Ie}.align.center`,QT=`${Ie}.align.right`,eM=`${Ie}.align.justify`,tM=`${Ie}.align.top`,nM=`${Ie}.align.middle`,rM=`${Ie}.align.bottom`,iM=`${Ie}.borders`,oM=`${Ie}.borders.top`,sM=`${Ie}.borders.right`,aM=`${Ie}.borders.bottom`,lM=`${Ie}.borders.left`,uM=`${Ie}.borders.remove`,cM=`${Ie}.nestedHeaders.insertChildRow`,hM=`${Ie}.nestedHeaders.detachFromParent`,dM=`${Ie}.hideColumn`,fM=`${Ie}.showColumn`,gM=`${Ie}.hideRow`,mM=`${Ie}.showRow`,pr="Filters:",Xt=`${pr}conditions`,ty=`${Xt}.none`,pM=`${Xt}.isEmpty`,wM=`${Xt}.isNotEmpty`,vM=`${Xt}.isEqualTo`,yM=`${Xt}.isNotEqualTo`,CM=`${Xt}.beginsWith`,bM=`${Xt}.endsWith`,SM=`${Xt}.contains`,RM=`${Xt}.doesNotContain`,nie=`${Xt}.byValue`,EM=`${Xt}.greaterThan`,TM=`${Xt}.greaterThanOrEqualTo`,MM=`${Xt}.lessThan`,_M=`${Xt}.lessThanOrEqualTo`,xM=`${Xt}.isBetween`,PM=`${Xt}.isNotBetween`,IM=`${Xt}.after`,OM=`${Xt}.before`,AM=`${Xt}.today`,HM=`${Xt}.tomorrow`,NM=`${Xt}.yesterday`,DM=`${pr}labels.filterByCondition`,kM=`${pr}labels.filterByValue`,$M=`${pr}labels.conjunction`,ny=`${pr}labels.disjunction`,Aw=`${pr}values.blankCells`,LM=`${pr}buttons.selectAll`,FM=`${pr}buttons.clear`,VM=`${pr}buttons.ok`,BM=`${pr}buttons.cancel`,WM=`${pr}buttons.placeholder.search`,jM=`${pr}buttons.placeholder.value`,UM=`${pr}buttons.placeholder.secondValue`,zM="CheckboxRenderer:",YM=`${zM}checked`,GM=`${zM}unchecked`,rie=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:YM,CHECKBOX_RENDERER_NAMESPACE:zM,CHECKBOX_UNCHECKED:GM,CONTEXTMENU_ITEMS_ADD_COMMENT:YT,CONTEXTMENU_ITEMS_ALIGNMENT:XT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:rM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:ZT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:eM,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:JT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:nM,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:QT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:tM,CONTEXTMENU_ITEMS_BORDERS:iM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:aM,CONTEXTMENU_ITEMS_BORDERS_LEFT:lM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:sM,CONTEXTMENU_ITEMS_BORDERS_TOP:oM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:kT,CONTEXTMENU_ITEMS_COPY:$T,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:VT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:FT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:LT,CONTEXTMENU_ITEMS_CUT:BT,CONTEXTMENU_ITEMS_EDIT_COMMENT:GT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:WT,CONTEXTMENU_ITEMS_HIDE_COLUMN:dM,CONTEXTMENU_ITEMS_HIDE_ROW:gM,CONTEXTMENU_ITEMS_INSERT_LEFT:IT,CONTEXTMENU_ITEMS_INSERT_RIGHT:OT,CONTEXTMENU_ITEMS_MERGE_CELLS:UT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:hM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:cM,CONTEXTMENU_ITEMS_NO_ITEMS:_T,CONTEXTMENU_ITEMS_READ_ONLY:Ow,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:qT,CONTEXTMENU_ITEMS_REDO:DT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:uM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:HT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:KT,CONTEXTMENU_ITEMS_REMOVE_ROW:AT,CONTEXTMENU_ITEMS_ROW_ABOVE:xT,CONTEXTMENU_ITEMS_ROW_BELOW:PT,CONTEXTMENU_ITEMS_SHOW_COLUMN:fM,CONTEXTMENU_ITEMS_SHOW_ROW:mM,CONTEXTMENU_ITEMS_UNDO:NT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:jT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:zT,CONTEXT_MENU_ITEMS_NAMESPACE:Z$,FILTERS_BUTTONS_CANCEL:BM,FILTERS_BUTTONS_CLEAR:FM,FILTERS_BUTTONS_OK:VM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:WM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:UM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:jM,FILTERS_BUTTONS_SELECT_ALL:LM,FILTERS_CONDITIONS_AFTER:IM,FILTERS_CONDITIONS_BEFORE:OM,FILTERS_CONDITIONS_BEGINS_WITH:CM,FILTERS_CONDITIONS_BETWEEN:xM,FILTERS_CONDITIONS_BY_VALUE:nie,FILTERS_CONDITIONS_CONTAINS:SM,FILTERS_CONDITIONS_EMPTY:pM,FILTERS_CONDITIONS_ENDS_WITH:bM,FILTERS_CONDITIONS_EQUAL:vM,FILTERS_CONDITIONS_GREATER_THAN:EM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:TM,FILTERS_CONDITIONS_LESS_THAN:MM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:_M,FILTERS_CONDITIONS_NAMESPACE:Xt,FILTERS_CONDITIONS_NONE:ty,FILTERS_CONDITIONS_NOT_BETWEEN:PM,FILTERS_CONDITIONS_NOT_CONTAIN:RM,FILTERS_CONDITIONS_NOT_EMPTY:wM,FILTERS_CONDITIONS_NOT_EQUAL:yM,FILTERS_CONDITIONS_TODAY:AM,FILTERS_CONDITIONS_TOMORROW:HM,FILTERS_CONDITIONS_YESTERDAY:NM,FILTERS_DIVS_FILTER_BY_CONDITION:DM,FILTERS_DIVS_FILTER_BY_VALUE:kM,FILTERS_LABELS_CONJUNCTION:$M,FILTERS_LABELS_DISJUNCTION:ny,FILTERS_NAMESPACE:pr,FILTERS_VALUES_BLANK_CELLS:Aw},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Q$={languageCode:"en-US",[_T]:"No available options",[xT]:"Insert row above",[PT]:"Insert row below",[IT]:"Insert column left",[OT]:"Insert column right",[AT]:["Remove row","Remove rows"],[HT]:["Remove column","Remove columns"],[NT]:"Undo",[DT]:"Redo",[Ow]:"Read only",[kT]:"Clear column",[XT]:"Alignment",[JT]:"Left",[ZT]:"Center",[QT]:"Right",[eM]:"Justify",[tM]:"Top",[nM]:"Middle",[rM]:"Bottom",[WT]:"Freeze column",[jT]:"Unfreeze column",[iM]:"Borders",[oM]:"Top",[sM]:"Right",[aM]:"Bottom",[lM]:"Left",[uM]:"Remove border(s)",[YT]:"Add comment",[GT]:"Edit comment",[KT]:"Delete comment",[qT]:"Read-only comment",[UT]:"Merge cells",[zT]:"Unmerge cells",[$T]:"Copy",[LT]:["Copy with header","Copy with headers"],[FT]:["Copy with group header","Copy with group headers"],[VT]:["Copy header only","Copy headers only"],[BT]:"Cut",[cM]:"Insert child row",[hM]:"Detach from parent",[dM]:["Hide column","Hide columns"],[fM]:["Show column","Show columns"],[gM]:["Hide row","Hide rows"],[mM]:["Show row","Show rows"],[ty]:"None",[pM]:"Is empty",[wM]:"Is not empty",[vM]:"Is equal to",[yM]:"Is not equal to",[CM]:"Begins with",[bM]:"Ends with",[SM]:"Contains",[RM]:"Does not contain",[EM]:"Greater than",[TM]:"Greater than or equal to",[MM]:"Less than",[_M]:"Less than or equal to",[xM]:"Is between",[PM]:"Is not between",[IM]:"After",[OM]:"Before",[AM]:"Today",[HM]:"Tomorrow",[NM]:"Yesterday",[Aw]:"Blank cells",[DM]:"Filter by condition",[kM]:"Filter by value",[$M]:"And",[ny]:"Or",[LM]:"Select all",[FM]:"Clear",[VM]:"OK",[BM]:"Cancel",[WM]:"Search",[jM]:"Value",[UM]:"Second value",[YM]:"Checked",[GM]:"Unchecked"},iie=rie,LR=Q$.languageCode,{register:oie,getItem:eL,hasItem:sie,getValues:aie}=uo("languagesDictionaries");tL(Q$);function tL(t,e){let n=t,r=e;return De(t)&&(r=t,n=r.languageCode),lie(n,r),oie(n,tr(r)),tr(r)}function lie(t,e){t!==LR&&Xre(e,eL(LR))}function nL(t){return KM(t)?tr(eL(t)):null}function KM(t){return sie(t)}function uie(){return aie()}function rL(t,e,n){const r=nL(t);if(r===null)return null;const i=r[e];if($t(i))return null;const o=cie(i,n);return Array.isArray(o)?o[0]:o}function cie(t,e){let n=t;return P(tie(),r=>{n=r(t,e)}),n}function hie(t){let e=X$(t);return KM(e)||(e=LR,J$(t)),e}function die(t,e,n){return(e=fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fie(t){var e=gie(t,"string");return typeof e=="symbol"?e:e+""}function gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zs extends A${constructor(e,n){super(e,null),die(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function YC(t){let{activeHeaderClassName:e,...n}=t;return new Zs({className:e,...n,selectionType:H$})}function mie(t){let{areaCornerVisible:e,...n}=t;return new Zs({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:uT})}function pie(t){let{...e}=t;return new Zs({className:"highlight",...e,selectionType:uT})}function wie(t){let{columnClassName:e,...n}=t;return new Zs({className:e,...n,selectionType:pne})}function vie(t){let{cellCornerVisible:e,...n}=t;return new Zs({className:"current",headerAttributes:[OE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Zd})}function yie(t){let{border:e,visualCellRange:n,...r}=t;return new Zs({...e,...r,selectionType:wne},n)}function Cie(t){let{...e}=t;return new Zs({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:gne})}function iO(t){let{headerClassName:e,...n}=t;return new Zs({className:e,...n,selectionType:lT})}function bie(t){let{rowClassName:e,...n}=t;return new Zs({className:e,...n,selectionType:mne})}function Sie(t,e){Rie(t,e),e.add(t)}function Rie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cr(t,e,n){return(e=Eie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eie(t){var e=Tie(t,"string");return typeof e=="symbol"?e:e+""}function Tie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wo=new WeakSet;class Mie{constructor(e){Sie(this,wo),Cr(this,"options",void 0),Cr(this,"layerLevel",0),Cr(this,"focus",void 0),Cr(this,"fill",void 0),Cr(this,"layeredAreas",new Map),Cr(this,"areas",new Map),Cr(this,"rowHeaders",new Map),Cr(this,"columnHeaders",new Map),Cr(this,"activeRowHeaders",new Map),Cr(this,"activeColumnHeaders",new Map),Cr(this,"activeCornerHeaders",new Map),Cr(this,"rowHighlights",new Map),Cr(this,"columnHighlights",new Map),Cr(this,"customSelections",[]),this.options=e,this.focus=vie(e),this.fill=Cie(e)}isEnabledFor(e,n){let r=e;e===Zd&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return hs(wo,this,ds).call(this,this.layeredAreas,mie)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return hs(wo,this,ds).call(this,this.areas,pie)}getAreas(){return[...this.areas.values()]}createRowHeader(){return hs(wo,this,ds).call(this,this.rowHeaders,iO)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return hs(wo,this,ds).call(this,this.columnHeaders,iO)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return hs(wo,this,ds).call(this,this.activeRowHeaders,YC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return hs(wo,this,ds).call(this,this.activeColumnHeaders,YC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return hs(wo,this,ds).call(this,this.activeCornerHeaders,YC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return hs(wo,this,ds).call(this,this.rowHighlights,bie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return hs(wo,this,ds).call(this,this.columnHighlights,wie)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(yie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),P(this.areas.values(),e=>void e.clear()),P(this.layeredAreas.values(),e=>void e.clear()),P(this.rowHeaders.values(),e=>void e.clear()),P(this.columnHeaders.values(),e=>void e.clear()),P(this.activeRowHeaders.values(),e=>void e.clear()),P(this.activeColumnHeaders.values(),e=>void e.clear()),P(this.activeCornerHeaders.values(),e=>void e.clear()),P(this.rowHighlights.values(),e=>void e.clear()),P(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ds(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function oO(t,e,n){return(e=_ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=xie(t,"string");return typeof e=="symbol"?e:e+""}function xie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pie{constructor(e){oO(this,"ranges",[]),oO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function Iie(t,e){iL(t,e),e.add(t)}function GC(t,e,n){iL(t,e),e.set(t,n)}function iL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qe(t,e){return t.get(vn(t,e))}function mm(t,e,n){return t.set(vn(t,e),n),n}function vn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pm=new WeakMap,_t=new WeakMap,no=new WeakMap,Mn=new WeakSet;class FR{constructor(e,n){Iie(this,Mn),GC(this,pm,void 0),GC(this,_t,void 0),GC(this,no,{x:0,y:0}),mm(pm,this,e),mm(_t,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Qe(_t,this).createCellCoords(e,n);let o=Qe(pm,this).current().highlight;const s=Qe(_t,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=vn(Mn,this,oL).call(this),{row:h,col:d}=vn(Mn,this,aO).call(this,o),f=Qe(_t,this).fixedRowsBottom(),g=Qe(_t,this).minSpareRows(),w=Qe(_t,this).minSpareCols(),C=Qe(_t,this).autoWrapRow(),R=Qe(_t,this).autoWrapCol(),y=Qe(_t,this).createCellCoords(h+i.row,d+i.col);if(y.row>=c){const _=kr(r&&g>0&&f===0),T=y.col+1,I=Qe(_t,this).createCellCoords(y.row-c,T>=u?T-u:T);this.runLocalHooks("beforeColumnWrap",_,vn(Mn,this,Yu).call(this,I),T>=u),_.value?this.runLocalHooks("insertRowRequire",Qe(_t,this).countRenderableRows()):R&&y.assign(I)}else if(y.row<0){const _=kr(R),T=y.col-1,I=Qe(_t,this).createCellCoords(c+y.row,T<0?u+T:T);this.runLocalHooks("beforeColumnWrap",_,vn(Mn,this,Yu).call(this,I),T<0),R&&y.assign(I)}if(y.col>=u){const _=kr(r&&w>0),T=y.row+1,I=Qe(_t,this).createCellCoords(T>=c?T-c:T,y.col-u);this.runLocalHooks("beforeRowWrap",_,vn(Mn,this,Yu).call(this,I),T>=c),_.value?this.runLocalHooks("insertColRequire",Qe(_t,this).countRenderableColumns()):C&&y.assign(I)}else if(y.col<0){const _=kr(C),T=y.row-1,I=Qe(_t,this).createCellCoords(T<0?c+T:T,u+y.col);this.runLocalHooks("beforeRowWrap",_,vn(Mn,this,Yu).call(this,I),T<0),C&&y.assign(I)}const{rowDir:M,colDir:x}=vn(Mn,this,sO).call(this,y);a=M,l=x,o=vn(Mn,this,Yu).call(this,y)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Qe(_t,this).createCellCoords(e,n),i=Qe(pm,this).current(),o=Qe(_t,this).visualToRenderableCoords(i.highlight),s=vn(Mn,this,KC).call(this,i.to.row,i.from.row),a=vn(Mn,this,qC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=vn(Mn,this,aO).call(this,i.highlight),f=Qe(_t,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),w=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const x=f.col-d;f.col=vn(Mn,this,qC).call(this,g.col,w.col)+x}else if(r.col>0&&a<=d&&f.col>d){const x=vn(Mn,this,qC).call(this,w.col,g.col),_=Math.max(f.col-x,1);f.col=x+_}if(r.row<0&&s>=h&&f.row<h){const x=f.row-h;f.row=vn(Mn,this,KC).call(this,g.row,C.row)+x}else if(r.row>0&&s<=h&&f.row>h){const x=vn(Mn,this,KC).call(this,C.row,g.row),_=Math.max(f.row-x,1);f.row=x+_}const{rowDir:R,colDir:y}=vn(Mn,this,sO).call(this,f);u=R,c=y;const M=vn(Mn,this,Yu).call(this,f);r.row===0&&r.col!==0?l.col=M.col:r.row!==0&&r.col===0?l.row=M.row:(l.row=M.row,l.col=M.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;mm(no,this,{x:n,y:r})}resetOffsetSize(){mm(no,this,{x:0,y:0})}}function sO(t){const{width:e,height:n}=vn(Mn,this,oL).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function oL(){return{width:Qe(no,this).x+Qe(_t,this).countRenderableColumns(),height:Qe(no,this).y+Qe(_t,this).countRenderableRows()}}function KC(t,e){const n=Qe(_t,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Qe(no,this).y+n}function qC(t,e){const n=Qe(_t,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Qe(no,this).x+n}function aO(t){const{row:e,col:n}=Qe(_t,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Qe(_t,this).createCellCoords(Qe(no,this).y+e,Qe(no,this).x+n)}function Yu(t){const e=t.clone();return e.col=t.col-Qe(no,this).x,e.row=t.row-Qe(no,this).y,Qe(_t,this).renderableToVisualCoords(e)}yt(FR,Bn);const ry=0,iy=1,sL=2,qM=3,Oie=[qM,sL],Aie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],XC=Symbol("root"),lO=Symbol("child");function nh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XC;if(e!==XC&&e!==lO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===XC;let i=ry;if(n){const o=t[0];t.length===0?i=iy:r&&o instanceof yg?i=qM:r&&Array.isArray(o)?i=nh(o,lO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Aie[l].includes(typeof a))&&(i=sL)}return i}function $f(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Oie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===qM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),$t(u)&&(u=a),$t(c)&&(c=l),!r){const f=a,g=l,w=u,C=c;a=Math.min(f,w),l=Math.min(g,C),u=Math.max(f,w),c=Math.max(g,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Hie(t){const e=nh(t.getSelected());if(e===ry||e===iy)return[];const n=$f(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;P(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return En(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Nie(t){const e=nh(t.getSelected());if(e===ry||e===iy)return[];const n=$f(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;P(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return En(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Gu(t,e,n){Die(t,e),e.set(t,n)}function Die(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cl(t,e,n){return(e=kie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kie(t){var e=$ie(t,"string");return typeof e=="symbol"?e:e+""}function $ie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nt(t,e){return t.get(aL(t,e))}function vo(t,e,n){return t.set(aL(t,e),n),n}function aL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jn=new WeakMap,hl=new WeakMap,wm=new WeakMap,ed=new WeakMap,vm=new WeakMap,td=new WeakMap;class lL{constructor(e,n){var r=this;cl(this,"settings",void 0),cl(this,"tableProps",void 0),cl(this,"inProgress",!1),cl(this,"selectedRange",new Pie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),cl(this,"highlight",void 0),Gu(this,jn,void 0),Gu(this,hl,void 0),cl(this,"selectedByRowHeader",new Set),cl(this,"selectedByColumnHeader",new Set),Gu(this,wm,!1),Gu(this,ed,!1),Gu(this,vm,"unknown"),Gu(this,td,-1),this.settings=e,this.tableProps=n,this.highlight=new Mie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[OE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),vo(jn,this,new FR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),vo(hl,this,new FR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Nt(jn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Nt(jn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Nt(jn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Nt(jn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Nt(jn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Nt(jn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Nt(jn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Nt(jn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Nt(hl,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Nt(hl,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){vo(vm,this,e)}markEndSource(){vo(vm,this,"unknown")}getSelectionSource(){return Nt(vm,this)}setExpectedLayers(e){vo(td,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,vo(td,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=$t(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();vo(wm,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&$t(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Nt(td,this)===-1||this.selectedRange.size()===Nt(td,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(P(this.highlight.getAreas(),g=>void g.clear()),P(this.highlight.getLayeredAreas(),g=>void g.clear()),P(this.highlight.getRowHeaders(),g=>void g.clear()),P(this.highlight.getColumnHeaders(),g=>void g.clear()),P(this.highlight.getActiveRowHeaders(),g=>void g.clear()),P(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),P(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),P(this.highlight.getRowHighlights(),g=>void g.clear()),P(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(uT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(lT,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),R=this.tableProps.createCellCoords(e.to.row,-1),y=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(y).commit(),d.add(C).commit(),f.add(y).commit()):(a.add(C).add(R).commit(),l.add(y).add(M).commit(),d.add(C).add(R).commit(),f.add(y).add(M).commit())}const g=!Nt(ed,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!Nt(ed,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Zd,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(vo(wm,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Nt(jn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Nt(jn,this).resetOffsetSize(),this.setRangeStart(Nt(jn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?Nt(jn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Nt(jn,this).resetOffsetSize(),this.setRangeEnd(Nt(jn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?Nt(hl,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Nt(hl,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Nt(hl,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ge(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ge(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ge(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ge(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ge(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ge(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=kr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Nt(wm,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;vo(ed,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ge(d.row,u,o-1),Ge(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),vo(ed,this,!1)}selectCells(e){var n=this;const r=nh(e);if(r===iy)return!1;if(r===ry)throw new Error(mt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=$f(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),P(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ge(r.row,u,s-1),g=Ge(r.col,Math.min(i,o),Math.max(i,o))):(f=Ge(r,u,s-1),g=i);const w=this.tableProps.createCellCoords(f,g),C=l===0?0:Ge(w.row,u,-1),R=s-1,y=this.tableProps.createCellCoords(C,i),M=this.tableProps.createCellCoords(R,o);this.runLocalHooks("beforeSelectColumns",y,M,w),y.row=C,M.row=R,this.setRangeStartOnly(y,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",y,M,w),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ge(r.row,Math.min(e,n),Math.max(e,n)),d=Ge(r.col,a,o-1)):(h=e,d=Ge(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Ge(f.col,a,-1),w=o-1,C=this.tableProps.createCellCoords(e,g),R=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",C,R,f),C.col=g,R.col=w,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.runLocalHooks("afterSelectRows",C,R,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Ge(s.row,-1/0,e-1),col:Ge(s.col,-1/0,n-1)}),i.assign({row:Ge(i.row,-1/0,e-1),col:Ge(i.col,-1/0,n-1)}),o.assign({row:Ge(o.row,0,e-1),col:Ge(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(Zd,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Zd,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}yt(lL,Bn);const uO=/^(\r\n|\n\r|\r|\n)/,Lie=/^[^\t\r\n]+/,cO=/^\t/;function Fie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(cO))t=t.replace(cO,""),n+=1,e[r][n]="";else if(t.match(uO))t=t.replace(uO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Lie);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function ef(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function dl(t,e,n){return(e=Vie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vie(t){var e=Bie(t,"string");return typeof e=="symbol"?e:e+""}function Bie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ac{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){dl(this,"hot",void 0),dl(this,"metaManager",void 0),dl(this,"tableMeta",void 0),dl(this,"dataSource",void 0),dl(this,"duckSchema",void 0),dl(this,"colToPropCache",void 0),dl(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Yv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(De(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return CT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&ke(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?eh(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=tr(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},wg(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const w=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let R=0;R<h;R+=1)typeof o[R]>"u"&&(o[R]=[]),o[R].push(null);else o.push([null]);else for(let R=0;R<h;R++)o[R].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(w,n));const C=this.hot.toVisualColumn(w);return this.hot.runHooks("afterCreateCol",C,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:w}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];pR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return vk(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];pR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&cn(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=kr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=kr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&cn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Ac.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Ac.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return ef(this.getRange(e,n,Ac.DESTINATION_RENDERER))}getCopyableText(e,n){return ef(this.getRange(e,n,Ac.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:Wie,getItem:jie,hasItem:uL,getNames:Uie,getValues:A0e}=uo("cellTypes");function XM(t){if(!uL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return jie(t)}function di(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&xr(t,n),r&&zr(t,r),i&&ql(t,i),Wie(t,e)}function zie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!cn(e,t)}function oy(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?XM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ke(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!De(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};ke(r,(o,s)=>{if(zie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),dn(t,i)}function Yie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}qk(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Vp(t){return Number.isInteger(t)&&t>=0}function Bp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function ym(t){return t==null}const cL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),qt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),qt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),zv(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function hO(t,e,n){return(e=Gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=Kie(t,"string");return typeof e=="symbol"?e:e+""}function Kie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qie(){return class{}}class Xie{constructor(e){hO(this,"metaCtor",qie()),hO(this,"meta",void 0),this.meta=this.metaCtor.prototype,dn(this.meta,cL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;dn(this.meta,e),oy(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Jie(t,e,n){return(e=Zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zie(t){var e=Qie(t,"string");return typeof e=="symbol"?e:e+""}function Qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eoe{constructor(e){Jie(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){dn(this.meta,e),oy(this.meta,e,e)}}function Cm(t,e,n){return(e=toe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function toe(t){var e=noe(t,"string");return typeof e=="symbol"?e:e+""}function noe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hw{constructor(e){Cm(this,"valueFactory",void 0),Cm(this,"data",[]),Cm(this,"index",[]),Cm(this,"holes",new Set),this.valueFactory=e}obtain(e){Bp(()=>Vp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Bp(()=>Vp(e)||ym(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=ym(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Bp(()=>Vp(e)||ym(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(ym(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function dO(t,e,n){return(e=roe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function roe(t){var e=ioe(t,"string");return typeof e=="symbol"?e:e+""}function ioe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ooe=["data","width"];class soe{constructor(e){dO(this,"globalMeta",void 0),dO(this,"metas",new Hw(()=>this._createMeta())),this.globalMeta=e,this.metas=new Hw(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);dn(r,n),oy(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Yie(this.globalMeta.getMetaConstructor(),ooe).prototype}}function fO(t,e,n){return(e=aoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aoe(t){var e=loe(t,"string");return typeof e=="symbol"?e:e+""}function loe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uoe{constructor(e){fO(this,"columnMeta",void 0),fO(this,"metas",new Hw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);dn(i,r),oy(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Bp(()=>Vp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Hw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class hL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Xie(e),this.tableMeta=new eoe(this.globalMeta),this.columnMeta=new soe(this.globalMeta),this.cellMeta=new uoe(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}yt(hL,Bn);function gO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=er(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ft(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Ac(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let w,C=0,R=0;for(C=0,R=d.startRows;C<R;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)w=tr(g),t.push(w);else if(i.dataType==="array")w=tr(g[0]),t.push(w);else{w=[];for(let y=0,M=d.startCols;y<M;y++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&be(i.rootElement,[_k(-1),Vv(i.countCols()+(i.view?i.countRowHeaders():0))])}function mO(t,e,n){return(e=coe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function coe(t){var e=hoe(t,"string");return typeof e=="symbol"?e:e+""}function hoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class doe{constructor(e){var n=this;mO(this,"metaManager",void 0),mO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),oe.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=cn(e,"type")?e.type:null;let c=ft(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function foe(t,e,n){goe(t,e),e.set(t,n)}function goe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JC(t,e,n){return(e=moe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function moe(t){var e=poe(t,"string");return typeof e=="symbol"?e:e+""}function poe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function woe(t,e){return t.get(voe(t,e))}function voe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pO=new WeakMap;class yoe{constructor(e){JC(this,"metaManager",void 0),JC(this,"usageTracker",new Set),JC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),foe(this,pO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,woe(pO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const dL="gridDefault",Qa="editorManager.handlingEditor",Coe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},boe="hooksRefRegisterer",fL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){P(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ke(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ns(fL,"MIXIN_NAME",boe,{writable:!1,enumerable:!1});function Li(t,e,n){return(e=Soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Soe(t){var e=Roe(t,"string");return typeof e=="symbol"?e:e+""}function Roe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Eoe="base",en=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class bh{static get EDITOR_TYPE(){return Eoe}constructor(e){Li(this,"hot",void 0),Li(this,"state",en.VIRGIN),Li(this,"_opened",!1),Li(this,"_fullEditMode",!1),Li(this,"_closeCallback",null),Li(this,"TD",null),Li(this,"row",null),Li(this,"col",null),Li(this,"prop",null),Li(this,"originalValue",null),Li(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:en.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==en.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=en.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Pt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===en.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===en.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=en.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=en.FINISHED,this.discardEditor(s)}):(this.state=en.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=en.FINISHED,this.discardEditor()}discardEditor(e){this.state===en.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=en.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=en.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===en.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Vn(n),a=nn(n),l=Vn(this.hot.rootElement),u=nn(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:w}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=w.name,R=["master","inline_start"].includes(C)?d:0,y=["master","top","bottom"].includes(C)?f:0,M=s.top===l.top?0:1;let x=s.top-l.top-M-R,_=0;this.hot.isRtl()?_=o.innerWidth-s.left-a-g-1+y:_=s.left-l.left-1-y,["top","top_inline_start_corner"].includes(C)&&(x+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(_+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const T=this.hot.hasColHeaders(),I=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),V=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(T&&I<=0||I===V)&&(x+=1),Y<=0&&(_+=1);const q=i.rowsRenderCalculator.startPosition,ee=i.columnsRenderCalculator.startPosition,Q=Math.abs(r.inlineStartOverlay.getScrollPosition()),ne=r.topOverlay.getScrollPosition(),pe=Pn(this.hot.rootDocument);let it=n.offsetTop;if(["inline_start","master"].includes(C)&&(it+=q-ne),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:K,wtTable:J}=r.bottomOverlay.clone;it+=K.getWorkspaceHeight()-J.getHeight()-pe}let Ee=n.offsetLeft;this.hot.isRtl()?(Ee>=0?Ee=w.getWidth()-n.offsetLeft:Ee=Math.abs(Ee),Ee+=ee-Q-a):["top","master","bottom"].includes(C)&&(Ee+=ee-Q);const Ae=o.getComputedStyle(this.TD),ut=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",In=parseInt(Ae[ut],10)>0?0:1,ct=parseInt(Ae.borderTopWidth,10)>0?0:1,m=nn(n)+In,v=hn(n)+ct,p=$E(c)?pe:0,A=LE(h)?pe:0,L=this.hot.view.maximumVisibleElementWidth(Ee)-p+In,j=Math.max(this.hot.view.maximumVisibleElementHeight(it)-A+ct,this.hot.view.getDefaultRowHeight());return{top:x,start:_,height:v,maxHeight:j,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}yt(bh,fL);const Toe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===en.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},Moe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},_oe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},xoe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Poe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Ai(e))}};function Ioe(){return[Coe,Toe,Moe,_oe,xoe,Poe]}const Ooe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},Aoe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},Hoe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},Noe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},Doe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},koe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},$oe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Loe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Foe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Voe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Boe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Woe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},joe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},Uoe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function zoe(){return[Ooe,Aoe,Hoe,Noe,Doe,koe,$oe,Loe,Foe,Voe,Boe,Woe,joe,Uoe]}const Yoe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Goe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Koe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},qoe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},Xoe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Joe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},Zoe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},Qoe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},ese={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},tse={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},nse={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},rse={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},ise={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},ose={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},sse={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},ase={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function lse(){return[Yoe,Goe,Koe,qoe,Xoe,Joe,Zoe,Qoe,ese,tse,nse,rse,ise,ose,sse,ase]}const use={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},cse={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},hse={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},dse={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},fse={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},gse=[...Ioe(),...zoe(),...lse(),use,cse,hse,dse,fse];function gL(t){const e={};return gse.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function mse(t){const e=t.getShortcutManager().addContext("editor"),n=gL(t),r={group:Qa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function pse(t){const e=t.getShortcutManager().addContext("grid"),n=gL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:dL};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Qa,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function wse(t){[pse,mse].forEach(e=>e(t))}function vse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=wO(t),i=wO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function wO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&be(n,[Pf("Focus catcher")]),n}function yse(t){const e=Cse(t);let n;const{activate:r,deactivate:i}=vse(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:VR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:BR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:dL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?VR(t):BR(t)),u(),!1;h.preventDefault()},position:"after"}])}function VR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function BR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function Cse(t){return e=>{if(!e)return null;const n=VR(t),r=BR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Sh(t){Yo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function sy(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,w=f<=h,C=g>=d;return{getComputedColumnTarget(R){return i==="mouse"||i==="keyboard"?R.col:u&&c?r.highlight.col:u?a:c?l:R.col},getComputedRowTarget(R){return i==="mouse"||i==="keyboard"?R.row:w&&C?r.highlight.row:w?f:C?g:R.row}}}function bse(t){return e=>{const n=sy(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Sh(t.getCell(r?-1:0,n,!0))})}}function Sse(){return()=>{}}function Rse(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Sh(t.getCell(n,r,!0))})}}function Ese(t){return e=>{const n=sy(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Sh(t.getCell(i,o,!0))})}}function Tse(t){return e=>{const n=sy(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Sh(t.getCell(i,o,!0))})}}function Mse(t){return e=>{const n=sy(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Sh(t.getCell(n,r?-1:0,!0))})}}function _se(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Sh(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function xse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=Rse(t):e.isSelectedByCorner()?s=Sse():e.isSelectedByRowHeader()?s=Mse(t):e.isSelectedByColumnHeader()?s=bse(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=Ese(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=_se(t):e.getSelectedRange().size()>1&&(s=Tse(t)),(o=s)===null||o===void 0||o(i)}}}const vO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),bm=t=>t.map(e=>{const n=e.toLowerCase();return vO.has(n)?vO.get(n):n}).sort().join("+"),Pse=t=>t.split("+"),yO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),ZC=t=>{let{which:e,key:n}=t;if(yO.has(e))return yO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},mL=Symbol("shortcut-context");function pL(t){return De(t)&&t.__kindOf===mL}const Ise=t=>{const e=qv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:w,position:C,forwardToContext:R}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if($t(c))throw new Error("You need to define the shortcut's group.");if(ft(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(mt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const y={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(w)&&(y.relativeToGroup=w,y.position=C),pL(R)&&(y.forwardToContext=R),l.forEach(M=>{const x=bm(M);if(e.hasItem(x)){const T=e.getItem(x);let I=T.findIndex(Y=>Y.group===w);I!==-1?C==="before"?I-=1:I+=1:I=T.length,T.splice(I,0,y)}else e.addItem(x,[y])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ke(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=bm(l);e.removeItem(u)};return{__kindOf:mL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=bm(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=bm(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(Pse(h)):(d.length=0,d.push(...f))})}}};function Ose(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Ase=["meta","alt","shift","control"],nd=Ose(),rd=[];let Sm=0;function Hse(t,e,n,r,i){const o=f=>Ase.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),g&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Ea(f))return;const w=ZC(f);let C=[];o(w)||(C=s(f));const R=[w].concat(C);!i(f,R)&&(_w()&&C.includes("meta")||!_w()&&C.includes("control"))&&i(f,[w].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=ZC(f);o(g)&&nd.press(g)}},u=f=>{if(typeof f.key=="string"){const g=ZC(f);o(g)&&nd.release(g)}},c=()=>{nd.releaseAll()};return{mount:()=>{let f=t;for(Sm+=1;f;)Sm===1&&(f.document.documentElement.addEventListener("keydown",l),rd.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),rd.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=hu(f)},unmount:()=>{let f=t;for(Sm-=1;f;){if(Sm===0){for(let g=0;g<rd.length;g++){const{event:w,listener:C}=rd[g];f.document.documentElement.removeEventListener(w,C)}rd.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=hu(f)}},isPressed:f=>nd.isPressed(f),releasePressedKeys:()=>nd.releaseAll()}}const Nse=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=qv({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const w=Ise(g);return o.addItem(g,w),w},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(mt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const R=pL(C)?C:u(C);let y=!1;if(!R.hasShortcut(w))return y;const M=R.getShortcuts(w);for(let x=0;x<M.length;x++){const{callback:_,runOnlyIf:T,preventDefault:I,stopPropagation:Y,captureCtrl:U,forwardToContext:V}=M[x];if(T(g)===!0){if(h=U,y=_(g,w)===!1,h=!1,I&&g.preventDefault(),Y&&(Ai(g),g.stopPropagation()),y)break;V&&d(g,w,V)}}return y},f=Hse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function CO(t){const{classNames:e}=Ak(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let QC=null;const eb=new Map;function wL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Mi(o);let a,l,u,c,h,d,f=!0;Qne(i)&&Zne(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",w=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=hie(e.language);const C=Object.fromEntries(Object.entries(e).filter(m=>{let[v]=m;return!(oe.getSingleton().isRegistered(v)||oe.getSingleton().isDeprecated(v))})),R=new hL(o,C,[doe,yoe]),y=R.getTableMeta(),M=R.getGlobalMeta(),x=qv();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),Fp(this)&&(Rk(e.licenseKey,t),X(t,"ht-wrapper")),this.guid=`ht_${_E()}`,eb.set(this.guid,this),this.columnIndexMapper=new $R,this.rowIndexMapper=new $R,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new bre(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const _=m=>{const{row:v,col:p}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getRenderableFromVisualIndex(v):v,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},T=m=>{const{row:v,col:p}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getVisualFromRenderableIndex(v):v,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},I=(m,v)=>{const p=v>m?1:-1,A=Math.min(m,v),L=Math.max(m,v),j=o.rowIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<A?null:j>=0?o.rowIndexMapper.getRenderableFromVisualIndex(j):j},Y=(m,v)=>{const p=v>m?1:-1,A=Math.min(m,v),L=Math.max(m,v),j=o.columnIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<A?null:j>=0?o.columnIndexMapper.getRenderableFromVisualIndex(j):j};let U=new lL(y,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,v)=>o._createCellCoords(m,v),createCellRange:(m,v,p)=>o._createCellRange(m,v,p),visualToRenderableCoords:_,renderableToVisualCoords:T,findFirstNonHiddenRenderableRow:I,findFirstNonHiddenRenderableColumn:Y,isDisabledCellSelection:(m,v)=>m<0||v<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,v).disableVisualSelection});this.selection=U;const V=m=>{let{hiddenIndexesChanged:v}=m;this.forceFullRender=!0,v&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("afterSetRangeEnd",(m,v)=>{const p=kr(!1),A=this.selection.getSelectedRange(),{from:L,to:j}=A.current(),K=A.size()-1;this.runHooks("afterSelection",L.row,L.col,j.row,j.col,p,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),j.row,o.colToProp(j.col),p,K),v&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m);const J=U.isSelectedByRowHeader(),b=U.isSelectedByColumnHeader();J&&b?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(we(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):b?(we(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),U.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const v=kr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,v),(!v.isTouched()||v.isTouched()&&!v.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const v=m.length-1,{from:p,to:A}=m[v];this.runHooks("afterSelectionEnd",p.row,p.col,A.row,A.col,v),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),A.row,o.colToProp(A.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const v=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=v)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...v)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...v)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...v)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSelectColumns",...v)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterSelectColumns",...v)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSelectRows",...v)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterSelectRows",...v)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("modifyTransformStart",...v)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...v)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("modifyTransformFocus",...v)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterModifyTransformFocus",...v)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("modifyTransformEnd",...v)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...v)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeRowWrap",...v)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeColumnWrap",...v)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,v){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const j=K=>{if(K.length===0)return[];const J=[...K];return J.sort((E,S)=>{let[$]=E,[O]=S;return $===O?0:$>O?1:-1}),En(J,(E,S)=>{let[$,O]=S;const N=E[E.length-1],[W,H]=N,D=W+H;if($<=D){const B=Math.max(O-(D-$),0);N[1]+=B}else E.push([$,O]);return E},[J[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(y.maxRows===K)return;const J=m==="insert_row_below"?"below":"above";v=v??(J==="below"?K:0);const{delta:b,startPhysicalIndex:E}=a.createRow(v,p,{source:A,mode:J});U.shiftRows(o.toVisualRow(E),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";v=v??(S==="end"?o.countSourceCols():0);const{delta:$,startPhysicalIndex:O}=a.createCol(v,p,{source:A,mode:S});if($){if(Array.isArray(y.colHeaders)){const H=[o.toVisualColumn(O),0];H.length+=$,Array.prototype.splice.apply(y.colHeaders,H)}U.shiftColumns(o.toVisualColumn(O),$)}break;case"remove_row":const N=H=>{let D=0;P(H,B=>{let[F,G]=B;const ae=qt(F)?o.countRows()-1:Math.max(F-D,0);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeRow(F,G,A))return;if(U.isSelected()){const{row:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+G-1&&c.closeEditor(!0)}const _e=o.countRows(),Fe=y.fixedRowsTop;Fe>=ae+1&&(y.fixedRowsTop-=Math.min(G,Fe-ae));const Ye=y.fixedRowsBottom;Ye&&ae>=_e-Ye&&(y.fixedRowsBottom-=Math.min(G,Ye)),_e===0?U.deselect():A==="ContextMenu.removeRow"?U.refresh():U.shiftRows(F,-G),D+=G})};Array.isArray(v)?N(j(v)):N([[v,p]]);break;case"remove_col":const W=H=>{let D=0;P(H,B=>{let[F,G]=B;const ae=qt(F)?o.countCols()-1:Math.max(F-D,0);let ce=o.toPhysicalColumn(ae);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeCol(F,G,A))return;if(U.isSelected()){const{col:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+G-1&&c.closeEditor(!0)}o.countCols()===0?U.deselect():A==="ContextMenu.removeColumn"?U.refresh():U.shiftColumns(F,-G);const Ye=y.fixedColumnsStart;Ye>=ae+1&&(y.fixedColumnsStart-=Math.min(G,Ye-ae)),Array.isArray(y.colHeaders)&&(typeof ce>"u"&&(ce=-1),y.colHeaders.splice(ce,G)),D+=G})};Array.isArray(v)?W(j(v)):W([[v,p]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=y.minRows,v=y.minSpareRows,p=y.minCols,A=y.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(v){const L=o.countEmptyRows(!0);if(L<v){const j=v-L,K=Math.min(j,y.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(p||A)&&(L=o.countEmptyCols(!0));let j=o.countCols();if(p&&!y.columns&&j<p){const K=p-j;L+=K,a.createCol(j,K,{source:"auto"})}if(A&&!y.columns&&o.dataType==="array"&&L<A){j=o.countCols();const K=A-L,J=Math.min(K,y.maxCols-j);a.createCol(j,J,{source:"auto"})}}},populateFromArray(m,v,p,A,L){let j,K,J,b;const E=[],S={},$=[],O=m.row,N=m.col;if(K=v.length,K===0)return!1;let W=0,H=0;switch(De(p)&&(W=p.col-N+1,H=p.row-O+1),L){case"shift_down":const D=Gd(v),B=D.length,F=Math.max(B,W),G=o.getData().slice(O),ae=Gd(G).slice(N,N+F);for(J=0;J<F;J+=1)if(J<B){for(j=0,K=D[J].length;j<H-K;j+=1)D[J].push(D[J][j%K]);J<ae.length?$.push(D[J].concat(ae[J])):$.push(D[J].concat(new Array(G.length).fill(null)))}else $.push(D[J%B].concat(ae[J]));o.populateFromArray(O,N,Gd($));break;case"shift_right":const ce=v.length,_e=Math.max(ce,H),Fe=o.getData().slice(O).map(At=>At.slice(N));for(j=0;j<_e;j+=1)if(j<ce){for(J=0,b=v[j].length;J<W-b;J+=1)v[j].push(v[j][J%b]);if(j<Fe.length)for(let At=0;At<Fe[j].length;At+=1)v[j].push(Fe[j][At]);else v[j].push(...new Array(Fe[0].length).fill(null))}else v.push(v[j%K].slice(0,_e).concat(Fe[j]));o.populateFromArray(O,N,v);break;case"overwrite":default:S.row=m.row,S.col=m.col;let Ye=0,Me=0,Be=!0,Ot;const Ni=function(pn){let Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ht=v[pn%v.length];return Tt!==null?Ht[Tt%Ht.length]:Ht},is=v.length,ii=p?p.row-m.row+1:0;for(p?K=ii:K=Math.max(is,ii),j=0;j<K&&!(p&&S.row>p.row&&ii>is||!y.allowInsertRow&&S.row>o.countRows()-1||S.row>=y.maxRows);j++){const At=j-Ye,pn=Ni(At).length,Tt=p?p.col-m.col+1:0;if(p?b=Tt:b=Math.max(pn,Tt),S.col=m.col,Ot=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&Ot.skipRowOnPaste){Ye+=1,S.row+=1,K+=1;continue}for(Me=0,J=0;J<b&&!(p&&S.col>p.col&&Tt>pn||!y.allowInsertColumn&&S.col>o.countCols()-1||S.col>=y.maxCols);J++){if(Ot=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&Ot.skipColumnOnPaste){Me+=1,S.col+=1,b+=1;continue}if(Ot.readOnly&&A!=="UndoRedo.undo"){S.col+=1;continue}const Ht=J-Me;let We=Ni(At,Ht),oi=o.getDataAtCell(S.row,S.col);if(We!==null&&typeof We=="object")if(Array.isArray(We)&&oi===null&&(oi=[]),oi===null||typeof oi!="object")Be=!1;else{const el=eh(Array.isArray(oi)?oi:oi[0]||oi),tl=eh(Array.isArray(We)?We:We[0]||We);zv(el,tl)||Array.isArray(el)&&Array.isArray(tl)?We=tr(We):Be=!1}else oi!==null&&typeof oi=="object"&&(Be=!1);Be&&E.push([S.row,S.col,We]),Be=!0,S.col+=1}S.row+=1}o.setDataAtCell(E,null,null,A||"populateFromArray");break}}};function q(m){const v=X$(m);KM(v)?(o.runHooks("beforeLanguageChange",v),M.language=v,o.runHooks("afterLanguageChange",v)):J$(m)}function ee(m,v){const p=m==="className"?o.rootElement:o.table;if(f)X(p,v);else{let A=[],L=[];M[m]&&(A=Array.isArray(M[m])?M[m]:vR(M[m])),v&&(L=Array.isArray(v)?v:vR(v));const j=wR(A,L),K=wR(L,A);j.length&&we(p,j),K.length&&X(p,K)}M[m]=v}this.init=function(){l.setData(y.data),o.runHooks("beforeInit"),(Uo()||YE())&&X(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new rre(this);const m=y.themeName||CO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=_R.getInstance(o,y,U),d=xse(o),h=new MZ(o),Fp(this)&&yse(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&Bk(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function Q(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function ne(m){const v=m.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):m}function pe(m,v,p){if(!m.length){p();return}const A=o.getActiveEditor(),L=new Q;let j=!0;L.onQueueEmpty=()=>{A&&j&&A.cancelChanges(),p()};for(let K=m.length-1;K>=0;K--){const[J,b]=m[K],E=a.propToCol(b);let S;Number.isInteger(E)?S=o.getCellMeta(J,E):S={...Object.getPrototypeOf(y),...y},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function($,O){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&O.allowInvalid===!1&&(j=!1,m.splice($,1),O.valid=!0),L.removeValidatorFormQueue()}}(K,S),v))}L.checkIfQueueIsEmpty()}function it(m,v){for(let A=m.length-1;A>=0;A--){let L=!1;if(m[A]===null){m.splice(A,1);continue}if(!((m[A][2]===null||m[A][2]===void 0)&&(m[A][3]===null||m[A][3]===void 0))){if(y.allowInsertRow)for(;m[A][0]>o.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}if(o.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(m[A][1])>o.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}L||a.set(m[A][0],m[A][1],m[A][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,v),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,v||"edit");const A=o.getActiveEditor();A&&le(A.refreshValue)&&A.refreshValue()}else o.render()}this._createCellCoords=function(m,v){return o.view._wt.createCellCoords(m,v)},this._createCellRange=function(m,v,p){return o.view._wt.createCellRange(m,v,p)},this.validateCell=function(m,v,p,A){let L=o.getCellValidator(v);function j(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||v.hidden===!0){p(K);return}const b=v.visualCol,E=v.visualRow,S=o.getCell(E,b,!0);if(S&&S.nodeName!=="TH"){const $=o.rowIndexMapper.getRenderableFromVisualIndex(E),O=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",$,O,S)}p(K)}Sk(L)&&(L=function(K){return function(J,b){b(K.test(J))}}(L)),ft(L)?(m=o.runHooks("beforeValidate",m,v.visualRow,v.prop,A),o._registerImmediate(()=>{L.call(v,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,v.visualRow,v.prop,A),v.valid=K,j(K),o.runHooks("postAfterValidate",K,m,v.visualRow,v.prop,A))})})):o._registerImmediate(()=>{v.valid=!0,j(v.valid,!1)})};function Ee(m,v,p){return Array.isArray(m)?m:[[m,v,p]]}function Ae(m,v){const p=o.runHooks("beforeChange",m,v||"edit"),A=m.filter(j=>j!==null);if(p===!1||A.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let j=A.length-1;j>=0;j--){const[K,J,,b]=A[j],E=a.propToCol(J);let S;Number.isInteger(E)?S=o.getCellMeta(K,E):S={...Object.getPrototypeOf(y),...y};const{type:$,checkedTemplate:O,uncheckedTemplate:N}=S;if($==="numeric"&&typeof b=="string"&&w$(b)&&(A[j][3]=ne(b)),$==="checkbox"){const W=Pt(b),H=W===Pt(O),D=W===Pt(N);(H||D)&&(A[j][3]=H?O:N)}}return A}this.setDataAtCell=function(m,v,p,A){const L=Ee(m,v,p),j=[];let K=A,J,b,E;for(J=0,b=L.length;J<b;J++){if(typeof L[J]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[J][1]>=this.countCols()?E=L[J][1]:E=a.colToProp(L[J][1]),j.push([L[J][0],E,l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]])}!K&&typeof m=="object"&&(K=v);const S=Ae(j,K);o.runHooks("afterSetDataAtCell",S,K),pe(S,K,()=>{it(S,K)})},this.setDataAtRowProp=function(m,v,p,A){const L=Ee(m,v,p),j=[];let K=A,J,b;for(J=0,b=L.length;J<b;J++)j.push([L[J][0],L[J][1],l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]]);!K&&typeof m=="object"&&(K=v);const E=Ae(j,A);o.runHooks("afterSetDataAtRowProp",E,K),pe(E,K,()=>{it(E,K)})},this.listen=function(){o&&!o.isListening()&&(eb.forEach(m=>{o!==m&&m.unlisten()}),QC=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(QC=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return QC===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),v&&U.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,v,p,A,L,j,K){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const J=typeof A=="number"?o._createCellCoords(A,L):null;return u.populateFromArray(o._createCellCoords(m,v),p,J,j,K)},this.spliceCol=function(m,v,p){for(var A=arguments.length,L=new Array(A>3?A-3:0),j=3;j<A;j++)L[j-3]=arguments[j];return a.spliceCol(m,v,p,...L)},this.spliceRow=function(m,v,p){for(var A=arguments.length,L=new Array(A>3?A-3:0),j=3;j<A;j++)L[j-3]=arguments[j];return a.spliceRow(m,v,p,...L)},this.getSelected=function(){if(U.isSelected())return ze(U.getSelectedRange(),m=>{let{from:v,to:p}=m;return[v.row,v.col,p.row,p.col]})},this.getSelectedLast=function(){const m=this.getSelected();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.emptySelectedCells=function(m){if(!U.isSelected()||this.countRows()===0||this.countCols()===0)return;const v=[];P(U.getSelectedRange(),p=>{if(p.isSingleHeader())return;const A=p.getTopStartCorner(),L=p.getBottomEndCorner();fe(A.row,L.row,j=>{fe(A.col,L.col,K=>{this.getCellMeta(j,K).readOnly||v.push([j,K,null])})})}),v.length>0&&this.setDataAtCell(v,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const v=m();return this.resumeRender(),v},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(v,0),(!this.isExecutionSuspended()&&v===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=m();return this.resumeExecution(v),p},this.batch=function(m){this.suspendRender(),this.suspendExecution();const v=m();return this.resumeExecution(),this.resumeRender(),v},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:v,height:p}=m.getLastSize(),{width:A,height:L}=o.rootElement.getBoundingClientRect(),j=A!==v||L!==p;o.runHooks("beforeRefreshDimensions",{width:v,height:p},{width:A,height:L},j)!==!1&&((j||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(A,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:v,height:p},{width:A,height:L},j))},this.updateData=function(m,v){gO(m,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),U.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:v,metaManager:R,firstRun:f})},this.loadData=function(m,v){gO(m,p=>{a=p},()=>{R.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),U.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:v,metaManager:R,firstRun:f})},this.getInitialColumnCount=function(){const m=y.columns;let v=0;if(Array.isArray(m))v=m.length;else if(ft(m))if(o.dataType==="array"){const p=this.countSourceCols();for(let A=0;A<p;A+=1)m(A)&&(v+=1)}else(o.dataType==="object"||o.dataType==="function")&&(v=a.colToPropCache.length);else if(le(y.dataSchema)){const p=a.getSchema();v=Array.isArray(p)?p.length:Yv(p)}else v=this.countSourceCols();return v},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,v,p,A){return $t(m)?a.getAll():a.getRange(o._createCellCoords(m,v),o._createCellCoords(p,A),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,v,p,A){return a.getCopyableText(o._createCellCoords(m,v),o._createCellCoords(p,A))},this.getCopyableData=function(m,v){return a.getCopyable(m,a.colToProp(v))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(f?o.loadData:o.updateData).bind(this);let A=!1,L,j;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&q(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")ee("className",m.className);else if(L==="tableClassName"&&o.table)ee("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(oe.getSingleton().isRegistered(L)||oe.getSingleton().isDeprecated(L)){const S=m[L];ft(S)?(oe.getSingleton().addAsFixed(L,S,o),y[L]=S):Array.isArray(S)&&(oe.getSingleton().add(L,S,o),y[L]=S)}else!v&&cn(m,L)&&(M[L]=m[L]);m.data===void 0&&y.data===void 0?p(null,"updateSettings"):m.data!==void 0?p(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),J=y.columns;if(J&&ft(J)&&(A=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&R.clearCache(),K>0)for(L=0,j=0;L<K;L++){if(J){const S=A?J(L):J[j];S&&R.updateColumnMeta(j,S)}j+=1}le(m.cell)&&ke(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let E=m.height;if(ft(E)&&(E=E()),v&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),E===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else E!==void 0&&(o.rootElement.style.height=isNaN(E)?`${E}`:`${E}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;ft(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!v){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),$=cn(m,"themeName");S&&$&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const O=$&&m.themeName||CO(o.rootElement);o.useTheme(O),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!v&&o.view&&(b===""||E===""||E===void 0)&&b!==E&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(y.getValue){if(ft(y.getValue))return y.getValue.call(o);if(m)return o.getData()[m[0][0]][y.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,v,p,A,L){u.alter(m,v,p,A,L)},this.getCell=function(m,v){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=v,L=m;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||A===null||L===void 0||A===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,A),p)},this.getCoords=function(m){const v=this.view._wt.wtTable.getCoords(m);if(v===null)return null;const{row:p,col:A}=v;let L=p,j=A;return p>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(p)),A>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(A)),o._createCellCoords(L,j)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,v){return a.get(m,a.colToProp(v))},this.getDataAtRowProp=function(m,v){return a.get(m,v)},this.getDataAtCol=function(m){const v=[],p=a.getRange(o._createCellCoords(0,m),o._createCellCoords(y.data.length-1,m),a.DESTINATION_RENDERER);for(let A=0;A<p.length;A+=1)for(let L=0;L<p[A].length;L+=1)v.push(p[A][L]);return v},this.getDataAtProp=function(m){const v=[],p=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(y.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let A=0;A<p.length;A+=1)for(let L=0;L<p[A].length;L+=1)v.push(p[A][L]);return v},this.getSourceData=function(m,v,p,A){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(p,A)),L},this.getSourceDataArray=function(m,v,p,A){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(p,A),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,v,p,A){const L=Ee(m,v,p),j=this.hasHook("afterSetSourceDataAtCell"),K=[];j&&P(L,b=>{let[E,S,$]=b;K.push([E,S,l.getAtCell(E,S),$])}),P(L,b=>{let[E,S,$]=b;l.setAtCell(E,S,$)}),j&&this.runHooks("afterSetSourceDataAtCell",K,A),this.render();const J=o.getActiveEditor();J&&le(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,v){return l.getAtCell(m,v)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,v,p,A){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,v,p,A],[j,K]=L;let[,,J,b]=L,E=null,S=null;J===void 0&&(J=j),b===void 0&&(b=K);let $="mixed";return fe(Math.max(Math.min(j,J),0),Math.max(j,J),O=>{let N=!0;return fe(Math.max(Math.min(K,b),0),Math.max(K,b),W=>(S=this.getCellMeta(O,W).type,E?N=E===S:E=S,N)),$=N?S:"mixed",N}),$},this.removeCellMeta=function(m,v,p){const[A,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(v)];let j=R.getCellMetaKeyValue(A,L,p);o.runHooks("beforeRemoveCellMeta",m,v,p,j)!==!1&&(R.removeCellMeta(A,L,p),o.runHooks("afterRemoveCellMeta",m,v,p,j)),j=null},this.spliceCellsMeta=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,A=new Array(p>2?p-2:0),L=2;L<p;L++)A[L-2]=arguments[L];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&R.removeRow(this.toPhysicalRow(m),v),A.length>0&&P(A.reverse(),j=>{R.createRow(this.toPhysicalRow(m)),P(j,(K,J)=>this.setCellMetaObject(m,J,K))}),o.render()},this.setCellMetaObject=function(m,v,p){typeof p=="object"&&ke(p,(A,L)=>{this.setCellMeta(m,v,L,A)})},this.setCellMeta=function(m,v,p,A){if(o.runHooks("beforeSetCellMeta",m,v,p,A)===!1)return;let j=m,K=v;m<this.countRows()&&(j=this.toPhysicalRow(m)),v<this.countCols()&&(K=this.toPhysicalColumn(v)),R.setCellMeta(j,K,p,A),o.runHooks("afterSetCellMeta",m,v,p,A)},this.getCellsMeta=function(){return R.getCellsMeta()},this.getCellMeta=function(m,v){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},A=this.toPhysicalRow(m),L=this.toPhysicalColumn(v);return A===null&&(A=m),L===null&&(L=v),R.getCellMeta(A,L,{visualRow:m,visualColumn:v,...p})},this.getColumnMeta=function(m){return R.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return R.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||y.columns)},this.getCellRenderer=function(m,v){const p=typeof m=="number"?o.getCellMeta(m,v).renderer:m.renderer;return typeof p=="string"?Iw(p):$t(p)?Iw("text"):p},this.getCellEditor=function(m,v){const p=typeof m=="number"?o.getCellMeta(m,v).editor:m.editor;return typeof p=="string"?Pw(p):$t(p)?Pw("text"):p},this.getCellValidator=function(m,v){const p=typeof m=="number"?o.getCellMeta(m,v).validator:m.validator;return typeof p=="string"?tT(p):p},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,v){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,m)},this.validateColumns=function(m,v){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,m)},this._validateCells=function(m,v,p){const A=new Q;m&&(A.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(v!==void 0&&v.indexOf(L)===-1){L-=1;continue}let j=o.countCols()-1;for(;j>=0;){if(p!==void 0&&p.indexOf(j)===-1){j-=1;continue}A.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,j),o.getCellMeta(L,j),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),j-=1}L-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let v=y.rowHeaders,p=m;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(v=[],fe(o.countRows()-1,A=>{v.push(o.getRowHeader(A))})):Array.isArray(v)&&v[p]!==void 0?v=v[p]:ft(v)?v=v(p):v&&typeof v!="string"&&typeof v!="number"&&(v=p+1),v},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let m=0,v=o.countCols();m<v;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",m);if(p===void 0){const J=[],b=o.countCols();for(let E=0;E<b;E++)J.push(o.getColHeader(E));return J}let A=y.colHeaders;const L=function(J){const b=[],E=o.countCols();let S=0;for(;S<E;S++)ft(y.columns)&&y.columns(S)&&b.push(S);return b[J]},j=o.toPhysicalColumn(p),K=L(j);return y.colHeaders===!1?A=null:y.columns&&ft(y.columns)&&y.columns(K)&&y.columns(K).title?A=y.columns(K).title:y.columns&&y.columns[j]&&y.columns[j].title?A=y.columns[j].title:Array.isArray(y.colHeaders)&&y.colHeaders[j]!==void 0?A=y.colHeaders[j]:ft(y.colHeaders)?A=y.colHeaders(j):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(A=Zv(p)),A=o.runHooks("modifyColumnHeaderValue",A,m,v),A},this._getColWidthFromSettings=function(m){let v;if(m>=0&&(v=o.getCellMeta(0,m).width),(v===void 0||v===y.width)&&(v=y.colWidths),v!=null){switch(typeof v){case"object":v=v[m];break;case"function":v=v(m);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(m,v){let p=o._getColWidthFromSettings(m);return p=o.runHooks("modifyColWidth",p,m,v),p===void 0&&(p=th),p},this._getRowHeightFromSettings=function(m){const v=this.view.getDefaultRowHeight();let p=y.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<v?v:p},this.getRowHeight=function(m,v){let p=o._getRowHeightFromSettings(m);return p=o.runHooks("modifyRowHeight",p,m,v),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=y.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,v)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return IR(o.countRows()-1,p=>{if(o.isEmptyRow(p))v+=1;else if(m===!0)return!1}),v},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return IR(o.countCols()-1,p=>{if(o.isEmptyCol(p))v+=1;else if(m===!0)return!1}),v},this.isEmptyRow=function(m){return y.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return y.isEmptyCol.call(o,m)},this.selectCell=function(m,v,p,A){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return $t(m)||$t(v)?!1:this.selectCells([[m,v,p,A]],L,j)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;v===!1&&d.suspend();const A=U.selectCells(m);return A&&p&&o.listen(),d.resume(),A},this.selectColumns=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectColumns(m,v,p)},this.selectRows=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectRows(m,v,p)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),U.selectAll(m,v,p)};const ut=(m,v)=>m.getNearestNotHiddenIndex(v,1,!0);this.scrollViewportTo=function(m,v){if(typeof m=="number"){var p;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:A,col:L,considerHiddenIndexes:j}=m??{};let K=A,J=L;if(ft(v)&&this.addHookOnce("afterScroll",v),j===void 0||j){const $=Number.isInteger(A)&&A>=0,O=Number.isInteger(L)&&L>=0,N=$?ut(this.rowIndexMapper,A):void 0,W=O?ut(this.columnIndexMapper,L):void 0;if(N===null||W===null)return!1;K=$?o.rowIndexMapper.getRenderableFromVisualIndex(N):A,J=O?o.columnIndexMapper.getRenderableFromVisualIndex(W):L}const b=Number.isInteger(K),E=Number.isInteger(J);let S=!1;return b&&K>=0&&E&&J>=0?S=o.view.scrollViewport(o._createCellCoords(K,J),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(E&&J<0||!E)?S=o.view.scrollViewportVertically(K,m.verticalSnap):E&&J>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(J,m.horizontalSnap)),ft(v)&&(S?this.view.render():(this.removeHook("afterScroll",v),this._registerMicrotask(()=>v()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;ft(m)&&this.addHookOnce("afterScroll",m);const{highlight:v}=this.getSelectedRangeLast(),p=this.scrollViewportTo(v.toObject());return p?this.view.render():ft(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),p},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),R.clearCache(),eb.delete(this.guid),Fp(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}Xo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),x.getItems().forEach(m=>{let[,v]=m;v.destroy()}),x.clear(),o.runHooks("afterDestroy")},!0),oe.getSingleton().destroy(o),ke(o,(m,v,p)=>{ft(m)?p[v]=In(v):v!=="guid"&&(p[v]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,U=null,c=null,o=null};function In(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return x.getItem(er(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:x.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,v,p){oe.getSingleton().add(m,v,o,p)},this.hasHook=function(m){return oe.getSingleton().has(m,o)||oe.getSingleton().has(m)},this.addHookOnce=function(m,v,p){oe.getSingleton().once(m,v,o,p)},this.removeHook=function(m,v){oe.getSingleton().remove(m,v,o)},this.runHooks=function(m,v,p,A,L,j,K){return oe.getSingleton().run(o,m,v,p,A,L,j,K)},this.getTranslatedPhrase=function(m,v){return rL(y.language,m,v)},this.toHTML=()=>xR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",xR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=m;typeof p=="function"&&(p=setTimeout(p,v)),this.timeouts.push(p)},this._clearTimeouts=function(){P(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){P(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const ct=Nse({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&ct.releasePressedKeys()}),this.getShortcutManager=function(){return ct},this.getFocusManager=function(){return h},eT().forEach(m=>{const v=vg(m);x.addItem(m,new v(this))}),wse(o),ct.setActiveContextName("grid"),oe.getSingleton().run(o,"construct")}function bO(t,e,n){t.addEventListener(e,n,!1)}function SO(t,e,n){t.removeEventListener(e,n,!1)}function Rm(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function vL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Rm(s).fontSize,o.style.fontFamily=Rm(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Rm(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=Rm(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),w=o.clientWidth+f+g+1;r.removeChild(o);const C=s.style;C.height=`${n.minHeight}px`,n.minWidth>w?C.width=`${n.minWidth}px`:w>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${w}px`;const R=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>R?C.height=`${n.minHeight}px`:n.maxHeight<R?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${R}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(bO(s,"input",a),bO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){SO(s,"input",a),SO(s,"keydown",l)}}}function RO(t,e){const n=kE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}fg(e,i)}function fl(t,e,n){return(e=Dse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dse(t){var e=kse(t,"string");return typeof e=="symbol"?e:e+""}function kse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $se="ht_editor_visible",Em="ht_editor_hidden",EO="textEditor",Lse="text";class Hu extends bh{static get EDITOR_TYPE(){return Lse}constructor(e){super(e),fl(this,"eventManager",new Mi(this)),fl(this,"autoResize",vL(this.hot.rootDocument)),fl(this,"TEXTAREA",void 0),fl(this,"textareaStyle",void 0),fl(this,"TEXTAREA_PARENT",void 0),fl(this,"textareaParentStyle",void 0),fl(this,"layerClass",void 0),this.eventManager=new Mi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Xd(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==en.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===en.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),fg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),be(this.TEXTAREA,[["data-hot-input",""],xu(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&we(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Em),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){r$()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",we(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Em)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(ve(i,"handsontableEditor"))return n=!0,!1}),ve(this.TEXTAREA_PARENT,Em)&&we(this.TEXTAREA_PARENT,Em),n?(this.layerClass=$se,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==en.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){zE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===en.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===en.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:EO},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;RO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;RO(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(EO)}}const Fse="base";function Rg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(nI())):a&&c.push(nI()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(rI())):(u.push(s.invalidCellClassName),a&&c.push(rI()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),we(e,u),X(e,l),Iu(e,c),be(e,h)}Rg.RENDERER_TYPE=Fse;const Vse="text";function Qs(t,e,n,r,i,o,s){Rg.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Pt(a),s.trimWhitespace&&(a=a.trim()),Ya(e,a)}Qs.RENDERER_TYPE=Vse;const Bse="text",yL={CELL_TYPE:Bse,editor:Hu,renderer:Qs};di(yL);Te.editors={BaseEditor:bh};function Te(t,e){const n=new wL(t,e||{},vT);return n.init(),n}Te.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new wL(t,e,vT)};Te.DefaultSettings=cL();Te.hooks=oe.getSingleton();Te.CellCoords=fu;Te.CellRange=yg;Te.packageName="handsontable";Te.buildDate="24/04/2025 10:59:00";Te.version="15.3.0";Te.languages={dictionaryKeys:iie,getLanguageDictionary:nL,getLanguagesDictionaries:uie,registerLanguageDictionary:tL,getTranslatedPhrase:rL};const TO="handsontableEditor",Wse="handsontable";class JM extends Hu{static get EDITOR_TYPE(){return Wse}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),fg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&dn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:TO,relativeToGroup:Qa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ai(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TO)}}function jse(t,e){CL(t,e),e.add(t)}function MO(t,e,n){CL(t,e),e.set(t,n)}function CL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tm(t,e,n){return(e=Use(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Use(t){var e=zse(t,"string");return typeof e=="symbol"?e:e+""}function zse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tb(t,e){return t.get(WR(t,e))}function WR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yse="autocomplete";var nb=new WeakMap,_O=new WeakMap,rb=new WeakSet;class ZM extends JM{constructor(){super(...arguments),jse(this,rb),Tm(this,"query",null),Tm(this,"strippedChoices",[]),Tm(this,"rawChoices",[]),MO(this,nb,this.hot.guid.slice(0,9)),MO(this,_O,mg(()=>{this.focus()},100)),Tm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=CR(Pt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return Yse}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),X(this.htContainer,"autocompleteEditor"),X(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[V8(),D8(),Mk("listbox"),U8()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[Ri("false"),z8(`${tb(nb,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",tb(_O,this)),this.htEditor.updateSettings({colWidths:e?[nn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Qs(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:w,locale:C}=this.cellProperties,R=this.query;let y=Pt(d),M,x;y&&!w&&(M=g===!0?y.indexOf(R):y.toLocaleLowerCase(C).indexOf(R.toLocaleLowerCase(C)),M!==-1&&(x=y.substr(M,R.length),y=y.replace(x,`<strong>${x}</strong>`))),n&&be(l,[k8(),...r?[q8(i)]:[],...r?[X8(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=y},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{be(h,[OE()]),be(this.TEXTAREA,...Y8(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(be(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ds()),be(this.htEditor.rootElement,[Tk(),G8("polite"),K8("text"),["id",`${tb(nb,this)}-listbox-${o}-${s}`]]),be(this.TEXTAREA,...Ri("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[Ri("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=kE(this.TEXTAREA),r=Vk(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Gd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),fg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),WR(rb,this,xO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),WR(rb,this,xO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=ze(e,o=>Pt(o));return ze(r,o=>n?o:CR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(i$(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function xO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+Pn(this.hot.rootDocument)})}const Gse="checkbox";class bL extends bh{static get EDITOR_TYPE(){return Gse}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ve(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ha=()=>window,vi=()=>window.document,jR=(t,e)=>window.setTimeout(t,e),Io=function(t,e,n,r){t.addEventListener(e,n,!!r)},fs=function(t,e,n,r){t.removeEventListener(e,n,!!r)},Kse=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ur=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},ib=function(t,e){Ur(t,e)||(t.className=t.className===""?e:t.className+" "+e)},ob=function(t,e){t.className=Kse((" "+t.className+" ").replace(" "+e+" "," "))},QM=function(t){return/Array/.test(Object.prototype.toString.call(t))},Kr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},qse=function(t){let e=t.getDay();return e===0||e===6},Xse=function(t){return t%4===0&&t%100!==0||t%400===0},PO=function(t,e){return[31,Xse(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Mm=function(t){Kr(t)&&t.setHours(0,0,0,0)},_m=function(t,e){return t.getTime()===e.getTime()},Nw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Kr(e[r])?n&&(t[r]=new Date(e[r].getTime())):QM(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Nw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},IO=function(t,e,n){let r=vi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Nw(r,n),t.dispatchEvent(r)},OO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},yo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},AO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Jse=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},Zse=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},Qse=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():Zse(o,i))+"</td>"},eae=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},tae=function(t){return"<tbody>"+t.join("")+"</tbody>"},nae=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+AO(t,e)+'">'+AO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},rae=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,w=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",QM(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(w=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},iae=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+nae(t)+tae(e)+"</table>"};function UR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Ha().event;let o=i.target||i.srcElement;if(o)if(Ur(o,"is-disabled")||(Ur(o,"pika-button")&&!Ur(o,"is-empty")&&!Ur(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&jR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Ur(o,"pika-prev")?e.prevMonth():Ur(o,"pika-next")&&e.nextMonth()),Ur(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Ha().event;let o=i.target||i.srcElement;o&&(Ur(o,"pika-select-month")?e.gotoMonth(o.value):Ur(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Ha().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Kr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=vi().activeElement;do if(Ur(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=jR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Ha().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Ur(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Io(o,"change",e._onChange)));do if(Ur(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=vi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Io(e.el,"mousedown",e._onMouseDown,!0),Io(e.el,"touchend",e._onMouseDown,!0),Io(e.el,"change",e._onChange),n.keyboardInput&&Io(vi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?vi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Io(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Kr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Io(n.trigger,"click",e._onInputClick),Io(n.trigger,"focus",e._onInputFocus),Io(n.trigger,"blur",e._onInputBlur)):this.show()}UR.prototype={config:function(t){this._o||(this._o=Nw({},yo,!0));let e=Nw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Kr(e.minDate)||(e.minDate=!1),Kr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),QM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||yo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Kr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Kr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",IO(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Kr(t))return;let n=this._o.minDate,r=this._o.maxDate;Kr(n)&&t<n?t=n:Kr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Mm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),IO(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Kr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=OO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=OO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Mm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=yo.minDate,this._o.minYear=yo.minYear,this._o.minMonth=yo.minMonth,this._o.startRange=yo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Mm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=yo.maxDate,this._o.maxYear=yo.maxYear,this._o.maxMonth=yo.maxMonth,this._o.endRange=yo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+rae(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&jR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Ha().innerWidth||vi().documentElement.clientWidth,i=Ha().innerHeight||vi().documentElement.clientHeight,o=vi().body.scrollTop||vi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Ha().pageXOffset,a=l.bottom+Ha().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",ib(this.el,u?"left-aligned":"right-aligned"),ib(this.el,c?"bottom-aligned":"top-aligned"),ob(this.el,u?"right-aligned":"left-aligned"),ob(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=PO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Mm(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=PO(h,u),g=o+s,w=g;for(;w>7;)w-=7;g+=7-w;let C=!1;for(let R=0,y=0;R<g;R++){let M=new Date(t,e,1+(R-s)),x=Kr(this._d)?_m(M,this._d):!1,_=_m(M,i),T=r.events.indexOf(M.toDateString())!==-1,I=R<s||R>=o+s,Y=1+(R-s),U=e,V=t,q=r.startRange&&_m(r.startRange,M),ee=r.endRange&&_m(r.endRange,M),Q=r.startRange&&r.endRange&&r.startRange<M&&M<r.endRange,ne=r.minDate&&M<r.minDate||r.maxDate&&M>r.maxDate||r.disableWeekends&&qse(M)||r.disableDayFn&&r.disableDayFn(M);I&&(R<s?(Y=f+Y,U=u,V=h):(Y=Y-o,U=c,V=d));let pe={day:Y,month:U,year:V,hasEvent:T,isSelected:x,isToday:_,isDisabled:ne,isEmpty:I,isStartRange:q,isEndRange:ee,isInRange:Q,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&x&&(C=!0),l.push(Jse(pe)),++y===7&&(r.showWeekNumber&&l.unshift(Qse(this,R-s,e,t,r.firstWeekOfYearMinDays)),a.push(eae(l,r.isRTL,r.pickWholeWeek,C)),l=[],y=0,C=!1)}return iae(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),ob(this.el,"is-hidden"),this._o.bound&&(Io(vi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&fs(vi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),ib(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),fs(this.el,"mousedown",this._onMouseDown,!0),fs(this.el,"touchend",this._onMouseDown,!0),fs(this.el,"change",this._onChange),t.keyboardInput&&fs(vi(),"keydown",this._onKeyChange),t.field&&(fs(t.field,"change",this._onInputChange),t.bound&&(fs(t.trigger,"click",this._onInputClick),fs(t.trigger,"focus",this._onInputFocus),fs(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function oae(t,e){sae(t,e),e.add(t)}function sae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HO(t,e,n){return(e=aae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aae(t){var e=lae(t,"string");return typeof e=="symbol"?e:e+""}function lae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SL="date",NO="dateEditor",uae="DD/MM/YYYY";var xm=new WeakSet;class RL extends Hu{constructor(){super(...arguments),oae(this,xm),HO(this,"parentDestroyed",!1),HO(this,"$datePicker",null)}static get EDITOR_TYPE(){return SL}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof UR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(we(this.datePicker,/ht-theme-.*/g),X(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),X(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();we(this.datePicker,/ht-theme-.*/g),X(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{ve(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:NO})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(NO),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=sb(xm,this,ab).call(this),r=this.hot.view.isMouseDown(),i=e?GE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new UR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&wg(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:sb(xm,this,ab).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Z(a).format(sb(xm,this,ab).call(this))),this.setValue(a),i&&i(),Uo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==en.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+hn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-nn(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function ab(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:uae}const cae="dropdown";class EL extends ZM{static get EDITOR_TYPE(){return cae}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const hae="numeric";class TL extends Hu{static get EDITOR_TYPE(){return hae}}function dae(t,e,n){return(e=fae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fae(t){var e=gae(t,"string");return typeof e=="symbol"?e:e+""}function gae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mae="password";class ML extends Hu{constructor(){super(...arguments),dae(this,"autoResize",vL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return mae}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Xo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const lb="ht_editor_visible",DO="selectEditor",pae="select";class _L extends bh{static get EDITOR_TYPE(){return pae}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Pu()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),X(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ve(this.selectWrapper,lb)&&we(this.selectWrapper,lb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Xo(this.select),ke(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ou(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==en.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",X(this.selectWrapper,lb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:DO};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(DO)}}const wae="time";class xL extends Hu{static get EDITOR_TYPE(){return wae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function vae(){xr(bh),xr(ZM),xr(bL),xr(RL),xr(EL),xr(JM),xr(TL),xr(ML),xr(_L),xr(Hu),xr(xL)}const yae="html";function e_(t,e,n,r,i,o,s){Rg.apply(this,[t,e,n,r,i,o,s]),Ou(e,o??"",!1)}e_.RENDERER_TYPE=yae;const Cae="autocomplete";function Rh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?e_:Qs,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Pu()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),X(e,"htAutocomplete"),!t.acArrowListener){const h=new Mi(t);t.acArrowListener=function(d){ve(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Rh.RENDERER_TYPE=Cae;const bae="dropdown";function t_(t,e,n,r,i,o,s){Rh.apply(this,[t,e,n,r,i,o,s])}t_.RENDERER_TYPE=bae;const kO=new WeakMap,$O=new WeakMap,Sae="htBadValue",rh="data-row",ih="data-col",Rae="checkboxRenderer",PL="checkbox";oe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===PL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function n_(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Rg.apply(this,[t,e,n,r,i,o,s]),Eae(t);let u=Tae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Xo(e),o===s.checkedTemplate||Pt(o).toLocaleLowerCase(s.locale)===Pt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Pt(o).toLocaleLowerCase(s.locale)===Pt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:qt(o)?X(u,"noValue"):(u.style.display="none",X(u,Sae),h=!0),be(u,[[rh,n],[ih,r]]),l&&be(u,[Pf(u.checked?t.getTranslatedPhrase(YM):t.getTranslatedPhrase(GM)),Pk(u.checked),$8()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const R=t.getDataAtRowProp(n,c.property);w=R!==null?R:""}const C=Mae(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),kO.has(t)||(kO.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),R={group:Rae,relativeToGroup:Qa,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const y=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(y==null?void 0:y.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}}],R)}function f(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),R=[],y=new Map;let M=[],x=0;if(C){for(let _=0;_<C.length;_++){const{row:T,col:I}=C[_].getTopStartCorner(),{row:Y,col:U}=C[_].getBottomEndCorner();for(let V=T;V<=Y;V+=1)for(let q=I;q<=U;q+=1){const ee=t.getCellMeta(V,q);if(ee.hidden)continue;const Q={checkedTemplate:ee.checkedTemplate,uncheckedTemplate:ee.uncheckedTemplate};if(ee.type!=="checkbox"){w===!0&&!ee.readOnly&&(y.has(R.length)?y.set(R.length,[...y.get(R.length),[V,q,null]]):y.set(R.length,[[V,q,null]]));continue}if(ee.readOnly===!0)continue;typeof ee.checkedTemplate>"u"&&(ee.checkedTemplate=!0),typeof ee.uncheckedTemplate>"u"&&(ee.uncheckedTemplate=!1);const ne=t.getDataAtCell(V,q);w===!1?[ee.checkedTemplate,ee.checkedTemplate.toString()].includes(ne)?M.push([V,q,ee.uncheckedTemplate,Q]):[ee.uncheckedTemplate,ee.uncheckedTemplate.toString(),null,void 0].includes(ne)&&M.push([V,q,ee.checkedTemplate,Q]):M.push([V,q,ee.uncheckedTemplate,Q]),x+=1}R.push(x),x=0}M.every(_=>{let[,,T]=_;return T===M[0][2]})?M=M.map(_=>{let[T,I,Y]=_;return[T,I,Y]}):M=M.map(_=>{let[T,I,,Y]=_;return[T,I,Y.checkedTemplate]}),M.length>0&&R.forEach((_,T)=>{let I=M.splice(0,_);y.size&&y.has(T)&&(I=[...I,...y.get(T)]),t.setDataAtCell(I)})}}function g(){const w=t.getSelectedRange();if(w){for(let C=0;C<w.length;C++){const R=w[C].getTopStartCorner(),y=w[C].getBottomEndCorner();for(let M=R.row;M<=y.row;M++)for(let x=R.col;x<=y.col;x++){if(t.getCellMeta(M,x).readOnly)continue;const T=t.getCell(M,x);if(Yo(T)&&T.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}n_.RENDERER_TYPE=PL;function Eae(t){let e=$O.get(t);if(!e){const{rootElement:n}=t;e=new Mi(t),e.addEventListener(n,"click",r=>xae(r,t)),e.addEventListener(n,"mouseup",r=>_ae(r,t)),e.addEventListener(n,"change",r=>Pae(r,t)),$O.set(t,e)}return e}function Tae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Mae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function _ae(t,e){const{target:n}=t;r_(n)&&(!n.hasAttribute(rh)||!n.hasAttribute(ih)||setTimeout(e.listen,10))}function xae(t,e){const{target:n}=t;if(!r_(n)||!n.hasAttribute(rh)||!n.hasAttribute(ih))return;const r=parseInt(n.getAttribute(rh),10),i=parseInt(n.getAttribute(ih),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function Pae(t,e){const{target:n}=t;if(!r_(n)||!n.hasAttribute(rh)||!n.hasAttribute(ih))return;const r=parseInt(n.getAttribute(rh),10),i=parseInt(n.getAttribute(ih),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function r_(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const Iae="handsontable";function i_(t,e,n,r,i,o,s){Rh.apply(this,[t,e,n,r,i,o,s])}i_.RENDERER_TYPE=Iae;var Oae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Aae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ub,LO;function Hae(){return LO||(LO=1,ub={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),ub}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cb,FO;function IL(){if(FO)return cb;FO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let w="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let T=0;T<t.length;T++){let I=t[T];if(w=l.replace(RegExp(`([0-9 ])(${I.key})$`),"$1"),w!==l)return n(w,u,c,h,d,f)*I.factor}if(w=l.replace("%",""),w!==l)return n(w,u,c,h,d,f)/100;let R=parseFloat(l);if(isNaN(R))return;let y=h(R);if(y&&y!=="."&&(w=l.replace(new RegExp(`${e(y)}$`),""),w!==l))return n(w,u,c,h,d,f);let M={};Object.keys(f).forEach(T=>{M[f[T]]=T});let x=Object.keys(M).sort().reverse(),_=x.length;for(let T=0;T<_;T++){let I=x[T],Y=M[I];if(w=l.replace(I,""),w!==l){let U;switch(Y){case"thousand":U=Math.pow(10,3);break;case"million":U=Math.pow(10,6);break;case"billion":U=Math.pow(10,9);break;case"trillion":U=Math.pow(10,12);break}return n(w,u,c,h,d,f)*U}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let w=r(l,u,c);return n(w,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=a_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),w=c.currentAbbreviations(),C;if(typeof l=="string")o(l,h)?C=s(l):C=i(l,h,d,f,g,w);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return cb={unformat:a},cb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var hb,VO;function o_(){if(VO)return hb;VO=1;let t=IL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,R)=>R.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,R)=>R.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,R)=>!R.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,R)=>R.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,R){let y=d(C),M=g(R);return y&&M}function d(C){return t.unformat(C)!==void 0}function f(C,R,y,M=!1){let x=Object.keys(C).map(_=>{if(!R[_])return console.error(`${y} Invalid key: ${_}`),!1;let T=C[_],I=R[_];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!f(T,u,`[Validate ${_}]`,!0))return!1}else if(typeof T!==I.type)return console.error(`${y} ${_} type mismatched: "${I.type}" expected, "${typeof T}" provided`),!1;if(I.restrictions&&I.restrictions.length){let Y=I.restrictions.length;for(let U=0;U<Y;U++){let{restriction:V,message:q}=I.restrictions[U];if(!V(T,C))return console.error(`${y} ${_} invalid value: ${q}`),!1}}return I.restriction&&!I.restriction(T,C)?(console.error(`${y} ${_} invalid value: ${I.message}`),!1):I.validValues&&I.validValues.indexOf(T)===-1?(console.error(`${y} ${_} invalid value: must be among ${JSON.stringify(I.validValues)}, "${T}" provided`),!1):!(I.children&&!f(T,I.children,`[Validate ${_}]`))});return M||x.push(...Object.keys(R).map(_=>{let T=R[_];if(typeof T=="string"&&(T={type:T}),T.mandatory){let I=T.mandatory;if(typeof I=="function"&&(I=I(C)),I&&C[_]===void 0)return console.error(`${y} Missing mandatory key "${_}"`),!1}return!0})),x.reduce((_,T)=>_&&T,!0)}function g(C){return f(C,u,"[Validate format]")}function w(C){return f(C,c,"[Validate language]")}return hb={validate:h,validateFormat:g,validateInput:d,validateLanguage:w},hb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Nae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function Dae(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function kae(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function $ae(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Lae(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function Fae(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function Vae(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function Bae(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function Wae(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function jae(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Uae(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function zae(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function Yae(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function Gae(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Kae(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function qae(t,e={}){return typeof t!="string"?t:(t=Nae(t,e),t=Dae(t,e),kae(t,e),Fae(t,e),Vae(t,e),Yae(t,e),jae(t,e),Uae(t,e),Bae(t,e),zae(t,e),Wae(t,e),$ae(t,e),Lae(t,e),Gae(t,e),Kae(t,e),e)}var s_={parseFormat:qae};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var db,BO;function a_(){if(BO)return db;BO=1;const t=Hae(),e=o_(),n=s_;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,db=r,db}function Xae(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Jae(t,e){t.forEach(n=>{let r;try{r=Xae(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var Zae=t=>({loadLanguagesInNode:e=>Jae(e,t)}),OL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(T){var I,Y,U,V=p.prototype={constructor:p,toString:null,valueOf:null},q=new p(1),ee=20,Q=4,ne=-7,pe=21,it=-1e7,Ee=1e7,Ae=!1,ut=1,In=0,ct={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",v=!0;function p(b,E){var S,$,O,N,W,H,D,B,F=this;if(!(F instanceof p))return new p(b,E);if(E==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>Ee?F.c=F.e=null:b.e<it?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((H=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(N=0,W=b;W>=10;W/=10,N++);N>Ee?F.c=F.e=null:(F.e=N,F.c=[b]);return}B=String(b)}else{if(!r.test(B=String(b)))return U(F,B,H);F.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(N=B.indexOf("."))>-1&&(B=B.replace(".","")),(W=B.search(/e/i))>0?(N<0&&(N=W),N+=+B.slice(W+1),B=B.substring(0,W)):N<0&&(N=B.length)}else{if(y(E,2,m.length,"Base"),E==10&&v)return F=new p(b),K(F,ee+F.e+1,Q);if(B=String(b),H=typeof b=="number"){if(b*0!=0)return U(F,B,H,E);if(F.s=1/b<0?(B=B.slice(1),-1):1,p.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(S=m.slice(0,E),N=W=0,D=B.length;W<D;W++)if(S.indexOf($=B.charAt(W))<0){if($=="."){if(W>N){N=D;continue}}else if(!O&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){O=!0,W=-1,N=0;continue}return U(F,String(b),H,E)}H=!1,B=Y(B,E,10,F.s),(N=B.indexOf("."))>-1?B=B.replace(".",""):N=B.length}for(W=0;B.charCodeAt(W)===48;W++);for(D=B.length;B.charCodeAt(--D)===48;);if(B=B.slice(W,++D)){if(D-=W,H&&p.DEBUG&&D>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((N=N-W-1)>Ee)F.c=F.e=null;else if(N<it)F.c=[F.e=0];else{if(F.e=N,F.c=[],W=(N+1)%u,N<0&&(W+=u),W<D){for(W&&F.c.push(+B.slice(0,W)),D-=u;W<D;)F.c.push(+B.slice(W,W+=u));W=u-(B=B.slice(W)).length}else W-=D;for(;W--;B+="0");F.c.push(+B)}}else F.c=[F.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(b){var E,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(E="DECIMAL_PLACES")&&(S=b[E],y(S,0,f,E),ee=S),b.hasOwnProperty(E="ROUNDING_MODE")&&(S=b[E],y(S,0,8,E),Q=S),b.hasOwnProperty(E="EXPONENTIAL_AT")&&(S=b[E],S&&S.pop?(y(S[0],-1e9,0,E),y(S[1],0,f,E),ne=S[0],pe=S[1]):(y(S,-1e9,f,E),ne=-(pe=S<0?-S:S))),b.hasOwnProperty(E="RANGE"))if(S=b[E],S&&S.pop)y(S[0],-1e9,-1,E),y(S[1],1,f,E),it=S[0],Ee=S[1];else if(y(S,-1e9,f,E),S)it=-(Ee=S<0?-S:S);else throw Error(s+E+" cannot be zero: "+S);if(b.hasOwnProperty(E="CRYPTO"))if(S=b[E],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ae=S;else throw Ae=!S,Error(s+"crypto unavailable");else Ae=S;else throw Error(s+E+" not true or false: "+S);if(b.hasOwnProperty(E="MODULO_MODE")&&(S=b[E],y(S,0,9,E),ut=S),b.hasOwnProperty(E="POW_PRECISION")&&(S=b[E],y(S,0,f,E),In=S),b.hasOwnProperty(E="FORMAT"))if(S=b[E],typeof S=="object")ct=S;else throw Error(s+E+" not an object: "+S);if(b.hasOwnProperty(E="ALPHABET"))if(S=b[E],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))v=S.slice(0,10)=="0123456789",m=S;else throw Error(s+E+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:ee,ROUNDING_MODE:Q,EXPONENTIAL_AT:[ne,pe],RANGE:[it,Ee],CRYPTO:Ae,MODULO_MODE:ut,POW_PRECISION:In,FORMAT:ct,ALPHABET:m}},p.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var E,S,$=b.c,O=b.e,N=b.s;e:if({}.toString.call($)=="[object Array]"){if((N===1||N===-1)&&O>=-1e9&&O<=f&&O===o(O)){if($[0]===0){if(O===0&&$.length===1)return!0;break e}if(E=(O+1)%u,E<1&&(E+=u),String($[0]).length==E){for(E=0;E<$.length;E++)if(S=$[E],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if($===null&&O===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},p.maximum=p.max=function(){return L(arguments,-1)},p.minimum=p.min=function(){return L(arguments,1)},p.random=function(){var b=9007199254740992,E=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var $,O,N,W,H,D=0,B=[],F=new p(q);if(S==null?S=ee:y(S,0,f),W=i(S/u),Ae)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(W*=2));D<W;)H=$[D]*131072+($[D+1]>>>11),H>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),$[D]=O[0],$[D+1]=O[1]):(B.push(H%1e14),D+=2);D=W/2}else if(crypto.randomBytes){for($=crypto.randomBytes(W*=7);D<W;)H=($[D]&31)*281474976710656+$[D+1]*1099511627776+$[D+2]*4294967296+$[D+3]*16777216+($[D+4]<<16)+($[D+5]<<8)+$[D+6],H>=9e15?crypto.randomBytes(7).copy($,D):(B.push(H%1e14),D+=7);D=W/7}else throw Ae=!1,Error(s+"crypto unavailable");if(!Ae)for(;D<W;)H=E(),H<9e15&&(B[D++]=H%1e14);for(W=B[--D],S%=u,W&&S&&(H=h[u-S],B[D]=o(W/H)*H);B[D]===0;B.pop(),D--);if(D<0)B=[N=0];else{for(N=-1;B[0]===0;B.splice(0,1),N-=u);for(D=1,H=B[0];H>=10;H/=10,D++);D<u&&(N-=u-D)}return F.e=N,F.c=B,F}}(),p.sum=function(){for(var b=1,E=arguments,S=new p(E[0]);b<E.length;)S=S.plus(E[b++]);return S},Y=function(){var b="0123456789";function E(S,$,O,N){for(var W,H=[0],D,B=0,F=S.length;B<F;){for(D=H.length;D--;H[D]*=$);for(H[0]+=N.indexOf(S.charAt(B++)),W=0;W<H.length;W++)H[W]>O-1&&(H[W+1]==null&&(H[W+1]=0),H[W+1]+=H[W]/O|0,H[W]%=O)}return H.reverse()}return function(S,$,O,N,W){var H,D,B,F,G,ae,ce,_e,Fe=S.indexOf("."),Ye=ee,Me=Q;for(Fe>=0&&(F=In,In=0,S=S.replace(".",""),_e=new p($),ae=_e.pow(S.length-Fe),In=F,_e.c=E(_(C(ae.c),ae.e,"0"),10,O,b),_e.e=_e.c.length),ce=E(S,$,O,W?(H=m,b):(H=b,m)),B=F=ce.length;ce[--F]==0;ce.pop());if(!ce[0])return H.charAt(0);if(Fe<0?--B:(ae.c=ce,ae.e=B,ae.s=N,ae=I(ae,_e,Ye,Me,O),ce=ae.c,G=ae.r,B=ae.e),D=B+Ye+1,Fe=ce[D],F=O/2,G=G||D<0||ce[D+1]!=null,G=Me<4?(Fe!=null||G)&&(Me==0||Me==(ae.s<0?3:2)):Fe>F||Fe==F&&(Me==4||G||Me==6&&ce[D-1]&1||Me==(ae.s<0?8:7)),D<1||!ce[0])S=G?_(H.charAt(1),-Ye,H.charAt(0)):H.charAt(0);else{if(ce.length=D,G)for(--O;++ce[--D]>O;)ce[D]=0,D||(++B,ce=[1].concat(ce));for(F=ce.length;!ce[--F];);for(Fe=0,S="";Fe<=F;S+=H.charAt(ce[Fe++]));S=_(S,B,H.charAt(0))}return S}}(),I=function(){function b($,O,N){var W,H,D,B,F=0,G=$.length,ae=O%d,ce=O/d|0;for($=$.slice();G--;)D=$[G]%d,B=$[G]/d|0,W=ce*D+B*ae,H=ae*D+W%d*d+F,F=(H/N|0)+(W/d|0)+ce*B,$[G]=H%N;return F&&($=[F].concat($)),$}function E($,O,N,W){var H,D;if(N!=W)D=N>W?1:-1;else for(H=D=0;H<N;H++)if($[H]!=O[H]){D=$[H]>O[H]?1:-1;break}return D}function S($,O,N,W){for(var H=0;N--;)$[N]-=H,H=$[N]<O[N]?1:0,$[N]=H*W+$[N]-O[N];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,O,N,W,H){var D,B,F,G,ae,ce,_e,Fe,Ye,Me,Be,Ot,Ni,is,ii,At,pn,Tt=$.s==O.s?1:-1,Ht=$.c,We=O.c;if(!Ht||!Ht[0]||!We||!We[0])return new p(!$.s||!O.s||(Ht?We&&Ht[0]==We[0]:!We)?NaN:Ht&&Ht[0]==0||!We?Tt*0:Tt/0);for(Fe=new p(Tt),Ye=Fe.c=[],B=$.e-O.e,Tt=N+B+1,H||(H=l,B=w($.e/u)-w(O.e/u),Tt=Tt/u|0),F=0;We[F]==(Ht[F]||0);F++);if(We[F]>(Ht[F]||0)&&B--,Tt<0)Ye.push(1),G=!0;else{for(is=Ht.length,At=We.length,F=0,Tt+=2,ae=o(H/(We[0]+1)),ae>1&&(We=b(We,ae,H),Ht=b(Ht,ae,H),At=We.length,is=Ht.length),Ni=At,Me=Ht.slice(0,At),Be=Me.length;Be<At;Me[Be++]=0);pn=We.slice(),pn=[0].concat(pn),ii=We[0],We[1]>=H/2&&ii++;do{if(ae=0,D=E(We,Me,At,Be),D<0){if(Ot=Me[0],At!=Be&&(Ot=Ot*H+(Me[1]||0)),ae=o(Ot/ii),ae>1)for(ae>=H&&(ae=H-1),ce=b(We,ae,H),_e=ce.length,Be=Me.length;E(ce,Me,_e,Be)==1;)ae--,S(ce,At<_e?pn:We,_e,H),_e=ce.length,D=1;else ae==0&&(D=ae=1),ce=We.slice(),_e=ce.length;if(_e<Be&&(ce=[0].concat(ce)),S(Me,ce,Be,H),Be=Me.length,D==-1)for(;E(We,Me,At,Be)<1;)ae++,S(Me,At<Be?pn:We,Be,H),Be=Me.length}else D===0&&(ae++,Me=[0]);Ye[F++]=ae,Me[0]?Me[Be++]=Ht[Ni]||0:(Me=[Ht[Ni]],Be=1)}while((Ni++<is||Me[0]!=null)&&Tt--);G=Me[0]!=null,Ye[0]||Ye.splice(0,1)}if(H==l){for(F=1,Tt=Ye[0];Tt>=10;Tt/=10,F++);K(Fe,N+(Fe.e=F+B*u-1)+1,W,G)}else Fe.e=B,Fe.r=+G;return Fe}}();function A(b,E,S,$){var O,N,W,H,D;if(S==null?S=Q:y(S,0,8),!b.c)return b.toString();if(O=b.c[0],W=b.e,E==null)D=C(b.c),D=$==1||$==2&&(W<=ne||W>=pe)?x(D,W):_(D,W,"0");else if(b=K(new p(b),E,S),N=b.e,D=C(b.c),H=D.length,$==1||$==2&&(E<=N||N<=ne)){for(;H<E;D+="0",H++);D=x(D,N)}else if(E-=W,D=_(D,N,"0"),N+1>H){if(--E>0)for(D+=".";E--;D+="0");}else if(E+=N-H,E>0)for(N+1==H&&(D+=".");E--;D+="0");return b.s<0&&O?"-"+D:D}function L(b,E){for(var S,$,O=1,N=new p(b[0]);O<b.length;O++)$=new p(b[O]),(!$.s||(S=R(N,$))===E||S===0&&N.s===E)&&(N=$);return N}function j(b,E,S){for(var $=1,O=E.length;!E[--O];E.pop());for(O=E[0];O>=10;O/=10,$++);return(S=$+S*u-1)>Ee?b.c=b.e=null:S<it?b.c=[b.e=0]:(b.e=S,b.c=E),b}U=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,E=/^([^.]+)\.$/,S=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,W,H,D){var B,F=H?W:W.replace(O,"");if($.test(F))N.s=isNaN(F)?null:F<0?-1:1;else{if(!H&&(F=F.replace(b,function(G,ae,ce){return B=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!D||D==B?ae:G}),D&&(B=D,F=F.replace(E,"$1").replace(S,"0.$1")),W!=F))return new p(F,B);if(p.DEBUG)throw Error(s+"Not a"+(D?" base "+D:"")+" number: "+W);N.s=null}N.c=N.e=null}}();function K(b,E,S,$){var O,N,W,H,D,B,F,G=b.c,ae=h;if(G){e:{for(O=1,H=G[0];H>=10;H/=10,O++);if(N=E-O,N<0)N+=u,W=E,D=G[B=0],F=o(D/ae[O-W-1]%10);else if(B=i((N+1)/u),B>=G.length)if($){for(;G.length<=B;G.push(0));D=F=0,O=1,N%=u,W=N-u+1}else break e;else{for(D=H=G[B],O=1;H>=10;H/=10,O++);N%=u,W=N-u+O,F=W<0?0:o(D/ae[O-W-1]%10)}if($=$||E<0||G[B+1]!=null||(W<0?D:D%ae[O-W-1]),$=S<4?(F||$)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||$||S==6&&(N>0?W>0?D/ae[O-W]:0:G[B-1])%10&1||S==(b.s<0?8:7)),E<1||!G[0])return G.length=0,$?(E-=b.e+1,G[0]=ae[(u-E%u)%u],b.e=-E||0):G[0]=b.e=0,b;if(N==0?(G.length=B,H=1,B--):(G.length=B+1,H=ae[u-N],G[B]=W>0?o(D/ae[O-W]%ae[W])*H:0),$)for(;;)if(B==0){for(N=1,W=G[0];W>=10;W/=10,N++);for(W=G[0]+=H,H=1;W>=10;W/=10,H++);N!=H&&(b.e++,G[0]==l&&(G[0]=1));break}else{if(G[B]+=H,G[B]!=l)break;G[B--]=0,H=1}for(N=G.length;G[--N]===0;G.pop());}b.e>Ee?b.c=b.e=null:b.e<it&&(b.c=[b.e=0])}return b}function J(b){var E,S=b.e;return S===null?b.toString():(E=C(b.c),E=S<=ne||S>=pe?x(E,S):_(E,S,"0"),b.s<0?"-"+E:E)}return V.absoluteValue=V.abs=function(){var b=new p(this);return b.s<0&&(b.s=1),b},V.comparedTo=function(b,E){return R(this,new p(b,E))},V.decimalPlaces=V.dp=function(b,E){var S,$,O,N=this;if(b!=null)return y(b,0,f),E==null?E=Q:y(E,0,8),K(new p(N),b+N.e+1,E);if(!(S=N.c))return null;if($=((O=S.length-1)-w(this.e/u))*u,O=S[O])for(;O%10==0;O/=10,$--);return $<0&&($=0),$},V.dividedBy=V.div=function(b,E){return I(this,new p(b,E),ee,Q)},V.dividedToIntegerBy=V.idiv=function(b,E){return I(this,new p(b,E),0,1)},V.exponentiatedBy=V.pow=function(b,E){var S,$,O,N,W,H,D,B,F,G=this;if(b=new p(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+J(b));if(E!=null&&(E=new p(E)),H=b.e>14,!G.c||!G.c[0]||G.c[0]==1&&!G.e&&G.c.length==1||!b.c||!b.c[0])return F=new p(Math.pow(+J(G),H?b.s*(2-M(b)):+J(b))),E?F.mod(E):F;if(D=b.s<0,E){if(E.c?!E.c[0]:!E.s)return new p(NaN);$=!D&&G.isInteger()&&E.isInteger(),$&&(G=G.mod(E))}else{if(b.e>9&&(G.e>0||G.e<-1||(G.e==0?G.c[0]>1||H&&G.c[1]>=24e7:G.c[0]<8e13||H&&G.c[0]<=9999975e7)))return N=G.s<0&&M(b)?-0:0,G.e>-1&&(N=1/N),new p(D?1/N:N);In&&(N=i(In/u+2))}for(H?(S=new p(.5),D&&(b.s=1),B=M(b)):(O=Math.abs(+J(b)),B=O%2),F=new p(q);;){if(B){if(F=F.times(G),!F.c)break;N?F.c.length>N&&(F.c.length=N):$&&(F=F.mod(E))}if(O){if(O=o(O/2),O===0)break;B=O%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)B=M(b);else{if(O=+J(b),O===0)break;B=O%2}G=G.times(G),N?G.c&&G.c.length>N&&(G.c.length=N):$&&(G=G.mod(E))}return $?F:(D&&(F=q.div(F)),E?F.mod(E):N?K(F,In,Q,W):F)},V.integerValue=function(b){var E=new p(this);return b==null?b=Q:y(b,0,8),K(E,E.e+1,b)},V.isEqualTo=V.eq=function(b,E){return R(this,new p(b,E))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(b,E){return R(this,new p(b,E))>0},V.isGreaterThanOrEqualTo=V.gte=function(b,E){return(E=R(this,new p(b,E)))===1||E===0},V.isInteger=function(){return!!this.c&&w(this.e/u)>this.c.length-2},V.isLessThan=V.lt=function(b,E){return R(this,new p(b,E))<0},V.isLessThanOrEqualTo=V.lte=function(b,E){return(E=R(this,new p(b,E)))===-1||E===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(b,E){var S,$,O,N,W=this,H=W.s;if(b=new p(b,E),E=b.s,!H||!E)return new p(NaN);if(H!=E)return b.s=-E,W.plus(b);var D=W.e/u,B=b.e/u,F=W.c,G=b.c;if(!D||!B){if(!F||!G)return F?(b.s=-E,b):new p(G?W:NaN);if(!F[0]||!G[0])return G[0]?(b.s=-E,b):new p(F[0]?W:Q==3?-0:0)}if(D=w(D),B=w(B),F=F.slice(),H=D-B){for((N=H<0)?(H=-H,O=F):(B=D,O=G),O.reverse(),E=H;E--;O.push(0));O.reverse()}else for($=(N=(H=F.length)<(E=G.length))?H:E,H=E=0;E<$;E++)if(F[E]!=G[E]){N=F[E]<G[E];break}if(N&&(O=F,F=G,G=O,b.s=-b.s),E=($=G.length)-(S=F.length),E>0)for(;E--;F[S++]=0);for(E=l-1;$>H;){if(F[--$]<G[$]){for(S=$;S&&!F[--S];F[S]=E);--F[S],F[$]+=l}F[$]-=G[$]}for(;F[0]==0;F.splice(0,1),--B);return F[0]?j(b,F,B):(b.s=Q==3?-1:1,b.c=[b.e=0],b)},V.modulo=V.mod=function(b,E){var S,$,O=this;return b=new p(b,E),!O.c||!b.s||b.c&&!b.c[0]?new p(NaN):!b.c||O.c&&!O.c[0]?new p(O):(ut==9?($=b.s,b.s=1,S=I(O,b,0,3),b.s=$,S.s*=$):S=I(O,b,0,ut),b=O.minus(S.times(b)),!b.c[0]&&ut==1&&(b.s=O.s),b)},V.multipliedBy=V.times=function(b,E){var S,$,O,N,W,H,D,B,F,G,ae,ce,_e,Fe,Ye,Me=this,Be=Me.c,Ot=(b=new p(b,E)).c;if(!Be||!Ot||!Be[0]||!Ot[0])return!Me.s||!b.s||Be&&!Be[0]&&!Ot||Ot&&!Ot[0]&&!Be?b.c=b.e=b.s=null:(b.s*=Me.s,!Be||!Ot?b.c=b.e=null:(b.c=[0],b.e=0)),b;for($=w(Me.e/u)+w(b.e/u),b.s*=Me.s,D=Be.length,G=Ot.length,D<G&&(_e=Be,Be=Ot,Ot=_e,O=D,D=G,G=O),O=D+G,_e=[];O--;_e.push(0));for(Fe=l,Ye=d,O=G;--O>=0;){for(S=0,ae=Ot[O]%Ye,ce=Ot[O]/Ye|0,W=D,N=O+W;N>O;)B=Be[--W]%Ye,F=Be[W]/Ye|0,H=ce*B+F*ae,B=ae*B+H%Ye*Ye+_e[N]+S,S=(B/Fe|0)+(H/Ye|0)+ce*F,_e[N--]=B%Fe;_e[N]=S}return S?++$:_e.splice(0,1),j(b,_e,$)},V.negated=function(){var b=new p(this);return b.s=-b.s||null,b},V.plus=function(b,E){var S,$=this,O=$.s;if(b=new p(b,E),E=b.s,!O||!E)return new p(NaN);if(O!=E)return b.s=-E,$.minus(b);var N=$.e/u,W=b.e/u,H=$.c,D=b.c;if(!N||!W){if(!H||!D)return new p(O/0);if(!H[0]||!D[0])return D[0]?b:new p(H[0]?$:O*0)}if(N=w(N),W=w(W),H=H.slice(),O=N-W){for(O>0?(W=N,S=D):(O=-O,S=H),S.reverse();O--;S.push(0));S.reverse()}for(O=H.length,E=D.length,O-E<0&&(S=D,D=H,H=S,E=O),O=0;E;)O=(H[--E]=H[E]+D[E]+O)/l|0,H[E]=l===H[E]?0:H[E]%l;return O&&(H=[O].concat(H),++W),j(b,H,W)},V.precision=V.sd=function(b,E){var S,$,O,N=this;if(b!=null&&b!==!!b)return y(b,1,f),E==null?E=Q:y(E,0,8),K(new p(N),b,E);if(!(S=N.c))return null;if(O=S.length-1,$=O*u+1,O=S[O]){for(;O%10==0;O/=10,$--);for(O=S[0];O>=10;O/=10,$++);}return b&&N.e+1>$&&($=N.e+1),$},V.shiftedBy=function(b){return y(b,-9007199254740991,c),this.times("1e"+b)},V.squareRoot=V.sqrt=function(){var b,E,S,$,O,N=this,W=N.c,H=N.s,D=N.e,B=ee+4,F=new p("0.5");if(H!==1||!W||!W[0])return new p(!H||H<0&&(!W||W[0])?NaN:W?N:1/0);if(H=Math.sqrt(+J(N)),H==0||H==1/0?(E=C(W),(E.length+D)%2==0&&(E+="0"),H=Math.sqrt(+E),D=w((D+1)/2)-(D<0||D%2),H==1/0?E="5e"+D:(E=H.toExponential(),E=E.slice(0,E.indexOf("e")+1)+D),S=new p(E)):S=new p(H+""),S.c[0]){for(D=S.e,H=D+B,H<3&&(H=0);;)if(O=S,S=F.times(O.plus(I(N,O,B,1))),C(O.c).slice(0,H)===(E=C(S.c)).slice(0,H))if(S.e<D&&--H,E=E.slice(H-3,H+1),E=="9999"||!$&&E=="4999"){if(!$&&(K(O,O.e+ee+2,0),O.times(O).eq(N))){S=O;break}B+=4,H+=4,$=1}else{(!+E||!+E.slice(1)&&E.charAt(0)=="5")&&(K(S,S.e+ee+2,1),b=!S.times(S).eq(N));break}}return K(S,S.e+ee+1,Q,b)},V.toExponential=function(b,E){return b!=null&&(y(b,0,f),b++),A(this,b,E,1)},V.toFixed=function(b,E){return b!=null&&(y(b,0,f),b=b+this.e+1),A(this,b,E)},V.toFormat=function(b,E,S){var $,O=this;if(S==null)b!=null&&E&&typeof E=="object"?(S=E,E=null):b&&typeof b=="object"?(S=b,b=E=null):S=ct;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if($=O.toFixed(b,E),O.c){var N,W=$.split("."),H=+S.groupSize,D=+S.secondaryGroupSize,B=S.groupSeparator||"",F=W[0],G=W[1],ae=O.s<0,ce=ae?F.slice(1):F,_e=ce.length;if(D&&(N=H,H=D,D=N,_e-=N),H>0&&_e>0){for(N=_e%H||H,F=ce.substr(0,N);N<_e;N+=H)F+=B+ce.substr(N,H);D>0&&(F+=B+ce.slice(N)),ae&&(F="-"+F)}$=G?F+(S.decimalSeparator||"")+((D=+S.fractionGroupSize)?G.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):G):F}return(S.prefix||"")+$+(S.suffix||"")},V.toFraction=function(b){var E,S,$,O,N,W,H,D,B,F,G,ae,ce=this,_e=ce.c;if(b!=null&&(H=new p(b),!H.isInteger()&&(H.c||H.s!==1)||H.lt(q)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+J(H));if(!_e)return new p(ce);for(E=new p(q),B=S=new p(q),$=D=new p(q),ae=C(_e),N=E.e=ae.length-ce.e-1,E.c[0]=h[(W=N%u)<0?u+W:W],b=!b||H.comparedTo(E)>0?N>0?E:B:H,W=Ee,Ee=1/0,H=new p(ae),D.c[0]=0;F=I(H,E,0,1),O=S.plus(F.times($)),O.comparedTo(b)!=1;)S=$,$=O,B=D.plus(F.times(O=B)),D=O,E=H.minus(F.times(O=E)),H=O;return O=I(b.minus(S),$,0,1),D=D.plus(O.times(B)),S=S.plus(O.times($)),D.s=B.s=ce.s,N=N*2,G=I(B,$,N,Q).minus(ce).abs().comparedTo(I(D,S,N,Q).minus(ce).abs())<1?[B,$]:[D,S],Ee=W,G},V.toNumber=function(){return+J(this)},V.toPrecision=function(b,E){return b!=null&&y(b,1,f),A(this,b,E,2)},V.toString=function(b){var E,S=this,$=S.s,O=S.e;return O===null?$?(E="Infinity",$<0&&(E="-"+E)):E="NaN":(b==null?E=O<=ne||O>=pe?x(C(S.c),O):_(C(S.c),O,"0"):b===10&&v?(S=K(new p(S),ee+O+1,Q),E=_(C(S.c),S.e,"0")):(y(b,2,m.length,"Base"),E=Y(_(C(S.c),O,"0"),10,b,$,!0)),$<0&&S.c[0]&&(E="-"+E)),E},V.valueOf=V.toJSON=function(){return J(this)},V._isBigNumber=!0,T!=null&&p.set(T),p}function w(T){var I=T|0;return T>0||T===I?I:I-1}function C(T){for(var I,Y,U=1,V=T.length,q=T[0]+"";U<V;){for(I=T[U++]+"",Y=u-I.length;Y--;I="0"+I);q+=I}for(V=q.length;q.charCodeAt(--V)===48;);return q.slice(0,V+1||1)}function R(T,I){var Y,U,V=T.c,q=I.c,ee=T.s,Q=I.s,ne=T.e,pe=I.e;if(!ee||!Q)return null;if(Y=V&&!V[0],U=q&&!q[0],Y||U)return Y?U?0:-Q:ee;if(ee!=Q)return ee;if(Y=ee<0,U=ne==pe,!V||!q)return U?0:!V^Y?1:-1;if(!U)return ne>pe^Y?1:-1;for(Q=(ne=V.length)<(pe=q.length)?ne:pe,ee=0;ee<Q;ee++)if(V[ee]!=q[ee])return V[ee]>q[ee]^Y?1:-1;return ne==pe?0:ne>pe^Y?1:-1}function y(T,I,Y,U){if(T<I||T>Y||T!==o(T))throw Error(s+(U||"Argument")+(typeof T=="number"?T<I||T>Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(T))}function M(T){var I=T.c.length-1;return w(T.e/u)==I&&T.c[I]%2!=0}function x(T,I){return(T.length>1?T.charAt(0)+"."+T.slice(1):T)+(I<0?"e":"e+")+I}function _(T,I,Y){var U,V;if(I<0){for(V=Y+".";++I;V+=Y);T=V+T}else if(U=T.length,++I>U){for(V=Y,I-=U;--I;V+=Y);T+=V}else I<U&&(T=T.slice(0,I)+"."+T.slice(I));return T}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Oae)})(OL);var AL=OL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const zi=a_(),Qae=o_(),ele=s_,tle=AL,Ln={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Eg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:HL,decimalSuffixes:Dw}=zi.currentBytes(),l_={general:{scale:1024,suffixes:Dw},binary:{scale:1024,suffixes:HL},decimal:{scale:1e3,suffixes:Dw}};function nle(t,e={},n){if(typeof e=="string"&&(e=ele.parseFormat(e)),!Qae.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=rle(t,e,n);return s=Sle(s,i),s=Rle(s,o),s}function rle(t,e,n){switch(e.output){case"currency":return e=Sc(e,zi.currentCurrencyDefaultFormat()),hle(t,e,zi);case"percent":return e=Sc(e,zi.currentPercentageDefaultFormat()),cle(t,e,zi,n);case"byte":return e=Sc(e,zi.currentByteDefaultFormat()),ale(t,e,zi,n);case"time":return e=Sc(e,zi.currentTimeDefaultFormat()),ule(t);case"ordinal":return e=Sc(e,zi.currentOrdinalDefaultFormat()),lle(t,e,zi);case"number":default:return Tg({instance:t,providedFormat:e})}}function ile(t){let e=l_.decimal;return ay(t._value,e.suffixes,e.scale).suffix}function ole(t){let e=l_.binary;return ay(t._value,e.suffixes,e.scale).suffix}function sle(t){let e=l_.general;return ay(t._value,e.suffixes,e.scale).suffix}function ay(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function ale(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Eg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Dw,marker:"bd"},binary:{scale:1024,suffixes:s||HL,marker:"b"},decimal:{scale:1e3,suffixes:a||Dw,marker:"d"}}[i],{value:c,suffix:h}=ay(t._value,u.suffixes,u.scale);return`${Tg({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function lle(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Eg,e),o=Tg({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function ule(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function cle(t,e,n,r){let i=e.prefixSymbol,o=Tg({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Eg,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function hle(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Eg,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Tg({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function dle({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Ln[e]?(a=r[e],t=t/Ln[e]):l>=Ln.trillion||n&&s(l/Ln.trillion)===1?(a=r.trillion,t=t/Ln.trillion):l<Ln.trillion&&l>=Ln.billion||n&&s(l/Ln.billion)===1?(a=r.billion,t=t/Ln.billion):l<Ln.billion&&l>=Ln.million||n&&s(l/Ln.million)===1?(a=r.million,t=t/Ln.million):(l<Ln.million&&l>=Ln.thousand||n&&s(l/Ln.thousand)===1)&&(a=r.thousand,t=t/Ln.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function fle({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Pm(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function gle(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Pm(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Pm(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Pm(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Pm(e)}`),n}function mle(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?gle(t,e):new tle(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function ple(t,e,n,r,i,o){if(r===-1)return t;let s=mle(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function wle(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function vle(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function yle(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),vle(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function Cle(t,e){return t+e}function ble(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function Sle(t,e){return e+t}function Rle(t,e){return t+e}function Tg({instance:t,providedFormat:e,state:n=zi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Eg,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,w=s.trimMantissa,C=s.thousandSeparated,R=s.spaceSeparated,y=s.negative,M=s.forceSign,x=s.exponential,_=s.roundingFunction,T="";if(d){let Y=dle({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:R,roundingFunction:_,totalLength:a});o=Y.value,T+=Y.abbreviation,a&&(f=Y.mantissaPrecision)}if(x){let Y=fle({value:o,characteristicPrecision:l});o=Y.value,T=Y.abbreviation+T}let I=ple(o.toString(),o,g,f,w,_);return I=wle(I,o,u,l),I=yle(I,o,C,n,r),(d||x)&&(I=Cle(I,T)),(M||o<0)&&(I=ble(I,o,y)),I}function Sc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var Ele=t=>({format:(...e)=>nle(...e,t),getByteUnit:(...e)=>sle(...e,t),getBinaryByteUnit:(...e)=>ole(...e,t),getDecimalByteUnit:(...e)=>ile(...e,t),formatOrDefault:Sc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Us=AL;function Tle(t,e,n){let r=new Us(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Us(i),t._value=r.plus(i).toNumber(),t}function NL(t,e,n){let r=new Us(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Us(i),t._value=r.minus(i).toNumber(),t}function Mle(t,e,n){let r=new Us(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Us(i),t._value=r.times(i).toNumber(),t}function _le(t,e,n){let r=new Us(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Us(i),t._value=r.dividedBy(i).toNumber(),t}function xle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function Ple(t,e,n){let r=n(t._value);return NL(r,e,n),Math.abs(r._value)}var Ile=t=>({add:(e,n)=>Tle(e,n,t),subtract:(e,n)=>NL(e,n,t),multiply:(e,n)=>Mle(e,n,t),divide:(e,n)=>_le(e,n,t),set:(e,n)=>xle(e,n,t),difference:(e,n)=>Ple(e,n,t),BigNumber:Us});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ole="2.5.0",rs=a_(),Ale=o_(),Hle=Zae(rn),Nle=IL();let gl=Ele(rn),Ul=Ile(rn);const Dle=s_;class DL{constructor(e){this._value=e}clone(){return rn(this._value)}format(e={}){return gl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Dle.parseFormat(e)),e=gl.formatOrDefault(e,rs.currentCurrencyDefaultFormat()),e.output="currency",gl.format(this,e)}formatTime(e={}){return e.output="time",gl.format(this,e)}binaryByteUnits(){return gl.getBinaryByteUnit(this)}decimalByteUnits(){return gl.getDecimalByteUnit(this)}byteUnits(){return gl.getByteUnit(this)}difference(e){return Ul.difference(this,e)}add(e){return Ul.add(this,e)}subtract(e){return Ul.subtract(this,e)}multiply(e){return Ul.multiply(this,e)}divide(e){return Ul.divide(this,e)}set(e){return Ul.set(this,kL(e))}value(){return this._value}valueOf(){return this._value}}function kL(t){let e=t;return rn.isNumbro(t)?e=t._value:typeof t=="string"?e=rn.unformat(t):isNaN(t)&&(e=NaN),e}function rn(t){return new DL(kL(t))}rn.version=Ole;rn.isNumbro=function(t){return t instanceof DL};rn.language=rs.currentLanguage;rn.registerLanguage=rs.registerLanguage;rn.setLanguage=rs.setLanguage;rn.languages=rs.languages;rn.languageData=rs.languageData;rn.zeroFormat=rs.setZeroFormat;rn.defaultFormat=rs.currentDefaults;rn.setDefaults=rs.setDefaults;rn.defaultCurrencyFormat=rs.currentCurrencyDefaultFormat;rn.validate=Ale.validate;rn.loadLanguagesInNode=Hle.loadLanguagesInNode;rn.unformat=Nle.unformat;rn.BigNumber=Ul.BigNumber;var kle=rn,ml=Aae(kle);const $le="numeric";function $L(t,e){if(qn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!ml.languages()[r]){const o=r.replace("-",""),s=ml.allLanguages?ml.allLanguages[r]:ml[o];s&&ml.registerLanguage(s)}ml.setLanguage(r),t=ml(t).format(i||"0")}return t}function u_(t,e,n,r,i,o,s){let a=o;if(qn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=$L(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Qs(t,e,n,r,i,a,s)}u_.RENDERER_TYPE=$le;const Lle="password";function c_(t,e,n,r,i,o,s){Qs.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),Ou(e,u)}c_.RENDERER_TYPE=Lle;const Fle="select";function h_(t,e,n,r,i,o,s){Qs.apply(this,[t,e,n,r,i,o,s])}h_.RENDERER_TYPE=Fle;const Vle="time";function d_(t,e,n,r,i,o,s){Qs.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}d_.RENDERER_TYPE=Vle;function Ble(){zr(Rh),zr(Rg),zr(n_),zr(t_),zr(i_),zr(e_),zr(u_),zr(c_),zr(h_),zr(Qs),zr(d_)}const Wle="autocomplete";function ly(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,WO(n,e)):WO(n,e)(this.source):e(!0)}ly.VALIDATOR_TYPE=Wle;function WO(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function LL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const jle=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:LL},Symbol.toStringTag,{value:"Module"})),Ule="date";function f_(t,e){const n=h$(SL,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=zle(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}f_.VALIDATOR_TYPE=Ule;function zle(t,e){const n=Z(LL(t)),r=Z(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const Yle="dropdown";function g_(t,e){ly.apply(this,[t,e])}g_.VALIDATOR_TYPE=Yle;const Gle="numeric";function m_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:qn(t))}m_.VALIDATOR_TYPE=Gle;const Kle=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],qle="time";function p_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,Kle,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}p_.VALIDATOR_TYPE=qle;function Xle(){ql(ly),ql(g_),ql(f_),ql(m_),ql(p_)}const Jle="autocomplete",Zle={CELL_TYPE:Jle,editor:ZM,renderer:Rh,validator:ly},Qle="checkbox",eue={CELL_TYPE:Qle,editor:bL,renderer:n_},tue="date";function FL(t,e,n,r,i,o,s){Rh.apply(this,[t,e,n,r,i,o,s])}FL.RENDERER_TYPE=tue;const nue="date",rue={CELL_TYPE:nue,editor:RL,renderer:FL,validator:f_},iue="dropdown",oue={CELL_TYPE:iue,editor:EL,renderer:t_,validator:g_,filter:!1,strict:!0},sue="handsontable",aue={CELL_TYPE:sue,editor:JM,renderer:i_},lue="numeric",uue={CELL_TYPE:lue,editor:TL,renderer:u_,validator:m_,dataType:"number"},cue="password",hue={CELL_TYPE:cue,editor:ML,renderer:c_,copyable:!1},due="select",fue={CELL_TYPE:due,editor:_L,renderer:h_},gue="time",mue={CELL_TYPE:gue,editor:xL,renderer:d_,validator:p_};function pue(){di(Zle),di(eue),di(rue),di(oue),di(aue),di(uue),di(hue),di(fue),di(yL),di(mue)}function wue(t,e){VL(t,e),e.add(t)}function vue(t,e,n){VL(t,e),e.set(t,n)}function VL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ku(t,e,n){return(e=yue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yue(t){var e=Cue(t,"string");return typeof e=="symbol"?e:e+""}function Cue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qu(t,e){return t.get(BL(t,e))}function BL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jO=new Map([["plugin",_Q],["cell-type",uL],["editor",c$],["renderer",C$],["validator",b$]]),WL=Symbol("mainSetting"),bue="base",Im=[];let pl=null;var wl=new WeakMap,UO=new WeakSet;class Je{static get PLUGIN_KEY(){return bue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){wue(this,UO),Ku(this,"eventManager",new Mi(this)),Ku(this,"pluginName",null),Ku(this,"pluginsInitializedCallbacks",[]),Ku(this,"isPluginsReady",!1),Ku(this,"enabled",!1),Ku(this,"initialized",!1),vue(this,wl,{}),ns(this,"hot",e,{writable:!1}),pl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!jO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);jO.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Im.push(o)}}if(pl||(pl=eT()),pl.indexOf(this.pluginName)>=0&&pl.splice(pl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),pl.length===0){if(Im.length>0){const i=[`${Im.join(`
`)}
`,"You have to import and register them manually."].join("");throw Im.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||De(n))&&r[WL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(De(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){qu(wl,this)[e]=qu(wl,this)[e]||[];const i=qu(wl,this)[e];this.hot.addHook(e,n,r),i.push(n),qu(wl,this)[e]=i}removeHooks(e){P(qu(wl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=qu(wl,this);ke(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){P(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=BL(UO,this,Sue).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ke(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function Sue(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function vl(t,e,n){return(e=Rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rue(t){var e=Eue(t,"string");return typeof e=="symbol"?e:e+""}function Eue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let w_=class{constructor(e){vl(this,"hot",null),vl(this,"container",null),vl(this,"injected",!1),vl(this,"rows",[]),vl(this,"columns",[]),vl(this,"samples",null),vl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),P(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),P(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{P(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{P(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{P(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),P(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{P(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Om(t,e,n){return(e=Tue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tue(t){var e=Mue(t,"string");return typeof e=="symbol"?e:e+""}function Mue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uy{static get SAMPLE_COUNT(){return 3}constructor(e){Om(this,"samples",null),Om(this,"dataFactory",null),Om(this,"customSampleCount",null),Om(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:uy.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:De(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Pt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function _ue(t,e){jL(t,e),e.add(t)}function fb(t,e,n){jL(t,e),e.set(t,n)}function jL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function id(t,e,n){return(e=xue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xue(t){var e=Pue(t,"string");return typeof e=="symbol"?e:e+""}function Pue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Na(t,e){return t.get(Or(t,e))}function kw(t,e,n){return t.set(Or(t,e),n),n}function Or(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutoColumnSizeSeed");const gb="autoColumnSize",Iue=10,Oue="autoColumnSize";var v_=new WeakMap,Rc=new WeakMap,oh=new WeakMap,Yr=new WeakSet;class tf extends Je{static get PLUGIN_KEY(){return gb}static get PLUGIN_PRIORITY(){return Iue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),_ue(this,Yr),id(this,"ghostTable",new w_(this.hot)),id(this,"samplesGenerator",new uy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),id(this,"inProgress",!1),id(this,"measuredColumns",0),id(this,"columnWidthsMap",new Za),fb(this,v_,!1),fb(this,Rc,[]),fb(this,oh,[]),this.hot.columnIndexMapper.registerMap(Oue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Or(Yr,this,zO).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[gb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Or(Yr,e,Nue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Or(Yr,e,Due).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Or(Yr,e,$ue).call(e,...i)}),this.addHook("beforeRender",()=>Or(Yr,this,Hue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Or(Yr,this,kue).call(this)),super.enablePlugin()}updatePlugin(){kw(oh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Or(Yr,this,zO).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Or(Yr,this,UL).call(this,s,o)}),this.ghostTable.columns.length&&(Or(Yr,this,zL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Hf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+tf.CALCULATION_STEP,i)},e,n),r=r+tf.CALCULATION_STEP+1,r<i?o=Af(s):(Hf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[gb];let n=tf.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return De(e)&&(n=e.syncLimit,xE(n)?n=ZE(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,th))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Na(Rc,this).length;return(s-1<o||Na(Rc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Na(Rc,this).push(i):Na(Rc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Aue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||Or(Yr,this,UL).call(this,n,e))}),this.ghostTable.columns.length&&(Or(Yr,this,zL).call(this),this.ghostTable.clean())}function UL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function zL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function Hue(){this.calculateVisibleColumnsWidth(),this.inProgress||(Or(Yr,this,Aue).call(this,Na(oh,this)),kw(oh,this,[]))}function Nue(t,e){e||this.recalculateAllColumnsWidth()}function Due(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Na(oh,this).push(...e)}function zO(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function kue(){kw(Rc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),kw(v_,this,!0)}function $ue(t){if(!Na(v_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Na(oh,this).push(...e)}const Zl={horizontal:"horizontal",vertical:"vertical"};function Lue(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function Fue(t){const e={};return t===!0?(e.directions=Object.keys(Zl),e.autoInsertRow=!0):De(t)?(le(t.autoInsertRow)?t.direction===Zl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Zl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Vue(t,e){Bue(t,e),e.add(t)}function Bue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xu(t,e,n){return(e=Wue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wue(t){var e=jue(t,"string");return typeof e=="symbol"?e:e+""}function jue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function od(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutofillRange");oe.getSingleton().register("beforeAutofill");oe.getSingleton().register("afterAutofill");const YO="autofill",Uue=20,zue=["fillHandle"],Yue="insert_row_below",Gue=200;var Ju=new WeakSet;class Kue extends Je{constructor(){super(...arguments),Vue(this,Ju),Xu(this,"addingStarted",!1),Xu(this,"mouseDownOnCellCorner",!1),Xu(this,"mouseDragOutside",!1),Xu(this,"handleDraggedCells",0),Xu(this,"directions",[]),Xu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return YO}static get PLUGIN_PRIORITY(){return Uue}static get SETTING_KEYS(){return[YO,...zue]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>od(Ju,this,Xue).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>od(Ju,this,que).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>od(Ju,this,Jue).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return P(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),P(a,c=>{const h=[];P(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=Lue(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),w=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,g,w,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let R=C;const y=C;if(["up","left"].indexOf(c)>-1&&!(y.length===1&&y[0].length===0))if(R=[],c==="up"){const M=d.row-h.row+1,x=M%y.length;for(let _=0;_<M;_++)R.push(y[(_+(y.length-x))%y.length])}else{const M=d.col-h.col+1,x=M%y[0].length;for(let _=0;_<y.length;_++){R.push([]);for(let T=0;T<M;T++)R[_].push(y[_][(T+(y[_].length-x))%y[_].length])}}this.hot.populateFromArray(h.row,h.col,R,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",R,g,w,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Zl.vertical)&&this.directions.includes(Zl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Zl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Zl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Yue,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Gue)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!qt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!qt(s)||!qt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...ze(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Vn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+hn(this.hot.table),i=Vn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+nn(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>od(Ju,this,Zue).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>od(Ju,this,Que).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Fue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function que(){this.selectAdjacent()&&this.fillIn()}function Xue(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Jue(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Zue(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Que(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function ece(t,e){YL(t,e),e.add(t)}function GO(t,e,n){YL(t,e),e.set(t,n)}function YL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zu(t,e,n){return(e=tce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tce(t){var e=nce(t,"string");return typeof e=="symbol"?e:e+""}function nce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GL(t,e,n){return t.set($o(t,e),n),n}function $w(t,e){return t.get($o(t,e))}function $o(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mb="autoRowSize",rce=40,ice="autoRowSize";var Lf=new WeakMap,y_=new WeakMap,bs=new WeakSet;class nf extends Je{static get PLUGIN_KEY(){return mb}static get PLUGIN_PRIORITY(){return rce}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),ece(this,bs),Zu(this,"headerHeight",null),Zu(this,"ghostTable",new w_(this.hot)),Zu(this,"samplesGenerator",new uy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Zu(this,"inProgress",!1),Zu(this,"measuredRows",0),Zu(this,"rowHeightsMap",new Za),GO(this,Lf,[]),GO(this,y_,!1),this.hot.rowIndexMapper.registerMap(ice,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>$o(bs,this,KO).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[mb];return e===!0||De(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $o(bs,e,ace).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $o(bs,e,lce).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $o(bs,e,cce).call(e,...i)}),this.addHook("beforeRender",()=>$o(bs,this,sce).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>$o(bs,this,uce).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>$o(bs,this,KO).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Hf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+nf.CALCULATION_STEP,i)},e,n),r=r+nf.CALCULATION_STEP+1,r<i?o=Af(s):(Hf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[mb];let n=nf.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return De(e)&&(n=e.syncLimit,xE(n)?n=ZE(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function oce(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function sce(){this.calculateVisibleRowsHeight(),this.inProgress||($o(bs,this,oce).call(this,$w(Lf,this)),GL(Lf,this,[]))}function KO(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function ace(t,e){e||this.recalculateAllRowsHeight()}function lce(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);$w(Lf,this).push(...e)}function uce(){this.recalculateAllRowsHeight(),GL(y_,this,!0)}function cce(t){if(!$w(y_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);$w(Lf,this).push(...e)}const{getListWithInsertedItems:hce,getListWithRemovedItems:dce}=z$("physicallyIndexed");class fce extends Au{constructor(){super(e=>e)}insert(e,n){const r=TT(this.indexedValues,n);this.indexedValues=hce(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=dce(this.indexedValues,e);this.indexedValues=ET(n,e),super.remove(e)}}const{getListWithInsertedItems:gce,getListWithRemovedItems:mce}=z$("physicallyIndexed");class pce extends Au{constructor(){super(e=>e)}insert(e,n){this.indexedValues=gce(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=mce(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function wce(t,e){vce(t,e),e.add(t)}function vce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yce(t,e,n){return(e=Cce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cce(t){var e=bce(t,"string");return typeof e=="symbol"?e:e+""}function bce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qO="bindRowsWithHeaders",Rce=210,Ece="loose",XO=new Map([["loose",fce],["strict",pce]]);var JO=new WeakSet;class Tce extends Je{constructor(){super(...arguments),wce(this,JO),yce(this,"headerIndexes",null)}static get PLUGIN_KEY(){return qO}static get PLUGIN_PRIORITY(){return Rce}isEnabled(){return!!this.hot.getSettings()[qO]}enablePlugin(){var e;if(this.enabled)return;const n=(e=XO.get(this.getSetting()))!==null&&e!==void 0?e:XO.get(Ece);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>Sce(JO,this,Mce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Mce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function _ce(t,e){KL(t,e),e.add(t)}function xce(t,e,n){KL(t,e),e.set(t,n)}function KL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZO(t,e,n){return(e=Pce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pce(t){var e=Ice(t,"string");return typeof e=="symbol"?e:e+""}function Ice(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QO(t,e){return t.get(Hc(t,e))}function pb(t,e,n){return t.set(Hc(t,e),n),n}function Hc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wp="collapsibleColumns",Oce=290,Ace=["nestedHeaders"],Yc="collapsibleIndicator",e1=Wp,t1=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Qu=new WeakMap,sd=new WeakSet;class Hce extends Je{constructor(){super(...arguments),_ce(this,sd),ZO(this,"nestedHeadersPlugin",null),ZO(this,"headerStateManager",null),xce(this,Qu,null)}static get PLUGIN_KEY(){return Wp}static get PLUGIN_PRIORITY(){return Oce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Wp,...Ace]}isEnabled(){return!!this.hot.getSettings()[Wp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||ot("You need to configure the Nested Headers plugin in order to use collapsible headers."),pb(Qu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Hc(sd,this,kce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Hc(sd,e,$ce).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Hc(sd,e,Nce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Hc(sd,this,Dce).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),pb(Qu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:e1,relativeToGroup:Qa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(e1)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Yc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Yc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Yc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!t1.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Ua(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;P(r,f=>{var g;let{row:w,col:C}=f;const{collapsible:R,isCollapsed:y}=(g=this.headerStateManager.getHeaderSettings(w,C))!==null&&g!==void 0?g:{};if(!R||y&&n==="collapse"||!y&&n==="expand")return i=!1,!1});const o=[],s=[];i&&P(r,f=>{let{row:g,col:w}=f;const{colspanCompensation:C,affectedColumns:R,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,g,w);C>0&&(s.push(...R),o.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=bk([...a,...s]):n==="expand"&&(l=Ua(a,f=>!s.includes(f)));const u=t1.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){P(o,f=>{f()});return}this.hot.batchExecution(()=>{P(s,f=>{QO(Qu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,R=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;C!==null&&R!==null&&this.hot.selectCell(C,R)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return QO(Qu,this).getHiddenIndexes()}destroy(){pb(Qu,this,null),super.destroy()}}function Nce(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Yc}`);if(Iu(e,[Ri("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),X(u,Yc),e.querySelector("div:first-child").appendChild(u)),we(u,["collapsed","expanded"]),s?(X(u,"collapsed"),Ya(u,"+"),l&&be(e,...Ri(!1))):(X(u,"expanded"),Ya(u,"-"),l&&be(e,...Ri(!0))),l&&be(u,...Pu());else{var c;(c=u)===null||c===void 0||c.remove()}}function Dce(t,e){ve(t.target,Yc)&&(ve(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ve(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ai(t))}function kce(){this.updatePlugin()}function $ce(t,e){e||this.updatePlugin()}function yl(t,e,n){return(e=Lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lce(t){var e=Fce(t,"string");return typeof e=="symbol"?e:e+""}function Fce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Vce=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Bce=!1,Wce=!0,jce=!0;class Uce{constructor(e,n){yl(this,"hot",void 0),yl(this,"sortingStates",new ey),yl(this,"sortEmptyCells",Bce),yl(this,"indicator",Wce),yl(this,"headerAction",jce),yl(this,"compareFunctionFactory",void 0),yl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){De(e)&&ke(e,(n,r)=>{Vce.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return De(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function qL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Go:qt(i)?qt(o)?Go:s&&t==="asc"?Gt:Kt:qt(o)?s&&t==="asc"?Kt:Gt:isNaN(i)&&!isNaN(o)?t==="asc"?Kt:Gt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Gt:Kt:i>o?t==="asc"?Kt:Gt:Go}}const XL="default";function zce(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Go;if(a){if(qt(r))return t==="asc"?Gt:Kt;if(qt(i))return t==="asc"?Kt:Gt}return isNaN(o)?Kt:isNaN(s)?Gt:o<s?t==="asc"?Gt:Kt:o>s?t==="asc"?Kt:Gt:Go}}const Yce="numeric";function Gce(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=qt(s),u=qt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Kt;if(l===!1&&u)return Gt}return d===!1&&f?t==="asc"?Gt:Kt:d&&f===!1?t==="asc"?Kt:Gt:d===!1&&f===!1?qL(t,e,n)(s,a):c===i&&h===r?t==="asc"?Gt:Kt:c===r&&h===i?t==="asc"?Kt:Gt:Go}}const Kce="checkbox";function qce(t,e,n){return nF(t,e.dateFormat,n)}const Xce="date";function Jce(t,e,n){return nF(t,e.timeFormat,n)}const Zce="time",{register:Mg,getItem:n1,hasItem:Qce}=uo("sorting.compareFunctionFactory"),{register:JL,getItem:ehe}=uo("sorting.mainSortComparator");function ZL(t){return Qce(t)?n1(t):n1(XL)}Mg(Kce,Gce);Mg(Xce,qce);Mg(XL,qL);Mg(Yce,zce);Mg(Zce,Jce);const Go=0,Gt=-1,Kt=1;function the(t,e){const n=ehe(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Lw="asc",Fw="desc",QL="colHeader";function nhe(t){if(De(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Lw,Fw].includes(n)}function rhe(t){if(t.some(n=>nhe(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function r1(t){if(t!==Fw)return t===Lw?Fw:Lw}function eF(t){return t.querySelector(`.${QL}`)}function tF(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function C_(t,e,n){return t===-1&&e>=0&&Ga(n)===!1}function nF(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Go;if(qt(r))return qt(i)?Go:o&&t==="asc"?Gt:Kt;if(qt(i))return o&&t==="asc"?Kt:Gt;const s=Z(r,e),a=Z(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Gt:Kt:a.isBefore(s)?t==="asc"?Kt:Gt:Go:Gt:Kt}}function ihe(t,e){ot(mt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const ohe="ascending",she="descending",rF="indicatorDisabled",iF="columnSorting",oF="sortAction",sF=new Map([[Lw,ohe],[Fw,she]]);function ahe(t,e,n,r){const i=[iF];if(r&&i.push(oF),n===!1)return i.push(rF),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(sF.get(o)),i}function lhe(){return Array.from(sF.values()).concat(oF,rF,iF)}function uhe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:ZL(u.type))(l,u,d)(c,h)}(0)}}function che(t,e){hhe(t,e),e.add(t)}function hhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Am(t,e,n){return(e=dhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dhe(t){var e=fhe(t,"string");return typeof e=="symbol"?e:e+""}function fhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ec(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vw="columnSorting",ghe=50,Bw="append",mhe="replace",i1=Vw;JL(Vw,uhe);oe.getSingleton().register("beforeColumnSort");oe.getSingleton().register("afterColumnSort");const ad=new WeakMap;var zl=new WeakSet;class aF extends Je{constructor(){super(...arguments),che(this,zl),Am(this,"columnStatesManager",null),Am(this,"columnMetaCache",null),Am(this,"pluginKey",Vw),Am(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Vw}static get PLUGIN_PRIORITY(){return ghe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(ad.has(this.hot)&&ad.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),ihe(ad.get(this.hot),this.pluginKey);return}this.enabled||(ad.set(this.hot,this.pluginKey),this.columnStatesManager=new Uce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Za(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Ec(zl,this,phe).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ec(zl,e,vhe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Ec(zl,this,zR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ec(zl,e,whe).call(e,...r)}),this.hot.view&&Ec(zl,this,zR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=eF(r);tF(n,r)===!1||i===null||this.updateHeaderClasses(i)};ad.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Qa,position:"before",group:i1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(i1)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Y$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return rhe(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=ze(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=ze(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=r1(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:r1()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if($t(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Bw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===mhe)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(De(e)){const n=e[this.pluginKey];if(De(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):ft(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>ze(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=ze(n,u=>u[0]);the(n,this.pluginKey,ze(e,u=>u.sortOrder),ze(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=ze(n,u=>u[0]),a=new Map(ze(o,(u,c)=>[u,s[c]])),l=ze(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(De(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||De(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(we(e,lhe()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];X(e,ahe(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ve(e.target,QL)}onAfterOnCellMouseDown(e,n){if(C_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function zR(){const t=this.getAllSavedSortSettings();if(De(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function phe(t,e){const n=eF(e);if(tF(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);be(e,...j8(s?`${s}ending`:"none"))}}function whe(t){t===!0&&this.hot.view&&Ec(zl,this,zR).call(this)}function vhe(t,e,n,r){C_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Cl(t,e,n){return(e=yhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yhe(t){var e=Che(t,"string");return typeof e=="symbol"?e:e+""}function Che(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bhe{constructor(e,n){Cl(this,"plugin",void 0),Cl(this,"hot",void 0),Cl(this,"endpoints",[]),Cl(this,"settings",void 0),Cl(this,"settingsType","array"),Cl(this,"currentEndpoint",null),Cl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),P(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();P(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;P(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?P(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):P(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){P(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];P(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),P(i,o=>{let s=[];P(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,P(e.ranges,r=>{P(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],P(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],P(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],P(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&P(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),P(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ot("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function wb(t){return t==null||isNaN(t)}function She(t,e){Rhe(t,e),e.add(t)}function Rhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ehe(t,e,n){return(e=The(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function The(t){var e=Mhe(t,"string");return typeof e=="symbol"?e:e+""}function Mhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vb="columnSummary",_he=220;var ld=new WeakSet;class xhe extends Je{constructor(){super(...arguments),She(this,ld),Ehe(this,"endpoints",null)}static get PLUGIN_KEY(){return vb}static get PLUGIN_PRIORITY(){return _he}isEnabled(){return!!this.hot.getSettings()[vb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[vb],this.endpoints=new bhe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hm(ld,e,Phe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hm(ld,e,Ohe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hm(ld,e,Ihe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hm(ld,e,Ahe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return ke(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=wb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return ke(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=wb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=wb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return ke(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(mt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Phe(){this.endpoints.initEndpoints()}function Ihe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Ohe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Ahe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Hhe(t,e){lF(t,e),e.add(t)}function yb(t,e,n){lF(t,e),e.set(t,n)}function lF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tc(t,e){return t.get(b_(t,e))}function YR(t,e,n){return t.set(b_(t,e),n),n}function b_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ww=new WeakMap,Nm=new WeakMap,Dm=new WeakMap,o1=new WeakSet;class uF{constructor(){Hhe(this,o1),yb(this,Ww,!0),yb(this,Nm,null),yb(this,Dm,new ResizeObserver(e=>b_(o1,this,Nhe).call(this,e)))}setObservedElement(e){YR(Nm,this,e)}unobserve(){Tc(Dm,this).unobserve(Tc(Nm,this))}observe(){YR(Ww,this,!0),Tc(Dm,this).observe(Tc(Nm,this))}destroy(){Tc(Dm,this).disconnect()}}function Nhe(t){if(Tc(Ww,this)||!Array.isArray(t)||!t.length){YR(Ww,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}yt(uF,Bn);function bl(t,e,n){Dhe(t,e),e.set(t,n)}function Dhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(t,e){return t.get(cF(t,e))}function gs(t,e,n){return t.set(cF(t,e),n),n}function cF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sl=new WeakMap,Cb=new WeakMap,ms=new WeakMap,ia=new WeakMap,oa=new WeakMap,km=new WeakMap,ec=new WeakMap;class Ql{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;bl(this,Sl,void 0),bl(this,Cb,!1),bl(this,ms,null),bl(this,ia,void 0),bl(this,oa,void 0),bl(this,km,!0),bl(this,ec,new uF),gs(Sl,this,e),gs(Cb,this,n),gs(ia,this,this.createEditor()),gs(oa,this,Ct(ia,this).style),Ct(ec,this).setObservedElement(this.getInputElement()),Ct(ec,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){Ct(oa,this).left=`${e}px`,Ct(oa,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:nn(this.getInputElement()),height:hn(this.getInputElement())}}observeSize(){Ct(ec,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){Ct(oa,this).display="block",gs(km,this,!1)}hide(){Ct(ec,this).unobserve(),Ct(km,this)||(Ct(oa,this).display="none"),gs(km,this,!0)}isVisible(){return Ct(oa,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return Ct(Sl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Ct(Sl,this).createElement("div"),n=Ct(Sl,this).createElement("textarea");return e.style.display="none",gs(ms,this,Ct(Sl,this).createElement("div")),Ct(ms,this).setAttribute("dir",Ct(Cb,this)?"rtl":"ltr"),X(Ct(ms,this),Ql.CLASS_EDITOR_CONTAINER),Ct(Sl,this).body.appendChild(Ct(ms,this)),X(e,Ql.CLASS_EDITOR),X(n,Ql.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),Ct(ms,this).appendChild(e),e}getInputElement(){return Ct(ia,this).querySelector(`.${Ql.CLASS_INPUT}`)}getEditorElement(){return Ct(ia,this)}destroy(){const e=Ct(ms,this)?Ct(ms,this).parentNode:null;Ct(ia,this).parentNode.removeChild(Ct(ia,this)),gs(ia,this,null),gs(oa,this,null),Ct(ec,this).destroy(),e&&e.removeChild(Ct(ms,this))}}yt(Ql,Bn);function bb(t,e,n){return(e=khe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function khe(t){var e=$he(t,"string");return typeof e=="symbol"?e:e+""}function $he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Lhe=250,Fhe=250;class hF{constructor(e){bb(this,"wasLastActionShow",!0),bb(this,"showDebounced",null),bb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Fhe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lhe;this.showDebounced=mg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}yt(hF,Bn);function Vhe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Bhe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Rl(t,e){const n={};return P(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function va(t,e,n,r,i){P(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Whe(s,a,e,n,r,i)})})}function Whe(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Vhe(s.className,r):a=Bhe(s.className,r)),o(t,e,"className",a)}function dF(t){return`<span class="selected">✓</span>${t}`}function jp(t,e){let n=!1;return Array.isArray(t)&&P(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function cy(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Le="---------";function jhe(){return{name:Le}}const mi="alignment";function Uhe(){return{key:mi,name(){return this.getTranslatedPhrase(XT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${mi}:left`,name(){return this.getTranslatedPhrase(JT)},callback(){const t=this.getSelectedRange(),e=Rl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),va(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:center`,name(){return this.getTranslatedPhrase(ZT)},callback(){const t=this.getSelectedRange(),e=Rl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),va(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:right`,name(){return this.getTranslatedPhrase(QT)},callback(){const t=this.getSelectedRange(),e=Rl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),va(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:justify`,name(){return this.getTranslatedPhrase(eM)},callback(){const t=this.getSelectedRange(),e=Rl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),va(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Le},{key:`${mi}:top`,name(){return this.getTranslatedPhrase(tM)},callback(){const t=this.getSelectedRange(),e=Rl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),va(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:middle`,name(){return this.getTranslatedPhrase(nM)},callback(){const t=this.getSelectedRange(),e=Rl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),va(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:bottom`,name(){return this.getTranslatedPhrase(rM)},callback(){const t=this.getSelectedRange(),e=Rl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),va(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const hy="clear_column";function zhe(){return{key:hy,name(){return this.getTranslatedPhrase(kT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const _g="col_left";function Yhe(){return{key:_g,name(){return this.getTranslatedPhrase(IT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const xg="col_right";function Ghe(){return{key:xg,name(){return this.getTranslatedPhrase(OT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Pg="make_read_only";function Khe(){return{key:Pg,checkable:!0,ariaChecked(){return jp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Ow)},name(){let t=this.getTranslatedPhrase(Ow);return jp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=dF(t)),t},callback(){const t=this.getSelectedRange(),e=jp(t,(n,r)=>this.getCellMeta(n,r).readOnly);P(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const dy="redo";function qhe(){return{key:dy,name(){return this.getTranslatedPhrase(DT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Ig="remove_col";function Xhe(){return{key:Ig,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(HT,e)},callback(){this.alter("remove_col",Hie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const fy="remove_row";function Jhe(){return{key:fy,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(AT,e)},callback(){this.alter("remove_row",Nie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const gy="row_above";function Zhe(){return{key:gy,name(){return this.getTranslatedPhrase(xT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const my="row_below";function Qhe(){return{key:my,name(){return this.getTranslatedPhrase(PT)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Ff="no_items";function ede(){return{key:Ff,name(){return this.getTranslatedPhrase(_T)},disabled:!0,isCommand:!1}}const py="undo";function tde(){return{key:py,name(){return this.getTranslatedPhrase(NT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const nde=[gy,my,_g,xg,hy,fy,Ig,py,dy,Pg,mi,Le,Ff],rde={[Le]:jhe,[Ff]:ede,[gy]:Zhe,[my]:Qhe,[_g]:Yhe,[xg]:Ghe,[hy]:zhe,[fy]:Jhe,[Ig]:Xhe,[py]:tde,[dy]:qhe,[Pg]:Khe,[mi]:Uhe};function fF(){const t={};return ke(rde,(e,n)=>{t[n]=e()}),t}function ide(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(GT):this.getTranslatedPhrase(YT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ode(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(KT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function sde(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(qT);return jp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Up))?dF(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Up);t.updateCommentMeta(n,r,{[Up]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ade(t,e){gF(t,e),e.add(t)}function tc(t,e,n){gF(t,e),e.set(t,n)}function gF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lde(t,e,n){return(e=ude(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ude(t){var e=cde(t,"string");return typeof e=="symbol"?e:e+""}function cde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Da(t,e,n){return t.set(Tr(t,e),n),n}function He(t,e){return t.get(Tr(t,e))}function Tr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jw="comments",hde=60,Ms="comment",Wd="value",mF="style",Up="readOnly",ud=jw,GR=`plugin:${jw}`;var wt=new WeakMap,Ho=new WeakMap,wy=new WeakMap,zp=new WeakMap,KR=new WeakMap,Uw=new WeakMap,Fr=new WeakSet;class dde extends Je{constructor(){super(...arguments),ade(this,Fr),lde(this,"range",{}),tc(this,wt,null),tc(this,Ho,null),tc(this,wy,!1),tc(this,zp,!1),tc(this,KR,null),tc(this,Uw,"")}static get PLUGIN_KEY(){return jw}static get PLUGIN_PRIORITY(){return hde}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[jw]}enablePlugin(){var e=this;this.enabled||(He(wt,this)||(Da(wt,this,new Ql(this.hot.rootDocument,this.hot.isRtl())),He(wt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tr(Fr,e,Cde).call(e,...r)})),He(Ho,this)||Da(Ho,this,new hF(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Tr(Fr,this,wde).call(this,n,a)),this.addHook("afterScroll",()=>Tr(Fr,this,bde).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Tr(Fr,this,s1).call(this,n)),this.addHook("beforeCompositionStart",n=>Tr(Fr,this,s1).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tr(Fr,e,Sde).call(e,...r)}),He(Ho,this).addLocalHook("hide",()=>this.hide()),He(Ho,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){He(Ho,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(GR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Da(zp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(GR),this.hot._registerTimeout(()=>{Da(zp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:ud}),r.addShortcut({keys:[["Escape"]],callback:()=>{He(wt,this).setValue(He(Uw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(wt,this).isVisible()&&He(wt,this).isFocused(),group:ud}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(wt,this).isVisible()&&He(wt,this).isFocused(),group:ud}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{He(wt,this).setValue(He(wt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:ud})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ud)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Tr(Fr,this,mde).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Tr(Fr,this,fde).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Tr(Fr,this,pde).call(this)),this.eventManager.addEventListener(n,"focus",()=>Tr(Fr,this,yde).call(this)),this.eventManager.addEventListener(n,"blur",()=>Tr(Fr,this,vde).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Tr(Fr,this,gde).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=za(e.target,"TD","TBODY");return!!(n&&ve(n,"htCommentCell")&&za(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=He(wt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Wd]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ms),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Wd)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Wd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return He(Ho,this).cancelHiding(),He(wt,this).setValue((e=i[Ms]?i[Ms][Wd]:null)!==null&&e!==void 0?e:""),He(wt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){He(wt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!He(wt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;He(wt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),w=this.getCommentMeta(i,o,mF);w?He(wt,this).setSize(w.width,w.height):He(wt,this).resetSize();const C=c?0:f.getColumnWidth(a),R=l&&!u?hn(g):0,{left:y,top:M,width:x,height:_}=g.getBoundingClientRect(),{width:T,height:I}=He(wt,this).getSize(),{innerWidth:Y,innerHeight:U}=this.hot.rootWindow,V=this.hot.rootDocument.documentElement,q=Pn(this.hot.rootDocument),ee=$E(this.hot.rootWindow)?q:0,Q=LE(this.hot.rootWindow)?q:0;let ne=y+h.scrollX+C,pe=M+h.scrollY+R;this.hot.isRtl()&&(ne-=T+C),this.hot.isLtr()&&y+x+T>Y-ee?ne=y+h.scrollX-T-1:this.hot.isRtl()&&ne<-(V.scrollWidth-V.clientWidth)&&(ne=y+h.scrollX+C+1),M+I>U-Q&&(pe-=I-_+1),He(wt,this).setPosition(ne,pe),He(wt,this).setReadOnlyState(this.getCommentMeta(i,o,Up)),He(wt,this).observeSize()}focusEditor(){He(wt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Ms];let o;i?(o=tr(i),wg(o,r)):o=r,this.hot.setCellMeta(e,n,Ms,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Ms])return i[Ms][r]}addToContextMenu(e){e.items.push({name:Le},ide(this),ode(this),sde(this))}getEditorInputElement(){return He(wt,this).getInputElement()}destroy(){var e,n;(e=He(wt,this))===null||e===void 0||e.destroy(),(n=He(Ho,this))===null||n===void 0||n.destroy(),super.destroy()}}function fde(t){if(!(!this.hot.view||!this.hot.view._wt)&&!He(wy,this)&&!this.targetIsCommentTextArea(t)){const e=za(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function gde(t){t.stopPropagation()}function mde(t){const{rootDocument:e}=this.hot;if(!(He(wy,this)||He(wt,this).isFocused()||ve(t.target,"wtBorder")||He(KR,this)===t.target||!He(wt,this)))if(Da(KR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));He(Ho,this).show(n)}else Fa(t.target,e)&&!this.targetIsCommentTextArea(t)&&He(Ho,this).hide()}function pde(){Da(wy,this,!1)}function wde(t,e){e[Ms]&&e[Ms][Wd]&&X(t,e.commentedCellClassName)}function vde(){Da(Uw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function yde(){Da(Uw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(GR)}function Cde(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[mF]:{width:t,height:e}})}function s1(t){He(wt,this).isFocused()&&Ai(t)}function bde(){He(zp,this)||this.hide()}function Sde(){const t=He(wt,this).getEditorElement();we(t,/ht-theme-.*/g),X(t,this.hot.getCurrentThemeName())}function Sb(t,e,n){return(e=Rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rde(t){var e=Ede(t,"string");return typeof e=="symbol"?e:e+""}function Ede(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pF{constructor(e){Sb(this,"hot",void 0),Sb(this,"commands",{}),Sb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Tde(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||cn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),P(u,c=>c.apply(this.hot,r))}}function Tde(t,e){let n;return P(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Rb(t,e,n){return(e=Mde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mde(t){var e=_de(t,"string");return typeof e=="symbol"?e:e+""}function _de(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Rb(this,"hot",void 0),Rb(this,"predefinedItems",fF()),Rb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,ke(e,(r,i)=>{let o="";r.name===Le?(n[Le]=r,o=Le):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return xde(e,this.defaultOrderPattern,this.predefinedItems)}}function xde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),De(i)?ke(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),De(o)?dn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):P(i,(o,s)=>{let a=n[o];!a&&nde.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),De(o)&&dn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function sa(t,e,n){return(e=Pde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pde(t){var e=Ide(t,"string");return typeof e=="symbol"?e:e+""}function Ide(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ode{constructor(e,n){sa(this,"top",void 0),sa(this,"topRelative",void 0),sa(this,"left",void 0),sa(this,"leftRelative",void 0),sa(this,"scrollTop",void 0),sa(this,"scrollLeft",void 0),sa(this,"cellHeight",void 0),sa(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function cd(t,e,n){Ade(t,e),e.set(t,n)}function Ade(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(vF(t,e))}function $m(t,e,n){return t.set(vF(t,e),n),n}function vF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var or=new WeakMap,br=new WeakMap,Sr=new WeakMap,Eb=new WeakMap,nc=new WeakMap;class Hde{constructor(e){cd(this,or,void 0),cd(this,br,void 0),cd(this,Sr,void 0),cd(this,Eb,!1),cd(this,nc,{above:0,below:0,left:0,right:0}),$m(Eb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Oe(nc,this)[e]=n,this}setElement(e){return $m(or,this,e),this}setParentElement(e){return $m(br,this,e),this}updatePosition(e){$m(Sr,this,new Ode(e,Oe(or,this).ownerDocument.defaultView)),Oe(Eb,this)?(Oe(Sr,this).fitsBelow(Oe(or,this))?this.setPositionBelowCursor():Oe(Sr,this).fitsAbove(Oe(or,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Oe(or,this).dir==="rtl"?Oe(Sr,this).fitsOnLeft(Oe(or,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Oe(Sr,this).fitsOnRight(Oe(or,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Oe(nc,this).above+Oe(Sr,this).top-Oe(or,this).offsetHeight;if(Oe(br,this)){const r=Oe(br,this).ownerDocument.defaultView.getComputedStyle(Oe(br,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Sr,this).top+Oe(Sr,this).cellHeight-Oe(or,this).scrollHeight+i+o}Oe(or,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Oe(nc,this).below+Oe(Sr,this).top+1;if(Oe(br,this)){const r=Oe(br,this).ownerDocument.defaultView.getComputedStyle(Oe(br,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Sr,this).top-i-o-1}Oe(or,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Oe(Sr,this).left;if(Oe(br,this)){const n=Oe(br,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(br,this).querySelector(".htCore")).borderRightWidth,10);e+=Oe(Sr,this).cellWidth+r}else e+=Oe(nc,this).right;Oe(or,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Oe(nc,this).left+Oe(Sr,this).left-Oe(or,this).offsetWidth;if(Oe(br,this)){const n=Oe(br,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(br,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Oe(or,this).style.left=`${e}px`}}function yF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ge(e,-1,g()-1);function a(C,R){const y=g()-1;return C<0&&(C=y),C>y&&(C=0),o.has(C)?-1:(o.add(C),r(C,!1)===!1&&(C=a(R===1?++C:--C,R)),C)}function l(C){C>-1&&C<g()&&r(C,!0)!==!1&&(s=C)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function w(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:w}}function Nde(t){return ze(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function qR(t){return cn(t,"submenu")}function XR(t){return new RegExp(Le,"i").test(t.name)}function Yp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function a1(t){return cn(t,"disableSelection")}function Dde(t){return ve(t,"htSeparator")}function kde(t){return ve(t,"htSubmenu")}function $de(t){return ve(t,"htDisabled")}function Lde(t){return ve(t,"htSelectionDisabled")}function Fde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function CF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Vde(t,e){let n=t.slice(0);return n.reverse(),n=CF(n,e),n.reverse(),n}function Bde(t){const e=[];return P(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Wde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le,n=t.slice(0);return n=CF(n,e),n=Vde(n,e),n=Bde(n),n}function jde(t){return t.checkable===!0}function Ude(t){return yF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Dde(r)||$de(r)||Lde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function zde(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const bF="menu",l1=bF;function Yde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(zde(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:bF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${l1}:${u}`:l1}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Gde(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Xo(n),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Yp(a,t)&&!a1(a)&&!XR(a);be(n,[...jde(a)?[N8(),Pf(c),Pk(h)]:[H8(),Pf(u)],...d?[xu(-1)]:[],...Yp(a,t)?[B8()]:[],...qR(a)?[Ri(!1)]:[]])}n.className="",n.appendChild(l),XR(a)?X(n,"htSeparator"):typeof a.renderer=="function"?(X(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ou(l,u),Yp(a,t)?X(n,"htDisabled"):a1(a)?X(n,"htSelectionDisabled"):qR(a)&&X(n,"htSubmenu")}}function Tb(t,e,n){Kde(t,e),e.set(t,n)}function Kde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Co(t,e,n){return(e=qde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qde(t){var e=Xde(t,"string");return typeof e=="symbol"?e:e+""}function Xde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mb(t,e,n){return t.set(SF(t,e),n),n}function El(t,e){return t.get(SF(t,e))}function SF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const u1=215;var hd=new WeakMap,Lm=new WeakMap,Fm=new WeakMap;class Eh{get tableBorderWidth(){return El(Fm,this)===void 0&&this.hotMenu&&Mb(Fm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),El(Fm,this)}constructor(e,n){var r=this;Co(this,"hot",void 0),Co(this,"options",void 0),Co(this,"eventManager",new Mi(this)),Co(this,"container",void 0),Co(this,"positioner",void 0),Co(this,"hotMenu",null),Co(this,"hotSubMenus",{}),Co(this,"parentMenu",void 0),Co(this,"menuItems",null),Co(this,"origOutsideClickDeselects",null),Tb(this,hd,void 0),Tb(this,Lm,void 0),Tb(this,Fm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:u1,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Hde(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=hu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return El(hd,this)}getKeyboardShortcutsCtrl(){return El(Lm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=mg(a=>this.openSubMenu(a),300),n=this.options.minWidth||u1;let r=!1,i=Ua(this.menuItems,a=>(a.key===Ff&&(r=!0),Fde(a,this.hot)));if(i.length<1&&!r)i.push(fF()[Ff]);else if(i.length===0)return;i=Wde(i,Le);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Gde(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{El(hd,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),RR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!RR()||!Ga(a))&&o&&this.hasSelectedItem()&&(Uo()||YE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Mb(hd,this,Ude(this.hotMenu)),Mb(Lm,this,Yde(this)),El(Lm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(El(hd,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);be(r,[Ri(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!kde(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Eh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&be(n,[Ri(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&be(i,[Ri(!1)])}}closeAllSubMenus(){P(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Nde(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||XR(e)||Yp(e,this.hot)||qR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=En(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?hn(this.hotMenu.getCell(c,0)):0;return l+(u.name===Le?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(ft(r)&&(r=r.call(this.hot),r===null||$t(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),r&&X(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&be(this.hotMenu.rootElement,[A8(),xu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Fa(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Fa(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&Fa(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}yt(Eh,Bn);function Jde(t,e){Zde(t,e),e.add(t)}function Zde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _b(t,e,n){return(e=Qde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qde(t){var e=efe(t,"string");return typeof e=="symbol"?e:e+""}function efe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jd="contextMenu",tfe=70,c1=jd;oe.getSingleton().register("afterContextMenuDefaultOptions");oe.getSingleton().register("beforeContextMenuShow");oe.getSingleton().register("afterContextMenuShow");oe.getSingleton().register("afterContextMenuHide");oe.getSingleton().register("afterContextMenuExecute");var dd=new WeakSet;class vy extends Je{constructor(){super(...arguments),Jde(this,dd),_b(this,"commandExecutor",new pF(this.hot)),_b(this,"itemsFactory",null),_b(this,"menu",null)}static get PLUGIN_KEY(){return jd}static get PLUGIN_PRIORITY(){return tfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[gy,my,Le,_g,xg,Le,fy,Ig,Le,py,dy,Le,Pg,Le,mi]}isEnabled(){return!!this.hot.getSettings()[jd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[jd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Eh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Vm(dd,this,rfe).call(this)),this.menu.addLocalHook("afterOpen",()=>Vm(dd,this,ife).call(this)),this.menu.addLocalHook("afterClose",()=>Vm(dd,this,ofe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Vm(dd,this,nfe).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=cy(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:c1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(c1)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;ke(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new wF(this.hot,vy.DEFAULT_ITEMS);const e=this.hot.getSettings()[jd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),P(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function nfe(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=cy(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function rfe(){this.hot.runHooks("beforeContextMenuShow",this)}function ife(){this.hot.runHooks("afterContextMenuShow",this)}function ofe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}vy.SEPARATOR={name:Le};function sfe(t){return{key:"copy",name(){return this.getTranslatedPhrase($T)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function afe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ge(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(VT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function lfe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ge(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(FT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ufe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ge(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(LT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function cfe(t){return{key:"cut",name(){return this.getTranslatedPhrase(BT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class hfe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class dfe{constructor(){this.clipboardData=new hfe}preventDefault(){}composedPath(){return[]}}function ffe(t,e){RF(t,e),e.add(t)}function rc(t,e,n){RF(t,e),e.set(t,n)}function RF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lr(t,e){return t.get(Nc(t,e))}function ic(t,e,n){return t.set(Nc(t,e),n),n}function Nc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var aa=new WeakMap,xb=new WeakMap,fd=new WeakMap,JR=new WeakMap,ZR=new WeakMap,gd=new WeakMap,md=new WeakSet;class gfe{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;ffe(this,md),rc(this,aa,void 0),rc(this,xb,void 0),rc(this,fd,void 0),rc(this,JR,void 0),rc(this,ZR,void 0),rc(this,gd,void 0),ic(xb,this,n),ic(fd,this,r),ic(JR,this,i),ic(ZR,this,o),ic(gd,this,s)}setSelectedRange(e){ic(aa,this,e)}getCellsRange(){if(lr(xb,this).call(this)===0||lr(fd,this).call(this)===0)return null;const{row:e,col:n}=lr(aa,this).getTopStartCorner(),{row:r,col:i}=lr(aa,this).getBottomEndCorner(),o=Nc(md,this,mfe).call(this,e,r),s=Nc(md,this,Pb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(lr(fd,this).call(this)===0||lr(gd,this).call(this)===0)return null;const{col:e}=lr(aa,this).getTopStartCorner(),{col:n}=lr(aa,this).getBottomEndCorner(),r=Nc(md,this,Pb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(lr(fd,this).call(this)===0||lr(gd,this).call(this)===0)return null;const{col:e}=lr(aa,this).getTopStartCorner(),{col:n}=lr(aa,this).getBottomEndCorner(),r=Nc(md,this,Pb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-lr(gd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Pb(t,e){return Math.min(e,Math.max(t+lr(ZR,this).call(this)-1,t))}function mfe(t,e){return Math.min(e,Math.max(t+lr(JR,this).call(this)-1,t))}function EF(t){const e=[],n=[];return P(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function pfe(t,e){TF(t,e),e.add(t)}function la(t,e,n){TF(t,e),e.set(t,n)}function TF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pd(t,e,n){return(e=wfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wfe(t){var e=vfe(t,"string");return typeof e=="symbol"?e:e+""}function vfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ir(t,e){return t.get(Ar(t,e))}function ji(t,e,n){return t.set(Ar(t,e),n),n}function Ar(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterCopyLimit");oe.getSingleton().register("modifyCopyableRange");oe.getSingleton().register("beforeCut");oe.getSingleton().register("afterCut");oe.getSingleton().register("beforePaste");oe.getSingleton().register("afterPaste");oe.getSingleton().register("beforeCopy");oe.getSingleton().register("afterCopy");const Ib="copyPaste",yfe=80,Cfe=["fragmentSelection"],h1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var QR=new WeakMap,e0=new WeakMap,t0=new WeakMap,oc=new WeakMap,Bm=new WeakMap,Wm=new WeakMap,sc=new WeakMap,zw=new WeakMap,Gr=new WeakSet;class bfe extends Je{constructor(){super(...arguments),pfe(this,Gr),pd(this,"columnsLimit",1/0),pd(this,"rowsLimit",1/0),pd(this,"pasteMode","overwrite"),pd(this,"uiContainer",this.hot.rootDocument.body),la(this,QR,!1),la(this,e0,!1),la(this,t0,!1),la(this,oc,"cells-only"),la(this,Bm,!1),la(this,Wm,!1),la(this,sc,new gfe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),la(this,zw,!1),pd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Ib}static get SETTING_KEYS(){return[Ib,...Cfe]}static get PLUGIN_PRIORITY(){return yfe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Ib]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),ji(QR,this,this.getSetting("copyColumnHeaders")),ji(e0,this,this.getSetting("copyColumnGroupHeaders")),ji(t0,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Ar(Gr,this,Efe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ar(Gr,r,Tfe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Ar(Gr,this,Mfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Nf()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ar(Gr,r,_fe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ar(Gr,r,xfe).call(r,...o)}),this.addHook("afterSelection",()=>Ar(Gr,this,Pfe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ji(oc,this,e),ji(Bm,this,!0),Ar(Gr,this,d1).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ji(Wm,this,!0),Ar(Gr,this,d1).call(this,"cut")}getRangedCopyableData(e){return ef(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=EF(e);return P(r,o=>{const s=[];P(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new dfe;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Ir(sc,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Ir(oc,this)==="column-headers-only"?n.set("headers",Ir(sc,this).getMostBottomColumnHeadersRange()):(Ir(oc,this)==="with-column-headers"?n.set("headers",Ir(sc,this).getMostBottomColumnHeadersRange()):Ir(oc,this)==="with-column-group-headers"&&n.set("headers",Ir(sc,this).getAllColumnHeadersRange()),n.set("cells",Ir(sc,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:w}=this.hot.getCellMeta(c,a);if(c=w+1,g===!0)continue;d=w,h=a;const C=[],R=o.length%r;for(;C.length<i||h<=u;){const{skipColumnOnPaste:y,visualCol:M}=this.hot.getCellMeta(s,h);if(h=M+1,y===!0)continue;f=M;const x=C.length%i;C.push(e[R][x])}o.push(C)}return ji(zw,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Ir(Bm,this)||this.isEditorOpened()||Yo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Xd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ji(Bm,this,!1);const o=this.getRangedData(this.copyableRanges),s=Ar(Gr,this,Sfe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=ef(o);if(e&&e.clipboardData){const u=PR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[h1,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}ji(oc,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Ir(Wm,this)||this.isEditorOpened()||Yo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Xd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ji(Wm,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=ef(o);if(e&&e.clipboardData){const l=PR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[h1,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Yo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Xd(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Fv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=p$(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Fie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function d1(t){if(Nf()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&Wk(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Sfe(t){const{rows:e}=EF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Rfe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&VE(r)}}}function MF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&BE(r)}}}function Efe(t){t.items.push({name:"---------"},sfe(this)),Ir(QR,this)&&t.items.push(ufe(this)),Ir(e0,this)&&t.items.push(lfe(this)),Ir(t0,this)&&t.items.push(afe(this)),t.items.push(cfe(this))}function Tfe(t,e,n,r,i){Ir(zw,this)&&(i.value=!0),ji(zw,this,!1)}function Mfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _fe(){Ar(Gr,this,MF).call(this)}function xfe(){Ar(Gr,this,Rfe).call(this)}function Pfe(){Ar(Gr,this,MF).call(this)}function _F(t,e){return`border_row${t}col${e}`}function Ud(){return{width:1,color:"#000"}}function ks(){return{hide:!0}}function Ife(){return{width:1,color:"#000",cornerVisible:!1}}function Ob(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function wd(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Ab(t,e){return{id:_F(t,e),border:Ife(),row:t,col:e,top:ks(),bottom:ks(),start:ks(),end:ks()}}function Ofe(t,e){return cn(e,"border")&&e.border&&(t.border=e.border),cn(e,"top")&&le(e.top)&&(e.top?(De(e.top)||(e.top=Ud()),t.top=e.top):(e.top=ks(),t.top=e.top)),cn(e,"bottom")&&le(e.bottom)&&(e.bottom?(De(e.bottom)||(e.bottom=Ud()),t.bottom=e.bottom):(e.bottom=ks(),t.bottom=e.bottom)),cn(e,"start")&&le(e.start)&&(e.start?(De(e.start)||(e.start=Ud()),t.start=e.start):(e.start=ks(),t.start=e.start)),cn(e,"end")&&le(e.end)&&(e.end?(De(e.end)||(e.end=Ud()),t.end=e.end):(e.end=ks(),t.end=e.end)),t}function zs(t,e){let n=!1;return P(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!cn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function yy(t){return`<span class="selected">✓</span>${t}`}function Afe(t){return t.some(e=>le(e.left)||le(e.right))}function Hfe(t){return t.some(e=>le(e.start)||le(e.end))}const Nfe=new Map([["left","start"],["right","end"]]);function Dfe(t){var e;return(e=Nfe.get(t))!==null&&e!==void 0?e:t}function kfe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(aM);return zs(this,"bottom")&&(e=yy(e)),e},callback(e,n){const r=zs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function $fe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(lM);return zs(this,e)&&(n=yy(n)),n},callback(n,r){const i=zs(this,e);t.prepareBorder(r,e,i)}}}function Lfe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(uM)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!zs(this)}}}function Ffe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(sM);return zs(this,e)&&(n=yy(n)),n},callback(n,r){const i=zs(this,e);t.prepareBorder(r,e,i)}}}function Vfe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(oM);return zs(this,"top")&&(e=yy(e)),e},callback(e,n){const r=zs(this,"top");t.prepareBorder(n,"top",r)}}}function Bfe(t,e){Wfe(t,e),e.add(t)}function Wfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jfe(t,e,n){return(e=Ufe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ufe(t){var e=zfe(t,"string");return typeof e=="symbol"?e:e+""}function zfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gp="customBorders",Yfe=90;var Hb=new WeakSet;class Gfe extends Je{constructor(){super(...arguments),Bfe(this,Hb),jfe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Gp}static get PLUGIN_PRIORITY(){return Yfe}isEnabled(){return!!this.hot.getSettings()[Gp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>f1(Hb,this,Kfe).call(this,e)),this.addHook("init",()=>f1(Hb,this,qfe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Ob(n));const o=nh(e),s=$f(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});P(e,a=>{s(a).forAll((l,u)=>{P(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Dfe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=nh(e),r=$f(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return P(e,o=>{r(o).forAll((s,a)=>{P(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(wd(l))})})}),i}clearBorders(e){e?this.setBorders(e):(P(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Ab(e,n);r&&(a=Ofe(a,r),P(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",wd(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=Ab(o,s);let l=0;o===e.from.row&&cn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&cn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&cn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&cn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",wd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=_F(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Ab(e,n):o=Ob(o),i?(o[r]=ks(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",wd(o)))):(o[r]=Ud(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",wd(o)))}prepareBorder(e,n,r){P(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){P(e,n=>{const r=Ob(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return En([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=ze(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){P(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){P(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=ze(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):P(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return P(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return P(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):P(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);P(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Gp];if(Array.isArray(e)){const n=tr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Afe(e),r=Hfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Kfe(t){this.hot.getSettings()[Gp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(iM)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Vfe(this),Ffe(this),kfe(this),$fe(this),Lfe(this)]}})}function qfe(){this.changeBorderSettings()}function Xfe(t,e){Jfe(t,e),e.add(t)}function Jfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nb(t,e,n){return(e=Zfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zfe(t){var e=Qfe(t,"string");return typeof e=="symbol"?e:e+""}function Qfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const m1="dragToScroll",ege=100;var Db=new WeakSet;class tge extends Je{constructor(){super(...arguments),Xfe(this,Db),Nb(this,"boundaries",null),Nb(this,"callback",null),Nb(this,"listening",!1)}static get PLUGIN_KEY(){return m1}static get PLUGIN_PRIORITY(){return ege}isEnabled(){return!!this.hot.getSettings()[m1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>g1(Db,this,p1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>g1(Db,this,p1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=hu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function p1(t){if(Ga(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function nge(t,e){xF(t,e),e.add(t)}function rge(t,e,n){xF(t,e),e.set(t,n)}function xF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kb(t,e,n){return(e=ige(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ige(t){var e=oge(t,"string");return typeof e=="symbol"?e:e+""}function oge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sge(t,e){return t.get(pi(t,e))}function PF(t,e,n){return t.set(pi(t,e),n),n}function pi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterDropdownMenuDefaultOptions");oe.getSingleton().register("beforeDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuHide");oe.getSingleton().register("afterDropdownMenuExecute");const Kp="dropdownMenu",age=230,Vf="changeType",$b=Kp;var Cy=new WeakMap,Yi=new WeakSet;class by extends Je{static get PLUGIN_KEY(){return Kp}static get PLUGIN_PRIORITY(){return age}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[_g,xg,Le,Ig,Le,hy,Le,Pg,Le,mi]}constructor(e){super(e),nge(this,Yi),kb(this,"commandExecutor",new pF(this.hot)),kb(this,"itemsFactory",null),kb(this,"menu",null),rge(this,Cy,!1),this.hot.addHook("afterGetColHeader",(n,r)=>pi(Yi,this,uge).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Kp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new wF(this.hot,by.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pi(Yi,e,mge).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pi(Yi,e,gge).call(e,...o)});const n=this.hot.getSettings()[Kp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Eh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>pi(Yi,this,cge).call(this)),this.menu.addLocalHook("afterOpen",()=>pi(Yi,this,hge).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>pi(Yi,this,dge).call(this,o)),this.menu.addLocalHook("afterClose",()=>pi(Yi,this,fge).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),P(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=cy(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Vf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:$b},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:$b}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($b)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>pi(Yi,this,lge).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function IF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function lge(t){if(ve(t.target,Vf)){const e=cy(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),PF(Cy,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function uge(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Vf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Vf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(be(s,[Pu(),Pf(" ")]),be(e,[Mk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function cge(){this.hot.runHooks("beforeDropdownMenuShow",this)}function hge(){this.hot.runHooks("afterDropdownMenuShow",this),pi(Yi,this,IF).call(this,this.menu)}function dge(t){pi(Yi,this,IF).call(this,t)}function fge(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function gge(t){return sge(Cy,this)?null:t}function mge(t){ve(t.target,Vf)&&PF(Cy,this,!0)}by.SEPARATOR={name:Le};function w1(t,e,n){return(e=pge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pge(t){var e=wge(t,"string");return typeof e=="symbol"?e:e+""}function wge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vge{constructor(e){w1(this,"hot",void 0),w1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function v1(t,e,n){return(e=yge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yge(t){var e=Cge(t,"string");return typeof e=="symbol"?e:e+""}function Cge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){v1(this,"dataProvider",void 0),v1(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=so(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=dn(so(S_.DEFAULT_OPTIONS),n),n=dn(n,e),n.filename=PE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function bge(t,e){Sge(t,e),e.add(t)}function Sge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OF="\r",Rge='"',Ege=`
`,Tge="=",Mge="+",_ge="-",xge="@",Pge="	";var Lb=new WeakSet;class Ige extends S_{constructor(){super(...arguments),bge(this,Lb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=ze(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),P(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Pt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=y1(Lb,this,Age).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=y1(Lb,this,Oge).call(this,i)),(n||i.indexOf(OF)>=0||i.indexOf(Rge)>=0||i.indexOf(Ege)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Oge(t){return t.startsWith(Tge)||t.startsWith(Mge)||t.startsWith(_ge)||t.startsWith(xge)||t.startsWith(Pge)||t.startsWith(OF)?`'${t}`:t}function Age(t,e){return e.test(t)?`'${t}`:t}const Hge="csv",n0={[Hge]:Ige};function Nge(t,e,n){return typeof n0[t]=="function"?new n0[t](e,n):null}const Dge="exportFile",kge=240;class $ge extends Je{static get PLUGIN_KEY(){return Dge}static get PLUGIN_PRIORITY(){return kge}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!n0[e])throw new Error(`Export format type "${e}" is not supported.`);return Nge(e,new vge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function ac(t,e,n){return(e=Lge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lge(t){var e=Fge(t,"string");return typeof e=="symbol"?e:e+""}function Fge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Og{constructor(e,n){let{id:r,stateless:i=!0}=n;ac(this,"hot",void 0),ac(this,"id",void 0),ac(this,"elements",[]),ac(this,"hidden",!1),ac(this,"stateId",""),ac(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new ey)}getElements(){return this.elements}reset(){P(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),P(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}yt(Og,Bn);const Bf={};function Ka(t,e){if(!Bf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Bf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function eu(t){if(!Bf[t])throw Error(`Filter condition "${t}" does not exist.`);return Bf[t].descriptor}function mn(t,e,n){n.key=t,Bf[t]={condition:e,descriptor:n}}const Nn="none";function Vge(){return!0}mn(Nn,Vge,{name:ty,inputsCount:0,showOperators:!1});const rf="empty";function Bge(t){return qt(t.value)}mn(rf,Bge,{name:pM,inputsCount:0,showOperators:!0});const qp="not_empty";function Wge(t,e){return!Ka(rf,e)(t)}mn(qp,Wge,{name:wM,inputsCount:0,showOperators:!0});const of="eq";function jge(t,e){let[n]=e;return Pt(t.value).toLocaleLowerCase(t.meta.locale)===Pt(n)}mn(of,jge,{name:vM,inputsCount:1,showOperators:!0});const Xp="neq";function Uge(t,e){return!Ka(of,e)(t)}mn(Xp,Uge,{name:yM,inputsCount:1,showOperators:!0});const AF="gt";function zge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}mn(AF,zge,{name:EM,inputsCount:1,showOperators:!0});const HF="gte";function Yge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}mn(HF,Yge,{name:TM,inputsCount:1,showOperators:!0});const NF="lt";function Gge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}mn(NF,Gge,{name:MM,inputsCount:1,showOperators:!0});const DF="lte";function Kge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}mn(DF,Kge,{name:_M,inputsCount:1,showOperators:!0});const R_="date_after";function qge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}mn(R_,qge,{name:IM,inputsCount:1,showOperators:!0});const E_="date_before";function Xge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}mn(E_,Xge,{name:OM,inputsCount:1,showOperators:!0});const Yw="between";function Jge(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Ka(E_,[o]),a=Ka(R_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}mn(Yw,Jge,{name:xM,inputsCount:2,showOperators:!0});const kF="not_between";function Zge(t,e){return!Ka(Yw,e)(t)}mn(kF,Zge,{name:PM,inputsCount:2,showOperators:!0});const $F="begins_with";function Qge(t,e){let[n]=e;return Pt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Pt(n))}mn($F,Qge,{name:CM,inputsCount:1,showOperators:!0});const LF="ends_with";function eme(t,e){let[n]=e;return Pt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Pt(n))}mn(LF,eme,{name:bM,inputsCount:1,showOperators:!0});const T_="contains";function tme(t,e){let[n]=e;return Pt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Pt(n))>=0}mn(T_,tme,{name:SM,inputsCount:1,showOperators:!0});const FF="not_contains";function nme(t,e){return!Ka(T_,e)(t)}mn(FF,nme,{name:RM,inputsCount:1,showOperators:!0});const VF="date_tomorrow";function rme(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}mn(VF,rme,{name:HM,inputsCount:0});const BF="date_today";function ime(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}mn(BF,ime,{name:AM,inputsCount:0});const WF="date_yesterday";function ome(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}mn(WF,ome,{name:NM,inputsCount:0});Zk();function sme(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Ag(t){const e=new Set(t);return function(n){return e.has(n)}}function M_(t){return t??""}function r0(t){return Array.from(new Set(t)).map(e=>M_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function C1(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Ag(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:sme(a,n)};r&&r(u),i.push(u)}),i}const tu="by_value";function ame(t,e){let[n]=e;return n(t.value)}mn(tu,ame,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Ag(e)]},showOperators:!1});const Wf={};function lme(t){if(!Wf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Wf[t].func;return function(n,r){return e(n,r)}}function ume(t){return Wf[t].name}function __(t,e,n){Wf[t]={name:e,func:n}}const Wa="conjunction",cme=$M;function hme(t,e){return t.every(n=>n.func(e))}__(Wa,cme,hme);const Gw="disjunction",dme=ny;function fme(t,e){return t.some(n=>n.func(e))}__(Gw,dme,fme);const x_="disjunctionWithExtraCondition",gme=ny;function mme(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}__(x_,gme,mme);const pme="numeric",jF="text",wme="date",b1={[pme]:[Nn,Le,rf,qp,Le,of,Xp,Le,AF,HF,NF,DF,Yw,kF],[jF]:[Nn,Le,rf,qp,Le,of,Xp,Le,$F,LF,Le,T_,FF],[wme]:[Nn,Le,rf,qp,Le,of,Xp,Le,E_,R_,Yw,Le,VF,BF,WF]};function vme(t){const e=[];let n=t;return b1[n]||(n=jF),P(b1[n],r=>{let i;r===Le?i={name:Le}:i=so(eu(r)),e.push(i)}),e}function vd(t,e,n){return(e=yme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yme(t){var e=Cme(t,"string");return typeof e=="symbol"?e:e+""}function Cme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Fb="built",Vb="building",S1=["click","input","keydown","keypress","keyup","focus","blur","change"];let ro=class UF{static get DEFAULTS(){return so({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){vd(this,"hot",void 0),vd(this,"eventManager",new Mi(this)),vd(this,"options",void 0),vd(this,"_element",void 0),vd(this,"buildState",void 0),this.hot=e,this.options=dn(UF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Vb?this._element:this.buildState===Fb?(this.update(),this._element):(this.buildState=Vb,this.build(),this.buildState=Fb,this._element)}isBuilt(){return this.buildState===Fb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(pr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Vb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&X(this._element,this.options.className),this.options.children.length)P(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),ke(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),P(S1,r=>e(n,r))}else P(S1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};yt(ro,Bn);function bme(t,e){zF(t,e),e.add(t)}function Sme(t,e,n){zF(t,e),e.set(t,n)}function zF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jm(t,e){return t.get(P_(t,e))}function Rme(t,e,n){return t.set(P_(t,e),n),n}function P_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lc=new WeakMap,R1=new WeakSet;class ja extends ro{static get DEFAULTS(){return so({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,dn(ja.DEFAULTS,n)),bme(this,R1),Sme(this,lc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>P_(R1,this,Eme).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Rme(lc,this,this._element.firstChild),X(this._element,"htUIInput"),X(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(jm(lc,this).type=this.options.type,jm(lc,this).placeholder=this.translateIfPossible(this.options.placeholder),jm(lc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&jm(lc,this).focus()}}function Eme(t){this.options.value=t.target.value}function Tme(t,e){YF(t,e),e.add(t)}function yd(t,e,n){YF(t,e),e.set(t,n)}function YF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uc(t,e,n){return t.set(sf(t,e),n),n}function Wt(t,e){return t.get(sf(t,e))}function sf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tn=new WeakMap,Um=new WeakMap,zm=new WeakMap,Bb=new WeakMap,Ym=new WeakMap,Gm=new WeakSet;class jf extends ro{static get DEFAULTS(){return so({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,dn(jf.DEFAULTS,n)),Tme(this,Gm),yd(this,Tn,null),yd(this,Um,[]),yd(this,zm,void 0),yd(this,Bb,void 0),yd(this,Ym,void 0),this.registerHooks()}getMenu(){return Wt(Tn,this)}registerHooks(){this.addLocalHook("click",()=>sf(Gm,this,xme).call(this))}setItems(e){uc(Um,this,this.translateNames(e)),Wt(Tn,this)&&Wt(Tn,this).setMenuItems(Wt(Um,this))}translateNames(e){return P(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),uc(Tn,this,new Eh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Wt(Tn,this).setMenuItems(Wt(Um,this));const e=new ro(this.hot,{className:"htUISelectCaption"}),n=new ro(this.hot,{className:"htUISelectDropdown"});uc(zm,this,e),uc(Bb,this,e.element),uc(Ym,this,n),this.hot.getSettings().ariaTags&&(be(n.element,[Pu()]),be(this._element,[Tk()])),P([e,n],r=>this._element.appendChild(r.element)),Wt(Tn,this).addLocalHook("select",r=>sf(Gm,this,Mme).call(this,r)),Wt(Tn,this).addLocalHook("afterClose",()=>sf(Gm,this,_me).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Wt(Tn,this).hot.getTranslatedPhrase(ty),Wt(Bb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Wt(Tn,this)&&(Wt(Tn,this).open(),Wt(Tn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Wt(Tn,this).getNavigator().toFirstItem(),Wt(Tn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Wt(Tn,this)&&Wt(Tn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Wt(Tn,this)&&(Wt(Tn,this).destroy(),uc(Tn,this,null)),Wt(zm,this)&&Wt(zm,this).destroy(),Wt(Ym,this)&&Wt(Ym,this).destroy(),super.destroy()}}function Mme(t){t.name!==Le&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function _me(){this.runLocalHooks("afterClose")}function xme(){this.openOptions()}function Pme(t,e){Ime(t,e),e.add(t)}function Ime(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function E1(t,e,n){return(e=Ome(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ome(t){var e=Ame(t,"string");return typeof e=="symbol"?e:e+""}function Ame(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wb=new WeakSet;class i0 extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),Pme(this,Wb),E1(this,"name",""),E1(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new jf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ja(this.hot,{placeholder:jM})),this.elements.push(new ja(this.hot,{placeholder:UM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>T1(Wb,this,Hme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),P(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>T1(Wb,this,Nme).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=so(e.command);n.name.startsWith(Xt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),P(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||eu(Nn),n=[];return P(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=eu(e?e.name:Nn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||P(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof jf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ja)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&X(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[eu(Nn)];if(e!==null){const{visualIndex:r}=e;n=vme(this.hot.getDataType(0,r,this.hot.countRows(),r))}P(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Hme(t){P(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Nme(t){yh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ai(t))}function M1(t,e,n){Dme(t,e),e.set(t,n)}function Dme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cd(t,e){return t.get(GF(t,e))}function _1(t,e,n){return t.set(GF(t,e),n),n}function GF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cc=new WeakMap,jb=new WeakMap;class Kw extends ro{static get DEFAULTS(){return so({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,dn(Kw.DEFAULTS,n)),M1(this,cc,void 0),M1(this,jb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_1(jb,this,e),_1(cc,this,this._element.firstChild),Cd(cc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Cd(jb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Cd(cc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Cd(cc,this).checked=e)}focus(){this.isBuilt()&&Cd(cc,this).focus()}}function kme(t,e){$me(t,e),e.add(t)}function $me(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lme(t,e,n){return(e=Fme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fme(t){var e=Vme(t,"string");return typeof e=="symbol"?e:e+""}function Vme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const x1=0;var P1=new WeakSet;class Wme extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),kme(this,P1),Lme(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuOperators"),P(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Wa,Gw];P(e,n=>{const r=new Kw(this.hot,{name:"operator",label:{htmlFor:n,textContent:ume(n)},value:n,checked:n===e[x1],id:n});r.addLocalHook("change",i=>Bme(P1,this,jme).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(mt`Radio button with index ${e} doesn't exist.`);P(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Kw&&n.isChecked());return e?e.getValue():Wa}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&P(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Wa,n=arguments.length>1?arguments[1]:void 0,r=e;r===x_&&(r=Gw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(x1)}}function jme(t){this.setState(t.target.value)}function Ume(t,e,n){zme(t,e),e.set(t,n)}function zme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ub(t,e){return t.get(KF(t,e))}function Yme(t,e,n){return t.set(KF(t,e),n),n}function KF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bd=new WeakMap;class Uf extends ro{static get DEFAULTS(){return so({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,dn(Uf.DEFAULTS,n)),Ume(this,bd,void 0)}build(){super.build(),Yme(bd,this,this._element.firstChild)}update(){this.isBuilt()&&(Ub(bd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Ub(bd,this).focus()}activate(){Ub(bd,this).click()}}function Gme(t,e){qF(t,e),e.add(t)}function hc(t,e,n){qF(t,e),e.set(t,n)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get(Dc(t,e))}function Fi(t,e,n){return t.set(Dc(t,e),n),n}function Dc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const I1="multipleSelect.itemBox";var Gi=new WeakMap,Qt=new WeakMap,zb=new WeakMap,ps=new WeakMap,ua=new WeakMap,ca=new WeakMap,Sd=new WeakSet;class zf extends ro{static get DEFAULTS(){return so({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,dn(zf.DEFAULTS,n)),Gme(this,Sd),hc(this,Gi,[]),hc(this,Qt,void 0),hc(this,zb,void 0),hc(this,ps,void 0),hc(this,ua,void 0),hc(this,ca,void 0),Fi(ps,this,new ja(this.hot,{placeholder:WM,className:"htUIMultipleSelectSearch"})),Fi(ua,this,new Uf(this.hot,{textContent:LM,className:"htUISelectAll"})),Fi(ca,this,new Uf(this.hot,{textContent:FM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Pe(Qt,this)}registerHooks(){Pe(ps,this).addLocalHook("keydown",e=>Dc(Sd,this,qme).call(this,e)),Pe(ps,this).addLocalHook("input",e=>Dc(Sd,this,Kme).call(this,e)),Pe(ua,this).addLocalHook("click",e=>Dc(Sd,this,Xme).call(this,e)),Pe(ca,this).addLocalHook("click",e=>Dc(Sd,this,Jme).call(this,e))}setItems(e){var n;Fi(Gi,this,e),(n=Pe(Qt,this))===null||n===void 0||n.loadData(Pe(Gi,this))}setLocale(e){Fi(zb,this,e)}getLocale(){return Pe(zb,this)}getItems(){return[...Pe(Gi,this)]}getValue(){return Qme(Pe(Gi,this))}getSearchInputElement(){return Pe(ps,this)}getSelectAllElement(){return Pe(ua,this)}getClearAllElement(){return Pe(ca,this)}isSelectedAllValues(){return Pe(Gi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new ro(this.hot,{className:"htUISelectionControls",children:[Pe(ua,this),Pe(ca,this)]});this._element.appendChild(Pe(ps,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Pe(Qt,this))===null||s===void 0||s.destroy(),X(o,"htUIMultipleSelectHot"),Fi(Qt,this,new this.hot.constructor(o,{data:Pe(Gi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Pe(Qt,this).listen()},modifyColWidth:u=>{const c=Pe(Qt,this).container.scrollWidth-Pn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Pe(Qt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Pe(Qt,this).useTheme(u)});const l=Pe(Qt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:I1}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Pe(Qt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:I1})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Pe(Qt,this).listen()}reset(){Pe(ps,this).reset(),Pe(ua,this).reset(),Pe(ca,this).reset()}update(){this.isBuilt()&&(Pe(Qt,this).loadData(Zme(Pe(Gi,this),this.options.value)),super.update())}destroy(){var e;(e=Pe(Qt,this))===null||e===void 0||e.destroy(),Pe(ps,this).destroy(),Pe(ca,this).destroy(),Pe(ua,this).destroy(),Fi(ps,this,null),Fi(ca,this,null),Fi(ua,this,null),Fi(Qt,this,null),Fi(Gi,this,null),super.destroy()}}function Kme(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Pe(Gi,this)]:n=Pe(Gi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Pe(Qt,this).loadData(n)}function qme(t){this.runLocalHooks("keydown",t,this),WE(yh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ai(t),Pe(Qt,this).listen(),Pe(Qt,this).selectCell(0,0))}function Xme(t){const e=[];t.preventDefault(),Pe(Qt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(yT(n,r)[0])}),Pe(Qt,this).setSourceDataAtCell(e)}function Jme(t){const e=[];t.preventDefault(),Pe(Qt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(yT(n,r)[0])}),Pe(Qt,this).setSourceDataAtCell(e)}function Zme(t,e){const n=Ag(e);return t.map(r=>(r.checked=n(r.value),r))}function Qme(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function epe(t,e){tpe(t,e),e.add(t)}function tpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function npe(t,e,n){return(e=rpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rpe(t){var e=ipe(t,"string");return typeof e=="symbol"?e:e+""}function ipe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Km(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rd=new WeakSet;class ope extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),epe(this,Rd),npe(this,"name",""),this.name=n.name,this.elements.push(new zf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Km(Rd,this,spe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Km(Rd,this,ape).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===tu){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Nn:tu},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Ua(i,h=>h.name===tu),u={},c=this.hot.getTranslatedPhrase(Aw);if(l){const h=s(r,a),d=ze(h,y=>y.value),f=new Map(h.map(y=>[y.value,this.hot.getCellMeta(y.meta.visualRow,y.meta.visualCol)])),g=r0(d);o&&(l.args[0]=o);const w=[],C=C1(g,l.args[0],c,y=>{y.checked&&w.push(y.value),Km(Rd,this,O1).call(this,y,f)}),R=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,R).locale,u.args=[w],u.command=eu(tu),u.itemsSnapshot=C}else u.args=[],u.command=eu(Nn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof zf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Aw),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=r0(r),s=C1(o,o,e,l=>{Km(Rd,this,O1).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:ze(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:M_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function spe(t){yh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ai(t))}function O1(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function ape(t,e){switch(e.type){case"numeric":return $L(t,e);default:return t}}var XF;function lpe(t,e){upe(t,e),e.add(t)}function upe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cpe(t,e,n){return(e=hpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hpe(t){var e=dpe(t,"string");return typeof e=="symbol"?e:e+""}function dpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fpe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var A1=new WeakSet;class Yf extends Og{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),lpe(this,A1),cpe(this,"name",""),this.name=n.name,this.elements.push(new ja(this.hot,{type:"button",value:VM,className:"htUIButton htUIButtonOK",identifier:Yf.BUTTON_OK})),this.elements.push(new ja(this.hot,{type:"button",value:BM,className:"htUIButton htUIButtonCancel",identifier:Yf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){P(this.elements,e=>{e.addLocalHook("click",(n,r)=>fpe(A1,this,gpe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuActionBar"),P(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}XF=Yf;function gpe(t,e){e.options.identifier===XF.BUTTON_OK?this.accept():this.cancel()}function Yb(t,e,n){return(e=mpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mpe(t){var e=ppe(t,"string");return typeof e=="symbol"?e:e+""}function ppe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const H1="ConditionCollection.filteringStates";class I_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Yb(this,"hot",void 0),Yb(this,"isMapRegistrable",void 0),Yb(this,"filteringStates",new ey),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(H1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wa;return e.length?lme(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wa,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(mt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if($t(Wf[r]))throw new Error(mt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Ka(a,s)}]},i):u.push({name:a,args:s,func:Ka(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(H1),this.filteringStates=null,this.clearLocalHooks()}}yt(I_,Bn);function N1(t,e,n){return(e=wpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wpe(t){var e=vpe(t,"string");return typeof e=="symbol"?e:e+""}function vpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];N1(this,"conditionCollection",void 0),N1(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return P(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return P(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return P(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function ype(t,e){Cpe(t,e),e.add(t)}function Cpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tl(t,e,n){return(e=bpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bpe(t){var e=Spe(t,"string");return typeof e=="symbol"?e:e+""}function Spe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qm=new WeakSet;class ZF{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];ype(this,qm),Tl(this,"hot",void 0),Tl(this,"conditionCollection",void 0),Tl(this,"columnDataFactory",void 0),Tl(this,"changes",[]),Tl(this,"grouping",!1),Tl(this,"latestEditedColumnPosition",-1),Tl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Gb(qm,this,Rpe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Gb(qm,this,Epe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Gb(qm,this,Tpe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,P(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=Uk(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new I_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const w=r.columnDataFactory(h);let C;f.isEmpty()?C=w:C=new JF(f,y=>r.columnDataFactory(y)).filter(),C=ze(C,y=>y.meta.visualRow);const R=Ag(C);return f.destroy(),Ua(w,y=>R(y.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),ke(this,(e,n)=>{this[n]=null})}}function Rpe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Epe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Tpe(){P(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}yt(ZF,Bn);function Mpe(t){return yF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof zf)return r;if(i.element&&!du(i.element))return!1;i.focus()}})}const Ed="filters";function _pe(t,e){let n=-1,r;const i=Mpe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Ed),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof ro&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Ed),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Ed)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const w=r.getNavigator();w.getCurrentPage()>-1&&(n=w.getCurrentPage()),w.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const w=e[i.getCurrentPage()];w instanceof jf&&(w.openOptions(),g.preventDefault()),w instanceof Uf&&(w.activate(),g.preventDefault()),w instanceof ro||g.preventDefault()}}],Ed)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Ed)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function xpe(t,e){QF(t,e),e.add(t)}function Kb(t,e,n){QF(t,e),e.set(t,n)}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Td(t,e,n){return(e=Ppe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ppe(t){var e=Ipe(t,"string");return typeof e=="symbol"?e:e+""}function Ipe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jp(t,e,n){return t.set(Mr(t,e),n),n}function wi(t,e){return t.get(Mr(t,e))}function Mr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const o0="filters",Ope=250,D1=o0;var Ss=new WeakMap,s0=new WeakMap,Xl=new WeakMap,Vr=new WeakSet;class Ape extends Je{static get PLUGIN_KEY(){return o0}static get PLUGIN_PRIORITY(){return Ope}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,xpe(this,Vr),Td(this,"dropdownMenuPlugin",null),Td(this,"conditionCollection",null),Td(this,"conditionUpdateObserver",null),Td(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Td(this,"filtersRowsMap",null),Kb(this,Ss,void 0),Kb(this,s0,new WeakSet),Kb(this,Xl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Mr(Vr,n,Fpe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[o0]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Sg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>Mr(Vr,this,k1).call(this,"accept")),a.addLocalHook("cancel",()=>Mr(Vr,this,k1).call(this,"cancel")),a.addLocalHook("change",l=>Mr(Vr,this,Lpe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(DM)}:`,s=()=>`${this.hot.getTranslatedPhrase(kM)}:`;if(!this.components.get("filter_by_condition")){const a=new i0(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Mr(Vr,this,$1).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Wme(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new i0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Mr(Vr,this,$1).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new ope(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Yf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new I_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ZF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Mr(Vr,this,Vpe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Mr(Vr,e,$pe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Mr(Vr,this,kpe).call(this)),this.addHook("afterDropdownMenuShow",()=>Mr(Vr,this,Npe).call(this)),this.addHook("afterDropdownMenuHide",()=>Mr(Vr,this,Dpe).call(this)),this.addHook("afterChange",a=>Mr(Vr,this,Hpe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!wi(Ss,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=wi(Ss,this).getMenu(),c=u.getNavigator(),h=wi(Ss,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Jp(Ss,this,_pe(this.dropdownMenuPlugin.menu,a));const l=u=>{wi(Ss,this).listen(),u.preventDefault(),yh(u.keyCode,"TAB")&&(u.shiftKey?wi(Ss,this).toPreviousItem():wi(Ss,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:D1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(D1)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Wa;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,wi(Xl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=ze(n.filter(),u=>u.meta.visualRow);const l=Ag(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),P(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Jp(Xl,this,this.exportConditions())}else s!==!1&&!r?(Jp(Xl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(wi(Xl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return P(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:M_(w)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=r0(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Gw&&n.command.key!==Nn&&r.command.key!==Nn&&i.command.key!==Nn?o=x_:i.command.key!==Nn&&(n.command.key===Nn||r.command.key===Nn)&&(o=Wa),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new JF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return P(i,s=>{P(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Hpe(t){t&&P(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Npe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Dpe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function kpe(){const t=this.dropdownMenuPlugin.menu;wi(s0,this).has(t)||wi(Ss,this).setMenu(t),wi(s0,this).add(t)}function $pe(t){t.items.push({name:Le}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function k1(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==Nn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==Nn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Nn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Lpe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===i0&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function $1(){this.setListeningDropdownMenu()}function Fpe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?X(e,"htFiltersActive"):we(e,"htFiltersActive")}function Vpe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Jp(Xl,this,wi(Xl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===tu),s=n.filter(a=>a.name!==tu);if(o.length>=2||s.length>=3)ot(mt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const eV="internal-use-in-handsontable",a0={licenseKey:eV,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function tV(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Xn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function nV(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Bpe(t){var e;const n=t[Xn],r=nV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=tV(t);return{...a0,...r,...i}}function Wpe(t){var e;const n=t[Xn],r=nV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=tV(t);return{...r,...i}}function jpe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Sy(){const t="engine_relationship",e=uo(Xn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function O_(){const t="shared_engine_usage",e=uo(Xn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Upe(t){const e=t.getSettings(),n=e[Xn],r=n==null?void 0:n.engine;if(n===!0||$t(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return zpe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&$t(r.hyperformula)){const o=Sy(),s=O_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:eV}),(r.getConfig().leapYear1900!==a0.leapYear1900||zv(r.getConfig().nullDate,a0.nullDate)===!1)&&ot(mt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function zpe(t,e,n){const r=e[Xn],i=Bpe(e),o=Sy(),s=O_();Ype(t,r.functions),Gpe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Kpe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function L1(t){var e;const n=Sy(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function F1(t,e){if(t){const n=Sy(),r=n.get(t),i=O_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Ype(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){ot(s.message)}})}function Gpe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){ot(r.message)}}}function Kpe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){ot(a.message)}}),t.resumeEvaluation())}function qpe(t,e){return($t(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const rV="DD/MM/YYYY";function Xpe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Jpe(t){return Xpe(t)?t.substr(1):t}function Zpe(t){return typeof t=="string"&&t.startsWith("=")}function A_(t,e){return typeof t=="string"&&e==="date"}function iV(t,e){return Z(t,e,!0).isValid()}function oV(t,e){return Z(t,e,!0).format(rV)}function Qpe(t,e){return Z(t,rV,!0).format(e)}function sV(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function ewe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function twe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function nwe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function H_(t,e,n){const r=twe(t,ewe(t,e,n));return nwe(r)}function Ml(t,e,n){rwe(t,e),e.set(t,n)}function rwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(t,e){return t.get(aV(t,e))}function ha(t,e,n){return t.set(aV(t,e),n),n}function aV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Md=new WeakMap,da=new WeakMap,Br=new WeakMap,Xm=new WeakMap,qb=new WeakMap,Xb=new WeakMap,Jm=new WeakMap;class V1{constructor(e,n,r){Ml(this,Md,void 0),Ml(this,da,void 0),Ml(this,Br,void 0),Ml(this,Xm,[]),Ml(this,qb,[]),Ml(this,Xb,void 0),Ml(this,Jm,[]),ha(Md,this,e),ha(da,this,n),ha(Br,this,r)}setRemovedHfIndexes(e){return ha(Jm,this,e.map(n=>{const r=Dt(da,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Dt(Jm,this)}getRemovedHfIndexes(){return Dt(Jm,this)}getHfIndexFromVisualIndex(e){const n=Dt(da,this).getIndexesSequence(),r=Dt(da,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${er(Dt(Md,this))}s`;Dt(Br,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Dt(Br,this).getEngine()[r](Dt(Br,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ha(qb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),ha(Xb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Dt(Br,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=H_(Dt(qb,this),Dt(Xb,this),Dt(da,this).getNumberOfIndexes());Dt(Br,this).getSheetId()===null?Dt(Br,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${er(Dt(Md,this))}Order`;return n=>{if(Dt(Br,this).isPerformingUndoRedo())return;const r=Dt(da,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Dt(Xm,this).map(l=>r.indexOf(l)),o=Dt(Br,this).getEngine().getSheetDimensions(Dt(Br,this).getSheetId());let s;Dt(Md,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Dt(Br,this).getEngine()[e](Dt(Br,this).getSheetId(),i)}ha(Xm,this,r)}}init(){ha(Xm,this,Dt(da,this).getIndexesSequence())}}function _l(t,e,n){iwe(t,e),e.set(t,n)}function iwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ws(t,e){return t.get(lV(t,e))}function xl(t,e,n){return t.set(lV(t,e),n),n}function lV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zm=new WeakMap,Qm=new WeakMap,Jb=new WeakMap,Zb=new WeakMap,Qb=new WeakMap,eS=new WeakMap,tS=new WeakMap;class owe{constructor(e,n,r){_l(this,Zm,void 0),_l(this,Qm,void 0),_l(this,Jb,void 0),_l(this,Zb,!1),_l(this,Qb,!1),_l(this,eS,null),_l(this,tS,null),xl(Zm,this,new V1("row",e,this)),xl(Qm,this,new V1("column",n,this)),xl(Jb,this,r)}getForAxis(e){return e==="row"?ws(Zm,this):ws(Qm,this)}setPerformUndo(e){xl(Zb,this,e)}setPerformRedo(e){xl(Qb,this,e)}isPerformingUndoRedo(){return ws(Zb,this)||ws(Qb,this)}getSheetId(){return ws(tS,this)}getEngine(){return ws(eS,this)}getPostponeAction(){return ws(Jb,this)}setupSyncEndpoint(e,n){xl(eS,this,e),xl(tS,this,n),ws(Zm,this).init(),ws(Qm,this).init()}}function swe(t,e){uV(t,e),e.add(t)}function Pl(t,e,n){return(e=awe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function awe(t){var e=lwe(t,"string");return typeof e=="symbol"?e:e+""}function lwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nS(t,e,n){uV(t,e),e.set(t,n)}function uV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qa(t,e,n){return t.set(Ze(t,e),n),n}function ou(t,e){return t.get(Ze(t,e))}function Ze(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xn="formulas",uwe=["maxRows","maxColumns","language"],cwe=260;oe.getSingleton().register("afterNamedExpressionAdded");oe.getSingleton().register("afterNamedExpressionRemoved");oe.getSingleton().register("afterSheetAdded");oe.getSingleton().register("afterSheetRemoved");oe.getSingleton().register("afterSheetRenamed");oe.getSingleton().register("afterFormulasValuesUpdate");const Th=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Ys=new WeakMap,Ry=new WeakMap,_d=new WeakMap,nt=new WeakSet;class hwe extends Je{constructor(){var e;super(...arguments),e=this,swe(this,nt),nS(this,Ys,!1),nS(this,Ry,!1),nS(this,_d,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ze(nt,e,_we).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ze(nt,e,xwe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ze(nt,e,Pwe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ze(nt,e,Iwe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ze(nt,e,Owe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ze(nt,e,Awe).call(e,...r)}]]),Pl(this,"staticRegister",uo("formulas")),Pl(this,"engine",null),Pl(this,"sheetId",null),Pl(this,"sheetName",null),Pl(this,"indexSyncer",null),Pl(this,"rowAxisSyncer",null),Pl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Xn}static get PLUGIN_PRIORITY(){return cwe}static get SETTING_KEYS(){return[Xn,...uwe]}isEnabled(){return!!this.hot.getSettings()[Xn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Upe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){ot("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Ze(nt,this,af).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,B1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,W1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,B1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,W1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,mwe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,pwe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,dwe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,wwe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,j1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,j1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,vwe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,ywe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,Swe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,Rwe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,Cwe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,bwe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,Ewe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,Twe).call(n,...i)}),this.indexSyncer=new owe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,gwe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,Mwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ze(nt,n,fwe).call(n,...i)}),ou(_d,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){ou(_d,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),F1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Wpe(this.hot.getSettings());jpe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Xn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Xn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Ze(nt,this,af).call(this,o)}}super.updatePlugin(e)}destroy(){ou(_d,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),qa(_d,this,null),F1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!j$(n))return ot("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return ot("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return ot(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){KE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Ze(nt,this,af).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${er(Xn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),L1(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=L1(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){ot(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return A_(r,o.type)&&(iV(r,o.dateFormat)?r=oV(r,o.dateFormat):Zpe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function af(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function dwe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&qn(s)&&(s=sV(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function fwe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:w}=h.start,{row:C,col:R}=h.end,y=C-g+1,M=R-w+1;for(let x=0;x<f.length;x+=1)for(let _=0;_<f[x].length;_+=1){const T=f[x][_],I=g+x%y,Y=w+_%M,U=this.hot.getCellMeta(I,Y);A_(T,U.type)&&(T.startsWith("'")?f[x][_]=T.slice(1):this.isFormulaCellType(I,Y,this.sheetId)===!1&&(f[x][_]=Qpe(T,U.dateFormat)))}return f}function B1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(er(Xn))||qa(Ry,this,$t(this.hot.getSettings().data))}function gwe(){if(ou(Ry,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;A_(i,s.type)&&(iV(i,a)?t[r][o]=oV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),qa(Ys,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),qa(Ys,this,!1)}function W1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(er(Xn)))return;const r=qpe(this.engine,this.hot.getSettings()[Xn].sheetName);if(Ze(nt,this,af).call(this,r),n!=="updateSettings")if(ou(Ry,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){qa(Ys,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),qa(Ys,this,!1)}}}function mwe(t,e,n,r){if(r!=="get"||ou(Ys,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=Jpe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&qn(a)&&(a=sV(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function pwe(t,e,n,r){if(r!=="get"||ou(Ys,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function j1(t,e){if(Th(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function wwe(t,e){if(Th(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!qn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){ot(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function vwe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function ywe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Cwe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function bwe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Swe(t,e,n){if(Th(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Rwe(t,e,n){if(Th(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Ewe(t,e,n,r){if(Th(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Twe(t,e,n,r){if(Th(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Mwe(t,e,n){var r;qa(Ys,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());qa(Ys,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function _we(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function xwe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Pwe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Iwe(t){this.hot.runHooks("afterSheetAdded",t)}function Owe(t,e){Ze(nt,this,af).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Awe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Hwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(dM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Nwe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(fM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=ze(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Dwe(t,e){cV(t,e),e.add(t)}function kwe(t,e,n){cV(t,e),e.set(t,n)}function cV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Il(t,e){return t.get(Ca(t,e))}function U1(t,e,n){return t.set(Ca(t,e),n),n}function Ca(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideColumns");oe.getSingleton().register("afterHideColumns");oe.getSingleton().register("beforeUnhideColumns");oe.getSingleton().register("afterUnhideColumns");const z1="hiddenColumns",$we=310;var bo=new WeakMap,Ol=new WeakSet;class Lwe extends Je{constructor(){super(...arguments),Dwe(this,Ol),kwe(this,bo,null)}static get PLUGIN_KEY(){return z1}static get PLUGIN_PRIORITY(){return $we}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[z1]}enablePlugin(){var e=this;this.enabled||(U1(bo,this,new Qv),Il(bo,this).addLocalHook("init",()=>Ca(Ol,this,Uwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Il(bo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,jwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Ca(Ol,this,Vwe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Ca(Ol,this,Fwe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,Wwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Ca(Ol,this,Bwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Il(bo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));P(l,u=>{o[u]=!1}),i=En(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Il(bo,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{Il(bo,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return ze(Il(bo,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Il(bo,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){U1(bo,this,null),super.destroy()}}function Fwe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Vwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Bwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Wwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),X(e,n)}function jwe(t){t.items.push({name:Le},Hwe(this),Nwe(this))}function Uwe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function zwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(gM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Ywe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(mM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=ze(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Gwe(t,e){hV(t,e),e.add(t)}function Kwe(t,e,n){hV(t,e),e.set(t,n)}function hV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(t,e){return t.get(ba(t,e))}function Y1(t,e,n){return t.set(ba(t,e),n),n}function ba(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideRows");oe.getSingleton().register("afterHideRows");oe.getSingleton().register("beforeUnhideRows");oe.getSingleton().register("afterUnhideRows");const G1="hiddenRows",qwe=320;var So=new WeakMap,Hl=new WeakSet;class Xwe extends Je{constructor(){super(...arguments),Gwe(this,Hl),Kwe(this,So,null)}static get PLUGIN_KEY(){return G1}static get PLUGIN_PRIORITY(){return qwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[G1]}enablePlugin(){var e=this;this.enabled||(Y1(So,this,new Qv),Al(So,this).addLocalHook("init",()=>ba(Hl,this,nve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Al(So,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Hl,e,tve).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>ba(Hl,this,Zwe).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>ba(Hl,this,Jwe).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Hl,e,eve).call(e,...r)}),this.addHook("modifyCopyableRange",n=>ba(Hl,this,Qwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Al(So,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));P(l,u=>{o[u]=!1}),i=En(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Al(So,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{Al(So,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return ze(Al(So,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Al(So,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){Y1(So,this,null),super.destroy()}}function Jwe(t,e){return this.isHidden(e)?0:t}function Zwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Qwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function eve(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),X(e,n)}function tve(t){t.items.push({name:Le},zwe(this),Ywe(this))}function nve(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function rve(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(WT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function ive(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(jT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function ove(t,e){dV(t,e),e.add(t)}function sve(t,e,n){dV(t,e),e.set(t,n)}function dV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l0(t,e){return t.get(qw(t,e))}function rS(t,e,n){return t.set(qw(t,e),n),n}function qw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnFreeze");oe.getSingleton().register("afterColumnFreeze");oe.getSingleton().register("beforeColumnUnfreeze");oe.getSingleton().register("afterColumnUnfreeze");const K1="manualColumnFreeze",ave=110;var Yl=new WeakMap,iS=new WeakSet;class lve extends Je{constructor(){super(...arguments),ove(this,iS),sve(this,Yl,!1)}static get PLUGIN_KEY(){return K1}static get PLUGIN_PRIORITY(){return ave}isEnabled(){return!!this.hot.getSettings()[K1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>qw(iS,this,uve).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>qw(iS,this,cve).call(this,e,n)),super.enablePlugin())}disablePlugin(){rS(Yl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;l0(Yl,this)||rS(Yl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;l0(Yl,this)||rS(Yl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function uve(t){t.items.push({name:"---------"},rve(this),ive(this))}function cve(t,e){if(l0(Yl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function ep(t,e,n){return(e=hve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hve(t){var e=dve(t,"string");return typeof e=="symbol"?e:e+""}function dve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oS=0,q1=1,X1=2,dc="px";let fV=class{constructor(e){ep(this,"hot",void 0),ep(this,"_element",null),ep(this,"state",oS),ep(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=X1}build(){this.state===oS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=q1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=oS}isAppended(){return this.state===X1}isBuilt(){return this.state>=q1}setPosition(e,n){qn(e)&&(this._element.style.top=e+dc),qn(n)&&(this._element.style[this.inlineProperty]=n+dc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){qn(e)&&(this._element.style.width=e+dc),qn(n)&&(this._element.style.height=n+dc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){qn(e)&&(this._element.style.marginTop=e+dc),qn(n)&&(this._element.style[`margin${er(this.inlineProperty)}`]=n+dc)}getOffset(){const e=this._element.style,n=`margin${er(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const fve="ht__manualColumnMove--backlight";let gve=class extends fV{build(){super.build(),X(this._element,fve)}};const mve="ht__manualColumnMove--guideline";let pve=class extends fV{build(){super.build(),X(this._element,mve)}};function wve(t,e){gV(t,e),e.add(t)}function Vi(t,e,n){gV(t,e),e.set(t,n)}function gV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(t,e,n){return t.set(Sa(t,e),n),n}function he(t,e){return t.get(Sa(t,e))}function Sa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnMove");oe.getSingleton().register("afterColumnMove");const sS="manualColumnMove",vve=120,J1="ht__manualColumnMove",Xw="show-ui",u0="on-moving--columns",c0="after-selection--columns";var cr=new WeakMap,Ta=new WeakMap,$s=new WeakMap,Zp=new WeakMap,ka=new WeakMap,ur=new WeakMap,tp=new WeakMap,fi=new WeakMap,Mc=new WeakMap,Jw=new WeakMap,lf=new WeakMap,Nl=new WeakSet;class yve extends Je{constructor(){super(...arguments),wve(this,Nl),Vi(this,cr,new gve(this.hot)),Vi(this,Ta,new pve(this.hot)),Vi(this,$s,[]),Vi(this,Zp,0),Vi(this,ka,!1),Vi(this,ur,{}),Vi(this,tp,void 0),Vi(this,fi,void 0),Vi(this,Mc,void 0),Vi(this,Jw,void 0),Vi(this,lf,void 0)}static get PLUGIN_KEY(){return sS}static get PLUGIN_PRIORITY(){return vve}isEnabled(){return!!this.hot.getSettings()[sS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(Nl,e,Cve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(Nl,e,Sve).call(e,...r)}),this.addHook("afterScrollVertically",()=>Sa(Nl,this,Eve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(Nl,e,Tve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,J1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,J1),this.unregisterEvents(),he(cr,this).destroy(),he(Ta,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(tp,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Hr(tp,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Hr(tp,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=En(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[sS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(fi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(fi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(cr,this).getOffset().start,u=he(cr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,w=nn(this.hot.rootElement),C=g.innerWidth-he(Mc,this)-w;h=g.innerWidth-he(ur,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=he(ur,this).eventPageX-(he(Mc,this)-(r.scrollX===void 0?i:0));if(he(Jw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(fi,this))&&(o+=i),o+=c,he(fi,this)<0)he(lf,this)>0?he(ur,this).col=0:he(ur,this).col=e>0?e-1:e;else if(he(ur,this).TD.offsetWidth/2+o<=h){const g=he(fi,this)>=he(Zp,this)?he(Zp,this)-1:he(fi,this);he(ur,this).col=g+1,o+=he(ur,this).TD.offsetWidth}else he(ur,this).col=he(fi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(fi,this)<he(lf,this)&&(f-=he(Mc,this)<=r.scrollX?he(Mc,this):0),he(cr,this).setPosition(null,d),he(Ta,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Sa(Nl,this,bve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Sa(Nl,this,Rve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(cr,this).build(),he(Ta,this).build()}destroy(){he(cr,this).destroy(),he(Ta,this).destroy(),super.destroy()}}function Cve(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ve(t.target,"sortAction");if(!s||!o||he(ka,this)||t.button!==0||a){Hr(ka,this,!1),he($s,this).length=0,we(this.hot.rootElement,[u0,Xw]);return}const l=he(Ta,this).isBuilt()&&!he(Ta,this).isAppended(),u=he(cr,this).isBuilt()&&!he(cr,this).isAppended();l&&u&&(he(Ta,this).appendTo(i.hider),he(cr,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Hr(ka,this,!0);const g=n.firstChild?a$(t,n.firstChild).x:t.offsetX;he(ur,this).eventPageX=t.pageX,Hr(fi,this,e.col),he(ur,this).TD=n,he(ur,this).col=e.col,Hr($s,this,this.prepareColumnsToMoving(d,f)),Hr(Jw,this,!!this.hot.getSettings().rowHeaders),Hr(Zp,this,this.hot.countCols()),Hr(lf,this,this.hot.getSettings().fixedColumnsStart),Hr(Mc,this,Vn(this.hot.rootElement).left);const w=he(Jw,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,R=e.col<he(lf,this),y=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),x=this.getColumnsWidth(d,e.col-1)+M,_=this.getColumnsWidth(w,d-1)+(R?y:0)+x;he(cr,this).setPosition(C,_),he(cr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),he(cr,this).setOffset(null,-x),X(this.hot.rootElement,u0)}else we(this.hot.rootElement,c0),Hr(ka,this,!1),he($s,this).length=0}function bve(t){he(ka,this)&&(he(ur,this).eventPageX=t.pageX,this.refreshPositions())}function Sve(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(ka,this)||(he($s,this).indexOf(e.col)>-1?we(this.hot.rootElement,Xw):X(this.hot.rootElement,Xw),r.row=!0,r.column=!0,r.cell=!0,Hr(fi,this,e.col),he(ur,this).TD=n)}function Rve(){const t=he(ur,this).col,e=he($s,this).length;if(Hr(fi,this,void 0),Hr(ka,this,!1),we(this.hot.rootElement,[u0,Xw,c0]),this.hot.selection.isSelectedByColumnHeader()&&X(this.hot.rootElement,c0),e<1||t===void 0)return;const n=he($s,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he($s,this),t);if(he($s,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Eve(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(cr,this).setPosition(r),he(cr,this).setSize(null,t.hider.offsetHeight-r)}function Tve(){this.moveBySettingsOrLoad()}function Mve(t,e){mV(t,e),e.add(t)}function Un(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tn(t,e,n){return t.set(Ki(t,e),n),n}function se(t,e){return t.get(Ki(t,e))}function Ki(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zw="manualColumnResize",_ve=130,Z1="manualColumnWidths";var _s=new WeakMap,np=new WeakMap,qr=new WeakMap,Qw=new WeakMap,Bo=new WeakMap,xve=new WeakMap,Gc=new WeakMap,rp=new WeakMap,Er=new WeakMap,Rs=new WeakMap,wu=new WeakMap,ev=new WeakMap,uf=new WeakMap,cf=new WeakMap,Jr=new WeakMap,hf=new WeakMap,Ro=new WeakSet;class Pve extends Je{static get PLUGIN_KEY(){return Zw}static get PLUGIN_PRIORITY(){return _ve}constructor(e){super(e),Mve(this,Ro),Un(this,_s,null),Un(this,np,null),Un(this,qr,[]),Un(this,Qw,null),Un(this,Bo,null),Un(this,xve,null),Un(this,Gc,null),Un(this,rp,null),Un(this,Er,this.hot.rootDocument.createElement("DIV")),Un(this,Rs,this.hot.rootDocument.createElement("DIV")),Un(this,wu,null),Un(this,ev,!1),Un(this,uf,0),Un(this,cf,null),Un(this,Jr,void 0),Un(this,hf,void 0),X(se(Er,this),"manualColumnResizer"),X(se(Rs,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Zw]}enablePlugin(){var e=this;this.enabled||(tn(Jr,this,new Za),se(Jr,this).addLocalHook("init",()=>Ki(Ro,this,Ive).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,se(Jr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ki(Ro,e,kve).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ki(Ro,e,$ve).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ki(Ro,e,Lve).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){tn(hf,this,se(Jr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",Z1,se(Jr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",Z1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return se(Jr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);se(Jr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;tn(_s,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(se(_s,this)),i=r.col;if(i<0)return;const o=hn(se(_s,this)),s=se(_s,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(_s,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(se(_s,this),r.row,r.col)),tn(np,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),tn(qr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();P(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{se(qr,this).includes(g)||se(qr,this).push(g)})})}se(qr,this).includes(se(np,this))||tn(qr,this,[se(np,this)]),tn(rp,this,l.start-6),tn(Gc,this,parseInt(s.width,10)),se(Er,this).style.top=`${l.top}px`,se(Er,this).style[this.inlineDir]=`${se(rp,this)+se(Gc,this)}px`,se(Er,this).style.height=`${o}px`,this.hot.rootElement.appendChild(se(Er,this))}refreshHandlePosition(){se(Er,this).style[this.inlineDir]=`${se(rp,this)+se(Qw,this)}px`}setupGuidePosition(){const e=parseInt(hn(se(Er,this)),10),n=parseInt(se(Er,this).style.top,10)+e,r=this.hot.view.getTableHeight();X(se(Er,this),"active"),X(se(Rs,this),"active"),se(Rs,this).style.top=`${n}px`,this.refreshGuidePosition(),se(Rs,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(se(Rs,this))}refreshGuidePosition(){se(Rs,this).style[this.inlineDir]=se(Er,this).style[this.inlineDir]}hideHandleAndGuide(){we(se(Er,this),"active"),we(se(Rs,this),"active")}checkIfColumnHeader(e){const n=za(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",se(Bo,this),r,!0);o!==void 0&&tn(Bo,this,o),this.setManualSize(r,se(Bo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Bo,this),r,!0),i&&e()};se(uf,this)>=2&&(se(qr,this).length>1?(P(se(qr,this),i=>{n(i)}),e()):P(se(qr,this),i=>{n(i,!0)})),tn(uf,this,0),tn(cf,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Ki(Ro,this,Ove).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Ki(Ro,this,Ave).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Ki(Ro,this,Hve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ki(Ro,this,Nve).call(this)),this.eventManager.addEventListener(se(Er,this),"contextmenu",()=>Ki(Ro,this,Dve).call(this))}destroy(){super.destroy()}}function Ive(){const t=this.hot.getSettings()[Zw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{se(Jr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{se(Jr,this).setValueAtIndex(r,n)})},!0),tn(hf,this,t)):t===!0&&Array.isArray(se(hf,this))&&this.hot.batchExecution(()=>{se(hf,this).forEach((n,r)=>{se(Jr,this).setValueAtIndex(r,n)})},!0)}function Ove(t){if(!FE(t.target)&&se(ev,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(se(wu,this)||this.setupHandlePosition(e))}}function Ave(t){t.target.parentNode===this.hot.rootElement&&ve(t.target,"manualColumnResizer")&&(this.setupHandlePosition(se(_s,this)),this.setupGuidePosition(),tn(wu,this,!0),se(cf,this)===null&&(tn(cf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(cf,this))),tn(uf,this,se(uf,this)+1),this.startX=t.pageX,tn(Bo,this,se(Gc,this)))}function Hve(t){if(se(wu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();tn(Qw,this,se(Gc,this)+e),P(se(qr,this),n=>{tn(Bo,this,this.setManualSize(n,se(Qw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Nve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",se(Bo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Bo,this),n,!1)};se(wu,this)&&(this.hideHandleAndGuide(),tn(wu,this,!1),se(Bo,this)!==se(Gc,this)&&(se(qr,this).length>1?(P(se(qr,this),r=>{e(r)}),t()):P(se(qr,this),r=>{e(r,!0)})),this.setupHandlePosition(se(_s,this)))}function Dve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(Er,this)),this.hot.rootElement.removeChild(se(Rs,this)),tn(wu,this,!1),tn(ev,this,!0),this.hot._registerImmediate(()=>{tn(ev,this,!1)})}function kve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=se(Jr,this).getValueAtIndex(r);this.hot.getSettings()[Zw]&&i&&(n=i)}return n}function $ve(t,e){const n=se(Jr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Lve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function aS(t,e,n){return(e=Fve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fve(t){var e=Vve(t,"string");return typeof e=="symbol"?e:e+""}function Vve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lS=0,Q1=1,eA=2,fc="px";let pV=class{constructor(e){aS(this,"hot",void 0),aS(this,"_element",null),aS(this,"state",lS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=eA}build(){this.state===lS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Q1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=lS}isAppended(){return this.state===eA}isBuilt(){return this.state>=Q1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+fc),n!==void 0&&(this._element.style.left=n+fc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+fc),n&&(this._element.style.height=n+fc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+fc),n&&(this._element.style.marginLeft=n+fc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Bve="ht__manualRowMove--backlight";class Wve extends pV{build(){super.build(),X(this._element,Bve)}}const jve="ht__manualRowMove--guideline";class Uve extends pV{build(){super.build(),X(this._element,jve)}}function zve(t,e){wV(t,e),e.add(t)}function gc(t,e,n){wV(t,e),e.set(t,n)}function wV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nu(t,e,n){return t.set(Ra(t,e),n),n}function xe(t,e){return t.get(Ra(t,e))}function Ra(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeRowMove");oe.getSingleton().register("afterRowMove");const uS="manualRowMove",Yve=140,tA="ht__manualRowMove",tv="show-ui",h0="on-moving--rows",d0="after-selection--rows";var hr=new WeakMap,Ma=new WeakMap,Ls=new WeakMap,$a=new WeakMap,Nr=new WeakMap,ip=new WeakMap,Dl=new WeakSet;class Gve extends Je{constructor(){super(...arguments),zve(this,Dl),gc(this,hr,new Wve(this.hot)),gc(this,Ma,new Uve(this.hot)),gc(this,Ls,[]),gc(this,$a,void 0),gc(this,Nr,{}),gc(this,ip,void 0)}static get PLUGIN_KEY(){return uS}static get PLUGIN_PRIORITY(){return Yve}isEnabled(){return!!this.hot.getSettings()[uS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Dl,e,Kve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Dl,e,Xve).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ra(Dl,this,Zve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Dl,e,Qve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,tA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,tA),this.unregisterEvents(),xe(hr,this).destroy(),xe(Ma,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=xe(ip,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(nu(ip,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return nu(ip,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=En(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[uS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=xe(Nr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=xe(Nr,this).TD,a=this.hot.rootElement,l=Vn(a),u=Qc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=xe(Nr,this).eventPageY-d+c,g=o.hider.offsetHeight,w=o.TBODY.offsetTop,C=xe(hr,this).getOffset().top,R=xe(hr,this).getSize().height,y=s.offsetHeight/2,M=s.offsetHeight;let x=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const _=f>=x+y;this.isFixedRowTop(e.row)&&(x+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?xe(Nr,this).row=n>0?n-1:n:_?(xe(Nr,this).row=e.row+1,x+=e.row===0?M-1:M):xe(Nr,this).row=e.row;let T=f,I=x;f+R+C>=g?T=g-R-C:f+C<w&&(T=w+Math.abs(C)),x>=g-1&&(I=g-1),xe(hr,this).setPosition(T),xe(Ma,this).setPosition(I)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ra(Dl,this,qve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ra(Dl,this,Jve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){xe(hr,this).build(),xe(Ma,this).build()}destroy(){xe(hr,this).destroy(),xe(Ma,this).destroy(),super.destroy()}}function Kve(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||xe($a,this)||t.button!==0){nu($a,this,!1),xe(Ls,this).length=0,we(this.hot.rootElement,[h0,tv]);return}const l=xe(Ma,this).isBuilt()&&!xe(Ma,this).isAppended(),u=xe(hr,this).isBuilt()&&!xe(hr,this).isAppended();l&&u&&(xe(Ma,this).appendTo(i.hider),xe(hr,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,nu($a,this,!0),xe(Nr,this).eventPageY=t.pageY,xe(Nr,this).coords=e,xe(Nr,this).TD=n,nu(Ls,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);xe(hr,this).setPosition(null,g),xe(hr,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),xe(hr,this).setOffset(-w,null),X(this.hot.rootElement,h0),this.refreshPositions()}else we(this.hot.rootElement,d0),nu($a,this,!1),xe(Ls,this).length=0}function qve(t){xe($a,this)&&(xe(Nr,this).eventPageY=t.pageY,this.refreshPositions())}function Xve(t,e,n,r){!this.hot.getSelectedRangeLast()||!xe($a,this)||(xe(Ls,this).indexOf(e.row)>-1?we(this.hot.rootElement,tv):X(this.hot.rootElement,tv),r.row=!0,r.column=!0,r.cell=!0,xe(Nr,this).coords=e,xe(Nr,this).TD=n)}function Jve(){const t=xe(Nr,this).row,e=xe(Ls,this).length;if(nu($a,this,!1),we(this.hot.rootElement,[h0,tv,d0]),this.hot.selection.isSelectedByRowHeader()&&X(this.hot.rootElement,d0),e<1||t===void 0)return;const n=xe(Ls,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(xe(Ls,this),t);if(xe(Ls,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Zve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;xe(hr,this).setPosition(null,r),xe(hr,this).setSize(t.hider.offsetWidth-r)}function Qve(){this.moveBySettingsOrLoad()}function eye(t,e){vV(t,e),e.add(t)}function zn(t,e,n){vV(t,e),e.set(t,n)}function vV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(t,e,n){return t.set(xs(t,e),n),n}function ie(t,e){return t.get(xs(t,e))}function xs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nv="manualRowResize",tye=30,nA="manualRowHeights";var No=new WeakMap,op=new WeakMap,Xr=new WeakMap,df=new WeakMap,_a=new WeakMap,N_=new WeakMap,Kc=new WeakMap,sp=new WeakMap,ar=new WeakMap,Oo=new WeakMap,vu=new WeakMap,rv=new WeakMap,ff=new WeakMap,gf=new WeakMap,Zi=new WeakMap,mf=new WeakMap,fa=new WeakSet;class nye extends Je{static get PLUGIN_KEY(){return nv}static get PLUGIN_PRIORITY(){return tye}constructor(e){super(e),eye(this,fa),zn(this,No,null),zn(this,op,null),zn(this,Xr,[]),zn(this,df,null),zn(this,_a,null),zn(this,N_,null),zn(this,Kc,null),zn(this,sp,null),zn(this,ar,this.hot.rootDocument.createElement("DIV")),zn(this,Oo,this.hot.rootDocument.createElement("DIV")),zn(this,vu,!1),zn(this,rv,!1),zn(this,ff,0),zn(this,gf,null),zn(this,Zi,void 0),zn(this,mf,void 0),X(ie(ar,this),"manualRowResizer"),X(ie(Oo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[nv]}enablePlugin(){this.enabled||(Yt(Zi,this,new Za),ie(Zi,this).addLocalHook("init",()=>xs(fa,this,uye).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ie(Zi,this)),this.addHook("modifyRowHeight",(e,n)=>xs(fa,this,lye).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Yt(mf,this,ie(Zi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",nA,ie(Zi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",nA,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return ie(Zi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ie(df,this)}setupHandlePosition(e){Yt(No,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ie(No,this)),o=i.row;if(o<0)return;const s=nn(ie(No,this)),a=ie(No,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(No,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ie(No,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ie(No,this),i.row,i.col)),Yt(op,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Yt(Xr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();P(d,f=>{const g=f.getTopStartCorner().row,w=f.getBottomStartCorner().row;fe(g,w,C=>{ie(Xr,this).includes(C)||ie(Xr,this).push(C)})})}ie(Xr,this).includes(ie(op,this))||Yt(Xr,this,[ie(op,this)]),Yt(sp,this,c.top-6),Yt(Kc,this,parseInt(a.height,10)),ie(ar,this).style.top=`${ie(sp,this)+ie(Kc,this)}px`,ie(ar,this).style[this.inlineDir]=`${c.start}px`,ie(ar,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ie(ar,this))}refreshHandlePosition(){ie(ar,this).style.top=`${ie(sp,this)+ie(df,this)}px`}setupGuidePosition(){const e=parseInt(nn(ie(ar,this)),10),n=parseInt(ie(ar,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();X(ie(ar,this),"active"),X(ie(Oo,this),"active"),ie(Oo,this).style.top=ie(ar,this).style.top,ie(Oo,this).style[this.inlineDir]=`${n}px`,ie(Oo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ie(Oo,this))}refreshGuidePosition(){ie(Oo,this).style.top=ie(ar,this).style.top}hideHandleAndGuide(){we(ie(ar,this),"active"),we(ie(Oo,this),"active")}checkIfRowHeader(e){const n=za(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ie(_a,this)<n?n:ie(_a,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Yt(_a,this,o),this.setManualSize(r,ie(_a,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ie(ff,this)>=2&&(ie(Xr,this).length>1?(P(ie(Xr,this),i=>{n(i)}),e()):P(ie(Xr,this),i=>{n(i,!0)})),Yt(ff,this,0),Yt(gf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>xs(fa,this,rye).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>xs(fa,this,iye).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>xs(fa,this,oye).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>xs(fa,this,sye).call(this)),this.eventManager.addEventListener(ie(ar,this),"contextmenu",()=>xs(fa,this,aye).call(this))}destroy(){super.destroy()}}function rye(t){if(!FE(t.target)&&ie(rv,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ie(vu,this)||this.setupHandlePosition(e))}}function iye(t){ve(t.target,"manualRowResizer")&&(this.setupHandlePosition(ie(No,this)),this.setupGuidePosition(),Yt(vu,this,!0),ie(gf,this)===null&&(Yt(gf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(gf,this))),Yt(ff,this,ie(ff,this)+1),Yt(N_,this,t.pageY),Yt(_a,this,ie(Kc,this)))}function oye(t){ie(vu,this)&&(Yt(df,this,ie(Kc,this)+(t.pageY-ie(N_,this))),P(ie(Xr,this),e=>{Yt(_a,this,this.setManualSize(e,ie(df,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function sye(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ie(vu,this)&&(this.hideHandleAndGuide(),Yt(vu,this,!1),ie(_a,this)!==ie(Kc,this)&&(ie(Xr,this).length>1?(P(ie(Xr,this),r=>{e(r)}),t()):P(ie(Xr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(No,this)))}function aye(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(ar,this)),this.hot.rootElement.removeChild(ie(Oo,this)),Yt(vu,this,!1),Yt(rv,this,!0),this.hot._registerImmediate(()=>{Yt(rv,this,!1)})}function lye(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ie(Zi,this).getValueAtIndex(r);this.hot.getSettings()[nv]&&i&&(n=i)}return n}function uye(){const t=this.hot.getSettings()[nv],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ie(Zi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ie(Zi,this).setValueAtIndex(r,n)}),Yt(mf,this,t)):t===!0&&Array.isArray(ie(mf,this))&&ie(mf,this).forEach((n,r)=>{ie(Zi,this).setValueAtIndex(r,n)})},!0)}var cye=Kv;cye("flatMap");var hye=bn,rA=Rn,dye=Qo,fye=X0,gye=function(t,e){(!e||typeof t!="string")&&rA(t);var n=fye(t);return dye(rA(n!==void 0?hye(n,t):t))},mye=Et,f0=bn,pye=Lr,g0=Rn,wye=Qo,vye=gye,yye=nE,m0=ni,Cye=Ja,cS=Cye("flatMap",TypeError),bye=yye(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=g0(f0(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){m0(t,"throw",i)}if(n=g0(f0(this.next,t)),this.done=!!n.done)return;try{this.inner=vye(e(n.value,this.counter++),!1)}catch(i){m0(t,"throw",i)}}});mye({target:"Iterator",proto:!0,real:!0,forced:cS},{flatMap:function(e){g0(this);try{pye(e)}catch(n){m0(this,"throw",n)}return cS?f0(cS,this,e):new bye(wye(this),{mapper:e,inner:null})}});function Sye(t,e,n){Rye(t,e),e.set(t,n)}function Rye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kl(t,e,n){return(e=Eye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eye(t){var e=Tye(t,"string");return typeof e=="symbol"?e:e+""}function Tye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iA(t,e){return t.get(yV(t,e))}function ap(t,e,n){return t.set(yV(t,e),n),n}function yV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $l=new WeakMap;class Do{constructor(e,n,r,i,o,s){kl(this,"row",void 0),kl(this,"col",void 0),kl(this,"rowspan",void 0),kl(this,"colspan",void 0),kl(this,"removed",!1),kl(this,"cellCoordsFactory",void 0),kl(this,"cellRangeFactory",void 0),Sye(this,$l,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return mt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return mt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return mt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return mt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),ap($l,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,ap($l,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return ap($l,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return iA($l,this)||ap($l,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),iA($l,this)}}function Mye(t,e){_ye(t,e),e.add(t)}function _ye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lp(t,e,n){return(e=xye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xye(t){var e=Pye(t,"string");return typeof e=="symbol"?e:e+""}function Pye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ll(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ga=new WeakSet;class iv{constructor(e){Mye(this,ga),lp(this,"plugin",void 0),lp(this,"mergedCells",[]),lp(this,"mergedCellsMatrix",new Map),lp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return mt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){ot(iv.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Do(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Ll(ga,this,oA).call(this,a),a):(u&&ot(iv.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Ll(ga,this,Iye).call(this,r),r):!1}clear(){P(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ge(u,i,i+s-1),d=Ge(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Ll(ga,this,up).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Ll(ga,this,up).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Ll(ga,this,up).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Ll(ga,this,up).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Ll(ga,this,oA).call(this,s)})}}function up(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function oA(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Iye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function hS(t,e,n){return(e=Oye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oye(t){var e=Aye(t,"string");return typeof e=="symbol"?e:e+""}function Aye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hye{constructor(e){hS(this,"plugin",void 0),hS(this,"mergedCellsCollection",void 0),hS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,w=this.getFarthestCollection(e,n,r,i);if(w){if(r==="down"){const C=w.row+w.rowspan-a-g;o[2]+C>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?C:0}else if(r==="right"){const C=w.col+w.colspan-l-g;o[3]+C>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?C:0}else if(r==="up"){const C=u-g-w.row+1;o[0]+C<0?o[0]+=g:o[0]-=g?C:0}else if(r==="left"){const C=c-g-w.col+1;o[1]+C<0?o[1]+=g:o[1]-=g?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),dn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,w=d-g;let C=null,R=null,y=null;switch(r){case"up":C="includesVertically",y=c-w+1;break;case"left":C="includesHorizontally",y=c-w+1;break;case"down":C="includesVertically",y=h+w-1;break;case"right":C="includesHorizontally",y=h+w-1;break}return P(i,M=>{M[C](y)&&M.isFarther(R,r)&&(R=M)}),R}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return P(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:w}=g;return w===h.getWidth()}):!f.every(g=>{let{rowspan:w}=g;return w===h.getHeight()})}}function dS(t,e,n){return(e=Nye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nye(t){var e=Dye(t,"string");return typeof e=="symbol"?e:e+""}function Dye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kye{constructor(e){dS(this,"plugin",void 0),dS(this,"hot",void 0),dS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function $ye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(zT)}return this.getTranslatedPhrase(UT)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Do.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function pf(t,e,n){return(e=Lye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lye(t){var e=Fye(t,"string");return typeof e=="symbol"?e:e+""}function Fye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sA{constructor(e){pf(this,"data",void 0),pf(this,"next",null),pf(this,"prev",null),this.data=e}}class cp{constructor(){pf(this,"first",null),pf(this,"last",null)}push(e){const n=new sA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new sA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Vye(t,e){CV(t,e),e.add(t)}function Fl(t,e,n){CV(t,e),e.set(t,n)}function CV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ht(t,e){return t.get(ov(t,e))}function Wr(t,e,n){return t.set(ov(t,e),n),n}function ov(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Eo=new WeakMap,To=new WeakMap,Mo=new WeakMap,_o=new WeakMap,p0=new WeakMap,hp=new WeakMap,dp=new WeakMap,fS=new WeakSet;class Bye{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Vye(this,fS),Fl(this,Eo,new cp),Fl(this,To,new cp),Fl(this,Mo,null),Fl(this,_o,null),Fl(this,p0,null),Fl(this,hp,null),Fl(this,dp,null),Wr(p0,this,n),Wr(hp,this,r),Wr(dp,this,i)}getCurrentVerticalNode(){return ht(_o,this).data}getFirstVerticalNode(){return ht(To,this).first.data}getNextVerticalNode(){return ht(_o,this).next.data}getPrevVerticalNode(){return ht(_o,this).prev.data}getCurrentHorizontalNode(){return ht(Mo,this).data}getFirstHorizontalNode(){return ht(Eo,this).first.data}getNextHorizontalNode(){return ht(Mo,this).next.data}getPrevHorizontalNode(){return ht(Mo,this).prev.data}setPrevNodeAsActive(){Wr(_o,this,ht(_o,this).prev),Wr(Mo,this,ht(Mo,this).prev)}setNextNodeAsActive(){Wr(_o,this,ht(_o,this).next),Wr(Mo,this,ht(Mo,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Wr(Eo,this,new cp);for(let s=n.row;s<=r.row;s++)if(!ht(hp,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(ht(dp,this).isHidden(a))continue;const l=ov(fS,this,aA).call(this,e,ht(Eo,this),i,s,a);l&&Wr(Mo,this,l)}ht(Eo,this).first&&(ht(Eo,this).first.prev=ht(Eo,this).last,ht(Eo,this).last.next=ht(Eo,this).first);const o=new WeakSet;Wr(To,this,new cp);for(let s=n.col;s<=r.col;s++)if(!ht(dp,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(ht(hp,this).isHidden(a))continue;const l=ov(fS,this,aA).call(this,e,ht(To,this),o,a,s);l&&Wr(_o,this,l)}ht(To,this).first&&(ht(To,this).first.prev=ht(To,this).last,ht(To,this).last.next=ht(To,this).first)}setActiveNode(e,n){return ht(Eo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Wr(Mo,this,r),!1}),ht(To,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Wr(_o,this,r),!1}),this}}function aA(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=ht(p0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function bV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function Wye(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!De(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Nf()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[w,C]=t.translateMergedCellToRenderable(h,g,d,f),R=t.getSetting("virtualized");if(Nf()&&d===0&&!e.getSettings().rowHeaders){const V=bV(e,h,g);i.set(l,V/g)}const y=n.getRenderableFromVisualIndex(l),M=r.getRenderableFromVisualIndex(u),x=w-y+1,_=C-M+1;let T=n.getNearestNotHiddenIndex(h,1),I=r.getNearestNotHiddenIndex(d,1);if(R){const V=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(V)||(T=Math.max(T,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(V)||(I=Math.max(I,e.getFirstRenderedVisibleColumn()))}const Y=Math.min(g,x),U=Math.min(f,_);T===l&&I===u?(a.setAttribute("rowspan",Y),a.setAttribute("colspan",U)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function jye(t,e){SV(t,e),e.add(t)}function fp(t,e,n){SV(t,e),e.set(t,n)}function SV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gS(t,e,n){return(e=Uye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uye(t){var e=zye(t,"string");return typeof e=="symbol"?e:e+""}function zye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gf(t,e,n){return t.set(pt(t,e),n),n}function Rt(t,e){return t.get(pt(t,e))}function pt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeMergeCells");oe.getSingleton().register("afterMergeCells");oe.getSingleton().register("beforeUnmergeCells");oe.getSingleton().register("afterUnmergeCells");const w0="mergeCells",Yye=150,lA=w0;var Ci=new WeakMap,Si=new WeakMap,Wo=new WeakMap,uA=new WeakMap,bt=new WeakSet;class Gye extends Je{constructor(){super(...arguments),jye(this,bt),gS(this,"mergedCellsCollection",null),gS(this,"autofillCalculations",null),gS(this,"selectionCalculations",null),fp(this,Ci,null),fp(this,Si,{row:0,col:0}),fp(this,Wo,new Bye({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),fp(this,uA,Wye(this))}static get PLUGIN_KEY(){return w0}static get PLUGIN_PRIORITY(){return Yye}static get DEFAULT_SETTINGS(){return{[WL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[w0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new iv(this),this.autofillCalculations=new Hye(this),this.selectionCalculations=new kye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,Kye).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,Xye).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,Jye).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,Zye).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,Qye).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,hA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,hA).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,tCe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,nCe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,rCe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,cA).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,cA).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,qye).call(e,...r)}),this.addHook("afterRenderer",function(){return Rt(uA,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,eCe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,iCe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,oCe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,sCe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,aCe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,lCe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,uCe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,cCe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,hCe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,dCe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,fCe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,gCe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,mCe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,pCe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,wCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!UE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Of(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Of(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Do.containsNegativeValues(e)?(ot(Do.NEGATIVE_VALUES_WARNING(e)),!1):Do.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ot(Do.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Do.isSingleCell(e)?(ot(Do.IS_SINGLE_CELL(e)),!1):Do.containsZeroSpan(e)?(ot(Do.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),P(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:lA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Kye(){this.generateFromSettings(),this.hot.render()}function qye(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Xye(t){Rt(Si,this).row=t.row,Rt(Si,this).col=t.col}function Jye(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;Rt(Ci,this)&&(i.getRenderableFromVisualIndex(Rt(Ci,this).row)!==null&&(n.row=Rt(Ci,this).row),r.getRenderableFromVisualIndex(Rt(Ci,this).col)!==null&&(n.col=Rt(Ci,this).col),Gf(Ci,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Zye(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Qye(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Gf(Ci,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Gf(Ci,this,e.clone()),n&&e.assign(n)}function cA(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),w=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ge(g,u,h),Ge(w,c,d),Ge(this.hot.getLastRenderedVisibleRow(),u,h),Ge(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function eCe(t){t.items.push({name:"---------"},$ye(this))}function hA(){Gf(Ci,this,null)}function tCe(){if(Rt(Ci,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=Rt(Ci,this).clone().normalize();Rt(Wo,this).setActiveNode(r.row,r.col),Rt(Si,this).row>0||Rt(Si,this).col>0?Rt(Wo,this).setPrevNodeAsActive():(n==="E-W"&&Rt(Si,this).col<0||e==="S-N"&&Rt(Si,this).row<0)&&Rt(Wo,this).setNextNodeAsActive()}function nCe(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(Rt(Si,this).col<0){const{rowEnd:a,colEnd:l}=Rt(Wo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(Rt(Si,this).col>0){const{rowStart:a,colStart:l}=Rt(Wo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(Rt(Si,this).row<0){const{rowEnd:a,colEnd:l}=Rt(Wo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(Rt(Si,this).row>0){const{rowStart:a,colStart:l}=Rt(Wo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}Rt(Wo,this).setActiveNode(t,e),Gf(Si,this,{row:0,col:0})}function rCe(){this.hot.getSelectedRangeLast().isHeader()||Rt(Wo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function iCe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function oCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function sCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function aCe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function lCe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function uCe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function cCe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function hCe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function dCe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function fCe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);P(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function gCe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function mCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function pCe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function wCe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,bV(this.hot,e,g))}),t}function vCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:ZL(u.type))(l,u,d)(c,h);if(g===Go){const w=a+1;if(typeof e[w]<"u")return s(w)}return g}(0)}}const RV="sort";function yCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${RV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function CCe(t){const e=t.className.split(" "),n=new RegExp(`^${RV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function bCe(t,e,n){return(e=SCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SCe(t){var e=RCe(t,"string");return typeof e=="symbol"?e:e+""}function RCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sv="multiColumnSorting",ECe=170,dA=sv;JL(sv,vCe);class TCe extends aF{constructor(){super(...arguments),bCe(this,"pluginKey",sv)}static get PLUGIN_KEY(){return sv}static get PLUGIN_PRIORITY(){return ECe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Bw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Qa,position:"before",group:dA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),we(e,CCe(e)),this.enabled!==!1&&X(e,yCe(...r))}onAfterOnCellMouseDown(e,n){C_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Bw))):this.sort(this.getColumnNextConfig(n.col)))}}function fA(t,e,n){return(e=MCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MCe(t){var e=_Ce(t,"string");return typeof e=="symbol"?e:e+""}function _Ce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xCe="multipleSelectionHandles",PCe=160;class ICe extends Je{constructor(){super(...arguments),fA(this,"dragged",[]),fA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return xCe}static get PLUGIN_PRIORITY(){return PCe}isEnabled(){return Uo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ve(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ve(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function v0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function EV(){return{label:"",isPlaceholder:!0}}function OCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;P(t,i=>{const o=[];let s=0;n.push(o),P(i,a=>{const l=v0();if(De(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Pt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Pt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(EV());return!u})});const r=Math.max(...ze(n,i=>i.length));return P(n,i=>{if(i.length<r){const o=ze(new Array(r-i.length),()=>v0());i.splice(i.length,0,...o)}}),n}function mS(t,e,n){ACe(t,e),e.set(t,n)}function ACe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bi(t,e){return t.get(TV(t,e))}function xd(t,e,n){return t.set(TV(t,e),n),n}function TV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gA=["label","collapsible"];var vs=new WeakMap,Vl=new WeakMap,pS=new WeakMap;class HCe{constructor(){mS(this,vs,[]),mS(this,Vl,0),mS(this,pS,1/0)}setColumnsLimit(e){xd(pS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];xd(vs,this,OCe(e,Bi(pS,this))),xd(Vl,this,Bi(vs,this).length)}getData(){return Bi(vs,this)}mergeWith(e){P(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&dn(s,o,gA)})}map(e){P(Bi(vs,this),n=>{P(n,r=>{const i=e({...r});De(i)&&dn(r,i,gA)})})}getHeaderSettings(e,n){var r;if(e>=Bi(Vl,this)||e<0)return null;const i=Bi(vs,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Bi(Vl,this)||e<0)return i;const o=Bi(vs,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Bi(Vl,this)}getColumnsCount(){return Bi(Vl,this)>0?Bi(vs,this)[0].length:0}clear(){xd(vs,this,[]),xd(Vl,this,0)}}function wS(t,e,n){return(e=NCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NCe(t){var e=DCe(t,"string");return typeof e=="symbol"?e:e+""}function DCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MV="DF-pre-order";function _V(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=_V.call(this.childs[r],t,e)}return n}const kCe="DF-post-order";function xV(t,e){for(let n=0;n<this.childs.length;n++)if(xV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const PV="BF";function $Ce(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const LCe=PV,mA=new Map([[MV,_V],[kCe,xV],[PV,$Ce]]);class av{constructor(e){wS(this,"data",{}),wS(this,"parent",null),wS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new av({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:LCe;if(!mA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);mA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function vS(t,e,n){FCe(t,e),e.set(t,n)}function FCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(IV(t,e))}function VCe(t,e,n){return t.set(IV(t,e),n),n}function IV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mc=new WeakMap,Bl=new WeakMap,pc=new WeakMap;class BCe{constructor(e){vS(this,mc,new Map),vS(this,Bl,new Map),vS(this,pc,null),VCe(pc,this,e)}getRoots(){return Array.from(sr(mc,this).values())}getRootByColumn(e){let n;return sr(Bl,this).has(e)&&(n=sr(mc,this).get(sr(Bl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-sr(Bl,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;sr(Bl,this).clear(),P(sr(mc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)sr(Bl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=sr(pc,this).getColumnsCount();let n=0;for(;n<e;){const r=sr(pc,this).getHeaderSettings(0,n),i=new av;sr(mc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=sr(pc,this).getHeadersSettings(r,n,i);r+=1,P(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new av(a),e.addChild(l)),r<sr(pc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){sr(mc,this).clear(),sr(Bl,this).clear()}}function OV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function lv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function uv(t){return lv(t,"origColspan")===t.data.origColspan}function D_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(uv(t))return D_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)P(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,OV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):uv(a)&&(l.isCollapsed=lv(a,"isCollapsed"))}),{rollbackModification:()=>k_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function k_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(uv(t))return k_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)P(o,l=>{OV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=lv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):uv(l)&&(u.isCollapsed=lv(l,"isCollapsed"))}),{rollbackModification:()=>D_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function WCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(mt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function jCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(mt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const pA=new Map([["collapse",k_],["expand",D_],["hide-column",WCe],["show-column",jCe]]);function UCe(t,e,n){if(!pA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return pA.get(t)(e,n)}function gp(t){const e=[];return P(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=YCe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(EV());else{const f=zCe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function zCe(t){const{crossHiddenColumns:e,...n}=v0(t);return n}function YCe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function yS(t,e,n){GCe(t,e),e.set(t,n)}function GCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pd(t,e,n){return t.set(AV(t,e),n),n}function jt(t,e){return t.get(AV(t,e))}function AV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xo=new WeakMap,Rr=new WeakMap,Wl=new WeakMap;class KCe{constructor(){yS(this,xo,new HCe),yS(this,Rr,new BCe(jt(xo,this))),yS(this,Wl,[[]])}setState(e){jt(xo,this).setData(e);let n=!1;try{jt(Rr,this).buildTree()}catch{jt(Rr,this).clear(),jt(xo,this).clear(),n=!0}return Pd(Wl,this,gp(jt(Rr,this).getRoots())),n}setColumnsLimit(e){jt(xo,this).setColumnsLimit(e)}mergeStateWith(e){const n=ze(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});jt(xo,this).mergeWith(n),jt(Rr,this).buildTree(),Pd(Wl,this,gp(jt(Rr,this).getRoots()))}mapState(e){jt(xo,this).map(e),jt(Rr,this).buildTree(),Pd(Wl,this,gp(jt(Rr,this).getRoots()))}mapNodes(e){return En(jt(Rr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=jt(Rr,this).getNode(n,r);let o;return i&&(o=UCe(e,i,r),Pd(Wl,this,gp(jt(Rr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=jt(Wl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=jt(Rr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=jt(Rr,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},MV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return jt(xo,this).getLayersCount()}getColumnsCount(){return jt(xo,this).getColumnsCount()}clear(){Pd(Wl,this,[]),jt(xo,this).clear(),jt(Rr,this).clear()}}function Id(t,e,n){return(e=qCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qCe(t){var e=XCe(t,"string");return typeof e=="symbol"?e:e+""}function XCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JCe{constructor(e,n){Id(this,"hot",void 0),Id(this,"nestedHeaderSettingsGetter",void 0),Id(this,"layersCount",0),Id(this,"container",void 0),Id(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),Ou(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function ZCe(t,e){HV(t,e),e.add(t)}function wA(t,e,n){return(e=QCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QCe(t){var e=ebe(t,"string");return typeof e=="symbol"?e:e+""}function ebe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Od(t,e,n){HV(t,e),e.set(t,n)}function HV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fs(t,e,n){return t.set(Ut(t,e),n),n}function Ue(t,e){return t.get(Ut(t,e))}function Ut(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vA="nestedHeaders",tbe=280;var vt=new WeakMap,ma=new WeakMap,wf=new WeakMap,Ey=new WeakMap,cv=new WeakMap,Jt=new WeakSet;class nbe extends Je{constructor(){super(...arguments),ZCe(this,Jt),Od(this,vt,new KCe),Od(this,ma,null),Od(this,wf,null),Od(this,Ey,!1),Od(this,cv,null),wA(this,"ghostTable",new JCe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),wA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return vA}static get PLUGIN_PRIORITY(){return tbe}isEnabled(){return!!this.hot.getSettings()[vA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&ot(mt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Ut(Jt,this,vbe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,ybe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,sbe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,abe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,lbe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,ube).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,cbe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,hbe).call(e,...i)}),this.addHook("afterSelection",()=>Ut(Jt,this,mp).call(this)),this.addHook("afterSelectionFocusSet",()=>Ut(Jt,this,mp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,rbe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Ut(Jt,this,fbe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,mbe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,pbe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,ibe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,obe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,dbe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,gbe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ut(Jt,e,wbe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Ut(Jt,this,mp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Ut(Jt,this,mp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ue(vt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ue(vt,this).setState(e)),this.detectedOverlappedHeaders&&ot(mt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Ue(vt,this).triggerColumnModification(i,r)}),!Ue(ma,this)&&this.enabled&&Fs(ma,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";Ue(vt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ue(vt,this).clear(),Ue(ma,this).unsubscribe(),Fs(ma,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ue(vt,this)}getLayersCount(){return Ue(vt,this).getLayersCount()}getHeaderSettings(e,n){return Ue(vt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),we(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),we(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),we(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),we(o,"hiddenHeader"),we(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Ue(vt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)X(o,"hiddenHeader");else if(c>1){var g,w,C;const{wtOverlays:R}=l._wt,y=(g=R.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),M=(w=R.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o);((C=R.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&u<r&&X(o,"hiddenHeaderText");const _=y||M?Math.min(c,r-i):c;_>1&&o.setAttribute("colspan",_)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const R=o.querySelector("div.relative");R&&f&&f.length>0&&(we(R,this.hot.getColumnMeta(u).headerClassName),X(R,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=Ue(vt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Fs(vt,this,null),Ue(ma,this)!==null&&(Ue(ma,this).unsubscribe(),Fs(ma,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ue(vt,this).getHeaderTreeNodeData(e.row,e.col)}}function mp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=Ue(vt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function rbe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=Ue(cv,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(Fs(cv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Ue(vt,this).findLeftMostColumnIndex(a,l),g=Ue(vt,this).findRightMostColumnIndex(a,l),w=g-f+1;if(f<c&&g>h)return f;if(s){let C=null;return f>=c&&g>h?w>d?(e.value="start",C=f):(e.value="end",C=g):f<c&&g<=h&&(w>d?(e.value="end",C=g):(e.value="start",C=f)),C}return f<=c?f:g}function ibe(t,e,n){const r=Ue(vt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Ue(vt,this).getHeaderSettings(e,t);if(o===lT){if(!a)return r.columnIndex}else if(o===H$&&(l>s-i||!a))return null;return t}function obe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,w=d-a;if(w===0)continue;((i=Ue(vt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][w]="")}}}function sbe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function abe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Fs(wf,this,e.clone()),Fs(Ey,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Gv(t)||Ga(t)&&l||s$(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function lbe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ge(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function ube(){Fs(Ey,this,!1)}function cbe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ue(Ey,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=Ue(vt,this).getHeaderTreeNodeData(Ue(wf,this).row,Ue(wf,this).col);if(e.setHighlight(Ue(wf,this)),o>e.getWidth()||i<n||i+o-1>r){const s=Ue(vt,this).findTopMostEntireHeaderLevel(Ge(n,i,i+o-1),Ge(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function hbe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Ue(vt,this).findLeftMostColumnIndex(n.row,n.col),o=Ue(vt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function dbe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Fs(cv,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function fbe(t){if(Ue(vt,this).getLayersCount()>0){t.length=0;for(let e=0;e<Ue(vt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function gbe(t){const e=Ue(vt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=Ue(vt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),qn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?Ue(vt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function mbe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function pbe(t,e,n){var r;const{label:i}=(r=Ue(vt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function wbe(t,e){if(t<0)return this.hot.getCell(t,Ue(vt,this).findLeftMostColumnIndex(t,e),!0)}function vbe(){this.updatePlugin()}function ybe(t,e){e||this.updatePlugin()}function Ad(t,e,n){return(e=Cbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cbe(t){var e=bbe(t,"string");return typeof e=="symbol"?e:e+""}function bbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sbe{constructor(e,n){Ad(this,"hot",void 0),Ad(this,"data",null),Ad(this,"plugin",void 0),Ad(this,"parentReference",new WeakMap),Ad(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&P(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&P(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ke(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(P(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];P(r,o=>{i.push(this.getDataObject(o))}),P(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function yA(t,e,n){return(e=Rbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rbe(t){var e=Ebe(t,"string");return typeof e=="symbol"?e:e+""}function Ebe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $_{constructor(e,n){yA(this,"hot",void 0),yA(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Lo extends $_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(P(l,c=>{c&&s.removeChild(c)}),X(n,Lo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");X(d,Lo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&be(c,[Pu()]),X(n,Lo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(X(c,`${Lo.CSS_CLASSES.button} ${Lo.CSS_CLASSES.expandButton}`),u&&be(n,[Ri(!1)])):(X(c,`${Lo.CSS_CLASSES.button} ${Lo.CSS_CLASSES.collapseButton}`),u&&be(n,[Ri(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class Tbe extends $_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),P(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&P(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&P(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&P(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ve(e.target,Lo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ai(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Mbe(t,e,n){_be(t,e),e.set(t,n)}function _be(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xbe(t,e,n){return(e=Pbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pbe(t){var e=Ibe(t,"string");return typeof e=="symbol"?e:e+""}function Ibe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Obe(t,e){return t.get(Abe(t,e))}function Abe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var CA=new WeakMap;class Hbe extends $_{constructor(){super(...arguments),xbe(this,"dataManager",this.plugin.dataManager),Mbe(this,CA,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(cM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(hM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return P(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=Obe(CA,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function pp(t,e,n){return(e=Nbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nbe(t){var e=Dbe(t,"string");return typeof e=="symbol"?e:e+""}function Dbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kbe{constructor(e){pp(this,"plugin",void 0),pp(this,"hot",void 0),pp(this,"dataManager",void 0),pp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return $t(i)&&(ot(mt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function $be(t,e){NV(t,e),e.add(t)}function bA(t,e,n){NV(t,e),e.set(t,n)}function NV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CS(t,e,n){return(e=Lbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lbe(t){var e=Fbe(t,"string");return typeof e=="symbol"?e:e+""}function Fbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qp(t,e){return t.get(_n(t,e))}function hv(t,e,n){return t.set(_n(t,e),n),n}function _n(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dv="nestedRows",Vbe=300,SA=dv,Bbe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Ty=new WeakMap,wc=new WeakMap,Hn=new WeakSet;class Wbe extends Je{constructor(){super(...arguments),$be(this,Hn),CS(this,"dataManager",null),CS(this,"headersUI",null),CS(this,"collapsedRowsMap",null),bA(this,Ty,!1),bA(this,wc,!1)}static get PLUGIN_KEY(){return dv}static get PLUGIN_PRIORITY(){return Vbe}isEnabled(){return!!this.hot.getSettings()[dv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Sg),this.dataManager=new Sbe(this,this.hot),this.collapsingUI=new Tbe(this,this.hot),this.headersUI=new Lo(this,this.hot),this.contextMenuUI=new Hbe(this,this.hot),this.rowMoveController=new kbe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,nSe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,rSe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,zbe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,Ybe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,Gbe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,Ube).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,Xbe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,qbe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,Jbe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,Zbe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,Qbe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,eSe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,Kbe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,tSe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _n(Hn,e,jbe).call(e,...r)}),this.addHook("beforeLoadData",n=>_n(Hn,this,RA).call(this,n)),this.addHook("beforeUpdateData",n=>_n(Hn,this,RA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:SA,relativeToGroup:Qa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SA)}disableCoreAPIModifiers(){hv(wc,this,!0)}enableCoreAPIModifiers(){hv(wc,this,!1)}onModifyRowData(e){if(!Qp(wc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Qp(wc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Qp(wc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function jbe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Ube(t,e,n){this.collapsingUI.toggleState(t,e,n)}function zbe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),hv(Ty,this,!0),this.dataManager.getData().slice()}function Ybe(t){return this.contextMenuUI.appendOptions(t)}function Gbe(t,e){this.headersUI.appendLevelIndicators(t,e)}function Kbe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function qbe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{hv(Ty,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Xbe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Jbe(){this.collapsingUI.collapsedRowsStash.stash()}function Zbe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Qbe(){this.collapsingUI.collapsedRowsStash.stash()}function eSe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function tSe(){this.dataManager.rewriteCache()}function nSe(){this.headersUI.updateRowHeaderWidth()}function rSe(t,e){Qp(Ty,this)&&(e.skipRender=!0)}function RA(t){if(!U$(t)){KE(Bbe),this.hot.getSettings()[dv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function bS(t,e,n){return(e=iSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iSe(t){var e=oSe(t,"string");return typeof e=="symbol"?e:e+""}function oSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sSe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;bS(this,"rootWindow",void 0),bS(this,"prefix",void 0),bS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){P(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function aSe(t,e,n){return(e=lSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lSe(t){var e=uSe(t,"string");return typeof e=="symbol"?e:e+""}function uSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}oe.getSingleton().register("persistentStateSave");oe.getSingleton().register("persistentStateLoad");oe.getSingleton().register("persistentStateReset");const EA="persistentState",cSe=0;class hSe extends Je{constructor(){super(...arguments),aSe(this,"storage",void 0)}static get PLUGIN_KEY(){return EA}static get PLUGIN_PRIORITY(){return cSe}isEnabled(){return!!this.hot.getSettings()[EA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new sSe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function dSe(t,e){fSe(t,e),e.add(t)}function fSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SS(t,e,n){return(e=gSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gSe(t){var e=mSe(t,"string");return typeof e=="symbol"?e:e+""}function mSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RS="search",pSe=190,wSe="htSearchResult",vSe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},ySe=function(t,e,n){return $t(t)||t===null||!t.toLocaleLowerCase||t.length===0||$t(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var ES=new WeakSet;class CSe extends Je{constructor(){super(...arguments),dSe(this,ES),SS(this,"callback",vSe),SS(this,"queryMethod",ySe),SS(this,"searchResultClass",wSe)}static get PLUGIN_KEY(){return RS}static get PLUGIN_PRIORITY(){return pSe}isEnabled(){return this.hot.getSettings()[RS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[RS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return TA(ES,e,MA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return TA(ES,e,MA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){De(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function MA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function wp(t,e,n){return(e=bSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bSe(t){var e=SSe(t,"string");return typeof e=="symbol"?e:e+""}function SSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DV{constructor(e){wp(this,"viewportWidth",void 0),wp(this,"overwriteColumnWidthFn",void 0),wp(this,"baseWidths",new Map),wp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class RSe extends DV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=th?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=th){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,w=g;o.includes(f)||(w=Math.round(g*l)),this.stretchedWidths.set(f,w),u=f,d<i.length-1&&(c+=w)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function _A(t,e,n){ESe(t,e),e.set(t,n)}function ESe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TS(t,e){return t.get(kV(t,e))}function vp(t,e,n){return t.set(kV(t,e),n),n}function kV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yp=new WeakMap,Hd=new WeakMap;class TSe extends DV{constructor(){super(...arguments),_A(this,yp,0),_A(this,Hd,-1)}prepare(e){super.prepare(e),vp(yp,this,0),vp(Hd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),vp(Hd,this,e),vp(yp,this,n)}calculate(){if(TS(Hd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+TS(yp,this),0);this.stretchedWidths.set(TS(Hd,this),n)}}function MSe(t,e){$V(t,e),e.add(t)}function Cp(t,e,n){$V(t,e),e.set(t,n)}function $V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zt(t,e){return t.get(kc(t,e))}function MS(t,e,n){return t.set(kc(t,e),n),n}function kc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _Se="stretchColumns";var Kn=new WeakMap,vc=new WeakMap,_S=new WeakMap,bp=new WeakMap,Nd=new WeakSet;class xSe{constructor(e){MSe(this,Nd),Cp(this,Kn,void 0),Cp(this,vc,void 0),Cp(this,_S,new Map([["all",new RSe(kc(Nd,this,xA).bind(this))],["last",new TSe(kc(Nd,this,xA).bind(this))]])),Cp(this,bp,"none"),MS(Kn,this,e),MS(vc,this,Zt(Kn,this).columnIndexMapper.createAndRegisterIndexMap(_Se,"physicalIndexToValue"))}useStrategy(e){MS(bp,this,Zt(_S,this).has(e)?e:"none")}refreshStretching(){if(Zt(bp,this)==="none"){Zt(vc,this).clear();return}Zt(Kn,this).batchExecution(()=>{Zt(vc,this).clear();const e=Zt(_S,this).get(Zt(bp,this));let r=Zt(Kn,this).view.getViewportWidth();kc(Nd,this,PSe).call(this)&&(r-=Pn(Zt(Kn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Zt(Kn,this).countCols();i++)Zt(Kn,this).columnIndexMapper.isHidden(Zt(Kn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,kc(Nd,this,ISe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Zt(vc,this).setValueAtIndex(Zt(Kn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Zt(vc,this).getValueAtIndex(Zt(Kn,this).toPhysicalColumn(e))}}function PSe(){const{view:t}=Zt(Kn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Zt(Kn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=Zt(Kn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function ISe(t){var e;return(e=Zt(Kn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:th}function xA(t,e){return Zt(Kn,this).runHooks("beforeStretchingColumnWidth",t,e)}function OSe(t,e){LV(t,e),e.add(t)}function xS(t,e,n){LV(t,e),e.set(t,n)}function LV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e,n){return t.set(fv(t,e),n),n}function Es(t,e){return t.get(fv(t,e))}function fv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ASe="stretchColumns",HSe=155;var _c=new WeakMap,Sp=new WeakMap,Dd=new WeakMap,IS=new WeakSet;class NSe extends Je{constructor(){super(...arguments),OSe(this,IS),xS(this,_c,new xSe(this.hot)),xS(this,Sp,null),xS(this,Dd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Es(Sp,this)!==null&&Es(Sp,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),PS(Sp,this,i.width)})})}))}static get PLUGIN_KEY(){return ASe}static get PLUGIN_PRIORITY(){return HSe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Es(_c,this).useStrategy(this.hot.getSettings().stretchH),Es(Dd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fv(IS,e,kSe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fv(IS,e,DSe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Es(_c,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Es(Dd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Es(_c,this).getStretchedWidth(e)}destroy(){Es(Dd,this).disconnect(),PS(Dd,this,null),PS(_c,this,null),super.destroy()}}function DSe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function kSe(t){t&&Es(_c,this).refreshStretching()}function $Se(t,e){LSe(t,e),e.add(t)}function LSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rp(t,e,n){return(e=FSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FSe(t){var e=VSe(t,"string");return typeof e=="symbol"?e:e+""}function VSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const BSe="touchScroll",WSe=200;var Ep=new WeakSet;class jSe extends Je{constructor(){super(...arguments),$Se(this,Ep),Rp(this,"scrollbars",[]),Rp(this,"clones",[]),Rp(this,"lockedCollection",!1),Rp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return BSe}static get PLUGIN_PRIORITY(){return WSe}static get SETTING_KEYS(){return!0}isEnabled(){return jE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>OS(Ep,this,USe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>OS(Ep,this,zSe).call(this)),this.addHook("afterMomentumScroll",()=>OS(Ep,this,YSe).call(this))}}function USe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function zSe(){this.freezeOverlays=!0,P(this.clones,t=>{X(t,"hide-tween")})}function YSe(){this.freezeOverlays=!1,P(this.clones,t=>{we(t,"hide-tween"),X(t,"show-tween")}),this.hot._registerTimeout(()=>{P(this.clones,t=>{we(t,"show-tween")})},400),P(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function GSe(t,e){KSe(t,e),e.add(t)}function KSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qSe(t,e,n){return(e=XSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XSe(t){var e=JSe(t,"string");return typeof e=="symbol"?e:e+""}function JSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZSe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ew="trimRows",QSe=330;var PA=new WeakSet;class eRe extends Je{constructor(){super(...arguments),GSe(this,PA),qSe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return ew}static get PLUGIN_PRIORITY(){return QSe}isEnabled(){return!!this.hot.getSettings()[ew]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Sg),this.trimmedRowsMap.addLocalHook("init",()=>ZSe(PA,this,tRe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[ew];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),P(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(P(e,l=>{o[l]=!1}),i=En(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function tRe(){const t=this.hot.getSettings()[ew];Array.isArray(t)&&this.hot.batchExecution(()=>{P(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function nRe(t,e,n){return(e=rRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rRe(t){var e=iRe(t,"string");return typeof e=="symbol"?e:e+""}function iRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hi{constructor(e){nRe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Tp(t,e,n){return(e=oRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oRe(t){var e=sRe(t,"string");return typeof e=="symbol"?e:e+""}function sRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L_ extends Hi{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Tp(this,"stateBefore",void 0),Tp(this,"range",void 0),Tp(this,"type",void 0),Tp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new L_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){P(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){va(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function IA(t,e,n){return(e=aRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aRe(t){var e=lRe(t,"string");return typeof e=="symbol"?e:e+""}function lRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F_ extends Hi{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),IA(this,"columns",void 0),IA(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new F_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),H_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function OA(t,e,n){return(e=uRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uRe(t){var e=cRe(t,"string");return typeof e=="symbol"?e:e+""}function cRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V_ extends Hi{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),OA(this,"previousSortState",void 0),OA(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new V_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function AA(t,e,n){return(e=hRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hRe(t){var e=dRe(t,"string");return typeof e=="symbol"?e:e+""}function dRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B_ extends Hi{constructor(e){let{index:n,amount:r}=e;super("insert_col"),AA(this,"index",void 0),AA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new B_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function HA(t,e,n){return(e=fRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fRe(t){var e=gRe(t,"string");return typeof e=="symbol"?e:e+""}function gRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W_ extends Hi{constructor(e){let{index:n,amount:r}=e;super("insert_row"),HA(this,"index",void 0),HA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new W_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Mp(t,e,n){return(e=mRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mRe(t){var e=pRe(t,"string");return typeof e=="symbol"?e:e+""}function pRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j_ extends Hi{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Mp(this,"changes",void 0),Mp(this,"selected",void 0),Mp(this,"countCols",void 0),Mp(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new j_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=tr(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=tr(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function NA(t,e,n){return(e=wRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wRe(t){var e=vRe(t,"string");return typeof e=="symbol"?e:e+""}function vRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U_ extends Hi{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),NA(this,"conditionsStack",void 0),NA(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new U_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function yRe(t,e,n){return(e=CRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CRe(t){var e=bRe(t,"string");return typeof e=="symbol"?e:e+""}function bRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z_ extends Hi{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),yRe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new z_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function FV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function ys(t,e,n){return(e=SRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SRe(t){var e=RRe(t,"string");return typeof e=="symbol"?e:e+""}function RRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y_ extends Hi{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),ys(this,"index",void 0),ys(this,"indexes",void 0),ys(this,"data",void 0),ys(this,"amount",void 0),ys(this,"headers",void 0),ys(this,"columnPositions",void 0),ys(this,"rowPositions",void 0),ys(this,"fixedColumnsStart",void 0),ys(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const w=[],C=l[g];fe(u,c,R=>{w.push(C[e.toPhysicalColumn(R)])}),h.push(w)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new Y_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:FV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(ze(this.data[c],o));const l=ze(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),P(e.getSourceDataArray(),(c,h)=>{P(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&P(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function yc(t,e,n){return(e=ERe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ERe(t){var e=TRe(t,"string");return typeof e=="symbol"?e:e+""}function TRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G_ extends Hi{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),yc(this,"index",void 0),yc(this,"data",void 0),yc(this,"fixedRowsBottom",void 0),yc(this,"fixedRowsTop",void 0),yc(this,"rowIndexesSequence",void 0),yc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=tr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new G_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:FV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function DA(t,e,n){return(e=MRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MRe(t){var e=_Re(t,"string");return typeof e=="symbol"?e:e+""}function _Re(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K_ extends Hi{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),DA(this,"rows",void 0),DA(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new K_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),H_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function xRe(t,e,n){return(e=PRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PRe(t){var e=IRe(t,"string");return typeof e=="symbol"?e:e+""}function IRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q_ extends Hi{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),xRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new q_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function ORe(t,e){[L_,F_,V_,B_,W_,j_,U_,z_,Y_,G_,K_,q_].forEach(n=>n.startRegisteringEvents(t,e))}function ARe(t,e){HRe(t,e),e.add(t)}function HRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AS(t,e,n){return(e=NRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NRe(t){var e=DRe(t,"string");return typeof e=="symbol"?e:e+""}function DRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kA="undoRedo",kRe="undoRedo",$Re=1e3;oe.getSingleton().register("beforeUndo");oe.getSingleton().register("afterUndo");oe.getSingleton().register("beforeRedo");oe.getSingleton().register("afterRedo");const $A=new Set;var _p=new WeakSet;class LRe extends Je{static get PLUGIN_KEY(){return kRe}static get PLUGIN_PRIORITY(){return $Re}static get SETTING_KEYS(){return!0}constructor(e){super(e),ARe(this,_p),AS(this,"doneActions",[]),AS(this,"undoneActions",[]),AS(this,"ignoreNewActions",!1),ORe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return HS(_p,e,FRe).call(e,...r)}),this.registerShortcuts(),HS(_p,this,VRe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),HS(_p,this,BRe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:kA};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kA)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=tr(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=tr(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function FRe(t,e){e==="loadData"&&this.clear()}function VRe(){const t=e=>{$A.has(e)||(ot(mt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),$A.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function BRe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function WRe(){Xe(tf),Xe(Kue),Xe(nf),Xe(Tce),Xe(Hce),Xe(aF),Xe(xhe),Xe(dde),Xe(vy),Xe(bfe),Xe(Gfe),Xe(tge),Xe(by),Xe($ge),Xe(Ape),Xe(hwe),Xe(Lwe),Xe(Xwe),Xe(lve),Xe(yve),Xe(Pve),Xe(Gve),Xe(nye),Xe(Gye),Xe(TCe),Xe(ICe),Xe(nbe),Xe(Wbe),Xe(hSe),Xe(CSe),Xe(NSe),Xe(jSe),Xe(eRe),Xe(LRe)}function jRe(){vae(),Ble(),Xle(),pue(),WRe()}function URe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var NS,DS,kS,$S,LS;jRe();URe(Te);Te.__GhostTable=w_;Te._getListenersCounter=yZ;Te._getRegisteredMapsCounter=Fre;Te.EventManager=Mi;const zRe=[b8,PJ,vre,jle,MJ,uJ,T8,wQ,TJ,_8,AJ,pQ],YRe=[oJ,HJ];Te.helper={};Te.dom={};P(zRe,t=>{P(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.helper[e]=t[e])})});P(YRe,t=>{P(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.dom[e]=t[e])})});Te.cellTypes=(NS=Te.cellTypes)!==null&&NS!==void 0?NS:{};P(Uie(),t=>{Te.cellTypes[t]=XM(t)});Te.cellTypes.registerCellType=di;Te.cellTypes.getCellType=XM;Te.editors=(DS=Te.editors)!==null&&DS!==void 0?DS:{};P(fZ(),t=>{Te.editors[`${er(t)}Editor`]=Pw(t)});Te.editors.registerEditor=xr;Te.editors.getEditor=Pw;Te.renderers=(kS=Te.renderers)!==null&&kS!==void 0?kS:{};P(AQ(),t=>{const e=Iw(t);t==="base"&&(Te.renderers.cellDecorator=e),Te.renderers[`${er(t)}Renderer`]=e});Te.renderers.registerRenderer=zr;Te.renderers.getRenderer=Iw;Te.validators=($S=Te.validators)!==null&&$S!==void 0?$S:{};P(DQ(),t=>{Te.validators[`${er(t)}Validator`]=tT(t)});Te.validators.registerValidator=ql;Te.validators.getValidator=tT;Te.plugins=(LS=Te.plugins)!==null&&LS!==void 0?LS:{};P(eT(),t=>{Te.plugins[t]=vg(t)});Te.plugins[`${er(Je.PLUGIN_KEY)}Plugin`]=Je;Te.plugins.registerPlugin=Xe;Te.plugins.getPlugin=vg;let vf=null,sn=new Map,xc={row:-1,col:-1,time:0};function Cs(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return t===void 0?(o="undefined",s.readOnly=!1):typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function hi(t,e,n){let r=[],i=!0,o=new Map;const s={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback},a=n.dataPathString||"";if(Array.isArray(t)){const l=t.length>0?t[0]:null;if(l&&typeof l=="object"&&l!==null&&!Array.isArray(l)){let u=Object.keys(l);if(u.length===0){for(let c=1;c<t.length;c++)if(t[c]&&typeof t[c]=="object"&&Object.keys(t[c]).length>0){u=Object.keys(t[c]);break}}i=u.length>0?u:t.length>0?["(내용 없음)"]:["새 열"],t.forEach((c,h)=>{const d=[],f=typeof c=="object"&&c!==null?c:{};i.forEach((g,w)=>{const C=f[g],R=`${a}[${h}]`,{displayValue:y,cellMeta:M}=Cs(C,R,g,!1,s);d.push(y),o.set(`${h}-${w}`,M)}),r.push(d)}),t.length===0&&Array.isArray(i)&&i.length===1&&(i[0]==="새 열"||i[0]==="(내용 없음)"||i[0])}else i=["Index","Value"],r=t.map((u,c)=>{const h=a,{displayValue:d,cellMeta:f}=Cs(c,h,String(c),!0,s),{displayValue:g,cellMeta:w}=Cs(u,h,String(c),!1,s);return o.set(`${c}-0`,f),o.set(`${c}-1`,w),[d,g]})}else if(typeof t=="object"&&t!==null){const l=Object.keys(t);if(l.length>0&&l.every(c=>Array.isArray(t[c]))){let c=0;l.forEach(d=>{c=Math.max(c,t[d].length)});const h=["항목 (Key)"];for(let d=0;d<c;d++)h.push(String(d));i=h,r=l.map((d,f)=>{const g=t[d],w=[],C=a,{displayValue:R,cellMeta:y}=Cs(d,C,d,!0,s);w.push(R),o.set(`${f}-0`,y);for(let M=0;M<c;M++)if(M<g.length){const x=g[M],_=`${a?a+".":""}${d}`,{displayValue:T,cellMeta:I}=Cs(x,_,String(M),!1,s);w.push(T),o.set(`${f}-${1+M}`,I)}else w.push(""),o.set(`${f}-${1+M}`,{readOnly:!0,originalValue:null,isPadding:!0});return w})}else i=["항목 (Key)","값 (Value)"],r=l.map((c,h)=>{const d=t[c],f=a,{displayValue:g,cellMeta:w}=Cs(c,f,c,!0,s),{displayValue:C,cellMeta:R}=Cs(d,f,c,!1,s);return o.set(`${h}-0`,w),o.set(`${h}-1`,R),[g,C]})}else{i=["항목","값"];const l=e||(t==null?String(t):"Value"),u=a,{displayValue:c,cellMeta:h}=Cs(l,u,"",!0,s),{displayValue:d,cellMeta:f}=Cs(t,u,"",!1,s);o.set("0-0",h),o.set("0-1",f),r=[[c,d]]}return{preparedHotData:r,preparedColHeaders:i,preparedCellMetaMap:o}}function VV(){return vf&&(vf.destroy(),vf=null),sn.clear(),xc={row:-1,col:-1,time:0},null}function GRe(t,e,n){const r=n.tableViewDomElement;VV(),r&&(r.innerHTML="");const{preparedHotData:i,preparedColHeaders:o,preparedCellMetaMap:s}=hi(t,e,n);return sn=s,r?(vf=new Te(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{view_key_content:{name:"내용 보기 (View Content)",hidden:function(){const l=this.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row;if(u.col!==0||typeof t!="object"||t===null||Array.isArray(t))return!0;const d=Object.keys(t);if(c>=d.length)return!0;const f=d[c],g=t[f];return typeof g!="object"||g===null},callback:function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start){console.error("View Content callback: 유효하지 않은 selection 객체입니다.",l);return}const h=l[0].start.row,d=Object.keys(t);if(h>=d.length){console.error("View Content callback: 행 인덱스가 범위를 벗어났습니다.",h,d);return}const f=d[h],g=t[f];if(typeof g!="object"||g===null){console.error("View Content callback: 대상 값이 객체나 배열이 아닙니다.",g),Ve({title:"오류",text:"내용을 볼 수 있는 대상(객체/배열)이 아닙니다.",icon:"error",showCancelButton:!1,hotInstance:u});return}const w=n.dataPathString||"",C=w?`${w}.${f}`:f;n.displayTableCallback(g,f,n.rootJsonData,C)}},row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입"},col_right:{name:"오른쪽에 열 삽입"},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제"},"---------":Te.plugins.ContextMenu.SEPARATOR,duplicate_row:{name:"선택 행 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)||typeof t=="object"&&t!==null&&!Array.isArray(t)):!0},callback:async function(a,l){const u=this,c=l[0].start.row;if(Array.isArray(t)){if(c>=0&&c<t.length){const h=JSON.parse(JSON.stringify(t[c]));t.splice(c+1,0,h),n.refreshTreeViewCallback("row_duplicated_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=hi(t,e,n);sn=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}else if(typeof t=="object"&&t!==null){const h=Object.keys(t);if(c<0||c>=h.length)return;const d=h[c];let f=d+"_복제본",g=f,w=1;for(;t.hasOwnProperty(g);)g=`${f}_${w++}`;Ps({title:"새 키 입력 (행 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:C=>{const R=C.trim();return R?R!==d&&t.hasOwnProperty(R)?"이미 사용 중인 키입니다.":/^\d+$/.test(R)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(C=>{if(C.isConfirmed&&C.value!==void 0){const R=C.value.trim(),y=JSON.parse(JSON.stringify(t[d])),M={};for(const I of Object.keys(t))M[I]=t[I],I===d&&(M[R]=y);Object.keys(t).forEach(I=>delete t[I]),Object.assign(t,M),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered");const{preparedHotData:x,preparedColHeaders:_,preparedCellMetaMap:T}=hi(t,e,n);sn=T,u.updateSettings({colHeaders:_}),u.loadData(x)}})}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])):!0},callback:async function(a,l){const u=this,c=l[0].start.col,h=u.getColHeader();if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])&&Array.isArray(h)&&c>=0&&c<h.length){const d=h[c];if(typeof d!="string")return;let f=d+"_복제본",g=f,w=1;for(;t[0].hasOwnProperty(g);)g=`${f}_${w++}`;Ps({title:"새 열 키 입력 (열 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:C=>{const R=C.trim();return R?t.length>0&&t[0].hasOwnProperty(R)&&R!==d?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(R)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(C=>{if(C.isConfirmed&&C.value!==void 0){const R=C.value.trim();t.forEach(_=>{if(typeof _=="object"&&_!==null){const T=_.hasOwnProperty(d)?JSON.parse(JSON.stringify(_[d])):null,I={};let Y=!1;for(const U in _)_.hasOwnProperty(U)&&(I[U]=_[U],U===d&&(I[R]=T,Y=!0));Y||(I[R]=T),Object.keys(_).forEach(U=>delete _[U]),Object.assign(_,I)}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered");const{preparedHotData:y,preparedColHeaders:M,preparedCellMetaMap:x}=hi(t,e,n);sn=x,u.updateSettings({colHeaders:M}),u.loadData(y)}})}}},set_template:{name:"템플릿으로 채우기",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=sn.get(`${c}-${h}`);if(d&&d.isPadding)return!0;const f=a.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:sn};return kd(c,h,g)===null},callback:async function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col;u&&typeof u.deselectCell=="function"&&u.deselectCell();const f=n.getTemplates();if(!f||f.length===0){Ve({title:"알림",text:"사용 가능한 템플릿이 없습니다. 먼저 템플릿을 추가해주세요.",icon:"info",showCancelButton:!1,hotInstance:u});return}const g={};f.forEach((C,R)=>{g[`tpl_idx_${R}`]=C.name});const{value:w}=await bi.fire({title:"템플릿 선택 (Select Template)",input:"select",inputOptions:g,inputPlaceholder:"적용할 템플릿을 선택하세요",showCancelButton:!0,confirmButtonText:"적용 (Apply)",cancelButtonText:"취소 (Cancel)",customClass:{popup:"custom-swal-popup"}});if(w){const C=parseInt(w.replace("tpl_idx_",""),10),R=f[C].value,y=JSON.stringify(R),M=u.getColHeader(),x={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(M)?M:M===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:sn},_=kd(h,d,x);if(_!==null){n.updateJsonDataCallback(_,y,!1);let T=t;const I=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;n.dataPathString?T=n.getObjectByPathCallback(I,n.dataPathString):T=I,T===void 0&&(T=_.includes("[")||_.includes(".")?{}:null);const{preparedHotData:Y,preparedColHeaders:U,preparedCellMetaMap:V}=hi(T,e,n);sn=V,u.updateSettings({colHeaders:U}),u.loadData(Y)}else Ve({title:"오류",text:"템플릿을 적용할 수 없는 셀입니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},add_as_template:{name:"템플릿에 추가",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=a.getColHeader(),f={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(d)?d:d===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:sn},g=kd(c,h,f);if(g===null)return!0;const w=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,C=n.getObjectByPathCallback(w,g);return!(typeof C=="object"&&C!==null)},callback:async function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col,f=u.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:sn},w=kd(h,d,g);if(w===null)return;const C=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,R=n.getObjectByPathCallback(C,w);if(!(typeof R=="object"&&R!==null)){Ve({title:"알림",text:"객체 또는 배열 형식의 값만 템플릿으로 추가할 수 있습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}u&&typeof u.deselectCell=="function"&&u.deselectCell();const{value:y}=await Ps({title:"새 템플릿 이름 입력",inputLabel:"저장할 템플릿의 이름을 입력하세요:",inputValue:"",confirmButtonText:"추가",inputValidator:M=>{const x=M.trim();return x?n.getTemplates().some(T=>T.name===x)?"이미 사용중인 템플릿 이름입니다.":null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:u});if(y&&y.trim()){const M=Array.isArray(R)?"array":"object",x=n.addTemplate(y.trim(),M,R);Ve(x===!0?{title:"성공",text:`템플릿 "${y.trim()}"이(가) 추가되었습니다.`,icon:"success",showCancelButton:!1,hotInstance:u}:x==="duplicate_name"?{title:"오류",text:`템플릿 이름 "${y.trim()}"이(가) 이미 존재합니다. 다른 이름을 사용해주세요.`,icon:"error",showCancelButton:!1,hotInstance:u}:{title:"오류",text:"템플릿 추가에 실패했습니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(a,l,u){const c={},h=sn.get(`${a}-${l}`);return h&&(c.readOnly=h.readOnly,h.isDrillable&&(c.renderer=function(d,f,g,w,C,R){Te.renderers.TextRenderer.apply(this,arguments),f.style.color="#007bff",f.style.textDecoration="underline",f.style.cursor="pointer"})),c},afterOnCellMouseDown:function(a,l,u){if(a.button!==0)return;const c=new Date().getTime(),{row:h,col:d}=l,f=sn.get(`${h}-${d}`),g=300;let w=!1;if(f&&h===xc.row&&d===xc.col&&c-xc.time<g?(w=!0,xc={row:-1,col:-1,time:0}):xc={row:h,col:d,time:c},w){let C=!1;const R=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(R)&&R.length>0&&R[0]==="항목 (Key)"&&d===0&&f&&(C=!0),C){const y=f.originalKey,M=t,x=n.dataPathString;Ps({title:`키 이름 변경: "${y}"`,inputValue:y,customClass:{popup:"custom-swal-popup"},confirmButtonText:"저장",inputValidator:_=>{const T=_.trim();return T?/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다!":M.hasOwnProperty(T)&&T!==y?"이미 사용 중인 키입니다!":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:this}).then(_=>{if(_.isConfirmed&&_.value!==void 0){const T=_.value.trim();T!==y&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(x,y,T,M)}});return}}if(f&&f.isDrillable&&f.originalValue!==void 0){const C=typeof t=="object"&&t!==null&&!Array.isArray(t)&&d===0&&f&&f.isDrillable;(!w||w&&!C&&f.drillPath)&&typeof f.originalValue=="object"&&f.originalValue!==null&&n.displayTableCallback(f.originalValue,f.originalKey,n.rootJsonData,f.drillPath)}},afterChange:function(a,l){if(l==="loadData"||!a||!Array.isArray(a)||a.length===0)return;const u=l==="CopyPaste.paste"||l==="Autofill.fill"||a.length>1,c=this.getColHeader();a.forEach(([h,d,f,g])=>{let w=-1;if(typeof d=="number"?w=d:typeof d=="string"&&Array.isArray(c)&&(w=c.indexOf(d)),w===-1)if(typeof d=="number"&&c===!0)w=d;else{console.warn("afterChange: 컬럼 인덱스 결정 불가:",h,d,c);return}const C={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(c)?c:c===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:sn};let R=kd(h,w,C);R!==null&&(n.updateJsonDataCallback(R,String(g),u,f),n.convertToTypedValueCallback(String(g),f))}),u&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_update_handsontable_afterChange")},afterCreateRow:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)){const f=c.getColHeader();for(let g=0;g<l;g++){let w=null;Array.isArray(f)&&f.length>0&&(f.length!==2||f[0]!=="Index"||f[1]!=="Value")&&(w={},f.forEach(C=>{typeof C=="string"&&(w[C]=null)})),h.splice(a+g,0,w)}d=!0,d&&n.refreshTreeViewCallback("row_added_array_hot")}else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){(async()=>{let f={...h},g=0;for(let y=0;y<l;y++){const M=a+y,x=await Ps({title:`새 항목 키 입력 (${y+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:_=>{const T=_.trim();return T?f.hasOwnProperty(T)?"이미 사용 중인 키입니다.":/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(x.isConfirmed&&x.value!==void 0){const _=x.value.trim(),T=null,I=Object.keys(f),Y={};let U=!1;for(let V=0;V<I.length;V++)V===M&&!U&&(Y[_]=T,U=!0),Y[I[V]]=f[I[V]];U||(Y[_]=T),f=Y,g++}else break}g>0&&(Object.keys(h).forEach(y=>delete h[y]),Object.assign(h,f),d=!0,n.refreshTreeViewCallback("key_added_object_hot_ordered"));const{preparedHotData:w,preparedColHeaders:C,preparedCellMetaMap:R}=hi(h,e,n);sn=R,c.updateSettings({colHeaders:C}),c.loadData(w)})();return}if(d||u!=="loadData"){const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:w}=hi(h,e,n);sn=w,c.updateSettings({colHeaders:g}),c.loadData(f)}},afterCreateCol:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){(async()=>{for(let C=0;C<l;C++){const R=a+C,y=await Ps({title:`새 열(속성)의 키 입력 (${C+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:M=>{const x=M.trim();return x?h[0].hasOwnProperty(x)?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(x)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(y.isConfirmed&&y.value!==void 0){const M=y.value.trim();h.forEach(x=>{if(typeof x=="object"&&x!==null){const _=Object.keys(x),T={};let I=!1;if(R>=_.length)x[M]=null;else{for(let Y=0;Y<_.length;Y++)Y===R&&!I&&(T[M]=null,I=!0),T[_[Y]]=x[_[Y]];I||(T[M]=null),Object.keys(x).forEach(Y=>delete x[Y]),Object.assign(x,T)}}}),d=!0}else break}d&&n.refreshTreeViewCallback("col_added_array_of_obj_hot_ordered");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:w}=hi(h,e,n);sn=w,c.updateSettings({colHeaders:g}),c.loadData(f)})();return}else if(typeof h=="object"&&h!==null&&!Array.isArray(h))Ve({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c}).then(()=>{const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:w}=hi(h,e,n);sn=w,c.updateSettings({colHeaders:g}),c.loadData(f)});else{Ve({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c});const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:w}=hi(h,e,n);sn=w,c.updateSettings({colHeaders:g}),c.loadData(f)}},beforeRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;if(u.sort((d,f)=>f-d),Array.isArray(h))u.forEach(d=>{d>=0&&d<h.length&&h.splice(d,1)});else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=Object.keys(h),f=u.map(g=>d[g]).filter(g=>g!==void 0);f.length>0&&f.forEach(g=>{delete h[g]})}else return!1;return!0},afterRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef||c==="ContextMenu.remove_row_custom")return;const h=this;let d=t;n.refreshTreeViewCallback("row_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:w}=hi(d,e,n);sn=w,h.updateSettings({colHeaders:g}),h.loadData(f)},beforeRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;const d=this.getColHeader();if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){if(!Array.isArray(d))return Ve({title:"오류",text:"열 헤더 정보를 가져올 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1;u.sort((f,g)=>g-f),u.forEach(f=>{if(f>=0&&f<d.length){const g=d[f];typeof g=="string"&&h.forEach(w=>{typeof w=="object"&&w!==null&&delete w[g]})}})}else return typeof h=="object"&&h!==null&&!Array.isArray(h)?(Ve({title:"오류",text:"이 뷰에서 특정 열 부분 삭제는 지원되지 않습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1):(Ve({title:"오류",text:"현재 데이터 구조에서는 열을 삭제할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1);return!0},afterRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return;const h=this;let d=t;n.refreshTreeViewCallback("col_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:w}=hi(d,e,n);sn=w,h.updateSettings({colHeaders:g}),h.loadData(f)}}),vf):(console.error("Handsontable 컨테이너를 찾을 수 없습니다."),null)}function kd(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a,cellMetaMap:l}=n;let u="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const c=o[e];u=`[${t}].${c}`}else return null;else if(e===1)u=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){const c=l.get(`${t}-0`);if(!c||c.originalKey===void 0)return null;const h=c.originalKey;if(e===0)return null;const d=Array.isArray(o)&&o.length>1&&o[0]==="항목 (Key)"&&!isNaN(parseInt(o[1],10)),f=Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)";if(d)if(e>0&&e<o.length){const g=o[e],w=r[h];if(Array.isArray(w)){const C=l.get(`${t}-${e}`);if(C&&C.isPadding)return null;u=`.${h}[${g}]`}else return null}else return null;else if(f)if(e===1)u=`.${h}`;else return null;else return Object.keys(r).length===0&&Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)",null}else return t===0&&e===1?i||"":null;return i?u.startsWith(".")||u.startsWith("[")?i+u:u?i+"."+u:i:u.startsWith(".")?u.substring(1):u}let qi=[],eo=-1;const KRe=30;let X_=!1;function qRe(){qi=[],eo=-1,X_=!1}function XRe(t){if(X_)return;const{dataPathString:e,dataKeyName:n}=t,r=qi[eo];r&&r.dataPathString===e&&r.dataKeyName===n||(eo<qi.length-1&&(qi=qi.slice(0,eo+1)),qi.push({dataPathString:e,dataKeyName:n}),eo=qi.length-1,qi.length>KRe&&(qi.shift(),eo--))}function JRe(t){let e=!1,n=eo;return t==="back"&&eo>0?(n--,e=!0):t==="forward"&&eo<qi.length-1&&(n++,e=!0),e?(eo=n,qi[eo]):null}function LA(t){X_=t}function ZRe(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function QRe(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=ZRe(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function FA(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}const gv="userJsonEditorTemplates_v1";let Dr=[];const xa=[{name:"빈 객체 (Empty Object)",type:"object",value:{},isDefault:!0},{name:"빈 배열 (Empty Array)",type:"array",value:[],isDefault:!0}];function mv(){try{const t=localStorage.getItem(gv);if(t){const e=JSON.parse(t);if(Array.isArray(e)){const n=e.filter(r=>!r.isDefault&&!xa.some(i=>i.name===r.name));Dr=[...xa,...n]}else Dr=[...xa]}else Dr=[...xa]}catch{Dr=[...xa]}return J_(),Dr}function e0e(){return(Dr.length===0&&localStorage.getItem(gv)===null||Dr.length===0&&localStorage.getItem(gv)!==null)&&mv(),Dr}function t0e(t,e,n){if(!t||!e||n===void 0)return!1;const r=t.trim();if(Dr.some(o=>o.name===r))return"duplicate_name";const i={name:r,type:e,value:JSON.parse(JSON.stringify(n)),isDefault:!1};return Dr.push(i),J_(),!0}function J_(){try{const t=Dr.map(e=>{const n=xa.find(r=>r.name===e.name);return{...e,isDefault:!!n}});localStorage.setItem(gv,JSON.stringify(t))}catch(t){console.error("Error saving templates to localStorage:",t)}}function n0e(t){if(!Array.isArray(t))return 0;const r=t.map(i=>({name:String(i.name||"Unnamed Template").trim(),type:i.type==="object"||i.type==="array"?i.type:"object",value:JSON.parse(JSON.stringify(i.value||{})),isDefault:!1})).filter(i=>!xa.some(o=>o.name===i.name)).filter((i,o,s)=>o===s.findIndex(a=>a.name===i.name));return Dr=[...xa,...r],J_(),r.length}function r0e(){return Dr.length===0&&mv(),Dr.filter(t=>!t.isDefault)}mv();const BV="selected_theme_json_editor",pv=[{buttonId:"theme-btn-1",themeClass:"theme-soft-dark",name:"Soft Dark"},{buttonId:"theme-btn-2",themeClass:"theme-classic-purple",name:"Classic Purple Light"},{buttonId:"theme-btn-3",themeClass:"theme-soft-mint",name:"Soft Mint"}],WV="theme-classic-purple";let FS=null,su=null,Pc=null;function y0(t){Pc||(Pc=document.body),pv.forEach(n=>{Pc.classList.contains(n.themeClass)&&Pc.classList.remove(n.themeClass)});let e=WV;t&&pv.some(n=>n.themeClass===t)&&(e=t),Pc.classList.add(e),localStorage.setItem(BV,e),i0e(e)}function i0e(t){su&&su.forEach(e=>{const n=pv.find(r=>r.buttonId===e.id);n&&n.themeClass===t?e.classList.add("active-theme"):e.classList.remove("active-theme")})}function o0e(){su&&su.forEach(t=>{t.addEventListener("click",()=>{const e=pv.find(n=>n.buttonId===t.id);e&&y0(e.themeClass)})})}function s0e(){if(Pc=document.body,FS=document.querySelector(".theme-switcher"),!FS){console.warn("Theme switcher element not found by theme-switcher.js during initialization.");return}if(su=FS.querySelectorAll(".theme-button"),!su||su.length===0){console.warn("Theme buttons not found by theme-switcher.js during initialization.");return}o0e();const t=localStorage.getItem(BV);y0(t!==null?t:WV),console.log("Theme switcher initialized.")}let Se=null,au=null,As,yf,Jn,et=null;function a0e(){const t=document.getElementById("loadBtn");t&&t.addEventListener("click",My);const e=document.getElementById("saveBtn");e&&e.addEventListener("click",b0e);const n=document.getElementById("minifyBtn");n&&n.addEventListener("click",()=>{if(dt&&dt.value)try{dt.value=JV(dt.value)}catch(R){Ke&&(Ke.textContent="Minify 오류: "+R.message)}else dt&&(dt.value="")});const r=document.getElementById("uglifyBtn");r&&r.addEventListener("click",()=>{if(dt&&dt.value)try{dt.value=ZV(dt.value)}catch(R){Ke&&(Ke.textContent="Uglify(포맷팅) 오류: "+R.message)}else dt&&(dt.value="")});const i=document.getElementById("diffBtn");i&&i.addEventListener("click",()=>{if(!au&&!Se){Ve({title:"알림",text:"먼저 JSON 데이터를 로드해주세요.",icon:"info",showCancelButton:!1,hotInstance:et});return}if(!au){Ve({title:"알림",text:"로드 시점의 원본 JSON 데이터가 없습니다. 변경사항을 비교할 수 없습니다.",icon:"info",showCancelButton:!1,hotInstance:et});return}Ej({title:"JSON 데이터 변경사항",jsonDiffData:{left:au,right:Se===null?{}:Se},buttons:[{text:"닫기",role:"confirm"}],hotInstance:et}).catch(y=>{Ve({title:"오류",text:"변경점 확인 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:et})})});const o=document.getElementById("loadFromFileBtn");o&&o.addEventListener("click",w0e);const s=document.getElementById("saveToFileBtn");s&&s.addEventListener("click",v0e);const a=document.getElementById("saveToCSV");a&&a.addEventListener("click",p0e);const l=document.getElementById("loadFromCSV");l&&l.addEventListener("click",g0e);const u=document.getElementById("loadTemplatesFromFileBtn");u&&u.addEventListener("click",y0e);const c=document.getElementById("saveTemplatesToFileBtn");c&&c.addEventListener("click",C0e),As=document.getElementById("searchInput"),yf=document.getElementById("searchTargetSelect"),Jn=document.getElementById("searchResultsDropdown"),As&&As.addEventListener("input",BA),yf&&yf.addEventListener("change",BA),document.addEventListener("click",R=>{Jn&&As&&!As.contains(R.target)&&!Jn.contains(R.target)&&(Jn.style.display="none")}),Jn&&Jn.addEventListener("click",R=>R.stopPropagation()),window.addEventListener("mousedown",R=>{(R.button===3||R.button===4)&&(R.preventDefault(),R.button===3?UA("back"):R.button===4&&UA("forward"))}),window.addEventListener("contextmenu",R=>{R.preventDefault()});const h=document.querySelector(".json-control-panel");h?(h.addEventListener("dragover",l0e),h.addEventListener("dragleave",u0e),h.addEventListener("drop",c0e)):console.warn(".json-control-panel 요소를 찾을 수 없어 드래그앤드롭 기능을 활성화할 수 없습니다.");const d=document.querySelector(".main-layout-triple-panel"),f=[document.querySelector(".json-control-panel"),document.querySelector(".tree-view-panel"),document.querySelector(".table-view-panel")],g=[document.getElementById("resizer-1"),document.getElementById("resizer-2")];d&&f.every(R=>R)&&g.every(R=>R)?(VA(d,f,g),window.addEventListener("resize",()=>VA(d,f,g)),g.forEach((R,y)=>{let M=!1,x=0,_=[];R.addEventListener("mousedown",Y=>{Y.preventDefault(),M=!0,x=Y.clientX,_=[f[y].offsetWidth,f[y+1].offsetWidth],document.addEventListener("mousemove",T),document.addEventListener("mouseup",I)});function T(Y){if(!M)return;const U=Y.clientX-x,V=50;let q=_[0]+U,ee=_[1]-U;q<V&&(q=V,ee=_[0]+_[1]-q),ee<V&&(ee=V,q=_[0]+_[1]-ee),f[y].style.flexBasis=`${q}px`,f[y+1].style.flexBasis=`${ee}px`}function I(){M&&(M=!1,document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",I))}})):console.warn("3-패널 레이아웃에 필요한 요소를 모두 찾을 수 없습니다. 리사이저가 동작하지 않을 수 있습니다.");const w=document.getElementById("encodeUrlBtn");w&&w.addEventListener("click",async()=>{const R=dt?dt.value:"";try{const y=await Mx({title:"URL 인코딩",initialInputValue:R,inputLabel:"인코딩할 원본 문자열:",outputLabel:"인코딩된 결과:",actionButtonText:"인코딩 실행",onExecuteAction:M=>{try{return h0e(M)}catch(x){return console.error("encodeUrlString 함수 실행 중 오류:",x),`오류: ${x.message}`}},confirmButtonText:"결과를 메인 편집기에 복사",cancelButtonText:"팝업 닫기",hotInstance:et});if(y.isConfirmed&&y.formData&&y.formData!==!1){const M=y.formData;dt&&(dt.value=M,rt&&un(rt,"결과가 메인 편집기에 복사되었습니다.",2e3))}else y.isDismissed&&y.dismiss==="cancel"?rt&&un(rt,"인코딩 팝업을 닫았습니다.",1500,"info"):y.isConfirmed&&y.formData}catch(y){console.error("URL 인코딩 팝업 처리 중 오류:",y),Ke&&(Ke.textContent="URL 인코딩 팝업 오류: "+y.message),rt&&un(rt,"URL 인코딩 팝업을 여는 중 문제가 발생했습니다.",3e3)}});const C=document.getElementById("decodeUrlBtn");C&&C.addEventListener("click",async()=>{const R=dt?dt.value:"";try{const y=await Mx({title:"URL 디코딩",initialInputValue:R,inputLabel:"디코딩할 URL 인코딩된 문자열:",outputLabel:"디코딩된 결과:",actionButtonText:"디코딩 실행",onExecuteAction:M=>{try{return d0e(M)}catch(x){return console.error("decodeUrlString 함수 실행 중 오류:",x),`오류: ${x.message}`}},confirmButtonText:"결과를 메인 편집기에 복사",cancelButtonText:"팝업 닫기",hotInstance:et});if(y.isConfirmed&&y.formData&&y.formData!==!1){const M=y.formData;dt&&(dt.value=M,rt&&un(rt,"결과가 메인 편집기에 복사되었습니다.",2e3))}else y.isDismissed&&y.dismiss==="cancel"?rt&&un(rt,"디코딩 팝업을 닫았습니다.",1500,"info"):y.isConfirmed&&y.formData}catch(y){console.error("URL 디코딩 팝업 처리 중 오류:",y),Ke&&(Ke.textContent="URL 디코딩 팝업 오류: "+y.message),rt&&un(rt,"URL 디코딩 팝업을 여는 중 문제가 발생했습니다.",3e3)}}),s0e()}function l0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.add("dragover-active"),t.dataTransfer.dropEffect="copy"}function u0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active")}function c0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active");const e=t.dataTransfer.files;if(e.length>0){const n=e[0];if(n.type==="application/json"||n.name.toLowerCase().endsWith(".json")){const r=new FileReader;r.onload=i=>{try{const o=i.target.result;dt?(dt.value=o,My(),un(rt,`${n.name} 파일이 드롭되어 로드되었습니다.`,3e3)):Ve({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:et})}catch(o){Ke&&(Ke.textContent=`파일 오류 (드롭): ${o.message}`),Ve({title:"파일 로드 오류 (드롭)",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:et})}},r.onerror=i=>{Ke&&(Ke.textContent="파일을 읽는 중 오류가 발생했습니다 (드롭)."),Ve({title:"파일 읽기 오류 (드롭)",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:et})},r.readAsText(n)}else Ve({title:"잘못된 파일 타입",text:"JSON 파일(.json)만 드롭해주세요.",icon:"warning",showCancelButton:!1,hotInstance:et})}}function VA(t,e,n){const r=t.offsetWidth,i=n.reduce((l,u)=>l+u.offsetWidth,0),o=r-i,s=[.1,.15,.75],a=50;if(o>0){let l=Math.max(a,Math.floor(o*s[0])),u=Math.max(a,Math.floor(o*s[1])),c=Math.max(a,o-l-u);l+u+c>o&&(c=o-l-u),e[0].style.flexBasis=`${l}px`,e[1].style.flexBasis=`${u}px`,e[2].style.flexBasis=`${c}px`}}function BA(){if(!As||!yf||!Jn)return;const t=As.value.trim().toLowerCase(),e=yf.value;if(!t){Jn.innerHTML="",Jn.style.display="none";return}if(Se==null){FA([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],Jn,t,WA);return}const n=QRe(t,e,Se);FA(n,Jn,t,WA)}function WA(t){t&&typeof Xa=="function"&&(Xa(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString||""),Jn&&(Jn.style.display="none"))}function h0e(t){if(typeof t!="string")throw new TypeError("입력값은 문자열이어야 합니다.");try{return encodeURIComponent(t)}catch(e){return console.error("URL 인코딩 중 오류 발생:",e),t}}function d0e(t){if(typeof t!="string")throw new TypeError("입력값은 문자열이어야 합니다.");try{return decodeURIComponent(t)}catch(e){return console.error("URL 디코딩 중 오류 발생:",e),t}}function VS(t){const e=[];let n="",r=!1;for(let i=0;i<t.length;i++){const o=t[i];o==='"'?r&&i+1<t.length&&t[i+1]==='"'?(n+='"',i++):r=!r:o===","&&!r?(e.push(n),n=""):n+=o}return e.push(n),e}function jA(t){if(typeof t!="string")return t;const e=t.trim();if(e.toLowerCase()==="null")return null;if(e.toLowerCase()==="true")return!0;if(e.toLowerCase()==="false")return!1;if(e==="")return null;if(e!==""&&!isNaN(Number(e))&&(e.includes(".")||/^-?\d+$/.test(e)||String(Number(e))===e.replace(/^0+(?=\d)/,"")))return Number(e);if(e.startsWith("[")&&e.endsWith("]")||e.startsWith("{")&&e.endsWith("}"))try{return JSON.parse(e)}catch{return e}return e}function f0e(t){const e=t.trim().split(/\r\n|\n|\r/);if(e.length===0)return[];let n=-1;for(let l=0;l<e.length;l++)if(e[l].trim()!==""){n=l;break}if(n===-1)return[];let r=VS(e[n]).map((l,u)=>{const c=l.trim();return c===""?`column_${u+1}`:c});const i=r.map(l=>l.toLowerCase()),o=["key","property","name","field","item"];if(r.length===2&&o.includes(i[0])&&i[1]==="value"){const l={};for(let u=n+1;u<e.length;u++){const c=e[u];if(c.trim()==="")continue;const h=VS(c);if(!h.every(d=>d.trim()==="")&&h.length>=2){const d=h[0].trim();if(d==="")continue;const f=h[1];l[d]=jA(f)}}return l}else{const l=[];for(let u=n+1;u<e.length;u++){const c=e[u];if(c.trim()==="")continue;const h=VS(c);if(h.every(w=>w.trim()===""))continue;const d={};let f=!1;const g=Math.max(r.length,h.length);for(let w=0;w<g;w++){const C=w<r.length&&r[w]?r[w]:`column_${w+1}`,R=h[w]!==void 0?h[w]:"",y=jA(R);d[C]=y,y!==null&&String(y).trim()!==""&&(f=!0)}f&&l.push(d)}return l}}async function g0e(){const t=document.createElement("input");t.type="file",t.accept=".csv,text/csv",t.style.display="none",t.addEventListener("change",e=>{const n=e.target.files[0];if(!n)return;const r=new FileReader;r.onload=i=>{try{const o=i.target.result,s=f0e(o);let a,l=`${n.name} CSV 파일이 성공적으로 JSON으로 변환 및 로드되었습니다.`;Array.isArray(s)?s.length>0?(a=s[0],s.length>1&&(console.warn("CSV contained multiple records; only the first record has been loaded into the editor. Subsequent records were ignored."),l=`${n.name} CSV 로드됨 (주의: 여러 레코드 중 첫 번째 레코드만 표시됨).`)):a=[]:typeof s=="object"&&s!==null?(a=s,l=`${n.name} Key-Value CSV가 단일 JSON 객체로 로드되었습니다.`):(console.error("Unexpected data type from CSV conversion:",s),a={},l=`${n.name} CSV 변환 중 예상치 못한 결과 발생.`);const u=JSON.stringify(a,null,2);dt?(dt.value=u,My(),un(rt,l,5e3)):Ve({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:et})}catch(o){console.error("CSV Parsing Error in loadCsvFromFile:",o),Ke&&(Ke.textContent=`CSV 파일 파싱 오류: ${o.message}`),Ve({title:"CSV 파일 파싱 오류",text:`CSV 파일을 JSON으로 변환하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:et})}},r.readAsText(n),t.parentNode===document.body&&document.body.removeChild(t)}),document.body.appendChild(t),t.click()}function m0e(t){if(t==null)throw new Error("데이터가 없어 CSV로 변환할 수 없습니다.");let e="";const n=r=>{if(r==null)return"";let i;return typeof r=="object"?i=JSON.stringify(r):i=String(r),(i.includes(",")||i.includes(`
`)||i.includes("\r")||i.includes('"'))&&(i='"'+i.replace(/"/g,'""')+'"'),i};if(Array.isArray(t)){if(t.length===0)return"";if(typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])){const r=[];if(t.forEach(i=>{typeof i=="object"&&i!==null&&Object.keys(i).forEach(o=>{r.includes(o)||r.push(o)})}),r.length>0)e+=r.map(n).join(",")+`\r
`;else if(t.every(i=>typeof i!="object"||i===null))return e+=`value\r
`,t.forEach(i=>{e+=n(i)+`\r
`}),e;t.forEach(i=>{if(typeof i=="object"&&i!==null){const o=r.map(s=>n(i[s]));e+=o.join(",")+`\r
`}else{const o=r.map(()=>n(null));e+=o.join(",")+`\r
`}})}else e+=`value\r
`,t.forEach(r=>{e+=n(r)+`\r
`})}else typeof t=="object"&&t!==null?(e+=`key,value\r
`,Object.keys(t).forEach(r=>{e+=n(r)+","+n(t[r])+`\r
`})):(e+=`value\r
`,e+=n(t)+`\r
`);return e}async function p0e(){if(Se==null){un(rt,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await Ps({title:"CSV 파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.csv 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:et});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".csv")||(e+=".csv");const n=m0e(Se),r=new Blob([n],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),un(rt,`${e} 파일이 성공적으로 CSV로 저장되었습니다!`,3e3)}else un(rt,"CSV 파일 저장이 취소되었습니다.",3e3)}catch(t){Ke&&(Ke.textContent="CSV 파일 저장/변환 오류: "+t.message),Ve({title:"CSV 저장/변환 오류",text:`JSON 데이터를 CSV로 저장하거나 변환하는 중 오류가 발생했습니다: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:et})}}function w0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",t.addEventListener("change",e=>{const n=e.target.files[0];if(!n)return;const r=new FileReader;r.onload=i=>{try{const o=i.target.result;dt?(dt.value=o,My(),un(rt,`${n.name} 파일이 로드되었습니다.`,3e3)):Ve({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:et})}catch(o){Ke&&(Ke.textContent=`파일 오류: ${o.message}`),Ve({title:"파일 로드 오류",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:et})}},r.onerror=i=>{Ke&&(Ke.textContent="파일을 읽는 중 오류가 발생했습니다."),Ve({title:"파일 읽기 오류",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:et})},r.readAsText(n),document.body.removeChild(t)}),document.body.appendChild(t),t.click()}async function v0e(){if(Se==null){un(rt,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await Ps({title:"파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:et});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".json")||(e+=".json");const n=JSON.stringify(Se,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),un(rt,`${e} 파일이 성공적으로 저장되었습니다!`,3e3)}else un(rt,"파일 저장이 취소되었습니다.",3e3)}catch(t){Ke&&(Ke.textContent="JSON 파일 저장 오류: "+t.message),Ve({title:"파일 저장 오류",text:`JSON 데이터를 파일로 저장하는 중 오류가 발생했습니다: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:et})}}function y0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",t.addEventListener("change",e=>{const n=e.target.files[0];if(!n)return;const r=new FileReader;r.onload=i=>{try{const o=i.target.result,s=JSON.parse(o);if(!Array.isArray(s))throw new Error("템플릿 파일은 배열 형태여야 합니다.");const a=n0e(s);un(rt,`템플릿 파일 '${n.name}'에서 ${a}개의 사용자 템플릿을 로드했습니다.`,3e3)}catch(o){Ke&&(Ke.textContent=`템플릿 파일 오류: ${o.message}`),Ve({title:"템플릿 파일 로드 오류",text:`템플릿 파일을 로드하거나 파싱하는 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:et})}},r.onerror=i=>{Ke&&(Ke.textContent="템플릿 파일을 읽는 중 오류가 발생했습니다."),Ve({title:"템플릿 파일 읽기 오류",text:"템플릿 파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:et})},r.readAsText(n),document.body.removeChild(t)}),document.body.appendChild(t),t.click()}async function C0e(){const t=r0e();if(!t||t.length===0){un(rt,"저장할 사용자 정의 템플릿이 없습니다.",3e3);return}try{const e=await Ps({title:"템플릿 파일 이름 입력",inputLabel:"저장할 템플릿 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"user_templates",confirmButtonText:"저장",inputValidator:n=>!n||n.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:et});if(e.isConfirmed&&e.value){let n=e.value.trim();n.toLowerCase().endsWith(".json")||(n+=".json");const r=JSON.stringify(t,null,2),i=new Blob([r],{type:"application/json"}),o=URL.createObjectURL(i),s=document.createElement("a");s.href=o,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o),un(rt,`사용자 템플릿이 ${n} 파일로 성공적으로 저장되었습니다!`,3e3)}else un(rt,"템플릿 파일 저장이 취소되었습니다.",3e3)}catch(e){Ke&&(Ke.textContent="템플릿 파일 저장 오류: "+e.message),Ve({title:"템플릿 파일 저장 오류",text:`템플릿을 파일로 저장하는 중 오류가 발생했습니다: ${e.message}`,icon:"error",showCancelButton:!1,hotInstance:et})}}function My(){S0e(),qRe();try{const t=dt.value.trim();if(!t){Se=null,au=null,Fc(null,Cf),tw();return}Se=JSON.parse(t),au=JSON.parse(JSON.stringify(Se));const e=jV();if(xt&&(xt.innerHTML=""),typeof Se=="object"&&Se!==null)Sf(Se,xt,"",Se,0,e);else{const r={["value"]:Se};Sf(r,xt,"",r,0,e)}tw(),Fc(null,Cf)}catch(t){Ke&&(Ke.textContent="JSON 파싱 오류: "+t.message),Se=null,au=null,xt&&(xt.innerHTML=""),tw(),Fc(null,Cf)}}function b0e(){if(Ke&&(Ke.textContent=""),Se!=null)try{const t=JSON.stringify(Se,null,2);dt&&(dt.value=t),rt&&un(rt,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){Ke&&(Ke.textContent="JSON 문자열 변환 오류: "+t.message),rt&&(rt.textContent="")}else dt&&(dt.value=""),rt&&un(rt,"저장할 JSON 데이터가 없습니다.",3e3)}function S0e(){Tj(),tw(),Se=null,au=null,Zc(null),Jn&&(Jn.innerHTML="",Jn.style.display="none"),As&&(As.value=""),xt&&(xt.innerHTML=""),Fc(null,Cf)}function tw(){et=VV()}function R0e(t,e,n=!1){if(Se==null)return;const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Se:s=uu(Se,o),o===""&&t===i&&(typeof Se!="object"||Se===null)){if(Se=GS(e,Se),n)return;wv(t),Xa(Se,"value",Se,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){Ve({title:"오류",text:"데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).",icon:"error",showCancelButton:!1,hotInstance:et});return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){Ve({title:"오류",text:"배열 인덱스 범위를 벗어났습니다.",icon:"error",showCancelButton:!1,hotInstance:et});return}let l=!0;const u=s[a],c=GS(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&xt){const f=xt.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(tN(g,c),l=!1)}}!n&&l&&wv(t)}}function E0e(t,e,n,r){let i;if(r&&(t===""||uu(Se,t)===r)?i=r:i=t===""?Se:uu(Se,t),typeof i!="object"||i===null||Array.isArray(i)){Ve({title:"오류",text:"키를 업데이트할 부모 객체를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:et});return}if(!i.hasOwnProperty(e)){Ve({title:"오류",text:`기존 키 "${e}"를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:et});return}if(n===e){Ve({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다.",showCancelButton:!1,hotInstance:et});return}if(i.hasOwnProperty(n)){Ve({title:"오류",text:`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:et});return}const o={},s=i[e];for(const a in i)i.hasOwnProperty(a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)i.hasOwnProperty(a)&&delete i[a];for(const a in o)o.hasOwnProperty(a)&&(i[a]=o[a]);Ve({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`,showCancelButton:!1,hotInstance:et}),wv(`key_renamed_in_parent:${t}`),Xa(i,n,Se,t)}function wv(t="N/A"){if(xt&&Se!=null){const e=xj(),n=Pj(xt);xt.innerHTML="";const r=jV();if(typeof Se=="object"&&Se!==null)Sf(Se,xt,"",Se,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Se};Sf(o,xt,"",o,0,r)}if(Ij(xt,n),e){const i=xt.querySelector(`.tree-node[data-path="${e}"]`);i&&Zc(i)}}else xt&&(xt.innerHTML="")}function jV(){return{displayTableCallback:Xa,getObjectByPathCallback:uu,rootJsonData:Se}}function Cf(t){const e=uu(Se,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}Xa(e,n,Se,t,{syncTreeView:!0})}else Ve({title:"오류",text:`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:et})}function Xa(t,e,n,r,i={syncTreeView:!0}){if(XRe({dataPathString:r,dataKeyName:e}),Fc(r,Cf),et=GRe(t,e,{tableViewDomElement:YS,updateJsonDataCallback:R0e,updateJsonKeyCallback:E0e,refreshTreeViewCallback:wv,getObjectByPathCallback:uu,convertToTypedValueCallback:GS,rootJsonData:n,currentJsonDataRef:()=>Se,dataPathString:r,displayTableCallback:Xa,getTemplates:e0e,addTemplate:t0e}),i.syncTreeView&&xt&&r!==void 0&&r!==null){const s=xt.querySelector(`.tree-node[data-path="${r}"]`);s?(Zc(s),setTimeout(()=>{const a=xt.querySelector(`.tree-node[data-path="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},50)):r===""?(Zc(null),xt.firstChild&&(xt.scrollTop=0)):console.warn(`Tree node for path "${r}" not found for synchronization.`)}}function UA(t){const e=JRe(t);if(e){LA(!0);try{const n=uu(Se,e.dataPathString);Xa(n,e.dataKeyName,Se,e.dataPathString,{syncTreeView:!1})}catch{Ve({title:"오류",text:"히스토리 복원 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:et})}finally{LA(!1)}}}document.addEventListener("DOMContentLoaded",a0e)});export default T0e();
