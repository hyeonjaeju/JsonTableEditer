var NV=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var qRe=NV((c0e,Zp)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function DV(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function kV(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function OA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function $V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z_(t,e){return t.get(OA(t,e))}function LV(t,e,n){$V(t,e),e.set(t,n)}function FV(t,e,n){return t.set(OA(t,e),n),n}const VV=100,Se={},WV=()=>{Se.previousActiveElement instanceof HTMLElement?(Se.previousActiveElement.focus(),Se.previousActiveElement=null):document.body&&document.body.focus()},BV=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Se.restoreFocusTimeout=setTimeout(()=>{WV(),e()},VV),window.scrollTo(n,r)}),AA="swal2-",jV=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],z=jV.reduce((t,e)=>(t[e]=AA+e,t),{}),UV=["success","warning","info","question","error"],Qp=UV.reduce((t,e)=>(t[e]=AA+e,t),{}),HA="SweetAlert2:",l0=t=>t.charAt(0).toUpperCase()+t.slice(1),cr=t=>{console.warn(`${HA} ${typeof t=="object"?t.join(" "):t}`)},mu=t=>{console.error(`${HA} ${t}`)},Q_=[],zV=t=>{Q_.includes(t)||(Q_.push(t),cr(t))},NA=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;zV(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},hv=t=>typeof t=="function"?t():t,u0=t=>t&&typeof t.toPromise=="function",Uf=t=>u0(t)?t.toPromise():Promise.resolve(t),c0=t=>t&&Promise.resolve(t)===t,fr=()=>document.body.querySelector(`.${z.container}`),zf=t=>{const e=fr();return e?e.querySelector(t):null},Qr=t=>zf(`.${t}`),nt=()=>Qr(z.popup),nh=()=>Qr(z.icon),YV=()=>Qr(z["icon-content"]),DA=()=>Qr(z.title),h0=()=>Qr(z["html-container"]),kA=()=>Qr(z.image),d0=()=>Qr(z["progress-steps"]),dv=()=>Qr(z["validation-message"]),Yo=()=>zf(`.${z.actions} .${z.confirm}`),rh=()=>zf(`.${z.actions} .${z.cancel}`),pu=()=>zf(`.${z.actions} .${z.deny}`),GV=()=>Qr(z["input-label"]),ih=()=>zf(`.${z.loader}`),Yf=()=>Qr(z.actions),$A=()=>Qr(z.footer),fv=()=>Qr(z["timer-progress-bar"]),f0=()=>Qr(z.close),KV=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,g0=()=>{const t=nt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(KV),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>Nr(o))},m0=()=>$s(document.body,z.shown)&&!$s(document.body,z["toast-shown"])&&!$s(document.body,z["no-backdrop"]),gv=()=>{const t=nt();return t?$s(t,z.toast):!1},qV=()=>{const t=nt();return t?t.hasAttribute("data-loading"):!1},ei=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},$s=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},XV=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(z).includes(n)&&!Object.values(Qp).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Zr=(t,e,n)=>{if(XV(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){cr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}ut(t,r)}},mv=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${z.popup} > .${z[e]}`);case"checkbox":return t.querySelector(`.${z.popup} > .${z.checkbox} input`);case"radio":return t.querySelector(`.${z.popup} > .${z.radio} input:checked`)||t.querySelector(`.${z.popup} > .${z.radio} input:first-child`);case"range":return t.querySelector(`.${z.popup} > .${z.range} input`);default:return t.querySelector(`.${z.popup} > .${z.input}`)}},LA=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},FA=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},ut=(t,e)=>{FA(t,e,!0)},bi=(t,e)=>{FA(t,e,!1)},Ta=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&$s(i,e))return i}},Ql=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},Hn=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},Jn=t=>{t&&(t.style.display="none")},p0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{Gf(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},eP=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},Gf=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?Hn(t,n):Jn(t)},Nr=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),JV=()=>!Nr(Yo())&&!Nr(pu())&&!Nr(rh()),tP=t=>t.scrollHeight>t.clientHeight,VA=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},w0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=fv();n&&Nr(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},ZV=()=>{const t=fv();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},QV=()=>typeof window>"u"||typeof document>"u",eW=`
 <div aria-labelledby="${z.title}" aria-describedby="${z["html-container"]}" class="${z.popup}" tabindex="-1">
   <button type="button" class="${z.close}"></button>
   <ul class="${z["progress-steps"]}"></ul>
   <div class="${z.icon}"></div>
   <img class="${z.image}" />
   <h2 class="${z.title}" id="${z.title}"></h2>
   <div class="${z["html-container"]}" id="${z["html-container"]}"></div>
   <input class="${z.input}" id="${z.input}" />
   <input type="file" class="${z.file}" />
   <div class="${z.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${z.select}" id="${z.select}"></select>
   <div class="${z.radio}"></div>
   <label class="${z.checkbox}">
     <input type="checkbox" id="${z.checkbox}" />
     <span class="${z.label}"></span>
   </label>
   <textarea class="${z.textarea}" id="${z.textarea}"></textarea>
   <div class="${z["validation-message"]}" id="${z["validation-message"]}"></div>
   <div class="${z.actions}">
     <div class="${z.loader}"></div>
     <button type="button" class="${z.confirm}"></button>
     <button type="button" class="${z.deny}"></button>
     <button type="button" class="${z.cancel}"></button>
   </div>
   <div class="${z.footer}"></div>
   <div class="${z["timer-progress-bar-container"]}">
     <div class="${z["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),tW=()=>{const t=fr();return t?(t.remove(),bi([document.documentElement,document.body],[z["no-backdrop"],z["toast-shown"],z["has-column"]]),!0):!1},Za=()=>{Se.currentInstance.resetValidationMessage()},nW=()=>{const t=nt(),e=Ta(t,z.input),n=Ta(t,z.file),r=t.querySelector(`.${z.range} input`),i=t.querySelector(`.${z.range} output`),o=Ta(t,z.select),s=t.querySelector(`.${z.checkbox} input`),a=Ta(t,z.textarea);e.oninput=Za,n.onchange=Za,o.onchange=Za,s.onchange=Za,a.oninput=Za,r.oninput=()=>{Za(),i.value=r.value},r.onchange=()=>{Za(),i.value=r.value}},rW=t=>typeof t=="string"?document.querySelector(t):t,iW=t=>{const e=nt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},oW=t=>{window.getComputedStyle(t).direction==="rtl"&&ut(fr(),z.rtl)},sW=t=>{const e=tW();if(QV()){mu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=z.container,e&&ut(n,z["no-transition"]),ei(n,eW),n.dataset.swal2Theme=t.theme;const r=rW(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),iW(t),oW(r),nW()},v0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?aW(t,e):t&&ei(e,t)},aW=(t,e)=>{t.jquery?lW(e,t):ei(e,t.toString())},lW=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},uW=(t,e)=>{const n=Yf(),r=ih();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?Jn(n):Hn(n),Zr(n,e,"actions"),cW(n,r,e),ei(r,e.loaderHtml||""),Zr(r,e,"loader"))};function cW(t,e,n){const r=Yo(),i=pu(),o=rh();!r||!i||!o||(Sy(r,"confirm",n),Sy(i,"deny",n),Sy(o,"cancel",n),hW(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function hW(t,e,n,r){if(!r.buttonsStyling){bi([t,e,n],z.styled);return}ut([t,e,n],z.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),by(t),by(e),by(n)}function by(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function Sy(t,e,n){const r=l0(e);Gf(t,n[`show${r}Button`],"inline-block"),ei(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=z[e],Zr(t,n,`${e}Button`)}const dW=(t,e)=>{const n=f0();n&&(ei(n,e.closeButtonHtml||""),Zr(n,e,"closeButton"),Gf(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},fW=(t,e)=>{const n=fr();n&&(gW(n,e.backdrop),mW(n,e.position),pW(n,e.grow),Zr(n,e,"container"))};function gW(t,e){typeof e=="string"?t.style.background=e:e||ut([document.documentElement,document.body],z["no-backdrop"])}function mW(t,e){e&&(e in z?ut(t,z[e]):(cr('The "position" parameter is not valid, defaulting to "center"'),ut(t,z.center)))}function pW(t,e){e&&ut(t,z[`grow-${e}`])}var Tt={innerParams:new WeakMap,domCache:new WeakMap};const wW=["input","file","range","select","radio","checkbox","textarea"],vW=(t,e)=>{const n=nt();if(!n)return;const r=Tt.innerParams.get(t),i=!r||e.input!==r.input;wW.forEach(o=>{const s=Ta(n,z[o]);s&&(bW(o,e.inputAttributes),s.className=z[o],i&&Jn(s))}),e.input&&(i&&yW(e),SW(e))},yW=t=>{if(!t.input)return;if(!on[t.input]){mu(`Unexpected type of input! Expected ${Object.keys(on).join(" | ")}, got "${t.input}"`);return}const e=WA(t.input);if(!e)return;const n=on[t.input](e,t);Hn(e),t.inputAutoFocus&&setTimeout(()=>{LA(n)})},CW=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},bW=(t,e)=>{const n=nt();if(!n)return;const r=mv(n,t);if(r){CW(r);for(const i in e)r.setAttribute(i,e[i])}},SW=t=>{if(!t.input)return;const e=WA(t.input);e&&Zr(e,t,"input")},y0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},Kf=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=z["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&ut(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},WA=t=>{const e=nt();if(e)return Ta(e,z[t]||z.input)},ew=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:c0(e)||cr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},on={};on.text=on.email=on.password=on.number=on.tel=on.url=on.search=on.date=on["datetime-local"]=on.time=on.week=on.month=(t,e)=>(ew(t,e.inputValue),Kf(t,t,e),y0(t,e),t.type=e.input,t);on.file=(t,e)=>(Kf(t,t,e),y0(t,e),t);on.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return ew(n,e.inputValue),n.type=e.input,ew(r,e.inputValue),Kf(n,t,e),t};on.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");ei(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return Kf(t,t,e),t};on.radio=t=>(t.textContent="",t);on.checkbox=(t,e)=>{const n=mv(nt(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return ei(r,e.inputPlaceholder||e.inputLabel),n};on.textarea=(t,e)=>{ew(t,e.inputValue),y0(t,e),Kf(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(nt()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?nt().style.width=`${o}px`:Ql(nt(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const RW=(t,e)=>{const n=h0();n&&(p0(n),Zr(n,e,"htmlContainer"),e.html?(v0(e.html,n),Hn(n,"block")):e.text?(n.textContent=e.text,Hn(n,"block")):Jn(n),vW(t,e))},EW=(t,e)=>{const n=$A();n&&(p0(n),Gf(n,e.footer,"block"),e.footer&&v0(e.footer,n),Zr(n,e,"footer"))},TW=(t,e)=>{const n=Tt.innerParams.get(t),r=nh();if(!r)return;if(n&&e.icon===n.icon){rP(r,e),nP(r,e);return}if(!e.icon&&!e.iconHtml){Jn(r);return}if(e.icon&&Object.keys(Qp).indexOf(e.icon)===-1){mu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),Jn(r);return}Hn(r),rP(r,e),nP(r,e),ut(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",BA)},nP=(t,e)=>{for(const[n,r]of Object.entries(Qp))e.icon!==n&&bi(t,r);ut(t,e.icon&&Qp[e.icon]),PW(t,e),BA(),Zr(t,e,"icon")},BA=()=>{const t=nt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},MW=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,_W=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,rP=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=iP(e.iconHtml):e.icon==="success"?(r=MW,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=_W:e.icon&&(r=iP({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&ei(t,r)},PW=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])eP(t,n,"background-color",e.iconColor);eP(t,".swal2-success-ring","border-color",e.iconColor)}},iP=t=>`<div class="${z["icon-content"]}">${t}</div>`,xW=(t,e)=>{const n=kA();if(n){if(!e.imageUrl){Jn(n);return}Hn(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),Ql(n,"width",e.imageWidth),Ql(n,"height",e.imageHeight),n.className=z.image,Zr(n,e,"image")}};let C0=!1,jA=0,UA=0,zA=0,YA=0;const IW=t=>{t.addEventListener("mousedown",tw),document.body.addEventListener("mousemove",nw),t.addEventListener("mouseup",rw),t.addEventListener("touchstart",tw),document.body.addEventListener("touchmove",nw),t.addEventListener("touchend",rw)},OW=t=>{t.removeEventListener("mousedown",tw),document.body.removeEventListener("mousemove",nw),t.removeEventListener("mouseup",rw),t.removeEventListener("touchstart",tw),document.body.removeEventListener("touchmove",nw),t.removeEventListener("touchend",rw)},tw=t=>{const e=nt();if(t.target===e||nh().contains(t.target)){C0=!0;const n=GA(t);jA=n.clientX,UA=n.clientY,zA=parseInt(e.style.insetInlineStart)||0,YA=parseInt(e.style.insetBlockStart)||0,ut(e,"swal2-dragging")}},nw=t=>{const e=nt();if(C0){let{clientX:n,clientY:r}=GA(t);e.style.insetInlineStart=`${zA+(n-jA)}px`,e.style.insetBlockStart=`${YA+(r-UA)}px`}},rw=()=>{const t=nt();C0=!1,bi(t,"swal2-dragging")},GA=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},AW=(t,e)=>{const n=fr(),r=nt();if(!(!n||!r)){if(e.toast){Ql(n,"width",e.width),r.style.width="100%";const i=ih();i&&r.insertBefore(i,nh())}else Ql(r,"width",e.width);Ql(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),Jn(dv()),HW(r,e),e.draggable&&!e.toast?(ut(r,z.draggable),IW(r)):(bi(r,z.draggable),OW(r))}},HW=(t,e)=>{const n=e.showClass||{};t.className=`${z.popup} ${Nr(t)?n.popup:""}`,e.toast?(ut([document.documentElement,document.body],z["toast-shown"]),ut(t,z.toast)):ut(t,z.modal),Zr(t,e,"popup"),typeof e.customClass=="string"&&ut(t,e.customClass),e.icon&&ut(t,z[`icon-${e.icon}`])},NW=(t,e)=>{const n=d0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){Jn(n);return}Hn(n),n.textContent="",i>=r.length&&cr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=DW(o);if(n.appendChild(a),s===i&&ut(a,z["active-progress-step"]),s!==r.length-1){const l=kW(e);n.appendChild(l)}})},DW=t=>{const e=document.createElement("li");return ut(e,z["progress-step"]),ei(e,t),e},kW=t=>{const e=document.createElement("li");return ut(e,z["progress-step-line"]),t.progressStepsDistance&&Ql(e,"width",t.progressStepsDistance),e},$W=(t,e)=>{const n=DA();n&&(p0(n),Gf(n,e.title||e.titleText,"block"),e.title&&v0(e.title,n),e.titleText&&(n.innerText=e.titleText),Zr(n,e,"title"))},KA=(t,e)=>{AW(t,e),fW(t,e),NW(t,e),TW(t,e),xW(t,e),$W(t,e),dW(t,e),RW(t,e),uW(t,e),EW(t,e);const n=nt();typeof e.didRender=="function"&&n&&e.didRender(n),Se.eventEmitter.emit("didRender",n)},LW=()=>Nr(nt()),qA=()=>{var t;return(t=Yo())===null||t===void 0?void 0:t.click()},FW=()=>{var t;return(t=pu())===null||t===void 0?void 0:t.click()},VW=()=>{var t;return(t=rh())===null||t===void 0?void 0:t.click()},oh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),XA=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},WW=(t,e,n)=>{XA(t),e.toast||(t.keydownHandler=r=>jW(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:nt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},OS=(t,e)=>{var n;const r=g0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=nt())===null||n===void 0||n.focus()},JA=["ArrowRight","ArrowDown"],BW=["ArrowLeft","ArrowUp"],jW=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?UW(e,t):e.key==="Tab"?zW(e):[...JA,...BW].includes(e.key)?YW(e.key):e.key==="Escape"&&GW(e,t,n)))},UW=(t,e)=>{if(!hv(e.allowEnterKey))return;const n=mv(nt(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;qA(),t.preventDefault()}},zW=t=>{const e=t.target,n=g0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?OS(r,-1):OS(r,1),t.stopPropagation(),t.preventDefault()},YW=t=>{const e=Yf(),n=Yo(),r=pu(),i=rh();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=JA.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Nr(a))break}a instanceof HTMLButtonElement&&a.focus()}},GW=(t,e,n)=>{hv(e.allowEscapeKey)&&(t.preventDefault(),n(oh.esc))};var zc={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const KW=()=>{const t=fr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},ZA=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},QA=typeof window<"u"&&!!window.GestureEvent,qW=()=>{if(QA&&!$s(document.body,z.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,ut(document.body,z.iosfix),XW()}},XW=()=>{const t=fr();if(!t)return;let e;t.ontouchstart=n=>{e=JW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},JW=t=>{const e=t.target,n=fr(),r=h0();return!n||!r||ZW(t)||QW(t)?!1:e===n||!tP(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(tP(r)&&r.contains(e))},ZW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",QW=t=>t.touches&&t.touches.length>1,eB=()=>{if($s(document.body,z.iosfix)){const t=parseInt(document.body.style.top,10);bi(document.body,z.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},tB=()=>{const t=document.createElement("div");t.className=z["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let Hc=null;const nB=t=>{Hc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(Hc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Hc+tB()}px`)},rB=()=>{Hc!==null&&(document.body.style.paddingRight=`${Hc}px`,Hc=null)};function eH(t,e,n,r){gv()?oP(t,r):(BV(n).then(()=>oP(t,r)),XA(Se)),QA?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),m0()&&(rB(),eB(),ZA()),iB()}function iB(){bi([document.documentElement,document.body],[z.shown,z["height-auto"],z["no-backdrop"],z["toast-shown"]])}function Ma(t){t=sB(t);const e=zc.swalPromiseResolve.get(this),n=oB(this);this.isAwaitingPromise?t.isDismissed||(qf(this),e(t)):n&&e(t)}const oB=t=>{const e=nt();if(!e)return!1;const n=Tt.innerParams.get(t);if(!n||$s(e,n.hideClass.popup))return!1;bi(e,n.showClass.popup),ut(e,n.hideClass.popup);const r=fr();return bi(r,n.showClass.backdrop),ut(r,n.hideClass.backdrop),aB(t,e,n),!0};function tH(t){const e=zc.swalPromiseReject.get(this);qf(this),e&&e(t)}const qf=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Tt.innerParams.get(t)||t._destroy())},sB=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),aB=(t,e,n)=>{var r;const i=fr(),o=VA(e);typeof n.willClose=="function"&&n.willClose(e),(r=Se.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?lB(t,e,i,n.returnFocus,n.didClose):eH(t,i,n.returnFocus,n.didClose)},lB=(t,e,n,r,i)=>{Se.swalCloseEventFinishedCallback=eH.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Se.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Se),delete Se.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},oP=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Se.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Yc=t=>{let e=nt();if(e||new Ji,e=nt(),!e)return;const n=ih();gv()?Jn(nh()):uB(e,t),Hn(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},uB=(t,e)=>{const n=Yf(),r=ih();!n||!r||(!e&&Nr(Yo())&&(e=Yo()),Hn(n),e&&(Jn(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),ut([t,n],z.loading))},cB=(t,e)=>{e.input==="select"||e.input==="radio"?mB(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(u0(e.inputValue)||c0(e.inputValue))&&(Yc(Yo()),pB(t,e))},hB=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return dB(n);case"radio":return fB(n);case"file":return gB(n);default:return e.inputAutoTrim?n.value.trim():n.value}},dB=t=>t.checked?1:0,fB=t=>t.checked?t.value:null,gB=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,mB=(t,e)=>{const n=nt();if(!n)return;const r=i=>{e.input==="select"?wB(n,iw(i),e):e.input==="radio"&&vB(n,iw(i),e)};u0(e.inputOptions)||c0(e.inputOptions)?(Yc(Yo()),Uf(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):mu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},pB=(t,e)=>{const n=t.getInput();n&&(Jn(n),Uf(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,Hn(n),n.focus(),t.hideLoading()}).catch(r=>{mu(`Error in inputValue promise: ${r}`),n.value="",Hn(n),n.focus(),t.hideLoading()}))};function wB(t,e,n){const r=Ta(t,z.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,ei(l,s),l.selected=nH(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function vB(t,e,n){const r=Ta(t,z.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=z.radio,l.value=s,nH(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");ei(c,a),c.className=z.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const iw=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=iw(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=iw(r)),e.push([n,r])}),e},nH=(t,e)=>!!e&&e.toString()===t.toString(),yB=t=>{const e=Tt.innerParams.get(t);t.disableButtons(),e.input?rH(t,"confirm"):S0(t,!0)},CB=t=>{const e=Tt.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?rH(t,"deny"):b0(t,!1)},bB=(t,e)=>{t.disableButtons(),e(oh.cancel)},rH=(t,e)=>{const n=Tt.innerParams.get(t);if(!n.input){mu(`The "input" parameter is needed to be set when using returnInputValueOn${l0(e)}`);return}const r=t.getInput(),i=hB(t,n);n.inputValidator?SB(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?b0(t,i):S0(t,i)},SB=(t,e,n)=>{const r=Tt.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Uf(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?b0(t,e):S0(t,e)})},b0=(t,e)=>{const n=Tt.innerParams.get(t||void 0);n.showLoaderOnDeny&&Yc(pu()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Uf(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),qf(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>iH(t||void 0,i))):t.close({isDenied:!0,value:e})},sP=(t,e)=>{t.close({isConfirmed:!0,value:e})},iH=(t,e)=>{t.rejectPromise(e)},S0=(t,e)=>{const n=Tt.innerParams.get(t||void 0);n.showLoaderOnConfirm&&Yc(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Uf(n.preConfirm(e,n.validationMessage))).then(i=>{Nr(dv())||i===!1?(t.hideLoading(),qf(t)):sP(t,typeof i>"u"?e:i)}).catch(i=>iH(t||void 0,i))):sP(t,e)};function ow(){const t=Tt.innerParams.get(this);if(!t)return;const e=Tt.domCache.get(this);Jn(e.loader),gv()?t.icon&&Hn(nh()):RB(e),bi([e.popup,e.actions],z.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const RB=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?Hn(e[0],"inline-block"):JV()&&Jn(t.actions)};function oH(){const t=Tt.innerParams.get(this),e=Tt.domCache.get(this);return e?mv(e.popup,t.input):null}function sH(t,e,n){const r=Tt.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function aH(t,e){const n=nt();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${z.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function lH(){sH(this,["confirmButton","denyButton","cancelButton"],!1)}function uH(){sH(this,["confirmButton","denyButton","cancelButton"],!0)}function cH(){aH(this.getInput(),!1)}function hH(){aH(this.getInput(),!0)}function dH(t){const e=Tt.domCache.get(this),n=Tt.innerParams.get(this);ei(e.validationMessage,t),e.validationMessage.className=z["validation-message"],n.customClass&&n.customClass.validationMessage&&ut(e.validationMessage,n.customClass.validationMessage),Hn(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",z["validation-message"]),LA(r),ut(r,z.inputerror))}function fH(){const t=Tt.domCache.get(this);t.validationMessage&&Jn(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),bi(e,z.inputerror))}const Nc={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},EB=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],TB={allowEnterKey:void 0},MB=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],gH=t=>Object.prototype.hasOwnProperty.call(Nc,t),mH=t=>EB.indexOf(t)!==-1,pH=t=>TB[t],_B=t=>{gH(t)||cr(`Unknown parameter "${t}"`)},PB=t=>{MB.includes(t)&&cr(`The parameter "${t}" is incompatible with toasts`)},xB=t=>{const e=pH(t);e&&NA(t,e)},wH=t=>{t.backdrop===!1&&t.allowOutsideClick&&cr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&cr(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)_B(e),t.toast&&PB(e),xB(e)};function vH(t){const e=fr(),n=nt(),r=Tt.innerParams.get(this);if(!n||$s(n,r.hideClass.popup)){cr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=IB(t),o=Object.assign({},r,i);wH(o),e.dataset.swal2Theme=o.theme,KA(this,o),Tt.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const IB=t=>{const e={};return Object.keys(t).forEach(n=>{mH(n)?e[n]=t[n]:cr(`Invalid parameter to update: ${n}`)}),e};function yH(){const t=Tt.domCache.get(this),e=Tt.innerParams.get(this);if(!e){CH(this);return}t.popup&&Se.swalCloseEventFinishedCallback&&(Se.swalCloseEventFinishedCallback(),delete Se.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Se.eventEmitter.emit("didDestroy"),OB(this)}const OB=t=>{CH(t),delete t.params,delete Se.keydownHandler,delete Se.keydownTarget,delete Se.currentInstance},CH=t=>{t.isAwaitingPromise?(Ry(Tt,t),t.isAwaitingPromise=!0):(Ry(zc,t),Ry(Tt,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},Ry=(t,e)=>{for(const n in t)t[n].delete(e)};var AB=Object.freeze({__proto__:null,_destroy:yH,close:Ma,closeModal:Ma,closePopup:Ma,closeToast:Ma,disableButtons:uH,disableInput:hH,disableLoading:ow,enableButtons:lH,enableInput:cH,getInput:oH,handleAwaitingPromise:qf,hideLoading:ow,rejectPromise:tH,resetValidationMessage:fH,showValidationMessage:dH,update:vH});const HB=(t,e,n)=>{t.toast?NB(t,e,n):(kB(e),$B(e),LB(t,e,n))},NB=(t,e,n)=>{e.popup.onclick=()=>{t&&(DB(t)||t.timer||t.input)||n(oh.close)}},DB=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let sw=!1;const kB=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(sw=!0)}}},$B=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(sw=!0)}}},LB=(t,e,n)=>{e.container.onclick=r=>{if(sw){sw=!1;return}r.target===e.container&&hv(t.allowOutsideClick)&&n(oh.backdrop)}},FB=t=>typeof t=="object"&&t.jquery,aP=t=>t instanceof Element||FB(t),VB=t=>{const e={};return typeof t[0]=="object"&&!aP(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||aP(i)?e[n]=i:i!==void 0&&mu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function WB(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function BB(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const jB=()=>Se.timeout&&Se.timeout.getTimerLeft(),bH=()=>{if(Se.timeout)return ZV(),Se.timeout.stop()},SH=()=>{if(Se.timeout){const t=Se.timeout.start();return w0(t),t}},UB=()=>{const t=Se.timeout;return t&&(t.running?bH():SH())},zB=t=>{if(Se.timeout){const e=Se.timeout.increase(t);return w0(e,!0),e}},YB=()=>!!(Se.timeout&&Se.timeout.isRunning());let lP=!1;const AS={};function GB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";AS[t]=this,lP||(document.body.addEventListener("click",KB),lP=!0)}const KB=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in AS){const r=e.getAttribute(n);if(r){AS[n].fire({template:r});return}}};class qB{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Se.eventEmitter=new qB;const XB=(t,e)=>{Se.eventEmitter.on(t,e)},JB=(t,e)=>{Se.eventEmitter.once(t,e)},ZB=(t,e)=>{if(!t){Se.eventEmitter.reset();return}e?Se.eventEmitter.removeListener(t,e):Se.eventEmitter.removeAllListeners(t)};var QB=Object.freeze({__proto__:null,argsToParams:VB,bindClickHandler:GB,clickCancel:VW,clickConfirm:qA,clickDeny:FW,enableLoading:Yc,fire:WB,getActions:Yf,getCancelButton:rh,getCloseButton:f0,getConfirmButton:Yo,getContainer:fr,getDenyButton:pu,getFocusableElements:g0,getFooter:$A,getHtmlContainer:h0,getIcon:nh,getIconContent:YV,getImage:kA,getInputLabel:GV,getLoader:ih,getPopup:nt,getProgressSteps:d0,getTimerLeft:jB,getTimerProgressBar:fv,getTitle:DA,getValidationMessage:dv,increaseTimer:zB,isDeprecatedParameter:pH,isLoading:qV,isTimerRunning:YB,isUpdatableParameter:mH,isValidParameter:gH,isVisible:LW,mixin:BB,off:ZB,on:XB,once:JB,resumeTimer:SH,showLoading:Yc,stopTimer:bH,toggleTimer:UB});class e2{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const RH=["swal-title","swal-html","swal-footer"],t2=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return u2(n),Object.assign(n2(n),r2(n),i2(n),o2(n),s2(n),a2(n),l2(n,RH))},n2=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{iu(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof Nc[i]=="boolean"?e[i]=o!=="false":typeof Nc[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},r2=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},i2=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{iu(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${l0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},o2=t=>{const e={},n=t.querySelector("swal-image");return n&&(iu(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},s2=t=>{const e={},n=t.querySelector("swal-icon");return n&&(iu(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},a2=t=>{const e={},n=t.querySelector("swal-input");n&&(iu(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{iu(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},l2=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(iu(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},u2=t=>{const e=RH.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||cr(`Unrecognized element <${r}>`)})},iu=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&cr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},EH=10,c2=t=>{const e=fr(),n=nt();typeof t.willOpen=="function"&&t.willOpen(n),Se.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;f2(e,n,t),setTimeout(()=>{h2(e,n)},EH),m0()&&(d2(e,t.scrollbarPadding,i),KW()),!gv()&&!Se.previousActiveElement&&(Se.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Se.eventEmitter.emit("didOpen",n),bi(e,z["no-transition"])},aw=t=>{const e=nt();if(t.target!==e)return;const n=fr();e.removeEventListener("animationend",aw),e.removeEventListener("transitionend",aw),n.style.overflowY="auto"},h2=(t,e)=>{VA(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",aw),e.addEventListener("transitionend",aw)):t.style.overflowY="auto"},d2=(t,e,n)=>{qW(),e&&n!=="hidden"&&nB(n),setTimeout(()=>{t.scrollTop=0})},f2=(t,e,n)=>{ut(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),Hn(e,"grid"),setTimeout(()=>{ut(e,n.showClass.popup),e.style.removeProperty("opacity")},EH)):Hn(e,"grid"),ut([document.documentElement,document.body],z.shown),n.heightAuto&&n.backdrop&&!n.toast&&ut([document.documentElement,document.body],z["height-auto"])};var uP={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function g2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=uP.email),t.input==="url"&&(t.inputValidator=uP.url))}function m2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(cr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function p2(t){g2(t),t.showLoaderOnConfirm&&!t.preConfirm&&cr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),m2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),sW(t)}let No;var Ig=new WeakMap;class hn{constructor(){if(LV(this,Ig,void 0),typeof window>"u")return;No=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,FV(Ig,this,this._main(No.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(wH(Object.assign({},n,e)),Se.currentInstance){const o=zc.swalPromiseResolve.get(Se.currentInstance),{isAwaitingPromise:s}=Se.currentInstance;Se.currentInstance._destroy(),s||o({isDismissed:!0}),m0()&&ZA()}Se.currentInstance=No;const r=v2(e,n);p2(r),Object.freeze(r),Se.timeout&&(Se.timeout.stop(),delete Se.timeout),clearTimeout(Se.restoreFocusTimeout);const i=y2(No);return KA(No,r),Tt.innerParams.set(No,r),w2(No,i,r)}then(e){return Z_(Ig,this).then(e)}finally(e){return Z_(Ig,this).finally(e)}}const w2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};zc.swalPromiseResolve.set(t,r),zc.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{yB(t)},e.denyButton.onclick=()=>{CB(t)},e.cancelButton.onclick=()=>{bB(t,o)},e.closeButton.onclick=()=>{o(oh.close)},HB(n,e,o),WW(Se,n,o),cB(t,n),c2(n),C2(Se,n,o),b2(e,n),setTimeout(()=>{e.container.scrollTop=0})}),v2=(t,e)=>{const n=t2(t),r=Object.assign({},Nc,e,n,t);return r.showClass=Object.assign({},Nc.showClass,r.showClass),r.hideClass=Object.assign({},Nc.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},y2=t=>{const e={popup:nt(),container:fr(),actions:Yf(),confirmButton:Yo(),denyButton:pu(),cancelButton:rh(),loader:ih(),closeButton:f0(),validationMessage:dv(),progressSteps:d0()};return Tt.domCache.set(t,e),e},C2=(t,e,n)=>{const r=fv();Jn(r),e.timer&&(t.timeout=new e2(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(Hn(r),Zr(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&w0(e.timer)})))},b2=(t,e)=>{if(!e.toast){if(!hv(e.allowEnterKey)){NA("allowEnterKey"),E2();return}S2(t)||R2(t,e)||OS(-1,1)}},S2=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&Nr(n))return n.focus(),!0;return!1},R2=(t,e)=>e.focusDeny&&Nr(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Nr(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&Nr(t.confirmButton)?(t.confirmButton.focus(),!0):!1,E2=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}hn.prototype.disableButtons=uH;hn.prototype.enableButtons=lH;hn.prototype.getInput=oH;hn.prototype.disableInput=hH;hn.prototype.enableInput=cH;hn.prototype.hideLoading=ow;hn.prototype.disableLoading=ow;hn.prototype.showValidationMessage=dH;hn.prototype.resetValidationMessage=fH;hn.prototype.close=Ma;hn.prototype.closePopup=Ma;hn.prototype.closeModal=Ma;hn.prototype.closeToast=Ma;hn.prototype.rejectPromise=tH;hn.prototype.update=vH;hn.prototype._destroy=yH;Object.assign(hn,QB);Object.keys(AB).forEach(t=>{hn[t]=function(){return No&&No[t]?No[t](...arguments):null}});hn.DismissReason=oh;hn.version="11.21.0";const Ji=hn;Ji.default=Ji;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var Us=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(I){if(I=o.postProcess(I,r),i){setTimeout(function(){i(I)},0);return}else return I},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],v=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&v+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var y=-1/0,E=1/0,C=function(){for(var I=Math.max(y,-c);I<=Math.min(E,c);I+=2){var P=void 0,T=g[I-1],A=g[I+1];T&&(g[I-1]=void 0);var G=!1;if(A){var U=A.oldPos-I;G=A&&0<=U&&U<l}var V=T&&T.oldPos+1<u;if(!G&&!V){g[I]=void 0;continue}if(!V||G&&T.oldPos<A.oldPos?P=o.addToPath(A,!0,!1,0,r):P=o.addToPath(T,!1,!0,1,r),v=o.extractCommon(P,n,e,I,r),P.oldPos+1>=u&&v+1>=l)return a(o.buildValues(P.lastComponent,n,e))||!0;g[I]=P,P.oldPos+1>=u&&(E=Math.min(E,I-1)),v+1>=l&&(y=Math.max(y,I+1))}c++};if(i)(function I(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);C()||I()},0)})();else for(;c<=h&&Date.now()<=f;){var _=C();if(_)return _}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),T2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),M2=function(t){T2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Us),TH=new M2;function _2(t,e,n){return TH.diff(t,e,n)}function cP(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function hP(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function HS(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function NS(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function Eh(t,e){return HS(t,e,"")}function Og(t,e){return NS(t,e,"")}function dP(t,e){return e.slice(0,P2(t,e))}function P2(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function x2(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function I2(t){return!t.includes(`\r
`)&&t.includes(`
`)}function Th(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function Js(t){var e=t.match(/^\s*/);return e?e[0]:""}var MH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),lw="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",O2=new RegExp("[".concat(lw,"]+|\\s+|[^").concat(lw,"]"),"ug"),A2=function(t){MH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(O2)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&fP(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&fP(i,s,o,null),n},e}(Us),_H=new A2;function H2(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?xH(t,e,n):_H.diff(t,e,n)}function fP(t,e,n,r){if(e&&n){var i=Js(e.value),o=Th(e.value),s=Js(n.value),a=Th(n.value);if(t){var l=cP(i,s);t.value=NS(t.value,s,l),e.value=Eh(e.value,l),n.value=Eh(n.value,l)}if(r){var u=hP(o,a);r.value=HS(r.value,a,u),e.value=Og(e.value,u),n.value=Og(n.value,u)}}else if(n){if(t){var c=Js(n.value);n.value=n.value.substring(c.length)}if(r){var c=Js(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=Js(r.value),d=Js(e.value),f=Th(e.value),g=cP(h,d);e.value=Eh(e.value,g);var v=hP(Eh(h,g),f);e.value=Og(e.value,v),r.value=HS(r.value,h,v),t.value=NS(t.value,h,h.slice(0,h.length-v.length))}else if(r){var y=Js(r.value),E=Th(e.value),C=dP(E,y);e.value=Og(e.value,C)}else if(t){var _=Th(t.value),I=Js(e.value),C=dP(_,I);e.value=Eh(e.value,C)}}var N2=function(t){MH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(lw,"]+|[^\\S\\n\\r]+|[^").concat(lw,"]"),"ug");return n.match(r)||[]},e}(Us),PH=new N2;function xH(t,e,n){return PH.diff(t,e,n)}function D2(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var k2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),$2=function(t){k2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=IH,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}(Us),R0=new $2;function wf(t,e,n){return R0.diff(t,e,n)}function L2(t,e,n){return n=D2(n,{ignoreWhitespace:!0}),R0.diff(t,e,n)}function IH(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var F2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),V2=function(t){F2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}(Us),OH=new V2;function W2(t,e,n){return OH.diff(t,e,n)}var B2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),j2=function(t){B2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}(Us),AH=new j2;function U2(t,e,n){return AH.diff(t,e,n)}var z2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Y2=function(t){z2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=IH,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(uw(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}(Us),HH=new Y2;function G2(t,e,n){return HH.diff(t,e,n)}function uw(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=uw(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=uw(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var K2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),q2=function(t){K2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}(Us),NH=new q2;function X2(t,e,n){return NH.diff(t,e,n)}var Wo=function(){return Wo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Wo.apply(this,arguments)};function DH(t){return Array.isArray(t)?t.map(function(e){return DH(e)}):Wo(Wo({},t),{hunks:t.hunks.map(function(e){return Wo(Wo({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function kH(t){return Array.isArray(t)?t.map(function(e){return kH(e)}):Wo(Wo({},t),{hunks:t.hunks.map(function(e){return Wo(Wo({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function J2(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function Z2(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function E0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function Q2(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function $H(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=E0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return ej(t,r[0],n)}function ej(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(x2(t)&&J2(e)?e=DH(e):I2(t)&&Z2(e)&&(e=kH(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(G,U,V,X){return U===X},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(G,U,V,X,ne,Q,te){X===void 0&&(X=0),ne===void 0&&(ne=!0),Q===void 0&&(Q=[]),te===void 0&&(te=0);for(var pe=0,et=!1;X<G.length;X++){var Re=G[X],Ae=Re.length>0?Re[0]:" ",ot=Re.length>0?Re.substr(1):Re;if(Ae==="-")if(o(U+1,r[U],Ae,ot))U++,pe=0;else return!V||r[U]==null?null:(Q[te]=r[U],f(G,U+1,V-1,X,!1,Q,te+1));if(Ae==="+"){if(!ne)return null;Q[te]=ot,te++,pe=0,et=!0}if(Ae===" ")if(pe++,Q[te]=r[U],o(U+1,r[U],Ae,ot))te++,ne=!0,et=!1,U++;else return et||!V?null:r[U]&&(f(G,U+1,V-1,X+1,!1,Q,te+1)||f(G,U+1,V-1,X,!1,Q,te+1))||f(G,U,V-1,X+1,!1,Q,te)}return te-=pe,U-=pe,Q.length=te,{patchedLines:Q,oldLineLastI:U-1}}for(var g=[],v=0,h=0;h<i.length;h++){for(var y=i[h],E=void 0,C=r.length-y.oldLines+s,_=void 0,I=0;I<=s;I++){_=y.oldStart+v-1;for(var P=Q2(_,a,C);_!==void 0&&(E=f(y.lines,_,I),!E);_=P());if(E)break}if(!E)return!1;for(var T=a;T<_;T++)g.push(r[T]);for(var A=0;A<E.patchedLines.length;A++){var d=E.patchedLines[A];g.push(d)}a=E.oldLineLastI+1,v=_+1-y.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function tj(t,e){var n=typeof t=="string"?E0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=$H(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var cw=function(){return cw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},cw.apply(this,arguments)};function LH(t){return Array.isArray(t)?t.map(function(e){return LH(e)}).reverse():cw(cw({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var Gc=function(){return Gc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Gc.apply(this,arguments)};function DS(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;wf(n,r,Gc(Gc({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(wf(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(Ae){return Ae.map(function(ot){return" "+ot})}for(var f=[],g=0,v=0,y=[],E=1,C=1,_=0;_<h.length;_++){var I=h[_],P=I.lines||rj(I.value);if(I.lines=P,I.added||I.removed){if(!g){var T=h[_-1];g=E,v=C,T&&(y=l>0?d(T.lines.slice(-l)):[],g-=y.length,v-=y.length)}for(var A=0,G=P;A<G.length;A++){var U=G[A];y.push((I.added?"+":"-")+U)}I.added?C+=P.length:E+=P.length}else{if(g)if(P.length<=l*2&&_<h.length-2)for(var V=0,X=d(P);V<X.length;V++){var U=X[V];y.push(U)}else{for(var ne=Math.min(P.length,l),Q=0,te=d(P.slice(0,ne));Q<te.length;Q++){var U=te[Q];y.push(U)}var pe={oldStart:g,oldLines:E-g+ne,newStart:v,newLines:C-v+ne,lines:y};f.push(pe),g=0,v=0,y=[]}E+=P.length,C+=P.length}}for(var et=0,Re=f;et<Re.length;et++)for(var pe=Re[et],_=0;_<pe.lines.length;_++)pe.lines[_].endsWith(`
`)?pe.lines[_]=pe.lines[_].slice(0,-1):(pe.lines.splice(_+1,0,"\\ No newline at end of file"),_++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function hw(t){if(Array.isArray(t))return t.map(hw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function FH(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;DS(t,e,n,r,i,o,Gc(Gc({},s),{callback:function(u){l(u?hw(u):void 0)}}))}else{var a=DS(t,e,n,r,i,o,s);return a?hw(a):void 0}}function nj(t,e,n,r,i,o){return FH(t,t,e,n,r,i,o)}function rj(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function ij(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function oj(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(sj(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function sj(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const aj=Object.freeze(Object.defineProperty({__proto__:null,Diff:Us,applyPatch:$H,applyPatches:tj,arrayDiff:NH,canonicalize:uw,characterDiff:TH,convertChangesToDMP:ij,convertChangesToXML:oj,createPatch:nj,createTwoFilesPatch:FH,cssDiff:AH,diffArrays:X2,diffChars:_2,diffCss:U2,diffJson:G2,diffLines:wf,diffSentences:W2,diffTrimmedLines:L2,diffWords:H2,diffWordsWithSpace:xH,formatPatch:hw,jsonDiff:HH,lineDiff:R0,parsePatch:E0,reversePatch:LH,sentenceDiff:OH,structuredPatch:DS,wordDiff:_H,wordsWithSpaceDiff:PH},Symbol.toStringTag,{value:"Module"}));function lj(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[],hotInstance:i}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();let o="",s="",a=[];const l=(h,d=2)=>{const f=g=>{if(typeof g!="object"||g===null)return g;if(Array.isArray(g))return g.map(f);const v={};return Object.keys(g).forEach(y=>{v[y]=f(g[y])}),v};try{return JSON.stringify(f(h),null,d)}catch(g){return console.error("Error stringifying object while preserving key order:",g),JSON.stringify(h,null,d)}};function u(h){return h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}if(n&&n.left!==void 0&&n.right!==void 0)if(typeof aj>"u"||typeof wf!="function")s='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다. (Diff is not defined)</p>',o='<div class="diff-popup-header error">라이브러리 오류</div>';else try{const h=l(n.left),d=l(n.right),f=wf(h,d);let g=0,v=0;f.forEach(V=>{const X=V.value||"",ne=X.split(`
`);let Q=ne.length;ne[ne.length-1]===""&&X.length>0&&Q--,X===""&&(Q=0),V.added?g+=Q:V.removed&&(v+=Q)});const y=[];let E=1,C=1;f.forEach((V,X)=>{const ne=V.value||"",Q=ne.split(`
`);let te=Q.length;Q[Q.length-1]===""&&ne.length>0&&te--,ne===""&&(te=0),V.removed?(y.push({originalPartIndex:X,part:V,sourceType:"del",lineNumber:E,numLines:te}),E+=te):V.added?(y.push({originalPartIndex:X,part:V,sourceType:"ins",lineNumber:C,numLines:te}),C+=te):(E+=te,C+=te)}),a=[];let _=[...y],I=null;for(_.length>0&&(_.sort((V,X)=>V.lineNumber!==X.lineNumber?V.lineNumber-X.lineNumber:V.sourceType==="del"&&X.sourceType!=="del"?-1:V.sourceType!=="del"&&X.sourceType==="del"?1:V.originalPartIndex-X.originalPartIndex),I=_[0],a.push(I),_=_.filter(V=>V.originalPartIndex!==I.originalPartIndex));_.length>0&&I;){const V=I.lineNumber;let X=null,ne=[];for(const Q of _)Q.lineNumber>=V&&ne.push({...Q,diff:Q.lineNumber-V});if(ne.length>0)ne.sort((Q,te)=>Q.diff!==te.diff?Q.diff-te.diff:Q.sourceType==="del"&&te.sourceType!=="del"?-1:Q.sourceType!=="del"&&te.sourceType==="del"?1:Q.originalPartIndex-te.originalPartIndex),X=ne[0];else{let Q=[];for(const te of _)Q.push({...te,absDiff:Math.abs(te.lineNumber-V)});Q.length>0&&(Q.sort((te,pe)=>te.absDiff!==pe.absDiff?te.absDiff-pe.absDiff:te.lineNumber!==pe.lineNumber?te.lineNumber-pe.lineNumber:te.sourceType==="del"&&pe.sourceType!=="del"?-1:te.sourceType!=="del"&&pe.sourceType==="del"?1:te.originalPartIndex-pe.originalPartIndex),X=Q[0])}if(X)a.push(X),I=X,_=_.filter(Q=>Q.originalPartIndex!==X.originalPartIndex);else break}let P="",T="",A=1,G=1;const U=new Map;if(a.forEach((V,X)=>U.set(V.originalPartIndex,X)),f.forEach((V,X)=>{const ne=V.value||"",Q=ne.replace(/\n$/,"").split(`
`);Q.length===1&&Q[0]===""&&ne===""||Q.forEach((te,pe)=>{let et="";(V.added||V.removed)&&pe===0&&U.has(X)&&(et=`id="diff-nav-target-${U.get(X)}"`),V.added?(P+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,T+=`<div ${et} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${G++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`):V.removed?(P+=`<div ${et} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${A++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`,T+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(P+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${A++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`,T+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${G++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`)})}),s=`<div class="diff-sbs-container"><div class="diff-sbs-pane" id="diff-left-pane">${P}</div><div class="diff-sbs-pane" id="diff-right-pane">${T}</div></div>`,a.length>0||g>0||v>0){let V="";(g>0||v>0)&&(V=`<span class="diff-summary"><strong class="diff-summary-added">+${g}</strong> <strong class="diff-summary-removed">-${v}</strong></span>`),o=`<div class="diff-popup-header">JSON 비교 결과 (텍스트 기반 Side-by-Side)</div><div id="diff-navigation">${V}<button id="prev-change-btn" class="swal2-styled">이전 변경점</button><button id="next-change-btn" class="swal2-styled">다음 변경점</button><span id="current-change-info"></span></div>`}else o='<div class="diff-popup-header">JSON 비교 결과</div>',h===d?s='<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':s='<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>'}catch(h){s=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${h.message}</p>`,o='<div class="diff-popup-header error">오류 발생</div>'}else s='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',o='<div class="diff-popup-header error">데이터 오류</div>';const c=`${o}<div id="diff-container">${s}</div>`;return uj({title:e,html:c,buttons:r,width:"95%",customClass:{popup:"custom-swal-popup-wider-text-diff",htmlContainer:"custom-swal-html-container-text-diff"},didOpen:h=>{const d=[];if(a&&a.length>0)for(let P=0;P<a.length;P++){const T=document.getElementById(`diff-nav-target-${P}`);T&&d.push(T)}let f=-1,g=null;const v=document.getElementById("diff-navigation"),y=document.getElementById("next-change-btn"),E=document.getElementById("prev-change-btn"),C=document.getElementById("current-change-info");function _(){if(!v)return;const P=d.length===0;y&&(y.style.display=P?"none":"inline-block"),E&&(E.style.display=P?"none":"inline-block"),C&&(C.textContent=P?totalAdded>0||totalRemoved>0?"0 / 0":"변경점 없음":`${f+1} / ${d.length}`),y&&(y.disabled=f>=d.length-1),E&&(E.disabled=f<=0)}function I(P){if(P<0||P>=d.length)return;g&&g.classList.remove("diff-navigation-highlight");const T=d[P];if(T){const A=document.getElementById("diff-container");if(A){const G=T.offsetTop;A.scrollTop=G-A.clientHeight/2+T.clientHeight/2}else T.scrollIntoView({block:"center"});T.classList.add("diff-navigation-highlight"),g=T}f=P,_()}d.length>0?I(0):_(),y&&y.addEventListener("click",()=>{f<d.length-1&&I(f+1)}),E&&E.addEventListener("click",()=>{f>0&&I(f-1)}),h.addEventListener("keydown",P=>{d.length===0||!y||!E||(P.key==="ArrowDown"||P.key==="PageDown"?(P.preventDefault(),y.disabled||y.click()):(P.key==="ArrowUp"||P.key==="PageUp")&&(P.preventDefault(),E.disabled||E.click()))}),_()}})}async function pc(t){const{title:e,inputLabel:n,inputValue:r="",inputPlaceholder:i="",inputValidator:o,confirmButtonText:s="확인",cancelButtonText:a="취소",showCancelButton:l=!0,customClass:u={},html:c,hotInstance:h}=t;h&&typeof h.deselectCell=="function"&&h.deselectCell();let d=c||"";return n&&!c&&(d=`<label style="display: block; text-align: left; margin-bottom: .5em; font-weight: normal;">${n}</label>`),Ji.fire({title:e,html:d,input:"text",inputValue:r,inputPlaceholder:i,inputValidator:o,showCancelButton:l,confirmButtonText:s,cancelButtonText:a,customClass:u,didOpen:()=>{const f=Ji.getInput();f&&(f.focus(),typeof f.select=="function"&&f.select())}})}async function yt(t){const{title:e,text:n="",html:r="",icon:i="warning",confirmButtonText:o="확인",cancelButtonText:s="취소",showCancelButton:a=!0,customClass:l={},hotInstance:u}=t;return u&&typeof u.deselectCell=="function"&&u.deselectCell(),Ji.fire({title:e,text:n,html:r,icon:i,showCancelButton:a,confirmButtonText:o,cancelButtonText:s,customClass:l})}function uj(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u}=t,c={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:a,preConfirm:l,didOpen:u},h=i.find(g=>g.role==="confirm"||!g.role&&i.indexOf(g)===0),d=i.find(g=>g.role==="cancel");return h?(c.showConfirmButton=!0,c.confirmButtonText=h.text||Ji.getConfirmButton().innerText,h.color&&(c.confirmButtonColor=h.color)):i.length>0||l?!i.some(g=>g.role!=="cancel")&&!l&&(c.showConfirmButton=!1):c.showConfirmButton=!1,d&&(c.showCancelButton=!0,c.cancelButtonText=d.text||Ji.getCancelButton().innerText,d.color&&(c.cancelButtonColor=d.color)),typeof Ji>"u"?Promise.reject("SweetAlert2 is not imported"):Ji.fire(c).then(g=>{let v={...g,formData:{}};return g.isConfirmed&&l&&(v.formData=g.value||{}),g.isConfirmed&&h&&typeof h.action=="function"&&!l?h.action():g.isDismissed&&d&&typeof d.action=="function"&&g.dismiss===Ji.DismissReason.cancel&&d.action(),v})}const sn=document.getElementById("json-input"),Xr=document.getElementById("save-message"),tn=document.getElementById("json-error"),At=document.getElementById("tree-view"),VH=document.getElementById("table-view");function eu(t,e,n){t.textContent=e,setTimeout(()=>{t.textContent=""},n)}function Dc(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(t!=null){if(i.appendChild(document.createTextNode(o)),t==="")if(e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));else{let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u,c=!0;for(;(u=l.exec(t))!==null;){const h=u[0];let d=h,f;if(c?(a=h,c=!1):h.startsWith("[")?a+=h:(a+="."+h,i.appendChild(document.createTextNode(" > "))),f=a,h.startsWith("[")&&h.endsWith("]")&&(d=h),e){const g=document.createElement("a");g.href="#",g.textContent=d,g.style.textDecoration="underline",g.style.cursor="pointer",g.onclick=v=>{v.preventDefault(),e(f)},i.appendChild(g)}else i.appendChild(document.createTextNode(d))}}i.appendChild(document.createTextNode(s))}}function cj(){At.innerHTML="",VH.innerHTML="",tn&&(tn.textContent=""),Xr&&(Xr.textContent=""),Dc(null)}function ou(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function kS(t,e){if(typeof t=="string"){const n=t.trim();if(n.toLowerCase()==="null")return null;if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1;if(n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,"")))return Number(n);if(n.startsWith("[")&&n.endsWith("]")||n.startsWith("{")&&n.endsWith("}"))try{return JSON.parse(n)}catch{return t}return t}return t}function WH(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let jl=null;function Kc(t){jl&&jl.classList.remove("selected-node"),jl=t,jl&&jl.classList.add("selected-node")}function hj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),Kc(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),WH(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),Kc(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function dj(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),vf(e,o,n,r.rootJsonData,r.depth+1,r),o}function vf(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=hj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=dj(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function fj(){return jl?jl.dataset.path:null}function gj(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function mj(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var Ag=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Mh=function(t){return t&&t.Math===Math&&t},vn=Mh(typeof globalThis=="object"&&globalThis)||Mh(typeof window=="object"&&window)||Mh(typeof self=="object"&&self)||Mh(typeof Ag=="object"&&Ag)||Mh(typeof Ag=="object"&&Ag)||function(){return this}()||Function("return this")(),T0={},Nn=function(t){try{return!!t()}catch{return!0}},pj=Nn,Ei=!pj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),wj=Nn,pv=!wj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),vj=pv,Hg=Function.prototype.call,yn=vj?Hg.bind(Hg):function(){return Hg.apply(Hg,arguments)},BH={},jH={}.propertyIsEnumerable,UH=Object.getOwnPropertyDescriptor,yj=UH&&!jH.call({1:2},1);BH.f=yj?function(e){var n=UH(this,e);return!!n&&n.enumerable}:jH;var wv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},zH=pv,YH=Function.prototype,$S=YH.call,Cj=zH&&YH.bind.bind($S,$S),dn=zH?Cj:function(t){return function(){return $S.apply(t,arguments)}},GH=dn,bj=GH({}.toString),Sj=GH("".slice),wu=function(t){return Sj(bj(t),8,-1)},Rj=dn,Ej=Nn,Tj=wu,Ey=Object,Mj=Rj("".split),_j=Ej(function(){return!Ey("z").propertyIsEnumerable(0)})?function(t){return Tj(t)==="String"?Mj(t,""):Ey(t)}:Ey,M0=function(t){return t==null},Pj=M0,xj=TypeError,Xf=function(t){if(Pj(t))throw new xj("Can't call method on "+t);return t},Ij=_j,Oj=Xf,Jf=function(t){return Ij(Oj(t))},Ty=typeof document=="object"&&document.all,Cn=typeof Ty>"u"&&Ty!==void 0?function(t){return typeof t=="function"||t===Ty}:function(t){return typeof t=="function"},Aj=Cn,Ti=function(t){return typeof t=="object"?t!==null:Aj(t)},My=vn,Hj=Cn,Nj=function(t){return Hj(t)?t:void 0},sh=function(t,e){return arguments.length<2?Nj(My[t]):My[t]&&My[t][e]},Dj=dn,Zf=Dj({}.isPrototypeOf),kj=vn,gP=kj.navigator,mP=gP&&gP.userAgent,vv=mP?String(mP):"",KH=vn,_y=vv,pP=KH.process,wP=KH.Deno,vP=pP&&pP.versions||wP&&wP.version,yP=vP&&vP.v8,Xi,dw;yP&&(Xi=yP.split("."),dw=Xi[0]>0&&Xi[0]<4?1:+(Xi[0]+Xi[1]));!dw&&_y&&(Xi=_y.match(/Edge\/(\d+)/),(!Xi||Xi[1]>=74)&&(Xi=_y.match(/Chrome\/(\d+)/),Xi&&(dw=+Xi[1])));var $j=dw,CP=$j,Lj=Nn,Fj=vn,Vj=Fj.String,_0=!!Object.getOwnPropertySymbols&&!Lj(function(){var t=Symbol("symbol detection");return!Vj(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&CP&&CP<41}),Wj=_0,qH=Wj&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Bj=sh,jj=Cn,Uj=Zf,zj=qH,Yj=Object,P0=zj?function(t){return typeof t=="symbol"}:function(t){var e=Bj("Symbol");return jj(e)&&Uj(e.prototype,Yj(t))},Gj=String,yv=function(t){try{return Gj(t)}catch{return"Object"}},Kj=Cn,qj=yv,Xj=TypeError,Dr=function(t){if(Kj(t))return t;throw new Xj(qj(t)+" is not a function")},Jj=Dr,Zj=M0,Qf=function(t,e){var n=t[e];return Zj(n)?void 0:Jj(n)},Py=yn,xy=Cn,Iy=Ti,Qj=TypeError,eU=function(t,e){var n,r;if(e==="string"&&xy(n=t.toString)&&!Iy(r=Py(n,t))||xy(n=t.valueOf)&&!Iy(r=Py(n,t))||e!=="string"&&xy(n=t.toString)&&!Iy(r=Py(n,t)))return r;throw new Qj("Can't convert object to primitive value")},XH={exports:{}},bP=vn,tU=Object.defineProperty,x0=function(t,e){try{tU(bP,t,{value:e,configurable:!0,writable:!0})}catch{bP[t]=e}return e},nU=vn,rU=x0,SP="__core-js_shared__",RP=XH.exports=nU[SP]||rU(SP,{});(RP.versions||(RP.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var I0=XH.exports,EP=I0,JH=function(t,e){return EP[t]||(EP[t]=e||{})},iU=Xf,oU=Object,ah=function(t){return oU(iU(t))},sU=dn,aU=ah,lU=sU({}.hasOwnProperty),Mi=Object.hasOwn||function(e,n){return lU(aU(e),n)},uU=dn,cU=0,hU=Math.random(),dU=uU(1 .toString),ZH=function(t){return"Symbol("+(t===void 0?"":t)+")_"+dU(++cU+hU,36)},fU=vn,gU=JH,TP=Mi,mU=ZH,pU=_0,wU=qH,Mc=fU.Symbol,Oy=gU("wks"),vU=wU?Mc.for||Mc:Mc&&Mc.withoutSetter||mU,oo=function(t){return TP(Oy,t)||(Oy[t]=pU&&TP(Mc,t)?Mc[t]:vU("Symbol."+t)),Oy[t]},yU=yn,MP=Ti,_P=P0,CU=Qf,bU=eU,SU=oo,RU=TypeError,EU=SU("toPrimitive"),TU=function(t,e){if(!MP(t)||_P(t))return t;var n=CU(t,EU),r;if(n){if(e===void 0&&(e="default"),r=yU(n,t,e),!MP(r)||_P(r))return r;throw new RU("Can't convert object to primitive value")}return e===void 0&&(e="number"),bU(t,e)},MU=TU,_U=P0,QH=function(t){var e=MU(t,"string");return _U(e)?e:e+""},PU=vn,PP=Ti,LS=PU.document,xU=PP(LS)&&PP(LS.createElement),O0=function(t){return xU?LS.createElement(t):{}},IU=Ei,OU=Nn,AU=O0,eN=!IU&&!OU(function(){return Object.defineProperty(AU("div"),"a",{get:function(){return 7}}).a!==7}),HU=Ei,NU=yn,DU=BH,kU=wv,$U=Jf,LU=QH,FU=Mi,VU=eN,xP=Object.getOwnPropertyDescriptor;T0.f=HU?xP:function(e,n){if(e=$U(e),n=LU(n),VU)try{return xP(e,n)}catch{}if(FU(e,n))return kU(!NU(DU.f,e,n),e[n])};var zs={},WU=Ei,BU=Nn,tN=WU&&BU(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),jU=Ti,UU=String,zU=TypeError,bn=function(t){if(jU(t))return t;throw new zU(UU(t)+" is not an object")},YU=Ei,GU=eN,KU=tN,Ng=bn,IP=QH,qU=TypeError,Ay=Object.defineProperty,XU=Object.getOwnPropertyDescriptor,Hy="enumerable",Ny="configurable",Dy="writable";zs.f=YU?KU?function(e,n,r){if(Ng(e),n=IP(n),Ng(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Dy in r&&!r[Dy]){var i=XU(e,n);i&&i[Dy]&&(e[n]=r.value,r={configurable:Ny in r?r[Ny]:i[Ny],enumerable:Hy in r?r[Hy]:i[Hy],writable:!1})}return Ay(e,n,r)}:Ay:function(e,n,r){if(Ng(e),n=IP(n),Ng(r),GU)try{return Ay(e,n,r)}catch{}if("get"in r||"set"in r)throw new qU("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var JU=Ei,ZU=zs,QU=wv,lh=JU?function(t,e,n){return ZU.f(t,e,QU(1,n))}:function(t,e,n){return t[e]=n,t},nN={exports:{}},FS=Ei,ez=Mi,rN=Function.prototype,tz=FS&&Object.getOwnPropertyDescriptor,nz=ez(rN,"name"),rz=nz&&(!FS||FS&&tz(rN,"name").configurable),iz={CONFIGURABLE:rz},oz=dn,sz=Cn,VS=I0,az=oz(Function.toString);sz(VS.inspectSource)||(VS.inspectSource=function(t){return az(t)});var lz=VS.inspectSource,uz=vn,cz=Cn,OP=uz.WeakMap,hz=cz(OP)&&/native code/.test(String(OP)),dz=JH,fz=ZH,AP=dz("keys"),A0=function(t){return AP[t]||(AP[t]=fz(t))},H0={},gz=hz,iN=vn,mz=Ti,pz=lh,ky=Mi,$y=I0,wz=A0,vz=H0,HP="Object already initialized",WS=iN.TypeError,yz=iN.WeakMap,fw,yf,gw,Cz=function(t){return gw(t)?yf(t):fw(t,{})},bz=function(t){return function(e){var n;if(!mz(e)||(n=yf(e)).type!==t)throw new WS("Incompatible receiver, "+t+" required");return n}};if(gz||$y.state){var co=$y.state||($y.state=new yz);co.get=co.get,co.has=co.has,co.set=co.set,fw=function(t,e){if(co.has(t))throw new WS(HP);return e.facade=t,co.set(t,e),e},yf=function(t){return co.get(t)||{}},gw=function(t){return co.has(t)}}else{var Ou=wz("state");vz[Ou]=!0,fw=function(t,e){if(ky(t,Ou))throw new WS(HP);return e.facade=t,pz(t,Ou,e),e},yf=function(t){return ky(t,Ou)?t[Ou]:{}},gw=function(t){return ky(t,Ou)}}var oN={set:fw,get:yf,has:gw,enforce:Cz,getterFor:bz},N0=dn,Sz=Nn,Rz=Cn,Dg=Mi,BS=Ei,Ez=iz.CONFIGURABLE,Tz=lz,sN=oN,Mz=sN.enforce,_z=sN.get,NP=String,Ep=Object.defineProperty,Pz=N0("".slice),xz=N0("".replace),Iz=N0([].join),Oz=BS&&!Sz(function(){return Ep(function(){},"length",{value:8}).length!==8}),Az=String(String).split("String"),Hz=nN.exports=function(t,e,n){Pz(NP(e),0,7)==="Symbol("&&(e="["+xz(NP(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Dg(t,"name")||Ez&&t.name!==e)&&(BS?Ep(t,"name",{value:e,configurable:!0}):t.name=e),Oz&&n&&Dg(n,"arity")&&t.length!==n.arity&&Ep(t,"length",{value:n.arity});try{n&&Dg(n,"constructor")&&n.constructor?BS&&Ep(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=Mz(t);return Dg(r,"source")||(r.source=Iz(Az,typeof e=="string"?e:"")),t};Function.prototype.toString=Hz(function(){return Rz(this)&&_z(this).source||Tz(this)},"toString");var aN=nN.exports,Nz=Cn,Dz=zs,kz=aN,$z=x0,D0=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Nz(n)&&kz(n,o,r),r.global)i?t[e]=n:$z(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:Dz.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},lN={},Lz=Math.ceil,Fz=Math.floor,Vz=Math.trunc||function(e){var n=+e;return(n>0?Fz:Lz)(n)},Wz=Vz,eg=function(t){var e=+t;return e!==e||e===0?0:Wz(e)},Bz=eg,jz=Math.max,Uz=Math.min,zz=function(t,e){var n=Bz(t);return n<0?jz(n+e,0):Uz(n,e)},Yz=eg,Gz=Math.min,Kz=function(t){var e=Yz(t);return e>0?Gz(e,9007199254740991):0},qz=Kz,uh=function(t){return qz(t.length)},Xz=Jf,Jz=zz,Zz=uh,Qz=function(t){return function(e,n,r){var i=Xz(e),o=Zz(i);if(o===0)return!t&&-1;var s=Jz(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},eY={indexOf:Qz(!1)},tY=dn,Ly=Mi,nY=Jf,rY=eY.indexOf,iY=H0,DP=tY([].push),uN=function(t,e){var n=nY(t),r=0,i=[],o;for(o in n)!Ly(iY,o)&&Ly(n,o)&&DP(i,o);for(;e.length>r;)Ly(n,o=e[r++])&&(~rY(i,o)||DP(i,o));return i},k0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],oY=uN,sY=k0,aY=sY.concat("length","prototype");lN.f=Object.getOwnPropertyNames||function(e){return oY(e,aY)};var cN={};cN.f=Object.getOwnPropertySymbols;var lY=sh,uY=dn,cY=lN,hY=cN,dY=bn,fY=uY([].concat),gY=lY("Reflect","ownKeys")||function(e){var n=cY.f(dY(e)),r=hY.f;return r?fY(n,r(e)):n},kP=Mi,mY=gY,pY=T0,wY=zs,hN=function(t,e,n){for(var r=mY(e),i=wY.f,o=pY.f,s=0;s<r.length;s++){var a=r[s];!kP(t,a)&&!(n&&kP(n,a))&&i(t,a,o(e,a))}},vY=Nn,yY=Cn,CY=/#|\.prototype\./,tg=function(t,e){var n=SY[bY(t)];return n===EY?!0:n===RY?!1:yY(e)?vY(e):!!e},bY=tg.normalize=function(t){return String(t).replace(CY,".").toLowerCase()},SY=tg.data={},RY=tg.NATIVE="N",EY=tg.POLYFILL="P",TY=tg,kg=vn,MY=T0.f,_Y=lh,PY=D0,xY=x0,IY=hN,OY=TY,Ct=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=kg:i?s=kg[n]||xY(n,{}):s=kg[n]&&kg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=MY(s,a),l=c&&c.value):l=s[a],o=OY(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;IY(u,l)}(t.sham||l&&l.sham)&&_Y(u,"sham",!0),PY(s,a,u,t)}},AY=pv,dN=Function.prototype,$P=dN.apply,LP=dN.call,ng=typeof Reflect=="object"&&Reflect.apply||(AY?LP.bind($P):function(){return LP.apply($P,arguments)}),HY=dn,NY=Dr,fN=function(t,e,n){try{return HY(NY(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},DY=Ti,kY=function(t){return DY(t)||t===null},$Y=kY,LY=String,FY=TypeError,VY=function(t){if($Y(t))return t;throw new FY("Can't set "+LY(t)+" as a prototype")},WY=fN,BY=Ti,jY=Xf,UY=VY,gN=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=WY(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return jY(i),UY(o),BY(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),zY=zs.f,YY=function(t,e,n){n in t||zY(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},GY=Cn,KY=Ti,FP=gN,qY=function(t,e,n){var r,i;return FP&&GY(r=e.constructor)&&r!==n&&KY(i=r.prototype)&&i!==n.prototype&&FP(t,i),t},XY=oo,JY=XY("toStringTag"),mN={};mN[JY]="z";var ZY=String(mN)==="[object z]",QY=ZY,eG=Cn,Tp=wu,tG=oo,nG=tG("toStringTag"),rG=Object,iG=Tp(function(){return arguments}())==="Arguments",oG=function(t,e){try{return t[e]}catch{}},pN=QY?Tp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=oG(e=rG(t),nG))=="string"?n:iG?Tp(e):(r=Tp(e))==="Object"&&eG(e.callee)?"Arguments":r},sG=pN,aG=String,Cv=function(t){if(sG(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return aG(t)},lG=Cv,uG=function(t,e){return t===void 0?arguments.length<2?"":e:lG(t)},cG=Ti,hG=lh,dG=function(t,e){cG(e)&&"cause"in e&&hG(t,"cause",e.cause)},fG=dn,wN=Error,gG=fG("".replace),mG=function(t){return String(new wN(t).stack)}("zxcasd"),vN=/\n\s*at [^:]*:[^\n]*/,pG=vN.test(mG),wG=function(t,e){if(pG&&typeof t=="string"&&!wN.prepareStackTrace)for(;e--;)t=gG(t,vN,"");return t},vG=Nn,yG=wv,CG=!vG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",yG(1,7)),t.stack!==7):!0}),bG=lh,SG=wG,RG=CG,VP=Error.captureStackTrace,EG=function(t,e,n,r){RG&&(VP?VP(t,e):bG(t,"stack",SG(n,r)))},WP=sh,TG=Mi,BP=lh,MG=Zf,jP=gN,UP=hN,zP=YY,_G=qY,PG=uG,xG=dG,IG=EG,OG=Ei,AG=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=WP.apply(null,s);if(l){var u=l.prototype;if(TG(u,"cause")&&delete u.cause,!n)return l;var c=WP("Error"),h=e(function(d,f){var g=PG(r?f:d,void 0),v=r?new l(d):new l;return g!==void 0&&BP(v,"message",g),IG(v,h,v.stack,2),this&&MG(u,this)&&_G(v,this,h),arguments.length>o&&xG(v,arguments[o]),v});h.prototype=u,a!=="Error"?jP?jP(h,c):UP(h,c,{name:!0}):OG&&i in l&&(zP(h,l,i),zP(h,l,"prepareStackTrace")),UP(h,l);try{u.name!==a&&BP(u,"name",a),u.constructor=h}catch{}return h}},yN=Ct,HG=vn,qo=ng,CN=AG,jS="WebAssembly",YP=HG[jS],mw=new Error("e",{cause:7}).cause!==7,vu=function(t,e){var n={};n[t]=CN(t,e,mw),yN({global:!0,constructor:!0,arity:1,forced:mw},n)},$0=function(t,e){if(YP&&YP[t]){var n={};n[t]=CN(jS+"."+t,e,mw),yN({target:jS,stat:!0,constructor:!0,arity:1,forced:mw},n)}};vu("Error",function(t){return function(n){return qo(t,this,arguments)}});vu("EvalError",function(t){return function(n){return qo(t,this,arguments)}});vu("RangeError",function(t){return function(n){return qo(t,this,arguments)}});vu("ReferenceError",function(t){return function(n){return qo(t,this,arguments)}});vu("SyntaxError",function(t){return function(n){return qo(t,this,arguments)}});vu("TypeError",function(t){return function(n){return qo(t,this,arguments)}});vu("URIError",function(t){return function(n){return qo(t,this,arguments)}});$0("CompileError",function(t){return function(n){return qo(t,this,arguments)}});$0("LinkError",function(t){return function(n){return qo(t,this,arguments)}});$0("RuntimeError",function(t){return function(n){return qo(t,this,arguments)}});var NG=wu,bN=Array.isArray||function(e){return NG(e)==="Array"},DG=Ei,kG=bN,$G=TypeError,LG=Object.getOwnPropertyDescriptor,FG=DG&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),SN=FG?function(t,e){if(kG(t)&&!LG(t,"length").writable)throw new $G("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},VG=TypeError,WG=9007199254740991,RN=function(t){if(t>WG)throw VG("Maximum allowed index exceeded");return t},BG=Ct,jG=ah,UG=uh,zG=SN,YG=RN,GG=Nn,KG=GG(function(){return[].push.call({length:4294967296},1)!==4294967297}),qG=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},XG=KG||!qG();BG({target:"Array",proto:!0,arity:1,forced:XG},{push:function(e){var n=jG(this),r=UG(n),i=arguments.length;YG(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return zG(n,r),r}});var JG=wu,ZG=dn,QG=function(t){if(JG(t)==="Function")return ZG(t)},GP=QG,eK=Dr,tK=pv,nK=GP(GP.bind),EN=function(t,e){return eK(t),e===void 0?t:tK?nK(t,e):function(){return t.apply(e,arguments)}},TN={},rK=oo,iK=TN,oK=rK("iterator"),sK=Array.prototype,aK=function(t){return t!==void 0&&(iK.Array===t||sK[oK]===t)},lK=pN,KP=Qf,uK=M0,cK=TN,hK=oo,dK=hK("iterator"),L0=function(t){if(!uK(t))return KP(t,dK)||KP(t,"@@iterator")||cK[lK(t)]},fK=yn,gK=Dr,mK=bn,pK=yv,wK=L0,vK=TypeError,yK=function(t,e){var n=arguments.length<2?wK(t):e;if(gK(n))return mK(fK(n,t));throw new vK(pK(t)+" is not iterable")},CK=yn,qP=bn,bK=Qf,ti=function(t,e,n){var r,i;qP(t);try{if(r=bK(t,"return"),!r){if(e==="throw")throw n;return n}r=CK(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return qP(r),n},SK=EN,RK=yn,EK=bn,TK=yv,MK=aK,_K=uh,XP=Zf,PK=yK,xK=L0,JP=ti,IK=TypeError,Mp=function(t,e){this.stopped=t,this.result=e},ZP=Mp.prototype,ch=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=SK(e,r),u,c,h,d,f,g,v,y=function(C){return u&&JP(u,"normal",C),new Mp(!0,C)},E=function(C){return i?(EK(C),a?l(C[0],C[1],y):l(C[0],C[1])):a?l(C,y):l(C)};if(o)u=t.iterator;else if(s)u=t;else{if(c=xK(t),!c)throw new IK(TK(t)+" is not iterable");if(MK(c)){for(h=0,d=_K(t);d>h;h++)if(f=E(t[h]),f&&XP(ZP,f))return f;return new Mp(!1)}u=PK(t,c)}for(g=o?t.next:u.next;!(v=RK(g,u)).done;){try{f=E(v.value)}catch(C){JP(u,"throw",C)}if(typeof f=="object"&&f&&XP(ZP,f))return f}return new Mp(!1)},OK=Ei,AK=zs,HK=wv,MN=function(t,e,n){OK?AK.f(t,e,HK(0,n)):t[e]=n},NK=Ct,DK=ch,kK=MN;NK({target:"Object",stat:!0},{fromEntries:function(e){var n={};return DK(e,function(r,i){kK(n,r,i)},{AS_ENTRIES:!0}),n}});var Fy=dn,$g=Set.prototype,Xo={Set,add:Fy($g.add),has:Fy($g.has),remove:Fy($g.delete),proto:$g},$K=Xo.has,yu=function(t){return $K(t),t},LK=yn,Cu=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=LK(i,r)).done;)if(s=e(o.value),s!==void 0)return s},_N=dn,FK=Cu,PN=Xo,VK=PN.Set,xN=PN.proto,WK=_N(xN.forEach),IN=_N(xN.keys),BK=IN(new VK).next,rg=function(t,e,n){return n?FK({iterator:IN(t),next:BK},e):WK(t,e)},ON=Xo,jK=rg,UK=ON.Set,zK=ON.add,F0=function(t){var e=new UK;return jK(t,function(n){zK(e,n)}),e},YK=fN,GK=Xo,ig=YK(GK.proto,"size","get")||function(t){return t.size},Jo=function(t){return{iterator:t,next:t.next,done:!1}},QP=Dr,AN=bn,ex=yn,KK=eg,qK=Jo,tx="Invalid size",XK=RangeError,JK=TypeError,ZK=Math.max,HN=function(t,e){this.set=t,this.size=ZK(e,0),this.has=QP(t.has),this.keys=QP(t.keys)};HN.prototype={getIterator:function(){return qK(AN(ex(this.keys,this.set)))},includes:function(t){return ex(this.has,this.set,t)}};var bu=function(t){AN(t);var e=+t.size;if(e!==e)throw new JK(tx);var n=KK(e);if(n<0)throw new XK(tx);return new HN(t,n)},QK=yu,NN=Xo,e3=F0,t3=ig,n3=bu,r3=rg,i3=Cu,o3=NN.has,nx=NN.remove,s3=function(e){var n=QK(this),r=n3(e),i=e3(n);return t3(n)<=r.size?r3(n,function(o){r.includes(o)&&nx(i,o)}):i3(r.getIterator(),function(o){o3(n,o)&&nx(i,o)}),i},a3=sh,rx=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},ix=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},Su=function(t,e){var n=a3("Set");try{new n()[t](rx(0));try{return new n()[t](rx(-1)),!1}catch{if(!e)return!0;try{return new n()[t](ix(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](ix(1/0)))}}}catch{return!1}},l3=Ct,u3=s3,c3=Su,h3=!c3("difference",function(t){return t.size===0});l3({target:"Set",proto:!0,real:!0,forced:h3},{difference:u3});var d3=yu,V0=Xo,f3=ig,g3=bu,m3=rg,p3=Cu,w3=V0.Set,ox=V0.add,v3=V0.has,y3=function(e){var n=d3(this),r=g3(e),i=new w3;return f3(n)>r.size?p3(r.getIterator(),function(o){v3(n,o)&&ox(i,o)}):m3(n,function(o){r.includes(o)&&ox(i,o)}),i},C3=Ct,b3=Nn,S3=y3,R3=Su,E3=!R3("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||b3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});C3({target:"Set",proto:!0,real:!0,forced:E3},{intersection:S3});var T3=yu,M3=Xo.has,_3=ig,P3=bu,x3=rg,I3=Cu,O3=ti,A3=function(e){var n=T3(this),r=P3(e);if(_3(n)<=r.size)return x3(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return I3(i,function(o){if(M3(n,o))return O3(i,"normal",!1)})!==!1},H3=Ct,N3=A3,D3=Su,k3=!D3("isDisjointFrom",function(t){return!t});H3({target:"Set",proto:!0,real:!0,forced:k3},{isDisjointFrom:N3});var $3=yu,L3=ig,F3=rg,V3=bu,W3=function(e){var n=$3(this),r=V3(e);return L3(n)>r.size?!1:F3(n,function(i){if(!r.includes(i))return!1},!0)!==!1},B3=Ct,j3=W3,U3=Su,z3=!U3("isSubsetOf",function(t){return t});B3({target:"Set",proto:!0,real:!0,forced:z3},{isSubsetOf:j3});var Y3=yu,G3=Xo.has,K3=ig,q3=bu,X3=Cu,J3=ti,Z3=function(e){var n=Y3(this),r=q3(e);if(K3(n)<r.size)return!1;var i=r.getIterator();return X3(i,function(o){if(!G3(n,o))return J3(i,"normal",!1)})!==!1},Q3=Ct,e5=Z3,t5=Su,n5=!t5("isSupersetOf",function(t){return!t});Q3({target:"Set",proto:!0,real:!0,forced:n5},{isSupersetOf:e5});var r5=yu,W0=Xo,i5=F0,o5=bu,s5=Cu,a5=W0.add,l5=W0.has,u5=W0.remove,c5=function(e){var n=r5(this),r=o5(e).getIterator(),i=i5(n);return s5(r,function(o){l5(n,o)?u5(i,o):a5(i,o)}),i},h5=Ct,d5=c5,f5=Su;h5({target:"Set",proto:!0,real:!0,forced:!f5("symmetricDifference")},{symmetricDifference:d5});var g5=yu,m5=Xo.add,p5=F0,w5=bu,v5=Cu,y5=function(e){var n=g5(this),r=w5(e).getIterator(),i=p5(n);return v5(r,function(o){m5(i,o)}),i},C5=Ct,b5=y5,S5=Su;C5({target:"Set",proto:!0,real:!0,forced:!S5("union")},{union:b5});var R5=Zf,E5=TypeError,T5=function(t,e){if(R5(e,t))return t;throw new E5("Incorrect invocation")},M5=Nn,_5=!M5(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),P5=Mi,x5=Cn,I5=ah,O5=A0,A5=_5,sx=O5("IE_PROTO"),US=Object,H5=US.prototype,DN=A5?US.getPrototypeOf:function(t){var e=I5(t);if(P5(e,sx))return e[sx];var n=e.constructor;return x5(n)&&e instanceof n?n.prototype:e instanceof US?H5:null},ax=aN,N5=zs,D5=function(t,e,n){return n.get&&ax(n.get,e,{getter:!0}),n.set&&ax(n.set,e,{setter:!0}),N5.f(t,e,n)},kN={},k5=uN,$5=k0,L5=Object.keys||function(e){return k5(e,$5)},F5=Ei,V5=tN,W5=zs,B5=bn,j5=Jf,U5=L5;kN.f=F5&&!V5?Object.defineProperties:function(e,n){B5(e);for(var r=j5(n),i=U5(n),o=i.length,s=0,a;o>s;)W5.f(e,a=i[s++],r[a]);return e};var z5=sh,$N=z5("document","documentElement"),Y5=bn,G5=kN,lx=k0,K5=H0,q5=$N,X5=O0,J5=A0,ux=">",cx="<",zS="prototype",YS="script",LN=J5("IE_PROTO"),Vy=function(){},FN=function(t){return cx+YS+ux+t+cx+"/"+YS+ux},hx=function(t){t.write(FN("")),t.close();var e=t.parentWindow.Object;return t=null,e},Z5=function(){var t=X5("iframe"),e="java"+YS+":",n;return t.style.display="none",q5.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(FN("document.F=Object")),n.close(),n.F},Lg,_p=function(){try{Lg=new ActiveXObject("htmlfile")}catch{}_p=typeof document<"u"?document.domain&&Lg?hx(Lg):Z5():hx(Lg);for(var t=lx.length;t--;)delete _p[zS][lx[t]];return _p()};K5[LN]=!0;var VN=Object.create||function(e,n){var r;return e!==null?(Vy[zS]=Y5(e),r=new Vy,Vy[zS]=null,r[LN]=e):r=_p(),n===void 0?r:G5.f(r,n)},Q5=Nn,eq=Cn,tq=Ti,dx=DN,nq=D0,rq=oo,GS=rq("iterator"),su,Wy,By;[].keys&&(By=[].keys(),"next"in By&&(Wy=dx(dx(By)),Wy!==Object.prototype&&(su=Wy)));var iq=!tq(su)||Q5(function(){var t={};return su[GS].call(t)!==t});iq&&(su={});eq(su[GS])||nq(su,GS,function(){return this});var WN={IteratorPrototype:su},oq=Ct,sq=vn,aq=T5,lq=bn,uq=Cn,cq=DN,hq=D5,dq=MN,fq=Nn,B0=Mi,gq=oo,jo=WN.IteratorPrototype,mq=Ei,jy="constructor",BN="Iterator",fx=gq("toStringTag"),jN=TypeError,Uy=sq[BN],UN=!uq(Uy)||Uy.prototype!==jo||!fq(function(){Uy({})}),j0=function(){if(aq(this,jo),cq(this)===jo)throw new jN("Abstract class Iterator not directly constructable")},zN=function(t,e){mq?hq(jo,t,{configurable:!0,get:function(){return e},set:function(n){if(lq(this),this===jo)throw new jN("You can't redefine this property");B0(this,t)?this[t]=n:dq(this,t,n)}}):jo[t]=e};B0(jo,fx)||zN(fx,BN);(UN||!B0(jo,jy)||jo[jy]===Object)&&zN(jy,j0);j0.prototype=jo;oq({global:!0,constructor:!0,forced:UN},{Iterator:j0});var pq=D0,wq=function(t,e,n){for(var r in e)pq(t,r,e[r],n);return t},vq=function(t,e){return{value:t,done:e}},yq=yn,Cq=VN,bq=lh,Sq=wq,Rq=oo,YN=oN,Eq=Qf,Tq=WN.IteratorPrototype,Fg=vq,zy=ti,Mq=Rq("toStringTag"),GN="IteratorHelper",KN="WrapForValidIterator",_q=YN.set,qN=function(t){var e=YN.getterFor(t?KN:GN);return Sq(Cq(Tq),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return Fg(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:Fg(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=Eq(r,"return");return i?yq(i,r):Fg(void 0,!0)}if(n.inner)try{zy(n.inner.iterator,"normal")}catch(o){return zy(r,"throw",o)}return r&&zy(r,"normal"),Fg(void 0,!0)}})},Pq=qN(!0),XN=qN(!1);bq(XN,Mq,"Iterator Helper");var U0=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?KN:GN,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,_q(this,s)};return r.prototype=e?Pq:XN,r},xq=bn,Iq=ti,JN=function(t,e,n,r){try{return r?e(xq(n)[0],n[1]):e(n)}catch(i){Iq(t,"throw",i)}},Oq=vn,Ga=function(t,e){var n=Oq.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},Aq=Ct,ZN=yn,Hq=Dr,QN=bn,Nq=Jo,Dq=U0,kq=JN,$q=ti,Lq=Ga,Yy=Lq("filter",TypeError),Fq=Dq(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=QN(ZN(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,kq(t,e,[o,this.counter++],!0))return o}});Aq({target:"Iterator",proto:!0,real:!0,forced:Yy},{filter:function(e){QN(this);try{Hq(e)}catch(n){$q(this,"throw",n)}return Yy?ZN(Yy,this,e):new Fq(Nq(this),{predicate:e})}});var Vq=Ct,Wq=yn,Bq=ch,jq=Dr,Uq=bn,zq=Jo,Yq=ti,Gq=Ga,Gy=Gq("forEach",TypeError);Vq({target:"Iterator",proto:!0,real:!0,forced:Gy},{forEach:function(e){Uq(this);try{jq(e)}catch(i){Yq(this,"throw",i)}if(Gy)return Wq(Gy,this,e);var n=zq(this),r=0;Bq(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var Kq=Ct,eD=yn,qq=Dr,tD=bn,Xq=Jo,Jq=U0,Zq=JN,Qq=ti,e4=Ga,Ky=e4("map",TypeError),t4=Jq(function(){var t=this.iterator,e=tD(eD(this.next,t)),n=this.done=!!e.done;if(!n)return Zq(t,this.mapper,[e.value,this.counter++],!0)});Kq({target:"Iterator",proto:!0,real:!0,forced:Ky},{map:function(e){tD(this);try{qq(e)}catch(n){Qq(this,"throw",n)}return Ky?eD(Ky,this,e):new t4(Xq(this),{mapper:e})}});var n4=dn,z0=n4([].slice),r4=TypeError,nD=function(t,e){if(t<e)throw new r4("Not enough arguments");return t},i4=vv,o4=/(?:ipad|iphone|ipod).*applewebkit/i.test(i4),_h=vn,s4=vv,a4=wu,Vg=function(t){return s4.slice(0,t.length)===t},rD=function(){return Vg("Bun/")?"BUN":Vg("Cloudflare-Workers")?"CLOUDFLARE":Vg("Deno/")?"DENO":Vg("Node.js/")?"NODE":_h.Bun&&typeof Bun.version=="string"?"BUN":_h.Deno&&typeof Deno.version=="object"?"DENO":a4(_h.process)==="process"?"NODE":_h.window&&_h.document?"BROWSER":"REST"}(),l4=rD,u4=l4==="NODE",Jr=vn,c4=ng,h4=EN,gx=Cn,d4=Mi,iD=Nn,mx=$N,f4=z0,px=O0,g4=nD,m4=o4,p4=u4,KS=Jr.setImmediate,qS=Jr.clearImmediate,w4=Jr.process,qy=Jr.Dispatch,v4=Jr.Function,wx=Jr.MessageChannel,y4=Jr.String,Xy=0,Wd={},vx="onreadystatechange",Cf,Qa,Jy,Zy;iD(function(){Cf=Jr.location});var Y0=function(t){if(d4(Wd,t)){var e=Wd[t];delete Wd[t],e()}},Qy=function(t){return function(){Y0(t)}},yx=function(t){Y0(t.data)},Cx=function(t){Jr.postMessage(y4(t),Cf.protocol+"//"+Cf.host)};(!KS||!qS)&&(KS=function(e){g4(arguments.length,1);var n=gx(e)?e:v4(e),r=f4(arguments,1);return Wd[++Xy]=function(){c4(n,void 0,r)},Qa(Xy),Xy},qS=function(e){delete Wd[e]},p4?Qa=function(t){w4.nextTick(Qy(t))}:qy&&qy.now?Qa=function(t){qy.now(Qy(t))}:wx&&!m4?(Jy=new wx,Zy=Jy.port2,Jy.port1.onmessage=yx,Qa=h4(Zy.postMessage,Zy)):Jr.addEventListener&&gx(Jr.postMessage)&&!Jr.importScripts&&Cf&&Cf.protocol!=="file:"&&!iD(Cx)?(Qa=Cx,Jr.addEventListener("message",yx,!1)):vx in px("script")?Qa=function(t){mx.appendChild(px("script"))[vx]=function(){mx.removeChild(this),Y0(t)}}:Qa=function(t){setTimeout(Qy(t),0)});var oD={set:KS,clear:qS},C4=Ct,b4=vn,bx=oD.clear;C4({global:!0,bind:!0,enumerable:!0,forced:b4.clearImmediate!==bx},{clearImmediate:bx});var sD=vn,S4=ng,R4=Cn,E4=rD,T4=vv,M4=z0,_4=nD,P4=sD.Function,x4=/MSIE .\./.test(T4)||E4==="BUN"&&function(){var t=sD.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),I4=function(t,e){var n=e?2:1;return x4?function(r,i){var o=_4(arguments.length,1)>n,s=R4(r)?r:P4(r),a=o?M4(arguments,n):[],l=o?function(){S4(s,this,a)}:s;return e?t(l,i):t(l)}:t},O4=Ct,aD=vn,Sx=oD.set,A4=I4,Rx=aD.setImmediate?A4(Sx,!1):Sx;O4({global:!0,bind:!0,enumerable:!0,forced:aD.setImmediate!==Rx},{setImmediate:Rx});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:lD,setPrototypeOf:Ex,isFrozen:H4,getPrototypeOf:N4,getOwnPropertyDescriptor:D4}=Object;let{freeze:hr,seal:Si,create:uD}=Object,{apply:XS,construct:JS}=typeof Reflect<"u"&&Reflect;hr||(hr=function(e){return e});Si||(Si=function(e){return e});XS||(XS=function(e,n,r){return e.apply(n,r)});JS||(JS=function(e,n){return new e(...n)});const Wg=dr(Array.prototype.forEach),k4=dr(Array.prototype.lastIndexOf),Tx=dr(Array.prototype.pop),Ph=dr(Array.prototype.push),$4=dr(Array.prototype.splice),Pp=dr(String.prototype.toLowerCase),eC=dr(String.prototype.toString),Mx=dr(String.prototype.match),xh=dr(String.prototype.replace),L4=dr(String.prototype.indexOf),F4=dr(String.prototype.trim),Wi=dr(Object.prototype.hasOwnProperty),tr=dr(RegExp.prototype.test),Ih=V4(TypeError);function dr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return XS(t,e,r)}}function V4(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return JS(t,n)}}function Be(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pp;Ex&&Ex(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(H4(e)||(e[r]=o),i=o)}t[i]=!0}return t}function W4(t){for(let e=0;e<t.length;e++)Wi(t,e)||(t[e]=null);return t}function Fl(t){const e=uD(null);for(const[n,r]of lD(t))Wi(t,n)&&(Array.isArray(r)?e[n]=W4(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Fl(r):e[n]=r);return e}function Oh(t,e){for(;t!==null;){const r=D4(t,e);if(r){if(r.get)return dr(r.get);if(typeof r.value=="function")return dr(r.value)}t=N4(t)}function n(){return null}return n}const _x=hr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),tC=hr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),nC=hr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),B4=hr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rC=hr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),j4=hr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Px=hr(["#text"]),xx=hr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),iC=hr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ix=hr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Bg=hr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),U4=Si(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z4=Si(/<%[\w\W]*|[\w\W]*%>/gm),Y4=Si(/\$\{[\w\W]*/gm),G4=Si(/^data-[\-\w.\u00B7-\uFFFF]+$/),K4=Si(/^aria-[\-\w]+$/),cD=Si(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q4=Si(/^(?:\w+script|data):/i),X4=Si(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),hD=Si(/^html$/i),J4=Si(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ox=Object.freeze({__proto__:null,ARIA_ATTR:K4,ATTR_WHITESPACE:X4,CUSTOM_ELEMENT:J4,DATA_ATTR:G4,DOCTYPE_NAME:hD,ERB_EXPR:z4,IS_ALLOWED_URI:cD,IS_SCRIPT_OR_DATA:q4,MUSTACHE_EXPR:U4,TMPLIT_EXPR:Y4});const Ah={element:1,text:3,progressingInstruction:7,comment:8,document:9},Z4=function(){return typeof window>"u"?null:window},Q4=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Ax=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function dD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Z4();const e=ye=>dD(ye);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==Ah.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,v=Oh(g,"cloneNode"),y=Oh(g,"remove"),E=Oh(g,"nextSibling"),C=Oh(g,"childNodes"),_=Oh(g,"parentNode");if(typeof s=="function"){const ye=n.createElement("template");ye.content&&ye.content.ownerDocument&&(n=ye.content.ownerDocument)}let I,P="";const{implementation:T,createNodeIterator:A,createDocumentFragment:G,getElementsByTagName:U}=n,{importNode:V}=r;let X=Ax();e.isSupported=typeof lD=="function"&&typeof _=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:Q,TMPLIT_EXPR:te,DATA_ATTR:pe,ARIA_ATTR:et,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Ae,CUSTOM_ELEMENT:ot}=Ox;let{IS_ALLOWED_URI:Pn}=Ox,st=null;const m=Be({},[..._x,...tC,...nC,...rC,...Px]);let w=null;const p=Be({},[...xx,...iC,...Ix,...Bg]);let O=Object.seal(uD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,j=null,K=!0,J=!0,b=!1,R=!0,S=!1,$=!0,x=!1,N=!1,B=!1,H=!1,D=!1,W=!1,F=!0,Y=!1;const ae="user-content-";let ce=!0,_e=!1,Fe={},ze=null;const Me=Be({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ve=null;const Mt=Be({},["audio","video","img","source","image","track"]);let Oi=null;const ns=Be({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ri="http://www.w3.org/1998/Math/MathML",_t="http://www.w3.org/2000/svg",gn="http://www.w3.org/1999/xhtml";let bt=gn,Pt=!1,We=null;const ii=Be({},[ri,_t,gn],eC);let Xa=Be({},["mi","mo","mn","ms","mtext"]),Ja=Be({},["annotation-xml"]);const PV=Be({},["title","style","font","a","script"]);let Sh=null;const xV=["application/xhtml+xml","text/html"],IV="text/html";let xn=null,Iu=null;const OV=n.createElement("form"),V_=function(k){return k instanceof RegExp||k instanceof Function},yy=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Iu&&Iu===k)){if((!k||typeof k!="object")&&(k={}),k=Fl(k),Sh=xV.indexOf(k.PARSER_MEDIA_TYPE)===-1?IV:k.PARSER_MEDIA_TYPE,xn=Sh==="application/xhtml+xml"?eC:Pp,st=Wi(k,"ALLOWED_TAGS")?Be({},k.ALLOWED_TAGS,xn):m,w=Wi(k,"ALLOWED_ATTR")?Be({},k.ALLOWED_ATTR,xn):p,We=Wi(k,"ALLOWED_NAMESPACES")?Be({},k.ALLOWED_NAMESPACES,eC):ii,Oi=Wi(k,"ADD_URI_SAFE_ATTR")?Be(Fl(ns),k.ADD_URI_SAFE_ATTR,xn):ns,Ve=Wi(k,"ADD_DATA_URI_TAGS")?Be(Fl(Mt),k.ADD_DATA_URI_TAGS,xn):Mt,ze=Wi(k,"FORBID_CONTENTS")?Be({},k.FORBID_CONTENTS,xn):Me,L=Wi(k,"FORBID_TAGS")?Be({},k.FORBID_TAGS,xn):{},j=Wi(k,"FORBID_ATTR")?Be({},k.FORBID_ATTR,xn):{},Fe=Wi(k,"USE_PROFILES")?k.USE_PROFILES:!1,K=k.ALLOW_ARIA_ATTR!==!1,J=k.ALLOW_DATA_ATTR!==!1,b=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=k.SAFE_FOR_TEMPLATES||!1,$=k.SAFE_FOR_XML!==!1,x=k.WHOLE_DOCUMENT||!1,H=k.RETURN_DOM||!1,D=k.RETURN_DOM_FRAGMENT||!1,W=k.RETURN_TRUSTED_TYPE||!1,B=k.FORCE_BODY||!1,F=k.SANITIZE_DOM!==!1,Y=k.SANITIZE_NAMED_PROPS||!1,ce=k.KEEP_CONTENT!==!1,_e=k.IN_PLACE||!1,Pn=k.ALLOWED_URI_REGEXP||cD,bt=k.NAMESPACE||gn,Xa=k.MATHML_TEXT_INTEGRATION_POINTS||Xa,Ja=k.HTML_INTEGRATION_POINTS||Ja,O=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&V_(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(O.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&V_(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(O.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(O.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(J=!1),D&&(H=!0),Fe&&(st=Be({},Px),w=[],Fe.html===!0&&(Be(st,_x),Be(w,xx)),Fe.svg===!0&&(Be(st,tC),Be(w,iC),Be(w,Bg)),Fe.svgFilters===!0&&(Be(st,nC),Be(w,iC),Be(w,Bg)),Fe.mathMl===!0&&(Be(st,rC),Be(w,Ix),Be(w,Bg))),k.ADD_TAGS&&(st===m&&(st=Fl(st)),Be(st,k.ADD_TAGS,xn)),k.ADD_ATTR&&(w===p&&(w=Fl(w)),Be(w,k.ADD_ATTR,xn)),k.ADD_URI_SAFE_ATTR&&Be(Oi,k.ADD_URI_SAFE_ATTR,xn),k.FORBID_CONTENTS&&(ze===Me&&(ze=Fl(ze)),Be(ze,k.FORBID_CONTENTS,xn)),ce&&(st["#text"]=!0),x&&Be(st,["html","head","body"]),st.table&&(Be(st,["tbody"]),delete L.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ih('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ih('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');I=k.TRUSTED_TYPES_POLICY,P=I.createHTML("")}else I===void 0&&(I=Q4(f,i)),I!==null&&typeof P=="string"&&(P=I.createHTML(""));hr&&hr(k),Iu=k}},W_=Be({},[...tC,...nC,...B4]),B_=Be({},[...rC,...j4]),AV=function(k){let re=_(k);(!re||!re.tagName)&&(re={namespaceURI:bt,tagName:"template"});const me=Pp(k.tagName),kt=Pp(re.tagName);return We[k.namespaceURI]?k.namespaceURI===_t?re.namespaceURI===gn?me==="svg":re.namespaceURI===ri?me==="svg"&&(kt==="annotation-xml"||Xa[kt]):!!W_[me]:k.namespaceURI===ri?re.namespaceURI===gn?me==="math":re.namespaceURI===_t?me==="math"&&Ja[kt]:!!B_[me]:k.namespaceURI===gn?re.namespaceURI===_t&&!Ja[kt]||re.namespaceURI===ri&&!Xa[kt]?!1:!B_[me]&&(PV[me]||!W_[me]):!!(Sh==="application/xhtml+xml"&&We[k.namespaceURI]):!1},lo=function(k){Ph(e.removed,{element:k});try{_(k).removeChild(k)}catch{y(k)}},xg=function(k,re){try{Ph(e.removed,{attribute:re.getAttributeNode(k),from:re})}catch{Ph(e.removed,{attribute:null,from:re})}if(re.removeAttribute(k),k==="is")if(H||D)try{lo(re)}catch{}else try{re.setAttribute(k,"")}catch{}},j_=function(k){let re=null,me=null;if(B)k="<remove></remove>"+k;else{const Dn=Mx(k,/^[\r\n\t ]+/);me=Dn&&Dn[0]}Sh==="application/xhtml+xml"&&bt===gn&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const kt=I?I.createHTML(k):k;if(bt===gn)try{re=new d().parseFromString(kt,Sh)}catch{}if(!re||!re.documentElement){re=T.createDocument(bt,"template",null);try{re.documentElement.innerHTML=Pt?P:kt}catch{}}const Vn=re.body||re.documentElement;return k&&me&&Vn.insertBefore(n.createTextNode(me),Vn.childNodes[0]||null),bt===gn?U.call(re,x?"html":"body")[0]:x?re.documentElement:Vn},U_=function(k){return A.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Cy=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},z_=function(k){return typeof a=="function"&&k instanceof a};function rs(ye,k,re){Wg(ye,me=>{me.call(e,k,re,Iu)})}const Y_=function(k){let re=null;if(rs(X.beforeSanitizeElements,k,null),Cy(k))return lo(k),!0;const me=xn(k.nodeName);if(rs(X.uponSanitizeElement,k,{tagName:me,allowedTags:st}),k.hasChildNodes()&&!z_(k.firstElementChild)&&tr(/<[/\w!]/g,k.innerHTML)&&tr(/<[/\w!]/g,k.textContent)||k.nodeType===Ah.progressingInstruction||$&&k.nodeType===Ah.comment&&tr(/<[/\w]/g,k.data))return lo(k),!0;if(!st[me]||L[me]){if(!L[me]&&K_(me)&&(O.tagNameCheck instanceof RegExp&&tr(O.tagNameCheck,me)||O.tagNameCheck instanceof Function&&O.tagNameCheck(me)))return!1;if(ce&&!ze[me]){const kt=_(k)||k.parentNode,Vn=C(k)||k.childNodes;if(Vn&&kt){const Dn=Vn.length;for(let mr=Dn-1;mr>=0;--mr){const uo=v(Vn[mr],!0);uo.__removalCount=(k.__removalCount||0)+1,kt.insertBefore(uo,E(k))}}}return lo(k),!0}return k instanceof l&&!AV(k)||(me==="noscript"||me==="noembed"||me==="noframes")&&tr(/<\/no(script|embed|frames)/i,k.innerHTML)?(lo(k),!0):(S&&k.nodeType===Ah.text&&(re=k.textContent,Wg([ne,Q,te],kt=>{re=xh(re,kt," ")}),k.textContent!==re&&(Ph(e.removed,{element:k.cloneNode()}),k.textContent=re)),rs(X.afterSanitizeElements,k,null),!1)},G_=function(k,re,me){if(F&&(re==="id"||re==="name")&&(me in n||me in OV))return!1;if(!(J&&!j[re]&&tr(pe,re))){if(!(K&&tr(et,re))){if(!w[re]||j[re]){if(!(K_(k)&&(O.tagNameCheck instanceof RegExp&&tr(O.tagNameCheck,k)||O.tagNameCheck instanceof Function&&O.tagNameCheck(k))&&(O.attributeNameCheck instanceof RegExp&&tr(O.attributeNameCheck,re)||O.attributeNameCheck instanceof Function&&O.attributeNameCheck(re))||re==="is"&&O.allowCustomizedBuiltInElements&&(O.tagNameCheck instanceof RegExp&&tr(O.tagNameCheck,me)||O.tagNameCheck instanceof Function&&O.tagNameCheck(me))))return!1}else if(!Oi[re]){if(!tr(Pn,xh(me,Ae,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&k!=="script"&&L4(me,"data:")===0&&Ve[k])){if(!(b&&!tr(Re,xh(me,Ae,"")))){if(me)return!1}}}}}}return!0},K_=function(k){return k!=="annotation-xml"&&Mx(k,ot)},q_=function(k){rs(X.beforeSanitizeAttributes,k,null);const{attributes:re}=k;if(!re||Cy(k))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w,forceKeepAttr:void 0};let kt=re.length;for(;kt--;){const Vn=re[kt],{name:Dn,namespaceURI:mr,value:uo}=Vn,Rh=xn(Dn);let er=Dn==="value"?uo:F4(uo);if(me.attrName=Rh,me.attrValue=er,me.keepAttr=!0,me.forceKeepAttr=void 0,rs(X.uponSanitizeAttribute,k,me),er=me.attrValue,Y&&(Rh==="id"||Rh==="name")&&(xg(Dn,k),er=ae+er),$&&tr(/((--!?|])>)|<\/(style|title)/i,er)){xg(Dn,k);continue}if(me.forceKeepAttr||(xg(Dn,k),!me.keepAttr))continue;if(!R&&tr(/\/>/i,er)){xg(Dn,k);continue}S&&Wg([ne,Q,te],J_=>{er=xh(er,J_," ")});const X_=xn(k.nodeName);if(G_(X_,Rh,er)){if(I&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!mr)switch(f.getAttributeType(X_,Rh)){case"TrustedHTML":{er=I.createHTML(er);break}case"TrustedScriptURL":{er=I.createScriptURL(er);break}}try{mr?k.setAttributeNS(mr,Dn,er):k.setAttribute(Dn,er),Cy(k)?lo(k):Tx(e.removed)}catch{}}}rs(X.afterSanitizeAttributes,k,null)},HV=function ye(k){let re=null;const me=U_(k);for(rs(X.beforeSanitizeShadowDOM,k,null);re=me.nextNode();)rs(X.uponSanitizeShadowNode,re,null),Y_(re),q_(re),re.content instanceof o&&ye(re.content);rs(X.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(ye){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,me=null,kt=null,Vn=null;if(Pt=!ye,Pt&&(ye="<!-->"),typeof ye!="string"&&!z_(ye))if(typeof ye.toString=="function"){if(ye=ye.toString(),typeof ye!="string")throw Ih("dirty is not a string, aborting")}else throw Ih("toString is not a function");if(!e.isSupported)return ye;if(N||yy(k),e.removed=[],typeof ye=="string"&&(_e=!1),_e){if(ye.nodeName){const uo=xn(ye.nodeName);if(!st[uo]||L[uo])throw Ih("root node is forbidden and cannot be sanitized in-place")}}else if(ye instanceof a)re=j_("<!---->"),me=re.ownerDocument.importNode(ye,!0),me.nodeType===Ah.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?re=me:re.appendChild(me);else{if(!H&&!S&&!x&&ye.indexOf("<")===-1)return I&&W?I.createHTML(ye):ye;if(re=j_(ye),!re)return H?null:W?P:""}re&&B&&lo(re.firstChild);const Dn=U_(_e?ye:re);for(;kt=Dn.nextNode();)Y_(kt),q_(kt),kt.content instanceof o&&HV(kt.content);if(_e)return ye;if(H){if(D)for(Vn=G.call(re.ownerDocument);re.firstChild;)Vn.appendChild(re.firstChild);else Vn=re;return(w.shadowroot||w.shadowrootmode)&&(Vn=V.call(r,Vn,!0)),Vn}let mr=x?re.outerHTML:re.innerHTML;return x&&st["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&tr(hD,re.ownerDocument.doctype.name)&&(mr="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+mr),S&&Wg([ne,Q,te],uo=>{mr=xh(mr,uo," ")}),I&&W?I.createHTML(mr):mr},e.setConfig=function(){let ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};yy(ye),N=!0},e.clearConfig=function(){Iu=null,N=!1},e.isValidAttribute=function(ye,k,re){Iu||yy({});const me=xn(ye),kt=xn(k);return G_(me,kt,re)},e.addHook=function(ye,k){typeof k=="function"&&Ph(X[ye],k)},e.removeHook=function(ye,k){if(k!==void 0){const re=k4(X[ye],k);return re===-1?void 0:$4(X[ye],re,1)[0]}return Tx(X[ye])},e.removeHooks=function(ye){X[ye]=[]},e.removeAllHooks=function(){X=Ax()},e}var eX=dD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var fD;function Z(){return fD.apply(null,arguments)}function tX(t){fD=t}function no(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function tu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function rt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function G0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(rt(t,e))return!1;return!0}function Tr(t){return t===void 0}function Vs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function og(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function gD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function _a(t,e){for(var n in e)rt(e,n)&&(t[n]=e[n]);return rt(e,"toString")&&(t.toString=e.toString),rt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Zo(t,e,n,r){return $D(t,e,n,r,!0).utc()}function nX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ne(t){return t._pf==null&&(t._pf=nX()),t._pf}var ZS;Array.prototype.some?ZS=Array.prototype.some:ZS=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function K0(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ne(t),n=ZS.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function bv(t){var e=Zo(NaN);return t!=null?_a(Ne(e),t):Ne(e).userInvalidated=!0,e}var Hx=Z.momentProperties=[],oC=!1;function q0(t,e){var n,r,i,o=Hx.length;if(Tr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Tr(e._i)||(t._i=e._i),Tr(e._f)||(t._f=e._f),Tr(e._l)||(t._l=e._l),Tr(e._strict)||(t._strict=e._strict),Tr(e._tzm)||(t._tzm=e._tzm),Tr(e._isUTC)||(t._isUTC=e._isUTC),Tr(e._offset)||(t._offset=e._offset),Tr(e._pf)||(t._pf=Ne(e)),Tr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=Hx[n],i=e[r],Tr(i)||(t[r]=i);return t}function sg(t){q0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),oC===!1&&(oC=!0,Z.updateOffset(this),oC=!1)}function ro(t){return t instanceof sg||t!=null&&t._isAMomentObject!=null}function mD(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function _i(t,e){var n=!0;return _a(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])rt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}mD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Nx={};function pD(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),Nx[t]||(mD(e),Nx[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function Qo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function rX(t){var e,n;for(n in t)rt(t,n)&&(e=t[n],Qo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function QS(t,e){var n=_a({},t),r;for(r in e)rt(e,r)&&(tu(t[r])&&tu(e[r])?(n[r]={},_a(n[r],t[r]),_a(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)rt(t,r)&&!rt(e,r)&&tu(t[r])&&(n[r]=_a({},n[r]));return n}function X0(t){t!=null&&this.set(t)}var eR;Object.keys?eR=Object.keys:eR=function(t){var e,n=[];for(e in t)rt(t,e)&&n.push(e);return n};var iX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function oX(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Qo(r)?r.call(e,n):r}function Go(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var J0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,jg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,sC={},kc={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(kc[t]=i),e&&(kc[e[0]]=function(){return Go(i.apply(this,arguments),e[1],e[2])}),n&&(kc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function sX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function aX(t){var e=t.match(J0),n,r;for(n=0,r=e.length;n<r;n++)kc[e[n]]?e[n]=kc[e[n]]:e[n]=sX(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Qo(e[s])?e[s].call(i,t):e[s];return o}}function xp(t,e){return t.isValid()?(e=wD(e,t.localeData()),sC[e]=sC[e]||aX(e),sC[e](t)):t.localeData().invalidDate()}function wD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(jg.lastIndex=0;n>=0&&jg.test(t);)t=t.replace(jg,r),jg.lastIndex=0,n-=1;return t}var lX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function uX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(J0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var cX="Invalid date";function hX(){return this._invalidDate}var dX="%d",fX=/\d{1,2}/;function gX(t){return this._ordinal.replace("%d",t)}var mX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function pX(t,e,n,r){var i=this._relativeTime[n];return Qo(i)?i(t,e,n,r):i.replace(/%d/i,t)}function wX(t,e){var n=this._relativeTime[t>0?"future":"past"];return Qo(n)?n(e):n.replace(/%s/i,e)}var Dx={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Pi(t){return typeof t=="string"?Dx[t]||Dx[t.toLowerCase()]:void 0}function Z0(t){var e={},n,r;for(r in t)rt(t,r)&&(n=Pi(r),n&&(e[n]=t[r]));return e}var vX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function yX(t){var e=[],n;for(n in t)rt(t,n)&&e.push({unit:n,priority:vX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var vD=/\d/,ni=/\d\d/,yD=/\d{3}/,Q0=/\d{4}/,Sv=/[+-]?\d{6}/,Dt=/\d\d?/,CD=/\d\d\d\d?/,bD=/\d\d\d\d\d\d?/,Rv=/\d{1,3}/,eE=/\d{1,4}/,Ev=/[+-]?\d{1,6}/,hh=/\d+/,Tv=/[+-]?\d+/,CX=/Z|[+-]\d\d:?\d\d/gi,Mv=/Z|[+-]\d\d(?::?\d\d)?/gi,bX=/[+-]?\d+(\.\d{1,3})?/,ag=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,dh=/^[1-9]\d?/,tE=/^([1-9]\d|\d)/,pw;pw={};function ue(t,e,n){pw[t]=Qo(e)?e:function(r,i){return r&&n?n:e}}function SX(t,e){return rt(pw,t)?pw[t](e._strict,e._locale):new RegExp(RX(t))}function RX(t){return Ls(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Ls(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function wi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ge(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=wi(e)),n}var tR={};function wt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Vs(e)&&(r=function(o,s){s[e]=Ge(o)}),i=t.length,n=0;n<i;n++)tR[t[n]]=r}function lg(t,e){wt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function EX(t,e,n){e!=null&&rt(tR,t)&&tR[t](e,n._a,n,t)}function _v(t){return t%4===0&&t%100!==0||t%400===0}var Xn=0,Is=1,$o=2,Mn=3,Qi=4,Os=5,Gl=6,TX=7,MX=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?Go(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ue("Y",Tv);ue("YY",Dt,ni);ue("YYYY",eE,Q0);ue("YYYYY",Ev,Sv);ue("YYYYYY",Ev,Sv);wt(["YYYYY","YYYYYY"],Xn);wt("YYYY",function(t,e){e[Xn]=t.length===2?Z.parseTwoDigitYear(t):Ge(t)});wt("YY",function(t,e){e[Xn]=Z.parseTwoDigitYear(t)});wt("Y",function(t,e){e[Xn]=parseInt(t,10)});function Bd(t){return _v(t)?366:365}Z.parseTwoDigitYear=function(t){return Ge(t)+(Ge(t)>68?1900:2e3)};var SD=fh("FullYear",!0);function _X(){return _v(this.year())}function fh(t,e){return function(n){return n!=null?(RD(this,t,n),Z.updateOffset(this,e),this):bf(this,t)}}function bf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function RD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!_v(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function PX(t){return t=Pi(t),Qo(this[t])?this[t]():this}function xX(t,e){if(typeof t=="object"){t=Z0(t);var n=yX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Pi(t),Qo(this[t]))return this[t](e);return this}function IX(t,e){return(t%e+e)%e}var an;Array.prototype.indexOf?an=Array.prototype.indexOf:an=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function nE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=IX(e,12);return t+=(e-n)/12,n===1?_v(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Dt,dh);ue("MM",Dt,ni);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});wt(["M","MM"],function(t,e){e[Is]=Ge(t)-1});wt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Is]=i:Ne(n).invalidMonth=t});var OX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ED="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),TD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,AX=ag,HX=ag;function NX(t,e){return t?no(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||TD).test(e)?"format":"standalone"][t.month()]:no(this._months)?this._months:this._months.standalone}function DX(t,e){return t?no(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[TD.test(e)?"format":"standalone"][t.month()]:no(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function kX(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Zo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=an.call(this._shortMonthsParse,s),i!==-1?i:null):(i=an.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=an.call(this._shortMonthsParse,s),i!==-1?i:(i=an.call(this._longMonthsParse,s),i!==-1?i:null)):(i=an.call(this._longMonthsParse,s),i!==-1?i:(i=an.call(this._shortMonthsParse,s),i!==-1?i:null))}function $X(t,e,n){var r,i,o;if(this._monthsParseExact)return kX.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Zo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function MD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ge(e);else if(e=t.localeData().monthsParse(e),!Vs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,nE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function _D(t){return t!=null?(MD(this,t),Z.updateOffset(this,!0),this):bf(this,"Month")}function LX(){return nE(this.year(),this.month())}function FX(t){return this._monthsParseExact?(rt(this,"_monthsRegex")||PD.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(rt(this,"_monthsShortRegex")||(this._monthsShortRegex=AX),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function VX(t){return this._monthsParseExact?(rt(this,"_monthsRegex")||PD.call(this),t?this._monthsStrictRegex:this._monthsRegex):(rt(this,"_monthsRegex")||(this._monthsRegex=HX),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function PD(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Zo([2e3,i]),s=Ls(this.monthsShort(o,"")),a=Ls(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function WX(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Sf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function ww(t,e,n){var r=7+e-n,i=(7+Sf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function xD(t,e,n,r,i){var o=(7+n-r)%7,s=ww(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Bd(l)+a):a>Bd(t)?(l=t+1,u=a-Bd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Rf(t,e,n){var r=ww(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Fs(s,e,n)):i>Fs(t.year(),e,n)?(o=i-Fs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Fs(t,e,n){var r=ww(t,e,n),i=ww(t+1,e,n);return(Bd(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ue("w",Dt,dh);ue("ww",Dt,ni);ue("W",Dt,dh);ue("WW",Dt,ni);lg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Ge(t)});function BX(t){return Rf(t,this._week.dow,this._week.doy).week}var jX={dow:0,doy:6};function UX(){return this._week.dow}function zX(){return this._week.doy}function YX(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function GX(t){var e=Rf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ue("d",Dt);ue("e",Dt);ue("E",Dt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});lg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ne(n).invalidWeekday=t});lg(["d","e","E"],function(t,e,n,r){e[r]=Ge(t)});function KX(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function qX(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function rE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var XX="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ID="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),JX="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ZX=ag,QX=ag,e6=ag;function t6(t,e){var n=no(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?rE(n,this._week.dow):t?n[t.day()]:n}function n6(t){return t===!0?rE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function r6(t){return t===!0?rE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function i6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Zo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=an.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=an.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=an.call(this._weekdaysParse,s),i!==-1||(i=an.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=an.call(this._shortWeekdaysParse,s),i!==-1||(i=an.call(this._weekdaysParse,s),i!==-1)?i:(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=an.call(this._minWeekdaysParse,s),i!==-1||(i=an.call(this._weekdaysParse,s),i!==-1)?i:(i=an.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function o6(t,e,n){var r,i,o;if(this._weekdaysParseExact)return i6.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Zo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function s6(t){if(!this.isValid())return t!=null?this:NaN;var e=bf(this,"Day");return t!=null?(t=KX(t,this.localeData()),this.add(t-e,"d")):e}function a6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function l6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=qX(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function u6(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||iE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(rt(this,"_weekdaysRegex")||(this._weekdaysRegex=ZX),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function c6(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||iE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(rt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=QX),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function h6(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||iE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(rt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=e6),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function iE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Zo([2e3,1]).day(o),a=Ls(this.weekdaysMin(s,"")),l=Ls(this.weekdaysShort(s,"")),u=Ls(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function oE(){return this.hours()%12||12}function d6(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,oE);Ce("k",["kk",2],0,d6);Ce("hmm",0,0,function(){return""+oE.apply(this)+Go(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+oE.apply(this)+Go(this.minutes(),2)+Go(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+Go(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+Go(this.minutes(),2)+Go(this.seconds(),2)});function OD(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}OD("a",!0);OD("A",!1);function AD(t,e){return e._meridiemParse}ue("a",AD);ue("A",AD);ue("H",Dt,tE);ue("h",Dt,dh);ue("k",Dt,dh);ue("HH",Dt,ni);ue("hh",Dt,ni);ue("kk",Dt,ni);ue("hmm",CD);ue("hmmss",bD);ue("Hmm",CD);ue("Hmmss",bD);wt(["H","HH"],Mn);wt(["k","kk"],function(t,e,n){var r=Ge(t);e[Mn]=r===24?0:r});wt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});wt(["h","hh"],function(t,e,n){e[Mn]=Ge(t),Ne(n).bigHour=!0});wt("hmm",function(t,e,n){var r=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[Qi]=Ge(t.substr(r)),Ne(n).bigHour=!0});wt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[Qi]=Ge(t.substr(r,2)),e[Os]=Ge(t.substr(i)),Ne(n).bigHour=!0});wt("Hmm",function(t,e,n){var r=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[Qi]=Ge(t.substr(r))});wt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[Qi]=Ge(t.substr(r,2)),e[Os]=Ge(t.substr(i))});function f6(t){return(t+"").toLowerCase().charAt(0)==="p"}var g6=/[ap]\.?m?\.?/i,m6=fh("Hours",!0);function p6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var HD={calendar:iX,longDateFormat:lX,invalidDate:cX,ordinal:dX,dayOfMonthOrdinalParse:fX,relativeTime:mX,months:OX,monthsShort:ED,week:jX,weekdays:XX,weekdaysMin:JX,weekdaysShort:ID,meridiemParse:g6},$t={},Hh={},Ef;function w6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function kx(t){return t&&t.toLowerCase().replace("_","-")}function v6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=kx(t[e]).split("-"),n=o.length,r=kx(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Pv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&w6(o,r)>=n-1)break;n--}e++}return Ef}function y6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Pv(t){var e=null,n;if($t[t]===void 0&&typeof Zp<"u"&&Zp&&Zp.exports&&y6(t))try{e=Ef._abbr,n=require,n("./locale/"+t),Na(e)}catch{$t[t]=null}return $t[t]}function Na(t,e){var n;return t&&(Tr(e)?n=Ys(t):n=sE(t,e),n?Ef=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ef._abbr}function sE(t,e){if(e!==null){var n,r=HD;if(e.abbr=t,$t[t]!=null)pD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=$t[t]._config;else if(e.parentLocale!=null)if($t[e.parentLocale]!=null)r=$t[e.parentLocale]._config;else if(n=Pv(e.parentLocale),n!=null)r=n._config;else return Hh[e.parentLocale]||(Hh[e.parentLocale]=[]),Hh[e.parentLocale].push({name:t,config:e}),null;return $t[t]=new X0(QS(r,e)),Hh[t]&&Hh[t].forEach(function(i){sE(i.name,i.config)}),Na(t),$t[t]}else return delete $t[t],null}function C6(t,e){if(e!=null){var n,r,i=HD;$t[t]!=null&&$t[t].parentLocale!=null?$t[t].set(QS($t[t]._config,e)):(r=Pv(t),r!=null&&(i=r._config),e=QS(i,e),r==null&&(e.abbr=t),n=new X0(e),n.parentLocale=$t[t],$t[t]=n),Na(t)}else $t[t]!=null&&($t[t].parentLocale!=null?($t[t]=$t[t].parentLocale,t===Na()&&Na(t)):$t[t]!=null&&delete $t[t]);return $t[t]}function Ys(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ef;if(!no(t)){if(e=Pv(t),e)return e;t=[t]}return v6(t)}function b6(){return eR($t)}function aE(t){var e,n=t._a;return n&&Ne(t).overflow===-2&&(e=n[Is]<0||n[Is]>11?Is:n[$o]<1||n[$o]>nE(n[Xn],n[Is])?$o:n[Mn]<0||n[Mn]>24||n[Mn]===24&&(n[Qi]!==0||n[Os]!==0||n[Gl]!==0)?Mn:n[Qi]<0||n[Qi]>59?Qi:n[Os]<0||n[Os]>59?Os:n[Gl]<0||n[Gl]>999?Gl:-1,Ne(t)._overflowDayOfYear&&(e<Xn||e>$o)&&(e=$o),Ne(t)._overflowWeeks&&e===-1&&(e=TX),Ne(t)._overflowWeekday&&e===-1&&(e=MX),Ne(t).overflow=e),t}var S6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,R6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,E6=/Z|[+-]\d\d(?::?\d\d)?/,Ug=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],aC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],T6=/^\/?Date\((-?\d+)/i,M6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,_6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function ND(t){var e,n,r=t._i,i=S6.exec(r)||R6.exec(r),o,s,a,l,u=Ug.length,c=aC.length;if(i){for(Ne(t).iso=!0,e=0,n=u;e<n;e++)if(Ug[e][1].exec(i[1])){s=Ug[e][0],o=Ug[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(aC[e][1].exec(i[3])){a=(i[2]||" ")+aC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(E6.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),uE(t)}else t._isValid=!1}function P6(t,e,n,r,i,o){var s=[x6(t),ED.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function x6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function I6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function O6(t,e,n){if(t){var r=ID.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ne(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function A6(t,e,n){if(t)return _6[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function DD(t){var e=M6.exec(I6(t._i)),n;if(e){if(n=P6(e[4],e[3],e[2],e[5],e[6],e[7]),!O6(e[1],n,t))return;t._a=n,t._tzm=A6(e[8],e[9],e[10]),t._d=Sf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ne(t).rfc2822=!0}else t._isValid=!1}function H6(t){var e=T6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(ND(t),t._isValid===!1)delete t._isValid;else return;if(DD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=_i("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function wc(t,e,n){return t??e??n}function N6(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function lE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=N6(t),t._w&&t._a[$o]==null&&t._a[Is]==null&&D6(t),t._dayOfYear!=null&&(s=wc(t._a[Xn],i[Xn]),(t._dayOfYear>Bd(s)||t._dayOfYear===0)&&(Ne(t)._overflowDayOfYear=!0),n=Sf(s,0,t._dayOfYear),t._a[Is]=n.getUTCMonth(),t._a[$o]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Mn]===24&&t._a[Qi]===0&&t._a[Os]===0&&t._a[Gl]===0&&(t._nextDay=!0,t._a[Mn]=0),t._d=(t._useUTC?Sf:WX).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Mn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ne(t).weekdayMismatch=!0)}}function D6(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=wc(e.GG,t._a[Xn],Rf(Nt(),1,4).year),r=wc(e.W,1),i=wc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Rf(Nt(),o,s),n=wc(e.gg,t._a[Xn],u.year),r=wc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Fs(n,o,s)?Ne(t)._overflowWeeks=!0:l!=null?Ne(t)._overflowWeekday=!0:(a=xD(n,r,i,o,s),t._a[Xn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function uE(t){if(t._f===Z.ISO_8601){ND(t);return}if(t._f===Z.RFC_2822){DD(t);return}t._a=[],Ne(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=wD(t._f,t._locale).match(J0)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(SX(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ne(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),kc[o]?(r?Ne(t).empty=!1:Ne(t).unusedTokens.push(o),EX(o,r,t)):t._strict&&!r&&Ne(t).unusedTokens.push(o);Ne(t).charsLeftOver=a-l,e.length>0&&Ne(t).unusedInput.push(e),t._a[Mn]<=12&&Ne(t).bigHour===!0&&t._a[Mn]>0&&(Ne(t).bigHour=void 0),Ne(t).parsedDateParts=t._a.slice(0),Ne(t).meridiem=t._meridiem,t._a[Mn]=k6(t._locale,t._a[Mn],t._meridiem),u=Ne(t).era,u!==null&&(t._a[Xn]=t._locale.erasConvertYear(u,t._a[Xn])),lE(t),aE(t)}function k6(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function $6(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ne(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=q0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],uE(e),K0(e)&&(s=!0),o+=Ne(e).charsLeftOver,o+=Ne(e).unusedTokens.length*10,Ne(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));_a(t,n||e)}function L6(t){if(!t._d){var e=Z0(t._i),n=e.day===void 0?e.date:e.day;t._a=gD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),lE(t)}}function F6(t){var e=new sg(aE(kD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function kD(t){var e=t._i,n=t._f;return t._locale=t._locale||Ys(t._l),e===null||n===void 0&&e===""?bv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ro(e)?new sg(aE(e)):(og(e)?t._d=e:no(n)?$6(t):n?uE(t):V6(t),K0(t)||(t._d=null),t))}function V6(t){var e=t._i;Tr(e)?t._d=new Date(Z.now()):og(e)?t._d=new Date(e.valueOf()):typeof e=="string"?H6(t):no(e)?(t._a=gD(e.slice(0),function(n){return parseInt(n,10)}),lE(t)):tu(e)?L6(t):Vs(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function $D(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(tu(t)&&G0(t)||no(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,F6(o)}function Nt(t,e,n,r){return $D(t,e,n,r,!1)}var W6=_i("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Nt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:bv()}),B6=_i("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Nt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:bv()});function LD(t,e){var n,r;if(e.length===1&&no(e[0])&&(e=e[0]),!e.length)return Nt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function j6(){var t=[].slice.call(arguments,0);return LD("isBefore",t)}function U6(){var t=[].slice.call(arguments,0);return LD("isAfter",t)}var z6=function(){return Date.now?Date.now():+new Date},Nh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Y6(t){var e,n=!1,r,i=Nh.length;for(e in t)if(rt(t,e)&&!(an.call(Nh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Nh[r]]){if(n)return!1;parseFloat(t[Nh[r]])!==Ge(t[Nh[r]])&&(n=!0)}return!0}function G6(){return this._isValid}function K6(){return so(NaN)}function xv(t){var e=Z0(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Y6(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Ys(),this._bubble()}function Ip(t){return t instanceof xv}function nR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function q6(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Ge(t[s])!==Ge(e[s])&&o++;return o+i}function FD(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Go(~~(n/60),2)+e+Go(~~n%60,2)})}FD("Z",":");FD("ZZ","");ue("Z",Mv);ue("ZZ",Mv);wt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=cE(Mv,t)});var X6=/([\+\-]|\d\d)/gi;function cE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(X6)||["-",0,0],o=+(i[1]*60)+Ge(i[2]),o===0?0:i[0]==="+"?o:-o)}function hE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ro(t)||og(t)?t.valueOf():Nt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Nt(t).local()}function rR(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function J6(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=cE(Mv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=rR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?BD(this,so(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:rR(this)}function Z6(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Q6(t){return this.utcOffset(0,t)}function e7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(rR(this),"m")),this}function t7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=cE(CX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function n7(t){return this.isValid()?(t=t?Nt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function r7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function i7(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return q0(t,this),t=kD(t),t._a?(e=t._isUTC?Zo(t._a):Nt(t._a),this._isDSTShifted=this.isValid()&&q6(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function o7(){return this.isValid()?!this._isUTC:!1}function s7(){return this.isValid()?this._isUTC:!1}function VD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var a7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,l7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function so(t,e){var n=t,r=null,i,o,s;return Ip(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Vs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=a7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Ge(r[$o])*i,h:Ge(r[Mn])*i,m:Ge(r[Qi])*i,s:Ge(r[Os])*i,ms:Ge(nR(r[Gl]*1e3))*i}):(r=l7.exec(t))?(i=r[1]==="-"?-1:1,n={y:el(r[2],i),M:el(r[3],i),w:el(r[4],i),d:el(r[5],i),h:el(r[6],i),m:el(r[7],i),s:el(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=u7(Nt(n.from),Nt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new xv(n),Ip(t)&&rt(t,"_locale")&&(o._locale=t._locale),Ip(t)&&rt(t,"_isValid")&&(o._isValid=t._isValid),o}so.fn=xv.prototype;so.invalid=K6;function el(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function $x(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function u7(t,e){var n;return t.isValid()&&e.isValid()?(e=hE(e,t),t.isBefore(e)?n=$x(t,e):(n=$x(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function WD(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(pD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=so(n,r),BD(this,i,t),this}}function BD(t,e,n,r){var i=e._milliseconds,o=nR(e._days),s=nR(e._months);t.isValid()&&(r=r??!0,s&&MD(t,bf(t,"Month")+s*n),o&&RD(t,"Date",bf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var c7=WD(1,"add"),h7=WD(-1,"subtract");function jD(t){return typeof t=="string"||t instanceof String}function d7(t){return ro(t)||og(t)||jD(t)||Vs(t)||g7(t)||f7(t)||t===null||t===void 0}function f7(t){var e=tu(t)&&!G0(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||rt(t,o);return e&&n}function g7(t){var e=no(t),n=!1;return e&&(n=t.filter(function(r){return!Vs(r)&&jD(t)}).length===0),e&&n}function m7(t){var e=tu(t)&&!G0(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||rt(t,o);return e&&n}function p7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function w7(t,e){arguments.length===1&&(arguments[0]?d7(arguments[0])?(t=arguments[0],e=void 0):m7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Nt(),r=hE(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(Qo(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Nt(n)))}function v7(){return new sg(this)}function y7(t,e){var n=ro(t)?t:Nt(t);return this.isValid()&&n.isValid()?(e=Pi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function C7(t,e){var n=ro(t)?t:Nt(t);return this.isValid()&&n.isValid()?(e=Pi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function b7(t,e,n,r){var i=ro(t)?t:Nt(t),o=ro(e)?e:Nt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function S7(t,e){var n=ro(t)?t:Nt(t),r;return this.isValid()&&n.isValid()?(e=Pi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function R7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function E7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function T7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=hE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Pi(e),e){case"year":o=Op(this,r)/12;break;case"month":o=Op(this,r);break;case"quarter":o=Op(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:wi(o)}function Op(t,e){if(t.date()<e.date())return-Op(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function M7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function _7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?xp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Qo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",xp(n,"Z")):xp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function P7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function x7(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=xp(this,t);return this.localeData().postformat(e)}function I7(t,e){return this.isValid()&&(ro(t)&&t.isValid()||Nt(t).isValid())?so({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function O7(t){return this.from(Nt(),t)}function A7(t,e){return this.isValid()&&(ro(t)&&t.isValid()||Nt(t).isValid())?so({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function H7(t){return this.to(Nt(),t)}function UD(t){var e;return t===void 0?this._locale._abbr:(e=Ys(t),e!=null&&(this._locale=e),this)}var zD=_i("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function YD(){return this._locale}var vw=1e3,$c=60*vw,yw=60*$c,GD=(365*400+97)*24*yw;function Lc(t,e){return(t%e+e)%e}function KD(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-GD:new Date(t,e,n).valueOf()}function qD(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-GD:Date.UTC(t,e,n)}function N7(t){var e,n;if(t=Pi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?qD:KD,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Lc(e+(this._isUTC?0:this.utcOffset()*$c),yw);break;case"minute":e=this._d.valueOf(),e-=Lc(e,$c);break;case"second":e=this._d.valueOf(),e-=Lc(e,vw);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function D7(t){var e,n;if(t=Pi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?qD:KD,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=yw-Lc(e+(this._isUTC?0:this.utcOffset()*$c),yw)-1;break;case"minute":e=this._d.valueOf(),e+=$c-Lc(e,$c)-1;break;case"second":e=this._d.valueOf(),e+=vw-Lc(e,vw)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function k7(){return this._d.valueOf()-(this._offset||0)*6e4}function $7(){return Math.floor(this.valueOf()/1e3)}function L7(){return new Date(this.valueOf())}function F7(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function V7(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function W7(){return this.isValid()?this.toISOString():null}function B7(){return K0(this)}function j7(){return _a({},Ne(this))}function U7(){return Ne(this).overflow}function z7(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ue("N",dE);ue("NN",dE);ue("NNN",dE);ue("NNNN",n9);ue("NNNNN",r9);wt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ne(n).era=i:Ne(n).invalidEra=t});ue("y",hh);ue("yy",hh);ue("yyy",hh);ue("yyyy",hh);ue("yo",i9);wt(["y","yy","yyy","yyyy"],Xn);wt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Xn]=n._locale.eraYearOrdinalParse(t,i):e[Xn]=parseInt(t,10)});function Y7(t,e){var n,r,i,o=this._eras||Ys("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function G7(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function K7(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function q7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function X7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function J7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function Z7(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function Q7(t){return rt(this,"_erasNameRegex")||fE.call(this),t?this._erasNameRegex:this._erasRegex}function e9(t){return rt(this,"_erasAbbrRegex")||fE.call(this),t?this._erasAbbrRegex:this._erasRegex}function t9(t){return rt(this,"_erasNarrowRegex")||fE.call(this),t?this._erasNarrowRegex:this._erasRegex}function dE(t,e){return e.erasAbbrRegex(t)}function n9(t,e){return e.erasNameRegex(t)}function r9(t,e){return e.erasNarrowRegex(t)}function i9(t,e){return e._eraYearOrdinalRegex||hh}function fE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Ls(u[i].name),a=Ls(u[i].abbr),l=Ls(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Iv(t,e){Ce(0,[t,t.length],0,e)}Iv("gggg","weekYear");Iv("ggggg","weekYear");Iv("GGGG","isoWeekYear");Iv("GGGGG","isoWeekYear");ue("G",Tv);ue("g",Tv);ue("GG",Dt,ni);ue("gg",Dt,ni);ue("GGGG",eE,Q0);ue("gggg",eE,Q0);ue("GGGGG",Ev,Sv);ue("ggggg",Ev,Sv);lg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Ge(t)});lg(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function o9(t){return XD.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function s9(t){return XD.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function a9(){return Fs(this.year(),1,4)}function l9(){return Fs(this.isoWeekYear(),1,4)}function u9(){var t=this.localeData()._week;return Fs(this.year(),t.dow,t.doy)}function c9(){var t=this.localeData()._week;return Fs(this.weekYear(),t.dow,t.doy)}function XD(t,e,n,r,i){var o;return t==null?Rf(this,r,i).year:(o=Fs(t,r,i),e>o&&(e=o),h9.call(this,t,e,n,r,i))}function h9(t,e,n,r,i){var o=xD(t,e,n,r,i),s=Sf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ue("Q",vD);wt("Q",function(t,e){e[Is]=(Ge(t)-1)*3});function d9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ue("D",Dt,dh);ue("DD",Dt,ni);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});wt(["D","DD"],$o);wt("Do",function(t,e){e[$o]=Ge(t.match(Dt)[0])});var JD=fh("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Rv);ue("DDDD",yD);wt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ge(t)});function f9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ue("m",Dt,tE);ue("mm",Dt,ni);wt(["m","mm"],Qi);var g9=fh("Minutes",!1);Ce("s",["ss",2],0,"second");ue("s",Dt,tE);ue("ss",Dt,ni);wt(["s","ss"],Os);var m9=fh("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Rv,vD);ue("SS",Rv,ni);ue("SSS",Rv,yD);var Pa,ZD;for(Pa="SSSS";Pa.length<=9;Pa+="S")ue(Pa,hh);function p9(t,e){e[Gl]=Ge(("0."+t)*1e3)}for(Pa="S";Pa.length<=9;Pa+="S")wt(Pa,p9);ZD=fh("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function w9(){return this._isUTC?"UTC":""}function v9(){return this._isUTC?"Coordinated Universal Time":""}var ee=sg.prototype;ee.add=c7;ee.calendar=w7;ee.clone=v7;ee.diff=T7;ee.endOf=D7;ee.format=x7;ee.from=I7;ee.fromNow=O7;ee.to=A7;ee.toNow=H7;ee.get=PX;ee.invalidAt=U7;ee.isAfter=y7;ee.isBefore=C7;ee.isBetween=b7;ee.isSame=S7;ee.isSameOrAfter=R7;ee.isSameOrBefore=E7;ee.isValid=B7;ee.lang=zD;ee.locale=UD;ee.localeData=YD;ee.max=B6;ee.min=W6;ee.parsingFlags=j7;ee.set=xX;ee.startOf=N7;ee.subtract=h7;ee.toArray=F7;ee.toObject=V7;ee.toDate=L7;ee.toISOString=_7;ee.inspect=P7;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=W7;ee.toString=M7;ee.unix=$7;ee.valueOf=k7;ee.creationData=z7;ee.eraName=q7;ee.eraNarrow=X7;ee.eraAbbr=J7;ee.eraYear=Z7;ee.year=SD;ee.isLeapYear=_X;ee.weekYear=o9;ee.isoWeekYear=s9;ee.quarter=ee.quarters=d9;ee.month=_D;ee.daysInMonth=LX;ee.week=ee.weeks=YX;ee.isoWeek=ee.isoWeeks=GX;ee.weeksInYear=u9;ee.weeksInWeekYear=c9;ee.isoWeeksInYear=a9;ee.isoWeeksInISOWeekYear=l9;ee.date=JD;ee.day=ee.days=s6;ee.weekday=a6;ee.isoWeekday=l6;ee.dayOfYear=f9;ee.hour=ee.hours=m6;ee.minute=ee.minutes=g9;ee.second=ee.seconds=m9;ee.millisecond=ee.milliseconds=ZD;ee.utcOffset=J6;ee.utc=Q6;ee.local=e7;ee.parseZone=t7;ee.hasAlignedHourOffset=n7;ee.isDST=r7;ee.isLocal=o7;ee.isUtcOffset=s7;ee.isUtc=VD;ee.isUTC=VD;ee.zoneAbbr=w9;ee.zoneName=v9;ee.dates=_i("dates accessor is deprecated. Use date instead.",JD);ee.months=_i("months accessor is deprecated. Use month instead",_D);ee.years=_i("years accessor is deprecated. Use year instead",SD);ee.zone=_i("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Z6);ee.isDSTShifted=_i("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",i7);function y9(t){return Nt(t*1e3)}function C9(){return Nt.apply(null,arguments).parseZone()}function QD(t){return t}var it=X0.prototype;it.calendar=oX;it.longDateFormat=uX;it.invalidDate=hX;it.ordinal=gX;it.preparse=QD;it.postformat=QD;it.relativeTime=pX;it.pastFuture=wX;it.set=rX;it.eras=Y7;it.erasParse=G7;it.erasConvertYear=K7;it.erasAbbrRegex=e9;it.erasNameRegex=Q7;it.erasNarrowRegex=t9;it.months=NX;it.monthsShort=DX;it.monthsParse=$X;it.monthsRegex=VX;it.monthsShortRegex=FX;it.week=BX;it.firstDayOfYear=zX;it.firstDayOfWeek=UX;it.weekdays=t6;it.weekdaysMin=r6;it.weekdaysShort=n6;it.weekdaysParse=o6;it.weekdaysRegex=u6;it.weekdaysShortRegex=c6;it.weekdaysMinRegex=h6;it.isPM=f6;it.meridiem=p6;function Cw(t,e,n,r){var i=Ys(),o=Zo().set(r,e);return i[n](o,t)}function ek(t,e,n){if(Vs(t)&&(e=t,t=void 0),t=t||"",e!=null)return Cw(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Cw(t,r,n,"month");return i}function gE(t,e,n,r){typeof t=="boolean"?(Vs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Vs(e)&&(n=e,e=void 0),e=e||"");var i=Ys(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Cw(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Cw(e,(s+o)%7,r,"day");return a}function b9(t,e){return ek(t,e,"months")}function S9(t,e){return ek(t,e,"monthsShort")}function R9(t,e,n){return gE(t,e,n,"weekdays")}function E9(t,e,n){return gE(t,e,n,"weekdaysShort")}function T9(t,e,n){return gE(t,e,n,"weekdaysMin")}Na("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ge(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=_i("moment.lang is deprecated. Use moment.locale instead.",Na);Z.langData=_i("moment.langData is deprecated. Use moment.localeData instead.",Ys);var is=Math.abs;function M9(){var t=this._data;return this._milliseconds=is(this._milliseconds),this._days=is(this._days),this._months=is(this._months),t.milliseconds=is(t.milliseconds),t.seconds=is(t.seconds),t.minutes=is(t.minutes),t.hours=is(t.hours),t.months=is(t.months),t.years=is(t.years),this}function tk(t,e,n,r){var i=so(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function _9(t,e){return tk(this,t,e,1)}function P9(t,e){return tk(this,t,e,-1)}function Lx(t){return t<0?Math.floor(t):Math.ceil(t)}function x9(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=Lx(iR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=wi(t/1e3),r.seconds=i%60,o=wi(i/60),r.minutes=o%60,s=wi(o/60),r.hours=s%24,e+=wi(s/24),l=wi(nk(e)),n+=l,e-=Lx(iR(l)),a=wi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function nk(t){return t*4800/146097}function iR(t){return t*146097/4800}function I9(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Pi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+nk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(iR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Gs(t){return function(){return this.as(t)}}var rk=Gs("ms"),O9=Gs("s"),A9=Gs("m"),H9=Gs("h"),N9=Gs("d"),D9=Gs("w"),k9=Gs("M"),$9=Gs("Q"),L9=Gs("y"),F9=rk;function V9(){return so(this)}function W9(t){return t=Pi(t),this.isValid()?this[t+"s"]():NaN}function Ru(t){return function(){return this.isValid()?this._data[t]:NaN}}var B9=Ru("milliseconds"),j9=Ru("seconds"),U9=Ru("minutes"),z9=Ru("hours"),Y9=Ru("days"),G9=Ru("months"),K9=Ru("years");function q9(){return wi(this.days()/7)}var Rs=Math.round,_c={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function X9(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function J9(t,e,n,r){var i=so(t).abs(),o=Rs(i.as("s")),s=Rs(i.as("m")),a=Rs(i.as("h")),l=Rs(i.as("d")),u=Rs(i.as("M")),c=Rs(i.as("w")),h=Rs(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,X9.apply(null,d)}function Z9(t){return t===void 0?Rs:typeof t=="function"?(Rs=t,!0):!1}function Q9(t,e){return _c[t]===void 0?!1:e===void 0?_c[t]:(_c[t]=e,t==="s"&&(_c.ss=e-1),!0)}function e8(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=_c,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},_c,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=J9(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var lC=Math.abs;function Au(t){return(t>0)-(t<0)||+t}function Ov(){if(!this.isValid())return this.localeData().invalidDate();var t=lC(this._milliseconds)/1e3,e=lC(this._days),n=lC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=wi(t/60),i=wi(r/60),t%=60,r%=60,o=wi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Au(this._months)!==Au(a)?"-":"",c=Au(this._days)!==Au(a)?"-":"",h=Au(this._milliseconds)!==Au(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ze=xv.prototype;Ze.isValid=G6;Ze.abs=M9;Ze.add=_9;Ze.subtract=P9;Ze.as=I9;Ze.asMilliseconds=rk;Ze.asSeconds=O9;Ze.asMinutes=A9;Ze.asHours=H9;Ze.asDays=N9;Ze.asWeeks=D9;Ze.asMonths=k9;Ze.asQuarters=$9;Ze.asYears=L9;Ze.valueOf=F9;Ze._bubble=x9;Ze.clone=V9;Ze.get=W9;Ze.milliseconds=B9;Ze.seconds=j9;Ze.minutes=U9;Ze.hours=z9;Ze.days=Y9;Ze.weeks=q9;Ze.months=G9;Ze.years=K9;Ze.humanize=e8;Ze.toISOString=Ov;Ze.toString=Ov;Ze.toJSON=Ov;Ze.locale=UD;Ze.localeData=YD;Ze.toIsoString=_i("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ov);Ze.lang=zD;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ue("x",Tv);ue("X",bX);wt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});wt("x",function(t,e,n){n._d=new Date(Ge(t))});//! moment.js
Z.version="2.30.1";tX(Nt);Z.fn=ee;Z.min=j6;Z.max=U6;Z.now=z6;Z.utc=Zo;Z.unix=y9;Z.months=b9;Z.isDate=og;Z.locale=Na;Z.invalid=bv;Z.duration=so;Z.isMoment=ro;Z.weekdays=R9;Z.parseZone=C9;Z.localeData=Ys;Z.isDuration=Ip;Z.monthsShort=S9;Z.weekdaysMin=T9;Z.defineLocale=sE;Z.updateLocale=C6;Z.locales=b6;Z.weekdaysShort=E9;Z.normalizeUnits=Pi;Z.relativeTimeRounding=Z9;Z.relativeTimeThreshold=Q9;Z.calendarFormat=p7;Z.prototype=ee;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function ik(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function oR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function jd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Sn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Va(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function M(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function ok(t){return Sn(t,(e,n)=>e+n,0)}function t8(t){return Sn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function n8(t){return Sn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function r8(t){return t.length?ok(t)/t.length:0}function sk(t){return Sn(t,(e,n)=>e.concat(Array.isArray(n)?sk(n):n),[])}function ak(t){const e=[];return M(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function sR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return M(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function i8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return M(i,s=>{o=o.filter(a=>s.includes(a))}),o}function o8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return M(i,s=>{M(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function aR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const s8=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:r8,arrayEach:M,arrayFilter:Va,arrayFlatten:sk,arrayMap:Ue,arrayMax:t8,arrayMin:n8,arrayReduce:Sn,arraySum:ok,arrayUnique:ak,extendArray:oR,getDifferenceOfArrays:sR,getIntersectionOfArrays:i8,getUnionOfArrays:o8,pivot:jd,stringToArray:aR,to2dArray:ik},Symbol.toStringTag,{value:"Module"}));function ct(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Sn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Et(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Ht(t){return typeof t>"u"}function Gt(t){return t===null||t===""||Ht(t)}function lk(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Hd="length",Ud=t=>parseInt(t,16),Fx=t=>parseInt(t,10),bw=(t,e,n)=>t.substr(e,n),zd=t=>t.codePointAt(0)-65,lR=t=>`${t}`.replace(/\-/g,""),a8=t=>Ud(bw(lR(t),Ud("12"),zd("F")))/(Ud(bw(lR(t),zd("B"),~~![][Hd]))||9),l8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Vx=!1;const Wx={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Bx={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function uk(t,e){const n=!Gt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=lR(t||"");const l=u8(t);if(n||r||l)if(l){const u=Z("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=a8(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(l8()&&(s="valid",a="valid"),!Vx&&s!=="valid"&&(Wx[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Wx[s]({keyValidityDate:o,hotVersion:i})),Vx=!0),a!=="valid"&&e.parentNode&&Bx[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=Bx[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function u8(t){let e=[][Hd],n=e;if(t[Hd]!==zd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=zd(i.shift());o;o=zd(i.shift()||"A"))--o<""[Hd]?n=n|(Fx(`${Fx(Ud(r)+(Ud(bw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=bw(t,o,o?i[Hd]===1?9:8:6);return n===e}const c8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:uk,isDefined:le,isEmpty:Gt,isRegExp:lk,isUndefined:Ht,stringify:Et},Symbol.toStringTag,{value:"Module"}));function Zn(t){return t[0].toUpperCase()+t.substr(1)}function h8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Et(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function mE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function pE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function wE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function uR(t){return Av(`${t}`,{ALLOWED_TAGS:[]})}function Av(t,e){return eX.sanitize(t,e)}const d8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:h8,isPercentValue:pE,randomString:mE,sanitize:Av,stripTags:uR,substitute:wE,toUpperCaseFirst:Zn},Symbol.toStringTag,{value:"Module"})),Eu=t=>["tabindex",t],f8=()=>["role","treegrid"],As=()=>["role","presentation"],g8=()=>["role","gridcell"],m8=()=>["role","rowheader"],ck=()=>["role","rowgroup"],p8=()=>["role","columnheader"],cR=()=>["role","row"],w8=()=>["role","menu"],v8=()=>["role","menuitem"],y8=()=>["role","menuitemcheckbox"],C8=()=>["role","combobox"],hk=()=>["role","listbox"],b8=()=>["role","option"],S8=()=>["role","checkbox"],R8=()=>["scope","col"],E8=()=>["scope","row"],T8=()=>["type","text"],Tf=t=>["aria-label",t],Tu=()=>["aria-hidden","true"],M8=()=>["aria-disabled","true"],_8=()=>["aria-multiselectable","true"],dk=t=>["aria-haspopup",t],fk=t=>["aria-rowcount",t],Hv=t=>["aria-colcount",t],gk=t=>["aria-rowindex",t],vE=t=>["aria-colindex",t],Ci=t=>["aria-expanded",t],P8=t=>["aria-sort",t],jx=()=>["aria-readonly","true"],Ux=()=>["aria-invalid","true"],mk=t=>["aria-checked",t],yE=()=>["aria-selected","true"],x8=()=>["aria-autocomplete","list"],I8=t=>["aria-controls",t],O8=t=>["aria-activedescendant",t],A8=t=>["aria-live",t],H8=t=>["aria-relevant",t],N8=t=>["aria-setsize",t],D8=t=>["aria-posinset",t];function pk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Yd(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function wk(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function au(t){return wk(t)&&t.parent}function k8(t){return!!Object.getPrototypeOf(t.parent)}function Wa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Nd(t,e,n){const r=[];let i=t;for(;i&&(i=Wa(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function vk(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Da(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function yk(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function fa(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Ck(t){return!t||!t.length?[]:t.filter(e=>!!e)}function bk(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=Ck(e),e.length>0&&t.classList.add(...e)}function we(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=bk(e,!0);n=Ck(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function be(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Mu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=bk(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function CE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)CE(e[n])}}function Ko(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Sk=/(<(.*)>|&(.*);)/;function _u(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Sk.test(e)?t.innerHTML=n?Av(e):e:Ba(t,e)}function Ba(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Ko(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function lu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return lu(r.host.impl);if(r.host)return lu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function Rk(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Ln(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function bE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Nv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Dv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?bE(e):t.scrollTop}function SE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Nv(e):t.scrollLeft}function Mf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Ek(t){return t.scrollHeight-t.clientHeight}function Tk(t){return t.scrollWidth-t.clientWidth}function qc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function _f(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function $8(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function en(t){return t.offsetWidth}function un(t){return t.offsetHeight}function Fc(t){return t.clientHeight||t.innerHeight}function RE(t){return t.clientWidth||t.innerWidth}function L8(t,e,n){t.addEventListener(e,n,!1)}function F8(t,e,n){t.removeEventListener(e,n,!1)}function EE(t){return t.selectionStart?t.selectionStart:0}function Mk(t){return t.selectionEnd?t.selectionEnd:0}function V8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function hR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function ug(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let uC;function W8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function _n(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return uC===void 0&&(uC=W8(t)),uC}function TE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function ME(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function kv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function B8(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function cg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Gd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function $v(t){return Gd(t)&&t.hasAttribute("data-hot-input")===!1}function j8(t){const e=t.ownerDocument.activeElement;$v(e)||t.select()}function _E(t){return!t.parentNode}function _k(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function PE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();be(t,"contenteditable",!0),n&&be(t,...Tu()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function xE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&we(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function Pk(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;PE(t,n),e(),xE(t,n)}function Uo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const U8=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Sk,addClass:q,addEvent:L8,clearTextSelection:hR,closest:Wa,closestDown:Nd,empty:Ko,fastInnerHTML:_u,fastInnerText:Ba,findFirstParentWithClass:vk,getCaretPosition:EE,getCssTransform:B8,getFrameElement:wk,getMaximumScrollLeft:Tk,getMaximumScrollTop:Ek,getParent:pk,getParentWindow:au,getScrollLeft:SE,getScrollTop:Dv,getScrollableElement:Mf,getScrollbarWidth:_n,getSelectionEndPosition:Mk,getSelectionText:V8,getStyle:_f,getTrimmingContainer:qc,getWindowScrollLeft:Nv,getWindowScrollTop:bE,hasAccessToParentWindow:k8,hasClass:ve,hasHorizontalScrollbar:ME,hasVerticalScrollbar:TE,hasZeroHeight:Rk,index:yk,innerHeight:Fc,innerWidth:RE,isChildOf:Da,isDetached:_E,isHTMLElement:Uo,isInput:Gd,isInternalElement:Yd,isOutsideInput:$v,isVisible:lu,makeElementContentEditableAndSelectItsContent:PE,matchesCSSRules:$8,observeVisibilityChangeOnce:_k,offset:Ln,outerHeight:un,outerWidth:en,overlayContainsElement:fa,removeAttribute:Mu,removeClass:we,removeContentEditableFromElementAndDeselect:xE,removeEvent:F8,removeTextNodes:CE,resetCssTransform:cg,runWithSelectedContendEditableElement:Pk,selectElementIfAllowed:j8,setAttribute:be,setCaretPosition:ug,setOverlayPosition:kv},Symbol.toStringTag,{value:"Module"}));function lt(t){return typeof t=="function"}function xk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function z8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=xk(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function hg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function Y8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Sn(i,(u,c)=>c(u),r.apply(this,a))}}function IE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function Ik(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function G8(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Sw(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const K8=Object.freeze(Object.defineProperty({__proto__:null,curry:Ik,curryRight:G8,debounce:hg,fastCall:Sw,isFunction:lt,partial:IE,pipe:Y8,throttle:xk,throttleAfterHits:z8},Symbol.toStringTag,{value:"Module"}));var q8=dn,zx=bN,X8=Cn,Yx=wu,J8=Cv,Gx=q8([].push),Z8=function(t){if(X8(t))return t;if(zx(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?Gx(n,i):(typeof i=="number"||Yx(i)==="Number"||Yx(i)==="String")&&Gx(n,J8(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(zx(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},Q8=Ct,Ok=sh,Ak=ng,eJ=yn,dg=dn,Hk=Nn,Kx=Cn,qx=P0,Nk=z0,tJ=Z8,nJ=_0,rJ=String,ka=Ok("JSON","stringify"),zg=dg(/./.exec),Xx=dg("".charAt),iJ=dg("".charCodeAt),oJ=dg("".replace),sJ=dg(1 .toString),aJ=/[\uD800-\uDFFF]/g,Jx=/^[\uD800-\uDBFF]$/,Zx=/^[\uDC00-\uDFFF]$/,Qx=!nJ||Hk(function(){var t=Ok("Symbol")("stringify detection");return ka([t])!=="[null]"||ka({a:t})!=="{}"||ka(Object(t))!=="{}"}),eI=Hk(function(){return ka("\uDF06\uD834")!=='"\\udf06\\ud834"'||ka("\uDEAD")!=='"\\udead"'}),lJ=function(t,e){var n=Nk(arguments),r=tJ(e);if(!(!Kx(r)&&(t===void 0||qx(t))))return n[1]=function(i,o){if(Kx(r)&&(o=eJ(r,this,rJ(i),o)),!qx(o))return o},Ak(ka,null,n)},uJ=function(t,e,n){var r=Xx(n,e-1),i=Xx(n,e+1);return zg(Jx,t)&&!zg(Zx,i)||zg(Zx,t)&&!zg(Jx,r)?"\\u"+sJ(iJ(t,0),16):t};ka&&Q8({target:"JSON",stat:!0,arity:3,forced:Qx||eI},{stringify:function(e,n,r){var i=Nk(arguments),o=Ak(Qx?lJ:ka,null,i);return eI&&typeof o=="string"?oJ(o,aJ,uJ):o}});function Xc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ke(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Xc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Xc(n[0])]:e[r]=[]:e[r]=null)})),e}function Dk(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function cn(t,e,n){const r=Array.isArray(n);return ke(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function fg(t,e){ke(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),fg(t[r],e[r])):t[r]=e[r]})}function Qn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function io(t){const e={};return ke(t,(n,r)=>{e[r]=n}),e}function gt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return M(n,i=>{t.MIXINS.push(i.MIXIN_NAME),ke(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let v=g;return(Array.isArray(v)||De(v))&&(v=Qn(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Lv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function De(t){return Object.prototype.toString.call(t)==="[object Object]"}function es(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function ke(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function kk(t,e){const n=e.split(".");let r=t;return ke(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Ap(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(ln(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function Fv(t){if(!De(t))return 0;const e=function(n){let r=0;return De(n)?ke(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function ln(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const cJ=Object.freeze(Object.defineProperty({__proto__:null,clone:io,createObjectPropListener:Hr,deepClone:Qn,deepExtend:fg,deepObjectSize:Fv,defineGetter:es,duckSchema:Xc,extend:cn,getProperty:kk,hasOwnProperty:ln,inherit:Dk,isObject:De,isObjectEqual:Lv,mixin:gt,objectEach:ke,setProperty:Ap},Symbol.toStringTag,{value:"Module"}));function Pf(t){return window.requestAnimationFrame(t)}function xf(t){window.cancelAnimationFrame(t)}function OE(){return"ontouchstart"in window}function $k(){return typeof window<"u"}let Hu;function Lk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Hu||(typeof Intl=="object"?Hu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Hu=(n,r)=>`${n}`.localeCompare(r):Hu=(n,r)=>n===r?0:n>r?-1:1,Hu)}const hJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:xf,getComparisonFunction:Lk,isCSR:$k,isTouchSupported:OE,requestAnimationFrame:Pf},Symbol.toStringTag,{value:"Module"})),di=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Ks={chrome:di((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:di(t=>/CriOS/.test(t)),edge:di(t=>/Edge/.test(t)),edgeWebKit:di(t=>/EdgiOS/.test(t)),firefox:di(t=>/Firefox/.test(t)),firefoxWebKit:di(t=>/FxiOS/.test(t)),mobile:di(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:di((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},gh={mac:di(t=>/^Mac/.test(t)),win:di(t=>/^Win/.test(t)),linux:di(t=>/^Linux/.test(t)),ios:di(t=>/iPhone|iPad|iPod/i.test(t))};function Fk(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(Ks,n=>{let{test:r}=n;return void r(t,e)})}function Vk(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(gh,e=>{let{test:n}=e;return void n(t)})}$k()&&(Fk(),Vk());function AE(){return Ks.chrome.value}function Wk(){return Ks.chromeWebKit.value}function Hp(){return Ks.firefox.value}function Bk(){return Ks.firefoxWebKit.value}function If(){return Ks.safari.value}function jk(){return Ks.edge.value}function dJ(){return Ks.edgeWebKit.value}function Bo(){return Ks.mobile.value}function HE(){return gh.ios.value}function NE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&gh.mac.value}function dR(){return gh.win.value}function Rw(){return gh.mac.value}function fJ(){return gh.linux.value}const gJ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:AE,isChromeWebKit:Wk,isEdge:jk,isEdgeWebKit:dJ,isFirefox:Hp,isFirefoxWebKit:Bk,isIOS:HE,isIpadOS:NE,isLinuxOS:fJ,isMacOS:Rw,isMobileBrowser:Bo,isSafari:If,isWindowsOS:dR,setBrowserMeta:Fk,setPlatformMeta:Vk},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Hp()?182:174,AUDIO_MUTE:Hp()?181:173,AUDIO_UP:Hp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},mJ=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function Uk(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function DE(t){return mJ.includes(t)}function pJ(t){const e=[];return Rw()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function zk(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function mh(t,e){const n=e.split("|");let r=!1;return M(n,i=>{if(t===de[i])return r=!0,!1}),r}const wJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:pJ,isCtrlMetaKey:zk,isFunctionKey:DE,isKey:mh,isPrintableChar:Uk},Symbol.toStringTag,{value:"Module"}));function xi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ba(t){return t.isImmediatePropagationEnabled===!1}function ja(t){return t.button===2}function Vv(t){return t.button===0}function Yk(t){return t instanceof TouchEvent}function Gk(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!Uo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const vJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ba,isLeftClick:Vv,isRightClick:ja,isTouchEvent:Yk,offsetRelativeTo:Gk,stopImmediatePropagation:xi},Symbol.toStringTag,{value:"Module"}));function tt(){le(console)&&console.warn(...arguments)}function kE(){le(console)&&console.error(...arguments)}const Ul=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],cC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),hC=new Map([[]]);var yJ=uh,CJ=function(t,e,n){for(var r=0,i=arguments.length>2?n:yJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},bJ=vn,SJ=function(t,e){var n=bJ[t],r=n&&n.prototype;return r&&r[e]},RJ=oo,EJ=VN,TJ=zs.f,fR=RJ("unscopables"),gR=Array.prototype;gR[fR]===void 0&&TJ(gR,fR,{configurable:!0,value:EJ(null)});var Wv=function(t){gR[fR][t]=!0},MJ=Ct,_J=dn,PJ=Dr,xJ=Jf,IJ=CJ,OJ=SJ,AJ=Wv,HJ=Array,NJ=_J(OJ("Array","sort"));MJ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&PJ(e);var n=xJ(this),r=IJ(HJ,n);return NJ(r,e)}});AJ("toSorted");var DJ=Ct,kJ=yn,$J=ch,LJ=Dr,FJ=bn,VJ=Jo,WJ=ti,BJ=Ga,dC=BJ("find",TypeError);DJ({target:"Iterator",proto:!0,real:!0,forced:dC},{find:function(e){FJ(this);try{LJ(e)}catch(i){WJ(this,"throw",i)}if(dC)return kJ(dC,this,e);var n=VJ(this),r=0;return $J(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function jJ(t,e){Kk(t,e),e.add(t)}function fC(t,e,n){Kk(t,e),e.set(t,n)}function Kk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tI(t,e,n){return t.set(Ew(t,e),n),n}function $n(t,e){return t.get(Ew(t,e))}function Ew(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const UJ=100;var Wr=new WeakMap,vc=new WeakMap,gC=new WeakMap,mC=new WeakSet;class nI{constructor(){jJ(this,mC),fC(this,Wr,new Map),fC(this,vc,new Map),fC(this,gC,new Set),Ul.forEach(e=>Ew(mC,this,rI).call(this,e))}getHooks(e){var n;return(n=$n(Wr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};$n(Wr,this).has(e)||(Ew(mC,this,rI).call(this,e),Ul.push(e));const i=$n(Wr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=$n(gC,this).has(e);!u&&o!==0&&(u=!0,$n(gC,this).add(e)),u&&i.length>1&&$n(Wr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return $n(Wr,this).has(e)&&$n(Wr,this).get(e).length>0}remove(e,n){if(!$n(Wr,this).has(e))return!1;const r=$n(Wr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=$n(vc,this).get(e);return i.skip=!0,o+=1,o>UJ&&($n(Wr,this).set(e,r.filter(s=>!s.skip)),o=0),$n(vc,this).set(e,o),!0}return!1}destroy(){$n(Wr,this).clear(),$n(vc,this).clear(),tI(Wr,this,null),tI(vc,this,null)}}function rI(t){$n(Wr,this).set(t,[]),$n(vc,this).set(t,0)}function zJ(t,e,n){return(e=YJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YJ(t){var e=GJ(t,"string");return typeof e=="symbol"?e:e+""}function GJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const KJ=ct`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class oe{constructor(){zJ(this,"globalBucket",new nI)}static getSingleton(){return XJ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new nI),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.add(e,o,r)):(cC.has(e)&&tt(wE(KJ,{hookName:e,removedInVersion:cC.get(e)})),hC.has(e)&&tt(hC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?M(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Sw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Sw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Ul.push(e)}deregister(e){this.isRegistered(e)&&Ul.splice(Ul.indexOf(e),1)}isDeprecated(e){return hC.has(e)||cC.has(e)}isRegistered(e){return Ul.indexOf(e)>=0}getRegistered(){return Ul}}const qJ=new oe;function XJ(){return qJ}const pC=new Map;function ao(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";pC.has(t)||pC.set(t,new Map);const e=pC.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const mR=new WeakMap,{register:JJ,getItem:qk,hasItem:Xk,getNames:ZJ,getValues:JRe}=ao("editors");function QJ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},oe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Jk(t,e){let n;if(typeof t=="function")mR.get(t)||Mr(null,t),n=mR.get(t);else if(typeof t=="string")n=qk(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Tw(t){if(typeof t=="function")return t;if(!Xk(t))throw Error(`No registered editor found under "${t}" name`);return qk(t).getConstructor()}function Mr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new QJ(e);typeof t=="string"&&JJ(t,n),mR.set(e,n)}function eZ(t,e,n){return(e=tZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:e+""}function nZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Np=0;class Ri{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;eZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,rZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Np+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Np-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Np-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function rZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),xi(this)},t}function iZ(){return Np}function oZ(t,e){sZ(t,e),e.add(t)}function sZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tl(t,e,n){return(e=aZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aZ(t){var e=lZ(t,"string");return typeof e=="symbol"?e:e+""}function lZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yg=new WeakSet;class pR{constructor(e,n,r){oZ(this,Yg),tl(this,"hot",void 0),tl(this,"tableMeta",void 0),tl(this,"selection",void 0),tl(this,"eventManager",void 0),tl(this,"destroyed",!1),tl(this,"activeEditor",void 0),tl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Ri(e),this.hot.addHook("afterDocumentKeyDown",i=>wC(Yg,this,iI).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>wC(Yg,this,iI).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>wC(Yg,this,uZ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=Jk(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function iI(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ba(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!DE(n)&&!zk(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function uZ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const oI=new WeakMap;pR.getInstance=function(t,e,n){let r=oI.get(t);return r||(r=new pR(t,e,n),oI.set(t,r)),r};function cZ(t,e){Zk(t,e),e.add(t)}function Dh(t,e,n){Zk(t,e),e.set(t,n)}function Zk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(t,e){return t.get(_s(t,e))}function kh(t,e,n){return t.set(_s(t,e),n),n}function _s(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vc=Object.freeze({CELL:"cell",MIXED:"mixed"});var wn=new WeakMap,Gg=new WeakMap,Kg=new WeakMap,qg=new WeakMap,Xg=new WeakMap,pa=new WeakSet;class hZ{constructor(e){var n=this;cZ(this,pa),Dh(this,wn,void 0),Dh(this,Gg,void 0),Dh(this,Kg,1),Dh(this,qg,null),Dh(this,Xg,new Map);const r=e.getSettings();kh(wn,this,e),kh(Gg,this,r.imeFastEdit?Vc.MIXED:Vc.CELL),St(wn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _s(pa,n,fZ).call(n,...o)}),St(wn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _s(pa,n,sI).call(n,...o)}),St(wn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _s(pa,n,sI).call(n,...o)}),St(wn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _s(pa,n,dZ).call(n,...o)})}getFocusMode(){return St(Gg,this)}setFocusMode(e){Object.values(Vc).includes(e)?kh(Gg,this,e):tt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return St(Kg,this)}setRefocusDelay(e){kh(Kg,this,e)}setRefocusElementGetter(e){kh(qg,this,e)}getRefocusElement(){var e;return typeof St(qg,this)=="function"?St(qg,this).call(this):(e=St(wn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=St(wn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=St(wn,this).runHooks("modifyFocusedElement",s.row,s.col,r);Uo(a)||(a=r),a&&!((o=St(wn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):_s(pa,this,$E).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:St(Kg,this);if(St(wn,this).getSettings().imeFastEdit&&!((e=St(wn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=St(wn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),St(Xg,this).has(n)||St(Xg,this).set(n,hg(()=>{if(!St(wn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),St(Xg,this).get(n)()}}}function $E(t){var e;const n=(e=St(wn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!St(wn,this).selection.isCellVisible(n)){t(null);return}const r=St(wn,this).getCell(n.row,n.col,!0);r===null?St(wn,this).addHookOnce("afterScroll",()=>{t(St(wn,this).getCell(n.row,n.col,!0))}):t(r)}function sI(){_s(pa,this,$E).call(this,t=>{const{activeElement:e}=St(wn,this).rootDocument;e&&$v(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function dZ(){_s(pa,this,$E).call(this,t=>{this.getFocusMode()===Vc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function fZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Vc.MIXED:Vc.CELL)}var gZ=Ti,mZ=wu,pZ=oo,wZ=pZ("match"),vZ=function(t){var e;return gZ(t)&&((e=t[wZ])!==void 0?!!e:mZ(t)==="RegExp")},yZ=bn,CZ=function(){var t=yZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},bZ=yn,SZ=Mi,RZ=Zf,EZ=CZ,aI=RegExp.prototype,TZ=function(t){var e=t.flags;return e===void 0&&!("flags"in aI)&&!SZ(t,"flags")&&RZ(aI,t)?bZ(EZ,t):e},LE=dn,MZ=ah,_Z=Math.floor,vC=LE("".charAt),PZ=LE("".replace),yC=LE("".slice),xZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,IZ=/\$([$&'`]|\d{1,2})/g,OZ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=IZ;return i!==void 0&&(i=MZ(i),l=xZ),PZ(o,l,function(u,c){var h;switch(vC(c,0)){case"$":return"$";case"&":return t;case"`":return yC(e,0,n);case"'":return yC(e,s);case"<":h=i[yC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=_Z(d/10);return f===0?u:f<=a?r[f-1]===void 0?vC(c,1):r[f-1]+vC(c,1):u}h=r[d-1]}return h===void 0?"":h})},AZ=Ct,HZ=yn,FE=dn,lI=Xf,NZ=Cn,DZ=Ti,kZ=vZ,$h=Cv,$Z=Qf,LZ=TZ,FZ=OZ,VZ=oo,WZ=VZ("replace"),BZ=TypeError,CC=FE("".indexOf);FE("".replace);var uI=FE("".slice),jZ=Math.max;AZ({target:"String",proto:!0},{replaceAll:function(e,n){var r=lI(this),i,o,s,a,l,u,c,h,d,f,g=0,v="";if(DZ(e)){if(i=kZ(e),i&&(o=$h(lI(LZ(e))),!~CC(o,"g")))throw new BZ("`.replaceAll` does not allow non-global regexes");if(s=$Z(e,WZ),s)return HZ(s,e,r,n)}for(a=$h(r),l=$h(e),u=NZ(n),u||(n=$h(n)),c=l.length,h=jZ(1,c),d=CC(a,l);d!==-1;)f=u?$h(n(l,d,a)):FZ(l,a,d,[],void 0,n),v+=uI(a,g,d)+f,g=d+c,d=d+h>a.length?-1:CC(a,l,d+h);return g<a.length&&(v+=uI(a,g)),v}});var UZ=Ct,zZ=ch,YZ=Dr,GZ=bn,KZ=Jo,qZ=ti,XZ=Ga,JZ=ng,ZZ=Nn,Qk=TypeError,e$=ZZ(function(){[].keys().reduce(function(){},void 0)}),bC=!e$&&XZ("reduce",Qk);UZ({target:"Iterator",proto:!0,real:!0,forced:e$||bC},{reduce:function(e){GZ(this);try{YZ(e)}catch(s){qZ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(bC)return JZ(bC,this,n?[e]:[e,r]);var i=KZ(this),o=0;if(zZ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new Qk("Reduce of empty iterator with no initial value");return r}});const t$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},QZ=new RegExp(Object.keys(t$).map(t=>`(${t})`).join("|"),"gi");function eQ(t){return(t&&t.nodeName||"")==="TABLE"}function wR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let y=0;y<s;y+=1){const E=!f&&n&&y===0;let C="";if(f)C=`<th>${t.getColHeader(y-c)}</th>`;else if(E)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const _=i[d][y],{hidden:I,rowspan:P,colspan:T}=t.getCellMeta(d-h,y-c);if(!I){const A=[];if(P&&A.push(`rowspan="${P}"`),T&&A.push(`colspan="${T}"`),Gt(_))C=`<td ${A.join(" ")}></td>`;else{const G=_.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${A.join(" ")}>${G}</td>`}}}g.push(C)}const v=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function vR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Gt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function n$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const _=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,I=>{const P=I.match(/<td\b[^>]*?>/g)[0],T=/<p.*?>/g,A=I.substring(P.length,I.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(T,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${A}</td>`});i.insertAdjacentHTML("afterbegin",`${_}`),o=i.querySelector("table")}if(!o||!eQ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((_,I)=>_+I.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const _=Array.from(o.tHead.rows).filter(I=>{const P=I.querySelector("td")!==null;return P&&h.push(I),!P});f=_.length,d=f>0,f>1?n.nestedHeaders=Array.from(_).reduce((I,P)=>{const T=Array.from(P.cells).reduce((A,G,U)=>{if(a&&U===0)return A;const{colSpan:V,innerHTML:X}=G,ne=V>1?{label:X,colspan:V}:X;return A.push(ne),A},[]);return I.push(T),I},[]):d&&(n.colHeaders=Array.from(_[0].children).reduce((I,P,T)=>(a&&T===0||I.push(P.innerHTML),I),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((_,I)=>(_.push(...Array.from(I.rows)),_),[]),...c];g=v.length;const y=new Array(g);for(let _=0;_<g;_++)y[_]=new Array(u);const E=[],C=[];for(let _=0;_<g;_++){const I=v[_],P=Array.from(I.cells),T=P.length;for(let A=0;A<T;A++){const G=P[A],{nodeName:U,innerHTML:V,rowSpan:X,colSpan:ne}=G,Q=y[_].findIndex(te=>te===void 0);if(U==="TD"){if(X>1||ne>1){for(let Re=_;Re<_+X;Re++)if(Re<g)for(let Ae=Q;Ae<Q+ne;Ae++)y[Re][Ae]=null;const pe=G.getAttribute("style");pe&&pe.includes("mso-ignore:colspan")||E.push({col:Q,row:_,rowspan:X,colspan:ne})}let te="";s&&/excel/gi.test(s.content)?te=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[_][Q]=te.replace(QZ,pe=>t$[pe])}else C.push(V)}}return E.length&&(n.mergeCells=E),C.length&&(n.rowHeaders=C),y.length&&(n.data=y),n}const tQ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:vR,htmlToGridSettings:n$,instanceToHTML:wR},Symbol.toStringTag,{value:"Module"}));function Gn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function r$(t){return Gn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function yR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function VE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ye(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const nQ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ye,isNumeric:Gn,isNumericLike:r$,rangeEach:fe,rangeEachReverse:yR,valueAccordingPercent:VE},Symbol.toStringTag,{value:"Module"})),CR="asc",rQ="desc",cI=new Map([[CR,[-1,1]],[rQ,[1,-1]]]),iQ=t=>`The priority '${t}' is already declared in a map.`,oQ=t=>`The priority '${t}' is not a number.`;function sQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=lt(t)?t:iQ,e=lt(e)?e:oQ;function r(o,s){if(!Gn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:CR;const[s,a]=cI.get(o)||cI.get(CR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const aQ=t=>`The id '${t}' is already declared in a map.`;function Bv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=lt(t)?t:aQ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const lQ=t=>`'${t}' value is already declared in a unique set.`;function uQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=lt(t)?t:lQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const WE=t=>`There is already registered "${t}" plugin.`,cQ=t=>`There is already registered plugin on priority "${t}".`,hQ=t=>`The priority "${t}" is not a number.`,i$=sQ({errorPriorityExists:cQ,errorPriorityNaN:hQ}),o$=uQ({errorItemExists:WE}),bR=Bv({errorIdExists:WE});function BE(){return[...i$.getItems(),...o$.getItems()]}function gg(t){const e=Zn(t);return bR.getItem(e)}function dQ(t){return!!gg(t)}function Ke(t,e,n){[t,e,n]=gQ(t,e,n),gg(t)===void 0&&fQ(t,e,n)}function fQ(t,e,n){const r=Zn(t);if(bR.hasItem(r))throw new Error(WE(r));n===void 0?o$.addItem(r):i$.addItem(n,r),bR.addItem(r,e)}function gQ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:mQ,getItem:pQ,hasItem:s$,getNames:wQ,getValues:ZRe}=ao("renderers");function Mw(t){if(typeof t=="function")return t;if(!s$(t))throw Error(`No registered renderer found under "${t}" name`);return pQ(t)}function jr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),mQ(t,e)}const{register:vQ,getItem:yQ,hasItem:a$,getNames:CQ,getValues:QRe}=ao("validators");function jE(t){if(typeof t=="function")return t;if(!a$(t))throw Error(`No registered validator found under "${t}" name`);return yQ(t)}function zl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),vQ(t,e)}var bQ=Ct,SQ=ah,RQ=uh,EQ=eg,TQ=Wv;bQ({target:"Array",proto:!0},{at:function(e){var n=SQ(this),r=RQ(n),i=EQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});TQ("at");var MQ=Ct,_Q=dn,PQ=Xf,xQ=eg,IQ=Cv,OQ=Nn,AQ=_Q("".charAt),HQ=OQ(function(){return"𠮷".at(-2)!=="\uD842"});MQ({target:"String",proto:!0,forced:HQ},{at:function(e){var n=IQ(PQ(this)),r=n.length,i=xQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:AQ(n,o)}});function Lh(t,e,n){return(e=NQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NQ(t){var e=DQ(t,"string");return typeof e=="symbol"?e:e+""}function DQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kQ{constructor(){Lh(this,"count",0),Lh(this,"startColumn",null),Lh(this,"endColumn",null),Lh(this,"startPosition",null),Lh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Fh(t,e,n){return(e=$Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Q(t){var e=LQ(t,"string");return typeof e=="symbol"?e:e+""}function LQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FQ{constructor(){Fh(this,"count",0),Fh(this,"startRow",null),Fh(this,"endRow",null),Fh(this,"startPosition",null),Fh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Vh(t,e,n){return(e=VQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VQ(t){var e=WQ(t,"string");return typeof e=="symbol"?e:e+""}function WQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l${constructor(){Vh(this,"count",0),Vh(this,"startColumn",null),Vh(this,"endColumn",null),Vh(this,"startPosition",null),Vh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Wh(t,e,n){return(e=BQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BQ(t){var e=jQ(t,"string");return typeof e=="symbol"?e:e+""}function jQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u${constructor(){Wh(this,"count",0),Wh(this,"startRow",null),Wh(this,"endRow",null),Wh(this,"startPosition",null),Wh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Bh(t,e,n){return(e=UQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UQ(t){var e=zQ(t,"string");return typeof e=="symbol"?e:e+""}function zQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YQ{constructor(){Bh(this,"count",0),Bh(this,"startColumn",0),Bh(this,"endColumn",0),Bh(this,"startPosition",0),Bh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function jh(t,e,n){return(e=GQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GQ(t){var e=KQ(t,"string");return typeof e=="symbol"?e:e+""}function KQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qQ{constructor(){jh(this,"count",0),jh(this,"startRow",0),jh(this,"endRow",0),jh(this,"startPosition",0),jh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function hI(t,e,n){return(e=XQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XQ(t){var e=JQ(t,"string");return typeof e=="symbol"?e:e+""}function JQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZQ extends l${constructor(){super(...arguments),hI(this,"columnStartOffset",0),hI(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function dI(t,e,n){return(e=QQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QQ(t){var e=eee(t,"string");return typeof e=="symbol"?e:e+""}function eee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tee extends u${constructor(){super(...arguments),dI(this,"rowStartOffset",0),dI(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function fI(t,e,n){return(e=nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=ree(t,"string");return typeof e=="symbol"?e:e+""}function ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c${constructor(e){fI(this,"calculationTypes",[]),fI(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Ai(t,e,n){return(e=iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iee(t){var e=oee(t,"string");return typeof e=="symbol"?e:e+""}function oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Jc=50;class see extends c${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Ai(this,"viewportWidth",0),Ai(this,"scrollOffset",0),Ai(this,"zeroBasedScrollOffset",0),Ai(this,"totalColumns",0),Ai(this,"columnWidthFn",null),Ai(this,"columnWidth",0),Ai(this,"overrideFn",null),Ai(this,"inlineStartOffset",0),Ai(this,"totalCalculatedWidth",0),Ai(this,"startPositions",[]),Ai(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Jc:n}}function oi(t,e,n){return(e=aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aee(t){var e=lee(t,"string");return typeof e=="symbol"?e:e+""}function lee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uee extends c${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),oi(this,"viewportHeight",0),oi(this,"scrollOffset",0),oi(this,"zeroBasedScrollOffset",0),oi(this,"totalRows",0),oi(this,"rowHeightFn",null),oi(this,"rowHeight",0),oi(this,"overrideFn",null),oi(this,"horizontalScrollbarHeight",0),oi(this,"innerViewportHeight",0),oi(this,"totalCalculatedHeight",0),oi(this,"startPositions",[]),oi(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function cee(t,e,n){hee(t,e),e.set(t,n)}function hee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gI(t,e,n){return(e=dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dee(t){var e=fee(t,"string");return typeof e=="symbol"?e:e+""}function fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nu(t,e){return t.get(h$(t,e))}function mI(t,e,n){return t.set(h$(t,e),n),n}function h$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var os=new WeakMap;class uu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;gI(this,"row",null),gI(this,"col",null),cee(this,os,!1),mI(os,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Nu(os,this)}isSouthEastOf(e){return this.row>=e.row&&(Nu(os,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Nu(os,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Nu(os,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Nu(os,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof uu&&mI(os,this,e.isRtl()),this}clone(){return new uu(this.row,this.col,Nu(os,this))}toObject(){return{row:this.row,col:this.col}}}function gee(t,e,n){mee(t,e),e.set(t,n)}function mee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SC(t,e,n){return(e=pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pee(t){var e=wee(t,"string");return typeof e=="symbol"?e:e+""}function wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function si(t,e){return t.get(d$(t,e))}function vee(t,e,n){return t.set(d$(t,e),n),n}function d$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pr=new WeakMap;class mg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;SC(this,"highlight",null),SC(this,"from",null),SC(this,"to",null),gee(this,pr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),vee(pr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return si(pr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return si(pr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return si(pr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return si(pr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return si(pr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return si(pr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return si(pr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return si(pr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof uu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(si(pr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(si(pr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new mg(this.highlight,this.from,this.to,si(pr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new uu(e,n,si(pr,this))}}function ho(t,e,n){yee(t,e),e.set(t,n)}function yee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(f$(t,e))}function Zs(t,e,n){return t.set(f$(t,e),n),n}function f$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ai=new WeakMap,RC=new WeakMap,In=new WeakMap,Du=new WeakMap,Jg=new WeakMap,Hi=new WeakMap,EC=new WeakMap,Uh=new WeakMap,nl=new WeakMap,fo=new WeakMap;let g$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ho(this,ai,void 0),ho(this,RC,void 0),ho(this,In,void 0),ho(this,Du,void 0),ho(this,Jg,void 0),ho(this,Hi,void 0),ho(this,EC,void 0),ho(this,Uh,void 0),ho(this,nl,[null,null]),ho(this,fo,[null,null]),Zs(ai,this,r),Zs(RC,this,n),Zs(In,this,o),Zs(Du,this,s),Zs(Jg,this,a),Zs(Hi,this,i),Zs(EC,this,e),this.registerEvents()}registerEvents(){ge(Hi,this).addEventListener(ge(In,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(Hi,this).addEventListener(ge(In,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(Hi,this).addEventListener(ge(In,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(Hi,this).addEventListener(ge(In,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(Hi,this).addEventListener(ge(In,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(Hi,this).addEventListener(ge(In,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(ai,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(ai,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(Hi,this).addEventListener(ge(In,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(Hi,this).addEventListener(ge(In,this).holder,"mousedown",r=>this.onMouseDown(r))};Bo()?e():(OE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(Uh,this)&&r){const[i,o]=[r.row,ge(Uh,this).from.row],[s,a]=[r.col,ge(Uh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(In,this).TABLE,i=Nd(e,["TD","TH"],r);return i?(n.coords=ge(In,this).getCoords(i),n.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(n.coords=ge(Du,this).getFocusSelection().cellRange.highlight,n.TD=ge(In,this).getCell(n.coords)):ve(e,"wtBorder")&&ve(e,"area")&&ge(Du,this).getAreaSelection().cellRange&&(n.coords=ge(Du,this).getAreaSelection().cellRange.to,n.TD=ge(In,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(RC,this).rootDocument.activeElement,r=IE(pk,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ve(i,"corner")?ge(ai,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(ai,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(fo,this)[0]=o.TD,clearTimeout(ge(nl,this)[0]),ge(nl,this)[0]=setTimeout(()=>{ge(fo,this)[0]=null},1e3))}onContextMenu(e){if(ge(ai,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(ai,this).has("onCellMouseOver"))return;const n=ge(In,this).TABLE,r=Nd(e.target,["TD","TH"],n),i=ge(Jg,this)||this;r&&r!==i.lastMouseOver&&Da(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(In,this).getCoords(r),r))}onMouseOut(e){if(!ge(ai,this).has("onCellMouseOut"))return;const n=ge(In,this).TABLE,r=Nd(e.target,["TD","TH"],n),i=Nd(e.relatedTarget,["TD","TH"],n),o=ge(Jg,this)||this;r&&r!==i&&Da(r,n)&&(this.callListener("onCellMouseOut",e,ge(In,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(ai,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(fo,this)[0]&&n.TD===ge(fo,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(fo,this)[0]=null,ge(fo,this)[1]=null):n.TD===ge(fo,this)[0]&&(ge(fo,this)[1]=n.TD,clearTimeout(ge(nl,this)[1]),ge(nl,this)[1]=setTimeout(()=>{ge(fo,this)[1]=null},500)))}onTouchStart(e){Zs(Uh,this,ge(Du,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(ai,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];HE()&&(Wk()||Bk())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(ai,this).getSettingPure(e);o&&o(n,r,i,ge(EC,this).call(this))}destroy(){clearTimeout(ge(nl,this)[0]),clearTimeout(ge(nl,this)[1]),ge(Hi,this).destroy()}};function TC(t,e,n){return(e=Cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cee(t){var e=bee(t,"string");return typeof e=="symbol"?e:e+""}function bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class See{constructor(e,n,r){TC(this,"offset",void 0),TC(this,"total",void 0),TC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function MC(t,e,n){return(e=Ree(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ree(t){var e=Eee(t,"string");return typeof e=="symbol"?e:e+""}function Eee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tee{constructor(e,n,r){MC(this,"offset",void 0),MC(this,"total",void 0),MC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Zg(t,e,n){return(e=Mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mee(t){var e=_ee(t,"string");return typeof e=="symbol"?e:e+""}function _ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pee{constructor(){Zg(this,"currentSize",0),Zg(this,"nextSize",0),Zg(this,"currentOffset",0),Zg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const xee=0,pI=1,SR=2;function _C(t,e,n){return(e=Iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iee(t){var e=Oee(t,"string");return typeof e=="symbol"?e:e+""}function Oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aee{constructor(){_C(this,"size",new Pee),_C(this,"workingSpace",xee),_C(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=pI,e.workingSpace=SR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=SR,e.workingSpace=pI,this.sharedSize=e.getViewSize()}}var wI=yv,Hee=TypeError,Nee=function(t,e){if(!delete t[e])throw new Hee("Cannot delete property "+wI(e)+" of "+wI(t))},Dee=Ct,kee=ah,$ee=uh,Lee=SN,Fee=Nee,Vee=RN,Wee=[].unshift(0)!==1,Bee=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},jee=Wee||!Bee();Dee({target:"Array",proto:!0,arity:1,forced:jee},{unshift:function(e){var n=kee(this),r=$ee(n),i=arguments.length;if(i){Vee(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Fee(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return Lee(n,r+i)}});function Uee(t,e,n){return(e=zee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zee(t){var e=Yee(t,"string");return typeof e=="symbol"?e:e+""}function Yee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vI{constructor(e,n){Uee(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Gee(t,e,n){return(e=Kee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kee(t){var e=qee(t,"string");return typeof e=="symbol"?e:e+""}function qee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xee{constructor(e){Gee(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new vI(o,n),l=new vI(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(SR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function ku(t,e,n){return(e=Jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jee(t){var e=Zee(t,"string");return typeof e=="symbol"?e:e+""}function Zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m${constructor(e,n){ku(this,"rootNode",void 0),ku(this,"nodesPool",void 0),ku(this,"sizeSet",new Aee),ku(this,"collectedNodes",[]),ku(this,"viewDiffer",new Xee(this.sizeSet)),ku(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class p$ extends m${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function yI(t,e,n){return(e=Qee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qee(t){var e=ete(t,"string");return typeof e=="symbol"?e:e+""}function ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tte{constructor(e){yI(this,"nodeType",void 0),yI(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function zh(t,e,n){return(e=nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nte(t){var e=rte(t,"string");return typeof e=="symbol"?e:e+""}function rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pg{constructor(e,n){zh(this,"nodesPool",null),zh(this,"nodeType",void 0),zh(this,"rootNode",void 0),zh(this,"table",null),zh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new tte(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function CI(t,e,n){return(e=ite(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ite(t){var e=ote(t,"string");return typeof e=="symbol"?e:e+""}function ote(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ste extends pg{constructor(){super("TH"),CI(this,"orderViews",new WeakMap),CI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new p$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Mu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(d,[m8(),E8(),vE(h+1),Eu(-1)]),n[h](a,d,h)}u.end()}}}class ate extends pg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Ko(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&be(this.rootNode,[ck()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&be(s,[cR(),gk(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Mu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(u,[vE(a+1+this.table.rowHeadersCount),Eu(-1),p8(),...a>=0?[R8()]:[cR()]]),r[n](l,u,n)}}}}let bI=!1;class lte extends pg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!bI&&e>1e3&&(bI=!0,tt(ct`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function ute(t,e,n){return(e=cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cte(t){var e=hte(t,"string");return typeof e=="symbol"?e:e+""}function hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $u={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let SI=!1;class dte extends pg{constructor(e){super("TR",e),ute(this,"orderView",void 0),this.orderView=new m$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!SI&&e>1e3&&(SI=!0,tt(ct`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&be(this.rootNode,[ck()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;be(o,[cR(),gk(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ve(o,$u.rowEven)||(we(o,$u.rowOdd),q(o,$u.rowEven)):ve(o,$u.rowOdd)||(we(o,$u.rowEven),q(o,$u.rowOdd))}this.orderView.end()}}function RI(t,e,n){return(e=fte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fte(t){var e=gte(t,"string");return typeof e=="symbol"?e:e+""}function gte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mte extends pg{constructor(){super("TD"),RI(this,"orderViews",new WeakMap),RI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new p$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(ve(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Mu(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;be(g,[...g.hasAttribute("role")?[]:[g8()],Eu(-1),vE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function mn(t,e,n){return(e=pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pte(t){var e=wte(t,"string");return typeof e=="symbol"?e:e+""}function wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vte{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mn(this,"rootNode",void 0),mn(this,"rootDocument",void 0),mn(this,"rowHeaders",null),mn(this,"columnHeaders",null),mn(this,"colGroup",null),mn(this,"rows",null),mn(this,"cells",null),mn(this,"rowFilter",null),mn(this,"columnFilter",null),mn(this,"rowUtils",null),mn(this,"columnUtils",null),mn(this,"rowsToRender",0),mn(this,"columnsToRender",0),mn(this,"rowHeaderFunctions",[]),mn(this,"rowHeadersCount",0),mn(this,"columnHeaderFunctions",[]),mn(this,"columnHeadersCount",0),mn(this,"cellRenderer",void 0),mn(this,"activeOverlayName",void 0),mn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class yte{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new vte(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new ste,columnHeaders:new ate(n),colGroup:new lte(r),rows:new dte(i),cells:new mte}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function PC(t,e,n){return(e=Cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cte(t){var e=bte(t,"string");return typeof e=="symbol"?e:e+""}function bte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ste{constructor(e,n){PC(this,"dataAccessObject",void 0),PC(this,"wtSettings",void 0),PC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function EI(t,e,n){return(e=Rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rte(t){var e=Ete(t,"string");return typeof e=="symbol"?e:e+""}function Ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tte{constructor(e,n){EI(this,"dataAccessObject",void 0),EI(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function go(t,e,n){return(e=Mte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mte(t){var e=_te(t,"string");return typeof e=="symbol"?e:e+""}function _te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ph{constructor(e,n,r,i,o){go(this,"wtSettings",null),go(this,"domBindings",void 0),go(this,"TBODY",null),go(this,"THEAD",null),go(this,"COLGROUP",null),go(this,"hasTableHeight",!0),go(this,"hasTableWidth",!0),go(this,"isTableVisible",!1),go(this,"tableOffset",0),go(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,CE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Tte(this.dataAccessObject,this.wtSettings),this.columnUtils=new Ste(this.dataAccessObject,this.wtSettings),this.tableRenderer=new yte({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&be(r,[As()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[As()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",be(r,[Eu(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&be(r.parentNode,[As()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[As()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Ln(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Ln(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Tee(f,o,c),this.columnFilter=new See(g,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),v=y.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Lo)||this.is($a))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Lo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Lo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Fc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Lo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Wa(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=yk(r),s=n.cellIndex;fa(du,n,this.wtRootElement)||fa(cu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):fa($a,n,this.wtRootElement)||fa(Lo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),fa(du,n,this.wtRootElement)||fa(hu,n,this.wtRootElement)||fa($a,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=Fc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?un:Fc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return en(this.TABLE)}getHeight(){return un(this.TABLE)}getTotalWidth(){const e=en(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=un(this.hider);return e!==0?e:this.getHeight()}isVisible(){return lu(this.TABLE)}_modifyRowHeaderWidth(e){let n=lt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Pte="stickyRowsBottom",UE={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};es(UE,"MIXIN_NAME",Pte,{writable:!1,enumerable:!1});const xte="stickyColumnsStart",jv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};es(jv,"MIXIN_NAME",xte,{writable:!1,enumerable:!1});class zE extends ph{constructor(e,n,r,i){super(e,n,r,i,$a)}}gt(zE,UE);gt(zE,jv);const cu="top",Lo="bottom",hu="inline_start",du="top_inline_start_corner",$a="bottom_inline_start_corner",w$=[cu,Lo,hu,du,$a],Ite=new Map([[cu,`ht_clone_${cu}`],[Lo,`ht_clone_${Lo}`],[hu,`ht_clone_${hu} ht_clone_left`],[du,`ht_clone_${du} ht_clone_top_left_corner`],[$a,`ht_clone_${$a} ht_clone_bottom_left_corner`]]);function Ote(t,e){Ate(t,e),e.add(t)}function Ate(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hte(t,e,n){return(e=Nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nte(t){var e=Dte(t,"string");return typeof e=="symbol"?e:e+""}function Dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yh=new WeakSet;class kte{constructor(e){Ote(this,Yh),Hte(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Qg(Yh,this,MI).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Qg(Yh,this,MI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Qg(Yh,this,TI).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Qg(Yh,this,TI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function TI(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Ln(r.wtRootElement).left;const u=Math.abs(SE(s,s));if(l>u){const c=RE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function MI(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Ln(n.wtRootElement),a=Dv(o,o);if(s.top>a){const l=Fc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function li(t,e,n){return(e=$te(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $te(t){var e=Lte(t,"string");return typeof e=="symbol"?e:e+""}function Lte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YE{get eventManager(){return new Ri(this)}constructor(e,n){li(this,"wtTable",void 0),li(this,"wtScroll",void 0),li(this,"wtViewport",void 0),li(this,"wtOverlays",void 0),li(this,"selectionManager",void 0),li(this,"wtEvent",void 0),li(this,"guid",`wt_${mE()}`),li(this,"drawInterrupted",!1),li(this,"drawn",!1),li(this,"activeOverlayName","master"),li(this,"domBindings",void 0),li(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new kte(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Ba(r,e[n])}])}}createCellCoords(e,n){return new uu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new mg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||Rk(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function _I(t,e,n){return(e=Fte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fte(t){var e=Vte(t,"string");return typeof e=="symbol"?e:e+""}function Vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wte extends YE{constructor(e,n,r){super(e,n),_I(this,"cloneSource",void 0),_I(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new g$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function Bte(t,e,n){return(e=jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jte(t){var e=Ute(t,"string");return typeof e=="symbol"?e:e+""}function Ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wg{constructor(e,n,r,i,o){Bte(this,"wtSettings",null),es(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=qc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=qc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Mf(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){tt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+_n())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(w$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Ite.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&be(o,[As()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===cu||u==="vertical"&&this.type===hu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Mf(e.TABLE),new Wte(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class zte extends wg{constructor(e,n,r,i,o,s){super(e,n,$a,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new zE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else cg(n),this.repositionOverlay();let r=un(this.clone.wtTable.TABLE);const i=en(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=_n(r)),i.style.bottom=`${o}px`}}const Yte="calculatedColumns",Uv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};es(Uv,"MIXIN_NAME",Yte,{writable:!1,enumerable:!1});class GE extends ph{constructor(e,n,r,i){super(e,n,r,i,Lo)}}gt(GE,UE);gt(GE,Uv);function Gte(t,e,n){return(e=Kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kte(t){var e=qte(t,"string");return typeof e=="symbol"?e:e+""}function qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xte extends wg{constructor(e,n,r,i){super(e,n,Lo,r,i),Gte(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new GE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=_n(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Nv(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=un(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=_n(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Dv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(we(s,"innerBorderBottom"),o=a)}return o}}const Jte="calculatedRows",KE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};es(KE,"MIXIN_NAME",Jte,{writable:!1,enumerable:!1});class qE extends ph{constructor(e,n,r,i){super(e,n,r,i,hu)}}gt(qE,KE);gt(qE,jv);const Zte="localHooks",Fn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Sw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};es(Fn,"MIXIN_NAME",Zte,{writable:!1,enumerable:!1});let v$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};gt(v$,Fn);const y$="active-header",XE="header",JE="area",Kd="focus",Qte="fill",ene="row",tne="column",nne="custom-selection",ZE=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var rne=Wv;rne("flat");function ine(t,e){C$(t,e),e.add(t)}function PI(t,e,n){C$(t,e),e.set(t,n)}function C$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jt(t,e){return t.get(qd(t,e))}function xI(t,e,n){return t.set(qd(t,e),n),n}function qd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fi=new WeakMap,Un=new WeakMap,em=new WeakSet;class one{constructor(){ine(this,em),PI(this,Fi,void 0),PI(this,Un,void 0)}setActiveOverlay(e){return xI(Un,this,e),this}setActiveSelection(e){return xI(Fi,this,e),this}scan(){const e=jt(Fi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=jt(Fi,this).getCorners(),{wtTable:s}=jt(Un,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const v=jt(Un,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:jt(Fi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==h&&(g=s.getColumnHeader(v,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=jt(Fi,this).getCorners(),{wtTable:s}=jt(Un,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const v=jt(Un,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:jt(Fi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(g=s.getRowHeader(v,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=jt(Un,this);qd(em,this,sne).call(this,(r,i)=>{const o=n.getCell(jt(Un,this).createCellCoords(r,i)),s=jt(Un,this).getSetting("onAfterDrawSelection",r,i,jt(Fi,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=jt(Fi,this).getCorners(),{wtTable:i}=jt(Un,this);qd(em,this,II).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(jt(Un,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=jt(Fi,this).getCorners(),{wtTable:i}=jt(Un,this);qd(em,this,II).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(jt(Un,this).createCellCoords(o,s));e(a)}})}}function sne(t){let[e,n,r,i]=jt(Fi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=jt(Un,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(jt(Un,this).createCellCoords(e,n));if(!Uo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function II(t){const{wtTable:e}=jt(Un,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class OI{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=ZE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),xi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Bo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};ke(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};ke(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),y-g-f*2),_=Math.min(parseInt(i+o-v/4,10),y-v-f*2);h[l]=`${C}px`,d[l]=`${_}px`;const I=Math.min(parseInt(r+s,10),E-g-f*2),P=Math.min(parseInt(r+s-v/4,10),E-v-f*2);h.top=`${I}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!Uo(g)){this.disappear();return}const v=u?s.getCell(this.wot.createCellCoords(i,o)):g,y=Ln(g),E=u?Ln(v):y,C=Ln(s.TABLE),_=y.top,I=y.left,P=this.wot.wtSettings.getSetting("rtlMode");let T=0,A=0;if(P){const Re=en(s.TABLE),Ae=en(g),ot=l.innerWidth-C.left-Re;A=I+Ae-E.left,T=l.innerWidth-I-Ae-ot-1}else A=E.left+en(v)-I,T=I-C.left-1;if(this.isEntireColumnSelected(n,i)){const Re=n,Ae=this.getDimensionsFromHeader("columns",r,o,Re,C);let ot=null;Ae&&([ot,T,A]=Ae),ot&&(g=ot)}let G=_-C.top-1,U=E.top+un(v)-_;if(this.isEntireRowSelected(r,o)){const Re=r,Ae=this.getDimensionsFromHeader("rows",n,i,Re,C);let ot=null;Ae&&([ot,G,U]=Ae),ot&&(g=ot)}const V=l.getComputedStyle(g);parseInt(V.borderTopWidth,10)>0&&(G+=1,U=U>0?U-1:0),parseInt(V[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,A=A>0?A-1:0);const X=P?"right":"left";this.topStyle.top=`${G}px`,this.topStyle[X]=`${T}px`,this.topStyle.width=`${A}px`,this.topStyle.display="block",this.startStyle.top=`${G}px`,this.startStyle[X]=`${T}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${G+U-ne}px`,this.bottomStyle[X]=`${T}px`,this.bottomStyle.width=`${A}px`,this.bottomStyle.display="block",this.endStyle.top=`${G}px`,this.endStyle[X]=`${T+A-ne}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let Q=this.settings.border.cornerVisible;Q=typeof Q=="function"?Q(this.settings.layerLevel):Q;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[pe,et]=[i,o];if(te&&Array.isArray(te)&&([,,pe,et]=te),Bo()||!Q||this.isPartRange(pe,et))this.cornerStyle.display="none";else{this.cornerStyle.top=`${G+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[X]=`${T+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Re=qc(s.TABLE);const Ae=Re===l;Ae&&(Re=a.documentElement);const ot=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Pn=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),st=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ae?v.getBoundingClientRect().left:v.offsetLeft;let w=!1,p=0;P?(p=m-parseInt(this.cornerDefaultStyle.width,10)/2,w=p<0):(p=m+en(v)+parseInt(this.cornerDefaultStyle.width,10)/2,w=p>=RE(Re)),w&&(this.cornerStyle[X]=`${Math.floor(T+A+this.cornerCenterPointOffset-Pn-ot)}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const p=(Ae?v.getBoundingClientRect().top:v.offsetTop)+un(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=Fc(Re),O=this.wot.stylesHandler.isClassicTheme();if(p){const L=Math.floor(G+U+this.cornerCenterPointOffset-st-ot);O?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}Bo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,G,T,A,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return un(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return en(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(g=l(n,y-i),v=l(r,y-i),!g||!v)return!1;const E=Ln(g),C=Ln(v);return g&&v&&(h=E[f]-o[f]-1,d=C[f]+u(v)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(ve(this[e],"hidden")&&we(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):we(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Bo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function ane(t,e){b$(t,e),e.add(t)}function Lu(t,e,n){b$(t,e),e.set(t,n)}function b$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(QE(t,e))}function AI(t,e,n){return t.set(QE(t,e),n),n}function QE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zn=new WeakMap,_r=new WeakMap,xC=new WeakMap,Dd=new WeakMap,IC=new WeakMap,rl=new WeakMap,HI=new WeakSet;class lne{constructor(e){ane(this,HI),Lu(this,zn,void 0),Lu(this,_r,void 0),Lu(this,xC,new one),Lu(this,Dd,new WeakMap),Lu(this,IC,new WeakSet),Lu(this,rl,new Map),AI(_r,this,e)}setActiveOverlay(e){return AI(zn,this,e),$e(xC,this).setActiveOverlay($e(zn,this)),$e(Dd,this).has($e(zn,this))||$e(Dd,this).set($e(zn,this),new Set),this}getFocusSelection(){return $e(_r,this)!==null?$e(_r,this).getFocus():null}getAreaSelection(){return $e(_r,this)!==null?$e(_r,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if($e(rl,this).has(e)){const r=$e(rl,this).get(e);if(r.has($e(zn,this)))return r.get($e(zn,this));const i=new OI($e(zn,this),e.settings);return r.set($e(zn,this),i),i}const n=new OI($e(zn,this),e.settings);return $e(rl,this).set(e,new Map([[$e(zn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=$e(rl,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){$e(rl,this).get(e).forEach(n=>n.destroy()),$e(rl,this).delete(e)}render(e){if($e(_r,this)===null)return;e&&QE(HI,this,une).call(this);const n=Array.from($e(_r,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;$e(IC,this).has(s)||($e(IC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&$e(xC,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const v=r.get(g);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();$e(zn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>$e(Dd,this).get($e(zn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=$e(_r,this).options)===null||a===void 0?void 0:a.cellAttributes)&&be(s,$e(_r,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{be(o,[...i.get(o)])})}}function une(){const t=$e(Dd,this).get($e(zn,this)),e=$e(zn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=$e(zn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=$e(_r,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=$e(_r,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=$e(_r,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...$e(_r,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)we(o[a],n),Mu(o[a],s)}),t.clear()}class cne extends wg{constructor(e,n,r,i){super(e,n,hu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new qE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),kv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),cg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,bE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=en(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=ZE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=_n(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Tk(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(SE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?we(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(we(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const hne="stickyRowsTop",eT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};es(eT,"MIXIN_NAME",hne,{writable:!1,enumerable:!1});class tT extends ph{constructor(e,n,r,i){super(e,n,r,i,du)}}gt(tT,eT);gt(tT,jv);function NI(t,e,n){return(e=dne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dne(t){var e=fne(t,"string");return typeof e=="symbol"?e:e+""}function fne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gne extends wg{constructor(e,n,r,i,o,s){super(e,n,du,r,i),NI(this,"topOverlay",void 0),NI(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new tT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();kv(e,`${i}px`,`${o}px`)}else cg(e);let n=un(this.clone.wtTable.TABLE);const r=en(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class nT extends ph{constructor(e,n,r,i){super(e,n,r,i,cu)}}gt(nT,eT);gt(nT,Uv);function mne(t,e,n){return(e=pne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pne(t){var e=wne(t,"string");return typeof e=="symbol"?e:e+""}function wne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vne extends wg{constructor(e,n,r,i){super(e,n,cu,r,i),mne(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new nT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),kv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),cg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Nv(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=un(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=ZE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=_n(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Ek(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Dv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?we(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(we(i,"innerBorderTop"),a=h)}}return a}}function tm(t,e,n){yne(t,e),e.set(t,n)}function yne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ss(t,e,n){return(e=Cne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cne(t){var e=bne(t,"string");return typeof e=="symbol"?e:e+""}function bne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function il(t,e,n){return t.set(S$(t,e),n),n}function as(t,e){return t.get(S$(t,e))}function S$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fu=new WeakMap,nm=new WeakMap,Vu=new WeakMap,rm=new WeakMap;class Sne{constructor(e,n,r,i,o,s){ss(this,"wot",null),tm(this,Fu,[]),ss(this,"topOverlay",null),ss(this,"bottomOverlay",null),ss(this,"inlineStartOverlay",null),ss(this,"topInlineStartCornerOverlay",null),ss(this,"bottomInlineStartCornerOverlay",null),ss(this,"browserLineHeight",void 0),ss(this,"wtSettings",null),tm(this,nm,!1),tm(this,Vu,0),tm(this,rm,null),ss(this,"resizeObserver",new ResizeObserver(c=>{Pf(()=>{!Array.isArray(c)||!c.length||(il(Vu,this,as(Vu,this)+1),as(Vu,this)===100&&(tt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),as(rm,this)!==null&&clearTimeout(as(rm,this)),il(rm,this,setTimeout(()=>{il(Vu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=_n(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Mf(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...as(Fu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new vne(...e),this.bottomOverlay=new Xte(...e),this.inlineStartOverlay=new cne(...e),this.topInlineStartCornerOverlay=new gne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new zte(...e,this.bottomOverlay,this.inlineStartOverlay),il(Fu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){il(nm,this,as(Fu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),as(Fu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),as(Fu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!AE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Pf(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{il(Vu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=mh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!as(nm,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),il(nm,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Mf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),v=f()?1:0,y=g()?1:0;d.width=`${c+y}px`,d.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return M(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];M(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function DI(t,e,n){return(e=Rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rne(t){var e=Ene(t,"string");return typeof e=="symbol"?e:e+""}function Ene(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tne{constructor(e){DI(this,"settings",{}),DI(this,"defaults",Object.freeze(this.getDefaults())),ke(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Ba(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?ke(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class rT extends ph{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=qc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=_f(e,"height",n),o=_f(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=lu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}gt(rT,KE);gt(rT,Uv);class Mne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new qQ:new tee],["fullyVisible",()=>new FQ],["partiallyVisible",()=>new u$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new YQ:new ZQ],["fullyVisible",()=>new kQ],["partiallyVisible",()=>new l$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=un(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Ln(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=un(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=en(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=_n(this.domBindings.rootDocument),new uee({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=_n(this.domBindings.rootDocument)),new see({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){ke(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function _ne(t,e){R$(t,e),e.add(t)}function ol(t,e,n){R$(t,e),e.set(t,n)}function R$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e){return t.get(Ki(t,e))}function Gi(t,e,n){return t.set(Ki(t,e),n),n}function Ki(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kI=23;var _o=new WeakMap,Ps=new WeakMap,iT=new WeakMap,RR=new WeakMap,ga=new WeakMap,kd=new WeakMap,Of=new WeakMap,Io=new WeakSet;class Pne{constructor(e){_ne(this,Io),ol(this,_o,void 0),ol(this,Ps,void 0),ol(this,iT,void 0),ol(this,RR,void 0),ol(this,ga,!0),ol(this,kd,{}),ol(this,Of,{}),Gi(Ps,this,e.rootTable.parentElement.parentElement),Gi(RR,this,e.rootDocument)}isClassicTheme(){return Ot(ga,this)}getCSSVariableValue(e){var n;if(Ot(ga,this))return null;if(Ot(kd,this)[`--ht-${e}`])return Ot(kd,this)[`--ht-${e}`];const r=(n=Ki(Io,this,Ane).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Ki(Io,this,E$).call(this,`--ht-${e}`);if(r!==null)return Ot(kd,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=Ot(Of,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Ot(ga,this))return kI;const e=Ki(Io,this,xne).call(this);return!e&&ve(Ot(Ps,this),"ht-wrapper")?(tt(`The "${Ot(_o,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Gi(ga,this,!0),this.useTheme(),kI):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Ki(Io,this,$I).call(this),Gi(ga,this,!0),Gi(_o,this,e||void 0);return}e&&e!==Ot(_o,this)&&(Ot(_o,this)&&Ki(Io,this,Hne).call(this),Gi(_o,this,e),Gi(ga,this,!1),Ki(Io,this,Ine).call(this),Ki(Io,this,$I).call(this))}getThemeName(){return Ot(_o,this)}removeClassNames(){ve(Ot(Ps,this),Ot(_o,this))&&we(Ot(Ps,this),Ot(_o,this))}}function xne(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Ine(){we(Ot(Ps,this),/ht-theme-.*/g),q(Ot(Ps,this),Ot(_o,this))}function $I(){this.isClassicTheme()||Gi(iT,this,getComputedStyle(Ot(Ps,this)));const t=Ki(Io,this,One).call(this,["box-sizing","border-bottom-width"]);Ot(Of,this).td={...Ot(Of,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function One(t){const e=Ot(RR,this),n=Ot(Ps,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function Ane(t){const e=Math.ceil(parseFloat(Ki(Io,this,E$).call(this,t)));return Number.isNaN(e)?null:e}function E$(t){const e=Ot(iT,this).getPropertyValue(t);return e===""?null:e}function Hne(){Gi(Of,this,{}),Gi(kd,this,{}),Gi(ga,this,!0)}class Nne extends YE{constructor(e,n){super(e,new Tne(n)),this.stylesHandler=new Pne(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new rT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Mne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new lne(this.wtSettings.getSetting("selections")),this.wtEvent=new g$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Sne(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];ke(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),we(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!w$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class oT{constructor(e){e instanceof YE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new oT(n);return()=>r},this._wot=new Nne(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function LI(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Dne(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const kne=new Map([["mousedown",LI],["mouseover",Dne],["touchstart",LI]]);function FI(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;kne.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Vv(t)||t.type==="touchstart",isRightClick:ja(t)})}const T$=new WeakMap,sT=Symbol("rootInstance");function $ne(t){T$.set(t,!0)}function Lne(t){return t===sT}function Dp(t){return T$.has(t)}function Fne(t,e){M$(t,e),e.add(t)}function Qs(t,e,n){M$(t,e),e.set(t,n)}function M$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ea(t,e,n){return(e=Vne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vne(t){var e=Wne(t,"string");return typeof e=="symbol"?e:e+""}function Wne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rn(t,e){return t.get(Wc(t,e))}function wr(t,e,n){return t.set(Wc(t,e),n),n}function Wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var OC=new WeakMap,im=new WeakMap,om=new WeakMap,ls=new WeakMap,Ni=new WeakMap,AC=new WeakMap,HC=new WeakMap,Wu=new WeakMap,$d=new WeakSet;class Bne{constructor(e){Fne(this,$d),ea(this,"hot",void 0),ea(this,"eventManager",void 0),ea(this,"settings",void 0),ea(this,"THEAD",void 0),ea(this,"TBODY",void 0),ea(this,"_wt",void 0),ea(this,"activeWt",void 0),Qs(this,OC,0),Qs(this,im,0),ea(this,"postponedAdjustElementsSize",!1),Qs(this,om,!1),Qs(this,ls,void 0),Qs(this,Ni,void 0),Qs(this,AC,0),Qs(this,HC,0),Qs(this,Wu,null),this.hot=e,this.eventManager=new Ri(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Wc($d,this,Une).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),wr(Ni,this,n.createElement("TABLE")),q(rn(Ni,this),"htCore"),this.hot.getSettings().tableClassName&&q(rn(Ni,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(be(rn(Ni,this),[As()]),be(e,[f8(),fk(-1),Hv(this.hot.countCols()),_8()])),this.THEAD=n.createElement("THEAD"),rn(Ni,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),rn(Ni,this).appendChild(this.TBODY),this.hot.table=rn(Ni,this),this.hot.container.insertBefore(rn(Ni,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{wr(om,this,!0),this.isTextSelectionAllowed(a.target)||(hR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{wr(om,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{rn(om,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&hR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&Vv(a)&&r.finish(),wr(ls,this,!1);const l=$v(n.activeElement);Gd(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!ja(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&ja(a)&&(r.finish(),wr(ls,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),wr(ls,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(rn(ls,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=_n(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=au(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=au(s);this.eventManager.addEventListener(rn(Ni,this),"selectstart",a=>{this.settings.fragmentSelection||Gd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&we(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:rn(Ni,this),isDataViewInstance:()=>Dp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),wr(im,this,o.length),this.hot.getSettings().ariaTags&&Wc($d,this,_$).call(this)===this.hot.countCols()&&Wc($d,this,jne).call(this,rn(im,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),wr(OC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,v,f),this.hot.runHooks("afterRenderer",a,l,u,g,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&lu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,wr(ls,this,!0),wr(Wu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ba(o)&&(FI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,wr(ls,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ba(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ba(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ba(o)&&(rn(ls,this)&&(!rn(Wu,this)||rn(Wu,this).x!==o.clientX||rn(Wu,this).y!==o.clientY)&&FI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,wr(Wu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ba(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,v,y,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new oT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Gd(e))return!0;const n=Da(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return rn(ls,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ve(r,"relative")){Ko(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(Ko(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(be(a,...As()),be(l,...As())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?_u(e,r(n,i)):(Ba(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){wr(AC,this,e),wr(HC,this,n)}getLastSize(){return{width:rn(AC,this),height:rn(HC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return rn(OC,this)}getRowHeadersCount(){return rn(im,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function _$(){return parseInt(this.hot.rootElement.getAttribute(Hv()[0]),10)}function jne(t){const e=Wc($d,this,_$).call(this)+t;be(this.hot.rootElement,...Hv(e))}function Une(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):we(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):we(t,"htHasScrollX")}var zne=Ct,Yne=yn,Gne=ch,Kne=Dr,qne=bn,Xne=Jo,Jne=ti,Zne=Ga,NC=Zne("every",TypeError);zne({target:"Iterator",proto:!0,real:!0,forced:NC},{every:function(e){qne(this);try{Kne(e)}catch(i){Jne(this,"throw",i)}if(NC)return Yne(NC,this,e);var n=Xne(this),r=0;return!Gne(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const P$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",ER=P$.length;function zv(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%ER,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/ER,10);return n}function Qne(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=ER**r*(P$.indexOf(t[n])+1);return e-=1,e}function ere(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(zv(i)+(r+1));n.push(o)}return n}function tre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=zv(i)+(r+1);n.push(o)}return n}function nre(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function aT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function lT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&De(t[0])&&(e=Fv(t[0]))),e}function x$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function I$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const rre=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:lT,createEmptySpreadsheetData:nre,createSpreadsheetData:ere,createSpreadsheetObjectData:tre,dataRowToChangesArray:aT,isArrayOfArrays:x$,isArrayOfObjects:I$,spreadsheetColumnIndex:Qne,spreadsheetColumnLabel:zv},Symbol.toStringTag,{value:"Module"}));function Gh(t,e,n){return(e=ire(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ire(t){var e=ore(t,"string");return typeof e=="symbol"?e:e+""}function ore(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Gh(this,"hot",void 0),Gh(this,"data",void 0),Gh(this,"dataType","array"),Gh(this,"colToProp",()=>{}),Gh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return M(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(De(a)||lt(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Ap(l,d,f):l[d]=f}})}else ke(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Ap(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Hr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Ap(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?kk(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Hr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return lT(this.data)}destroy(){this.data=null,this.hot=null}}var are=Ct,lre=yn,ure=ch,cre=Dr,hre=bn,dre=Jo,fre=ti,gre=Ga,DC=gre("some",TypeError);are({target:"Iterator",proto:!0,real:!0,forced:DC},{some:function(e){hre(this);try{cre(e)}catch(i){fre(this,"throw",i)}if(DC)return lre(DC,this,e);var n=dre(this),r=0;return ure(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function VI(t,e,n){return(e=mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mre(t){var e=pre(t,"string");return typeof e=="symbol"?e:e+""}function pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;VI(this,"indexedValues",[]),VI(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,lt(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}gt(Pu,Fn);function uT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>lt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function cT(t,e){return Va(t,(n,r)=>e.includes(r)===!1)}class Ka extends Pu{insert(e,n){this.indexedValues=uT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=cT(this.indexedValues,e),super.remove(e)}}class Yv extends Ka{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Sn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function hT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Af(t,e){return Va(t,n=>e.includes(n)===!1)}function dT(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function fT(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function wre(t,e,n){return(e=vre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vre(t){var e=yre(t,"string");return typeof e=="symbol"?e:e+""}function yre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gv extends Pu{constructor(){super(...arguments),wre(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Af(this.orderOfIndexes,[e]),lt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=uT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=fT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=cT(this.indexedValues,e),this.orderOfIndexes=Af(this.orderOfIndexes,e),this.orderOfIndexes=dT(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class vg extends Ka{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Sn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const WI=new Map([["indexesSequence",{getListWithInsertedItems:hT,getListWithRemovedItems:Af}],["physicallyIndexed",{getListWithInsertedItems:uT,getListWithRemovedItems:cT}]]),O$=t=>{if(WI.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return WI.get(t)};class A$ extends Pu{constructor(){super(e=>e)}insert(e,n){const r=fT(this.indexedValues,n);this.indexedValues=hT(r,e,n),super.insert(e,n)}remove(e){const n=Af(this.indexedValues,e);this.indexedValues=dT(n,e),super.remove(e)}}const BI=new Map([["hiding",Yv],["index",Pu],["linkedPhysicalIndexToValue",Gv],["physicalIndexToValue",Ka],["trimming",vg]]);function Cre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!BI.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(BI.get(t))(e)}function bre(t,e,n){return(e=Sre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sre(t){var e=Rre(t,"string");return typeof e=="symbol"?e:e+""}function Rre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let TR=0;class gT{constructor(){bre(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),TR+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),TR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ht(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}gt(gT,Fn);function Ere(){return TR}function kC(t,e,n){return(e=Tre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tre(t){var e=Mre(t,"string");return typeof e=="symbol"?e:e+""}function Mre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jI extends gT{constructor(e,n){super(),kC(this,"mergedValuesCache",[]),kC(this,"aggregationFunction",void 0),kC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function _re(t,e,n){Pre(t,e),e.set(t,n)}function Pre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xre(t,e,n){return t.set(H$(t,e),n),n}function Ire(t,e){return t.get(H$(t,e))}function H$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $C=new WeakMap;class N${constructor(){_re(this,$C,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Ire($C,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){xre($C,this,e)}}gt(N$,Fn);function UI(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Kh(t,e,n){Ore(t,e),e.set(t,n)}function Ore(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ui(t,e){return t.get(D$(t,e))}function sm(t,e,n){return t.set(D$(t,e),n),n}function D$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var am=new WeakMap,qh=new WeakMap,lm=new WeakMap,um=new WeakMap,cm=new WeakMap;class Are{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Kh(this,am,new Set),Kh(this,qh,[]),Kh(this,lm,[]),Kh(this,um,!1),Kh(this,cm,!1),sm(cm,this,e??!1)}createObserver(){const e=new N$;return ui(am,this).add(e),e.addLocalHook("unsubscribe",()=>{ui(am,this).delete(e)}),e._writeInitialChanges(UI(ui(qh,this),ui(lm,this))),e}emit(e){let n=ui(lm,this);(!ui(um,this)||ui(qh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(ui(cm,this)):sm(qh,this,new Array(e.length).fill(ui(cm,this))),ui(um,this)||(sm(um,this,!0),n=ui(qh,this)));const r=UI(n,e);ui(am,this).forEach(i=>i._write(r)),sm(lm,this,e)}}function nr(t,e,n){return(e=Hre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hre(t){var e=Nre(t,"string");return typeof e=="symbol"?e:e+""}function Nre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MR{constructor(){nr(this,"indexesSequence",new A$),nr(this,"trimmingMapsCollection",new jI(e=>e.some(n=>n===!0),!1)),nr(this,"hidingMapsCollection",new jI(e=>e.some(n=>n===!0),!1)),nr(this,"variousMapsCollection",new gT),nr(this,"hidingChangesObservable",new Are({initialIndexValue:!1})),nr(this,"notTrimmedIndexesCache",[]),nr(this,"notHiddenIndexesCache",[]),nr(this,"isBatched",!1),nr(this,"indexesSequenceChanged",!1),nr(this,"indexesChangeSource",void 0),nr(this,"trimmedIndexesChanged",!1),nr(this,"hiddenIndexesChanged",!1),nr(this,"renderablePhysicalIndexesCache",[]),nr(this,"fromPhysicalToVisualIndexesCache",new Map),nr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,Cre(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof vg?this.trimmingMapsCollection.register(e,n):n instanceof Yv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Af(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(hT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}gt(MR,Fn);function Dre(t,e){return ke(e,(n,r)=>{Ht(t[r])&&(t[r]=n)}),t}function k$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function $$(t){le(t)&&kE(ct`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function kre(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:$re,getValues:Lre}=ao("phraseFormatters");function Fre(t,e){$re(t,e)}function Vre(){return Lre()}Fre("pluralize",kre);const L$="ContextMenu:items",Ie=L$,mT=`${Ie}.noItems`,pT=`${Ie}.insertRowAbove`,wT=`${Ie}.insertRowBelow`,vT=`${Ie}.insertColumnOnTheLeft`,yT=`${Ie}.insertColumnOnTheRight`,CT=`${Ie}.removeRow`,bT=`${Ie}.removeColumn`,ST=`${Ie}.undo`,RT=`${Ie}.redo`,_w=`${Ie}.readOnly`,ET=`${Ie}.clearColumn`,TT=`${Ie}.copy`,MT=`${Ie}.copyWithHeaders`,_T=`${Ie}.copyWithGroupHeaders`,PT=`${Ie}.copyHeadersOnly`,xT=`${Ie}.cut`,IT=`${Ie}.freezeColumn`,OT=`${Ie}.unfreezeColumn`,AT=`${Ie}.mergeCells`,HT=`${Ie}.unmergeCells`,NT=`${Ie}.addComment`,DT=`${Ie}.editComment`,kT=`${Ie}.removeComment`,$T=`${Ie}.readOnlyComment`,LT=`${Ie}.align`,FT=`${Ie}.align.left`,VT=`${Ie}.align.center`,WT=`${Ie}.align.right`,BT=`${Ie}.align.justify`,jT=`${Ie}.align.top`,UT=`${Ie}.align.middle`,zT=`${Ie}.align.bottom`,YT=`${Ie}.borders`,GT=`${Ie}.borders.top`,KT=`${Ie}.borders.right`,qT=`${Ie}.borders.bottom`,XT=`${Ie}.borders.left`,JT=`${Ie}.borders.remove`,ZT=`${Ie}.nestedHeaders.insertChildRow`,QT=`${Ie}.nestedHeaders.detachFromParent`,eM=`${Ie}.hideColumn`,tM=`${Ie}.showColumn`,nM=`${Ie}.hideRow`,rM=`${Ie}.showRow`,gr="Filters:",Kt=`${gr}conditions`,Kv=`${Kt}.none`,iM=`${Kt}.isEmpty`,oM=`${Kt}.isNotEmpty`,sM=`${Kt}.isEqualTo`,aM=`${Kt}.isNotEqualTo`,lM=`${Kt}.beginsWith`,uM=`${Kt}.endsWith`,cM=`${Kt}.contains`,hM=`${Kt}.doesNotContain`,Wre=`${Kt}.byValue`,dM=`${Kt}.greaterThan`,fM=`${Kt}.greaterThanOrEqualTo`,gM=`${Kt}.lessThan`,mM=`${Kt}.lessThanOrEqualTo`,pM=`${Kt}.isBetween`,wM=`${Kt}.isNotBetween`,vM=`${Kt}.after`,yM=`${Kt}.before`,CM=`${Kt}.today`,bM=`${Kt}.tomorrow`,SM=`${Kt}.yesterday`,RM=`${gr}labels.filterByCondition`,EM=`${gr}labels.filterByValue`,TM=`${gr}labels.conjunction`,qv=`${gr}labels.disjunction`,Pw=`${gr}values.blankCells`,MM=`${gr}buttons.selectAll`,_M=`${gr}buttons.clear`,PM=`${gr}buttons.ok`,xM=`${gr}buttons.cancel`,IM=`${gr}buttons.placeholder.search`,OM=`${gr}buttons.placeholder.value`,AM=`${gr}buttons.placeholder.secondValue`,HM="CheckboxRenderer:",NM=`${HM}checked`,DM=`${HM}unchecked`,Bre=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:NM,CHECKBOX_RENDERER_NAMESPACE:HM,CHECKBOX_UNCHECKED:DM,CONTEXTMENU_ITEMS_ADD_COMMENT:NT,CONTEXTMENU_ITEMS_ALIGNMENT:LT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:zT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:VT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:BT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:FT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:UT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:WT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:jT,CONTEXTMENU_ITEMS_BORDERS:YT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:qT,CONTEXTMENU_ITEMS_BORDERS_LEFT:XT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:KT,CONTEXTMENU_ITEMS_BORDERS_TOP:GT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:ET,CONTEXTMENU_ITEMS_COPY:TT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:PT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:_T,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:MT,CONTEXTMENU_ITEMS_CUT:xT,CONTEXTMENU_ITEMS_EDIT_COMMENT:DT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:IT,CONTEXTMENU_ITEMS_HIDE_COLUMN:eM,CONTEXTMENU_ITEMS_HIDE_ROW:nM,CONTEXTMENU_ITEMS_INSERT_LEFT:vT,CONTEXTMENU_ITEMS_INSERT_RIGHT:yT,CONTEXTMENU_ITEMS_MERGE_CELLS:AT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:QT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:ZT,CONTEXTMENU_ITEMS_NO_ITEMS:mT,CONTEXTMENU_ITEMS_READ_ONLY:_w,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:$T,CONTEXTMENU_ITEMS_REDO:RT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:JT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:bT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:kT,CONTEXTMENU_ITEMS_REMOVE_ROW:CT,CONTEXTMENU_ITEMS_ROW_ABOVE:pT,CONTEXTMENU_ITEMS_ROW_BELOW:wT,CONTEXTMENU_ITEMS_SHOW_COLUMN:tM,CONTEXTMENU_ITEMS_SHOW_ROW:rM,CONTEXTMENU_ITEMS_UNDO:ST,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:OT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:HT,CONTEXT_MENU_ITEMS_NAMESPACE:L$,FILTERS_BUTTONS_CANCEL:xM,FILTERS_BUTTONS_CLEAR:_M,FILTERS_BUTTONS_OK:PM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:IM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:AM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:OM,FILTERS_BUTTONS_SELECT_ALL:MM,FILTERS_CONDITIONS_AFTER:vM,FILTERS_CONDITIONS_BEFORE:yM,FILTERS_CONDITIONS_BEGINS_WITH:lM,FILTERS_CONDITIONS_BETWEEN:pM,FILTERS_CONDITIONS_BY_VALUE:Wre,FILTERS_CONDITIONS_CONTAINS:cM,FILTERS_CONDITIONS_EMPTY:iM,FILTERS_CONDITIONS_ENDS_WITH:uM,FILTERS_CONDITIONS_EQUAL:sM,FILTERS_CONDITIONS_GREATER_THAN:dM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:fM,FILTERS_CONDITIONS_LESS_THAN:gM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:mM,FILTERS_CONDITIONS_NAMESPACE:Kt,FILTERS_CONDITIONS_NONE:Kv,FILTERS_CONDITIONS_NOT_BETWEEN:wM,FILTERS_CONDITIONS_NOT_CONTAIN:hM,FILTERS_CONDITIONS_NOT_EMPTY:oM,FILTERS_CONDITIONS_NOT_EQUAL:aM,FILTERS_CONDITIONS_TODAY:CM,FILTERS_CONDITIONS_TOMORROW:bM,FILTERS_CONDITIONS_YESTERDAY:SM,FILTERS_DIVS_FILTER_BY_CONDITION:RM,FILTERS_DIVS_FILTER_BY_VALUE:EM,FILTERS_LABELS_CONJUNCTION:TM,FILTERS_LABELS_DISJUNCTION:qv,FILTERS_NAMESPACE:gr,FILTERS_VALUES_BLANK_CELLS:Pw},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const F$={languageCode:"en-US",[mT]:"No available options",[pT]:"Insert row above",[wT]:"Insert row below",[vT]:"Insert column left",[yT]:"Insert column right",[CT]:["Remove row","Remove rows"],[bT]:["Remove column","Remove columns"],[ST]:"Undo",[RT]:"Redo",[_w]:"Read only",[ET]:"Clear column",[LT]:"Alignment",[FT]:"Left",[VT]:"Center",[WT]:"Right",[BT]:"Justify",[jT]:"Top",[UT]:"Middle",[zT]:"Bottom",[IT]:"Freeze column",[OT]:"Unfreeze column",[YT]:"Borders",[GT]:"Top",[KT]:"Right",[qT]:"Bottom",[XT]:"Left",[JT]:"Remove border(s)",[NT]:"Add comment",[DT]:"Edit comment",[kT]:"Delete comment",[$T]:"Read-only comment",[AT]:"Merge cells",[HT]:"Unmerge cells",[TT]:"Copy",[MT]:["Copy with header","Copy with headers"],[_T]:["Copy with group header","Copy with group headers"],[PT]:["Copy header only","Copy headers only"],[xT]:"Cut",[ZT]:"Insert child row",[QT]:"Detach from parent",[eM]:["Hide column","Hide columns"],[tM]:["Show column","Show columns"],[nM]:["Hide row","Hide rows"],[rM]:["Show row","Show rows"],[Kv]:"None",[iM]:"Is empty",[oM]:"Is not empty",[sM]:"Is equal to",[aM]:"Is not equal to",[lM]:"Begins with",[uM]:"Ends with",[cM]:"Contains",[hM]:"Does not contain",[dM]:"Greater than",[fM]:"Greater than or equal to",[gM]:"Less than",[mM]:"Less than or equal to",[pM]:"Is between",[wM]:"Is not between",[vM]:"After",[yM]:"Before",[CM]:"Today",[bM]:"Tomorrow",[SM]:"Yesterday",[Pw]:"Blank cells",[RM]:"Filter by condition",[EM]:"Filter by value",[TM]:"And",[qv]:"Or",[MM]:"Select all",[_M]:"Clear",[PM]:"OK",[xM]:"Cancel",[IM]:"Search",[OM]:"Value",[AM]:"Second value",[NM]:"Checked",[DM]:"Unchecked"},jre=Bre,_R=F$.languageCode,{register:Ure,getItem:V$,hasItem:zre,getValues:Yre}=ao("languagesDictionaries");W$(F$);function W$(t,e){let n=t,r=e;return De(t)&&(r=t,n=r.languageCode),Gre(n,r),Ure(n,Qn(r)),Qn(r)}function Gre(t,e){t!==_R&&Dre(e,V$(_R))}function B$(t){return kM(t)?Qn(V$(t)):null}function kM(t){return zre(t)}function Kre(){return Yre()}function j$(t,e,n){const r=B$(t);if(r===null)return null;const i=r[e];if(Ht(i))return null;const o=qre(i,n);return Array.isArray(o)?o[0]:o}function qre(t,e){let n=t;return M(Vre(),r=>{n=r(t,e)}),n}function Xre(t){let e=k$(t);return kM(e)||(e=_R,$$(t)),e}function Jre(t,e,n){return(e=Zre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zre(t){var e=Qre(t,"string");return typeof e=="symbol"?e:e+""}function Qre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qs extends v${constructor(e,n){super(e,null),Jre(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function LC(t){let{activeHeaderClassName:e,...n}=t;return new qs({className:e,...n,selectionType:y$})}function eie(t){let{areaCornerVisible:e,...n}=t;return new qs({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:JE})}function tie(t){let{...e}=t;return new qs({className:"highlight",...e,selectionType:JE})}function nie(t){let{columnClassName:e,...n}=t;return new qs({className:e,...n,selectionType:tne})}function rie(t){let{cellCornerVisible:e,...n}=t;return new qs({className:"current",headerAttributes:[yE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Kd})}function iie(t){let{border:e,visualCellRange:n,...r}=t;return new qs({...e,...r,selectionType:nne},n)}function oie(t){let{...e}=t;return new qs({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Qte})}function zI(t){let{headerClassName:e,...n}=t;return new qs({className:e,...n,selectionType:XE})}function sie(t){let{rowClassName:e,...n}=t;return new qs({className:e,...n,selectionType:ene})}function aie(t,e){lie(t,e),e.add(t)}function lie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e,n){return(e=uie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uie(t){var e=cie(t,"string");return typeof e=="symbol"?e:e+""}function cie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function us(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mo=new WeakSet;class hie{constructor(e){aie(this,mo),vr(this,"options",void 0),vr(this,"layerLevel",0),vr(this,"focus",void 0),vr(this,"fill",void 0),vr(this,"layeredAreas",new Map),vr(this,"areas",new Map),vr(this,"rowHeaders",new Map),vr(this,"columnHeaders",new Map),vr(this,"activeRowHeaders",new Map),vr(this,"activeColumnHeaders",new Map),vr(this,"activeCornerHeaders",new Map),vr(this,"rowHighlights",new Map),vr(this,"columnHighlights",new Map),vr(this,"customSelections",[]),this.options=e,this.focus=rie(e),this.fill=oie(e)}isEnabledFor(e,n){let r=e;e===Kd&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return us(mo,this,cs).call(this,this.layeredAreas,eie)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return us(mo,this,cs).call(this,this.areas,tie)}getAreas(){return[...this.areas.values()]}createRowHeader(){return us(mo,this,cs).call(this,this.rowHeaders,zI)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return us(mo,this,cs).call(this,this.columnHeaders,zI)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return us(mo,this,cs).call(this,this.activeRowHeaders,LC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return us(mo,this,cs).call(this,this.activeColumnHeaders,LC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return us(mo,this,cs).call(this,this.activeCornerHeaders,LC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return us(mo,this,cs).call(this,this.rowHighlights,sie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return us(mo,this,cs).call(this,this.columnHighlights,nie)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(iie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),M(this.areas.values(),e=>void e.clear()),M(this.layeredAreas.values(),e=>void e.clear()),M(this.rowHeaders.values(),e=>void e.clear()),M(this.columnHeaders.values(),e=>void e.clear()),M(this.activeRowHeaders.values(),e=>void e.clear()),M(this.activeColumnHeaders.values(),e=>void e.clear()),M(this.activeCornerHeaders.values(),e=>void e.clear()),M(this.rowHighlights.values(),e=>void e.clear()),M(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function cs(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function YI(t,e,n){return(e=die(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function die(t){var e=fie(t,"string");return typeof e=="symbol"?e:e+""}function fie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gie{constructor(e){YI(this,"ranges",[]),YI(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function mie(t,e){U$(t,e),e.add(t)}function FC(t,e,n){U$(t,e),e.set(t,n)}function U$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(pn(t,e))}function hm(t,e,n){return t.set(pn(t,e),n),n}function pn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dm=new WeakMap,Rt=new WeakMap,eo=new WeakMap,En=new WeakSet;class PR{constructor(e,n){mie(this,En),FC(this,dm,void 0),FC(this,Rt,void 0),FC(this,eo,{x:0,y:0}),hm(dm,this,e),hm(Rt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Je(Rt,this).createCellCoords(e,n);let o=Je(dm,this).current().highlight;const s=Je(Rt,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=pn(En,this,z$).call(this),{row:h,col:d}=pn(En,this,KI).call(this,o),f=Je(Rt,this).fixedRowsBottom(),g=Je(Rt,this).minSpareRows(),v=Je(Rt,this).minSpareCols(),y=Je(Rt,this).autoWrapRow(),E=Je(Rt,this).autoWrapCol(),C=Je(Rt,this).createCellCoords(h+i.row,d+i.col);if(C.row>=c){const P=Hr(r&&g>0&&f===0),T=C.col+1,A=Je(Rt,this).createCellCoords(C.row-c,T>=u?T-u:T);this.runLocalHooks("beforeColumnWrap",P,pn(En,this,Bu).call(this,A),T>=u),P.value?this.runLocalHooks("insertRowRequire",Je(Rt,this).countRenderableRows()):E&&C.assign(A)}else if(C.row<0){const P=Hr(E),T=C.col-1,A=Je(Rt,this).createCellCoords(c+C.row,T<0?u+T:T);this.runLocalHooks("beforeColumnWrap",P,pn(En,this,Bu).call(this,A),T<0),E&&C.assign(A)}if(C.col>=u){const P=Hr(r&&v>0),T=C.row+1,A=Je(Rt,this).createCellCoords(T>=c?T-c:T,C.col-u);this.runLocalHooks("beforeRowWrap",P,pn(En,this,Bu).call(this,A),T>=c),P.value?this.runLocalHooks("insertColRequire",Je(Rt,this).countRenderableColumns()):y&&C.assign(A)}else if(C.col<0){const P=Hr(y),T=C.row-1,A=Je(Rt,this).createCellCoords(T<0?c+T:T,u+C.col);this.runLocalHooks("beforeRowWrap",P,pn(En,this,Bu).call(this,A),T<0),y&&C.assign(A)}const{rowDir:_,colDir:I}=pn(En,this,GI).call(this,C);a=_,l=I,o=pn(En,this,Bu).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Je(Rt,this).createCellCoords(e,n),i=Je(dm,this).current(),o=Je(Rt,this).visualToRenderableCoords(i.highlight),s=pn(En,this,VC).call(this,i.to.row,i.from.row),a=pn(En,this,WC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=pn(En,this,KI).call(this,i.highlight),f=Je(Rt,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),v=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const I=f.col-d;f.col=pn(En,this,WC).call(this,g.col,v.col)+I}else if(r.col>0&&a<=d&&f.col>d){const I=pn(En,this,WC).call(this,v.col,g.col),P=Math.max(f.col-I,1);f.col=I+P}if(r.row<0&&s>=h&&f.row<h){const I=f.row-h;f.row=pn(En,this,VC).call(this,g.row,y.row)+I}else if(r.row>0&&s<=h&&f.row>h){const I=pn(En,this,VC).call(this,y.row,g.row),P=Math.max(f.row-I,1);f.row=I+P}const{rowDir:E,colDir:C}=pn(En,this,GI).call(this,f);u=E,c=C;const _=pn(En,this,Bu).call(this,f);r.row===0&&r.col!==0?l.col=_.col:r.row!==0&&r.col===0?l.row=_.row:(l.row=_.row,l.col=_.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;hm(eo,this,{x:n,y:r})}resetOffsetSize(){hm(eo,this,{x:0,y:0})}}function GI(t){const{width:e,height:n}=pn(En,this,z$).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function z$(){return{width:Je(eo,this).x+Je(Rt,this).countRenderableColumns(),height:Je(eo,this).y+Je(Rt,this).countRenderableRows()}}function VC(t,e){const n=Je(Rt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Je(eo,this).y+n}function WC(t,e){const n=Je(Rt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Je(eo,this).x+n}function KI(t){const{row:e,col:n}=Je(Rt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Je(Rt,this).createCellCoords(Je(eo,this).y+e,Je(eo,this).x+n)}function Bu(t){const e=t.clone();return e.col=t.col-Je(eo,this).x,e.row=t.row-Je(eo,this).y,Je(Rt,this).renderableToVisualCoords(e)}gt(PR,Fn);const Xv=0,Jv=1,Y$=2,$M=3,pie=[$M,Y$],wie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],BC=Symbol("root"),qI=Symbol("child");function Zc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:BC;if(e!==BC&&e!==qI)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===BC;let i=Xv;if(n){const o=t[0];t.length===0?i=Jv:r&&o instanceof mg?i=$M:r&&Array.isArray(o)?i=Zc(o,qI):t.length>=2&&t.length<=4&&!t.some((a,l)=>!wie[l].includes(typeof a))&&(i=Y$)}return i}function Hf(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!pie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===$M;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ht(u)&&(u=a),Ht(c)&&(c=l),!r){const f=a,g=l,v=u,y=c;a=Math.min(f,v),l=Math.min(g,y),u=Math.max(f,v),c=Math.max(g,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function vie(t){const e=Zc(t.getSelected());if(e===Xv||e===Jv)return[];const n=Hf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Sn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function yie(t){const e=Zc(t.getSelected());if(e===Xv||e===Jv)return[];const n=Hf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Sn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function ju(t,e,n){Cie(t,e),e.set(t,n)}function Cie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sl(t,e,n){return(e=bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bie(t){var e=Sie(t,"string");return typeof e=="symbol"?e:e+""}function Sie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xt(t,e){return t.get(G$(t,e))}function po(t,e,n){return t.set(G$(t,e),n),n}function G$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wn=new WeakMap,al=new WeakMap,fm=new WeakMap,Xh=new WeakMap,gm=new WeakMap,Jh=new WeakMap;class K${constructor(e,n){var r=this;sl(this,"settings",void 0),sl(this,"tableProps",void 0),sl(this,"inProgress",!1),sl(this,"selectedRange",new gie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),sl(this,"highlight",void 0),ju(this,Wn,void 0),ju(this,al,void 0),sl(this,"selectedByRowHeader",new Set),sl(this,"selectedByColumnHeader",new Set),ju(this,fm,!1),ju(this,Xh,!1),ju(this,gm,"unknown"),ju(this,Jh,-1),this.settings=e,this.tableProps=n,this.highlight=new hie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[yE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),po(Wn,this,new PR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),po(al,this,new PR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),xt(Wn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),xt(Wn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),xt(Wn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),xt(Wn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),xt(Wn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),xt(Wn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),xt(Wn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),xt(Wn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),xt(al,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),xt(al,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){po(gm,this,e)}markEndSource(){po(gm,this,"unknown")}getSelectionSource(){return xt(gm,this)}setExpectedLayers(e){po(Jh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,po(Jh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ht(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();po(fm,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ht(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=xt(Jh,this)===-1||this.selectedRange.size()===xt(Jh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(M(this.highlight.getAreas(),g=>void g.clear()),M(this.highlight.getLayeredAreas(),g=>void g.clear()),M(this.highlight.getRowHeaders(),g=>void g.clear()),M(this.highlight.getColumnHeaders(),g=>void g.clear()),M(this.highlight.getActiveRowHeaders(),g=>void g.clear()),M(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),M(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),M(this.highlight.getRowHighlights(),g=>void g.clear()),M(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(JE,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(XE,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),_=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(C).commit(),d.add(y).commit(),f.add(C).commit()):(a.add(y).add(E).commit(),l.add(C).add(_).commit(),d.add(y).add(E).commit(),f.add(C).add(_).commit())}const g=!xt(Xh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!xt(Xh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Kd,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(po(fm,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?xt(Wn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):xt(Wn,this).resetOffsetSize(),this.setRangeStart(xt(Wn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?xt(Wn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):xt(Wn,this).resetOffsetSize(),this.setRangeEnd(xt(Wn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?xt(al,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):xt(al,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=xt(al,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ye(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ye(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ye(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ye(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ye(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ye(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Hr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&xt(fm,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;po(Xh,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ye(d.row,u,o-1),Ye(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),po(Xh,this,!1)}selectCells(e){var n=this;const r=Zc(e);if(r===Jv)return!1;if(r===Xv)throw new Error(ct`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Hf(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),M(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ye(r.row,u,s-1),g=Ye(r.col,Math.min(i,o),Math.max(i,o))):(f=Ye(r,u,s-1),g=i);const v=this.tableProps.createCellCoords(f,g),y=l===0?0:Ye(v.row,u,-1),E=s-1,C=this.tableProps.createCellCoords(y,i),_=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",C,_,v),C.row=y,_.row=E,this.setRangeStartOnly(C,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.runLocalHooks("afterSelectColumns",C,_,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ye(r.row,Math.min(e,n),Math.max(e,n)),d=Ye(r.col,a,o-1)):(h=e,d=Ye(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Ye(f.col,a,-1),v=o-1,y=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",y,E,f),y.col=g,E.col=v,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",y,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Ye(s.row,-1/0,e-1),col:Ye(s.col,-1/0,n-1)}),i.assign({row:Ye(i.row,-1/0,e-1),col:Ye(i.col,-1/0,n-1)}),o.assign({row:Ye(o.row,0,e-1),col:Ye(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(Kd,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Kd,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}gt(K$,Fn);const XI=/^(\r\n|\n\r|\r|\n)/,Rie=/^[^\t\r\n]+/,JI=/^\t/;function Eie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(JI))t=t.replace(JI,""),n+=1,e[r][n]="";else if(t.match(XI))t=t.replace(XI,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Rie);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Xd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ll(t,e,n){return(e=Tie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tie(t){var e=Mie(t,"string");return typeof e=="symbol"?e:e+""}function Mie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){ll(this,"hot",void 0),ll(this,"metaManager",void 0),ll(this,"tableMeta",void 0),ll(this,"dataSource",void 0),ll(this,"duckSchema",void 0),ll(this,"colToPropCache",void 0),ll(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Fv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(De(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return lT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&ke(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Xc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Qn(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},fg(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const v=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(v,n));const y=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",y,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];oR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return ik(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];oR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&ln(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Hr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Hr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&ln(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Pc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Pc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Xd(this.getRange(e,n,Pc.DESTINATION_RENDERER))}getCopyableText(e,n){return Xd(this.getRange(e,n,Pc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:_ie,getItem:Pie,hasItem:q$,getNames:xie,getValues:n0e}=ao("cellTypes");function LM(t){if(!q$(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Pie(t)}function ci(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Mr(t,n),r&&jr(t,r),i&&zl(t,i),_ie(t,e)}function Iie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!ln(e,t)}function Zv(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?LM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ke(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!De(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};ke(r,(o,s)=>{if(Iie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),cn(t,i)}function Oie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Dk(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function kp(t){return Number.isInteger(t)&&t>=0}function $p(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function mm(t){return t==null}const X$=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Gt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Gt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Lv(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function ZI(t,e,n){return(e=Aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aie(t){var e=Hie(t,"string");return typeof e=="symbol"?e:e+""}function Hie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nie(){return class{}}class Die{constructor(e){ZI(this,"metaCtor",Nie()),ZI(this,"meta",void 0),this.meta=this.metaCtor.prototype,cn(this.meta,X$()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;cn(this.meta,e),Zv(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function kie(t,e,n){return(e=$ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:e+""}function Lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fie{constructor(e){kie(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){cn(this.meta,e),Zv(this.meta,e,e)}}function pm(t,e,n){return(e=Vie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vie(t){var e=Wie(t,"string");return typeof e=="symbol"?e:e+""}function Wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xw{constructor(e){pm(this,"valueFactory",void 0),pm(this,"data",[]),pm(this,"index",[]),pm(this,"holes",new Set),this.valueFactory=e}obtain(e){$p(()=>kp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;$p(()=>kp(e)||mm(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=mm(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;$p(()=>kp(e)||mm(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(mm(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function QI(t,e,n){return(e=Bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bie(t){var e=jie(t,"string");return typeof e=="symbol"?e:e+""}function jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Uie=["data","width"];class zie{constructor(e){QI(this,"globalMeta",void 0),QI(this,"metas",new xw(()=>this._createMeta())),this.globalMeta=e,this.metas=new xw(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);cn(r,n),Zv(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Oie(this.globalMeta.getMetaConstructor(),Uie).prototype}}function eO(t,e,n){return(e=Yie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yie(t){var e=Gie(t,"string");return typeof e=="symbol"?e:e+""}function Gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kie{constructor(e){eO(this,"columnMeta",void 0),eO(this,"metas",new xw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);cn(i,r),Zv(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){$p(()=>kp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new xw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class J${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Die(e),this.tableMeta=new Fie(this.globalMeta),this.columnMeta=new zie(this.globalMeta),this.cellMeta=new Kie(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}gt(J$,Fn);function tO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Zn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":lt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Pc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let v,y=0,E=0;for(y=0,E=d.startRows;y<E;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Qn(g),t.push(v);else if(i.dataType==="array")v=Qn(g[0]),t.push(v);else{v=[];for(let C=0,_=d.startCols;C<_;C++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&be(i.rootElement,[fk(-1),Hv(i.countCols()+(i.view?i.countRowHeaders():0))])}function nO(t,e,n){return(e=qie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qie(t){var e=Xie(t,"string");return typeof e=="symbol"?e:e+""}function Xie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jie{constructor(e){var n=this;nO(this,"metaManager",void 0),nO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),oe.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=ln(e,"type")?e.type:null;let c=lt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Zie(t,e,n){Qie(t,e),e.set(t,n)}function Qie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jC(t,e,n){return(e=eoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eoe(t){var e=toe(t,"string");return typeof e=="symbol"?e:e+""}function toe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function noe(t,e){return t.get(roe(t,e))}function roe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rO=new WeakMap;class ioe{constructor(e){jC(this,"metaManager",void 0),jC(this,"usageTracker",new Set),jC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Zie(this,rO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,noe(rO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const Z$="gridDefault",qa="editorManager.handlingEditor",ooe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},soe="hooksRefRegisterer",Q$={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){M(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ke(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};es(Q$,"MIXIN_NAME",soe,{writable:!1,enumerable:!1});function Di(t,e,n){return(e=aoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aoe(t){var e=loe(t,"string");return typeof e=="symbol"?e:e+""}function loe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uoe="base",Zt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class wh{static get EDITOR_TYPE(){return uoe}constructor(e){Di(this,"hot",void 0),Di(this,"state",Zt.VIRGIN),Di(this,"_opened",!1),Di(this,"_fullEditMode",!1),Di(this,"_closeCallback",null),Di(this,"TD",null),Di(this,"row",null),Di(this,"col",null),Di(this,"prop",null),Di(this,"originalValue",null),Di(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Zt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Zt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Zt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Et(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Zt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Zt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Zt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Zt.FINISHED,this.discardEditor(s)}):(this.state=Zt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Zt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Zt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Zt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Zt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Zt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Ln(n),a=en(n),l=Ln(this.hot.rootElement),u=en(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,E=["master","inline_start"].includes(y)?d:0,C=["master","top","bottom"].includes(y)?f:0,_=s.top===l.top?0:1;let I=s.top-l.top-_-E,P=0;this.hot.isRtl()?P=o.innerWidth-s.left-a-g-1+C:P=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(y)&&(I+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(P+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const T=this.hot.hasColHeaders(),A=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),G=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),V=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(T&&A<=0||A===V)&&(I+=1),G<=0&&(P+=1);const X=i.rowsRenderCalculator.startPosition,ne=i.columnsRenderCalculator.startPosition,Q=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),pe=_n(this.hot.rootDocument);let et=n.offsetTop;if(["inline_start","master"].includes(y)&&(et+=X-te),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:K,wtTable:J}=r.bottomOverlay.clone;et+=K.getWorkspaceHeight()-J.getHeight()-pe}let Re=n.offsetLeft;this.hot.isRtl()?(Re>=0?Re=v.getWidth()-n.offsetLeft:Re=Math.abs(Re),Re+=ne-Q-a):["top","master","bottom"].includes(y)&&(Re+=ne-Q);const Ae=o.getComputedStyle(this.TD),ot=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Pn=parseInt(Ae[ot],10)>0?0:1,st=parseInt(Ae.borderTopWidth,10)>0?0:1,m=en(n)+Pn,w=un(n)+st,p=TE(c)?pe:0,O=ME(h)?pe:0,L=this.hot.view.maximumVisibleElementWidth(Re)-p+Pn,j=Math.max(this.hot.view.maximumVisibleElementHeight(et)-O+st,this.hot.view.getDefaultRowHeight());return{top:I,start:P,height:w,maxHeight:j,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}gt(wh,Q$);const coe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Zt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},hoe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},doe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},foe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},goe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),xi(e))}};function moe(){return[ooe,coe,hoe,doe,foe,goe]}const poe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},woe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},voe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},yoe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},Coe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},boe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Soe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Roe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Eoe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Toe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Moe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},_oe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},Poe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},xoe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Ioe(){return[poe,woe,voe,yoe,Coe,boe,Soe,Roe,Eoe,Toe,Moe,_oe,Poe,xoe]}const Ooe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Aoe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Hoe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},Noe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},Doe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},koe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},$oe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},Loe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},Foe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Voe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},Woe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Boe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},joe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},Uoe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},zoe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Yoe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Goe(){return[Ooe,Aoe,Hoe,Noe,Doe,koe,$oe,Loe,Foe,Voe,Woe,Boe,joe,Uoe,zoe,Yoe]}const Koe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},qoe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Xoe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Joe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Zoe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Qoe=[...moe(),...Ioe(),...Goe(),Koe,qoe,Xoe,Joe,Zoe];function eL(t){const e={};return Qoe.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function ese(t){const e=t.getShortcutManager().addContext("editor"),n=eL(t),r={group:qa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function tse(t){const e=t.getShortcutManager().addContext("grid"),n=eL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Z$};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:qa,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function nse(t){[tse,ese].forEach(e=>e(t))}function rse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=iO(t),i=iO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function iO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&be(n,[Tf("Focus catcher")]),n}function ise(t){const e=ose(t);let n;const{activate:r,deactivate:i}=rse(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:xR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:IR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Z$,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?xR(t):IR(t)),u(),!1;h.preventDefault()},position:"after"}])}function xR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function IR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function ose(t){return e=>{if(!e)return null;const n=xR(t),r=IR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function vh(t){Uo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Qv(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,v=f<=h,y=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:v&&y?r.highlight.row:v?f:y?g:E.row}}}function sse(t){return e=>{const n=Qv(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;vh(t.getCell(r?-1:0,n,!0))})}}function ase(){return()=>{}}function lse(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;vh(t.getCell(n,r,!0))})}}function use(t){return e=>{const n=Qv(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;vh(t.getCell(i,o,!0))})}}function cse(t){return e=>{const n=Qv(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;vh(t.getCell(i,o,!0))})}}function hse(t){return e=>{const n=Qv(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;vh(t.getCell(n,r?-1:0,!0))})}}function dse(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{vh(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function fse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=lse(t):e.isSelectedByCorner()?s=ase():e.isSelectedByRowHeader()?s=hse(t):e.isSelectedByColumnHeader()?s=sse(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=use(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=dse(t):e.getSelectedRange().size()>1&&(s=cse(t)),(o=s)===null||o===void 0||o(i)}}}const oO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),wm=t=>t.map(e=>{const n=e.toLowerCase();return oO.has(n)?oO.get(n):n}).sort().join("+"),gse=t=>t.split("+"),sO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),UC=t=>{let{which:e,key:n}=t;if(sO.has(e))return sO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},tL=Symbol("shortcut-context");function nL(t){return De(t)&&t.__kindOf===tL}const mse=t=>{const e=Bv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:v,position:y,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ht(c))throw new Error("You need to define the shortcut's group.");if(lt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ct`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(v)&&(C.relativeToGroup=v,C.position=y),nL(E)&&(C.forwardToContext=E),l.forEach(_=>{const I=wm(_);if(e.hasItem(I)){const T=e.getItem(I);let A=T.findIndex(G=>G.group===v);A!==-1?y==="before"?A-=1:A+=1:A=T.length,T.splice(A,0,C)}else e.addItem(I,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ke(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=wm(l);e.removeItem(u)};return{__kindOf:tL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=wm(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=wm(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(gse(h)):(d.length=0,d.push(...f))})}}};function pse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const wse=["meta","alt","shift","control"],Zh=pse(),Qh=[];let vm=0;function vse(t,e,n,r,i){const o=f=>wse.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),g&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||ba(f))return;const v=UC(f);let y=[];o(v)||(y=s(f));const E=[v].concat(y);!i(f,E)&&(Rw()&&y.includes("meta")||!Rw()&&y.includes("control"))&&i(f,[v].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=UC(f);o(g)&&Zh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=UC(f);o(g)&&Zh.release(g)}},c=()=>{Zh.releaseAll()};return{mount:()=>{let f=t;for(vm+=1;f;)vm===1&&(f.document.documentElement.addEventListener("keydown",l),Qh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Qh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=au(f)},unmount:()=>{let f=t;for(vm-=1;f;){if(vm===0){for(let g=0;g<Qh.length;g++){const{event:v,listener:y}=Qh[g];f.document.documentElement.removeEventListener(v,y)}Qh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=au(f)}},isPressed:f=>Zh.isPressed(f),releasePressedKeys:()=>Zh.releaseAll()}}const yse=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Bv({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const v=mse(g);return o.addItem(g,v),v},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(ct`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=nL(y)?y:u(y);let C=!1;if(!E.hasShortcut(v))return C;const _=E.getShortcuts(v);for(let I=0;I<_.length;I++){const{callback:P,runOnlyIf:T,preventDefault:A,stopPropagation:G,captureCtrl:U,forwardToContext:V}=_[I];if(T(g)===!0){if(h=U,C=P(g,v)===!1,h=!1,A&&g.preventDefault(),G&&(xi(g),g.stopPropagation()),C)break;V&&d(g,v,V)}}return C},f=vse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function aO(t){const{classNames:e}=vk(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let zC=null;const YC=new Map;function rL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Ri(o);let a,l,u,c,h,d,f=!0;Lne(i)&&$ne(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=Xre(e.language);const y=Object.fromEntries(Object.entries(e).filter(m=>{let[w]=m;return!(oe.getSingleton().isRegistered(w)||oe.getSingleton().isDeprecated(w))})),E=new J$(o,y,[Jie,ioe]),C=E.getTableMeta(),_=E.getGlobalMeta(),I=Bv();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),Dp(this)&&(uk(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${mE()}`,YC.set(this.guid,this),this.columnIndexMapper=new MR,this.rowIndexMapper=new MR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new sre(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getRenderableFromVisualIndex(w):w,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},T=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getVisualFromRenderableIndex(w):w,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},A=(m,w)=>{const p=w>m?1:-1,O=Math.min(m,w),L=Math.max(m,w),j=o.rowIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<O?null:j>=0?o.rowIndexMapper.getRenderableFromVisualIndex(j):j},G=(m,w)=>{const p=w>m?1:-1,O=Math.min(m,w),L=Math.max(m,w),j=o.columnIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<O?null:j>=0?o.columnIndexMapper.getRenderableFromVisualIndex(j):j};let U=new K$(C,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,w)=>o._createCellCoords(m,w),createCellRange:(m,w,p)=>o._createCellRange(m,w,p),visualToRenderableCoords:P,renderableToVisualCoords:T,findFirstNonHiddenRenderableRow:A,findFirstNonHiddenRenderableColumn:G,isDisabledCellSelection:(m,w)=>m<0||w<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,w).disableVisualSelection});this.selection=U;const V=m=>{let{hiddenIndexesChanged:w}=m;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("afterSetRangeEnd",(m,w)=>{const p=Hr(!1),O=this.selection.getSelectedRange(),{from:L,to:j}=O.current(),K=O.size()-1;this.runHooks("afterSelection",L.row,L.col,j.row,j.col,p,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),j.row,o.colToProp(j.col),p,K),w&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m);const J=U.isSelectedByRowHeader(),b=U.isSelectedByColumnHeader();J&&b?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(we(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):b?(we(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),U.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const w=Hr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const w=m.length-1,{from:p,to:O}=m[w];this.runHooks("afterSelectionEnd",p.row,p.col,O.row,O.col,w),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),O.row,o.colToProp(O.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const w=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const j=K=>{if(K.length===0)return[];const J=[...K];return J.sort((R,S)=>{let[$]=R,[x]=S;return $===x?0:$>x?1:-1}),Sn(J,(R,S)=>{let[$,x]=S;const N=R[R.length-1],[B,H]=N,D=B+H;if($<=D){const W=Math.max(x-(D-$),0);N[1]+=W}else R.push([$,x]);return R},[J[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(C.maxRows===K)return;const J=m==="insert_row_below"?"below":"above";w=w??(J==="below"?K:0);const{delta:b,startPhysicalIndex:R}=a.createRow(w,p,{source:O,mode:J});U.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";w=w??(S==="end"?o.countSourceCols():0);const{delta:$,startPhysicalIndex:x}=a.createCol(w,p,{source:O,mode:S});if($){if(Array.isArray(C.colHeaders)){const H=[o.toVisualColumn(x),0];H.length+=$,Array.prototype.splice.apply(C.colHeaders,H)}U.shiftColumns(o.toVisualColumn(x),$)}break;case"remove_row":const N=H=>{let D=0;M(H,W=>{let[F,Y]=W;const ae=Gt(F)?o.countRows()-1:Math.max(F-D,0);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeRow(F,Y,O))return;if(U.isSelected()){const{row:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+Y-1&&c.closeEditor(!0)}const _e=o.countRows(),Fe=C.fixedRowsTop;Fe>=ae+1&&(C.fixedRowsTop-=Math.min(Y,Fe-ae));const ze=C.fixedRowsBottom;ze&&ae>=_e-ze&&(C.fixedRowsBottom-=Math.min(Y,ze)),_e===0?U.deselect():O==="ContextMenu.removeRow"?U.refresh():U.shiftRows(F,-Y),D+=Y})};Array.isArray(w)?N(j(w)):N([[w,p]]);break;case"remove_col":const B=H=>{let D=0;M(H,W=>{let[F,Y]=W;const ae=Gt(F)?o.countCols()-1:Math.max(F-D,0);let ce=o.toPhysicalColumn(ae);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeCol(F,Y,O))return;if(U.isSelected()){const{col:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+Y-1&&c.closeEditor(!0)}o.countCols()===0?U.deselect():O==="ContextMenu.removeColumn"?U.refresh():U.shiftColumns(F,-Y);const ze=C.fixedColumnsStart;ze>=ae+1&&(C.fixedColumnsStart-=Math.min(Y,ze-ae)),Array.isArray(C.colHeaders)&&(typeof ce>"u"&&(ce=-1),C.colHeaders.splice(ce,Y)),D+=Y})};Array.isArray(w)?B(j(w)):B([[w,p]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=C.minRows,w=C.minSpareRows,p=C.minCols,O=C.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(w){const L=o.countEmptyRows(!0);if(L<w){const j=w-L,K=Math.min(j,C.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(p||O)&&(L=o.countEmptyCols(!0));let j=o.countCols();if(p&&!C.columns&&j<p){const K=p-j;L+=K,a.createCol(j,K,{source:"auto"})}if(O&&!C.columns&&o.dataType==="array"&&L<O){j=o.countCols();const K=O-L,J=Math.min(K,C.maxCols-j);a.createCol(j,J,{source:"auto"})}}},populateFromArray(m,w,p,O,L){let j,K,J,b;const R=[],S={},$=[],x=m.row,N=m.col;if(K=w.length,K===0)return!1;let B=0,H=0;switch(De(p)&&(B=p.col-N+1,H=p.row-x+1),L){case"shift_down":const D=jd(w),W=D.length,F=Math.max(W,B),Y=o.getData().slice(x),ae=jd(Y).slice(N,N+F);for(J=0;J<F;J+=1)if(J<W){for(j=0,K=D[J].length;j<H-K;j+=1)D[J].push(D[J][j%K]);J<ae.length?$.push(D[J].concat(ae[J])):$.push(D[J].concat(new Array(Y.length).fill(null)))}else $.push(D[J%W].concat(ae[J]));o.populateFromArray(x,N,jd($));break;case"shift_right":const ce=w.length,_e=Math.max(ce,H),Fe=o.getData().slice(x).map(_t=>_t.slice(N));for(j=0;j<_e;j+=1)if(j<ce){for(J=0,b=w[j].length;J<B-b;J+=1)w[j].push(w[j][J%b]);if(j<Fe.length)for(let _t=0;_t<Fe[j].length;_t+=1)w[j].push(Fe[j][_t]);else w[j].push(...new Array(Fe[0].length).fill(null))}else w.push(w[j%K].slice(0,_e).concat(Fe[j]));o.populateFromArray(x,N,w);break;case"overwrite":default:S.row=m.row,S.col=m.col;let ze=0,Me=0,Ve=!0,Mt;const Oi=function(gn){let bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Pt=w[gn%w.length];return bt!==null?Pt[bt%Pt.length]:Pt},ns=w.length,ri=p?p.row-m.row+1:0;for(p?K=ri:K=Math.max(ns,ri),j=0;j<K&&!(p&&S.row>p.row&&ri>ns||!C.allowInsertRow&&S.row>o.countRows()-1||S.row>=C.maxRows);j++){const _t=j-ze,gn=Oi(_t).length,bt=p?p.col-m.col+1:0;if(p?b=bt:b=Math.max(gn,bt),S.col=m.col,Mt=o.getCellMeta(S.row,S.col),(O==="CopyPaste.paste"||O==="Autofill.fill")&&Mt.skipRowOnPaste){ze+=1,S.row+=1,K+=1;continue}for(Me=0,J=0;J<b&&!(p&&S.col>p.col&&bt>gn||!C.allowInsertColumn&&S.col>o.countCols()-1||S.col>=C.maxCols);J++){if(Mt=o.getCellMeta(S.row,S.col),(O==="CopyPaste.paste"||O==="Autofill.fill")&&Mt.skipColumnOnPaste){Me+=1,S.col+=1,b+=1;continue}if(Mt.readOnly&&O!=="UndoRedo.undo"){S.col+=1;continue}const Pt=J-Me;let We=Oi(_t,Pt),ii=o.getDataAtCell(S.row,S.col);if(We!==null&&typeof We=="object")if(Array.isArray(We)&&ii===null&&(ii=[]),ii===null||typeof ii!="object")Ve=!1;else{const Xa=Xc(Array.isArray(ii)?ii:ii[0]||ii),Ja=Xc(Array.isArray(We)?We:We[0]||We);Lv(Xa,Ja)||Array.isArray(Xa)&&Array.isArray(Ja)?We=Qn(We):Ve=!1}else ii!==null&&typeof ii=="object"&&(Ve=!1);Ve&&R.push([S.row,S.col,We]),Ve=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,O||"populateFromArray");break}}};function X(m){const w=k$(m);kM(w)?(o.runHooks("beforeLanguageChange",w),_.language=w,o.runHooks("afterLanguageChange",w)):$$(m)}function ne(m,w){const p=m==="className"?o.rootElement:o.table;if(f)q(p,w);else{let O=[],L=[];_[m]&&(O=Array.isArray(_[m])?_[m]:aR(_[m])),w&&(L=Array.isArray(w)?w:aR(w));const j=sR(O,L),K=sR(L,O);j.length&&we(p,j),K.length&&q(p,K)}_[m]=w}this.init=function(){l.setData(C.data),o.runHooks("beforeInit"),(Bo()||NE())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Bne(this);const m=C.themeName||aO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=pR.getInstance(o,C,U),d=fse(o),h=new hZ(o),Dp(this)&&ise(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&_k(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function Q(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const w=m.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):m}function pe(m,w,p){if(!m.length){p();return}const O=o.getActiveEditor(),L=new Q;let j=!0;L.onQueueEmpty=()=>{O&&j&&O.cancelChanges(),p()};for(let K=m.length-1;K>=0;K--){const[J,b]=m[K],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(J,R):S={...Object.getPrototypeOf(C),...C},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function($,x){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&x.allowInvalid===!1&&(j=!1,m.splice($,1),x.valid=!0),L.removeValidatorFormQueue()}}(K,S),w))}L.checkIfQueueIsEmpty()}function et(m,w){for(let O=m.length-1;O>=0;O--){let L=!1;if(m[O]===null){m.splice(O,1);continue}if(!((m[O][2]===null||m[O][2]===void 0)&&(m[O][3]===null||m[O][3]===void 0))){if(C.allowInsertRow)for(;m[O][0]>o.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}if(o.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(m[O][1])>o.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}L||a.set(m[O][0],m[O][1],m[O][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,w),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,w||"edit");const O=o.getActiveEditor();O&&le(O.refreshValue)&&O.refreshValue()}else o.render()}this._createCellCoords=function(m,w){return o.view._wt.createCellCoords(m,w)},this._createCellRange=function(m,w,p){return o.view._wt.createCellRange(m,w,p)},this.validateCell=function(m,w,p,O){let L=o.getCellValidator(w);function j(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){p(K);return}const b=w.visualCol,R=w.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const $=o.rowIndexMapper.getRenderableFromVisualIndex(R),x=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",$,x,S)}p(K)}lk(L)&&(L=function(K){return function(J,b){b(K.test(J))}}(L)),lt(L)?(m=o.runHooks("beforeValidate",m,w.visualRow,w.prop,O),o._registerImmediate(()=>{L.call(w,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,w.visualRow,w.prop,O),w.valid=K,j(K),o.runHooks("postAfterValidate",K,m,w.visualRow,w.prop,O))})})):o._registerImmediate(()=>{w.valid=!0,j(w.valid,!1)})};function Re(m,w,p){return Array.isArray(m)?m:[[m,w,p]]}function Ae(m,w){const p=o.runHooks("beforeChange",m,w||"edit"),O=m.filter(j=>j!==null);if(p===!1||O.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let j=O.length-1;j>=0;j--){const[K,J,,b]=O[j],R=a.propToCol(J);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(C),...C};const{type:$,checkedTemplate:x,uncheckedTemplate:N}=S;if($==="numeric"&&typeof b=="string"&&r$(b)&&(O[j][3]=te(b)),$==="checkbox"){const B=Et(b),H=B===Et(x),D=B===Et(N);(H||D)&&(O[j][3]=H?x:N)}}return O}this.setDataAtCell=function(m,w,p,O){const L=Re(m,w,p),j=[];let K=O,J,b,R;for(J=0,b=L.length;J<b;J++){if(typeof L[J]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[J][1]>=this.countCols()?R=L[J][1]:R=a.colToProp(L[J][1]),j.push([L[J][0],R,l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]])}!K&&typeof m=="object"&&(K=w);const S=Ae(j,K);o.runHooks("afterSetDataAtCell",S,K),pe(S,K,()=>{et(S,K)})},this.setDataAtRowProp=function(m,w,p,O){const L=Re(m,w,p),j=[];let K=O,J,b;for(J=0,b=L.length;J<b;J++)j.push([L[J][0],L[J][1],l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]]);!K&&typeof m=="object"&&(K=w);const R=Ae(j,O);o.runHooks("afterSetDataAtRowProp",R,K),pe(R,K,()=>{et(R,K)})},this.listen=function(){o&&!o.isListening()&&(YC.forEach(m=>{o!==m&&m.unlisten()}),zC=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(zC=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return zC===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),w&&U.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,w,p,O,L,j,K){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const J=typeof O=="number"?o._createCellCoords(O,L):null;return u.populateFromArray(o._createCellCoords(m,w),p,J,j,K)},this.spliceCol=function(m,w,p){for(var O=arguments.length,L=new Array(O>3?O-3:0),j=3;j<O;j++)L[j-3]=arguments[j];return a.spliceCol(m,w,p,...L)},this.spliceRow=function(m,w,p){for(var O=arguments.length,L=new Array(O>3?O-3:0),j=3;j<O;j++)L[j-3]=arguments[j];return a.spliceRow(m,w,p,...L)},this.getSelected=function(){if(U.isSelected())return Ue(U.getSelectedRange(),m=>{let{from:w,to:p}=m;return[w.row,w.col,p.row,p.col]})},this.getSelectedLast=function(){const m=this.getSelected();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.emptySelectedCells=function(m){if(!U.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];M(U.getSelectedRange(),p=>{if(p.isSingleHeader())return;const O=p.getTopStartCorner(),L=p.getBottomEndCorner();fe(O.row,L.row,j=>{fe(O.col,L.col,K=>{this.getCellMeta(j,K).readOnly||w.push([j,K,null])})})}),w.length>0&&this.setDataAtCell(w,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const w=m();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=m();return this.resumeExecution(w),p},this.batch=function(m){this.suspendRender(),this.suspendExecution();const w=m();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:w,height:p}=m.getLastSize(),{width:O,height:L}=o.rootElement.getBoundingClientRect(),j=O!==w||L!==p;o.runHooks("beforeRefreshDimensions",{width:w,height:p},{width:O,height:L},j)!==!1&&((j||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(O,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:w,height:p},{width:O,height:L},j))},this.updateData=function(m,w){tO(m,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),U.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:E,firstRun:f})},this.loadData=function(m,w){tO(m,p=>{a=p},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),U.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=C.columns;let w=0;if(Array.isArray(m))w=m.length;else if(lt(m))if(o.dataType==="array"){const p=this.countSourceCols();for(let O=0;O<p;O+=1)m(O)&&(w+=1)}else(o.dataType==="object"||o.dataType==="function")&&(w=a.colToPropCache.length);else if(le(C.dataSchema)){const p=a.getSchema();w=Array.isArray(p)?p.length:Fv(p)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,w,p,O){return Ht(m)?a.getAll():a.getRange(o._createCellCoords(m,w),o._createCellCoords(p,O),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,w,p,O){return a.getCopyableText(o._createCellCoords(m,w),o._createCellCoords(p,O))},this.getCopyableData=function(m,w){return a.getCopyable(m,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(f?o.loadData:o.updateData).bind(this);let O=!1,L,j;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&X(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")ne("className",m.className);else if(L==="tableClassName"&&o.table)ne("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(oe.getSingleton().isRegistered(L)||oe.getSingleton().isDeprecated(L)){const S=m[L];lt(S)?(oe.getSingleton().addAsFixed(L,S,o),C[L]=S):Array.isArray(S)&&(oe.getSingleton().add(L,S,o),C[L]=S)}else!w&&ln(m,L)&&(_[L]=m[L]);m.data===void 0&&C.data===void 0?p(null,"updateSettings"):m.data!==void 0?p(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),J=C.columns;if(J&&lt(J)&&(O=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),K>0)for(L=0,j=0;L<K;L++){if(J){const S=O?J(L):J[j];S&&E.updateColumnMeta(j,S)}j+=1}le(m.cell)&&ke(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(lt(R)&&(R=R()),w&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;lt(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!w){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),$=ln(m,"themeName");S&&$&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const x=$&&m.themeName||aO(o.rootElement);o.useTheme(x),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!w&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(C.getValue){if(lt(C.getValue))return C.getValue.call(o);if(m)return o.getData()[m[0][0]][C.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,w,p,O,L){u.alter(m,w,p,O,L)},this.getCell=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=w,L=m;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;O=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||O===null||L===void 0||O===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,O),p)},this.getCoords=function(m){const w=this.view._wt.wtTable.getCoords(m);if(w===null)return null;const{row:p,col:O}=w;let L=p,j=O;return p>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(p)),O>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(O)),o._createCellCoords(L,j)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,w){return a.get(m,a.colToProp(w))},this.getDataAtRowProp=function(m,w){return a.get(m,w)},this.getDataAtCol=function(m){const w=[],p=a.getRange(o._createCellCoords(0,m),o._createCellCoords(C.data.length-1,m),a.DESTINATION_RENDERER);for(let O=0;O<p.length;O+=1)for(let L=0;L<p[O].length;L+=1)w.push(p[O][L]);return w},this.getDataAtProp=function(m){const w=[],p=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(C.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let O=0;O<p.length;O+=1)for(let L=0;L<p[O].length;L+=1)w.push(p[O][L]);return w},this.getSourceData=function(m,w,p,O){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,O)),L},this.getSourceDataArray=function(m,w,p,O){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,O),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,w,p,O){const L=Re(m,w,p),j=this.hasHook("afterSetSourceDataAtCell"),K=[];j&&M(L,b=>{let[R,S,$]=b;K.push([R,S,l.getAtCell(R,S),$])}),M(L,b=>{let[R,S,$]=b;l.setAtCell(R,S,$)}),j&&this.runHooks("afterSetSourceDataAtCell",K,O),this.render();const J=o.getActiveEditor();J&&le(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,w){return l.getAtCell(m,w)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,w,p,O){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,w,p,O],[j,K]=L;let[,,J,b]=L,R=null,S=null;J===void 0&&(J=j),b===void 0&&(b=K);let $="mixed";return fe(Math.max(Math.min(j,J),0),Math.max(j,J),x=>{let N=!0;return fe(Math.max(Math.min(K,b),0),Math.max(K,b),B=>(S=this.getCellMeta(x,B).type,R?N=R===S:R=S,N)),$=N?S:"mixed",N}),$},this.removeCellMeta=function(m,w,p){const[O,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(w)];let j=E.getCellMetaKeyValue(O,L,p);o.runHooks("beforeRemoveCellMeta",m,w,p,j)!==!1&&(E.removeCellMeta(O,L,p),o.runHooks("afterRemoveCellMeta",m,w,p,j)),j=null},this.spliceCellsMeta=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,O=new Array(p>2?p-2:0),L=2;L<p;L++)O[L-2]=arguments[L];if(O.length>0&&!Array.isArray(O[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&E.removeRow(this.toPhysicalRow(m),w),O.length>0&&M(O.reverse(),j=>{E.createRow(this.toPhysicalRow(m)),M(j,(K,J)=>this.setCellMetaObject(m,J,K))}),o.render()},this.setCellMetaObject=function(m,w,p){typeof p=="object"&&ke(p,(O,L)=>{this.setCellMeta(m,w,L,O)})},this.setCellMeta=function(m,w,p,O){if(o.runHooks("beforeSetCellMeta",m,w,p,O)===!1)return;let j=m,K=w;m<this.countRows()&&(j=this.toPhysicalRow(m)),w<this.countCols()&&(K=this.toPhysicalColumn(w)),E.setCellMeta(j,K,p,O),o.runHooks("afterSetCellMeta",m,w,p,O)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},O=this.toPhysicalRow(m),L=this.toPhysicalColumn(w);return O===null&&(O=m),L===null&&(L=w),E.getCellMeta(O,L,{visualRow:m,visualColumn:w,...p})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||C.columns)},this.getCellRenderer=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).renderer:m.renderer;return typeof p=="string"?Mw(p):Ht(p)?Mw("text"):p},this.getCellEditor=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).editor:m.editor;return typeof p=="string"?Tw(p):Ht(p)?Tw("text"):p},this.getCellValidator=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).validator:m.validator;return typeof p=="string"?jE(p):p},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,w){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,m)},this.validateColumns=function(m,w){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,m)},this._validateCells=function(m,w,p){const O=new Q;m&&(O.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(w!==void 0&&w.indexOf(L)===-1){L-=1;continue}let j=o.countCols()-1;for(;j>=0;){if(p!==void 0&&p.indexOf(j)===-1){j-=1;continue}O.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,j),o.getCellMeta(L,j),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(O.valid=!1),O.removeValidatorFormQueue()},"validateCells"),j-=1}L-=1}O.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let w=C.rowHeaders,p=m;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(w=[],fe(o.countRows()-1,O=>{w.push(o.getRowHeader(O))})):Array.isArray(w)&&w[p]!==void 0?w=w[p]:lt(w)?w=w(p):w&&typeof w!="string"&&typeof w!="number"&&(w=p+1),w},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let m=0,w=o.countCols();m<w;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",m);if(p===void 0){const J=[],b=o.countCols();for(let R=0;R<b;R++)J.push(o.getColHeader(R));return J}let O=C.colHeaders;const L=function(J){const b=[],R=o.countCols();let S=0;for(;S<R;S++)lt(C.columns)&&C.columns(S)&&b.push(S);return b[J]},j=o.toPhysicalColumn(p),K=L(j);return C.colHeaders===!1?O=null:C.columns&&lt(C.columns)&&C.columns(K)&&C.columns(K).title?O=C.columns(K).title:C.columns&&C.columns[j]&&C.columns[j].title?O=C.columns[j].title:Array.isArray(C.colHeaders)&&C.colHeaders[j]!==void 0?O=C.colHeaders[j]:lt(C.colHeaders)?O=C.colHeaders(j):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(O=zv(p)),O=o.runHooks("modifyColumnHeaderValue",O,m,w),O},this._getColWidthFromSettings=function(m){let w;if(m>=0&&(w=o.getCellMeta(0,m).width),(w===void 0||w===C.width)&&(w=C.colWidths),w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(m,w){let p=o._getColWidthFromSettings(m);return p=o.runHooks("modifyColWidth",p,m,w),p===void 0&&(p=Jc),p},this._getRowHeightFromSettings=function(m){const w=this.view.getDefaultRowHeight();let p=C.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<w?w:p},this.getRowHeight=function(m,w){let p=o._getRowHeightFromSettings(m);return p=o.runHooks("modifyRowHeight",p,m,w),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=C.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,w)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return yR(o.countRows()-1,p=>{if(o.isEmptyRow(p))w+=1;else if(m===!0)return!1}),w},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return yR(o.countCols()-1,p=>{if(o.isEmptyCol(p))w+=1;else if(m===!0)return!1}),w},this.isEmptyRow=function(m){return C.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return C.isEmptyCol.call(o,m)},this.selectCell=function(m,w,p,O){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ht(m)||Ht(w)?!1:this.selectCells([[m,w,p,O]],L,j)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const O=U.selectCells(m);return O&&p&&o.listen(),d.resume(),O},this.selectColumns=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectColumns(m,w,p)},this.selectRows=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectRows(m,w,p)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),U.selectAll(m,w,p)};const ot=(m,w)=>m.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(m,w){if(typeof m=="number"){var p;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:O,col:L,considerHiddenIndexes:j}=m??{};let K=O,J=L;if(lt(w)&&this.addHookOnce("afterScroll",w),j===void 0||j){const $=Number.isInteger(O)&&O>=0,x=Number.isInteger(L)&&L>=0,N=$?ot(this.rowIndexMapper,O):void 0,B=x?ot(this.columnIndexMapper,L):void 0;if(N===null||B===null)return!1;K=$?o.rowIndexMapper.getRenderableFromVisualIndex(N):O,J=x?o.columnIndexMapper.getRenderableFromVisualIndex(B):L}const b=Number.isInteger(K),R=Number.isInteger(J);let S=!1;return b&&K>=0&&R&&J>=0?S=o.view.scrollViewport(o._createCellCoords(K,J),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(R&&J<0||!R)?S=o.view.scrollViewportVertically(K,m.verticalSnap):R&&J>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(J,m.horizontalSnap)),lt(w)&&(S?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;lt(m)&&this.addHookOnce("afterScroll",m);const{highlight:w}=this.getSelectedRangeLast(),p=this.scrollViewportTo(w.toObject());return p?this.view.render():lt(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),p},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),YC.delete(this.guid),Dp(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}Ko(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),I.getItems().forEach(m=>{let[,w]=m;w.destroy()}),I.clear(),o.runHooks("afterDestroy")},!0),oe.getSingleton().destroy(o),ke(o,(m,w,p)=>{lt(m)?p[w]=Pn(w):w!=="guid"&&(p[w]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,U=null,c=null,o=null};function Pn(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return I.getItem(Zn(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,w,p){oe.getSingleton().add(m,w,o,p)},this.hasHook=function(m){return oe.getSingleton().has(m,o)||oe.getSingleton().has(m)},this.addHookOnce=function(m,w,p){oe.getSingleton().once(m,w,o,p)},this.removeHook=function(m,w){oe.getSingleton().remove(m,w,o)},this.runHooks=function(m,w,p,O,L,j,K){return oe.getSingleton().run(o,m,w,p,O,L,j,K)},this.getTranslatedPhrase=function(m,w){return j$(C.language,m,w)},this.toHTML=()=>wR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",wR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=m;typeof p=="function"&&(p=setTimeout(p,w)),this.timeouts.push(p)},this._clearTimeouts=function(){M(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){M(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const st=yse({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&st.releasePressedKeys()}),this.getShortcutManager=function(){return st},this.getFocusManager=function(){return h},BE().forEach(m=>{const w=gg(m);I.addItem(m,new w(this))}),nse(o),st.setActiveContextName("grid"),oe.getSingleton().run(o,"construct")}function lO(t,e,n){t.addEventListener(e,n,!1)}function uO(t,e,n){t.removeEventListener(e,n,!1)}function ym(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function iL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=ym(s).fontSize,o.style.fontFamily=ym(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=ym(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=ym(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+g+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>v?y.width=`${n.minWidth}px`:v>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${v}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?y.height=`${n.minHeight}px`:n.maxHeight<E?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(lO(s,"input",a),lO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){uO(s,"input",a),uO(s,"keydown",l)}}}function cO(t,e){const n=EE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}ug(e,i)}function ul(t,e,n){return(e=Cse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cse(t){var e=bse(t,"string");return typeof e=="symbol"?e:e+""}function bse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Sse="ht_editor_visible",Cm="ht_editor_hidden",hO="textEditor",Rse="text";class xu extends wh{static get EDITOR_TYPE(){return Rse}constructor(e){super(e),ul(this,"eventManager",new Ri(this)),ul(this,"autoResize",iL(this.hot.rootDocument)),ul(this,"TEXTAREA",void 0),ul(this,"textareaStyle",void 0),ul(this,"TEXTAREA_PARENT",void 0),ul(this,"textareaParentStyle",void 0),ul(this,"layerClass",void 0),this.eventManager=new Ri(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Yd(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Zt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Zt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),ug(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),be(this.TEXTAREA,[["data-hot-input",""],Eu(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Cm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){jk()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Cm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(ve(i,"handsontableEditor"))return n=!0,!1}),ve(this.TEXTAREA_PARENT,Cm)&&we(this.TEXTAREA_PARENT,Cm),n?(this.layerClass=Sse,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Zt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){HE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Zt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Zt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:hO},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;cO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;cO(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(hO)}}const Ese="base";function yg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(jx())):a&&c.push(jx()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(Ux())):(u.push(s.invalidCellClassName),a&&c.push(Ux()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),we(e,u),q(e,l),Mu(e,c),be(e,h)}yg.RENDERER_TYPE=Ese;const Tse="text";function Xs(t,e,n,r,i,o,s){yg.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Et(a),s.trimWhitespace&&(a=a.trim()),Ba(e,a)}Xs.RENDERER_TYPE=Tse;const Mse="text",oL={CELL_TYPE:Mse,editor:xu,renderer:Xs};ci(oL);Te.editors={BaseEditor:wh};function Te(t,e){const n=new rL(t,e||{},sT);return n.init(),n}Te.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new rL(t,e,sT)};Te.DefaultSettings=X$();Te.hooks=oe.getSingleton();Te.CellCoords=uu;Te.CellRange=mg;Te.packageName="handsontable";Te.buildDate="24/04/2025 10:59:00";Te.version="15.3.0";Te.languages={dictionaryKeys:jre,getLanguageDictionary:B$,getLanguagesDictionaries:Kre,registerLanguageDictionary:W$,getTranslatedPhrase:j$};const dO="handsontableEditor",_se="handsontable";class FM extends xu{static get EDITOR_TYPE(){return _se}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),ug(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&cn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:dO,relativeToGroup:qa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),xi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(dO)}}function Pse(t,e){sL(t,e),e.add(t)}function fO(t,e,n){sL(t,e),e.set(t,n)}function sL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bm(t,e,n){return(e=xse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xse(t){var e=Ise(t,"string");return typeof e=="symbol"?e:e+""}function Ise(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GC(t,e){return t.get(OR(t,e))}function OR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ose="autocomplete";var KC=new WeakMap,gO=new WeakMap,qC=new WeakSet;class VM extends FM{constructor(){super(...arguments),Pse(this,qC),bm(this,"query",null),bm(this,"strippedChoices",[]),bm(this,"rawChoices",[]),fO(this,KC,this.hot.guid.slice(0,9)),fO(this,gO,hg(()=>{this.focus()},100)),bm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=uR(Et(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return Ose}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[T8(),C8(),dk("listbox"),x8()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[Ci("false"),I8(`${GC(KC,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",GC(gO,this)),this.htEditor.updateSettings({colWidths:e?[en(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Xs(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:v,locale:y}=this.cellProperties,E=this.query;let C=Et(d),_,I;C&&!v&&(_=g===!0?C.indexOf(E):C.toLocaleLowerCase(y).indexOf(E.toLocaleLowerCase(y)),_!==-1&&(I=C.substr(_,E.length),C=C.replace(I,`<strong>${I}</strong>`))),n&&be(l,[b8(),...r?[N8(i)]:[],...r?[D8(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=C},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{be(h,[yE()]),be(this.TEXTAREA,...O8(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(be(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...As()),be(this.htEditor.rootElement,[hk(),A8("polite"),H8("text"),["id",`${GC(KC,this)}-listbox-${o}-${s}`]]),be(this.TEXTAREA,...Ci("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[Ci("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=EE(this.TEXTAREA),r=Mk(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(jd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),ug(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),OR(qC,this,mO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),OR(qC,this,mO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Et(o));return Ue(r,o=>n?o:uR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(Uk(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function mO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+_n(this.hot.rootDocument)})}const Ase="checkbox";class aL extends wh{static get EDITOR_TYPE(){return Ase}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ve(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const xa=()=>window,pi=()=>window.document,AR=(t,e)=>window.setTimeout(t,e),Po=function(t,e,n,r){t.addEventListener(e,n,!!r)},hs=function(t,e,n,r){t.removeEventListener(e,n,!!r)},Hse=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Br=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},XC=function(t,e){Br(t,e)||(t.className=t.className===""?e:t.className+" "+e)},JC=function(t,e){t.className=Hse((" "+t.className+" ").replace(" "+e+" "," "))},WM=function(t){return/Array/.test(Object.prototype.toString.call(t))},Yr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Nse=function(t){let e=t.getDay();return e===0||e===6},Dse=function(t){return t%4===0&&t%100!==0||t%400===0},pO=function(t,e){return[31,Dse(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Sm=function(t){Yr(t)&&t.setHours(0,0,0,0)},Rm=function(t,e){return t.getTime()===e.getTime()},Iw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Yr(e[r])?n&&(t[r]=new Date(e[r].getTime())):WM(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Iw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},wO=function(t,e,n){let r=pi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Iw(r,n),t.dispatchEvent(r)},vO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},wo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},yO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},kse=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},$se=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},Lse=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():$se(o,i))+"</td>"},Fse=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Vse=function(t){return"<tbody>"+t.join("")+"</tbody>"},Wse=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+yO(t,e)+'">'+yO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Bse=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,v=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",WM(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},jse=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Wse(t)+Vse(e)+"</table>"};function HR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||xa().event;let o=i.target||i.srcElement;if(o)if(Br(o,"is-disabled")||(Br(o,"pika-button")&&!Br(o,"is-empty")&&!Br(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&AR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Br(o,"pika-prev")?e.prevMonth():Br(o,"pika-next")&&e.nextMonth()),Br(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||xa().event;let o=i.target||i.srcElement;o&&(Br(o,"pika-select-month")?e.gotoMonth(o.value):Br(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||xa().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Yr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=pi().activeElement;do if(Br(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=AR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||xa().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Br(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Po(o,"change",e._onChange)));do if(Br(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=pi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Po(e.el,"mousedown",e._onMouseDown,!0),Po(e.el,"touchend",e._onMouseDown,!0),Po(e.el,"change",e._onChange),n.keyboardInput&&Po(pi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?pi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Po(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Yr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Po(n.trigger,"click",e._onInputClick),Po(n.trigger,"focus",e._onInputFocus),Po(n.trigger,"blur",e._onInputBlur)):this.show()}HR.prototype={config:function(t){this._o||(this._o=Iw({},wo,!0));let e=Iw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Yr(e.minDate)||(e.minDate=!1),Yr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),WM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||wo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Yr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Yr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",wO(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Yr(t))return;let n=this._o.minDate,r=this._o.maxDate;Yr(n)&&t<n?t=n:Yr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Sm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),wO(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Yr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=vO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=vO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Sm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=wo.minDate,this._o.minYear=wo.minYear,this._o.minMonth=wo.minMonth,this._o.startRange=wo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Sm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=wo.maxDate,this._o.maxYear=wo.maxYear,this._o.maxMonth=wo.maxMonth,this._o.endRange=wo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Bse(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&AR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=xa().innerWidth||pi().documentElement.clientWidth,i=xa().innerHeight||pi().documentElement.clientHeight,o=pi().body.scrollTop||pi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+xa().pageXOffset,a=l.bottom+xa().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",XC(this.el,u?"left-aligned":"right-aligned"),XC(this.el,c?"bottom-aligned":"top-aligned"),JC(this.el,u?"right-aligned":"left-aligned"),JC(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=pO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Sm(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=pO(h,u),g=o+s,v=g;for(;v>7;)v-=7;g+=7-v;let y=!1;for(let E=0,C=0;E<g;E++){let _=new Date(t,e,1+(E-s)),I=Yr(this._d)?Rm(_,this._d):!1,P=Rm(_,i),T=r.events.indexOf(_.toDateString())!==-1,A=E<s||E>=o+s,G=1+(E-s),U=e,V=t,X=r.startRange&&Rm(r.startRange,_),ne=r.endRange&&Rm(r.endRange,_),Q=r.startRange&&r.endRange&&r.startRange<_&&_<r.endRange,te=r.minDate&&_<r.minDate||r.maxDate&&_>r.maxDate||r.disableWeekends&&Nse(_)||r.disableDayFn&&r.disableDayFn(_);A&&(E<s?(G=f+G,U=u,V=h):(G=G-o,U=c,V=d));let pe={day:G,month:U,year:V,hasEvent:T,isSelected:I,isToday:P,isDisabled:te,isEmpty:A,isStartRange:X,isEndRange:ne,isInRange:Q,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&I&&(y=!0),l.push(kse(pe)),++C===7&&(r.showWeekNumber&&l.unshift(Lse(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(Fse(l,r.isRTL,r.pickWholeWeek,y)),l=[],C=0,y=!1)}return jse(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),JC(this.el,"is-hidden"),this._o.bound&&(Po(pi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&hs(pi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),XC(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),hs(this.el,"mousedown",this._onMouseDown,!0),hs(this.el,"touchend",this._onMouseDown,!0),hs(this.el,"change",this._onChange),t.keyboardInput&&hs(pi(),"keydown",this._onKeyChange),t.field&&(hs(t.field,"change",this._onInputChange),t.bound&&(hs(t.trigger,"click",this._onInputClick),hs(t.trigger,"focus",this._onInputFocus),hs(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Use(t,e){zse(t,e),e.add(t)}function zse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CO(t,e,n){return(e=Yse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yse(t){var e=Gse(t,"string");return typeof e=="symbol"?e:e+""}function Gse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lL="date",bO="dateEditor",Kse="DD/MM/YYYY";var Em=new WeakSet;class uL extends xu{constructor(){super(...arguments),Use(this,Em),CO(this,"parentDestroyed",!1),CO(this,"$datePicker",null)}static get EDITOR_TYPE(){return lL}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof HR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(we(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();we(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{ve(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:bO})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(bO),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=ZC(Em,this,QC).call(this),r=this.hot.view.isMouseDown(),i=e?DE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new HR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&fg(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:ZC(Em,this,QC).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Z(a).format(ZC(Em,this,QC).call(this))),this.setValue(a),i&&i(),Bo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Zt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+un(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-en(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function QC(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:Kse}const qse="dropdown";class cL extends VM{static get EDITOR_TYPE(){return qse}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const Xse="numeric";class hL extends xu{static get EDITOR_TYPE(){return Xse}}function Jse(t,e,n){return(e=Zse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zse(t){var e=Qse(t,"string");return typeof e=="symbol"?e:e+""}function Qse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eae="password";class dL extends xu{constructor(){super(...arguments),Jse(this,"autoResize",iL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return eae}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Ko(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const eb="ht_editor_visible",SO="selectEditor",tae="select";class fL extends wh{static get EDITOR_TYPE(){return tae}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Tu()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ve(this.selectWrapper,eb)&&we(this.selectWrapper,eb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Ko(this.select),ke(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,_u(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Zt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,eb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:SO};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SO)}}const nae="time";class gL extends xu{static get EDITOR_TYPE(){return nae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function rae(){Mr(wh),Mr(VM),Mr(aL),Mr(uL),Mr(cL),Mr(FM),Mr(hL),Mr(dL),Mr(fL),Mr(xu),Mr(gL)}const iae="html";function BM(t,e,n,r,i,o,s){yg.apply(this,[t,e,n,r,i,o,s]),_u(e,o??"",!1)}BM.RENDERER_TYPE=iae;const oae="autocomplete";function yh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?BM:Xs,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Tu()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new Ri(t);t.acArrowListener=function(d){ve(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}yh.RENDERER_TYPE=oae;const sae="dropdown";function jM(t,e,n,r,i,o,s){yh.apply(this,[t,e,n,r,i,o,s])}jM.RENDERER_TYPE=sae;const RO=new WeakMap,EO=new WeakMap,aae="htBadValue",Qc="data-row",eh="data-col",lae="checkboxRenderer",mL="checkbox";oe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===mL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function UM(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;yg.apply(this,[t,e,n,r,i,o,s]),uae(t);let u=cae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Ko(e),o===s.checkedTemplate||Et(o).toLocaleLowerCase(s.locale)===Et(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Et(o).toLocaleLowerCase(s.locale)===Et(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Gt(o)?q(u,"noValue"):(u.style.display="none",q(u,aae),h=!0),be(u,[[Qc,n],[eh,r]]),l&&be(u,[Tf(u.checked?t.getTranslatedPhrase(NM):t.getTranslatedPhrase(DM)),mk(u.checked),S8()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);v=E!==null?E:""}const y=hae(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),RO.has(t)||(RO.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),E={group:lae,relativeToGroup:qa,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const C=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(C==null?void 0:C.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],E)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),E=[],C=new Map;let _=[],I=0;if(y){for(let P=0;P<y.length;P++){const{row:T,col:A}=y[P].getTopStartCorner(),{row:G,col:U}=y[P].getBottomEndCorner();for(let V=T;V<=G;V+=1)for(let X=A;X<=U;X+=1){const ne=t.getCellMeta(V,X);if(ne.hidden)continue;const Q={checkedTemplate:ne.checkedTemplate,uncheckedTemplate:ne.uncheckedTemplate};if(ne.type!=="checkbox"){v===!0&&!ne.readOnly&&(C.has(E.length)?C.set(E.length,[...C.get(E.length),[V,X,null]]):C.set(E.length,[[V,X,null]]));continue}if(ne.readOnly===!0)continue;typeof ne.checkedTemplate>"u"&&(ne.checkedTemplate=!0),typeof ne.uncheckedTemplate>"u"&&(ne.uncheckedTemplate=!1);const te=t.getDataAtCell(V,X);v===!1?[ne.checkedTemplate,ne.checkedTemplate.toString()].includes(te)?_.push([V,X,ne.uncheckedTemplate,Q]):[ne.uncheckedTemplate,ne.uncheckedTemplate.toString(),null,void 0].includes(te)&&_.push([V,X,ne.checkedTemplate,Q]):_.push([V,X,ne.uncheckedTemplate,Q]),I+=1}E.push(I),I=0}_.every(P=>{let[,,T]=P;return T===_[0][2]})?_=_.map(P=>{let[T,A,G]=P;return[T,A,G]}):_=_.map(P=>{let[T,A,,G]=P;return[T,A,G.checkedTemplate]}),_.length>0&&E.forEach((P,T)=>{let A=_.splice(0,P);C.size&&C.has(T)&&(A=[...A,...C.get(T)]),t.setDataAtCell(A)})}}function g(){const v=t.getSelectedRange();if(v){for(let y=0;y<v.length;y++){const E=v[y].getTopStartCorner(),C=v[y].getBottomEndCorner();for(let _=E.row;_<=C.row;_++)for(let I=E.col;I<=C.col;I++){if(t.getCellMeta(_,I).readOnly)continue;const T=t.getCell(_,I);if(Uo(T)&&T.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}UM.RENDERER_TYPE=mL;function uae(t){let e=EO.get(t);if(!e){const{rootElement:n}=t;e=new Ri(t),e.addEventListener(n,"click",r=>fae(r,t)),e.addEventListener(n,"mouseup",r=>dae(r,t)),e.addEventListener(n,"change",r=>gae(r,t)),EO.set(t,e)}return e}function cae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function hae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function dae(t,e){const{target:n}=t;zM(n)&&(!n.hasAttribute(Qc)||!n.hasAttribute(eh)||setTimeout(e.listen,10))}function fae(t,e){const{target:n}=t;if(!zM(n)||!n.hasAttribute(Qc)||!n.hasAttribute(eh))return;const r=parseInt(n.getAttribute(Qc),10),i=parseInt(n.getAttribute(eh),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function gae(t,e){const{target:n}=t;if(!zM(n)||!n.hasAttribute(Qc)||!n.hasAttribute(eh))return;const r=parseInt(n.getAttribute(Qc),10),i=parseInt(n.getAttribute(eh),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function zM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const mae="handsontable";function YM(t,e,n,r,i,o,s){yh.apply(this,[t,e,n,r,i,o,s])}YM.RENDERER_TYPE=mae;var pae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var tb,TO;function vae(){return TO||(TO=1,tb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),tb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var nb,MO;function pL(){if(MO)return nb;MO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let v="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let T=0;T<t.length;T++){let A=t[T];if(v=l.replace(RegExp(`([0-9 ])(${A.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*A.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let C=h(E);if(C&&C!=="."&&(v=l.replace(new RegExp(`${e(C)}$`),""),v!==l))return n(v,u,c,h,d,f);let _={};Object.keys(f).forEach(T=>{_[f[T]]=T});let I=Object.keys(_).sort().reverse(),P=I.length;for(let T=0;T<P;T++){let A=I[T],G=_[A];if(v=l.replace(A,""),v!==l){let U;switch(G){case"thousand":U=Math.pow(10,3);break;case"million":U=Math.pow(10,6);break;case"billion":U=Math.pow(10,9);break;case"trillion":U=Math.pow(10,12);break}return n(v,u,c,h,d,f)*U}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let v=r(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=qM();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),v=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,g,v);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return nb={unformat:a},nb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var rb,_O;function GM(){if(_O)return rb;_O=1;let t=pL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,E){let C=d(y),_=g(E);return C&&_}function d(y){return t.unformat(y)!==void 0}function f(y,E,C,_=!1){let I=Object.keys(y).map(P=>{if(!E[P])return console.error(`${C} Invalid key: ${P}`),!1;let T=y[P],A=E[P];if(typeof A=="string"&&(A={type:A}),A.type==="format"){if(!f(T,u,`[Validate ${P}]`,!0))return!1}else if(typeof T!==A.type)return console.error(`${C} ${P} type mismatched: "${A.type}" expected, "${typeof T}" provided`),!1;if(A.restrictions&&A.restrictions.length){let G=A.restrictions.length;for(let U=0;U<G;U++){let{restriction:V,message:X}=A.restrictions[U];if(!V(T,y))return console.error(`${C} ${P} invalid value: ${X}`),!1}}return A.restriction&&!A.restriction(T,y)?(console.error(`${C} ${P} invalid value: ${A.message}`),!1):A.validValues&&A.validValues.indexOf(T)===-1?(console.error(`${C} ${P} invalid value: must be among ${JSON.stringify(A.validValues)}, "${T}" provided`),!1):!(A.children&&!f(T,A.children,`[Validate ${P}]`))});return _||I.push(...Object.keys(E).map(P=>{let T=E[P];if(typeof T=="string"&&(T={type:T}),T.mandatory){let A=T.mandatory;if(typeof A=="function"&&(A=A(y)),A&&y[P]===void 0)return console.error(`${C} Missing mandatory key "${P}"`),!1}return!0})),I.reduce((P,T)=>P&&T,!0)}function g(y){return f(y,u,"[Validate format]")}function v(y){return f(y,c,"[Validate language]")}return rb={validate:h,validateFormat:g,validateInput:d,validateLanguage:v},rb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function yae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function Cae(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function bae(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function Sae(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Rae(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function Eae(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function Tae(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function Mae(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function _ae(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function Pae(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function xae(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Iae(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function Oae(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function Aae(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Hae(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Nae(t,e={}){return typeof t!="string"?t:(t=yae(t,e),t=Cae(t,e),bae(t,e),Eae(t,e),Tae(t,e),Oae(t,e),Pae(t,e),xae(t,e),Mae(t,e),Iae(t,e),_ae(t,e),Sae(t,e),Rae(t,e),Aae(t,e),Hae(t,e),e)}var KM={parseFormat:Nae};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ib,PO;function qM(){if(PO)return ib;PO=1;const t=vae(),e=GM(),n=KM;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,ib=r,ib}function Dae(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function kae(t,e){t.forEach(n=>{let r;try{r=Dae(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var $ae=t=>({loadLanguagesInNode:e=>kae(e,t)}),wL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(T){var A,G,U,V=p.prototype={constructor:p,toString:null,valueOf:null},X=new p(1),ne=20,Q=4,te=-7,pe=21,et=-1e7,Re=1e7,Ae=!1,ot=1,Pn=0,st={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function p(b,R){var S,$,x,N,B,H,D,W,F=this;if(!(F instanceof p))return new p(b,R);if(R==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>Re?F.c=F.e=null:b.e<et?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((H=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(N=0,B=b;B>=10;B/=10,N++);N>Re?F.c=F.e=null:(F.e=N,F.c=[b]);return}W=String(b)}else{if(!r.test(W=String(b)))return U(F,W,H);F.s=W.charCodeAt(0)==45?(W=W.slice(1),-1):1}(N=W.indexOf("."))>-1&&(W=W.replace(".","")),(B=W.search(/e/i))>0?(N<0&&(N=B),N+=+W.slice(B+1),W=W.substring(0,B)):N<0&&(N=W.length)}else{if(C(R,2,m.length,"Base"),R==10&&w)return F=new p(b),K(F,ne+F.e+1,Q);if(W=String(b),H=typeof b=="number"){if(b*0!=0)return U(F,W,H,R);if(F.s=1/b<0?(W=W.slice(1),-1):1,p.DEBUG&&W.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=W.charCodeAt(0)===45?(W=W.slice(1),-1):1;for(S=m.slice(0,R),N=B=0,D=W.length;B<D;B++)if(S.indexOf($=W.charAt(B))<0){if($=="."){if(B>N){N=D;continue}}else if(!x&&(W==W.toUpperCase()&&(W=W.toLowerCase())||W==W.toLowerCase()&&(W=W.toUpperCase()))){x=!0,B=-1,N=0;continue}return U(F,String(b),H,R)}H=!1,W=G(W,R,10,F.s),(N=W.indexOf("."))>-1?W=W.replace(".",""):N=W.length}for(B=0;W.charCodeAt(B)===48;B++);for(D=W.length;W.charCodeAt(--D)===48;);if(W=W.slice(B,++D)){if(D-=B,H&&p.DEBUG&&D>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((N=N-B-1)>Re)F.c=F.e=null;else if(N<et)F.c=[F.e=0];else{if(F.e=N,F.c=[],B=(N+1)%u,N<0&&(B+=u),B<D){for(B&&F.c.push(+W.slice(0,B)),D-=u;B<D;)F.c.push(+W.slice(B,B+=u));B=u-(W=W.slice(B)).length}else B-=D;for(;B--;W+="0");F.c.push(+W)}}else F.c=[F.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],C(S,0,f,R),ne=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],C(S,0,8,R),Q=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(C(S[0],-1e9,0,R),C(S[1],0,f,R),te=S[0],pe=S[1]):(C(S,-1e9,f,R),te=-(pe=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)C(S[0],-1e9,-1,R),C(S[1],1,f,R),et=S[0],Re=S[1];else if(C(S,-1e9,f,R),S)et=-(Re=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ae=S;else throw Ae=!S,Error(s+"crypto unavailable");else Ae=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],C(S,0,9,R),ot=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],C(S,0,f,R),Pn=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")st=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))w=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:ne,ROUNDING_MODE:Q,EXPONENTIAL_AT:[te,pe],RANGE:[et,Re],CRYPTO:Ae,MODULO_MODE:ot,POW_PRECISION:Pn,FORMAT:st,ALPHABET:m}},p.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,S,$=b.c,x=b.e,N=b.s;e:if({}.toString.call($)=="[object Array]"){if((N===1||N===-1)&&x>=-1e9&&x<=f&&x===o(x)){if($[0]===0){if(x===0&&$.length===1)return!0;break e}if(R=(x+1)%u,R<1&&(R+=u),String($[0]).length==R){for(R=0;R<$.length;R++)if(S=$[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if($===null&&x===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},p.maximum=p.max=function(){return L(arguments,-1)},p.minimum=p.min=function(){return L(arguments,1)},p.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var $,x,N,B,H,D=0,W=[],F=new p(X);if(S==null?S=ne:C(S,0,f),B=i(S/u),Ae)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(B*=2));D<B;)H=$[D]*131072+($[D+1]>>>11),H>=9e15?(x=crypto.getRandomValues(new Uint32Array(2)),$[D]=x[0],$[D+1]=x[1]):(W.push(H%1e14),D+=2);D=B/2}else if(crypto.randomBytes){for($=crypto.randomBytes(B*=7);D<B;)H=($[D]&31)*281474976710656+$[D+1]*1099511627776+$[D+2]*4294967296+$[D+3]*16777216+($[D+4]<<16)+($[D+5]<<8)+$[D+6],H>=9e15?crypto.randomBytes(7).copy($,D):(W.push(H%1e14),D+=7);D=B/7}else throw Ae=!1,Error(s+"crypto unavailable");if(!Ae)for(;D<B;)H=R(),H<9e15&&(W[D++]=H%1e14);for(B=W[--D],S%=u,B&&S&&(H=h[u-S],W[D]=o(B/H)*H);W[D]===0;W.pop(),D--);if(D<0)W=[N=0];else{for(N=-1;W[0]===0;W.splice(0,1),N-=u);for(D=1,H=W[0];H>=10;H/=10,D++);D<u&&(N-=u-D)}return F.e=N,F.c=W,F}}(),p.sum=function(){for(var b=1,R=arguments,S=new p(R[0]);b<R.length;)S=S.plus(R[b++]);return S},G=function(){var b="0123456789";function R(S,$,x,N){for(var B,H=[0],D,W=0,F=S.length;W<F;){for(D=H.length;D--;H[D]*=$);for(H[0]+=N.indexOf(S.charAt(W++)),B=0;B<H.length;B++)H[B]>x-1&&(H[B+1]==null&&(H[B+1]=0),H[B+1]+=H[B]/x|0,H[B]%=x)}return H.reverse()}return function(S,$,x,N,B){var H,D,W,F,Y,ae,ce,_e,Fe=S.indexOf("."),ze=ne,Me=Q;for(Fe>=0&&(F=Pn,Pn=0,S=S.replace(".",""),_e=new p($),ae=_e.pow(S.length-Fe),Pn=F,_e.c=R(P(y(ae.c),ae.e,"0"),10,x,b),_e.e=_e.c.length),ce=R(S,$,x,B?(H=m,b):(H=b,m)),W=F=ce.length;ce[--F]==0;ce.pop());if(!ce[0])return H.charAt(0);if(Fe<0?--W:(ae.c=ce,ae.e=W,ae.s=N,ae=A(ae,_e,ze,Me,x),ce=ae.c,Y=ae.r,W=ae.e),D=W+ze+1,Fe=ce[D],F=x/2,Y=Y||D<0||ce[D+1]!=null,Y=Me<4?(Fe!=null||Y)&&(Me==0||Me==(ae.s<0?3:2)):Fe>F||Fe==F&&(Me==4||Y||Me==6&&ce[D-1]&1||Me==(ae.s<0?8:7)),D<1||!ce[0])S=Y?P(H.charAt(1),-ze,H.charAt(0)):H.charAt(0);else{if(ce.length=D,Y)for(--x;++ce[--D]>x;)ce[D]=0,D||(++W,ce=[1].concat(ce));for(F=ce.length;!ce[--F];);for(Fe=0,S="";Fe<=F;S+=H.charAt(ce[Fe++]));S=P(S,W,H.charAt(0))}return S}}(),A=function(){function b($,x,N){var B,H,D,W,F=0,Y=$.length,ae=x%d,ce=x/d|0;for($=$.slice();Y--;)D=$[Y]%d,W=$[Y]/d|0,B=ce*D+W*ae,H=ae*D+B%d*d+F,F=(H/N|0)+(B/d|0)+ce*W,$[Y]=H%N;return F&&($=[F].concat($)),$}function R($,x,N,B){var H,D;if(N!=B)D=N>B?1:-1;else for(H=D=0;H<N;H++)if($[H]!=x[H]){D=$[H]>x[H]?1:-1;break}return D}function S($,x,N,B){for(var H=0;N--;)$[N]-=H,H=$[N]<x[N]?1:0,$[N]=H*B+$[N]-x[N];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,x,N,B,H){var D,W,F,Y,ae,ce,_e,Fe,ze,Me,Ve,Mt,Oi,ns,ri,_t,gn,bt=$.s==x.s?1:-1,Pt=$.c,We=x.c;if(!Pt||!Pt[0]||!We||!We[0])return new p(!$.s||!x.s||(Pt?We&&Pt[0]==We[0]:!We)?NaN:Pt&&Pt[0]==0||!We?bt*0:bt/0);for(Fe=new p(bt),ze=Fe.c=[],W=$.e-x.e,bt=N+W+1,H||(H=l,W=v($.e/u)-v(x.e/u),bt=bt/u|0),F=0;We[F]==(Pt[F]||0);F++);if(We[F]>(Pt[F]||0)&&W--,bt<0)ze.push(1),Y=!0;else{for(ns=Pt.length,_t=We.length,F=0,bt+=2,ae=o(H/(We[0]+1)),ae>1&&(We=b(We,ae,H),Pt=b(Pt,ae,H),_t=We.length,ns=Pt.length),Oi=_t,Me=Pt.slice(0,_t),Ve=Me.length;Ve<_t;Me[Ve++]=0);gn=We.slice(),gn=[0].concat(gn),ri=We[0],We[1]>=H/2&&ri++;do{if(ae=0,D=R(We,Me,_t,Ve),D<0){if(Mt=Me[0],_t!=Ve&&(Mt=Mt*H+(Me[1]||0)),ae=o(Mt/ri),ae>1)for(ae>=H&&(ae=H-1),ce=b(We,ae,H),_e=ce.length,Ve=Me.length;R(ce,Me,_e,Ve)==1;)ae--,S(ce,_t<_e?gn:We,_e,H),_e=ce.length,D=1;else ae==0&&(D=ae=1),ce=We.slice(),_e=ce.length;if(_e<Ve&&(ce=[0].concat(ce)),S(Me,ce,Ve,H),Ve=Me.length,D==-1)for(;R(We,Me,_t,Ve)<1;)ae++,S(Me,_t<Ve?gn:We,Ve,H),Ve=Me.length}else D===0&&(ae++,Me=[0]);ze[F++]=ae,Me[0]?Me[Ve++]=Pt[Oi]||0:(Me=[Pt[Oi]],Ve=1)}while((Oi++<ns||Me[0]!=null)&&bt--);Y=Me[0]!=null,ze[0]||ze.splice(0,1)}if(H==l){for(F=1,bt=ze[0];bt>=10;bt/=10,F++);K(Fe,N+(Fe.e=F+W*u-1)+1,B,Y)}else Fe.e=W,Fe.r=+Y;return Fe}}();function O(b,R,S,$){var x,N,B,H,D;if(S==null?S=Q:C(S,0,8),!b.c)return b.toString();if(x=b.c[0],B=b.e,R==null)D=y(b.c),D=$==1||$==2&&(B<=te||B>=pe)?I(D,B):P(D,B,"0");else if(b=K(new p(b),R,S),N=b.e,D=y(b.c),H=D.length,$==1||$==2&&(R<=N||N<=te)){for(;H<R;D+="0",H++);D=I(D,N)}else if(R-=B,D=P(D,N,"0"),N+1>H){if(--R>0)for(D+=".";R--;D+="0");}else if(R+=N-H,R>0)for(N+1==H&&(D+=".");R--;D+="0");return b.s<0&&x?"-"+D:D}function L(b,R){for(var S,$,x=1,N=new p(b[0]);x<b.length;x++)$=new p(b[x]),(!$.s||(S=E(N,$))===R||S===0&&N.s===R)&&(N=$);return N}function j(b,R,S){for(var $=1,x=R.length;!R[--x];R.pop());for(x=R[0];x>=10;x/=10,$++);return(S=$+S*u-1)>Re?b.c=b.e=null:S<et?b.c=[b.e=0]:(b.e=S,b.c=R),b}U=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,B,H,D){var W,F=H?B:B.replace(x,"");if($.test(F))N.s=isNaN(F)?null:F<0?-1:1;else{if(!H&&(F=F.replace(b,function(Y,ae,ce){return W=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!D||D==W?ae:Y}),D&&(W=D,F=F.replace(R,"$1").replace(S,"0.$1")),B!=F))return new p(F,W);if(p.DEBUG)throw Error(s+"Not a"+(D?" base "+D:"")+" number: "+B);N.s=null}N.c=N.e=null}}();function K(b,R,S,$){var x,N,B,H,D,W,F,Y=b.c,ae=h;if(Y){e:{for(x=1,H=Y[0];H>=10;H/=10,x++);if(N=R-x,N<0)N+=u,B=R,D=Y[W=0],F=o(D/ae[x-B-1]%10);else if(W=i((N+1)/u),W>=Y.length)if($){for(;Y.length<=W;Y.push(0));D=F=0,x=1,N%=u,B=N-u+1}else break e;else{for(D=H=Y[W],x=1;H>=10;H/=10,x++);N%=u,B=N-u+x,F=B<0?0:o(D/ae[x-B-1]%10)}if($=$||R<0||Y[W+1]!=null||(B<0?D:D%ae[x-B-1]),$=S<4?(F||$)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||$||S==6&&(N>0?B>0?D/ae[x-B]:0:Y[W-1])%10&1||S==(b.s<0?8:7)),R<1||!Y[0])return Y.length=0,$?(R-=b.e+1,Y[0]=ae[(u-R%u)%u],b.e=-R||0):Y[0]=b.e=0,b;if(N==0?(Y.length=W,H=1,W--):(Y.length=W+1,H=ae[u-N],Y[W]=B>0?o(D/ae[x-B]%ae[B])*H:0),$)for(;;)if(W==0){for(N=1,B=Y[0];B>=10;B/=10,N++);for(B=Y[0]+=H,H=1;B>=10;B/=10,H++);N!=H&&(b.e++,Y[0]==l&&(Y[0]=1));break}else{if(Y[W]+=H,Y[W]!=l)break;Y[W--]=0,H=1}for(N=Y.length;Y[--N]===0;Y.pop());}b.e>Re?b.c=b.e=null:b.e<et&&(b.c=[b.e=0])}return b}function J(b){var R,S=b.e;return S===null?b.toString():(R=y(b.c),R=S<=te||S>=pe?I(R,S):P(R,S,"0"),b.s<0?"-"+R:R)}return V.absoluteValue=V.abs=function(){var b=new p(this);return b.s<0&&(b.s=1),b},V.comparedTo=function(b,R){return E(this,new p(b,R))},V.decimalPlaces=V.dp=function(b,R){var S,$,x,N=this;if(b!=null)return C(b,0,f),R==null?R=Q:C(R,0,8),K(new p(N),b+N.e+1,R);if(!(S=N.c))return null;if($=((x=S.length-1)-v(this.e/u))*u,x=S[x])for(;x%10==0;x/=10,$--);return $<0&&($=0),$},V.dividedBy=V.div=function(b,R){return A(this,new p(b,R),ne,Q)},V.dividedToIntegerBy=V.idiv=function(b,R){return A(this,new p(b,R),0,1)},V.exponentiatedBy=V.pow=function(b,R){var S,$,x,N,B,H,D,W,F,Y=this;if(b=new p(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+J(b));if(R!=null&&(R=new p(R)),H=b.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!b.c||!b.c[0])return F=new p(Math.pow(+J(Y),H?b.s*(2-_(b)):+J(b))),R?F.mod(R):F;if(D=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);$=!D&&Y.isInteger()&&R.isInteger(),$&&(Y=Y.mod(R))}else{if(b.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||H&&Y.c[1]>=24e7:Y.c[0]<8e13||H&&Y.c[0]<=9999975e7)))return N=Y.s<0&&_(b)?-0:0,Y.e>-1&&(N=1/N),new p(D?1/N:N);Pn&&(N=i(Pn/u+2))}for(H?(S=new p(.5),D&&(b.s=1),W=_(b)):(x=Math.abs(+J(b)),W=x%2),F=new p(X);;){if(W){if(F=F.times(Y),!F.c)break;N?F.c.length>N&&(F.c.length=N):$&&(F=F.mod(R))}if(x){if(x=o(x/2),x===0)break;W=x%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)W=_(b);else{if(x=+J(b),x===0)break;W=x%2}Y=Y.times(Y),N?Y.c&&Y.c.length>N&&(Y.c.length=N):$&&(Y=Y.mod(R))}return $?F:(D&&(F=X.div(F)),R?F.mod(R):N?K(F,Pn,Q,B):F)},V.integerValue=function(b){var R=new p(this);return b==null?b=Q:C(b,0,8),K(R,R.e+1,b)},V.isEqualTo=V.eq=function(b,R){return E(this,new p(b,R))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(b,R){return E(this,new p(b,R))>0},V.isGreaterThanOrEqualTo=V.gte=function(b,R){return(R=E(this,new p(b,R)))===1||R===0},V.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},V.isLessThan=V.lt=function(b,R){return E(this,new p(b,R))<0},V.isLessThanOrEqualTo=V.lte=function(b,R){return(R=E(this,new p(b,R)))===-1||R===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(b,R){var S,$,x,N,B=this,H=B.s;if(b=new p(b,R),R=b.s,!H||!R)return new p(NaN);if(H!=R)return b.s=-R,B.plus(b);var D=B.e/u,W=b.e/u,F=B.c,Y=b.c;if(!D||!W){if(!F||!Y)return F?(b.s=-R,b):new p(Y?B:NaN);if(!F[0]||!Y[0])return Y[0]?(b.s=-R,b):new p(F[0]?B:Q==3?-0:0)}if(D=v(D),W=v(W),F=F.slice(),H=D-W){for((N=H<0)?(H=-H,x=F):(W=D,x=Y),x.reverse(),R=H;R--;x.push(0));x.reverse()}else for($=(N=(H=F.length)<(R=Y.length))?H:R,H=R=0;R<$;R++)if(F[R]!=Y[R]){N=F[R]<Y[R];break}if(N&&(x=F,F=Y,Y=x,b.s=-b.s),R=($=Y.length)-(S=F.length),R>0)for(;R--;F[S++]=0);for(R=l-1;$>H;){if(F[--$]<Y[$]){for(S=$;S&&!F[--S];F[S]=R);--F[S],F[$]+=l}F[$]-=Y[$]}for(;F[0]==0;F.splice(0,1),--W);return F[0]?j(b,F,W):(b.s=Q==3?-1:1,b.c=[b.e=0],b)},V.modulo=V.mod=function(b,R){var S,$,x=this;return b=new p(b,R),!x.c||!b.s||b.c&&!b.c[0]?new p(NaN):!b.c||x.c&&!x.c[0]?new p(x):(ot==9?($=b.s,b.s=1,S=A(x,b,0,3),b.s=$,S.s*=$):S=A(x,b,0,ot),b=x.minus(S.times(b)),!b.c[0]&&ot==1&&(b.s=x.s),b)},V.multipliedBy=V.times=function(b,R){var S,$,x,N,B,H,D,W,F,Y,ae,ce,_e,Fe,ze,Me=this,Ve=Me.c,Mt=(b=new p(b,R)).c;if(!Ve||!Mt||!Ve[0]||!Mt[0])return!Me.s||!b.s||Ve&&!Ve[0]&&!Mt||Mt&&!Mt[0]&&!Ve?b.c=b.e=b.s=null:(b.s*=Me.s,!Ve||!Mt?b.c=b.e=null:(b.c=[0],b.e=0)),b;for($=v(Me.e/u)+v(b.e/u),b.s*=Me.s,D=Ve.length,Y=Mt.length,D<Y&&(_e=Ve,Ve=Mt,Mt=_e,x=D,D=Y,Y=x),x=D+Y,_e=[];x--;_e.push(0));for(Fe=l,ze=d,x=Y;--x>=0;){for(S=0,ae=Mt[x]%ze,ce=Mt[x]/ze|0,B=D,N=x+B;N>x;)W=Ve[--B]%ze,F=Ve[B]/ze|0,H=ce*W+F*ae,W=ae*W+H%ze*ze+_e[N]+S,S=(W/Fe|0)+(H/ze|0)+ce*F,_e[N--]=W%Fe;_e[N]=S}return S?++$:_e.splice(0,1),j(b,_e,$)},V.negated=function(){var b=new p(this);return b.s=-b.s||null,b},V.plus=function(b,R){var S,$=this,x=$.s;if(b=new p(b,R),R=b.s,!x||!R)return new p(NaN);if(x!=R)return b.s=-R,$.minus(b);var N=$.e/u,B=b.e/u,H=$.c,D=b.c;if(!N||!B){if(!H||!D)return new p(x/0);if(!H[0]||!D[0])return D[0]?b:new p(H[0]?$:x*0)}if(N=v(N),B=v(B),H=H.slice(),x=N-B){for(x>0?(B=N,S=D):(x=-x,S=H),S.reverse();x--;S.push(0));S.reverse()}for(x=H.length,R=D.length,x-R<0&&(S=D,D=H,H=S,R=x),x=0;R;)x=(H[--R]=H[R]+D[R]+x)/l|0,H[R]=l===H[R]?0:H[R]%l;return x&&(H=[x].concat(H),++B),j(b,H,B)},V.precision=V.sd=function(b,R){var S,$,x,N=this;if(b!=null&&b!==!!b)return C(b,1,f),R==null?R=Q:C(R,0,8),K(new p(N),b,R);if(!(S=N.c))return null;if(x=S.length-1,$=x*u+1,x=S[x]){for(;x%10==0;x/=10,$--);for(x=S[0];x>=10;x/=10,$++);}return b&&N.e+1>$&&($=N.e+1),$},V.shiftedBy=function(b){return C(b,-9007199254740991,c),this.times("1e"+b)},V.squareRoot=V.sqrt=function(){var b,R,S,$,x,N=this,B=N.c,H=N.s,D=N.e,W=ne+4,F=new p("0.5");if(H!==1||!B||!B[0])return new p(!H||H<0&&(!B||B[0])?NaN:B?N:1/0);if(H=Math.sqrt(+J(N)),H==0||H==1/0?(R=y(B),(R.length+D)%2==0&&(R+="0"),H=Math.sqrt(+R),D=v((D+1)/2)-(D<0||D%2),H==1/0?R="5e"+D:(R=H.toExponential(),R=R.slice(0,R.indexOf("e")+1)+D),S=new p(R)):S=new p(H+""),S.c[0]){for(D=S.e,H=D+W,H<3&&(H=0);;)if(x=S,S=F.times(x.plus(A(N,x,W,1))),y(x.c).slice(0,H)===(R=y(S.c)).slice(0,H))if(S.e<D&&--H,R=R.slice(H-3,H+1),R=="9999"||!$&&R=="4999"){if(!$&&(K(x,x.e+ne+2,0),x.times(x).eq(N))){S=x;break}W+=4,H+=4,$=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(K(S,S.e+ne+2,1),b=!S.times(S).eq(N));break}}return K(S,S.e+ne+1,Q,b)},V.toExponential=function(b,R){return b!=null&&(C(b,0,f),b++),O(this,b,R,1)},V.toFixed=function(b,R){return b!=null&&(C(b,0,f),b=b+this.e+1),O(this,b,R)},V.toFormat=function(b,R,S){var $,x=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=st;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if($=x.toFixed(b,R),x.c){var N,B=$.split("."),H=+S.groupSize,D=+S.secondaryGroupSize,W=S.groupSeparator||"",F=B[0],Y=B[1],ae=x.s<0,ce=ae?F.slice(1):F,_e=ce.length;if(D&&(N=H,H=D,D=N,_e-=N),H>0&&_e>0){for(N=_e%H||H,F=ce.substr(0,N);N<_e;N+=H)F+=W+ce.substr(N,H);D>0&&(F+=W+ce.slice(N)),ae&&(F="-"+F)}$=Y?F+(S.decimalSeparator||"")+((D=+S.fractionGroupSize)?Y.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):Y):F}return(S.prefix||"")+$+(S.suffix||"")},V.toFraction=function(b){var R,S,$,x,N,B,H,D,W,F,Y,ae,ce=this,_e=ce.c;if(b!=null&&(H=new p(b),!H.isInteger()&&(H.c||H.s!==1)||H.lt(X)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+J(H));if(!_e)return new p(ce);for(R=new p(X),W=S=new p(X),$=D=new p(X),ae=y(_e),N=R.e=ae.length-ce.e-1,R.c[0]=h[(B=N%u)<0?u+B:B],b=!b||H.comparedTo(R)>0?N>0?R:W:H,B=Re,Re=1/0,H=new p(ae),D.c[0]=0;F=A(H,R,0,1),x=S.plus(F.times($)),x.comparedTo(b)!=1;)S=$,$=x,W=D.plus(F.times(x=W)),D=x,R=H.minus(F.times(x=R)),H=x;return x=A(b.minus(S),$,0,1),D=D.plus(x.times(W)),S=S.plus(x.times($)),D.s=W.s=ce.s,N=N*2,Y=A(W,$,N,Q).minus(ce).abs().comparedTo(A(D,S,N,Q).minus(ce).abs())<1?[W,$]:[D,S],Re=B,Y},V.toNumber=function(){return+J(this)},V.toPrecision=function(b,R){return b!=null&&C(b,1,f),O(this,b,R,2)},V.toString=function(b){var R,S=this,$=S.s,x=S.e;return x===null?$?(R="Infinity",$<0&&(R="-"+R)):R="NaN":(b==null?R=x<=te||x>=pe?I(y(S.c),x):P(y(S.c),x,"0"):b===10&&w?(S=K(new p(S),ne+x+1,Q),R=P(y(S.c),S.e,"0")):(C(b,2,m.length,"Base"),R=G(P(y(S.c),x,"0"),10,b,$,!0)),$<0&&S.c[0]&&(R="-"+R)),R},V.valueOf=V.toJSON=function(){return J(this)},V._isBigNumber=!0,T!=null&&p.set(T),p}function v(T){var A=T|0;return T>0||T===A?A:A-1}function y(T){for(var A,G,U=1,V=T.length,X=T[0]+"";U<V;){for(A=T[U++]+"",G=u-A.length;G--;A="0"+A);X+=A}for(V=X.length;X.charCodeAt(--V)===48;);return X.slice(0,V+1||1)}function E(T,A){var G,U,V=T.c,X=A.c,ne=T.s,Q=A.s,te=T.e,pe=A.e;if(!ne||!Q)return null;if(G=V&&!V[0],U=X&&!X[0],G||U)return G?U?0:-Q:ne;if(ne!=Q)return ne;if(G=ne<0,U=te==pe,!V||!X)return U?0:!V^G?1:-1;if(!U)return te>pe^G?1:-1;for(Q=(te=V.length)<(pe=X.length)?te:pe,ne=0;ne<Q;ne++)if(V[ne]!=X[ne])return V[ne]>X[ne]^G?1:-1;return te==pe?0:te>pe^G?1:-1}function C(T,A,G,U){if(T<A||T>G||T!==o(T))throw Error(s+(U||"Argument")+(typeof T=="number"?T<A||T>G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(T))}function _(T){var A=T.c.length-1;return v(T.e/u)==A&&T.c[A]%2!=0}function I(T,A){return(T.length>1?T.charAt(0)+"."+T.slice(1):T)+(A<0?"e":"e+")+A}function P(T,A,G){var U,V;if(A<0){for(V=G+".";++A;V+=G);T=V+T}else if(U=T.length,++A>U){for(V=G,A-=U;--A;V+=G);T+=V}else A<U&&(T=T.slice(0,A)+"."+T.slice(A));return T}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(pae)})(wL);var vL=wL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Bi=qM(),Lae=GM(),Fae=KM,Vae=vL,kn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Cg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:yL,decimalSuffixes:Ow}=Bi.currentBytes(),XM={general:{scale:1024,suffixes:Ow},binary:{scale:1024,suffixes:yL},decimal:{scale:1e3,suffixes:Ow}};function Wae(t,e={},n){if(typeof e=="string"&&(e=Fae.parseFormat(e)),!Lae.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=Bae(t,e,n);return s=ale(s,i),s=lle(s,o),s}function Bae(t,e,n){switch(e.output){case"currency":return e=yc(e,Bi.currentCurrencyDefaultFormat()),Xae(t,e,Bi);case"percent":return e=yc(e,Bi.currentPercentageDefaultFormat()),qae(t,e,Bi,n);case"byte":return e=yc(e,Bi.currentByteDefaultFormat()),Yae(t,e,Bi,n);case"time":return e=yc(e,Bi.currentTimeDefaultFormat()),Kae(t);case"ordinal":return e=yc(e,Bi.currentOrdinalDefaultFormat()),Gae(t,e,Bi);case"number":default:return bg({instance:t,providedFormat:e})}}function jae(t){let e=XM.decimal;return ey(t._value,e.suffixes,e.scale).suffix}function Uae(t){let e=XM.binary;return ey(t._value,e.suffixes,e.scale).suffix}function zae(t){let e=XM.general;return ey(t._value,e.suffixes,e.scale).suffix}function ey(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function Yae(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Cg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Ow,marker:"bd"},binary:{scale:1024,suffixes:s||yL,marker:"b"},decimal:{scale:1e3,suffixes:a||Ow,marker:"d"}}[i],{value:c,suffix:h}=ey(t._value,u.suffixes,u.scale);return`${bg({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function Gae(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Cg,e),o=bg({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function Kae(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function qae(t,e,n,r){let i=e.prefixSymbol,o=bg({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Cg,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function Xae(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Cg,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=bg({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function Jae({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&kn[e]?(a=r[e],t=t/kn[e]):l>=kn.trillion||n&&s(l/kn.trillion)===1?(a=r.trillion,t=t/kn.trillion):l<kn.trillion&&l>=kn.billion||n&&s(l/kn.billion)===1?(a=r.billion,t=t/kn.billion):l<kn.billion&&l>=kn.million||n&&s(l/kn.million)===1?(a=r.million,t=t/kn.million):(l<kn.million&&l>=kn.thousand||n&&s(l/kn.thousand)===1)&&(a=r.thousand,t=t/kn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function Zae({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Tm(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function Qae(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Tm(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Tm(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Tm(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Tm(e)}`),n}function ele(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?Qae(t,e):new Vae(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function tle(t,e,n,r,i,o){if(r===-1)return t;let s=ele(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function nle(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function rle(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function ile(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),rle(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function ole(t,e){return t+e}function sle(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function ale(t,e){return e+t}function lle(t,e){return t+e}function bg({instance:t,providedFormat:e,state:n=Bi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Cg,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,y=s.thousandSeparated,E=s.spaceSeparated,C=s.negative,_=s.forceSign,I=s.exponential,P=s.roundingFunction,T="";if(d){let G=Jae({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:P,totalLength:a});o=G.value,T+=G.abbreviation,a&&(f=G.mantissaPrecision)}if(I){let G=Zae({value:o,characteristicPrecision:l});o=G.value,T=G.abbreviation+T}let A=tle(o.toString(),o,g,f,v,P);return A=nle(A,o,u,l),A=ile(A,o,y,n,r),(d||I)&&(A=ole(A,T)),(_||o<0)&&(A=sle(A,o,C)),A}function yc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var ule=t=>({format:(...e)=>Wae(...e,t),getByteUnit:(...e)=>zae(...e,t),getBinaryByteUnit:(...e)=>Uae(...e,t),getDecimalByteUnit:(...e)=>jae(...e,t),formatOrDefault:yc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ws=vL;function cle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.plus(i).toNumber(),t}function CL(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.minus(i).toNumber(),t}function hle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.times(i).toNumber(),t}function dle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.dividedBy(i).toNumber(),t}function fle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function gle(t,e,n){let r=n(t._value);return CL(r,e,n),Math.abs(r._value)}var mle=t=>({add:(e,n)=>cle(e,n,t),subtract:(e,n)=>CL(e,n,t),multiply:(e,n)=>hle(e,n,t),divide:(e,n)=>dle(e,n,t),set:(e,n)=>fle(e,n,t),difference:(e,n)=>gle(e,n,t),BigNumber:Ws});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ple="2.5.0",ts=qM(),wle=GM(),vle=$ae(nn),yle=pL();let cl=ule(nn),Vl=mle(nn);const Cle=KM;class bL{constructor(e){this._value=e}clone(){return nn(this._value)}format(e={}){return cl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Cle.parseFormat(e)),e=cl.formatOrDefault(e,ts.currentCurrencyDefaultFormat()),e.output="currency",cl.format(this,e)}formatTime(e={}){return e.output="time",cl.format(this,e)}binaryByteUnits(){return cl.getBinaryByteUnit(this)}decimalByteUnits(){return cl.getDecimalByteUnit(this)}byteUnits(){return cl.getByteUnit(this)}difference(e){return Vl.difference(this,e)}add(e){return Vl.add(this,e)}subtract(e){return Vl.subtract(this,e)}multiply(e){return Vl.multiply(this,e)}divide(e){return Vl.divide(this,e)}set(e){return Vl.set(this,SL(e))}value(){return this._value}valueOf(){return this._value}}function SL(t){let e=t;return nn.isNumbro(t)?e=t._value:typeof t=="string"?e=nn.unformat(t):isNaN(t)&&(e=NaN),e}function nn(t){return new bL(SL(t))}nn.version=ple;nn.isNumbro=function(t){return t instanceof bL};nn.language=ts.currentLanguage;nn.registerLanguage=ts.registerLanguage;nn.setLanguage=ts.setLanguage;nn.languages=ts.languages;nn.languageData=ts.languageData;nn.zeroFormat=ts.setZeroFormat;nn.defaultFormat=ts.currentDefaults;nn.setDefaults=ts.setDefaults;nn.defaultCurrencyFormat=ts.currentCurrencyDefaultFormat;nn.validate=wle.validate;nn.loadLanguagesInNode=vle.loadLanguagesInNode;nn.unformat=yle.unformat;nn.BigNumber=Vl.BigNumber;var ble=nn,hl=wae(ble);const Sle="numeric";function RL(t,e){if(Gn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!hl.languages()[r]){const o=r.replace("-",""),s=hl.allLanguages?hl.allLanguages[r]:hl[o];s&&hl.registerLanguage(s)}hl.setLanguage(r),t=hl(t).format(i||"0")}return t}function JM(t,e,n,r,i,o,s){let a=o;if(Gn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=RL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Xs(t,e,n,r,i,a,s)}JM.RENDERER_TYPE=Sle;const Rle="password";function ZM(t,e,n,r,i,o,s){Xs.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),_u(e,u)}ZM.RENDERER_TYPE=Rle;const Ele="select";function QM(t,e,n,r,i,o,s){Xs.apply(this,[t,e,n,r,i,o,s])}QM.RENDERER_TYPE=Ele;const Tle="time";function e_(t,e,n,r,i,o,s){Xs.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}e_.RENDERER_TYPE=Tle;function Mle(){jr(yh),jr(yg),jr(UM),jr(jM),jr(YM),jr(BM),jr(JM),jr(ZM),jr(QM),jr(Xs),jr(e_)}const _le="autocomplete";function ty(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,xO(n,e)):xO(n,e)(this.source):e(!0)}ty.VALIDATOR_TYPE=_le;function xO(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function EL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Ple=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:EL},Symbol.toStringTag,{value:"Module"})),xle="date";function t_(t,e){const n=Jk(lL,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=Ile(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}t_.VALIDATOR_TYPE=xle;function Ile(t,e){const n=Z(EL(t)),r=Z(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const Ole="dropdown";function n_(t,e){ty.apply(this,[t,e])}n_.VALIDATOR_TYPE=Ole;const Ale="numeric";function r_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Gn(t))}r_.VALIDATOR_TYPE=Ale;const Hle=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Nle="time";function i_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,Hle,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}i_.VALIDATOR_TYPE=Nle;function Dle(){zl(ty),zl(n_),zl(t_),zl(r_),zl(i_)}const kle="autocomplete",$le={CELL_TYPE:kle,editor:VM,renderer:yh,validator:ty},Lle="checkbox",Fle={CELL_TYPE:Lle,editor:aL,renderer:UM},Vle="date";function TL(t,e,n,r,i,o,s){yh.apply(this,[t,e,n,r,i,o,s])}TL.RENDERER_TYPE=Vle;const Wle="date",Ble={CELL_TYPE:Wle,editor:uL,renderer:TL,validator:t_},jle="dropdown",Ule={CELL_TYPE:jle,editor:cL,renderer:jM,validator:n_,filter:!1,strict:!0},zle="handsontable",Yle={CELL_TYPE:zle,editor:FM,renderer:YM},Gle="numeric",Kle={CELL_TYPE:Gle,editor:hL,renderer:JM,validator:r_,dataType:"number"},qle="password",Xle={CELL_TYPE:qle,editor:dL,renderer:ZM,copyable:!1},Jle="select",Zle={CELL_TYPE:Jle,editor:fL,renderer:QM},Qle="time",eue={CELL_TYPE:Qle,editor:gL,renderer:e_,validator:i_};function tue(){ci($le),ci(Fle),ci(Ble),ci(Ule),ci(Yle),ci(Kle),ci(Xle),ci(Zle),ci(oL),ci(eue)}function nue(t,e){ML(t,e),e.add(t)}function rue(t,e,n){ML(t,e),e.set(t,n)}function ML(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uu(t,e,n){return(e=iue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iue(t){var e=oue(t,"string");return typeof e=="symbol"?e:e+""}function oue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zu(t,e){return t.get(_L(t,e))}function _L(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IO=new Map([["plugin",dQ],["cell-type",q$],["editor",Xk],["renderer",s$],["validator",a$]]),PL=Symbol("mainSetting"),sue="base",Mm=[];let dl=null;var fl=new WeakMap,OO=new WeakSet;class qe{static get PLUGIN_KEY(){return sue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){nue(this,OO),Uu(this,"eventManager",new Ri(this)),Uu(this,"pluginName",null),Uu(this,"pluginsInitializedCallbacks",[]),Uu(this,"isPluginsReady",!1),Uu(this,"enabled",!1),Uu(this,"initialized",!1),rue(this,fl,{}),es(this,"hot",e,{writable:!1}),dl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!IO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);IO.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Mm.push(o)}}if(dl||(dl=BE()),dl.indexOf(this.pluginName)>=0&&dl.splice(dl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),dl.length===0){if(Mm.length>0){const i=[`${Mm.join(`
`)}
`,"You have to import and register them manually."].join("");throw Mm.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||De(n))&&r[PL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(De(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){zu(fl,this)[e]=zu(fl,this)[e]||[];const i=zu(fl,this)[e];this.hot.addHook(e,n,r),i.push(n),zu(fl,this)[e]=i}removeHooks(e){M(zu(fl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=zu(fl,this);ke(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){M(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=_L(OO,this,aue).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ke(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function aue(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function gl(t,e,n){return(e=lue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lue(t){var e=uue(t,"string");return typeof e=="symbol"?e:e+""}function uue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let o_=class{constructor(e){gl(this,"hot",null),gl(this,"container",null),gl(this,"injected",!1),gl(this,"rows",[]),gl(this,"columns",[]),gl(this,"samples",null),gl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),M(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),M(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{M(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{M(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{M(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),M(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{M(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function _m(t,e,n){return(e=cue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cue(t){var e=hue(t,"string");return typeof e=="symbol"?e:e+""}function hue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ny{static get SAMPLE_COUNT(){return 3}constructor(e){_m(this,"samples",null),_m(this,"dataFactory",null),_m(this,"customSampleCount",null),_m(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:ny.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:De(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Et(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function due(t,e){xL(t,e),e.add(t)}function ob(t,e,n){xL(t,e),e.set(t,n)}function xL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ed(t,e,n){return(e=fue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fue(t){var e=gue(t,"string");return typeof e=="symbol"?e:e+""}function gue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ia(t,e){return t.get(xr(t,e))}function Aw(t,e,n){return t.set(xr(t,e),n),n}function xr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutoColumnSizeSeed");const sb="autoColumnSize",mue=10,pue="autoColumnSize";var s_=new WeakMap,Cc=new WeakMap,th=new WeakMap,Ur=new WeakSet;class Jd extends qe{static get PLUGIN_KEY(){return sb}static get PLUGIN_PRIORITY(){return mue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),due(this,Ur),ed(this,"ghostTable",new o_(this.hot)),ed(this,"samplesGenerator",new ny((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ed(this,"inProgress",!1),ed(this,"measuredColumns",0),ed(this,"columnWidthsMap",new Ka),ob(this,s_,!1),ob(this,Cc,[]),ob(this,th,[]),this.hot.columnIndexMapper.registerMap(pue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>xr(Ur,this,AO).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[sb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(Ur,e,yue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(Ur,e,Cue).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(Ur,e,Sue).call(e,...i)}),this.addHook("beforeRender",()=>xr(Ur,this,vue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>xr(Ur,this,bue).call(this)),super.enablePlugin()}updatePlugin(){Aw(th,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>xr(Ur,this,AO).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&xr(Ur,this,IL).call(this,s,o)}),this.ghostTable.columns.length&&(xr(Ur,this,OL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){xf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Jd.CALCULATION_STEP,i)},e,n),r=r+Jd.CALCULATION_STEP+1,r<i?o=Pf(s):(xf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[sb];let n=Jd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return De(e)&&(n=e.syncLimit,pE(n)?n=VE(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Jc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Ia(Cc,this).length;return(s-1<o||Ia(Cc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Ia(Cc,this).push(i):Ia(Cc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function wue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||xr(Ur,this,IL).call(this,n,e))}),this.ghostTable.columns.length&&(xr(Ur,this,OL).call(this),this.ghostTable.clean())}function IL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function OL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function vue(){this.calculateVisibleColumnsWidth(),this.inProgress||(xr(Ur,this,wue).call(this,Ia(th,this)),Aw(th,this,[]))}function yue(t,e){e||this.recalculateAllColumnsWidth()}function Cue(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Ia(th,this).push(...e)}function AO(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function bue(){Aw(Cc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Aw(s_,this,!0)}function Sue(t){if(!Ia(s_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Ia(th,this).push(...e)}const Kl={horizontal:"horizontal",vertical:"vertical"};function Rue(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function Eue(t){const e={};return t===!0?(e.directions=Object.keys(Kl),e.autoInsertRow=!0):De(t)?(le(t.autoInsertRow)?t.direction===Kl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Kl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Tue(t,e){Mue(t,e),e.add(t)}function Mue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yu(t,e,n){return(e=_ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ue(t){var e=Pue(t,"string");return typeof e=="symbol"?e:e+""}function Pue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function td(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutofillRange");oe.getSingleton().register("beforeAutofill");oe.getSingleton().register("afterAutofill");const HO="autofill",xue=20,Iue=["fillHandle"],Oue="insert_row_below",Aue=200;var Gu=new WeakSet;class Hue extends qe{constructor(){super(...arguments),Tue(this,Gu),Yu(this,"addingStarted",!1),Yu(this,"mouseDownOnCellCorner",!1),Yu(this,"mouseDragOutside",!1),Yu(this,"handleDraggedCells",0),Yu(this,"directions",[]),Yu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return HO}static get PLUGIN_PRIORITY(){return xue}static get SETTING_KEYS(){return[HO,...Iue]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>td(Gu,this,Due).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>td(Gu,this,Nue).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>td(Gu,this,kue).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return M(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),M(a,c=>{const h=[];M(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=Rue(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),v=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,g,v,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=y;const C=y;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(E=[],c==="up"){const _=d.row-h.row+1,I=_%C.length;for(let P=0;P<_;P++)E.push(C[(P+(C.length-I))%C.length])}else{const _=d.col-h.col+1,I=_%C[0].length;for(let P=0;P<C.length;P++){E.push([]);for(let T=0;T<_;T++)E[P].push(C[P][(T+(C[P].length-I))%C[P].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,v,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Kl.vertical)&&this.directions.includes(Kl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Kl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Kl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Oue,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Aue)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Gt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Gt(s)||!Gt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Ln(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+un(this.hot.table),i=Ln(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+en(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>td(Gu,this,$ue).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>td(Gu,this,Lue).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Eue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Nue(){this.selectAdjacent()&&this.fillIn()}function Due(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function kue(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function $ue(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Lue(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Fue(t,e){AL(t,e),e.add(t)}function NO(t,e,n){AL(t,e),e.set(t,n)}function AL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ku(t,e,n){return(e=Vue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vue(t){var e=Wue(t,"string");return typeof e=="symbol"?e:e+""}function Wue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HL(t,e,n){return t.set(Do(t,e),n),n}function Hw(t,e){return t.get(Do(t,e))}function Do(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ab="autoRowSize",Bue=40,jue="autoRowSize";var Nf=new WeakMap,a_=new WeakMap,ys=new WeakSet;class Zd extends qe{static get PLUGIN_KEY(){return ab}static get PLUGIN_PRIORITY(){return Bue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Fue(this,ys),Ku(this,"headerHeight",null),Ku(this,"ghostTable",new o_(this.hot)),Ku(this,"samplesGenerator",new ny((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Ku(this,"inProgress",!1),Ku(this,"measuredRows",0),Ku(this,"rowHeightsMap",new Ka),NO(this,Nf,[]),NO(this,a_,!1),this.hot.rowIndexMapper.registerMap(jue,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Do(ys,this,DO).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[ab];return e===!0||De(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Do(ys,e,Yue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Do(ys,e,Gue).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Do(ys,e,que).call(e,...i)}),this.addHook("beforeRender",()=>Do(ys,this,zue).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>Do(ys,this,Kue).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Do(ys,this,DO).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){xf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Zd.CALCULATION_STEP,i)},e,n),r=r+Zd.CALCULATION_STEP+1,r<i?o=Pf(s):(xf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[ab];let n=Zd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return De(e)&&(n=e.syncLimit,pE(n)?n=VE(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Uue(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function zue(){this.calculateVisibleRowsHeight(),this.inProgress||(Do(ys,this,Uue).call(this,Hw(Nf,this)),HL(Nf,this,[]))}function DO(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Yue(t,e){e||this.recalculateAllRowsHeight()}function Gue(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Hw(Nf,this).push(...e)}function Kue(){this.recalculateAllRowsHeight(),HL(a_,this,!0)}function que(t){if(!Hw(a_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Hw(Nf,this).push(...e)}const{getListWithInsertedItems:Xue,getListWithRemovedItems:Jue}=O$("physicallyIndexed");class Zue extends Pu{constructor(){super(e=>e)}insert(e,n){const r=fT(this.indexedValues,n);this.indexedValues=Xue(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Jue(this.indexedValues,e);this.indexedValues=dT(n,e),super.remove(e)}}const{getListWithInsertedItems:Que,getListWithRemovedItems:ece}=O$("physicallyIndexed");class tce extends Pu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Que(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=ece(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function nce(t,e){rce(t,e),e.add(t)}function rce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ice(t,e,n){return(e=oce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oce(t){var e=sce(t,"string");return typeof e=="symbol"?e:e+""}function sce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ace(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kO="bindRowsWithHeaders",lce=210,uce="loose",$O=new Map([["loose",Zue],["strict",tce]]);var LO=new WeakSet;class cce extends qe{constructor(){super(...arguments),nce(this,LO),ice(this,"headerIndexes",null)}static get PLUGIN_KEY(){return kO}static get PLUGIN_PRIORITY(){return lce}isEnabled(){return!!this.hot.getSettings()[kO]}enablePlugin(){var e;if(this.enabled)return;const n=(e=$O.get(this.getSetting()))!==null&&e!==void 0?e:$O.get(uce);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>ace(LO,this,hce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function hce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function dce(t,e){NL(t,e),e.add(t)}function fce(t,e,n){NL(t,e),e.set(t,n)}function NL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FO(t,e,n){return(e=gce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gce(t){var e=mce(t,"string");return typeof e=="symbol"?e:e+""}function mce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VO(t,e){return t.get(xc(t,e))}function lb(t,e,n){return t.set(xc(t,e),n),n}function xc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lp="collapsibleColumns",pce=290,wce=["nestedHeaders"],Bc="collapsibleIndicator",WO=Lp,BO=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var qu=new WeakMap,nd=new WeakSet;class vce extends qe{constructor(){super(...arguments),dce(this,nd),FO(this,"nestedHeadersPlugin",null),FO(this,"headerStateManager",null),fce(this,qu,null)}static get PLUGIN_KEY(){return Lp}static get PLUGIN_PRIORITY(){return pce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Lp,...wce]}isEnabled(){return!!this.hot.getSettings()[Lp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||tt("You need to configure the Nested Headers plugin in order to use collapsible headers."),lb(qu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>xc(nd,this,bce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xc(nd,e,Sce).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xc(nd,e,yce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>xc(nd,this,Cce).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),lb(qu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:WO,relativeToGroup:qa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(WO)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Bc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Bc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Bc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!BO.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Va(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;M(r,f=>{var g;let{row:v,col:y}=f;const{collapsible:E,isCollapsed:C}=(g=this.headerStateManager.getHeaderSettings(v,y))!==null&&g!==void 0?g:{};if(!E||C&&n==="collapse"||!C&&n==="expand")return i=!1,!1});const o=[],s=[];i&&M(r,f=>{let{row:g,col:v}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:C}=this.headerStateManager.triggerNodeModification(n,g,v);y>0&&(s.push(...E),o.push(C))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=ak([...a,...s]):n==="expand"&&(l=Va(a,f=>!s.includes(f)));const u=BO.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){M(o,f=>{f()});return}this.hot.batchExecution(()=>{M(s,f=>{VO(qu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;y!==null&&E!==null&&this.hot.selectCell(y,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return VO(qu,this).getHiddenIndexes()}destroy(){lb(qu,this,null),super.destroy()}}function yce(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Bc}`);if(Mu(e,[Ci("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,Bc),e.querySelector("div:first-child").appendChild(u)),we(u,["collapsed","expanded"]),s?(q(u,"collapsed"),Ba(u,"+"),l&&be(e,...Ci(!1))):(q(u,"expanded"),Ba(u,"-"),l&&be(e,...Ci(!0))),l&&be(u,...Tu());else{var c;(c=u)===null||c===void 0||c.remove()}}function Cce(t,e){ve(t.target,Bc)&&(ve(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ve(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),xi(t))}function bce(){this.updatePlugin()}function Sce(t,e){e||this.updatePlugin()}function ml(t,e,n){return(e=Rce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rce(t){var e=Ece(t,"string");return typeof e=="symbol"?e:e+""}function Ece(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Tce=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Mce=!1,_ce=!0,Pce=!0;class xce{constructor(e,n){ml(this,"hot",void 0),ml(this,"sortingStates",new Gv),ml(this,"sortEmptyCells",Mce),ml(this,"indicator",_ce),ml(this,"headerAction",Pce),ml(this,"compareFunctionFactory",void 0),ml(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){De(e)&&ke(e,(n,r)=>{Tce.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return De(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function DL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?zo:Gt(i)?Gt(o)?zo:s&&t==="asc"?zt:Yt:Gt(o)?s&&t==="asc"?Yt:zt:isNaN(i)&&!isNaN(o)?t==="asc"?Yt:zt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?zt:Yt:i>o?t==="asc"?Yt:zt:zo}}const kL="default";function Ice(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return zo;if(a){if(Gt(r))return t==="asc"?zt:Yt;if(Gt(i))return t==="asc"?Yt:zt}return isNaN(o)?Yt:isNaN(s)?zt:o<s?t==="asc"?zt:Yt:o>s?t==="asc"?Yt:zt:zo}}const Oce="numeric";function Ace(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Gt(s),u=Gt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Yt;if(l===!1&&u)return zt}return d===!1&&f?t==="asc"?zt:Yt:d&&f===!1?t==="asc"?Yt:zt:d===!1&&f===!1?DL(t,e,n)(s,a):c===i&&h===r?t==="asc"?zt:Yt:c===r&&h===i?t==="asc"?Yt:zt:zo}}const Hce="checkbox";function Nce(t,e,n){return BL(t,e.dateFormat,n)}const Dce="date";function kce(t,e,n){return BL(t,e.timeFormat,n)}const $ce="time",{register:Sg,getItem:jO,hasItem:Lce}=ao("sorting.compareFunctionFactory"),{register:$L,getItem:Fce}=ao("sorting.mainSortComparator");function LL(t){return Lce(t)?jO(t):jO(kL)}Sg(Hce,Ace);Sg(Dce,Nce);Sg(kL,DL);Sg(Oce,Ice);Sg($ce,kce);const zo=0,zt=-1,Yt=1;function Vce(t,e){const n=Fce(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Nw="asc",Dw="desc",FL="colHeader";function Wce(t){if(De(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Nw,Dw].includes(n)}function Bce(t){if(t.some(n=>Wce(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function UO(t){if(t!==Dw)return t===Nw?Dw:Nw}function VL(t){return t.querySelector(`.${FL}`)}function WL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function l_(t,e,n){return t===-1&&e>=0&&ja(n)===!1}function BL(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return zo;if(Gt(r))return Gt(i)?zo:o&&t==="asc"?zt:Yt;if(Gt(i))return o&&t==="asc"?Yt:zt;const s=Z(r,e),a=Z(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?zt:Yt:a.isBefore(s)?t==="asc"?Yt:zt:zo:zt:Yt}}function jce(t,e){tt(ct`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const Uce="ascending",zce="descending",jL="indicatorDisabled",UL="columnSorting",zL="sortAction",YL=new Map([[Nw,Uce],[Dw,zce]]);function Yce(t,e,n,r){const i=[UL];if(r&&i.push(zL),n===!1)return i.push(jL),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(YL.get(o)),i}function Gce(){return Array.from(YL.values()).concat(zL,jL,UL)}function Kce(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:LL(u.type))(l,u,d)(c,h)}(0)}}function qce(t,e){Xce(t,e),e.add(t)}function Xce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pm(t,e,n){return(e=Jce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jce(t){var e=Zce(t,"string");return typeof e=="symbol"?e:e+""}function Zce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kw="columnSorting",Qce=50,$w="append",ehe="replace",zO=kw;$L(kw,Kce);oe.getSingleton().register("beforeColumnSort");oe.getSingleton().register("afterColumnSort");const rd=new WeakMap;var Wl=new WeakSet;class GL extends qe{constructor(){super(...arguments),qce(this,Wl),Pm(this,"columnStatesManager",null),Pm(this,"columnMetaCache",null),Pm(this,"pluginKey",kw),Pm(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return kw}static get PLUGIN_PRIORITY(){return Qce}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(rd.has(this.hot)&&rd.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),jce(rd.get(this.hot),this.pluginKey);return}this.enabled||(rd.set(this.hot,this.pluginKey),this.columnStatesManager=new xce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ka(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>bc(Wl,this,the).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bc(Wl,e,rhe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>bc(Wl,this,NR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bc(Wl,e,nhe).call(e,...r)}),this.hot.view&&bc(Wl,this,NR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=VL(r);WL(n,r)===!1||i===null||this.updateHeaderClasses(i)};rd.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:qa,position:"before",group:zO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zO)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new A$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Bce(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=UO(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:UO()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$w;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ht(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===$w)return[...o.slice(0,r),...o.slice(r+1),s];if(n===ehe)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(De(e)){const n=e[this.pluginKey];if(De(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):lt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);Vce(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(De(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||De(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(we(e,Gce()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,Yce(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ve(e.target,FL)}onAfterOnCellMouseDown(e,n){if(l_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function NR(){const t=this.getAllSavedSortSettings();if(De(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function the(t,e){const n=VL(e);if(WL(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);be(e,...P8(s?`${s}ending`:"none"))}}function nhe(t){t===!0&&this.hot.view&&bc(Wl,this,NR).call(this)}function rhe(t,e,n,r){l_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function pl(t,e,n){return(e=ihe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ihe(t){var e=ohe(t,"string");return typeof e=="symbol"?e:e+""}function ohe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class she{constructor(e,n){pl(this,"plugin",void 0),pl(this,"hot",void 0),pl(this,"endpoints",[]),pl(this,"settings",void 0),pl(this,"settingsType","array"),pl(this,"currentEndpoint",null),pl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),M(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();M(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;M(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?M(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):M(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){M(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];M(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),M(i,o=>{let s=[];M(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,M(e.ranges,r=>{M(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],M(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],M(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],M(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&M(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),M(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){tt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function ub(t){return t==null||isNaN(t)}function ahe(t,e){lhe(t,e),e.add(t)}function lhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uhe(t,e,n){return(e=che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function che(t){var e=hhe(t,"string");return typeof e=="symbol"?e:e+""}function hhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cb="columnSummary",dhe=220;var id=new WeakSet;class fhe extends qe{constructor(){super(...arguments),ahe(this,id),uhe(this,"endpoints",null)}static get PLUGIN_KEY(){return cb}static get PLUGIN_PRIORITY(){return dhe}isEnabled(){return!!this.hot.getSettings()[cb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[cb],this.endpoints=new she(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xm(id,e,ghe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xm(id,e,phe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xm(id,e,mhe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xm(id,e,whe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return ke(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=ub(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return ke(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=ub(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=ub(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return ke(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ct`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function ghe(){this.endpoints.initEndpoints()}function mhe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function phe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function whe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function vhe(t,e){KL(t,e),e.add(t)}function hb(t,e,n){KL(t,e),e.set(t,n)}function KL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sc(t,e){return t.get(u_(t,e))}function DR(t,e,n){return t.set(u_(t,e),n),n}function u_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lw=new WeakMap,Im=new WeakMap,Om=new WeakMap,YO=new WeakSet;class qL{constructor(){vhe(this,YO),hb(this,Lw,!0),hb(this,Im,null),hb(this,Om,new ResizeObserver(e=>u_(YO,this,yhe).call(this,e)))}setObservedElement(e){DR(Im,this,e)}unobserve(){Sc(Om,this).unobserve(Sc(Im,this))}observe(){DR(Lw,this,!0),Sc(Om,this).observe(Sc(Im,this))}destroy(){Sc(Om,this).disconnect()}}function yhe(t){if(Sc(Lw,this)||!Array.isArray(t)||!t.length){DR(Lw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}gt(qL,Fn);function wl(t,e,n){Che(t,e),e.set(t,n)}function Che(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return t.get(XL(t,e))}function ds(t,e,n){return t.set(XL(t,e),n),n}function XL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vl=new WeakMap,db=new WeakMap,fs=new WeakMap,ta=new WeakMap,na=new WeakMap,Am=new WeakMap,Xu=new WeakMap;class ql{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;wl(this,vl,void 0),wl(this,db,!1),wl(this,fs,null),wl(this,ta,void 0),wl(this,na,void 0),wl(this,Am,!0),wl(this,Xu,new qL),ds(vl,this,e),ds(db,this,n),ds(ta,this,this.createEditor()),ds(na,this,mt(ta,this).style),mt(Xu,this).setObservedElement(this.getInputElement()),mt(Xu,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){mt(na,this).left=`${e}px`,mt(na,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:en(this.getInputElement()),height:un(this.getInputElement())}}observeSize(){mt(Xu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){mt(na,this).display="block",ds(Am,this,!1)}hide(){mt(Xu,this).unobserve(),mt(Am,this)||(mt(na,this).display="none"),ds(Am,this,!0)}isVisible(){return mt(na,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return mt(vl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=mt(vl,this).createElement("div"),n=mt(vl,this).createElement("textarea");return e.style.display="none",ds(fs,this,mt(vl,this).createElement("div")),mt(fs,this).setAttribute("dir",mt(db,this)?"rtl":"ltr"),q(mt(fs,this),ql.CLASS_EDITOR_CONTAINER),mt(vl,this).body.appendChild(mt(fs,this)),q(e,ql.CLASS_EDITOR),q(n,ql.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),mt(fs,this).appendChild(e),e}getInputElement(){return mt(ta,this).querySelector(`.${ql.CLASS_INPUT}`)}getEditorElement(){return mt(ta,this)}destroy(){const e=mt(fs,this)?mt(fs,this).parentNode:null;mt(ta,this).parentNode.removeChild(mt(ta,this)),ds(ta,this,null),ds(na,this,null),mt(Xu,this).destroy(),e&&e.removeChild(mt(fs,this))}}gt(ql,Fn);function fb(t,e,n){return(e=bhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bhe(t){var e=She(t,"string");return typeof e=="symbol"?e:e+""}function She(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Rhe=250,Ehe=250;class JL{constructor(e){fb(this,"wasLastActionShow",!0),fb(this,"showDebounced",null),fb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Ehe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rhe;this.showDebounced=hg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}gt(JL,Fn);function The(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Mhe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function yl(t,e){const n={};return M(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function ma(t,e,n,r,i){M(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&_he(s,a,e,n,r,i)})})}function _he(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=The(s.className,r):a=Mhe(s.className,r)),o(t,e,"className",a)}function ZL(t){return`<span class="selected">✓</span>${t}`}function Fp(t,e){let n=!1;return Array.isArray(t)&&M(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function ry(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Le="---------";function Phe(){return{name:Le}}const fi="alignment";function xhe(){return{key:fi,name(){return this.getTranslatedPhrase(LT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${fi}:left`,name(){return this.getTranslatedPhrase(FT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:center`,name(){return this.getTranslatedPhrase(VT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:right`,name(){return this.getTranslatedPhrase(WT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:justify`,name(){return this.getTranslatedPhrase(BT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Le},{key:`${fi}:top`,name(){return this.getTranslatedPhrase(jT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:middle`,name(){return this.getTranslatedPhrase(UT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:bottom`,name(){return this.getTranslatedPhrase(zT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const iy="clear_column";function Ihe(){return{key:iy,name(){return this.getTranslatedPhrase(ET)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Rg="col_left";function Ohe(){return{key:Rg,name(){return this.getTranslatedPhrase(vT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Eg="col_right";function Ahe(){return{key:Eg,name(){return this.getTranslatedPhrase(yT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Tg="make_read_only";function Hhe(){return{key:Tg,checkable:!0,ariaChecked(){return Fp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(_w)},name(){let t=this.getTranslatedPhrase(_w);return Fp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=ZL(t)),t},callback(){const t=this.getSelectedRange(),e=Fp(t,(n,r)=>this.getCellMeta(n,r).readOnly);M(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const oy="redo";function Nhe(){return{key:oy,name(){return this.getTranslatedPhrase(RT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Mg="remove_col";function Dhe(){return{key:Mg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(bT,e)},callback(){this.alter("remove_col",vie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const sy="remove_row";function khe(){return{key:sy,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(CT,e)},callback(){this.alter("remove_row",yie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const ay="row_above";function $he(){return{key:ay,name(){return this.getTranslatedPhrase(pT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const ly="row_below";function Lhe(){return{key:ly,name(){return this.getTranslatedPhrase(wT)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Df="no_items";function Fhe(){return{key:Df,name(){return this.getTranslatedPhrase(mT)},disabled:!0,isCommand:!1}}const uy="undo";function Vhe(){return{key:uy,name(){return this.getTranslatedPhrase(ST)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Whe=[ay,ly,Rg,Eg,iy,sy,Mg,uy,oy,Tg,fi,Le,Df],Bhe={[Le]:Phe,[Df]:Fhe,[ay]:$he,[ly]:Lhe,[Rg]:Ohe,[Eg]:Ahe,[iy]:Ihe,[sy]:khe,[Mg]:Dhe,[uy]:Vhe,[oy]:Nhe,[Tg]:Hhe,[fi]:xhe};function QL(){const t={};return ke(Bhe,(e,n)=>{t[n]=e()}),t}function jhe(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(DT):this.getTranslatedPhrase(NT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Uhe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(kT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function zhe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase($T);return Fp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Vp))?ZL(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Vp);t.updateCommentMeta(n,r,{[Vp]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Yhe(t,e){eF(t,e),e.add(t)}function Ju(t,e,n){eF(t,e),e.set(t,n)}function eF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ghe(t,e,n){return(e=Khe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Khe(t){var e=qhe(t,"string");return typeof e=="symbol"?e:e+""}function qhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oa(t,e,n){return t.set(Rr(t,e),n),n}function He(t,e){return t.get(Rr(t,e))}function Rr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fw="comments",Xhe=60,Es="comment",Ld="value",tF="style",Vp="readOnly",od=Fw,kR=`plugin:${Fw}`;var dt=new WeakMap,Oo=new WeakMap,cy=new WeakMap,Wp=new WeakMap,$R=new WeakMap,Vw=new WeakMap,kr=new WeakSet;class Jhe extends qe{constructor(){super(...arguments),Yhe(this,kr),Ghe(this,"range",{}),Ju(this,dt,null),Ju(this,Oo,null),Ju(this,cy,!1),Ju(this,Wp,!1),Ju(this,$R,null),Ju(this,Vw,"")}static get PLUGIN_KEY(){return Fw}static get PLUGIN_PRIORITY(){return Xhe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Fw]}enablePlugin(){var e=this;this.enabled||(He(dt,this)||(Oa(dt,this,new ql(this.hot.rootDocument,this.hot.isRtl())),He(dt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr(kr,e,ode).call(e,...r)})),He(Oo,this)||Oa(Oo,this,new JL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Rr(kr,this,nde).call(this,n,a)),this.addHook("afterScroll",()=>Rr(kr,this,sde).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Rr(kr,this,GO).call(this,n)),this.addHook("beforeCompositionStart",n=>Rr(kr,this,GO).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr(kr,e,ade).call(e,...r)}),He(Oo,this).addLocalHook("hide",()=>this.hide()),He(Oo,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){He(Oo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(kR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Oa(Wp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(kR),this.hot._registerTimeout(()=>{Oa(Wp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:od}),r.addShortcut({keys:[["Escape"]],callback:()=>{He(dt,this).setValue(He(Vw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(dt,this).isVisible()&&He(dt,this).isFocused(),group:od}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(dt,this).isVisible()&&He(dt,this).isFocused(),group:od}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{He(dt,this).setValue(He(dt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:od})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(od)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Rr(kr,this,ede).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Rr(kr,this,Zhe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Rr(kr,this,tde).call(this)),this.eventManager.addEventListener(n,"focus",()=>Rr(kr,this,ide).call(this)),this.eventManager.addEventListener(n,"blur",()=>Rr(kr,this,rde).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Rr(kr,this,Qhe).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Wa(e.target,"TD","TBODY");return!!(n&&ve(n,"htCommentCell")&&Wa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=He(dt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Ld]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Es),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Ld)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Ld)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return He(Oo,this).cancelHiding(),He(dt,this).setValue((e=i[Es]?i[Es][Ld]:null)!==null&&e!==void 0?e:""),He(dt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){He(dt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!He(dt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;He(dt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(i,o,tF);v?He(dt,this).setSize(v.width,v.height):He(dt,this).resetSize();const y=c?0:f.getColumnWidth(a),E=l&&!u?un(g):0,{left:C,top:_,width:I,height:P}=g.getBoundingClientRect(),{width:T,height:A}=He(dt,this).getSize(),{innerWidth:G,innerHeight:U}=this.hot.rootWindow,V=this.hot.rootDocument.documentElement,X=_n(this.hot.rootDocument),ne=TE(this.hot.rootWindow)?X:0,Q=ME(this.hot.rootWindow)?X:0;let te=C+h.scrollX+y,pe=_+h.scrollY+E;this.hot.isRtl()&&(te-=T+y),this.hot.isLtr()&&C+I+T>G-ne?te=C+h.scrollX-T-1:this.hot.isRtl()&&te<-(V.scrollWidth-V.clientWidth)&&(te=C+h.scrollX+y+1),_+A>U-Q&&(pe-=A-P+1),He(dt,this).setPosition(te,pe),He(dt,this).setReadOnlyState(this.getCommentMeta(i,o,Vp)),He(dt,this).observeSize()}focusEditor(){He(dt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Es];let o;i?(o=Qn(i),fg(o,r)):o=r,this.hot.setCellMeta(e,n,Es,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Es])return i[Es][r]}addToContextMenu(e){e.items.push({name:Le},jhe(this),Uhe(this),zhe(this))}getEditorInputElement(){return He(dt,this).getInputElement()}destroy(){var e,n;(e=He(dt,this))===null||e===void 0||e.destroy(),(n=He(Oo,this))===null||n===void 0||n.destroy(),super.destroy()}}function Zhe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!He(cy,this)&&!this.targetIsCommentTextArea(t)){const e=Wa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Qhe(t){t.stopPropagation()}function ede(t){const{rootDocument:e}=this.hot;if(!(He(cy,this)||He(dt,this).isFocused()||ve(t.target,"wtBorder")||He($R,this)===t.target||!He(dt,this)))if(Oa($R,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));He(Oo,this).show(n)}else Da(t.target,e)&&!this.targetIsCommentTextArea(t)&&He(Oo,this).hide()}function tde(){Oa(cy,this,!1)}function nde(t,e){e[Es]&&e[Es][Ld]&&q(t,e.commentedCellClassName)}function rde(){Oa(Vw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function ide(){Oa(Vw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(kR)}function ode(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[tF]:{width:t,height:e}})}function GO(t){He(dt,this).isFocused()&&xi(t)}function sde(){He(Wp,this)||this.hide()}function ade(){const t=He(dt,this).getEditorElement();we(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function gb(t,e,n){return(e=lde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lde(t){var e=ude(t,"string");return typeof e=="symbol"?e:e+""}function ude(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nF{constructor(e){gb(this,"hot",void 0),gb(this,"commands",{}),gb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=cde(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||ln(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),M(u,c=>c.apply(this.hot,r))}}function cde(t,e){let n;return M(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function mb(t,e,n){return(e=hde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hde(t){var e=dde(t,"string");return typeof e=="symbol"?e:e+""}function dde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;mb(this,"hot",void 0),mb(this,"predefinedItems",QL()),mb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,ke(e,(r,i)=>{let o="";r.name===Le?(n[Le]=r,o=Le):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return fde(e,this.defaultOrderPattern,this.predefinedItems)}}function fde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),De(i)?ke(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),De(o)?cn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):M(i,(o,s)=>{let a=n[o];!a&&Whe.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),De(o)&&cn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ra(t,e,n){return(e=gde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gde(t){var e=mde(t,"string");return typeof e=="symbol"?e:e+""}function mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pde{constructor(e,n){ra(this,"top",void 0),ra(this,"topRelative",void 0),ra(this,"left",void 0),ra(this,"leftRelative",void 0),ra(this,"scrollTop",void 0),ra(this,"scrollLeft",void 0),ra(this,"cellHeight",void 0),ra(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function sd(t,e,n){wde(t,e),e.set(t,n)}function wde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(iF(t,e))}function Hm(t,e,n){return t.set(iF(t,e),n),n}function iF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rr=new WeakMap,yr=new WeakMap,Cr=new WeakMap,pb=new WeakMap,Zu=new WeakMap;class vde{constructor(e){sd(this,rr,void 0),sd(this,yr,void 0),sd(this,Cr,void 0),sd(this,pb,!1),sd(this,Zu,{above:0,below:0,left:0,right:0}),Hm(pb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Oe(Zu,this)[e]=n,this}setElement(e){return Hm(rr,this,e),this}setParentElement(e){return Hm(yr,this,e),this}updatePosition(e){Hm(Cr,this,new pde(e,Oe(rr,this).ownerDocument.defaultView)),Oe(pb,this)?(Oe(Cr,this).fitsBelow(Oe(rr,this))?this.setPositionBelowCursor():Oe(Cr,this).fitsAbove(Oe(rr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Oe(rr,this).dir==="rtl"?Oe(Cr,this).fitsOnLeft(Oe(rr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Oe(Cr,this).fitsOnRight(Oe(rr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Oe(Zu,this).above+Oe(Cr,this).top-Oe(rr,this).offsetHeight;if(Oe(yr,this)){const r=Oe(yr,this).ownerDocument.defaultView.getComputedStyle(Oe(yr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Cr,this).top+Oe(Cr,this).cellHeight-Oe(rr,this).scrollHeight+i+o}Oe(rr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Oe(Zu,this).below+Oe(Cr,this).top+1;if(Oe(yr,this)){const r=Oe(yr,this).ownerDocument.defaultView.getComputedStyle(Oe(yr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Cr,this).top-i-o-1}Oe(rr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Oe(Cr,this).left;if(Oe(yr,this)){const n=Oe(yr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(yr,this).querySelector(".htCore")).borderRightWidth,10);e+=Oe(Cr,this).cellWidth+r}else e+=Oe(Zu,this).right;Oe(rr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Oe(Zu,this).left+Oe(Cr,this).left-Oe(rr,this).offsetWidth;if(Oe(yr,this)){const n=Oe(yr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(yr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Oe(rr,this).style.left=`${e}px`}}function oF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ye(e,-1,g()-1);function a(y,E){const C=g()-1;return y<0&&(y=C),y>C&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(E===1?++y:--y,E)),y)}function l(y){y>-1&&y<g()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:v}}function yde(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function LR(t){return ln(t,"submenu")}function FR(t){return new RegExp(Le,"i").test(t.name)}function Bp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function KO(t){return ln(t,"disableSelection")}function Cde(t){return ve(t,"htSeparator")}function bde(t){return ve(t,"htSubmenu")}function Sde(t){return ve(t,"htDisabled")}function Rde(t){return ve(t,"htSelectionDisabled")}function Ede(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function sF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Tde(t,e){let n=t.slice(0);return n.reverse(),n=sF(n,e),n.reverse(),n}function Mde(t){const e=[];return M(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function _de(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le,n=t.slice(0);return n=sF(n,e),n=Tde(n,e),n=Mde(n),n}function Pde(t){return t.checkable===!0}function xde(t){return oF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Cde(r)||Sde(r)||Rde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Ide(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const aF="menu",qO=aF;function Ode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Ide(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:aF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${qO}:${u}`:qO}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Ade(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Ko(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Bp(a,t)&&!KO(a)&&!FR(a);be(n,[...Pde(a)?[y8(),Tf(c),mk(h)]:[v8(),Tf(u)],...d?[Eu(-1)]:[],...Bp(a,t)?[M8()]:[],...LR(a)?[Ci(!1)]:[]])}n.className="",n.appendChild(l),FR(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):_u(l,u),Bp(a,t)?q(n,"htDisabled"):KO(a)?q(n,"htSelectionDisabled"):LR(a)&&q(n,"htSubmenu")}}function wb(t,e,n){Hde(t,e),e.set(t,n)}function Hde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vo(t,e,n){return(e=Nde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nde(t){var e=Dde(t,"string");return typeof e=="symbol"?e:e+""}function Dde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vb(t,e,n){return t.set(lF(t,e),n),n}function Cl(t,e){return t.get(lF(t,e))}function lF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const XO=215;var ad=new WeakMap,Nm=new WeakMap,Dm=new WeakMap;class Ch{get tableBorderWidth(){return Cl(Dm,this)===void 0&&this.hotMenu&&vb(Dm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Cl(Dm,this)}constructor(e,n){var r=this;vo(this,"hot",void 0),vo(this,"options",void 0),vo(this,"eventManager",new Ri(this)),vo(this,"container",void 0),vo(this,"positioner",void 0),vo(this,"hotMenu",null),vo(this,"hotSubMenus",{}),vo(this,"parentMenu",void 0),vo(this,"menuItems",null),vo(this,"origOutsideClickDeselects",null),wb(this,ad,void 0),wb(this,Nm,void 0),wb(this,Dm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:XO,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new vde(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=au(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Cl(ad,this)}getKeyboardShortcutsCtrl(){return Cl(Nm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=hg(a=>this.openSubMenu(a),300),n=this.options.minWidth||XO;let r=!1,i=Va(this.menuItems,a=>(a.key===Df&&(r=!0),Ede(a,this.hot)));if(i.length<1&&!r)i.push(QL()[Df]);else if(i.length===0)return;i=_de(i,Le);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Ade(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Cl(ad,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),dR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!dR()||!ja(a))&&o&&this.hasSelectedItem()&&(Bo()||NE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),vb(ad,this,xde(this.hotMenu)),vb(Nm,this,Ode(this)),Cl(Nm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Cl(ad,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);be(r,[Ci(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!bde(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Ch(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&be(n,[Ci(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&be(i,[Ci(!1)])}}closeAllSubMenus(){M(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?yde(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||FR(e)||Bp(e,this.hot)||LR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=Sn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?un(this.hotMenu.getCell(c,0)):0;return l+(u.name===Le?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(lt(r)&&(r=r.call(this.hot),r===null||Ht(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&be(this.hotMenu.rootElement,[w8(),Eu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Da(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Da(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&Da(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}gt(Ch,Fn);function kde(t,e){$de(t,e),e.add(t)}function $de(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yb(t,e,n){return(e=Lde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lde(t){var e=Fde(t,"string");return typeof e=="symbol"?e:e+""}function Fde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function km(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fd="contextMenu",Vde=70,JO=Fd;oe.getSingleton().register("afterContextMenuDefaultOptions");oe.getSingleton().register("beforeContextMenuShow");oe.getSingleton().register("afterContextMenuShow");oe.getSingleton().register("afterContextMenuHide");oe.getSingleton().register("afterContextMenuExecute");var ld=new WeakSet;class hy extends qe{constructor(){super(...arguments),kde(this,ld),yb(this,"commandExecutor",new nF(this.hot)),yb(this,"itemsFactory",null),yb(this,"menu",null)}static get PLUGIN_KEY(){return Fd}static get PLUGIN_PRIORITY(){return Vde}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ay,ly,Le,Rg,Eg,Le,sy,Mg,Le,uy,oy,Le,Tg,Le,fi]}isEnabled(){return!!this.hot.getSettings()[Fd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Fd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Ch(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>km(ld,this,Bde).call(this)),this.menu.addLocalHook("afterOpen",()=>km(ld,this,jde).call(this)),this.menu.addLocalHook("afterClose",()=>km(ld,this,Ude).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>km(ld,this,Wde).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=ry(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:JO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JO)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;ke(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new rF(this.hot,hy.DEFAULT_ITEMS);const e=this.hot.getSettings()[Fd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),M(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Wde(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=ry(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Bde(){this.hot.runHooks("beforeContextMenuShow",this)}function jde(){this.hot.runHooks("afterContextMenuShow",this)}function Ude(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}hy.SEPARATOR={name:Le};function zde(t){return{key:"copy",name(){return this.getTranslatedPhrase(TT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Yde(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(PT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Gde(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(_T,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Kde(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(MT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function qde(t){return{key:"cut",name(){return this.getTranslatedPhrase(xT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Xde{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Jde{constructor(){this.clipboardData=new Xde}preventDefault(){}composedPath(){return[]}}function Zde(t,e){uF(t,e),e.add(t)}function Qu(t,e,n){uF(t,e),e.set(t,n)}function uF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(Ic(t,e))}function ec(t,e,n){return t.set(Ic(t,e),n),n}function Ic(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ia=new WeakMap,Cb=new WeakMap,ud=new WeakMap,VR=new WeakMap,WR=new WeakMap,cd=new WeakMap,hd=new WeakSet;class Qde{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Zde(this,hd),Qu(this,ia,void 0),Qu(this,Cb,void 0),Qu(this,ud,void 0),Qu(this,VR,void 0),Qu(this,WR,void 0),Qu(this,cd,void 0),ec(Cb,this,n),ec(ud,this,r),ec(VR,this,i),ec(WR,this,o),ec(cd,this,s)}setSelectedRange(e){ec(ia,this,e)}getCellsRange(){if(sr(Cb,this).call(this)===0||sr(ud,this).call(this)===0)return null;const{row:e,col:n}=sr(ia,this).getTopStartCorner(),{row:r,col:i}=sr(ia,this).getBottomEndCorner(),o=Ic(hd,this,efe).call(this,e,r),s=Ic(hd,this,bb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(sr(ud,this).call(this)===0||sr(cd,this).call(this)===0)return null;const{col:e}=sr(ia,this).getTopStartCorner(),{col:n}=sr(ia,this).getBottomEndCorner(),r=Ic(hd,this,bb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(sr(ud,this).call(this)===0||sr(cd,this).call(this)===0)return null;const{col:e}=sr(ia,this).getTopStartCorner(),{col:n}=sr(ia,this).getBottomEndCorner(),r=Ic(hd,this,bb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-sr(cd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function bb(t,e){return Math.min(e,Math.max(t+sr(WR,this).call(this)-1,t))}function efe(t,e){return Math.min(e,Math.max(t+sr(VR,this).call(this)-1,t))}function cF(t){const e=[],n=[];return M(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function tfe(t,e){hF(t,e),e.add(t)}function oa(t,e,n){hF(t,e),e.set(t,n)}function hF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){return(e=nfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nfe(t){var e=rfe(t,"string");return typeof e=="symbol"?e:e+""}function rfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pr(t,e){return t.get(Ir(t,e))}function Vi(t,e,n){return t.set(Ir(t,e),n),n}function Ir(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterCopyLimit");oe.getSingleton().register("modifyCopyableRange");oe.getSingleton().register("beforeCut");oe.getSingleton().register("afterCut");oe.getSingleton().register("beforePaste");oe.getSingleton().register("afterPaste");oe.getSingleton().register("beforeCopy");oe.getSingleton().register("afterCopy");const Sb="copyPaste",ife=80,ofe=["fragmentSelection"],ZO=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var BR=new WeakMap,jR=new WeakMap,UR=new WeakMap,tc=new WeakMap,$m=new WeakMap,Lm=new WeakMap,nc=new WeakMap,Ww=new WeakMap,zr=new WeakSet;class sfe extends qe{constructor(){super(...arguments),tfe(this,zr),dd(this,"columnsLimit",1/0),dd(this,"rowsLimit",1/0),dd(this,"pasteMode","overwrite"),dd(this,"uiContainer",this.hot.rootDocument.body),oa(this,BR,!1),oa(this,jR,!1),oa(this,UR,!1),oa(this,tc,"cells-only"),oa(this,$m,!1),oa(this,Lm,!1),oa(this,nc,new Qde({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),oa(this,Ww,!1),dd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Sb}static get SETTING_KEYS(){return[Sb,...ofe]}static get PLUGIN_PRIORITY(){return ife}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Sb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Vi(BR,this,this.getSetting("copyColumnHeaders")),Vi(jR,this,this.getSetting("copyColumnGroupHeaders")),Vi(UR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Ir(zr,this,ufe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(zr,r,cfe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Ir(zr,this,hfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),If()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(zr,r,dfe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(zr,r,ffe).call(r,...o)}),this.addHook("afterSelection",()=>Ir(zr,this,gfe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Vi(tc,this,e),Vi($m,this,!0),Ir(zr,this,QO).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Vi(Lm,this,!0),Ir(zr,this,QO).call(this,"cut")}getRangedCopyableData(e){return Xd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=cF(e);return M(r,o=>{const s=[];M(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Jde;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Pr(nc,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Pr(tc,this)==="column-headers-only"?n.set("headers",Pr(nc,this).getMostBottomColumnHeadersRange()):(Pr(tc,this)==="with-column-headers"?n.set("headers",Pr(nc,this).getMostBottomColumnHeadersRange()):Pr(tc,this)==="with-column-group-headers"&&n.set("headers",Pr(nc,this).getAllColumnHeadersRange()),n.set("cells",Pr(nc,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,g===!0)continue;d=v,h=a;const y=[],E=o.length%r;for(;y.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:_}=this.hot.getCellMeta(s,h);if(h=_+1,C===!0)continue;f=_;const I=y.length%i;y.push(e[E][I])}o.push(y)}return Vi(Ww,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Pr($m,this)||this.isEditorOpened()||Uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Yd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Vi($m,this,!1);const o=this.getRangedData(this.copyableRanges),s=Ir(zr,this,afe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Xd(o);if(e&&e.clipboardData){const u=vR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[ZO,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Vi(tc,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Pr(Lm,this)||this.isEditorOpened()||Uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Yd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Vi(Lm,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Xd(o);if(e&&e.clipboardData){const l=vR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[ZO,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Yd(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Av(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=n$(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Eie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function QO(t){if(If()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&Pk(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function afe(t){const{rows:e}=cF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function lfe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&PE(r)}}}function dF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&xE(r)}}}function ufe(t){t.items.push({name:"---------"},zde(this)),Pr(BR,this)&&t.items.push(Kde(this)),Pr(jR,this)&&t.items.push(Gde(this)),Pr(UR,this)&&t.items.push(Yde(this)),t.items.push(qde(this))}function cfe(t,e,n,r,i){Pr(Ww,this)&&(i.value=!0),Vi(Ww,this,!1)}function hfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function dfe(){Ir(zr,this,dF).call(this)}function ffe(){Ir(zr,this,lfe).call(this)}function gfe(){Ir(zr,this,dF).call(this)}function fF(t,e){return`border_row${t}col${e}`}function Vd(){return{width:1,color:"#000"}}function Hs(){return{hide:!0}}function mfe(){return{width:1,color:"#000",cornerVisible:!1}}function Rb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function fd(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Eb(t,e){return{id:fF(t,e),border:mfe(),row:t,col:e,top:Hs(),bottom:Hs(),start:Hs(),end:Hs()}}function pfe(t,e){return ln(e,"border")&&e.border&&(t.border=e.border),ln(e,"top")&&le(e.top)&&(e.top?(De(e.top)||(e.top=Vd()),t.top=e.top):(e.top=Hs(),t.top=e.top)),ln(e,"bottom")&&le(e.bottom)&&(e.bottom?(De(e.bottom)||(e.bottom=Vd()),t.bottom=e.bottom):(e.bottom=Hs(),t.bottom=e.bottom)),ln(e,"start")&&le(e.start)&&(e.start?(De(e.start)||(e.start=Vd()),t.start=e.start):(e.start=Hs(),t.start=e.start)),ln(e,"end")&&le(e.end)&&(e.end?(De(e.end)||(e.end=Vd()),t.end=e.end):(e.end=Hs(),t.end=e.end)),t}function Bs(t,e){let n=!1;return M(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!ln(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function dy(t){return`<span class="selected">✓</span>${t}`}function wfe(t){return t.some(e=>le(e.left)||le(e.right))}function vfe(t){return t.some(e=>le(e.start)||le(e.end))}const yfe=new Map([["left","start"],["right","end"]]);function Cfe(t){var e;return(e=yfe.get(t))!==null&&e!==void 0?e:t}function bfe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(qT);return Bs(this,"bottom")&&(e=dy(e)),e},callback(e,n){const r=Bs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function Sfe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(XT);return Bs(this,e)&&(n=dy(n)),n},callback(n,r){const i=Bs(this,e);t.prepareBorder(r,e,i)}}}function Rfe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(JT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Bs(this)}}}function Efe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(KT);return Bs(this,e)&&(n=dy(n)),n},callback(n,r){const i=Bs(this,e);t.prepareBorder(r,e,i)}}}function Tfe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(GT);return Bs(this,"top")&&(e=dy(e)),e},callback(e,n){const r=Bs(this,"top");t.prepareBorder(n,"top",r)}}}function Mfe(t,e){_fe(t,e),e.add(t)}function _fe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pfe(t,e,n){return(e=xfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xfe(t){var e=Ife(t,"string");return typeof e=="symbol"?e:e+""}function Ife(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jp="customBorders",Ofe=90;var Tb=new WeakSet;class Afe extends qe{constructor(){super(...arguments),Mfe(this,Tb),Pfe(this,"savedBorders",[])}static get PLUGIN_KEY(){return jp}static get PLUGIN_PRIORITY(){return Ofe}isEnabled(){return!!this.hot.getSettings()[jp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>e1(Tb,this,Hfe).call(this,e)),this.addHook("init",()=>e1(Tb,this,Nfe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Rb(n));const o=Zc(e),s=Hf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});M(e,a=>{s(a).forAll((l,u)=>{M(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Cfe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Zc(e),r=Hf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return M(e,o=>{r(o).forAll((s,a)=>{M(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(fd(l))})})}),i}clearBorders(e){e?this.setBorders(e):(M(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Eb(e,n);r&&(a=pfe(a,r),M(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",fd(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=Eb(o,s);let l=0;o===e.from.row&&ln(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&ln(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&ln(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&ln(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",fd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=fF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Eb(e,n):o=Rb(o),i?(o[r]=Hs(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",fd(o)))):(o[r]=Vd(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",fd(o)))}prepareBorder(e,n,r){M(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){M(e,n=>{const r=Rb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Sn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){M(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){M(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):M(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return M(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return M(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):M(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);M(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[jp];if(Array.isArray(e)){const n=Qn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=wfe(e),r=vfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Hfe(t){this.hot.getSettings()[jp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(YT)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Tfe(this),Efe(this),bfe(this),Sfe(this),Rfe(this)]}})}function Nfe(){this.changeBorderSettings()}function Dfe(t,e){kfe(t,e),e.add(t)}function kfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mb(t,e,n){return(e=$fe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $fe(t){var e=Lfe(t,"string");return typeof e=="symbol"?e:e+""}function Lfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const n1="dragToScroll",Ffe=100;var _b=new WeakSet;class Vfe extends qe{constructor(){super(...arguments),Dfe(this,_b),Mb(this,"boundaries",null),Mb(this,"callback",null),Mb(this,"listening",!1)}static get PLUGIN_KEY(){return n1}static get PLUGIN_PRIORITY(){return Ffe}isEnabled(){return!!this.hot.getSettings()[n1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>t1(_b,this,r1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>t1(_b,this,r1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=au(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function r1(t){if(ja(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Wfe(t,e){gF(t,e),e.add(t)}function Bfe(t,e,n){gF(t,e),e.set(t,n)}function gF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e,n){return(e=jfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jfe(t){var e=Ufe(t,"string");return typeof e=="symbol"?e:e+""}function Ufe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zfe(t,e){return t.get(gi(t,e))}function mF(t,e,n){return t.set(gi(t,e),n),n}function gi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterDropdownMenuDefaultOptions");oe.getSingleton().register("beforeDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuHide");oe.getSingleton().register("afterDropdownMenuExecute");const Up="dropdownMenu",Yfe=230,kf="changeType",xb=Up;var fy=new WeakMap,ji=new WeakSet;class gy extends qe{static get PLUGIN_KEY(){return Up}static get PLUGIN_PRIORITY(){return Yfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Rg,Eg,Le,Mg,Le,iy,Le,Tg,Le,fi]}constructor(e){super(e),Wfe(this,ji),Pb(this,"commandExecutor",new nF(this.hot)),Pb(this,"itemsFactory",null),Pb(this,"menu",null),Bfe(this,fy,!1),this.hot.addHook("afterGetColHeader",(n,r)=>gi(ji,this,Kfe).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Up]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new rF(this.hot,gy.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gi(ji,e,ege).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gi(ji,e,Qfe).call(e,...o)});const n=this.hot.getSettings()[Up],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Ch(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>gi(ji,this,qfe).call(this)),this.menu.addLocalHook("afterOpen",()=>gi(ji,this,Xfe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>gi(ji,this,Jfe).call(this,o)),this.menu.addLocalHook("afterClose",()=>gi(ji,this,Zfe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),M(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=ry(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${kf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:xb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:xb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>gi(ji,this,Gfe).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function pF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Gfe(t){if(ve(t.target,kf)){const e=ry(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),mF(fy,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Kfe(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${kf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=kf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(be(s,[Tu(),Tf(" ")]),be(e,[dk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function qfe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Xfe(){this.hot.runHooks("afterDropdownMenuShow",this),gi(ji,this,pF).call(this,this.menu)}function Jfe(t){gi(ji,this,pF).call(this,t)}function Zfe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Qfe(t){return zfe(fy,this)?null:t}function ege(t){ve(t.target,kf)&&mF(fy,this,!0)}gy.SEPARATOR={name:Le};function i1(t,e,n){return(e=tge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tge(t){var e=nge(t,"string");return typeof e=="symbol"?e:e+""}function nge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rge{constructor(e){i1(this,"hot",void 0),i1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function o1(t,e,n){return(e=ige(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ige(t){var e=oge(t,"string");return typeof e=="symbol"?e:e+""}function oge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){o1(this,"dataProvider",void 0),o1(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=io(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=cn(io(c_.DEFAULT_OPTIONS),n),n=cn(n,e),n.filename=wE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function sge(t,e){age(t,e),e.add(t)}function age(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wF="\r",lge='"',uge=`
`,cge="=",hge="+",dge="-",fge="@",gge="	";var Ib=new WeakSet;class mge extends c_{constructor(){super(...arguments),sge(this,Ib)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Ue(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),M(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Et(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=s1(Ib,this,wge).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=s1(Ib,this,pge).call(this,i)),(n||i.indexOf(wF)>=0||i.indexOf(lge)>=0||i.indexOf(uge)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function pge(t){return t.startsWith(cge)||t.startsWith(hge)||t.startsWith(dge)||t.startsWith(fge)||t.startsWith(gge)||t.startsWith(wF)?`'${t}`:t}function wge(t,e){return e.test(t)?`'${t}`:t}const vge="csv",zR={[vge]:mge};function yge(t,e,n){return typeof zR[t]=="function"?new zR[t](e,n):null}const Cge="exportFile",bge=240;class Sge extends qe{static get PLUGIN_KEY(){return Cge}static get PLUGIN_PRIORITY(){return bge}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!zR[e])throw new Error(`Export format type "${e}" is not supported.`);return yge(e,new rge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function rc(t,e,n){return(e=Rge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rge(t){var e=Ege(t,"string");return typeof e=="symbol"?e:e+""}function Ege(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _g{constructor(e,n){let{id:r,stateless:i=!0}=n;rc(this,"hot",void 0),rc(this,"id",void 0),rc(this,"elements",[]),rc(this,"hidden",!1),rc(this,"stateId",""),rc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Gv)}getElements(){return this.elements}reset(){M(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),M(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}gt(_g,Fn);const $f={};function Ua(t,e){if(!$f[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=$f[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Xl(t){if(!$f[t])throw Error(`Filter condition "${t}" does not exist.`);return $f[t].descriptor}function fn(t,e,n){n.key=t,$f[t]={condition:e,descriptor:n}}const An="none";function Tge(){return!0}fn(An,Tge,{name:Kv,inputsCount:0,showOperators:!1});const Qd="empty";function Mge(t){return Gt(t.value)}fn(Qd,Mge,{name:iM,inputsCount:0,showOperators:!0});const zp="not_empty";function _ge(t,e){return!Ua(Qd,e)(t)}fn(zp,_ge,{name:oM,inputsCount:0,showOperators:!0});const ef="eq";function Pge(t,e){let[n]=e;return Et(t.value).toLocaleLowerCase(t.meta.locale)===Et(n)}fn(ef,Pge,{name:sM,inputsCount:1,showOperators:!0});const Yp="neq";function xge(t,e){return!Ua(ef,e)(t)}fn(Yp,xge,{name:aM,inputsCount:1,showOperators:!0});const vF="gt";function Ige(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}fn(vF,Ige,{name:dM,inputsCount:1,showOperators:!0});const yF="gte";function Oge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}fn(yF,Oge,{name:fM,inputsCount:1,showOperators:!0});const CF="lt";function Age(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}fn(CF,Age,{name:gM,inputsCount:1,showOperators:!0});const bF="lte";function Hge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}fn(bF,Hge,{name:mM,inputsCount:1,showOperators:!0});const h_="date_after";function Nge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}fn(h_,Nge,{name:vM,inputsCount:1,showOperators:!0});const d_="date_before";function Dge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}fn(d_,Dge,{name:yM,inputsCount:1,showOperators:!0});const Bw="between";function kge(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Ua(d_,[o]),a=Ua(h_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}fn(Bw,kge,{name:pM,inputsCount:2,showOperators:!0});const SF="not_between";function $ge(t,e){return!Ua(Bw,e)(t)}fn(SF,$ge,{name:wM,inputsCount:2,showOperators:!0});const RF="begins_with";function Lge(t,e){let[n]=e;return Et(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Et(n))}fn(RF,Lge,{name:lM,inputsCount:1,showOperators:!0});const EF="ends_with";function Fge(t,e){let[n]=e;return Et(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Et(n))}fn(EF,Fge,{name:uM,inputsCount:1,showOperators:!0});const f_="contains";function Vge(t,e){let[n]=e;return Et(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Et(n))>=0}fn(f_,Vge,{name:cM,inputsCount:1,showOperators:!0});const TF="not_contains";function Wge(t,e){return!Ua(f_,e)(t)}fn(TF,Wge,{name:hM,inputsCount:1,showOperators:!0});const MF="date_tomorrow";function Bge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}fn(MF,Bge,{name:bM,inputsCount:0});const _F="date_today";function jge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}fn(_F,jge,{name:CM,inputsCount:0});const PF="date_yesterday";function Uge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}fn(PF,Uge,{name:SM,inputsCount:0});Lk();function zge(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Pg(t){const e=new Set(t);return function(n){return e.has(n)}}function g_(t){return t??""}function YR(t){return Array.from(new Set(t)).map(e=>g_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function a1(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Pg(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:zge(a,n)};r&&r(u),i.push(u)}),i}const Jl="by_value";function Yge(t,e){let[n]=e;return n(t.value)}fn(Jl,Yge,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Pg(e)]},showOperators:!1});const Lf={};function Gge(t){if(!Lf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Lf[t].func;return function(n,r){return e(n,r)}}function Kge(t){return Lf[t].name}function m_(t,e,n){Lf[t]={name:e,func:n}}const La="conjunction",qge=TM;function Xge(t,e){return t.every(n=>n.func(e))}m_(La,qge,Xge);const jw="disjunction",Jge=qv;function Zge(t,e){return t.some(n=>n.func(e))}m_(jw,Jge,Zge);const p_="disjunctionWithExtraCondition",Qge=qv;function eme(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}m_(p_,Qge,eme);const tme="numeric",xF="text",nme="date",l1={[tme]:[An,Le,Qd,zp,Le,ef,Yp,Le,vF,yF,CF,bF,Bw,SF],[xF]:[An,Le,Qd,zp,Le,ef,Yp,Le,RF,EF,Le,f_,TF],[nme]:[An,Le,Qd,zp,Le,ef,Yp,Le,d_,h_,Bw,Le,MF,_F,PF]};function rme(t){const e=[];let n=t;return l1[n]||(n=xF),M(l1[n],r=>{let i;r===Le?i={name:Le}:i=io(Xl(r)),e.push(i)}),e}function gd(t,e,n){return(e=ime(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ime(t){var e=ome(t,"string");return typeof e=="symbol"?e:e+""}function ome(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ob="built",Ab="building",u1=["click","input","keydown","keypress","keyup","focus","blur","change"];let to=class IF{static get DEFAULTS(){return io({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){gd(this,"hot",void 0),gd(this,"eventManager",new Ri(this)),gd(this,"options",void 0),gd(this,"_element",void 0),gd(this,"buildState",void 0),this.hot=e,this.options=cn(IF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Ab?this._element:this.buildState===Ob?(this.update(),this._element):(this.buildState=Ab,this.build(),this.buildState=Ob,this._element)}isBuilt(){return this.buildState===Ob}translateIfPossible(e){return typeof e=="string"&&e.startsWith(gr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Ab),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)M(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),ke(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),M(u1,r=>e(n,r))}else M(u1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};gt(to,Fn);function sme(t,e){OF(t,e),e.add(t)}function ame(t,e,n){OF(t,e),e.set(t,n)}function OF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fm(t,e){return t.get(w_(t,e))}function lme(t,e,n){return t.set(w_(t,e),n),n}function w_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ic=new WeakMap,c1=new WeakSet;class Fa extends to{static get DEFAULTS(){return io({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,cn(Fa.DEFAULTS,n)),sme(this,c1),ame(this,ic,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>w_(c1,this,ume).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");lme(ic,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Fm(ic,this).type=this.options.type,Fm(ic,this).placeholder=this.translateIfPossible(this.options.placeholder),Fm(ic,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Fm(ic,this).focus()}}function ume(t){this.options.value=t.target.value}function cme(t,e){AF(t,e),e.add(t)}function md(t,e,n){AF(t,e),e.set(t,n)}function AF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oc(t,e,n){return t.set(tf(t,e),n),n}function Ft(t,e){return t.get(tf(t,e))}function tf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rn=new WeakMap,Vm=new WeakMap,Wm=new WeakMap,Hb=new WeakMap,Bm=new WeakMap,jm=new WeakSet;class Ff extends to{static get DEFAULTS(){return io({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,cn(Ff.DEFAULTS,n)),cme(this,jm),md(this,Rn,null),md(this,Vm,[]),md(this,Wm,void 0),md(this,Hb,void 0),md(this,Bm,void 0),this.registerHooks()}getMenu(){return Ft(Rn,this)}registerHooks(){this.addLocalHook("click",()=>tf(jm,this,fme).call(this))}setItems(e){oc(Vm,this,this.translateNames(e)),Ft(Rn,this)&&Ft(Rn,this).setMenuItems(Ft(Vm,this))}translateNames(e){return M(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),oc(Rn,this,new Ch(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ft(Rn,this).setMenuItems(Ft(Vm,this));const e=new to(this.hot,{className:"htUISelectCaption"}),n=new to(this.hot,{className:"htUISelectDropdown"});oc(Wm,this,e),oc(Hb,this,e.element),oc(Bm,this,n),this.hot.getSettings().ariaTags&&(be(n.element,[Tu()]),be(this._element,[hk()])),M([e,n],r=>this._element.appendChild(r.element)),Ft(Rn,this).addLocalHook("select",r=>tf(jm,this,hme).call(this,r)),Ft(Rn,this).addLocalHook("afterClose",()=>tf(jm,this,dme).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ft(Rn,this).hot.getTranslatedPhrase(Kv),Ft(Hb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ft(Rn,this)&&(Ft(Rn,this).open(),Ft(Rn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ft(Rn,this).getNavigator().toFirstItem(),Ft(Rn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ft(Rn,this)&&Ft(Rn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ft(Rn,this)&&(Ft(Rn,this).destroy(),oc(Rn,this,null)),Ft(Wm,this)&&Ft(Wm,this).destroy(),Ft(Bm,this)&&Ft(Bm,this).destroy(),super.destroy()}}function hme(t){t.name!==Le&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function dme(){this.runLocalHooks("afterClose")}function fme(){this.openOptions()}function gme(t,e){mme(t,e),e.add(t)}function mme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h1(t,e,n){return(e=pme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pme(t){var e=wme(t,"string");return typeof e=="symbol"?e:e+""}function wme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nb=new WeakSet;class GR extends _g{constructor(e,n){super(e,{id:n.id,stateless:!1}),gme(this,Nb),h1(this,"name",""),h1(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Ff(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Fa(this.hot,{placeholder:OM})),this.elements.push(new Fa(this.hot,{placeholder:AM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>d1(Nb,this,vme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),M(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>d1(Nb,this,yme).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=io(e.command);n.name.startsWith(Kt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),M(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Xl(An),n=[];return M(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Xl(e?e.name:An);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||M(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Ff)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Fa)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Xl(An)];if(e!==null){const{visualIndex:r}=e;n=rme(this.hot.getDataType(0,r,this.hot.countRows(),r))}M(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function vme(t){M(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function yme(t){mh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),xi(t))}function f1(t,e,n){Cme(t,e),e.set(t,n)}function Cme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pd(t,e){return t.get(HF(t,e))}function g1(t,e,n){return t.set(HF(t,e),n),n}function HF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sc=new WeakMap,Db=new WeakMap;class Uw extends to{static get DEFAULTS(){return io({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,cn(Uw.DEFAULTS,n)),f1(this,sc,void 0),f1(this,Db,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),g1(Db,this,e),g1(sc,this,this._element.firstChild),pd(sc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(pd(Db,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?pd(sc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(pd(sc,this).checked=e)}focus(){this.isBuilt()&&pd(sc,this).focus()}}function bme(t,e){Sme(t,e),e.add(t)}function Sme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rme(t,e,n){return(e=Eme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eme(t){var e=Tme(t,"string");return typeof e=="symbol"?e:e+""}function Tme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const m1=0;var p1=new WeakSet;class _me extends _g{constructor(e,n){super(e,{id:n.id,stateless:!1}),bme(this,p1),Rme(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),M(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[La,jw];M(e,n=>{const r=new Uw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Kge(n)},value:n,checked:n===e[m1],id:n});r.addLocalHook("change",i=>Mme(p1,this,Pme).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ct`Radio button with index ${e} doesn't exist.`);M(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Uw&&n.isChecked());return e?e.getValue():La}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&M(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:La,n=arguments.length>1?arguments[1]:void 0,r=e;r===p_&&(r=jw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(m1)}}function Pme(t){this.setState(t.target.value)}function xme(t,e,n){Ime(t,e),e.set(t,n)}function Ime(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kb(t,e){return t.get(NF(t,e))}function Ome(t,e,n){return t.set(NF(t,e),n),n}function NF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wd=new WeakMap;class Vf extends to{static get DEFAULTS(){return io({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,cn(Vf.DEFAULTS,n)),xme(this,wd,void 0)}build(){super.build(),Ome(wd,this,this._element.firstChild)}update(){this.isBuilt()&&(kb(wd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&kb(wd,this).focus()}activate(){kb(wd,this).click()}}function Ame(t,e){DF(t,e),e.add(t)}function ac(t,e,n){DF(t,e),e.set(t,n)}function DF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(Oc(t,e))}function ki(t,e,n){return t.set(Oc(t,e),n),n}function Oc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const w1="multipleSelect.itemBox";var Ui=new WeakMap,Jt=new WeakMap,$b=new WeakMap,gs=new WeakMap,sa=new WeakMap,aa=new WeakMap,vd=new WeakSet;class Wf extends to{static get DEFAULTS(){return io({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,cn(Wf.DEFAULTS,n)),Ame(this,vd),ac(this,Ui,[]),ac(this,Jt,void 0),ac(this,$b,void 0),ac(this,gs,void 0),ac(this,sa,void 0),ac(this,aa,void 0),ki(gs,this,new Fa(this.hot,{placeholder:IM,className:"htUIMultipleSelectSearch"})),ki(sa,this,new Vf(this.hot,{textContent:MM,className:"htUISelectAll"})),ki(aa,this,new Vf(this.hot,{textContent:_M,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return xe(Jt,this)}registerHooks(){xe(gs,this).addLocalHook("keydown",e=>Oc(vd,this,Nme).call(this,e)),xe(gs,this).addLocalHook("input",e=>Oc(vd,this,Hme).call(this,e)),xe(sa,this).addLocalHook("click",e=>Oc(vd,this,Dme).call(this,e)),xe(aa,this).addLocalHook("click",e=>Oc(vd,this,kme).call(this,e))}setItems(e){var n;ki(Ui,this,e),(n=xe(Jt,this))===null||n===void 0||n.loadData(xe(Ui,this))}setLocale(e){ki($b,this,e)}getLocale(){return xe($b,this)}getItems(){return[...xe(Ui,this)]}getValue(){return Lme(xe(Ui,this))}getSearchInputElement(){return xe(gs,this)}getSelectAllElement(){return xe(sa,this)}getClearAllElement(){return xe(aa,this)}isSelectedAllValues(){return xe(Ui,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new to(this.hot,{className:"htUISelectionControls",children:[xe(sa,this),xe(aa,this)]});this._element.appendChild(xe(gs,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=xe(Jt,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),ki(Jt,this,new this.hot.constructor(o,{data:xe(Ui,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{xe(Jt,this).listen()},modifyColWidth:u=>{const c=xe(Jt,this).container.scrollWidth-_n(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),xe(Jt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||xe(Jt,this).useTheme(u)});const l=xe(Jt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:w1}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{xe(Jt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:w1})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&xe(Jt,this).listen()}reset(){xe(gs,this).reset(),xe(sa,this).reset(),xe(aa,this).reset()}update(){this.isBuilt()&&(xe(Jt,this).loadData($me(xe(Ui,this),this.options.value)),super.update())}destroy(){var e;(e=xe(Jt,this))===null||e===void 0||e.destroy(),xe(gs,this).destroy(),xe(aa,this).destroy(),xe(sa,this).destroy(),ki(gs,this,null),ki(aa,this,null),ki(sa,this,null),ki(Jt,this,null),ki(Ui,this,null),super.destroy()}}function Hme(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...xe(Ui,this)]:n=xe(Ui,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),xe(Jt,this).loadData(n)}function Nme(t){this.runLocalHooks("keydown",t,this),IE(mh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),xi(t),xe(Jt,this).listen(),xe(Jt,this).selectCell(0,0))}function Dme(t){const e=[];t.preventDefault(),xe(Jt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(aT(n,r)[0])}),xe(Jt,this).setSourceDataAtCell(e)}function kme(t){const e=[];t.preventDefault(),xe(Jt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(aT(n,r)[0])}),xe(Jt,this).setSourceDataAtCell(e)}function $me(t,e){const n=Pg(e);return t.map(r=>(r.checked=n(r.value),r))}function Lme(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Fme(t,e){Vme(t,e),e.add(t)}function Vme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wme(t,e,n){return(e=Bme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bme(t){var e=jme(t,"string");return typeof e=="symbol"?e:e+""}function jme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Um(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yd=new WeakSet;class Ume extends _g{constructor(e,n){super(e,{id:n.id,stateless:!1}),Fme(this,yd),Wme(this,"name",""),this.name=n.name,this.elements.push(new Wf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Um(yd,this,zme).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Um(yd,this,Yme).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Jl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?An:Jl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Va(i,h=>h.name===Jl),u={},c=this.hot.getTranslatedPhrase(Pw);if(l){const h=s(r,a),d=Ue(h,C=>C.value),f=new Map(h.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),g=YR(d);o&&(l.args[0]=o);const v=[],y=a1(g,l.args[0],c,C=>{C.checked&&v.push(C.value),Um(yd,this,v1).call(this,C,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[v],u.command=Xl(Jl),u.itemsSnapshot=y}else u.args=[],u.command=Xl(An);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Wf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Pw),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=YR(r),s=a1(o,o,e,l=>{Um(yd,this,v1).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:g_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function zme(t){mh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),xi(t))}function v1(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Yme(t,e){switch(e.type){case"numeric":return RL(t,e);default:return t}}var kF;function Gme(t,e){Kme(t,e),e.add(t)}function Kme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qme(t,e,n){return(e=Xme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xme(t){var e=Jme(t,"string");return typeof e=="symbol"?e:e+""}function Jme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var y1=new WeakSet;class Bf extends _g{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Gme(this,y1),qme(this,"name",""),this.name=n.name,this.elements.push(new Fa(this.hot,{type:"button",value:PM,className:"htUIButton htUIButtonOK",identifier:Bf.BUTTON_OK})),this.elements.push(new Fa(this.hot,{type:"button",value:xM,className:"htUIButton htUIButtonCancel",identifier:Bf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){M(this.elements,e=>{e.addLocalHook("click",(n,r)=>Zme(y1,this,Qme).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),M(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}kF=Bf;function Qme(t,e){e.options.identifier===kF.BUTTON_OK?this.accept():this.cancel()}function Lb(t,e,n){return(e=epe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function epe(t){var e=tpe(t,"string");return typeof e=="symbol"?e:e+""}function tpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const C1="ConditionCollection.filteringStates";class v_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Lb(this,"hot",void 0),Lb(this,"isMapRegistrable",void 0),Lb(this,"filteringStates",new Gv),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(C1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:La;return e.length?Gge(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:La,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ct`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ht(Lf[r]))throw new Error(ct`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Ua(a,s)}]},i):u.push({name:a,args:s,func:Ua(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(C1),this.filteringStates=null,this.clearLocalHooks()}}gt(v_,Fn);function b1(t,e,n){return(e=npe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function npe(t){var e=rpe(t,"string");return typeof e=="symbol"?e:e+""}function rpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $F{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];b1(this,"conditionCollection",void 0),b1(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return M(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return M(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return M(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function ipe(t,e){ope(t,e),e.add(t)}function ope(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bl(t,e,n){return(e=spe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function spe(t){var e=ape(t,"string");return typeof e=="symbol"?e:e+""}function ape(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zm=new WeakSet;class LF{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];ipe(this,zm),bl(this,"hot",void 0),bl(this,"conditionCollection",void 0),bl(this,"columnDataFactory",void 0),bl(this,"changes",[]),bl(this,"grouping",!1),bl(this,"latestEditedColumnPosition",-1),bl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Fb(zm,this,lpe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Fb(zm,this,upe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Fb(zm,this,cpe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,M(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=Ik(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new v_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const v=r.columnDataFactory(h);let y;f.isEmpty()?y=v:y=new $F(f,C=>r.columnDataFactory(C)).filter(),y=Ue(y,C=>C.meta.visualRow);const E=Pg(y);return f.destroy(),Va(v,C=>E(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),ke(this,(e,n)=>{this[n]=null})}}function lpe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function upe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function cpe(){M(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}gt(LF,Fn);function hpe(t){return oF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Wf)return r;if(i.element&&!lu(i.element))return!1;i.focus()}})}const Cd="filters";function dpe(t,e){let n=-1,r;const i=hpe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Cd),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof to&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Cd),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Cd)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const v=r.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const v=e[i.getCurrentPage()];v instanceof Ff&&(v.openOptions(),g.preventDefault()),v instanceof Vf&&(v.activate(),g.preventDefault()),v instanceof to||g.preventDefault()}}],Cd)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Cd)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function fpe(t,e){FF(t,e),e.add(t)}function Vb(t,e,n){FF(t,e),e.set(t,n)}function FF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bd(t,e,n){return(e=gpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gpe(t){var e=mpe(t,"string");return typeof e=="symbol"?e:e+""}function mpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gp(t,e,n){return t.set(Er(t,e),n),n}function mi(t,e){return t.get(Er(t,e))}function Er(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const KR="filters",ppe=250,S1=KR;var Cs=new WeakMap,qR=new WeakMap,Yl=new WeakMap,$r=new WeakSet;class wpe extends qe{static get PLUGIN_KEY(){return KR}static get PLUGIN_PRIORITY(){return ppe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,fpe(this,$r),bd(this,"dropdownMenuPlugin",null),bd(this,"conditionCollection",null),bd(this,"conditionUpdateObserver",null),bd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),bd(this,"filtersRowsMap",null),Vb(this,Cs,void 0),Vb(this,qR,new WeakSet),Vb(this,Yl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Er($r,n,Epe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[KR]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new vg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>Er($r,this,R1).call(this,"accept")),a.addLocalHook("cancel",()=>Er($r,this,R1).call(this,"cancel")),a.addLocalHook("change",l=>Er($r,this,Rpe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(RM)}:`,s=()=>`${this.hot.getTranslatedPhrase(EM)}:`;if(!this.components.get("filter_by_condition")){const a=new GR(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Er($r,this,E1).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new _me(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new GR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Er($r,this,E1).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Ume(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Bf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new v_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new LF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Er($r,this,Tpe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Er($r,e,Spe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Er($r,this,bpe).call(this)),this.addHook("afterDropdownMenuShow",()=>Er($r,this,ype).call(this)),this.addHook("afterDropdownMenuHide",()=>Er($r,this,Cpe).call(this)),this.addHook("afterChange",a=>Er($r,this,vpe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!mi(Cs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=mi(Cs,this).getMenu(),c=u.getNavigator(),h=mi(Cs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Gp(Cs,this,dpe(this.dropdownMenuPlugin.menu,a));const l=u=>{mi(Cs,this).listen(),u.preventDefault(),mh(u.keyCode,"TAB")&&(u.shiftKey?mi(Cs,this).toPreviousItem():mi(Cs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:S1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(S1)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:La;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,mi(Yl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=Pg(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),M(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Gp(Yl,this,this.exportConditions())}else s!==!1&&!r?(Gp(Yl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(mi(Yl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return M(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:g_(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=YR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===jw&&n.command.key!==An&&r.command.key!==An&&i.command.key!==An?o=p_:i.command.key!==An&&(n.command.key===An||r.command.key===An)&&(o=La),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new $F(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return M(i,s=>{M(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function vpe(t){t&&M(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function ype(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Cpe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function bpe(){const t=this.dropdownMenuPlugin.menu;mi(qR,this).has(t)||mi(Cs,this).setMenu(t),mi(qR,this).add(t)}function Spe(t){t.items.push({name:Le}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function R1(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==An&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==An&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==An&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Rpe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===GR&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function E1(){this.setListeningDropdownMenu()}function Epe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):we(e,"htFiltersActive")}function Tpe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Gp(Yl,this,mi(Yl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Jl),s=n.filter(a=>a.name!==Jl);if(o.length>=2||s.length>=3)tt(ct`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const VF="internal-use-in-handsontable",XR={licenseKey:VF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function WF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Kn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function BF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Mpe(t){var e;const n=t[Kn],r=BF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=WF(t);return{...XR,...r,...i}}function _pe(t){var e;const n=t[Kn],r=BF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=WF(t);return{...r,...i}}function Ppe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function my(){const t="engine_relationship",e=ao(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function y_(){const t="shared_engine_usage",e=ao(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function xpe(t){const e=t.getSettings(),n=e[Kn],r=n==null?void 0:n.engine;if(n===!0||Ht(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Ipe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ht(r.hyperformula)){const o=my(),s=y_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:VF}),(r.getConfig().leapYear1900!==XR.leapYear1900||Lv(r.getConfig().nullDate,XR.nullDate)===!1)&&tt(ct`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Ipe(t,e,n){const r=e[Kn],i=Mpe(e),o=my(),s=y_();Ope(t,r.functions),Ape(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Hpe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function T1(t){var e;const n=my(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function M1(t,e){if(t){const n=my(),r=n.get(t),i=y_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Ope(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){tt(s.message)}})}function Ape(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){tt(r.message)}}}function Hpe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){tt(a.message)}}),t.resumeEvaluation())}function Npe(t,e){return(Ht(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const jF="DD/MM/YYYY";function Dpe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function kpe(t){return Dpe(t)?t.substr(1):t}function $pe(t){return typeof t=="string"&&t.startsWith("=")}function C_(t,e){return typeof t=="string"&&e==="date"}function UF(t,e){return Z(t,e,!0).isValid()}function zF(t,e){return Z(t,e,!0).format(jF)}function Lpe(t,e){return Z(t,jF,!0).format(e)}function YF(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function Fpe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Vpe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Wpe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function b_(t,e,n){const r=Vpe(t,Fpe(t,e,n));return Wpe(r)}function Sl(t,e,n){Bpe(t,e),e.set(t,n)}function Bpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function It(t,e){return t.get(GF(t,e))}function la(t,e,n){return t.set(GF(t,e),n),n}function GF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sd=new WeakMap,ua=new WeakMap,Lr=new WeakMap,Ym=new WeakMap,Wb=new WeakMap,Bb=new WeakMap,Gm=new WeakMap;class _1{constructor(e,n,r){Sl(this,Sd,void 0),Sl(this,ua,void 0),Sl(this,Lr,void 0),Sl(this,Ym,[]),Sl(this,Wb,[]),Sl(this,Bb,void 0),Sl(this,Gm,[]),la(Sd,this,e),la(ua,this,n),la(Lr,this,r)}setRemovedHfIndexes(e){return la(Gm,this,e.map(n=>{const r=It(ua,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),It(Gm,this)}getRemovedHfIndexes(){return It(Gm,this)}getHfIndexFromVisualIndex(e){const n=It(ua,this).getIndexesSequence(),r=It(ua,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Zn(It(Sd,this))}s`;It(Lr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&It(Lr,this).getEngine()[r](It(Lr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(la(Wb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),la(Bb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(It(Lr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=b_(It(Wb,this),It(Bb,this),It(ua,this).getNumberOfIndexes());It(Lr,this).getSheetId()===null?It(Lr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Zn(It(Sd,this))}Order`;return n=>{if(It(Lr,this).isPerformingUndoRedo())return;const r=It(ua,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=It(Ym,this).map(l=>r.indexOf(l)),o=It(Lr,this).getEngine().getSheetDimensions(It(Lr,this).getSheetId());let s;It(Sd,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);It(Lr,this).getEngine()[e](It(Lr,this).getSheetId(),i)}la(Ym,this,r)}}init(){la(Ym,this,It(ua,this).getIndexesSequence())}}function Rl(t,e,n){jpe(t,e),e.set(t,n)}function jpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ms(t,e){return t.get(KF(t,e))}function El(t,e,n){return t.set(KF(t,e),n),n}function KF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Km=new WeakMap,qm=new WeakMap,jb=new WeakMap,Ub=new WeakMap,zb=new WeakMap,Yb=new WeakMap,Gb=new WeakMap;class Upe{constructor(e,n,r){Rl(this,Km,void 0),Rl(this,qm,void 0),Rl(this,jb,void 0),Rl(this,Ub,!1),Rl(this,zb,!1),Rl(this,Yb,null),Rl(this,Gb,null),El(Km,this,new _1("row",e,this)),El(qm,this,new _1("column",n,this)),El(jb,this,r)}getForAxis(e){return e==="row"?ms(Km,this):ms(qm,this)}setPerformUndo(e){El(Ub,this,e)}setPerformRedo(e){El(zb,this,e)}isPerformingUndoRedo(){return ms(Ub,this)||ms(zb,this)}getSheetId(){return ms(Gb,this)}getEngine(){return ms(Yb,this)}getPostponeAction(){return ms(jb,this)}setupSyncEndpoint(e,n){El(Yb,this,e),El(Gb,this,n),ms(Km,this).init(),ms(qm,this).init()}}function zpe(t,e){qF(t,e),e.add(t)}function Tl(t,e,n){return(e=Ype(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ype(t){var e=Gpe(t,"string");return typeof e=="symbol"?e:e+""}function Gpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kb(t,e,n){qF(t,e),e.set(t,n)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function za(t,e,n){return t.set(Xe(t,e),n),n}function nu(t,e){return t.get(Xe(t,e))}function Xe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Kn="formulas",Kpe=["maxRows","maxColumns","language"],qpe=260;oe.getSingleton().register("afterNamedExpressionAdded");oe.getSingleton().register("afterNamedExpressionRemoved");oe.getSingleton().register("afterSheetAdded");oe.getSingleton().register("afterSheetRemoved");oe.getSingleton().register("afterSheetRenamed");oe.getSingleton().register("afterFormulasValuesUpdate");const bh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var js=new WeakMap,py=new WeakMap,Rd=new WeakMap,Qe=new WeakSet;class Xpe extends qe{constructor(){var e;super(...arguments),e=this,zpe(this,Qe),Kb(this,js,!1),Kb(this,py,!1),Kb(this,Rd,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,dwe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,fwe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,gwe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,mwe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,pwe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,wwe).call(e,...r)}]]),Tl(this,"staticRegister",ao("formulas")),Tl(this,"engine",null),Tl(this,"sheetId",null),Tl(this,"sheetName",null),Tl(this,"indexSyncer",null),Tl(this,"rowAxisSyncer",null),Tl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Kn}static get PLUGIN_PRIORITY(){return qpe}static get SETTING_KEYS(){return[Kn,...Kpe]}isEnabled(){return!!this.hot.getSettings()[Kn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=xpe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){tt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Xe(Qe,this,nf).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,P1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,x1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,P1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,x1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,ewe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,twe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Jpe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,nwe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,I1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,I1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,rwe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,iwe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,awe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,lwe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,owe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,swe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,uwe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,cwe).call(n,...i)}),this.indexSyncer=new Upe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Qpe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,hwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Zpe).call(n,...i)}),nu(Rd,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){nu(Rd,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),M1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=_pe(this.hot.getSettings());Ppe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Kn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Kn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Xe(Qe,this,nf).call(this,o)}}super.updatePlugin(e)}destroy(){nu(Rd,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),za(Rd,this,null),M1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!x$(n))return tt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return tt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return tt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){kE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Xe(Qe,this,nf).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Zn(Kn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),T1(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=T1(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){tt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return C_(r,o.type)&&(UF(r,o.dateFormat)?r=zF(r,o.dateFormat):$pe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function nf(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function Jpe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Gn(s)&&(s=YF(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Zpe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:v}=h.start,{row:y,col:E}=h.end,C=y-g+1,_=E-v+1;for(let I=0;I<f.length;I+=1)for(let P=0;P<f[I].length;P+=1){const T=f[I][P],A=g+I%C,G=v+P%_,U=this.hot.getCellMeta(A,G);C_(T,U.type)&&(T.startsWith("'")?f[I][P]=T.slice(1):this.isFormulaCellType(A,G,this.sheetId)===!1&&(f[I][P]=Lpe(T,U.dateFormat)))}return f}function P1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Zn(Kn))||za(py,this,Ht(this.hot.getSettings().data))}function Qpe(){if(nu(py,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;C_(i,s.type)&&(UF(i,a)?t[r][o]=zF(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),za(js,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),za(js,this,!1)}function x1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Zn(Kn)))return;const r=Npe(this.engine,this.hot.getSettings()[Kn].sheetName);if(Xe(Qe,this,nf).call(this,r),n!=="updateSettings")if(nu(py,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){za(js,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),za(js,this,!1)}}}function ewe(t,e,n,r){if(r!=="get"||nu(js,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=kpe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Gn(a)&&(a=YF(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function twe(t,e,n,r){if(r!=="get"||nu(js,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function I1(t,e){if(bh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function nwe(t,e){if(bh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Gn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){tt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function rwe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function iwe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function owe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function swe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function awe(t,e,n){if(bh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function lwe(t,e,n){if(bh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function uwe(t,e,n,r){if(bh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function cwe(t,e,n,r){if(bh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function hwe(t,e,n){var r;za(js,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());za(js,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function dwe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function fwe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function gwe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function mwe(t){this.hot.runHooks("afterSheetAdded",t)}function pwe(t,e){Xe(Qe,this,nf).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function wwe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function vwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(eM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function ywe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(tM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Cwe(t,e){XF(t,e),e.add(t)}function bwe(t,e,n){XF(t,e),e.set(t,n)}function XF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e){return t.get(wa(t,e))}function O1(t,e,n){return t.set(wa(t,e),n),n}function wa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideColumns");oe.getSingleton().register("afterHideColumns");oe.getSingleton().register("beforeUnhideColumns");oe.getSingleton().register("afterUnhideColumns");const A1="hiddenColumns",Swe=310;var yo=new WeakMap,_l=new WeakSet;class Rwe extends qe{constructor(){super(...arguments),Cwe(this,_l),bwe(this,yo,null)}static get PLUGIN_KEY(){return A1}static get PLUGIN_PRIORITY(){return Swe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[A1]}enablePlugin(){var e=this;this.enabled||(O1(yo,this,new Yv),Ml(yo,this).addLocalHook("init",()=>wa(_l,this,xwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ml(yo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wa(_l,e,Pwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>wa(_l,this,Twe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>wa(_l,this,Ewe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wa(_l,e,_we).call(e,...r)}),this.addHook("modifyCopyableRange",n=>wa(_l,this,Mwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Ml(yo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));M(l,u=>{o[u]=!1}),i=Sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Ml(yo,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{Ml(yo,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(Ml(yo,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ml(yo,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){O1(yo,this,null),super.destroy()}}function Ewe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Twe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Mwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return M(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function _we(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function Pwe(t){t.items.push({name:Le},vwe(this),ywe(this))}function xwe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Iwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(nM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Owe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(rM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Awe(t,e){JF(t,e),e.add(t)}function Hwe(t,e,n){JF(t,e),e.set(t,n)}function JF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pl(t,e){return t.get(va(t,e))}function H1(t,e,n){return t.set(va(t,e),n),n}function va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideRows");oe.getSingleton().register("afterHideRows");oe.getSingleton().register("beforeUnhideRows");oe.getSingleton().register("afterUnhideRows");const N1="hiddenRows",Nwe=320;var Co=new WeakMap,xl=new WeakSet;class Dwe extends qe{constructor(){super(...arguments),Awe(this,xl),Hwe(this,Co,null)}static get PLUGIN_KEY(){return N1}static get PLUGIN_PRIORITY(){return Nwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[N1]}enablePlugin(){var e=this;this.enabled||(H1(Co,this,new Yv),Pl(Co,this).addLocalHook("init",()=>va(xl,this,Wwe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Pl(Co,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(xl,e,Vwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>va(xl,this,$we).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>va(xl,this,kwe).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(xl,e,Fwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>va(xl,this,Lwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Pl(Co,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));M(l,u=>{o[u]=!1}),i=Sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Pl(Co,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{Pl(Co,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(Pl(Co,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Pl(Co,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){H1(Co,this,null),super.destroy()}}function kwe(t,e){return this.isHidden(e)?0:t}function $we(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Lwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return M(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Fwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function Vwe(t){t.items.push({name:Le},Iwe(this),Owe(this))}function Wwe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Bwe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(IT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function jwe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(OT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Uwe(t,e){ZF(t,e),e.add(t)}function zwe(t,e,n){ZF(t,e),e.set(t,n)}function ZF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JR(t,e){return t.get(zw(t,e))}function qb(t,e,n){return t.set(zw(t,e),n),n}function zw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnFreeze");oe.getSingleton().register("afterColumnFreeze");oe.getSingleton().register("beforeColumnUnfreeze");oe.getSingleton().register("afterColumnUnfreeze");const D1="manualColumnFreeze",Ywe=110;var Bl=new WeakMap,Xb=new WeakSet;class Gwe extends qe{constructor(){super(...arguments),Uwe(this,Xb),zwe(this,Bl,!1)}static get PLUGIN_KEY(){return D1}static get PLUGIN_PRIORITY(){return Ywe}isEnabled(){return!!this.hot.getSettings()[D1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>zw(Xb,this,Kwe).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>zw(Xb,this,qwe).call(this,e,n)),super.enablePlugin())}disablePlugin(){qb(Bl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;JR(Bl,this)||qb(Bl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;JR(Bl,this)||qb(Bl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Kwe(t){t.items.push({name:"---------"},Bwe(this),jwe(this))}function qwe(t,e){if(JR(Bl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Xm(t,e,n){return(e=Xwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xwe(t){var e=Jwe(t,"string");return typeof e=="symbol"?e:e+""}function Jwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Jb=0,k1=1,$1=2,lc="px";let QF=class{constructor(e){Xm(this,"hot",void 0),Xm(this,"_element",null),Xm(this,"state",Jb),Xm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=$1}build(){this.state===Jb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=k1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Jb}isAppended(){return this.state===$1}isBuilt(){return this.state>=k1}setPosition(e,n){Gn(e)&&(this._element.style.top=e+lc),Gn(n)&&(this._element.style[this.inlineProperty]=n+lc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Gn(e)&&(this._element.style.width=e+lc),Gn(n)&&(this._element.style.height=n+lc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Gn(e)&&(this._element.style.marginTop=e+lc),Gn(n)&&(this._element.style[`margin${Zn(this.inlineProperty)}`]=n+lc)}getOffset(){const e=this._element.style,n=`margin${Zn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Zwe="ht__manualColumnMove--backlight";let Qwe=class extends QF{build(){super.build(),q(this._element,Zwe)}};const eve="ht__manualColumnMove--guideline";let tve=class extends QF{build(){super.build(),q(this._element,eve)}};function nve(t,e){eV(t,e),e.add(t)}function $i(t,e,n){eV(t,e),e.set(t,n)}function eV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(t,e,n){return t.set(ya(t,e),n),n}function he(t,e){return t.get(ya(t,e))}function ya(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnMove");oe.getSingleton().register("afterColumnMove");const Zb="manualColumnMove",rve=120,L1="ht__manualColumnMove",Yw="show-ui",ZR="on-moving--columns",QR="after-selection--columns";var lr=new WeakMap,Sa=new WeakMap,Ns=new WeakMap,Kp=new WeakMap,Aa=new WeakMap,ar=new WeakMap,Jm=new WeakMap,hi=new WeakMap,Rc=new WeakMap,Gw=new WeakMap,rf=new WeakMap,Il=new WeakSet;class ive extends qe{constructor(){super(...arguments),nve(this,Il),$i(this,lr,new Qwe(this.hot)),$i(this,Sa,new tve(this.hot)),$i(this,Ns,[]),$i(this,Kp,0),$i(this,Aa,!1),$i(this,ar,{}),$i(this,Jm,void 0),$i(this,hi,void 0),$i(this,Rc,void 0),$i(this,Gw,void 0),$i(this,rf,void 0)}static get PLUGIN_KEY(){return Zb}static get PLUGIN_PRIORITY(){return rve}isEnabled(){return!!this.hot.getSettings()[Zb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,ove).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,ave).call(e,...r)}),this.addHook("afterScrollVertically",()=>ya(Il,this,uve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,cve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,L1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,L1),this.unregisterEvents(),he(lr,this).destroy(),he(Sa,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(Jm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Or(Jm,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Or(Jm,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Sn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Zb];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(hi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(hi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(lr,this).getOffset().start,u=he(lr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,v=en(this.hot.rootElement),y=g.innerWidth-he(Rc,this)-v;h=g.innerWidth-he(ar,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=he(ar,this).eventPageX-(he(Rc,this)-(r.scrollX===void 0?i:0));if(he(Gw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(hi,this))&&(o+=i),o+=c,he(hi,this)<0)he(rf,this)>0?he(ar,this).col=0:he(ar,this).col=e>0?e-1:e;else if(he(ar,this).TD.offsetWidth/2+o<=h){const g=he(hi,this)>=he(Kp,this)?he(Kp,this)-1:he(hi,this);he(ar,this).col=g+1,o+=he(ar,this).TD.offsetWidth}else he(ar,this).col=he(hi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(hi,this)<he(rf,this)&&(f-=he(Rc,this)<=r.scrollX?he(Rc,this):0),he(lr,this).setPosition(null,d),he(Sa,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ya(Il,this,sve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ya(Il,this,lve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(lr,this).build(),he(Sa,this).build()}destroy(){he(lr,this).destroy(),he(Sa,this).destroy(),super.destroy()}}function ove(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ve(t.target,"sortAction");if(!s||!o||he(Aa,this)||t.button!==0||a){Or(Aa,this,!1),he(Ns,this).length=0,we(this.hot.rootElement,[ZR,Yw]);return}const l=he(Sa,this).isBuilt()&&!he(Sa,this).isAppended(),u=he(lr,this).isBuilt()&&!he(lr,this).isAppended();l&&u&&(he(Sa,this).appendTo(i.hider),he(lr,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Or(Aa,this,!0);const g=n.firstChild?Gk(t,n.firstChild).x:t.offsetX;he(ar,this).eventPageX=t.pageX,Or(hi,this,e.col),he(ar,this).TD=n,he(ar,this).col=e.col,Or(Ns,this,this.prepareColumnsToMoving(d,f)),Or(Gw,this,!!this.hot.getSettings().rowHeaders),Or(Kp,this,this.hot.countCols()),Or(rf,this,this.hot.getSettings().fixedColumnsStart),Or(Rc,this,Ln(this.hot.rootElement).left);const v=he(Gw,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(rf,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),_=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),I=this.getColumnsWidth(d,e.col-1)+_,P=this.getColumnsWidth(v,d-1)+(E?C:0)+I;he(lr,this).setPosition(y,P),he(lr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),he(lr,this).setOffset(null,-I),q(this.hot.rootElement,ZR)}else we(this.hot.rootElement,QR),Or(Aa,this,!1),he(Ns,this).length=0}function sve(t){he(Aa,this)&&(he(ar,this).eventPageX=t.pageX,this.refreshPositions())}function ave(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(Aa,this)||(he(Ns,this).indexOf(e.col)>-1?we(this.hot.rootElement,Yw):q(this.hot.rootElement,Yw),r.row=!0,r.column=!0,r.cell=!0,Or(hi,this,e.col),he(ar,this).TD=n)}function lve(){const t=he(ar,this).col,e=he(Ns,this).length;if(Or(hi,this,void 0),Or(Aa,this,!1),we(this.hot.rootElement,[ZR,Yw,QR]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,QR),e<1||t===void 0)return;const n=he(Ns,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(Ns,this),t);if(he(Ns,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function uve(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(lr,this).setPosition(r),he(lr,this).setSize(null,t.hider.offsetHeight-r)}function cve(){this.moveBySettingsOrLoad()}function hve(t,e){tV(t,e),e.add(t)}function Bn(t,e,n){tV(t,e),e.set(t,n)}function tV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qt(t,e,n){return t.set(zi(t,e),n),n}function se(t,e){return t.get(zi(t,e))}function zi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Kw="manualColumnResize",dve=130,F1="manualColumnWidths";var Ts=new WeakMap,Zm=new WeakMap,Gr=new WeakMap,qw=new WeakMap,Fo=new WeakMap,fve=new WeakMap,jc=new WeakMap,Qm=new WeakMap,Sr=new WeakMap,bs=new WeakMap,fu=new WeakMap,Xw=new WeakMap,of=new WeakMap,sf=new WeakMap,qr=new WeakMap,af=new WeakMap,bo=new WeakSet;class gve extends qe{static get PLUGIN_KEY(){return Kw}static get PLUGIN_PRIORITY(){return dve}constructor(e){super(e),hve(this,bo),Bn(this,Ts,null),Bn(this,Zm,null),Bn(this,Gr,[]),Bn(this,qw,null),Bn(this,Fo,null),Bn(this,fve,null),Bn(this,jc,null),Bn(this,Qm,null),Bn(this,Sr,this.hot.rootDocument.createElement("DIV")),Bn(this,bs,this.hot.rootDocument.createElement("DIV")),Bn(this,fu,null),Bn(this,Xw,!1),Bn(this,of,0),Bn(this,sf,null),Bn(this,qr,void 0),Bn(this,af,void 0),q(se(Sr,this),"manualColumnResizer"),q(se(bs,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Kw]}enablePlugin(){var e=this;this.enabled||(Qt(qr,this,new Ka),se(qr,this).addLocalHook("init",()=>zi(bo,this,mve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,se(qr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zi(bo,e,bve).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zi(bo,e,Sve).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zi(bo,e,Rve).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Qt(af,this,se(qr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",F1,se(qr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",F1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return se(qr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);se(qr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Qt(Ts,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(se(Ts,this)),i=r.col;if(i<0)return;const o=un(se(Ts,this)),s=se(Ts,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(Ts,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(se(Ts,this),r.row,r.col)),Qt(Zm,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Qt(Gr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();M(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{se(Gr,this).includes(g)||se(Gr,this).push(g)})})}se(Gr,this).includes(se(Zm,this))||Qt(Gr,this,[se(Zm,this)]),Qt(Qm,this,l.start-6),Qt(jc,this,parseInt(s.width,10)),se(Sr,this).style.top=`${l.top}px`,se(Sr,this).style[this.inlineDir]=`${se(Qm,this)+se(jc,this)}px`,se(Sr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(se(Sr,this))}refreshHandlePosition(){se(Sr,this).style[this.inlineDir]=`${se(Qm,this)+se(qw,this)}px`}setupGuidePosition(){const e=parseInt(un(se(Sr,this)),10),n=parseInt(se(Sr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(se(Sr,this),"active"),q(se(bs,this),"active"),se(bs,this).style.top=`${n}px`,this.refreshGuidePosition(),se(bs,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(se(bs,this))}refreshGuidePosition(){se(bs,this).style[this.inlineDir]=se(Sr,this).style[this.inlineDir]}hideHandleAndGuide(){we(se(Sr,this),"active"),we(se(bs,this),"active")}checkIfColumnHeader(e){const n=Wa(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",se(Fo,this),r,!0);o!==void 0&&Qt(Fo,this,o),this.setManualSize(r,se(Fo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Fo,this),r,!0),i&&e()};se(of,this)>=2&&(se(Gr,this).length>1?(M(se(Gr,this),i=>{n(i)}),e()):M(se(Gr,this),i=>{n(i,!0)})),Qt(of,this,0),Qt(sf,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>zi(bo,this,pve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>zi(bo,this,wve).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>zi(bo,this,vve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>zi(bo,this,yve).call(this)),this.eventManager.addEventListener(se(Sr,this),"contextmenu",()=>zi(bo,this,Cve).call(this))}destroy(){super.destroy()}}function mve(){const t=this.hot.getSettings()[Kw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{se(qr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{se(qr,this).setValueAtIndex(r,n)})},!0),Qt(af,this,t)):t===!0&&Array.isArray(se(af,this))&&this.hot.batchExecution(()=>{se(af,this).forEach((n,r)=>{se(qr,this).setValueAtIndex(r,n)})},!0)}function pve(t){if(!_E(t.target)&&se(Xw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(se(fu,this)||this.setupHandlePosition(e))}}function wve(t){t.target.parentNode===this.hot.rootElement&&ve(t.target,"manualColumnResizer")&&(this.setupHandlePosition(se(Ts,this)),this.setupGuidePosition(),Qt(fu,this,!0),se(sf,this)===null&&(Qt(sf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(sf,this))),Qt(of,this,se(of,this)+1),this.startX=t.pageX,Qt(Fo,this,se(jc,this)))}function vve(t){if(se(fu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Qt(qw,this,se(jc,this)+e),M(se(Gr,this),n=>{Qt(Fo,this,this.setManualSize(n,se(qw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function yve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",se(Fo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Fo,this),n,!1)};se(fu,this)&&(this.hideHandleAndGuide(),Qt(fu,this,!1),se(Fo,this)!==se(jc,this)&&(se(Gr,this).length>1?(M(se(Gr,this),r=>{e(r)}),t()):M(se(Gr,this),r=>{e(r,!0)})),this.setupHandlePosition(se(Ts,this)))}function Cve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(Sr,this)),this.hot.rootElement.removeChild(se(bs,this)),Qt(fu,this,!1),Qt(Xw,this,!0),this.hot._registerImmediate(()=>{Qt(Xw,this,!1)})}function bve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=se(qr,this).getValueAtIndex(r);this.hot.getSettings()[Kw]&&i&&(n=i)}return n}function Sve(t,e){const n=se(qr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Rve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Qb(t,e,n){return(e=Eve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eve(t){var e=Tve(t,"string");return typeof e=="symbol"?e:e+""}function Tve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eS=0,V1=1,W1=2,uc="px";let nV=class{constructor(e){Qb(this,"hot",void 0),Qb(this,"_element",null),Qb(this,"state",eS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=W1}build(){this.state===eS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=V1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=eS}isAppended(){return this.state===W1}isBuilt(){return this.state>=V1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+uc),n!==void 0&&(this._element.style.left=n+uc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+uc),n&&(this._element.style.height=n+uc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+uc),n&&(this._element.style.marginLeft=n+uc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Mve="ht__manualRowMove--backlight";class _ve extends nV{build(){super.build(),q(this._element,Mve)}}const Pve="ht__manualRowMove--guideline";class xve extends nV{build(){super.build(),q(this._element,Pve)}}function Ive(t,e){rV(t,e),e.add(t)}function cc(t,e,n){rV(t,e),e.set(t,n)}function rV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zl(t,e,n){return t.set(Ca(t,e),n),n}function Pe(t,e){return t.get(Ca(t,e))}function Ca(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeRowMove");oe.getSingleton().register("afterRowMove");const tS="manualRowMove",Ove=140,B1="ht__manualRowMove",Jw="show-ui",e0="on-moving--rows",t0="after-selection--rows";var ur=new WeakMap,Ra=new WeakMap,Ds=new WeakMap,Ha=new WeakMap,Ar=new WeakMap,ep=new WeakMap,Ol=new WeakSet;class Ave extends qe{constructor(){super(...arguments),Ive(this,Ol),cc(this,ur,new _ve(this.hot)),cc(this,Ra,new xve(this.hot)),cc(this,Ds,[]),cc(this,Ha,void 0),cc(this,Ar,{}),cc(this,ep,void 0)}static get PLUGIN_KEY(){return tS}static get PLUGIN_PRIORITY(){return Ove}isEnabled(){return!!this.hot.getSettings()[tS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,Hve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,Dve).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ca(Ol,this,$ve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,Lve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,B1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,B1),this.unregisterEvents(),Pe(ur,this).destroy(),Pe(Ra,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Pe(ep,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Zl(ep,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Zl(ep,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Sn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[tS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Pe(Ar,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Pe(Ar,this).TD,a=this.hot.rootElement,l=Ln(a),u=qc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Pe(Ar,this).eventPageY-d+c,g=o.hider.offsetHeight,v=o.TBODY.offsetTop,y=Pe(ur,this).getOffset().top,E=Pe(ur,this).getSize().height,C=s.offsetHeight/2,_=s.offsetHeight;let I=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=f>=I+C;this.isFixedRowTop(e.row)&&(I+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Pe(Ar,this).row=n>0?n-1:n:P?(Pe(Ar,this).row=e.row+1,I+=e.row===0?_-1:_):Pe(Ar,this).row=e.row;let T=f,A=I;f+E+y>=g?T=g-E-y:f+y<v&&(T=v+Math.abs(y)),I>=g-1&&(A=g-1),Pe(ur,this).setPosition(T),Pe(Ra,this).setPosition(A)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ca(Ol,this,Nve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ca(Ol,this,kve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(ur,this).build(),Pe(Ra,this).build()}destroy(){Pe(ur,this).destroy(),Pe(Ra,this).destroy(),super.destroy()}}function Hve(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Pe(Ha,this)||t.button!==0){Zl(Ha,this,!1),Pe(Ds,this).length=0,we(this.hot.rootElement,[e0,Jw]);return}const l=Pe(Ra,this).isBuilt()&&!Pe(Ra,this).isAppended(),u=Pe(ur,this).isBuilt()&&!Pe(ur,this).isAppended();l&&u&&(Pe(Ra,this).appendTo(i.hider),Pe(ur,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,Zl(Ha,this,!0),Pe(Ar,this).eventPageY=t.pageY,Pe(Ar,this).coords=e,Pe(Ar,this).TD=n,Zl(Ds,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Pe(ur,this).setPosition(null,g),Pe(ur,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Pe(ur,this).setOffset(-v,null),q(this.hot.rootElement,e0),this.refreshPositions()}else we(this.hot.rootElement,t0),Zl(Ha,this,!1),Pe(Ds,this).length=0}function Nve(t){Pe(Ha,this)&&(Pe(Ar,this).eventPageY=t.pageY,this.refreshPositions())}function Dve(t,e,n,r){!this.hot.getSelectedRangeLast()||!Pe(Ha,this)||(Pe(Ds,this).indexOf(e.row)>-1?we(this.hot.rootElement,Jw):q(this.hot.rootElement,Jw),r.row=!0,r.column=!0,r.cell=!0,Pe(Ar,this).coords=e,Pe(Ar,this).TD=n)}function kve(){const t=Pe(Ar,this).row,e=Pe(Ds,this).length;if(Zl(Ha,this,!1),we(this.hot.rootElement,[e0,Jw,t0]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,t0),e<1||t===void 0)return;const n=Pe(Ds,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Pe(Ds,this),t);if(Pe(Ds,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function $ve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Pe(ur,this).setPosition(null,r),Pe(ur,this).setSize(t.hider.offsetWidth-r)}function Lve(){this.moveBySettingsOrLoad()}function Fve(t,e){iV(t,e),e.add(t)}function jn(t,e,n){iV(t,e),e.set(t,n)}function iV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ut(t,e,n){return t.set(Ms(t,e),n),n}function ie(t,e){return t.get(Ms(t,e))}function Ms(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zw="manualRowResize",Vve=30,j1="manualRowHeights";var Ao=new WeakMap,tp=new WeakMap,Kr=new WeakMap,lf=new WeakMap,Ea=new WeakMap,S_=new WeakMap,Uc=new WeakMap,np=new WeakMap,or=new WeakMap,xo=new WeakMap,gu=new WeakMap,Qw=new WeakMap,uf=new WeakMap,cf=new WeakMap,qi=new WeakMap,hf=new WeakMap,ca=new WeakSet;class Wve extends qe{static get PLUGIN_KEY(){return Zw}static get PLUGIN_PRIORITY(){return Vve}constructor(e){super(e),Fve(this,ca),jn(this,Ao,null),jn(this,tp,null),jn(this,Kr,[]),jn(this,lf,null),jn(this,Ea,null),jn(this,S_,null),jn(this,Uc,null),jn(this,np,null),jn(this,or,this.hot.rootDocument.createElement("DIV")),jn(this,xo,this.hot.rootDocument.createElement("DIV")),jn(this,gu,!1),jn(this,Qw,!1),jn(this,uf,0),jn(this,cf,null),jn(this,qi,void 0),jn(this,hf,void 0),q(ie(or,this),"manualRowResizer"),q(ie(xo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Zw]}enablePlugin(){this.enabled||(Ut(qi,this,new Ka),ie(qi,this).addLocalHook("init",()=>Ms(ca,this,Kve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ie(qi,this)),this.addHook("modifyRowHeight",(e,n)=>Ms(ca,this,Gve).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ut(hf,this,ie(qi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",j1,ie(qi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",j1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return ie(qi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ie(lf,this)}setupHandlePosition(e){Ut(Ao,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ie(Ao,this)),o=i.row;if(o<0)return;const s=en(ie(Ao,this)),a=ie(Ao,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(Ao,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ie(Ao,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ie(Ao,this),i.row,i.col)),Ut(tp,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Ut(Kr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();M(d,f=>{const g=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;fe(g,v,y=>{ie(Kr,this).includes(y)||ie(Kr,this).push(y)})})}ie(Kr,this).includes(ie(tp,this))||Ut(Kr,this,[ie(tp,this)]),Ut(np,this,c.top-6),Ut(Uc,this,parseInt(a.height,10)),ie(or,this).style.top=`${ie(np,this)+ie(Uc,this)}px`,ie(or,this).style[this.inlineDir]=`${c.start}px`,ie(or,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ie(or,this))}refreshHandlePosition(){ie(or,this).style.top=`${ie(np,this)+ie(lf,this)}px`}setupGuidePosition(){const e=parseInt(en(ie(or,this)),10),n=parseInt(ie(or,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(ie(or,this),"active"),q(ie(xo,this),"active"),ie(xo,this).style.top=ie(or,this).style.top,ie(xo,this).style[this.inlineDir]=`${n}px`,ie(xo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ie(xo,this))}refreshGuidePosition(){ie(xo,this).style.top=ie(or,this).style.top}hideHandleAndGuide(){we(ie(or,this),"active"),we(ie(xo,this),"active")}checkIfRowHeader(e){const n=Wa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ie(Ea,this)<n?n:ie(Ea,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Ut(Ea,this,o),this.setManualSize(r,ie(Ea,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ie(uf,this)>=2&&(ie(Kr,this).length>1?(M(ie(Kr,this),i=>{n(i)}),e()):M(ie(Kr,this),i=>{n(i,!0)})),Ut(uf,this,0),Ut(cf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ms(ca,this,Bve).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ms(ca,this,jve).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Ms(ca,this,Uve).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Ms(ca,this,zve).call(this)),this.eventManager.addEventListener(ie(or,this),"contextmenu",()=>Ms(ca,this,Yve).call(this))}destroy(){super.destroy()}}function Bve(t){if(!_E(t.target)&&ie(Qw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ie(gu,this)||this.setupHandlePosition(e))}}function jve(t){ve(t.target,"manualRowResizer")&&(this.setupHandlePosition(ie(Ao,this)),this.setupGuidePosition(),Ut(gu,this,!0),ie(cf,this)===null&&(Ut(cf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(cf,this))),Ut(uf,this,ie(uf,this)+1),Ut(S_,this,t.pageY),Ut(Ea,this,ie(Uc,this)))}function Uve(t){ie(gu,this)&&(Ut(lf,this,ie(Uc,this)+(t.pageY-ie(S_,this))),M(ie(Kr,this),e=>{Ut(Ea,this,this.setManualSize(e,ie(lf,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function zve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ie(gu,this)&&(this.hideHandleAndGuide(),Ut(gu,this,!1),ie(Ea,this)!==ie(Uc,this)&&(ie(Kr,this).length>1?(M(ie(Kr,this),r=>{e(r)}),t()):M(ie(Kr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(Ao,this)))}function Yve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(or,this)),this.hot.rootElement.removeChild(ie(xo,this)),Ut(gu,this,!1),Ut(Qw,this,!0),this.hot._registerImmediate(()=>{Ut(Qw,this,!1)})}function Gve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ie(qi,this).getValueAtIndex(r);this.hot.getSettings()[Zw]&&i&&(n=i)}return n}function Kve(){const t=this.hot.getSettings()[Zw],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ie(qi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ie(qi,this).setValueAtIndex(r,n)}),Ut(hf,this,t)):t===!0&&Array.isArray(ie(hf,this))&&ie(hf,this).forEach((n,r)=>{ie(qi,this).setValueAtIndex(r,n)})},!0)}var qve=Wv;qve("flatMap");var Xve=yn,U1=bn,Jve=Jo,Zve=L0,Qve=function(t,e){(!e||typeof t!="string")&&U1(t);var n=Zve(t);return Jve(U1(n!==void 0?Xve(n,t):t))},eye=Ct,n0=yn,tye=Dr,r0=bn,nye=Jo,rye=Qve,iye=U0,i0=ti,oye=Ga,nS=oye("flatMap",TypeError),sye=iye(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=r0(n0(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){i0(t,"throw",i)}if(n=r0(n0(this.next,t)),this.done=!!n.done)return;try{this.inner=rye(e(n.value,this.counter++),!1)}catch(i){i0(t,"throw",i)}}});eye({target:"Iterator",proto:!0,real:!0,forced:nS},{flatMap:function(e){r0(this);try{tye(e)}catch(n){i0(this,"throw",n)}return nS?n0(nS,this,e):new sye(nye(this),{mapper:e,inner:null})}});function aye(t,e,n){lye(t,e),e.set(t,n)}function lye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(t,e,n){return(e=uye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uye(t){var e=cye(t,"string");return typeof e=="symbol"?e:e+""}function cye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function z1(t,e){return t.get(oV(t,e))}function rp(t,e,n){return t.set(oV(t,e),n),n}function oV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hl=new WeakMap;class Ho{constructor(e,n,r,i,o,s){Al(this,"row",void 0),Al(this,"col",void 0),Al(this,"rowspan",void 0),Al(this,"colspan",void 0),Al(this,"removed",!1),Al(this,"cellCoordsFactory",void 0),Al(this,"cellRangeFactory",void 0),aye(this,Hl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return ct`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return ct`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return ct`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return ct`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),rp(Hl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,rp(Hl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return rp(Hl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return z1(Hl,this)||rp(Hl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),z1(Hl,this)}}function hye(t,e){dye(t,e),e.add(t)}function dye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ip(t,e,n){return(e=fye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fye(t){var e=gye(t,"string");return typeof e=="symbol"?e:e+""}function gye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ha=new WeakSet;class ev{constructor(e){hye(this,ha),ip(this,"plugin",void 0),ip(this,"mergedCells",[]),ip(this,"mergedCellsMatrix",new Map),ip(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return ct`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){tt(ev.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Ho(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Nl(ha,this,Y1).call(this,a),a):(u&&tt(ev.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Nl(ha,this,mye).call(this,r),r):!1}clear(){M(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ye(u,i,i+s-1),d=Ye(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Nl(ha,this,op).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Nl(ha,this,op).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Nl(ha,this,op).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Nl(ha,this,op).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Nl(ha,this,Y1).call(this,s)})}}function op(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function Y1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function mye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function rS(t,e,n){return(e=pye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pye(t){var e=wye(t,"string");return typeof e=="symbol"?e:e+""}function wye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vye{constructor(e){rS(this,"plugin",void 0),rS(this,"mergedCellsCollection",void 0),rS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const y=v.row+v.rowspan-a-g;o[2]+y>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?y:0}else if(r==="right"){const y=v.col+v.colspan-l-g;o[3]+y>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?y:0}else if(r==="up"){const y=u-g-v.row+1;o[0]+y<0?o[0]+=g:o[0]-=g?y:0}else if(r==="left"){const y=c-g-v.col+1;o[1]+y<0?o[1]+=g:o[1]-=g?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),cn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,v=d-g;let y=null,E=null,C=null;switch(r){case"up":y="includesVertically",C=c-v+1;break;case"left":y="includesHorizontally",C=c-v+1;break;case"down":y="includesVertically",C=h+v-1;break;case"right":y="includesHorizontally",C=h+v-1;break}return M(i,_=>{_[y](C)&&_.isFarther(E,r)&&(E=_)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return M(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:v}=g;return v===h.getWidth()}):!f.every(g=>{let{rowspan:v}=g;return v===h.getHeight()})}}function iS(t,e,n){return(e=yye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yye(t){var e=Cye(t,"string");return typeof e=="symbol"?e:e+""}function Cye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bye{constructor(e){iS(this,"plugin",void 0),iS(this,"hot",void 0),iS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Sye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(HT)}return this.getTranslatedPhrase(AT)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Ho.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function df(t,e,n){return(e=Rye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rye(t){var e=Eye(t,"string");return typeof e=="symbol"?e:e+""}function Eye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G1{constructor(e){df(this,"data",void 0),df(this,"next",null),df(this,"prev",null),this.data=e}}class sp{constructor(){df(this,"first",null),df(this,"last",null)}push(e){const n=new G1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new G1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Tye(t,e){sV(t,e),e.add(t)}function Dl(t,e,n){sV(t,e),e.set(t,n)}function sV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){return t.get(tv(t,e))}function Fr(t,e,n){return t.set(tv(t,e),n),n}function tv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var So=new WeakMap,Ro=new WeakMap,Eo=new WeakMap,To=new WeakMap,o0=new WeakMap,ap=new WeakMap,lp=new WeakMap,oS=new WeakSet;class Mye{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Tye(this,oS),Dl(this,So,new sp),Dl(this,Ro,new sp),Dl(this,Eo,null),Dl(this,To,null),Dl(this,o0,null),Dl(this,ap,null),Dl(this,lp,null),Fr(o0,this,n),Fr(ap,this,r),Fr(lp,this,i)}getCurrentVerticalNode(){return at(To,this).data}getFirstVerticalNode(){return at(Ro,this).first.data}getNextVerticalNode(){return at(To,this).next.data}getPrevVerticalNode(){return at(To,this).prev.data}getCurrentHorizontalNode(){return at(Eo,this).data}getFirstHorizontalNode(){return at(So,this).first.data}getNextHorizontalNode(){return at(Eo,this).next.data}getPrevHorizontalNode(){return at(Eo,this).prev.data}setPrevNodeAsActive(){Fr(To,this,at(To,this).prev),Fr(Eo,this,at(Eo,this).prev)}setNextNodeAsActive(){Fr(To,this,at(To,this).next),Fr(Eo,this,at(Eo,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Fr(So,this,new sp);for(let s=n.row;s<=r.row;s++)if(!at(ap,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(at(lp,this).isHidden(a))continue;const l=tv(oS,this,K1).call(this,e,at(So,this),i,s,a);l&&Fr(Eo,this,l)}at(So,this).first&&(at(So,this).first.prev=at(So,this).last,at(So,this).last.next=at(So,this).first);const o=new WeakSet;Fr(Ro,this,new sp);for(let s=n.col;s<=r.col;s++)if(!at(lp,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(at(ap,this).isHidden(a))continue;const l=tv(oS,this,K1).call(this,e,at(Ro,this),o,a,s);l&&Fr(To,this,l)}at(Ro,this).first&&(at(Ro,this).first.prev=at(Ro,this).last,at(Ro,this).last.next=at(Ro,this).first)}setActiveNode(e,n){return at(So,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Fr(Eo,this,r),!1}),at(Ro,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Fr(To,this,r),!1}),this}}function K1(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=at(o0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function aV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function _ye(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!De(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),If()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[v,y]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if(If()&&d===0&&!e.getSettings().rowHeaders){const V=aV(e,h,g);i.set(l,V/g)}const C=n.getRenderableFromVisualIndex(l),_=r.getRenderableFromVisualIndex(u),I=v-C+1,P=y-_+1;let T=n.getNearestNotHiddenIndex(h,1),A=r.getNearestNotHiddenIndex(d,1);if(E){const V=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(V)||(T=Math.max(T,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(V)||(A=Math.max(A,e.getFirstRenderedVisibleColumn()))}const G=Math.min(g,I),U=Math.min(f,P);T===l&&A===u?(a.setAttribute("rowspan",G),a.setAttribute("colspan",U)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function Pye(t,e){lV(t,e),e.add(t)}function up(t,e,n){lV(t,e),e.set(t,n)}function lV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sS(t,e,n){return(e=xye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xye(t){var e=Iye(t,"string");return typeof e=="symbol"?e:e+""}function Iye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jf(t,e,n){return t.set(ht(t,e),n),n}function vt(t,e){return t.get(ht(t,e))}function ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeMergeCells");oe.getSingleton().register("afterMergeCells");oe.getSingleton().register("beforeUnmergeCells");oe.getSingleton().register("afterUnmergeCells");const s0="mergeCells",Oye=150,q1=s0;var vi=new WeakMap,yi=new WeakMap,Vo=new WeakMap,X1=new WeakMap,pt=new WeakSet;class Aye extends qe{constructor(){super(...arguments),Pye(this,pt),sS(this,"mergedCellsCollection",null),sS(this,"autofillCalculations",null),sS(this,"selectionCalculations",null),up(this,vi,null),up(this,yi,{row:0,col:0}),up(this,Vo,new Mye({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),up(this,X1,_ye(this))}static get PLUGIN_KEY(){return s0}static get PLUGIN_PRIORITY(){return Oye}static get DEFAULT_SETTINGS(){return{[PL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[s0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new ev(this),this.autofillCalculations=new vye(this),this.selectionCalculations=new bye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Hye).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Dye).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,kye).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,$ye).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Lye).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Z1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Z1).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Vye).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Wye).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Bye).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,J1).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,J1).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Nye).call(e,...r)}),this.addHook("afterRenderer",function(){return vt(X1,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Fye).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,jye).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Uye).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,zye).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Yye).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Gye).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Kye).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,qye).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Xye).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Jye).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Zye).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Qye).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,eCe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,tCe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,nCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!AE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=_f(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=_f(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Ho.containsNegativeValues(e)?(tt(Ho.NEGATIVE_VALUES_WARNING(e)),!1):Ho.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(tt(Ho.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Ho.isSingleCell(e)?(tt(Ho.IS_SINGLE_CELL(e)),!1):Ho.containsZeroSpan(e)?(tt(Ho.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),M(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:q1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(q1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Hye(){this.generateFromSettings(),this.hot.render()}function Nye(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Dye(t){vt(yi,this).row=t.row,vt(yi,this).col=t.col}function kye(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;vt(vi,this)&&(i.getRenderableFromVisualIndex(vt(vi,this).row)!==null&&(n.row=vt(vi,this).row),r.getRenderableFromVisualIndex(vt(vi,this).col)!==null&&(n.col=vt(vi,this).col),jf(vi,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function $ye(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Lye(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){jf(vi,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);jf(vi,this,e.clone()),n&&e.assign(n)}function J1(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ye(g,u,h),Ye(v,c,d),Ye(this.hot.getLastRenderedVisibleRow(),u,h),Ye(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Fye(t){t.items.push({name:"---------"},Sye(this))}function Z1(){jf(vi,this,null)}function Vye(){if(vt(vi,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=vt(vi,this).clone().normalize();vt(Vo,this).setActiveNode(r.row,r.col),vt(yi,this).row>0||vt(yi,this).col>0?vt(Vo,this).setPrevNodeAsActive():(n==="E-W"&&vt(yi,this).col<0||e==="S-N"&&vt(yi,this).row<0)&&vt(Vo,this).setNextNodeAsActive()}function Wye(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(vt(yi,this).col<0){const{rowEnd:a,colEnd:l}=vt(Vo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(vt(yi,this).col>0){const{rowStart:a,colStart:l}=vt(Vo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(vt(yi,this).row<0){const{rowEnd:a,colEnd:l}=vt(Vo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(vt(yi,this).row>0){const{rowStart:a,colStart:l}=vt(Vo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}vt(Vo,this).setActiveNode(t,e),jf(yi,this,{row:0,col:0})}function Bye(){this.hot.getSelectedRangeLast().isHeader()||vt(Vo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function jye(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Uye(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function zye(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Yye(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function Gye(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Kye(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function qye(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Xye(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Jye(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Zye(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);M(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Qye(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function eCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function tCe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function nCe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,aV(this.hot,e,g))}),t}function rCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:LL(u.type))(l,u,d)(c,h);if(g===zo){const v=a+1;if(typeof e[v]<"u")return s(v)}return g}(0)}}const uV="sort";function iCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${uV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function oCe(t){const e=t.className.split(" "),n=new RegExp(`^${uV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function sCe(t,e,n){return(e=aCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aCe(t){var e=lCe(t,"string");return typeof e=="symbol"?e:e+""}function lCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nv="multiColumnSorting",uCe=170,Q1=nv;$L(nv,rCe);class cCe extends GL{constructor(){super(...arguments),sCe(this,"pluginKey",nv)}static get PLUGIN_KEY(){return nv}static get PLUGIN_PRIORITY(){return uCe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,$w)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:qa,position:"before",group:Q1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Q1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),we(e,oCe(e)),this.enabled!==!1&&q(e,iCe(...r))}onAfterOnCellMouseDown(e,n){l_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,$w))):this.sort(this.getColumnNextConfig(n.col)))}}function eA(t,e,n){return(e=hCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hCe(t){var e=dCe(t,"string");return typeof e=="symbol"?e:e+""}function dCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fCe="multipleSelectionHandles",gCe=160;class mCe extends qe{constructor(){super(...arguments),eA(this,"dragged",[]),eA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return fCe}static get PLUGIN_PRIORITY(){return gCe}isEnabled(){return Bo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ve(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ve(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function a0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function cV(){return{label:"",isPlaceholder:!0}}function pCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;M(t,i=>{const o=[];let s=0;n.push(o),M(i,a=>{const l=a0();if(De(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Et(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Et(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(cV());return!u})});const r=Math.max(...Ue(n,i=>i.length));return M(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>a0());i.splice(i.length,0,...o)}}),n}function aS(t,e,n){wCe(t,e),e.set(t,n)}function wCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Li(t,e){return t.get(hV(t,e))}function Ed(t,e,n){return t.set(hV(t,e),n),n}function hV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tA=["label","collapsible"];var ps=new WeakMap,kl=new WeakMap,lS=new WeakMap;class vCe{constructor(){aS(this,ps,[]),aS(this,kl,0),aS(this,lS,1/0)}setColumnsLimit(e){Ed(lS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Ed(ps,this,pCe(e,Li(lS,this))),Ed(kl,this,Li(ps,this).length)}getData(){return Li(ps,this)}mergeWith(e){M(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&cn(s,o,tA)})}map(e){M(Li(ps,this),n=>{M(n,r=>{const i=e({...r});De(i)&&cn(r,i,tA)})})}getHeaderSettings(e,n){var r;if(e>=Li(kl,this)||e<0)return null;const i=Li(ps,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Li(kl,this)||e<0)return i;const o=Li(ps,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Li(kl,this)}getColumnsCount(){return Li(kl,this)>0?Li(ps,this)[0].length:0}clear(){Ed(ps,this,[]),Ed(kl,this,0)}}function uS(t,e,n){return(e=yCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yCe(t){var e=CCe(t,"string");return typeof e=="symbol"?e:e+""}function CCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dV="DF-pre-order";function fV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=fV.call(this.childs[r],t,e)}return n}const bCe="DF-post-order";function gV(t,e){for(let n=0;n<this.childs.length;n++)if(gV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const mV="BF";function SCe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const RCe=mV,nA=new Map([[dV,fV],[bCe,gV],[mV,SCe]]);class rv{constructor(e){uS(this,"data",{}),uS(this,"parent",null),uS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new rv({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:RCe;if(!nA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);nA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function cS(t,e,n){ECe(t,e),e.set(t,n)}function ECe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(t,e){return t.get(pV(t,e))}function TCe(t,e,n){return t.set(pV(t,e),n),n}function pV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hc=new WeakMap,$l=new WeakMap,dc=new WeakMap;class MCe{constructor(e){cS(this,hc,new Map),cS(this,$l,new Map),cS(this,dc,null),TCe(dc,this,e)}getRoots(){return Array.from(ir(hc,this).values())}getRootByColumn(e){let n;return ir($l,this).has(e)&&(n=ir(hc,this).get(ir($l,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-ir($l,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;ir($l,this).clear(),M(ir(hc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)ir($l,this).set(i,e);e+=r})}buildTree(){this.clear();const e=ir(dc,this).getColumnsCount();let n=0;for(;n<e;){const r=ir(dc,this).getHeaderSettings(0,n),i=new rv;ir(hc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=ir(dc,this).getHeadersSettings(r,n,i);r+=1,M(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new rv(a),e.addChild(l)),r<ir(dc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){ir(hc,this).clear(),ir($l,this).clear()}}function wV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function iv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function ov(t){return iv(t,"origColspan")===t.data.origColspan}function R_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ov(t))return R_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)M(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,wV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):ov(a)&&(l.isCollapsed=iv(a,"isCollapsed"))}),{rollbackModification:()=>E_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function E_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ov(t))return E_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)M(o,l=>{wV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=iv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):ov(l)&&(u.isCollapsed=iv(l,"isCollapsed"))}),{rollbackModification:()=>R_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function _Ce(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function PCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const rA=new Map([["collapse",E_],["expand",R_],["hide-column",_Ce],["show-column",PCe]]);function xCe(t,e,n){if(!rA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return rA.get(t)(e,n)}function cp(t){const e=[];return M(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=OCe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(cV());else{const f=ICe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function ICe(t){const{crossHiddenColumns:e,...n}=a0(t);return n}function OCe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function hS(t,e,n){ACe(t,e),e.set(t,n)}function ACe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Td(t,e,n){return t.set(vV(t,e),n),n}function Vt(t,e){return t.get(vV(t,e))}function vV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mo=new WeakMap,br=new WeakMap,Ll=new WeakMap;class HCe{constructor(){hS(this,Mo,new vCe),hS(this,br,new MCe(Vt(Mo,this))),hS(this,Ll,[[]])}setState(e){Vt(Mo,this).setData(e);let n=!1;try{Vt(br,this).buildTree()}catch{Vt(br,this).clear(),Vt(Mo,this).clear(),n=!0}return Td(Ll,this,cp(Vt(br,this).getRoots())),n}setColumnsLimit(e){Vt(Mo,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Vt(Mo,this).mergeWith(n),Vt(br,this).buildTree(),Td(Ll,this,cp(Vt(br,this).getRoots()))}mapState(e){Vt(Mo,this).map(e),Vt(br,this).buildTree(),Td(Ll,this,cp(Vt(br,this).getRoots()))}mapNodes(e){return Sn(Vt(br,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Vt(br,this).getNode(n,r);let o;return i&&(o=xCe(e,i,r),Td(Ll,this,cp(Vt(br,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Vt(Ll,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Vt(br,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Vt(br,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},dV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Vt(Mo,this).getLayersCount()}getColumnsCount(){return Vt(Mo,this).getColumnsCount()}clear(){Td(Ll,this,[]),Vt(Mo,this).clear(),Vt(br,this).clear()}}function Md(t,e,n){return(e=NCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NCe(t){var e=DCe(t,"string");return typeof e=="symbol"?e:e+""}function DCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kCe{constructor(e,n){Md(this,"hot",void 0),Md(this,"nestedHeaderSettingsGetter",void 0),Md(this,"layersCount",0),Md(this,"container",void 0),Md(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),_u(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function $Ce(t,e){yV(t,e),e.add(t)}function iA(t,e,n){return(e=LCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LCe(t){var e=FCe(t,"string");return typeof e=="symbol"?e:e+""}function FCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _d(t,e,n){yV(t,e),e.set(t,n)}function yV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ks(t,e,n){return t.set(Bt(t,e),n),n}function je(t,e){return t.get(Bt(t,e))}function Bt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const oA="nestedHeaders",VCe=280;var ft=new WeakMap,da=new WeakMap,ff=new WeakMap,wy=new WeakMap,sv=new WeakMap,qt=new WeakSet;class WCe extends qe{constructor(){super(...arguments),$Ce(this,qt),_d(this,ft,new HCe),_d(this,da,null),_d(this,ff,null),_d(this,wy,!1),_d(this,sv,null),iA(this,"ghostTable",new kCe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),iA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return oA}static get PLUGIN_PRIORITY(){return VCe}isEnabled(){return!!this.hot.getSettings()[oA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&tt(ct`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Bt(qt,this,rbe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,ibe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,zCe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,YCe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,GCe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,KCe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,qCe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,XCe).call(e,...i)}),this.addHook("afterSelection",()=>Bt(qt,this,hp).call(this)),this.addHook("afterSelectionFocusSet",()=>Bt(qt,this,hp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,BCe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Bt(qt,this,ZCe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,ebe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,tbe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,jCe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,UCe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,JCe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,QCe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(qt,e,nbe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Bt(qt,this,hp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Bt(qt,this,hp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();je(ft,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=je(ft,this).setState(e)),this.detectedOverlappedHeaders&&tt(ct`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";je(ft,this).triggerColumnModification(i,r)}),!je(da,this)&&this.enabled&&ks(da,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";je(ft,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),je(ft,this).clear(),je(da,this).unsubscribe(),ks(da,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return je(ft,this)}getLayersCount(){return je(ft,this).getLayersCount()}getHeaderSettings(e,n){return je(ft,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),we(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),we(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),we(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),we(o,"hiddenHeader"),we(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=je(ft,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,v,y;const{wtOverlays:E}=l._wt,C=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),_=(v=E.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((y=E.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const P=C||_?Math.min(c,r-i):c;P>1&&o.setAttribute("colspan",P)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(we(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=je(ft,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){ks(ft,this,null),je(da,this)!==null&&(je(da,this).unsubscribe(),ks(da,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return je(ft,this).getHeaderTreeNodeData(e.row,e.col)}}function hp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=je(ft,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function BCe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=je(sv,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(ks(sv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=je(ft,this).findLeftMostColumnIndex(a,l),g=je(ft,this).findRightMostColumnIndex(a,l),v=g-f+1;if(f<c&&g>h)return f;if(s){let y=null;return f>=c&&g>h?v>d?(e.value="start",y=f):(e.value="end",y=g):f<c&&g<=h&&(v>d?(e.value="end",y=g):(e.value="start",y=f)),y}return f<=c?f:g}function jCe(t,e,n){const r=je(ft,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=je(ft,this).getHeaderSettings(e,t);if(o===XE){if(!a)return r.columnIndex}else if(o===y$&&(l>s-i||!a))return null;return t}function UCe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,v=d-a;if(v===0)continue;((i=je(ft,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][v]="")}}}function zCe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function YCe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;ks(ff,this,e.clone()),ks(wy,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Vv(t)||ja(t)&&l||Yk(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function GCe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ye(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function KCe(){ks(wy,this,!1)}function qCe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!je(wy,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=je(ft,this).getHeaderTreeNodeData(je(ff,this).row,je(ff,this).col);if(e.setHighlight(je(ff,this)),o>e.getWidth()||i<n||i+o-1>r){const s=je(ft,this).findTopMostEntireHeaderLevel(Ye(n,i,i+o-1),Ye(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function XCe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=je(ft,this).findLeftMostColumnIndex(n.row,n.col),o=je(ft,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function JCe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});ks(sv,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function ZCe(t){if(je(ft,this).getLayersCount()>0){t.length=0;for(let e=0;e<je(ft,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function QCe(t){const e=je(ft,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=je(ft,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Gn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?je(ft,this).getHeaderTreeNodeData(0,n).columnIndex:n}function ebe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function tbe(t,e,n){var r;const{label:i}=(r=je(ft,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function nbe(t,e){if(t<0)return this.hot.getCell(t,je(ft,this).findLeftMostColumnIndex(t,e),!0)}function rbe(){this.updatePlugin()}function ibe(t,e){e||this.updatePlugin()}function Pd(t,e,n){return(e=obe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function obe(t){var e=sbe(t,"string");return typeof e=="symbol"?e:e+""}function sbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class abe{constructor(e,n){Pd(this,"hot",void 0),Pd(this,"data",null),Pd(this,"plugin",void 0),Pd(this,"parentReference",new WeakMap),Pd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&M(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&M(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ke(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(M(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];M(r,o=>{i.push(this.getDataObject(o))}),M(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function sA(t,e,n){return(e=lbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lbe(t){var e=ube(t,"string");return typeof e=="symbol"?e:e+""}function ube(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T_{constructor(e,n){sA(this,"hot",void 0),sA(this,"plugin",void 0),this.hot=n,this.plugin=e}}class ko extends T_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(M(l,c=>{c&&s.removeChild(c)}),q(n,ko.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");q(d,ko.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&be(c,[Tu()]),q(n,ko.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${ko.CSS_CLASSES.button} ${ko.CSS_CLASSES.expandButton}`),u&&be(n,[Ci(!1)])):(q(c,`${ko.CSS_CLASSES.button} ${ko.CSS_CLASSES.collapseButton}`),u&&be(n,[Ci(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class cbe extends T_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),M(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&M(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];M(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return M(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);M(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return M(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);M(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&M(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];M(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];M(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];M(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&M(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ve(e.target,ko.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),xi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function hbe(t,e,n){dbe(t,e),e.set(t,n)}function dbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fbe(t,e,n){return(e=gbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gbe(t){var e=mbe(t,"string");return typeof e=="symbol"?e:e+""}function mbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pbe(t,e){return t.get(wbe(t,e))}function wbe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var aA=new WeakMap;class vbe extends T_{constructor(){super(...arguments),fbe(this,"dataManager",this.plugin.dataManager),hbe(this,aA,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(ZT)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(QT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return M(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=pbe(aA,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function dp(t,e,n){return(e=ybe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ybe(t){var e=Cbe(t,"string");return typeof e=="symbol"?e:e+""}function Cbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bbe{constructor(e){dp(this,"plugin",void 0),dp(this,"hot",void 0),dp(this,"dataManager",void 0),dp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Ht(i)&&(tt(ct`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Sbe(t,e){CV(t,e),e.add(t)}function lA(t,e,n){CV(t,e),e.set(t,n)}function CV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dS(t,e,n){return(e=Rbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rbe(t){var e=Ebe(t,"string");return typeof e=="symbol"?e:e+""}function Ebe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qp(t,e){return t.get(Tn(t,e))}function av(t,e,n){return t.set(Tn(t,e),n),n}function Tn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lv="nestedRows",Tbe=300,uA=lv,Mbe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var vy=new WeakMap,fc=new WeakMap,On=new WeakSet;class _be extends qe{constructor(){super(...arguments),Sbe(this,On),dS(this,"dataManager",null),dS(this,"headersUI",null),dS(this,"collapsedRowsMap",null),lA(this,vy,!1),lA(this,fc,!1)}static get PLUGIN_KEY(){return lv}static get PLUGIN_PRIORITY(){return Tbe}isEnabled(){return!!this.hot.getSettings()[lv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new vg),this.dataManager=new abe(this,this.hot),this.collapsingUI=new cbe(this,this.hot),this.headersUI=new ko(this,this.hot),this.contextMenuUI=new vbe(this,this.hot),this.rowMoveController=new bbe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Wbe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Bbe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Ibe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Obe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Abe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,xbe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Dbe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Nbe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,kbe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,$be).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Lbe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Fbe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Hbe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Vbe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Pbe).call(e,...r)}),this.addHook("beforeLoadData",n=>Tn(On,this,cA).call(this,n)),this.addHook("beforeUpdateData",n=>Tn(On,this,cA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:uA,relativeToGroup:qa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uA)}disableCoreAPIModifiers(){av(fc,this,!0)}enableCoreAPIModifiers(){av(fc,this,!1)}onModifyRowData(e){if(!qp(fc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!qp(fc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return qp(fc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Pbe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function xbe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Ibe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),av(vy,this,!0),this.dataManager.getData().slice()}function Obe(t){return this.contextMenuUI.appendOptions(t)}function Abe(t,e){this.headersUI.appendLevelIndicators(t,e)}function Hbe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Nbe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{av(vy,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Dbe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function kbe(){this.collapsingUI.collapsedRowsStash.stash()}function $be(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Lbe(){this.collapsingUI.collapsedRowsStash.stash()}function Fbe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Vbe(){this.dataManager.rewriteCache()}function Wbe(){this.headersUI.updateRowHeaderWidth()}function Bbe(t,e){qp(vy,this)&&(e.skipRender=!0)}function cA(t){if(!I$(t)){kE(Mbe),this.hot.getSettings()[lv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function fS(t,e,n){return(e=jbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jbe(t){var e=Ube(t,"string");return typeof e=="symbol"?e:e+""}function Ube(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zbe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;fS(this,"rootWindow",void 0),fS(this,"prefix",void 0),fS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){M(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Ybe(t,e,n){return(e=Gbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gbe(t){var e=Kbe(t,"string");return typeof e=="symbol"?e:e+""}function Kbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}oe.getSingleton().register("persistentStateSave");oe.getSingleton().register("persistentStateLoad");oe.getSingleton().register("persistentStateReset");const hA="persistentState",qbe=0;class Xbe extends qe{constructor(){super(...arguments),Ybe(this,"storage",void 0)}static get PLUGIN_KEY(){return hA}static get PLUGIN_PRIORITY(){return qbe}isEnabled(){return!!this.hot.getSettings()[hA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new zbe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Jbe(t,e){Zbe(t,e),e.add(t)}function Zbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gS(t,e,n){return(e=Qbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qbe(t){var e=eSe(t,"string");return typeof e=="symbol"?e:e+""}function eSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mS="search",tSe=190,nSe="htSearchResult",rSe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},iSe=function(t,e,n){return Ht(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ht(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var pS=new WeakSet;class oSe extends qe{constructor(){super(...arguments),Jbe(this,pS),gS(this,"callback",rSe),gS(this,"queryMethod",iSe),gS(this,"searchResultClass",nSe)}static get PLUGIN_KEY(){return mS}static get PLUGIN_PRIORITY(){return tSe}isEnabled(){return this.hot.getSettings()[mS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[mS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return dA(pS,e,fA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return dA(pS,e,fA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){De(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function fA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function fp(t,e,n){return(e=sSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sSe(t){var e=aSe(t,"string");return typeof e=="symbol"?e:e+""}function aSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bV{constructor(e){fp(this,"viewportWidth",void 0),fp(this,"overwriteColumnWidthFn",void 0),fp(this,"baseWidths",new Map),fp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class lSe extends bV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=Jc?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=Jc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,v=g;o.includes(f)||(v=Math.round(g*l)),this.stretchedWidths.set(f,v),u=f,d<i.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function gA(t,e,n){uSe(t,e),e.set(t,n)}function uSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wS(t,e){return t.get(SV(t,e))}function gp(t,e,n){return t.set(SV(t,e),n),n}function SV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mp=new WeakMap,xd=new WeakMap;class cSe extends bV{constructor(){super(...arguments),gA(this,mp,0),gA(this,xd,-1)}prepare(e){super.prepare(e),gp(mp,this,0),gp(xd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),gp(xd,this,e),gp(mp,this,n)}calculate(){if(wS(xd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+wS(mp,this),0);this.stretchedWidths.set(wS(xd,this),n)}}function hSe(t,e){RV(t,e),e.add(t)}function pp(t,e,n){RV(t,e),e.set(t,n)}function RV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(t,e){return t.get(Ac(t,e))}function vS(t,e,n){return t.set(Ac(t,e),n),n}function Ac(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dSe="stretchColumns";var Yn=new WeakMap,gc=new WeakMap,yS=new WeakMap,wp=new WeakMap,Id=new WeakSet;class fSe{constructor(e){hSe(this,Id),pp(this,Yn,void 0),pp(this,gc,void 0),pp(this,yS,new Map([["all",new lSe(Ac(Id,this,mA).bind(this))],["last",new cSe(Ac(Id,this,mA).bind(this))]])),pp(this,wp,"none"),vS(Yn,this,e),vS(gc,this,Xt(Yn,this).columnIndexMapper.createAndRegisterIndexMap(dSe,"physicalIndexToValue"))}useStrategy(e){vS(wp,this,Xt(yS,this).has(e)?e:"none")}refreshStretching(){if(Xt(wp,this)==="none"){Xt(gc,this).clear();return}Xt(Yn,this).batchExecution(()=>{Xt(gc,this).clear();const e=Xt(yS,this).get(Xt(wp,this));let r=Xt(Yn,this).view.getViewportWidth();Ac(Id,this,gSe).call(this)&&(r-=_n(Xt(Yn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Xt(Yn,this).countCols();i++)Xt(Yn,this).columnIndexMapper.isHidden(Xt(Yn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Ac(Id,this,mSe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Xt(gc,this).setValueAtIndex(Xt(Yn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Xt(gc,this).getValueAtIndex(Xt(Yn,this).toPhysicalColumn(e))}}function gSe(){const{view:t}=Xt(Yn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Xt(Yn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=Xt(Yn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function mSe(t){var e;return(e=Xt(Yn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Jc}function mA(t,e){return Xt(Yn,this).runHooks("beforeStretchingColumnWidth",t,e)}function pSe(t,e){EV(t,e),e.add(t)}function CS(t,e,n){EV(t,e),e.set(t,n)}function EV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bS(t,e,n){return t.set(uv(t,e),n),n}function Ss(t,e){return t.get(uv(t,e))}function uv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wSe="stretchColumns",vSe=155;var Ec=new WeakMap,vp=new WeakMap,Od=new WeakMap,SS=new WeakSet;class ySe extends qe{constructor(){super(...arguments),pSe(this,SS),CS(this,Ec,new fSe(this.hot)),CS(this,vp,null),CS(this,Od,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Ss(vp,this)!==null&&Ss(vp,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),bS(vp,this,i.width)})})}))}static get PLUGIN_KEY(){return wSe}static get PLUGIN_PRIORITY(){return vSe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Ss(Ec,this).useStrategy(this.hot.getSettings().stretchH),Ss(Od,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return uv(SS,e,bSe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return uv(SS,e,CSe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Ss(Ec,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Ss(Od,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Ss(Ec,this).getStretchedWidth(e)}destroy(){Ss(Od,this).disconnect(),bS(Od,this,null),bS(Ec,this,null),super.destroy()}}function CSe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function bSe(t){t&&Ss(Ec,this).refreshStretching()}function SSe(t,e){RSe(t,e),e.add(t)}function RSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yp(t,e,n){return(e=ESe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ESe(t){var e=TSe(t,"string");return typeof e=="symbol"?e:e+""}function TSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const MSe="touchScroll",_Se=200;var Cp=new WeakSet;class PSe extends qe{constructor(){super(...arguments),SSe(this,Cp),yp(this,"scrollbars",[]),yp(this,"clones",[]),yp(this,"lockedCollection",!1),yp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return MSe}static get PLUGIN_PRIORITY(){return _Se}static get SETTING_KEYS(){return!0}isEnabled(){return OE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>RS(Cp,this,xSe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>RS(Cp,this,ISe).call(this)),this.addHook("afterMomentumScroll",()=>RS(Cp,this,OSe).call(this))}}function xSe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function ISe(){this.freezeOverlays=!0,M(this.clones,t=>{q(t,"hide-tween")})}function OSe(){this.freezeOverlays=!1,M(this.clones,t=>{we(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{M(this.clones,t=>{we(t,"show-tween")})},400),M(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function ASe(t,e){HSe(t,e),e.add(t)}function HSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NSe(t,e,n){return(e=DSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DSe(t){var e=kSe(t,"string");return typeof e=="symbol"?e:e+""}function kSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Se(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xp="trimRows",LSe=330;var pA=new WeakSet;class FSe extends qe{constructor(){super(...arguments),ASe(this,pA),NSe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Xp}static get PLUGIN_PRIORITY(){return LSe}isEnabled(){return!!this.hot.getSettings()[Xp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new vg),this.trimmedRowsMap.addLocalHook("init",()=>$Se(pA,this,VSe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Xp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),M(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(M(e,l=>{o[l]=!1}),i=Sn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function VSe(){const t=this.hot.getSettings()[Xp];Array.isArray(t)&&this.hot.batchExecution(()=>{M(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function WSe(t,e,n){return(e=BSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BSe(t){var e=jSe(t,"string");return typeof e=="symbol"?e:e+""}function jSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ii{constructor(e){WSe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function bp(t,e,n){return(e=USe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function USe(t){var e=zSe(t,"string");return typeof e=="symbol"?e:e+""}function zSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M_ extends Ii{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),bp(this,"stateBefore",void 0),bp(this,"range",void 0),bp(this,"type",void 0),bp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new M_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){M(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){ma(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function wA(t,e,n){return(e=YSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YSe(t){var e=GSe(t,"string");return typeof e=="symbol"?e:e+""}function GSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class __ extends Ii{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),wA(this,"columns",void 0),wA(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new __({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),b_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function vA(t,e,n){return(e=KSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KSe(t){var e=qSe(t,"string");return typeof e=="symbol"?e:e+""}function qSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P_ extends Ii{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),vA(this,"previousSortState",void 0),vA(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new P_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function yA(t,e,n){return(e=XSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XSe(t){var e=JSe(t,"string");return typeof e=="symbol"?e:e+""}function JSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x_ extends Ii{constructor(e){let{index:n,amount:r}=e;super("insert_col"),yA(this,"index",void 0),yA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new x_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function CA(t,e,n){return(e=ZSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZSe(t){var e=QSe(t,"string");return typeof e=="symbol"?e:e+""}function QSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I_ extends Ii{constructor(e){let{index:n,amount:r}=e;super("insert_row"),CA(this,"index",void 0),CA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new I_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Sp(t,e,n){return(e=eRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eRe(t){var e=tRe(t,"string");return typeof e=="symbol"?e:e+""}function tRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O_ extends Ii{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Sp(this,"changes",void 0),Sp(this,"selected",void 0),Sp(this,"countCols",void 0),Sp(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new O_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Qn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Qn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function bA(t,e,n){return(e=nRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nRe(t){var e=rRe(t,"string");return typeof e=="symbol"?e:e+""}function rRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A_ extends Ii{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),bA(this,"conditionsStack",void 0),bA(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new A_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function iRe(t,e,n){return(e=oRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oRe(t){var e=sRe(t,"string");return typeof e=="symbol"?e:e+""}function sRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H_ extends Ii{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),iRe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new H_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function TV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function ws(t,e,n){return(e=aRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aRe(t){var e=lRe(t,"string");return typeof e=="symbol"?e:e+""}function lRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N_ extends Ii{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),ws(this,"index",void 0),ws(this,"indexes",void 0),ws(this,"data",void 0),ws(this,"amount",void 0),ws(this,"headers",void 0),ws(this,"columnPositions",void 0),ws(this,"rowPositions",void 0),ws(this,"fixedColumnsStart",void 0),ws(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const v=[],y=l[g];fe(u,c,E=>{v.push(y[e.toPhysicalColumn(E)])}),h.push(v)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new N_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:TV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ue(this.data[c],o));const l=Ue(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),M(e.getSourceDataArray(),(c,h)=>{M(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&M(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function mc(t,e,n){return(e=uRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uRe(t){var e=cRe(t,"string");return typeof e=="symbol"?e:e+""}function cRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D_ extends Ii{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),mc(this,"index",void 0),mc(this,"data",void 0),mc(this,"fixedRowsBottom",void 0),mc(this,"fixedRowsTop",void 0),mc(this,"rowIndexesSequence",void 0),mc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Qn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new D_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:TV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function SA(t,e,n){return(e=hRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hRe(t){var e=dRe(t,"string");return typeof e=="symbol"?e:e+""}function dRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k_ extends Ii{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),SA(this,"rows",void 0),SA(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new k_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),b_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function fRe(t,e,n){return(e=gRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gRe(t){var e=mRe(t,"string");return typeof e=="symbol"?e:e+""}function mRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $_ extends Ii{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),fRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new $_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function pRe(t,e){[M_,__,P_,x_,I_,O_,A_,H_,N_,D_,k_,$_].forEach(n=>n.startRegisteringEvents(t,e))}function wRe(t,e){vRe(t,e),e.add(t)}function vRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ES(t,e,n){return(e=yRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yRe(t){var e=CRe(t,"string");return typeof e=="symbol"?e:e+""}function CRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RA="undoRedo",bRe="undoRedo",SRe=1e3;oe.getSingleton().register("beforeUndo");oe.getSingleton().register("afterUndo");oe.getSingleton().register("beforeRedo");oe.getSingleton().register("afterRedo");const EA=new Set;var Rp=new WeakSet;class RRe extends qe{static get PLUGIN_KEY(){return bRe}static get PLUGIN_PRIORITY(){return SRe}static get SETTING_KEYS(){return!0}constructor(e){super(e),wRe(this,Rp),ES(this,"doneActions",[]),ES(this,"undoneActions",[]),ES(this,"ignoreNewActions",!1),pRe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return TS(Rp,e,ERe).call(e,...r)}),this.registerShortcuts(),TS(Rp,this,TRe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),TS(Rp,this,MRe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:RA};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(RA)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function ERe(t,e){e==="loadData"&&this.clear()}function TRe(){const t=e=>{EA.has(e)||(tt(ct`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),EA.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function MRe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function _Re(){Ke(Jd),Ke(Hue),Ke(Zd),Ke(cce),Ke(vce),Ke(GL),Ke(fhe),Ke(Jhe),Ke(hy),Ke(sfe),Ke(Afe),Ke(Vfe),Ke(gy),Ke(Sge),Ke(wpe),Ke(Xpe),Ke(Rwe),Ke(Dwe),Ke(Gwe),Ke(ive),Ke(gve),Ke(Ave),Ke(Wve),Ke(Aye),Ke(cCe),Ke(mCe),Ke(WCe),Ke(_be),Ke(Xbe),Ke(oSe),Ke(ySe),Ke(PSe),Ke(FSe),Ke(RRe)}function PRe(){rae(),Mle(),Dle(),tue(),_Re()}function xRe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var MS,_S,PS,xS,IS;PRe();xRe(Te);Te.__GhostTable=o_;Te._getListenersCounter=iZ;Te._getRegisteredMapsCounter=Ere;Te.EventManager=Ri;const IRe=[s8,gJ,rre,Ple,hJ,K8,c8,nQ,cJ,d8,wJ,tQ],ORe=[U8,vJ];Te.helper={};Te.dom={};M(IRe,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.helper[e]=t[e])})});M(ORe,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.dom[e]=t[e])})});Te.cellTypes=(MS=Te.cellTypes)!==null&&MS!==void 0?MS:{};M(xie(),t=>{Te.cellTypes[t]=LM(t)});Te.cellTypes.registerCellType=ci;Te.cellTypes.getCellType=LM;Te.editors=(_S=Te.editors)!==null&&_S!==void 0?_S:{};M(ZJ(),t=>{Te.editors[`${Zn(t)}Editor`]=Tw(t)});Te.editors.registerEditor=Mr;Te.editors.getEditor=Tw;Te.renderers=(PS=Te.renderers)!==null&&PS!==void 0?PS:{};M(wQ(),t=>{const e=Mw(t);t==="base"&&(Te.renderers.cellDecorator=e),Te.renderers[`${Zn(t)}Renderer`]=e});Te.renderers.registerRenderer=jr;Te.renderers.getRenderer=Mw;Te.validators=(xS=Te.validators)!==null&&xS!==void 0?xS:{};M(CQ(),t=>{Te.validators[`${Zn(t)}Validator`]=jE(t)});Te.validators.registerValidator=zl;Te.validators.getValidator=jE;Te.plugins=(IS=Te.plugins)!==null&&IS!==void 0?IS:{};M(BE(),t=>{Te.plugins[t]=gg(t)});Te.plugins[`${Zn(qe.PLUGIN_KEY)}Plugin`]=qe;Te.plugins.registerPlugin=Ke;Te.plugins.getPlugin=gg;let gf=null,Wt=new Map,Tc={row:-1,col:-1,time:0};function vs(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return t===void 0?(o="undefined",s.readOnly=!1):typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function Vr(t,e,n){let r=[],i=!0,o=new Map;const s={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback},a=n.dataPathString||"";if(Array.isArray(t)){const l=t.length>0?t[0]:null;if(l&&typeof l=="object"&&l!==null&&!Array.isArray(l)){let u=Object.keys(l);if(u.length===0){for(let c=1;c<t.length;c++)if(t[c]&&typeof t[c]=="object"&&Object.keys(t[c]).length>0){u=Object.keys(t[c]);break}}i=u.length>0?u:t.length>0?["(내용 없음)"]:["새 열"],t.forEach((c,h)=>{const d=[],f=typeof c=="object"&&c!==null?c:{};i.forEach((g,v)=>{const y=f[g],E=`${a}[${h}]`,{displayValue:C,cellMeta:_}=vs(y,E,g,!1,s);d.push(C),o.set(`${h}-${v}`,_)}),r.push(d)}),t.length===0&&Array.isArray(i)&&i.length===1&&(i[0]==="새 열"||i[0]==="(내용 없음)"||i[0])}else i=["Index","Value"],r=t.map((u,c)=>{const h=a,{displayValue:d,cellMeta:f}=vs(c,h,String(c),!0,s),{displayValue:g,cellMeta:v}=vs(u,h,String(c),!1,s);return o.set(`${c}-0`,f),o.set(`${c}-1`,v),[d,g]})}else if(typeof t=="object"&&t!==null){const l=Object.keys(t);if(l.length>0&&l.every(c=>Array.isArray(t[c]))){let c=0;l.forEach(d=>{c=Math.max(c,t[d].length)});const h=["항목 (Key)"];for(let d=0;d<c;d++)h.push(String(d));i=h,r=l.map((d,f)=>{const g=t[d],v=[],y=a,{displayValue:E,cellMeta:C}=vs(d,y,d,!0,s);v.push(E),o.set(`${f}-0`,C);for(let _=0;_<c;_++)if(_<g.length){const I=g[_],P=`${a?a+".":""}${d}`,{displayValue:T,cellMeta:A}=vs(I,P,String(_),!1,s);v.push(T),o.set(`${f}-${1+_}`,A)}else v.push(""),o.set(`${f}-${1+_}`,{readOnly:!0,originalValue:null,isPadding:!0});return v})}else i=["항목 (Key)","값 (Value)"],r=l.map((c,h)=>{const d=t[c],f=a,{displayValue:g,cellMeta:v}=vs(c,f,c,!0,s),{displayValue:y,cellMeta:E}=vs(d,f,c,!1,s);return o.set(`${h}-0`,v),o.set(`${h}-1`,E),[g,y]})}else{i=["항목","값"];const l=e||(t==null?String(t):"Value"),u=a,{displayValue:c,cellMeta:h}=vs(l,u,"",!0,s),{displayValue:d,cellMeta:f}=vs(t,u,"",!1,s);o.set("0-0",h),o.set("0-1",f),r=[[c,d]]}return{preparedHotData:r,preparedColHeaders:i,preparedCellMetaMap:o}}function MV(){return gf&&(gf.destroy(),gf=null),Wt.clear(),Tc={row:-1,col:-1,time:0},null}function ARe(t,e,n){const r=n.tableViewDomElement;MV(),r&&(r.innerHTML="");const{preparedHotData:i,preparedColHeaders:o,preparedCellMetaMap:s}=Vr(t,e,n);return Wt=s,r?(gf=new Te(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입"},col_right:{name:"오른쪽에 열 삽입"},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제"},"---------":Te.plugins.ContextMenu.SEPARATOR,duplicate_row:{name:"선택 행 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)||typeof t=="object"&&t!==null&&!Array.isArray(t)):!0},callback:async function(a,l){const u=this,c=l[0].start.row;if(Array.isArray(t)){if(c>=0&&c<t.length){const h=JSON.parse(JSON.stringify(t[c]));t.splice(c+1,0,h),n.refreshTreeViewCallback("row_duplicated_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=Vr(t,e,n);Wt=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}else if(typeof t=="object"&&t!==null){const h=Object.keys(t);if(c<0||c>=h.length)return;const d=h[c];let f=d+"_복제본",g=f,v=1;for(;t.hasOwnProperty(g);)g=`${f}_${v++}`;pc({title:"새 키 입력 (행 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:y=>{const E=y.trim();return E?E!==d&&t.hasOwnProperty(E)?"이미 사용 중인 키입니다.":/^\d+$/.test(E)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(y=>{if(y.isConfirmed&&y.value!==void 0){const E=y.value.trim(),C=JSON.parse(JSON.stringify(t[d])),_={};for(const A of Object.keys(t))_[A]=t[A],A===d&&(_[E]=C);Object.keys(t).forEach(A=>delete t[A]),Object.assign(t,_),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered");const{preparedHotData:I,preparedColHeaders:P,preparedCellMetaMap:T}=Vr(t,e,n);Wt=T,u.updateSettings({colHeaders:P}),u.loadData(I)}})}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])):!0},callback:async function(a,l){const u=this,c=l[0].start.col,h=u.getColHeader();if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])&&Array.isArray(h)&&c>=0&&c<h.length){const d=h[c];if(typeof d!="string")return;let f=d+"_복제본",g=f,v=1;for(;t[0].hasOwnProperty(g);)g=`${f}_${v++}`;pc({title:"새 열 키 입력 (열 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:y=>{const E=y.trim();return E?t.length>0&&t[0].hasOwnProperty(E)&&E!==d?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(E)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(y=>{if(y.isConfirmed&&y.value!==void 0){const E=y.value.trim();t.forEach(P=>{if(typeof P=="object"&&P!==null){const T=P.hasOwnProperty(d)?JSON.parse(JSON.stringify(P[d])):null,A={};let G=!1;for(const U in P)P.hasOwnProperty(U)&&(A[U]=P[U],U===d&&(A[E]=T,G=!0));G||(A[E]=T),Object.keys(P).forEach(U=>delete P[U]),Object.assign(P,A)}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered");const{preparedHotData:C,preparedColHeaders:_,preparedCellMetaMap:I}=Vr(t,e,n);Wt=I,u.updateSettings({colHeaders:_}),u.loadData(C)}})}}},make_array:{name:"값을 빈 배열 [] 로 변경",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=Wt.get(`${c}-${h}`);if(d&&d.isPadding)return!0;const f=a.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt};return Ad(c,h,g)===null},callback:function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col,f=u.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt},v=Ad(h,d,g);if(v!==null){n.updateJsonDataCallback(v,"[]",!1);let y=t;if(n.dataPathString){const I=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;y=n.getObjectByPathCallback(I,n.dataPathString)}else y=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;y===void 0&&(y=v.includes("[")||v.includes(".")?{}:null);const{preparedHotData:E,preparedColHeaders:C,preparedCellMetaMap:_}=Vr(y,e,n);Wt=_,u.updateSettings({colHeaders:C}),u.loadData(E)}else yt({title:"오류",text:"값을 빈 배열로 변경할 수 없는 셀입니다.",icon:"error",showCancelButton:!1,hotInstance:u})}},make_object:{name:"값을 빈 객체 {} 로 변경",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=Wt.get(`${c}-${h}`);if(d&&d.isPadding)return!0;const f=a.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt};return Ad(c,h,g)===null},callback:function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col,f=u.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt},v=Ad(h,d,g);if(v!==null){n.updateJsonDataCallback(v,"{}",!1);let y=t;if(n.dataPathString){const I=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;y=n.getObjectByPathCallback(I,n.dataPathString)}else y=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;y===void 0&&(y=v.includes("[")||v.includes(".")?{}:null);const{preparedHotData:E,preparedColHeaders:C,preparedCellMetaMap:_}=Vr(y,e,n);Wt=_,u.updateSettings({colHeaders:C}),u.loadData(E)}else yt({title:"오류",text:"값을 빈 객체로 변경할 수 없는 셀입니다.",icon:"error",showCancelButton:!1,hotInstance:u})}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(a,l,u){const c={},h=Wt.get(`${a}-${l}`);return h&&(c.readOnly=h.readOnly,h.isDrillable&&(c.renderer=function(d,f,g,v,y,E){Te.renderers.TextRenderer.apply(this,arguments),f.style.color="#007bff",f.style.textDecoration="underline",f.style.cursor="pointer"})),c},afterOnCellMouseDown:function(a,l,u){if(a.button!==0)return;const c=new Date().getTime(),{row:h,col:d}=l,f=Wt.get(`${h}-${d}`),g=300;let v=!1;if(f&&h===Tc.row&&d===Tc.col&&c-Tc.time<g?(v=!0,Tc={row:-1,col:-1,time:0}):Tc={row:h,col:d,time:c},v){let y=!1;const E=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(E)&&E.length>0&&E[0]==="항목 (Key)"&&d===0&&f&&(y=!0),y){const C=f.originalKey,_=t,I=n.dataPathString;pc({title:`키 이름 변경: "${C}"`,inputValue:C,customClass:{popup:"custom-swal-popup"},confirmButtonText:"저장",inputValidator:P=>{const T=P.trim();return T?/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다!":_.hasOwnProperty(T)&&T!==C?"이미 사용 중인 키입니다!":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:this}).then(P=>{if(P.isConfirmed&&P.value!==void 0){const T=P.value.trim();T!==C&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(I,C,T,_)}});return}}if(f&&f.isDrillable&&f.originalValue!==void 0){const y=typeof t=="object"&&t!==null&&!Array.isArray(t)&&d===0&&f&&f.isDrillable;(!v||v&&!y&&f.drillPath)&&typeof f.originalValue=="object"&&f.originalValue!==null&&n.displayTableCallback(f.originalValue,f.originalKey,n.rootJsonData,f.drillPath)}},afterChange:function(a,l){if(l==="loadData"||!a||!Array.isArray(a)||a.length===0)return;const u=l==="CopyPaste.paste"||l==="Autofill.fill"||a.length>1,c=this.getColHeader();a.forEach(([h,d,f,g])=>{let v=-1;if(typeof d=="number"?v=d:typeof d=="string"&&Array.isArray(c)&&(v=c.indexOf(d)),v===-1)if(typeof d=="number"&&c===!0)v=d;else{console.warn("afterChange: 컬럼 인덱스 결정 불가:",h,d,c);return}const y={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(c)?c:c===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt};let E=Ad(h,v,y);E!==null&&(n.updateJsonDataCallback(E,String(g),u,f),n.convertToTypedValueCallback(String(g),f))}),u&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_update_handsontable_afterChange")},afterCreateRow:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)){const f=c.getColHeader();for(let g=0;g<l;g++){let v=null;Array.isArray(f)&&f.length>0&&(f.length!==2||f[0]!=="Index"||f[1]!=="Value")&&(v={},f.forEach(y=>{typeof y=="string"&&(v[y]=null)})),h.splice(a+g,0,v)}d=!0,d&&n.refreshTreeViewCallback("row_added_array_hot")}else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){(async()=>{let f={...h},g=0;for(let C=0;C<l;C++){const _=a+C,I=await pc({title:`새 항목 키 입력 (${C+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:P=>{const T=P.trim();return T?f.hasOwnProperty(T)?"이미 사용 중인 키입니다.":/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(I.isConfirmed&&I.value!==void 0){const P=I.value.trim(),T=null,A=Object.keys(f),G={};let U=!1;for(let V=0;V<A.length;V++)V===_&&!U&&(G[P]=T,U=!0),G[A[V]]=f[A[V]];U||(G[P]=T),f=G,g++}else break}g>0&&(Object.keys(h).forEach(C=>delete h[C]),Object.assign(h,f),d=!0,n.refreshTreeViewCallback("key_added_object_hot_ordered"));const{preparedHotData:v,preparedColHeaders:y,preparedCellMetaMap:E}=Vr(h,e,n);Wt=E,c.updateSettings({colHeaders:y}),c.loadData(v)})();return}if(d||u!=="loadData"){const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(h,e,n);Wt=v,c.updateSettings({colHeaders:g}),c.loadData(f)}},afterCreateCol:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){(async()=>{for(let y=0;y<l;y++){const E=a+y,C=await pc({title:`새 열(속성)의 키 입력 (${y+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:_=>{const I=_.trim();return I?h[0].hasOwnProperty(I)?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(I)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(C.isConfirmed&&C.value!==void 0){const _=C.value.trim();h.forEach(I=>{if(typeof I=="object"&&I!==null){const P=Object.keys(I),T={};let A=!1;if(E>=P.length)I[_]=null;else{for(let G=0;G<P.length;G++)G===E&&!A&&(T[_]=null,A=!0),T[P[G]]=I[P[G]];A||(T[_]=null),Object.keys(I).forEach(G=>delete I[G]),Object.assign(I,T)}}}),d=!0}else break}d&&n.refreshTreeViewCallback("col_added_array_of_obj_hot_ordered");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(h,e,n);Wt=v,c.updateSettings({colHeaders:g}),c.loadData(f)})();return}else if(typeof h=="object"&&h!==null&&!Array.isArray(h))yt({title:"알림",html:'이 뷰에서는 "열 추가"가 "새 키-값 쌍 추가"(행 추가와 유사)로 동작합니다.<br>행 추가 기능을 사용해주세요.',icon:"info",showCancelButton:!1,hotInstance:c}).then(()=>{const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(h,e,n);Wt=v,c.updateSettings({colHeaders:g}),c.loadData(f)});else{yt({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c});const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(h,e,n);Wt=v,c.updateSettings({colHeaders:g}),c.loadData(f)}},beforeRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;if(u.sort((d,f)=>f-d),Array.isArray(h))u.forEach(d=>{d>=0&&d<h.length&&h.splice(d,1)});else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=Object.keys(h),f=u.map(g=>d[g]).filter(g=>g!==void 0);f.length>0&&f.forEach(g=>{delete h[g]})}else return!1;return!0},afterRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef||c==="ContextMenu.remove_row_custom")return;const h=this;let d=t;n.refreshTreeViewCallback("row_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(d,e,n);Wt=v,h.updateSettings({colHeaders:g}),h.loadData(f)},beforeRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;const d=this.getColHeader();if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){if(!Array.isArray(d))return yt({title:"오류",text:"열 헤더 정보를 가져올 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1;u.sort((f,g)=>g-f),u.forEach(f=>{if(f>=0&&f<d.length){const g=d[f];typeof g=="string"&&h.forEach(v=>{typeof v=="object"&&v!==null&&delete v[g]})}})}else return typeof h=="object"&&h!==null&&!Array.isArray(h)?(yt({title:"알림",text:"이 뷰에서 특정 열 부분 삭제는 지원되지 않습니다. 행 전체를 삭제해주세요.",icon:"info",showCancelButton:!1,hotInstance:this}),!1):(yt({title:"오류",text:"현재 데이터 구조에서는 열을 삭제할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1);return!0},afterRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return;const h=this;let d=t;n.refreshTreeViewCallback("col_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(d,e,n);Wt=v,h.updateSettings({colHeaders:g}),h.loadData(f)}}),gf):(console.error("Handsontable 컨테이너를 찾을 수 없습니다."),null)}function Ad(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a,cellMetaMap:l}=n;let u="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const c=o[e];u=`[${t}].${c}`}else return null;else if(e===1)u=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){const c=l.get(`${t}-0`);if(!c||c.originalKey===void 0)return null;const h=c.originalKey;if(e===0)return null;const d=Array.isArray(o)&&o.length>1&&o[0]==="항목 (Key)"&&!isNaN(parseInt(o[1],10)),f=Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)";if(d)if(e>0&&e<o.length){const g=o[e],v=r[h];if(Array.isArray(v)){const y=l.get(`${t}-${e}`);if(y&&y.isPadding)return null;u=`.${h}[${g}]`}else return null}else return null;else if(f)if(e===1)u=`.${h}`;else return null;else return Object.keys(r).length===0&&Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)",null}else return t===0&&e===1?i||"":null;return i?u.startsWith(".")||u.startsWith("[")?i+u:u?i+"."+u:i:u.startsWith(".")?u.substring(1):u}let Yi=[],Zi=-1;const HRe=30;let L_=!1;function NRe(){Yi=[],Zi=-1,L_=!1}function DRe(t){if(L_)return;const{dataPathString:e,dataKeyName:n}=t,r=Yi[Zi];r&&r.dataPathString===e&&r.dataKeyName===n||(Zi<Yi.length-1&&(Yi=Yi.slice(0,Zi+1)),Yi.push({dataPathString:e,dataKeyName:n}),Zi=Yi.length-1,Yi.length>HRe&&(Yi.shift(),Zi--))}function kRe(t){let e=!1,n=Zi;return t==="back"&&Zi>0?(n--,e=!0):t==="forward"&&Zi<Yi.length-1&&(n++,e=!0),e?(Zi=n,Yi[Zi]):null}function TA(t){L_=t}function $Re(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function LRe(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=$Re(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function MA(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}let Ee=null,ru=null,xs,mf,qn,Lt=null;function FRe(){const t=document.getElementById("loadBtn");t&&t.addEventListener("click",F_);const e=document.getElementById("saveBtn");e&&e.addEventListener("click",zRe);const n=document.getElementById("minifyBtn");n&&n.addEventListener("click",()=>{if(sn&&sn.value)try{sn.value=DV(sn.value)}catch(h){tn&&(tn.textContent="Minify 오류: "+h.message)}else sn&&(sn.value="")});const r=document.getElementById("uglifyBtn");r&&r.addEventListener("click",()=>{if(sn&&sn.value)try{sn.value=kV(sn.value)}catch(h){tn&&(tn.textContent="Uglify(포맷팅) 오류: "+h.message)}else sn&&(sn.value="")});const i=document.getElementById("diffBtn");i&&i.addEventListener("click",()=>{if(!ru&&!Ee){yt({title:"알림",text:"먼저 JSON 데이터를 로드해주세요.",icon:"info",showCancelButton:!1,hotInstance:Lt});return}if(!ru){yt({title:"알림",text:"로드 시점의 원본 JSON 데이터가 없습니다. 변경사항을 비교할 수 없습니다.",icon:"info",showCancelButton:!1,hotInstance:Lt});return}lj({title:"JSON 데이터 변경사항",jsonDiffData:{left:ru,right:Ee===null?{}:Ee},buttons:[{text:"닫기",role:"confirm"}],hotInstance:Lt}).catch(d=>{console.error("showJsonDiffPopup 실행 중 오류:",d),yt({title:"오류",text:"변경점 확인 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})})});const o=document.getElementById("loadFromFileBtn");o&&o.addEventListener("click",jRe);const s=document.getElementById("saveToFileBtn");s&&s.addEventListener("click",URe),xs=document.getElementById("searchInput"),mf=document.getElementById("searchTargetSelect"),qn=document.getElementById("searchResultsDropdown"),xs&&xs.addEventListener("input",PA),mf&&mf.addEventListener("change",PA),document.addEventListener("click",h=>{qn&&xs&&!xs.contains(h.target)&&!qn.contains(h.target)&&(qn.style.display="none")}),qn&&qn.addEventListener("click",h=>h.stopPropagation()),window.addEventListener("mousedown",h=>{(h.button===3||h.button===4)&&(h.preventDefault(),h.button===3?IA("back"):h.button===4&&IA("forward"))}),window.addEventListener("contextmenu",h=>{h.preventDefault()});const a=document.querySelector(".json-control-panel");a?(a.addEventListener("dragover",VRe),a.addEventListener("dragleave",WRe),a.addEventListener("drop",BRe)):console.warn(".json-control-panel 요소를 찾을 수 없어 드래그앤드롭 기능을 활성화할 수 없습니다.");const l=document.querySelector(".main-layout-triple-panel"),u=[document.querySelector(".json-control-panel"),document.querySelector(".tree-view-panel"),document.querySelector(".table-view-panel")],c=[document.getElementById("resizer-1"),document.getElementById("resizer-2")];l&&u.every(h=>h)&&c.every(h=>h)?(_A(l,u,c),window.addEventListener("resize",()=>_A(l,u,c)),c.forEach((h,d)=>{let f=!1,g=0,v=[];h.addEventListener("mousedown",C=>{C.preventDefault(),f=!0,g=C.clientX,v=[u[d].offsetWidth,u[d+1].offsetWidth],document.addEventListener("mousemove",y),document.addEventListener("mouseup",E)});function y(C){if(!f)return;const _=C.clientX-g,I=50;let P=v[0]+_,T=v[1]-_;P<I&&(P=I,T=v[0]+v[1]-P),T<I&&(T=I,P=v[0]+v[1]-T),u[d].style.flexBasis=`${P}px`,u[d+1].style.flexBasis=`${T}px`}function E(){f&&(f=!1,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",E))}})):console.warn("3-패널 레이아웃에 필요한 요소를 모두 찾을 수 없습니다. 리사이저가 동작하지 않을 수 있습니다.")}function VRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.add("dragover-active"),t.dataTransfer.dropEffect="copy"}function WRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active")}function BRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active");const e=t.dataTransfer.files;if(e.length>0){const n=e[0];if(n.type==="application/json"||n.name.toLowerCase().endsWith(".json")){const r=new FileReader;r.onload=i=>{try{const o=i.target.result;sn?(sn.value=o,F_(),eu(Xr,`${n.name} 파일이 드롭되어 로드되었습니다.`,3e3)):(console.error("JSON 입력 필드를 찾을 수 없습니다."),yt({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt}))}catch(o){console.error("파일 읽기 또는 JSON 파싱 오류 (드롭):",o),tn&&(tn.textContent=`파일 오류 (드롭): ${o.message}`),yt({title:"파일 로드 오류 (드롭)",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}},r.onerror=i=>{console.error("파일 읽기 오류 (드롭):",i),tn&&(tn.textContent="파일을 읽는 중 오류가 발생했습니다 (드롭)."),yt({title:"파일 읽기 오류 (드롭)",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})},r.readAsText(n)}else yt({title:"잘못된 파일 타입",text:"JSON 파일(.json)만 드롭해주세요.",icon:"warning",showCancelButton:!1,hotInstance:Lt})}}function _A(t,e,n){const r=t.offsetWidth,i=n.reduce((l,u)=>l+u.offsetWidth,0),o=r-i,s=[.1,.15,.75],a=50;if(o>0){let l=Math.max(a,Math.floor(o*s[0])),u=Math.max(a,Math.floor(o*s[1])),c=Math.max(a,o-l-u);l+u+c>o&&(c=o-l-u),e[0].style.flexBasis=`${l}px`,e[1].style.flexBasis=`${u}px`,e[2].style.flexBasis=`${c}px`}}function PA(){if(!xs||!mf||!qn)return;const t=xs.value.trim().toLowerCase(),e=mf.value;if(!t){qn.innerHTML="",qn.style.display="none";return}if(Ee==null){MA([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],qn,t,xA);return}const n=LRe(t,e,Ee);MA(n,qn,t,xA)}function xA(t){t&&typeof Ya=="function"&&(Ya(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString||""),qn&&(qn.style.display="none"))}function jRe(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",t.addEventListener("change",e=>{const n=e.target.files[0];if(!n)return;const r=new FileReader;r.onload=i=>{try{const o=i.target.result;sn?(sn.value=o,F_(),eu(Xr,`${n.name} 파일이 로드되었습니다.`,3e3)):(console.error("JSON 입력 필드를 찾을 수 없습니다."),yt({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt}))}catch(o){console.error("파일 읽기 또는 JSON 파싱 오류:",o),tn&&(tn.textContent=`파일 오류: ${o.message}`),yt({title:"파일 로드 오류",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}},r.onerror=i=>{console.error("파일 읽기 오류:",i),tn&&(tn.textContent="파일을 읽는 중 오류가 발생했습니다."),yt({title:"파일 읽기 오류",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})},r.readAsText(n),document.body.removeChild(t)}),document.body.appendChild(t),t.click()}async function URe(){if(Ee==null){eu(Xr,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await pc({title:"파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:Lt});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".json")||(e+=".json");const n=JSON.stringify(Ee,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),eu(Xr,`${e} 파일이 성공적으로 저장되었습니다!`,3e3)}else eu(Xr,"파일 저장이 취소되었습니다.",3e3)}catch(t){console.error("JSON 파일 저장 오류:",t),tn&&(tn.textContent="JSON 파일 저장 오류: "+t.message),yt({title:"파일 저장 오류",text:`JSON 데이터를 파일로 저장하는 중 오류가 발생했습니다: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}}function F_(){YRe(),NRe();try{const t=sn.value.trim();if(!t){Ee=null,ru=null,Dc(null,pf),Jp();return}Ee=JSON.parse(t),ru=JSON.parse(JSON.stringify(Ee));const e=_V();if(At&&(At.innerHTML=""),typeof Ee=="object"&&Ee!==null)vf(Ee,At,"",Ee,0,e);else{const r={["value"]:Ee};vf(r,At,"",r,0,e)}Jp(),Dc(null,pf)}catch(t){tn&&(tn.textContent="JSON 파싱 오류: "+t.message),Ee=null,ru=null,At&&(At.innerHTML=""),Jp(),Dc(null,pf)}}function zRe(){if(tn&&(tn.textContent=""),Ee!=null)try{const t=JSON.stringify(Ee,null,2);sn&&(sn.value=t),Xr&&eu(Xr,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){tn&&(tn.textContent="JSON 문자열 변환 오류: "+t.message),Xr&&(Xr.textContent="")}else sn&&(sn.value=""),Xr&&eu(Xr,"저장할 JSON 데이터가 없습니다.",3e3)}function YRe(){cj(),Jp(),Ee=null,ru=null,Kc(null),qn&&(qn.innerHTML="",qn.style.display="none"),xs&&(xs.value=""),At&&(At.innerHTML=""),Dc(null,pf)}function Jp(){Lt=MV()}function GRe(t,e,n=!1){if(Ee==null){console.error("데이터 업데이트 오류: currentJsonData가 없습니다.");return}const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Ee:s=ou(Ee,o),o===""&&t===i&&(typeof Ee!="object"||Ee===null)){if(Ee=kS(e,Ee),n)return;cv(t),Ya(Ee,"value",Ee,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){console.error("데이터 업데이트 오류: 부모 객체를 찾을 수 없거나 객체/배열이 아님.",{pathString:t,parentPath:o,parentObject:s}),yt({title:"오류",text:"데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).",icon:"error",showCancelButton:!1,hotInstance:Lt});return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){console.error("데이터 업데이트 오류: 배열 인덱스 범위 초과.",{targetKeyOrIndex:a,arrayLength:s.length}),yt({title:"오류",text:"배열 인덱스 범위를 벗어났습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt});return}let l=!0;const u=s[a],c=kS(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&At){const f=At.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(WH(g,c),l=!1)}}!n&&l&&cv(t)}}function KRe(t,e,n,r){let i;if(r&&(t===""||ou(Ee,t)===r)?i=r:i=t===""?Ee:ou(Ee,t),typeof i!="object"||i===null||Array.isArray(i)){yt({title:"오류",text:"키를 업데이트할 부모 객체를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt});return}if(!i.hasOwnProperty(e)){yt({title:"오류",text:`기존 키 "${e}"를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt});return}if(n===e){yt({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다.",showCancelButton:!1,hotInstance:Lt});return}if(i.hasOwnProperty(n)){yt({title:"오류",text:`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt});return}const o={},s=i[e];for(const a in i)i.hasOwnProperty(a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)i.hasOwnProperty(a)&&delete i[a];for(const a in o)o.hasOwnProperty(a)&&(i[a]=o[a]);yt({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`,showCancelButton:!1,hotInstance:Lt}),cv(`key_renamed_in_parent:${t}`),Ya(i,n,Ee,t)}function cv(t="N/A"){if(At&&Ee!=null){const e=fj(),n=gj(At);At.innerHTML="";const r=_V();if(typeof Ee=="object"&&Ee!==null)vf(Ee,At,"",Ee,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Ee};vf(o,At,"",o,0,r)}if(mj(At,n),e){const i=At.querySelector(`.tree-node[data-path="${e}"]`);i&&Kc(i)}}else At&&(At.innerHTML="")}function _V(){return{displayTableCallback:Ya,getObjectByPathCallback:ou,rootJsonData:Ee}}function pf(t){const e=ou(Ee,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}Ya(e,n,Ee,t,{syncTreeView:!0})}else console.warn(`Data not found for path: ${t}`),yt({title:"오류",text:`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt})}function Ya(t,e,n,r,i={syncTreeView:!0}){if(DRe({dataPathString:r,dataKeyName:e}),Dc(r,pf),Lt=ARe(t,e,{tableViewDomElement:VH,updateJsonDataCallback:GRe,updateJsonKeyCallback:KRe,refreshTreeViewCallback:cv,getObjectByPathCallback:ou,convertToTypedValueCallback:kS,rootJsonData:n,currentJsonDataRef:()=>Ee,dataPathString:r,displayTableCallback:Ya}),i.syncTreeView&&At&&r!==void 0&&r!==null){const s=At.querySelector(`.tree-node[data-path="${r}"]`);s?(Kc(s),setTimeout(()=>{const a=At.querySelector(`.tree-node[data-path="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},50)):r===""?(Kc(null),At.firstChild&&(At.scrollTop=0)):console.warn(`Tree node for path "${r}" not found for synchronization.`)}}function IA(t){const e=kRe(t);if(e){TA(!0);try{const n=ou(Ee,e.dataPathString);Ya(n,e.dataKeyName,Ee,e.dataPathString,{syncTreeView:!1})}catch(n){console.error("Error navigating history:",n),yt({title:"오류",text:"히스토리 복원 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})}finally{TA(!1)}}}document.addEventListener("DOMContentLoaded",FRe)});export default qRe();
