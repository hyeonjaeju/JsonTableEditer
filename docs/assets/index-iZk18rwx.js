var YV=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var d0e=YV((_0e,nw)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function GV(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function KV(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function BA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function qV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lP(t,e){return t.get(BA(t,e))}function XV(t,e,n){qV(t,e),e.set(t,n)}function JV(t,e,n){return t.set(BA(t,e),n),n}const ZV=100,Se={},QV=()=>{Se.previousActiveElement instanceof HTMLElement?(Se.previousActiveElement.focus(),Se.previousActiveElement=null):document.body&&document.body.focus()},eB=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Se.restoreFocusTimeout=setTimeout(()=>{QV(),e()},ZV),window.scrollTo(n,r)}),WA="swal2-",tB=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],z=tB.reduce((t,e)=>(t[e]=WA+e,t),{}),nB=["success","warning","info","question","error"],rw=nB.reduce((t,e)=>(t[e]=WA+e,t),{}),jA="SweetAlert2:",v0=t=>t.charAt(0).toUpperCase()+t.slice(1),cr=t=>{console.warn(`${jA} ${typeof t=="object"?t.join(" "):t}`)},vu=t=>{console.error(`${jA} ${t}`)},uP=[],rB=t=>{uP.includes(t)||(uP.push(t),cr(t))},UA=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;rB(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},wv=t=>typeof t=="function"?t():t,y0=t=>t&&typeof t.toPromise=="function",Kf=t=>y0(t)?t.toPromise():Promise.resolve(t),C0=t=>t&&Promise.resolve(t)===t,fr=()=>document.body.querySelector(`.${z.container}`),qf=t=>{const e=fr();return e?e.querySelector(t):null},Zr=t=>qf(`.${t}`),rt=()=>Zr(z.popup),oh=()=>Zr(z.icon),iB=()=>Zr(z["icon-content"]),zA=()=>Zr(z.title),b0=()=>Zr(z["html-container"]),YA=()=>Zr(z.image),S0=()=>Zr(z["progress-steps"]),vv=()=>Zr(z["validation-message"]),Go=()=>qf(`.${z.actions} .${z.confirm}`),sh=()=>qf(`.${z.actions} .${z.cancel}`),yu=()=>qf(`.${z.actions} .${z.deny}`),oB=()=>Zr(z["input-label"]),ah=()=>qf(`.${z.loader}`),Xf=()=>Zr(z.actions),GA=()=>Zr(z.footer),yv=()=>Zr(z["timer-progress-bar"]),R0=()=>Zr(z.close),sB=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,E0=()=>{const t=rt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(sB),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>Nr(o))},T0=()=>Ls(document.body,z.shown)&&!Ls(document.body,z["toast-shown"])&&!Ls(document.body,z["no-backdrop"]),Cv=()=>{const t=rt();return t?Ls(t,z.toast):!1},aB=()=>{const t=rt();return t?t.hasAttribute("data-loading"):!1},Qr=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},Ls=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},lB=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(z).includes(n)&&!Object.values(rw).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Jr=(t,e,n)=>{if(lB(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){cr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}ct(t,r)}},bv=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${z.popup} > .${z[e]}`);case"checkbox":return t.querySelector(`.${z.popup} > .${z.checkbox} input`);case"radio":return t.querySelector(`.${z.popup} > .${z.radio} input:checked`)||t.querySelector(`.${z.popup} > .${z.radio} input:first-child`);case"range":return t.querySelector(`.${z.popup} > .${z.range} input`);default:return t.querySelector(`.${z.popup} > .${z.input}`)}},KA=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},qA=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},ct=(t,e)=>{qA(t,e,!0)},Si=(t,e)=>{qA(t,e,!1)},Ma=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&Ls(i,e))return i}},tu=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},Hn=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},Jn=t=>{t&&(t.style.display="none")},M0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{Jf(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},cP=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},Jf=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?Hn(t,n):Jn(t)},Nr=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),uB=()=>!Nr(Go())&&!Nr(yu())&&!Nr(sh()),hP=t=>t.scrollHeight>t.clientHeight,XA=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},_0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=yv();n&&Nr(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},cB=()=>{const t=yv();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},hB=()=>typeof window>"u"||typeof document>"u",dB=`
 <div aria-labelledby="${z.title}" aria-describedby="${z["html-container"]}" class="${z.popup}" tabindex="-1">
   <button type="button" class="${z.close}"></button>
   <ul class="${z["progress-steps"]}"></ul>
   <div class="${z.icon}"></div>
   <img class="${z.image}" />
   <h2 class="${z.title}" id="${z.title}"></h2>
   <div class="${z["html-container"]}" id="${z["html-container"]}"></div>
   <input class="${z.input}" id="${z.input}" />
   <input type="file" class="${z.file}" />
   <div class="${z.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${z.select}" id="${z.select}"></select>
   <div class="${z.radio}"></div>
   <label class="${z.checkbox}">
     <input type="checkbox" id="${z.checkbox}" />
     <span class="${z.label}"></span>
   </label>
   <textarea class="${z.textarea}" id="${z.textarea}"></textarea>
   <div class="${z["validation-message"]}" id="${z["validation-message"]}"></div>
   <div class="${z.actions}">
     <div class="${z.loader}"></div>
     <button type="button" class="${z.confirm}"></button>
     <button type="button" class="${z.deny}"></button>
     <button type="button" class="${z.cancel}"></button>
   </div>
   <div class="${z.footer}"></div>
   <div class="${z["timer-progress-bar-container"]}">
     <div class="${z["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),fB=()=>{const t=fr();return t?(t.remove(),Si([document.documentElement,document.body],[z["no-backdrop"],z["toast-shown"],z["has-column"]]),!0):!1},Qa=()=>{Se.currentInstance.resetValidationMessage()},gB=()=>{const t=rt(),e=Ma(t,z.input),n=Ma(t,z.file),r=t.querySelector(`.${z.range} input`),i=t.querySelector(`.${z.range} output`),o=Ma(t,z.select),s=t.querySelector(`.${z.checkbox} input`),a=Ma(t,z.textarea);e.oninput=Qa,n.onchange=Qa,o.onchange=Qa,s.onchange=Qa,a.oninput=Qa,r.oninput=()=>{Qa(),i.value=r.value},r.onchange=()=>{Qa(),i.value=r.value}},mB=t=>typeof t=="string"?document.querySelector(t):t,pB=t=>{const e=rt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},wB=t=>{window.getComputedStyle(t).direction==="rtl"&&ct(fr(),z.rtl)},vB=t=>{const e=fB();if(hB()){vu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=z.container,e&&ct(n,z["no-transition"]),Qr(n,dB),n.dataset.swal2Theme=t.theme;const r=mB(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),pB(t),wB(r),gB()},P0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?yB(t,e):t&&Qr(e,t)},yB=(t,e)=>{t.jquery?CB(e,t):Qr(e,t.toString())},CB=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},bB=(t,e)=>{const n=Xf(),r=ah();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?Jn(n):Hn(n),Jr(n,e,"actions"),SB(n,r,e),Qr(r,e.loaderHtml||""),Jr(r,e,"loader"))};function SB(t,e,n){const r=Go(),i=yu(),o=sh();!r||!i||!o||(Py(r,"confirm",n),Py(i,"deny",n),Py(o,"cancel",n),RB(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function RB(t,e,n,r){if(!r.buttonsStyling){Si([t,e,n],z.styled);return}ct([t,e,n],z.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),_y(t),_y(e),_y(n)}function _y(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function Py(t,e,n){const r=v0(e);Jf(t,n[`show${r}Button`],"inline-block"),Qr(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=z[e],Jr(t,n,`${e}Button`)}const EB=(t,e)=>{const n=R0();n&&(Qr(n,e.closeButtonHtml||""),Jr(n,e,"closeButton"),Jf(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},TB=(t,e)=>{const n=fr();n&&(MB(n,e.backdrop),_B(n,e.position),PB(n,e.grow),Jr(n,e,"container"))};function MB(t,e){typeof e=="string"?t.style.background=e:e||ct([document.documentElement,document.body],z["no-backdrop"])}function _B(t,e){e&&(e in z?ct(t,z[e]):(cr('The "position" parameter is not valid, defaulting to "center"'),ct(t,z.center)))}function PB(t,e){e&&ct(t,z[`grow-${e}`])}var Mt={innerParams:new WeakMap,domCache:new WeakMap};const xB=["input","file","range","select","radio","checkbox","textarea"],IB=(t,e)=>{const n=rt();if(!n)return;const r=Mt.innerParams.get(t),i=!r||e.input!==r.input;xB.forEach(o=>{const s=Ma(n,z[o]);s&&(HB(o,e.inputAttributes),s.className=z[o],i&&Jn(s))}),e.input&&(i&&OB(e),NB(e))},OB=t=>{if(!t.input)return;if(!on[t.input]){vu(`Unexpected type of input! Expected ${Object.keys(on).join(" | ")}, got "${t.input}"`);return}const e=JA(t.input);if(!e)return;const n=on[t.input](e,t);Hn(e),t.inputAutoFocus&&setTimeout(()=>{KA(n)})},AB=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},HB=(t,e)=>{const n=rt();if(!n)return;const r=bv(n,t);if(r){AB(r);for(const i in e)r.setAttribute(i,e[i])}},NB=t=>{if(!t.input)return;const e=JA(t.input);e&&Jr(e,t,"input")},x0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},Zf=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=z["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&ct(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},JA=t=>{const e=rt();if(e)return Ma(e,z[t]||z.input)},iw=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:C0(e)||cr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},on={};on.text=on.email=on.password=on.number=on.tel=on.url=on.search=on.date=on["datetime-local"]=on.time=on.week=on.month=(t,e)=>(iw(t,e.inputValue),Zf(t,t,e),x0(t,e),t.type=e.input,t);on.file=(t,e)=>(Zf(t,t,e),x0(t,e),t);on.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return iw(n,e.inputValue),n.type=e.input,iw(r,e.inputValue),Zf(n,t,e),t};on.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");Qr(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return Zf(t,t,e),t};on.radio=t=>(t.textContent="",t);on.checkbox=(t,e)=>{const n=bv(rt(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return Qr(r,e.inputPlaceholder||e.inputLabel),n};on.textarea=(t,e)=>{iw(t,e.inputValue),x0(t,e),Zf(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(rt()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?rt().style.width=`${o}px`:tu(rt(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const DB=(t,e)=>{const n=b0();n&&(M0(n),Jr(n,e,"htmlContainer"),e.html?(P0(e.html,n),Hn(n,"block")):e.text?(n.textContent=e.text,Hn(n,"block")):Jn(n),IB(t,e))},kB=(t,e)=>{const n=GA();n&&(M0(n),Jf(n,e.footer,"block"),e.footer&&P0(e.footer,n),Jr(n,e,"footer"))},$B=(t,e)=>{const n=Mt.innerParams.get(t),r=oh();if(!r)return;if(n&&e.icon===n.icon){fP(r,e),dP(r,e);return}if(!e.icon&&!e.iconHtml){Jn(r);return}if(e.icon&&Object.keys(rw).indexOf(e.icon)===-1){vu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),Jn(r);return}Hn(r),fP(r,e),dP(r,e),ct(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",ZA)},dP=(t,e)=>{for(const[n,r]of Object.entries(rw))e.icon!==n&&Si(t,r);ct(t,e.icon&&rw[e.icon]),VB(t,e),ZA(),Jr(t,e,"icon")},ZA=()=>{const t=rt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},LB=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,FB=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,fP=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=gP(e.iconHtml):e.icon==="success"?(r=LB,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=FB:e.icon&&(r=gP({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&Qr(t,r)},VB=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])cP(t,n,"background-color",e.iconColor);cP(t,".swal2-success-ring","border-color",e.iconColor)}},gP=t=>`<div class="${z["icon-content"]}">${t}</div>`,BB=(t,e)=>{const n=YA();if(n){if(!e.imageUrl){Jn(n);return}Hn(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),tu(n,"width",e.imageWidth),tu(n,"height",e.imageHeight),n.className=z.image,Jr(n,e,"image")}};let I0=!1,QA=0,eH=0,tH=0,nH=0;const WB=t=>{t.addEventListener("mousedown",ow),document.body.addEventListener("mousemove",sw),t.addEventListener("mouseup",aw),t.addEventListener("touchstart",ow),document.body.addEventListener("touchmove",sw),t.addEventListener("touchend",aw)},jB=t=>{t.removeEventListener("mousedown",ow),document.body.removeEventListener("mousemove",sw),t.removeEventListener("mouseup",aw),t.removeEventListener("touchstart",ow),document.body.removeEventListener("touchmove",sw),t.removeEventListener("touchend",aw)},ow=t=>{const e=rt();if(t.target===e||oh().contains(t.target)){I0=!0;const n=rH(t);QA=n.clientX,eH=n.clientY,tH=parseInt(e.style.insetInlineStart)||0,nH=parseInt(e.style.insetBlockStart)||0,ct(e,"swal2-dragging")}},sw=t=>{const e=rt();if(I0){let{clientX:n,clientY:r}=rH(t);e.style.insetInlineStart=`${tH+(n-QA)}px`,e.style.insetBlockStart=`${nH+(r-eH)}px`}},aw=()=>{const t=rt();I0=!1,Si(t,"swal2-dragging")},rH=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},UB=(t,e)=>{const n=fr(),r=rt();if(!(!n||!r)){if(e.toast){tu(n,"width",e.width),r.style.width="100%";const i=ah();i&&r.insertBefore(i,oh())}else tu(r,"width",e.width);tu(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),Jn(vv()),zB(r,e),e.draggable&&!e.toast?(ct(r,z.draggable),WB(r)):(Si(r,z.draggable),jB(r))}},zB=(t,e)=>{const n=e.showClass||{};t.className=`${z.popup} ${Nr(t)?n.popup:""}`,e.toast?(ct([document.documentElement,document.body],z["toast-shown"]),ct(t,z.toast)):ct(t,z.modal),Jr(t,e,"popup"),typeof e.customClass=="string"&&ct(t,e.customClass),e.icon&&ct(t,z[`icon-${e.icon}`])},YB=(t,e)=>{const n=S0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){Jn(n);return}Hn(n),n.textContent="",i>=r.length&&cr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=GB(o);if(n.appendChild(a),s===i&&ct(a,z["active-progress-step"]),s!==r.length-1){const l=KB(e);n.appendChild(l)}})},GB=t=>{const e=document.createElement("li");return ct(e,z["progress-step"]),Qr(e,t),e},KB=t=>{const e=document.createElement("li");return ct(e,z["progress-step-line"]),t.progressStepsDistance&&tu(e,"width",t.progressStepsDistance),e},qB=(t,e)=>{const n=zA();n&&(M0(n),Jf(n,e.title||e.titleText,"block"),e.title&&P0(e.title,n),e.titleText&&(n.innerText=e.titleText),Jr(n,e,"title"))},iH=(t,e)=>{UB(t,e),TB(t,e),YB(t,e),$B(t,e),BB(t,e),qB(t,e),EB(t,e),DB(t,e),bB(t,e),kB(t,e);const n=rt();typeof e.didRender=="function"&&n&&e.didRender(n),Se.eventEmitter.emit("didRender",n)},XB=()=>Nr(rt()),oH=()=>{var t;return(t=Go())===null||t===void 0?void 0:t.click()},JB=()=>{var t;return(t=yu())===null||t===void 0?void 0:t.click()},ZB=()=>{var t;return(t=sh())===null||t===void 0?void 0:t.click()},lh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),sH=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},QB=(t,e,n)=>{sH(t),e.toast||(t.keydownHandler=r=>tW(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:rt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},LS=(t,e)=>{var n;const r=E0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=rt())===null||n===void 0||n.focus()},aH=["ArrowRight","ArrowDown"],eW=["ArrowLeft","ArrowUp"],tW=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?nW(e,t):e.key==="Tab"?rW(e):[...aH,...eW].includes(e.key)?iW(e.key):e.key==="Escape"&&oW(e,t,n)))},nW=(t,e)=>{if(!wv(e.allowEnterKey))return;const n=bv(rt(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;oH(),t.preventDefault()}},rW=t=>{const e=t.target,n=E0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?LS(r,-1):LS(r,1),t.stopPropagation(),t.preventDefault()},iW=t=>{const e=Xf(),n=Go(),r=yu(),i=sh();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=aH.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Nr(a))break}a instanceof HTMLButtonElement&&a.focus()}},oW=(t,e,n)=>{wv(e.allowEscapeKey)&&(t.preventDefault(),n(lh.esc))};var Kc={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const sW=()=>{const t=fr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},lH=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},uH=typeof window<"u"&&!!window.GestureEvent,aW=()=>{if(uH&&!Ls(document.body,z.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,ct(document.body,z.iosfix),lW()}},lW=()=>{const t=fr();if(!t)return;let e;t.ontouchstart=n=>{e=uW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},uW=t=>{const e=t.target,n=fr(),r=b0();return!n||!r||cW(t)||hW(t)?!1:e===n||!hP(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(hP(r)&&r.contains(e))},cW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",hW=t=>t.touches&&t.touches.length>1,dW=()=>{if(Ls(document.body,z.iosfix)){const t=parseInt(document.body.style.top,10);Si(document.body,z.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},fW=()=>{const t=document.createElement("div");t.className=z["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let kc=null;const gW=t=>{kc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(kc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${kc+fW()}px`)},mW=()=>{kc!==null&&(document.body.style.paddingRight=`${kc}px`,kc=null)};function cH(t,e,n,r){Cv()?mP(t,r):(eB(n).then(()=>mP(t,r)),sH(Se)),uH?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),T0()&&(mW(),dW(),lH()),pW()}function pW(){Si([document.documentElement,document.body],[z.shown,z["height-auto"],z["no-backdrop"],z["toast-shown"]])}function _a(t){t=vW(t);const e=Kc.swalPromiseResolve.get(this),n=wW(this);this.isAwaitingPromise?t.isDismissed||(Qf(this),e(t)):n&&e(t)}const wW=t=>{const e=rt();if(!e)return!1;const n=Mt.innerParams.get(t);if(!n||Ls(e,n.hideClass.popup))return!1;Si(e,n.showClass.popup),ct(e,n.hideClass.popup);const r=fr();return Si(r,n.showClass.backdrop),ct(r,n.hideClass.backdrop),yW(t,e,n),!0};function hH(t){const e=Kc.swalPromiseReject.get(this);Qf(this),e&&e(t)}const Qf=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Mt.innerParams.get(t)||t._destroy())},vW=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),yW=(t,e,n)=>{var r;const i=fr(),o=XA(e);typeof n.willClose=="function"&&n.willClose(e),(r=Se.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?CW(t,e,i,n.returnFocus,n.didClose):cH(t,i,n.returnFocus,n.didClose)},CW=(t,e,n,r,i)=>{Se.swalCloseEventFinishedCallback=cH.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Se.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Se),delete Se.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},mP=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Se.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},qc=t=>{let e=rt();if(e||new yi,e=rt(),!e)return;const n=ah();Cv()?Jn(oh()):bW(e,t),Hn(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},bW=(t,e)=>{const n=Xf(),r=ah();!n||!r||(!e&&Nr(Go())&&(e=Go()),Hn(n),e&&(Jn(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),ct([t,n],z.loading))},SW=(t,e)=>{e.input==="select"||e.input==="radio"?_W(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(y0(e.inputValue)||C0(e.inputValue))&&(qc(Go()),PW(t,e))},RW=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return EW(n);case"radio":return TW(n);case"file":return MW(n);default:return e.inputAutoTrim?n.value.trim():n.value}},EW=t=>t.checked?1:0,TW=t=>t.checked?t.value:null,MW=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,_W=(t,e)=>{const n=rt();if(!n)return;const r=i=>{e.input==="select"?xW(n,lw(i),e):e.input==="radio"&&IW(n,lw(i),e)};y0(e.inputOptions)||C0(e.inputOptions)?(qc(Go()),Kf(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):vu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},PW=(t,e)=>{const n=t.getInput();n&&(Jn(n),Kf(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,Hn(n),n.focus(),t.hideLoading()}).catch(r=>{vu(`Error in inputValue promise: ${r}`),n.value="",Hn(n),n.focus(),t.hideLoading()}))};function xW(t,e,n){const r=Ma(t,z.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,Qr(l,s),l.selected=dH(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function IW(t,e,n){const r=Ma(t,z.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=z.radio,l.value=s,dH(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");Qr(c,a),c.className=z.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const lw=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=lw(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=lw(r)),e.push([n,r])}),e},dH=(t,e)=>!!e&&e.toString()===t.toString(),OW=t=>{const e=Mt.innerParams.get(t);t.disableButtons(),e.input?fH(t,"confirm"):A0(t,!0)},AW=t=>{const e=Mt.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?fH(t,"deny"):O0(t,!1)},HW=(t,e)=>{t.disableButtons(),e(lh.cancel)},fH=(t,e)=>{const n=Mt.innerParams.get(t);if(!n.input){vu(`The "input" parameter is needed to be set when using returnInputValueOn${v0(e)}`);return}const r=t.getInput(),i=RW(t,n);n.inputValidator?NW(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?O0(t,i):A0(t,i)},NW=(t,e,n)=>{const r=Mt.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Kf(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?O0(t,e):A0(t,e)})},O0=(t,e)=>{const n=Mt.innerParams.get(t||void 0);n.showLoaderOnDeny&&qc(yu()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Kf(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),Qf(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>gH(t||void 0,i))):t.close({isDenied:!0,value:e})},pP=(t,e)=>{t.close({isConfirmed:!0,value:e})},gH=(t,e)=>{t.rejectPromise(e)},A0=(t,e)=>{const n=Mt.innerParams.get(t||void 0);n.showLoaderOnConfirm&&qc(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Kf(n.preConfirm(e,n.validationMessage))).then(i=>{Nr(vv())||i===!1?(t.hideLoading(),Qf(t)):pP(t,typeof i>"u"?e:i)}).catch(i=>gH(t||void 0,i))):pP(t,e)};function uw(){const t=Mt.innerParams.get(this);if(!t)return;const e=Mt.domCache.get(this);Jn(e.loader),Cv()?t.icon&&Hn(oh()):DW(e),Si([e.popup,e.actions],z.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const DW=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?Hn(e[0],"inline-block"):uB()&&Jn(t.actions)};function mH(){const t=Mt.innerParams.get(this),e=Mt.domCache.get(this);return e?bv(e.popup,t.input):null}function pH(t,e,n){const r=Mt.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function wH(t,e){const n=rt();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${z.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function vH(){pH(this,["confirmButton","denyButton","cancelButton"],!1)}function yH(){pH(this,["confirmButton","denyButton","cancelButton"],!0)}function CH(){wH(this.getInput(),!1)}function bH(){wH(this.getInput(),!0)}function SH(t){const e=Mt.domCache.get(this),n=Mt.innerParams.get(this);Qr(e.validationMessage,t),e.validationMessage.className=z["validation-message"],n.customClass&&n.customClass.validationMessage&&ct(e.validationMessage,n.customClass.validationMessage),Hn(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",z["validation-message"]),KA(r),ct(r,z.inputerror))}function RH(){const t=Mt.domCache.get(this);t.validationMessage&&Jn(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Si(e,z.inputerror))}const $c={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},kW=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],$W={allowEnterKey:void 0},LW=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],EH=t=>Object.prototype.hasOwnProperty.call($c,t),TH=t=>kW.indexOf(t)!==-1,MH=t=>$W[t],FW=t=>{EH(t)||cr(`Unknown parameter "${t}"`)},VW=t=>{LW.includes(t)&&cr(`The parameter "${t}" is incompatible with toasts`)},BW=t=>{const e=MH(t);e&&UA(t,e)},_H=t=>{t.backdrop===!1&&t.allowOutsideClick&&cr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&cr(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)FW(e),t.toast&&VW(e),BW(e)};function PH(t){const e=fr(),n=rt(),r=Mt.innerParams.get(this);if(!n||Ls(n,r.hideClass.popup)){cr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=WW(t),o=Object.assign({},r,i);_H(o),e.dataset.swal2Theme=o.theme,iH(this,o),Mt.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const WW=t=>{const e={};return Object.keys(t).forEach(n=>{TH(n)?e[n]=t[n]:cr(`Invalid parameter to update: ${n}`)}),e};function xH(){const t=Mt.domCache.get(this),e=Mt.innerParams.get(this);if(!e){IH(this);return}t.popup&&Se.swalCloseEventFinishedCallback&&(Se.swalCloseEventFinishedCallback(),delete Se.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Se.eventEmitter.emit("didDestroy"),jW(this)}const jW=t=>{IH(t),delete t.params,delete Se.keydownHandler,delete Se.keydownTarget,delete Se.currentInstance},IH=t=>{t.isAwaitingPromise?(xy(Mt,t),t.isAwaitingPromise=!0):(xy(Kc,t),xy(Mt,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},xy=(t,e)=>{for(const n in t)t[n].delete(e)};var UW=Object.freeze({__proto__:null,_destroy:xH,close:_a,closeModal:_a,closePopup:_a,closeToast:_a,disableButtons:yH,disableInput:bH,disableLoading:uw,enableButtons:vH,enableInput:CH,getInput:mH,handleAwaitingPromise:Qf,hideLoading:uw,rejectPromise:hH,resetValidationMessage:RH,showValidationMessage:SH,update:PH});const zW=(t,e,n)=>{t.toast?YW(t,e,n):(KW(e),qW(e),XW(t,e,n))},YW=(t,e,n)=>{e.popup.onclick=()=>{t&&(GW(t)||t.timer||t.input)||n(lh.close)}},GW=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let cw=!1;const KW=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(cw=!0)}}},qW=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(cw=!0)}}},XW=(t,e,n)=>{e.container.onclick=r=>{if(cw){cw=!1;return}r.target===e.container&&wv(t.allowOutsideClick)&&n(lh.backdrop)}},JW=t=>typeof t=="object"&&t.jquery,wP=t=>t instanceof Element||JW(t),ZW=t=>{const e={};return typeof t[0]=="object"&&!wP(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||wP(i)?e[n]=i:i!==void 0&&vu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function QW(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function e2(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const t2=()=>Se.timeout&&Se.timeout.getTimerLeft(),OH=()=>{if(Se.timeout)return cB(),Se.timeout.stop()},AH=()=>{if(Se.timeout){const t=Se.timeout.start();return _0(t),t}},n2=()=>{const t=Se.timeout;return t&&(t.running?OH():AH())},r2=t=>{if(Se.timeout){const e=Se.timeout.increase(t);return _0(e,!0),e}},i2=()=>!!(Se.timeout&&Se.timeout.isRunning());let vP=!1;const FS={};function o2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";FS[t]=this,vP||(document.body.addEventListener("click",s2),vP=!0)}const s2=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in FS){const r=e.getAttribute(n);if(r){FS[n].fire({template:r});return}}};class a2{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Se.eventEmitter=new a2;const l2=(t,e)=>{Se.eventEmitter.on(t,e)},u2=(t,e)=>{Se.eventEmitter.once(t,e)},c2=(t,e)=>{if(!t){Se.eventEmitter.reset();return}e?Se.eventEmitter.removeListener(t,e):Se.eventEmitter.removeAllListeners(t)};var h2=Object.freeze({__proto__:null,argsToParams:ZW,bindClickHandler:o2,clickCancel:ZB,clickConfirm:oH,clickDeny:JB,enableLoading:qc,fire:QW,getActions:Xf,getCancelButton:sh,getCloseButton:R0,getConfirmButton:Go,getContainer:fr,getDenyButton:yu,getFocusableElements:E0,getFooter:GA,getHtmlContainer:b0,getIcon:oh,getIconContent:iB,getImage:YA,getInputLabel:oB,getLoader:ah,getPopup:rt,getProgressSteps:S0,getTimerLeft:t2,getTimerProgressBar:yv,getTitle:zA,getValidationMessage:vv,increaseTimer:r2,isDeprecatedParameter:MH,isLoading:aB,isTimerRunning:i2,isUpdatableParameter:TH,isValidParameter:EH,isVisible:XB,mixin:e2,off:c2,on:l2,once:u2,resumeTimer:AH,showLoading:qc,stopTimer:OH,toggleTimer:n2});class d2{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const HH=["swal-title","swal-html","swal-footer"],f2=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return b2(n),Object.assign(g2(n),m2(n),p2(n),w2(n),v2(n),y2(n),C2(n,HH))},g2=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{au(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof $c[i]=="boolean"?e[i]=o!=="false":typeof $c[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},m2=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},p2=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{au(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${v0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},w2=t=>{const e={},n=t.querySelector("swal-image");return n&&(au(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},v2=t=>{const e={},n=t.querySelector("swal-icon");return n&&(au(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},y2=t=>{const e={},n=t.querySelector("swal-input");n&&(au(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{au(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},C2=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(au(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},b2=t=>{const e=HH.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||cr(`Unrecognized element <${r}>`)})},au=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&cr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},NH=10,S2=t=>{const e=fr(),n=rt();typeof t.willOpen=="function"&&t.willOpen(n),Se.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;T2(e,n,t),setTimeout(()=>{R2(e,n)},NH),T0()&&(E2(e,t.scrollbarPadding,i),sW()),!Cv()&&!Se.previousActiveElement&&(Se.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Se.eventEmitter.emit("didOpen",n),Si(e,z["no-transition"])},hw=t=>{const e=rt();if(t.target!==e)return;const n=fr();e.removeEventListener("animationend",hw),e.removeEventListener("transitionend",hw),n.style.overflowY="auto"},R2=(t,e)=>{XA(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",hw),e.addEventListener("transitionend",hw)):t.style.overflowY="auto"},E2=(t,e,n)=>{aW(),e&&n!=="hidden"&&gW(n),setTimeout(()=>{t.scrollTop=0})},T2=(t,e,n)=>{ct(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),Hn(e,"grid"),setTimeout(()=>{ct(e,n.showClass.popup),e.style.removeProperty("opacity")},NH)):Hn(e,"grid"),ct([document.documentElement,document.body],z.shown),n.heightAuto&&n.backdrop&&!n.toast&&ct([document.documentElement,document.body],z["height-auto"])};var yP={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function M2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=yP.email),t.input==="url"&&(t.inputValidator=yP.url))}function _2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(cr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function P2(t){M2(t),t.showLoaderOnConfirm&&!t.preConfirm&&cr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),_2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),vB(t)}let Do;var Ng=new WeakMap;class hn{constructor(){if(XV(this,Ng,void 0),typeof window>"u")return;Do=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,JV(Ng,this,this._main(Do.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(_H(Object.assign({},n,e)),Se.currentInstance){const o=Kc.swalPromiseResolve.get(Se.currentInstance),{isAwaitingPromise:s}=Se.currentInstance;Se.currentInstance._destroy(),s||o({isDismissed:!0}),T0()&&lH()}Se.currentInstance=Do;const r=I2(e,n);P2(r),Object.freeze(r),Se.timeout&&(Se.timeout.stop(),delete Se.timeout),clearTimeout(Se.restoreFocusTimeout);const i=O2(Do);return iH(Do,r),Mt.innerParams.set(Do,r),x2(Do,i,r)}then(e){return lP(Ng,this).then(e)}finally(e){return lP(Ng,this).finally(e)}}const x2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};Kc.swalPromiseResolve.set(t,r),Kc.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{OW(t)},e.denyButton.onclick=()=>{AW(t)},e.cancelButton.onclick=()=>{HW(t,o)},e.closeButton.onclick=()=>{o(lh.close)},zW(n,e,o),QB(Se,n,o),SW(t,n),S2(n),A2(Se,n,o),H2(e,n),setTimeout(()=>{e.container.scrollTop=0})}),I2=(t,e)=>{const n=f2(t),r=Object.assign({},$c,e,n,t);return r.showClass=Object.assign({},$c.showClass,r.showClass),r.hideClass=Object.assign({},$c.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},O2=t=>{const e={popup:rt(),container:fr(),actions:Xf(),confirmButton:Go(),denyButton:yu(),cancelButton:sh(),loader:ah(),closeButton:R0(),validationMessage:vv(),progressSteps:S0()};return Mt.domCache.set(t,e),e},A2=(t,e,n)=>{const r=yv();Jn(r),e.timer&&(t.timeout=new d2(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(Hn(r),Jr(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&_0(e.timer)})))},H2=(t,e)=>{if(!e.toast){if(!wv(e.allowEnterKey)){UA("allowEnterKey"),k2();return}N2(t)||D2(t,e)||LS(-1,1)}},N2=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&Nr(n))return n.focus(),!0;return!1},D2=(t,e)=>e.focusDeny&&Nr(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Nr(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&Nr(t.confirmButton)?(t.confirmButton.focus(),!0):!1,k2=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}hn.prototype.disableButtons=yH;hn.prototype.enableButtons=vH;hn.prototype.getInput=mH;hn.prototype.disableInput=bH;hn.prototype.enableInput=CH;hn.prototype.hideLoading=uw;hn.prototype.disableLoading=uw;hn.prototype.showValidationMessage=SH;hn.prototype.resetValidationMessage=RH;hn.prototype.close=_a;hn.prototype.closePopup=_a;hn.prototype.closeModal=_a;hn.prototype.closeToast=_a;hn.prototype.rejectPromise=hH;hn.prototype.update=PH;hn.prototype._destroy=xH;Object.assign(hn,h2);Object.keys(UW).forEach(t=>{hn[t]=function(){return Do&&Do[t]?Do[t](...arguments):null}});hn.DismissReason=lh;hn.version="11.21.0";const yi=hn;yi.default=yi;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var zs=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(x){if(x=o.postProcess(x,r),i){setTimeout(function(){i(x)},0);return}else return x},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],v=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&v+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var y=-1/0,E=1/0,C=function(){for(var x=Math.max(y,-c);x<=Math.min(E,c);x+=2){var P=void 0,T=g[x-1],O=g[x+1];T&&(g[x-1]=void 0);var G=!1;if(O){var U=O.oldPos-x;G=O&&0<=U&&U<l}var V=T&&T.oldPos+1<u;if(!G&&!V){g[x]=void 0;continue}if(!V||G&&T.oldPos<O.oldPos?P=o.addToPath(O,!0,!1,0,r):P=o.addToPath(T,!1,!0,1,r),v=o.extractCommon(P,n,e,x,r),P.oldPos+1>=u&&v+1>=l)return a(o.buildValues(P.lastComponent,n,e))||!0;g[x]=P,P.oldPos+1>=u&&(E=Math.min(E,x-1)),v+1>=l&&(y=Math.max(y,x+1))}c++};if(i)(function x(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);C()||x()},0)})();else for(;c<=h&&Date.now()<=f;){var M=C();if(M)return M}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),$2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),L2=function(t){$2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(zs),DH=new L2;function F2(t,e,n){return DH.diff(t,e,n)}function CP(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function bP(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function VS(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function BS(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function _h(t,e){return VS(t,e,"")}function Dg(t,e){return BS(t,e,"")}function SP(t,e){return e.slice(0,V2(t,e))}function V2(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function B2(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function W2(t){return!t.includes(`\r
`)&&t.includes(`
`)}function Ph(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function Zs(t){var e=t.match(/^\s*/);return e?e[0]:""}var kH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),dw="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",j2=new RegExp("[".concat(dw,"]+|\\s+|[^").concat(dw,"]"),"ug"),U2=function(t){kH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(j2)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&RP(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&RP(i,s,o,null),n},e}(zs),$H=new U2;function z2(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?FH(t,e,n):$H.diff(t,e,n)}function RP(t,e,n,r){if(e&&n){var i=Zs(e.value),o=Ph(e.value),s=Zs(n.value),a=Ph(n.value);if(t){var l=CP(i,s);t.value=BS(t.value,s,l),e.value=_h(e.value,l),n.value=_h(n.value,l)}if(r){var u=bP(o,a);r.value=VS(r.value,a,u),e.value=Dg(e.value,u),n.value=Dg(n.value,u)}}else if(n){if(t){var c=Zs(n.value);n.value=n.value.substring(c.length)}if(r){var c=Zs(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=Zs(r.value),d=Zs(e.value),f=Ph(e.value),g=CP(h,d);e.value=_h(e.value,g);var v=bP(_h(h,g),f);e.value=Dg(e.value,v),r.value=VS(r.value,h,v),t.value=BS(t.value,h,h.slice(0,h.length-v.length))}else if(r){var y=Zs(r.value),E=Ph(e.value),C=SP(E,y);e.value=Dg(e.value,C)}else if(t){var M=Ph(t.value),x=Zs(e.value),C=SP(M,x);e.value=_h(e.value,C)}}var Y2=function(t){kH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(dw,"]+|[^\\S\\n\\r]+|[^").concat(dw,"]"),"ug");return n.match(r)||[]},e}(zs),LH=new Y2;function FH(t,e,n){return LH.diff(t,e,n)}function G2(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var K2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),q2=function(t){K2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=VH,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}(zs),H0=new q2;function bf(t,e,n){return H0.diff(t,e,n)}function X2(t,e,n){return n=G2(n,{ignoreWhitespace:!0}),H0.diff(t,e,n)}function VH(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var J2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Z2=function(t){J2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}(zs),BH=new Z2;function Q2(t,e,n){return BH.diff(t,e,n)}var ej=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),tj=function(t){ej(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}(zs),WH=new tj;function nj(t,e,n){return WH.diff(t,e,n)}var rj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ij=function(t){rj(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=VH,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(fw(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}(zs),jH=new ij;function oj(t,e,n){return jH.diff(t,e,n)}function fw(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=fw(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=fw(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var sj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),aj=function(t){sj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}(zs),UH=new aj;function lj(t,e,n){return UH.diff(t,e,n)}var Wo=function(){return Wo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Wo.apply(this,arguments)};function zH(t){return Array.isArray(t)?t.map(function(e){return zH(e)}):Wo(Wo({},t),{hunks:t.hunks.map(function(e){return Wo(Wo({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function YH(t){return Array.isArray(t)?t.map(function(e){return YH(e)}):Wo(Wo({},t),{hunks:t.hunks.map(function(e){return Wo(Wo({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function uj(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function cj(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function N0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function hj(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function GH(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=N0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return dj(t,r[0],n)}function dj(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(B2(t)&&uj(e)?e=zH(e):W2(t)&&cj(e)&&(e=YH(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(G,U,V,X){return U===X},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(G,U,V,X,ne,Q,te){X===void 0&&(X=0),ne===void 0&&(ne=!0),Q===void 0&&(Q=[]),te===void 0&&(te=0);for(var pe=0,et=!1;X<G.length;X++){var Re=G[X],Ae=Re.length>0?Re[0]:" ",st=Re.length>0?Re.substr(1):Re;if(Ae==="-")if(o(U+1,r[U],Ae,st))U++,pe=0;else return!V||r[U]==null?null:(Q[te]=r[U],f(G,U+1,V-1,X,!1,Q,te+1));if(Ae==="+"){if(!ne)return null;Q[te]=st,te++,pe=0,et=!0}if(Ae===" ")if(pe++,Q[te]=r[U],o(U+1,r[U],Ae,st))te++,ne=!0,et=!1,U++;else return et||!V?null:r[U]&&(f(G,U+1,V-1,X+1,!1,Q,te+1)||f(G,U+1,V-1,X,!1,Q,te+1))||f(G,U,V-1,X+1,!1,Q,te)}return te-=pe,U-=pe,Q.length=te,{patchedLines:Q,oldLineLastI:U-1}}for(var g=[],v=0,h=0;h<i.length;h++){for(var y=i[h],E=void 0,C=r.length-y.oldLines+s,M=void 0,x=0;x<=s;x++){M=y.oldStart+v-1;for(var P=hj(M,a,C);M!==void 0&&(E=f(y.lines,M,x),!E);M=P());if(E)break}if(!E)return!1;for(var T=a;T<M;T++)g.push(r[T]);for(var O=0;O<E.patchedLines.length;O++){var d=E.patchedLines[O];g.push(d)}a=E.oldLineLastI+1,v=M+1-y.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function fj(t,e){var n=typeof t=="string"?N0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=GH(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var gw=function(){return gw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},gw.apply(this,arguments)};function KH(t){return Array.isArray(t)?t.map(function(e){return KH(e)}).reverse():gw(gw({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var Xc=function(){return Xc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Xc.apply(this,arguments)};function WS(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;bf(n,r,Xc(Xc({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(bf(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(Ae){return Ae.map(function(st){return" "+st})}for(var f=[],g=0,v=0,y=[],E=1,C=1,M=0;M<h.length;M++){var x=h[M],P=x.lines||mj(x.value);if(x.lines=P,x.added||x.removed){if(!g){var T=h[M-1];g=E,v=C,T&&(y=l>0?d(T.lines.slice(-l)):[],g-=y.length,v-=y.length)}for(var O=0,G=P;O<G.length;O++){var U=G[O];y.push((x.added?"+":"-")+U)}x.added?C+=P.length:E+=P.length}else{if(g)if(P.length<=l*2&&M<h.length-2)for(var V=0,X=d(P);V<X.length;V++){var U=X[V];y.push(U)}else{for(var ne=Math.min(P.length,l),Q=0,te=d(P.slice(0,ne));Q<te.length;Q++){var U=te[Q];y.push(U)}var pe={oldStart:g,oldLines:E-g+ne,newStart:v,newLines:C-v+ne,lines:y};f.push(pe),g=0,v=0,y=[]}E+=P.length,C+=P.length}}for(var et=0,Re=f;et<Re.length;et++)for(var pe=Re[et],M=0;M<pe.lines.length;M++)pe.lines[M].endsWith(`
`)?pe.lines[M]=pe.lines[M].slice(0,-1):(pe.lines.splice(M+1,0,"\\ No newline at end of file"),M++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function mw(t){if(Array.isArray(t))return t.map(mw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function qH(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;WS(t,e,n,r,i,o,Xc(Xc({},s),{callback:function(u){l(u?mw(u):void 0)}}))}else{var a=WS(t,e,n,r,i,o,s);return a?mw(a):void 0}}function gj(t,e,n,r,i,o){return qH(t,t,e,n,r,i,o)}function mj(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function pj(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function wj(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(vj(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function vj(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const yj=Object.freeze(Object.defineProperty({__proto__:null,Diff:zs,applyPatch:GH,applyPatches:fj,arrayDiff:UH,canonicalize:fw,characterDiff:DH,convertChangesToDMP:pj,convertChangesToXML:wj,createPatch:gj,createTwoFilesPatch:qH,cssDiff:WH,diffArrays:lj,diffChars:F2,diffCss:nj,diffJson:oj,diffLines:bf,diffSentences:Q2,diffTrimmedLines:X2,diffWords:z2,diffWordsWithSpace:FH,formatPatch:mw,jsonDiff:jH,lineDiff:H0,parsePatch:N0,reversePatch:KH,sentenceDiff:BH,structuredPatch:WS,wordDiff:$H,wordsWithSpaceDiff:LH},Symbol.toStringTag,{value:"Module"}));function Cj(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[],hotInstance:i}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();let o="",s="",a=[];const l=(h,d=2)=>{const f=g=>{if(typeof g!="object"||g===null)return g;if(Array.isArray(g))return g.map(f);const v={};return Object.keys(g).forEach(y=>{v[y]=f(g[y])}),v};try{return JSON.stringify(f(h),null,d)}catch(g){return console.error("Error stringifying object while preserving key order:",g),JSON.stringify(h,null,d)}};function u(h){return h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}if(n&&n.left!==void 0&&n.right!==void 0)if(typeof yj>"u"||typeof bf!="function")s='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다. (Diff is not defined)</p>',o='<div class="diff-popup-header error">라이브러리 오류</div>';else try{const h=l(n.left),d=l(n.right),f=bf(h,d);let g=0,v=0;f.forEach(V=>{const X=V.value||"",ne=X.split(`
`);let Q=ne.length;ne[ne.length-1]===""&&X.length>0&&Q--,X===""&&(Q=0),V.added?g+=Q:V.removed&&(v+=Q)});const y=[];let E=1,C=1;f.forEach((V,X)=>{const ne=V.value||"",Q=ne.split(`
`);let te=Q.length;Q[Q.length-1]===""&&ne.length>0&&te--,ne===""&&(te=0),V.removed?(y.push({originalPartIndex:X,part:V,sourceType:"del",lineNumber:E,numLines:te}),E+=te):V.added?(y.push({originalPartIndex:X,part:V,sourceType:"ins",lineNumber:C,numLines:te}),C+=te):(E+=te,C+=te)}),a=[];let M=[...y],x=null;for(M.length>0&&(M.sort((V,X)=>V.lineNumber!==X.lineNumber?V.lineNumber-X.lineNumber:V.sourceType==="del"&&X.sourceType!=="del"?-1:V.sourceType!=="del"&&X.sourceType==="del"?1:V.originalPartIndex-X.originalPartIndex),x=M[0],a.push(x),M=M.filter(V=>V.originalPartIndex!==x.originalPartIndex));M.length>0&&x;){const V=x.lineNumber;let X=null,ne=[];for(const Q of M)Q.lineNumber>=V&&ne.push({...Q,diff:Q.lineNumber-V});if(ne.length>0)ne.sort((Q,te)=>Q.diff!==te.diff?Q.diff-te.diff:Q.sourceType==="del"&&te.sourceType!=="del"?-1:Q.sourceType!=="del"&&te.sourceType==="del"?1:Q.originalPartIndex-te.originalPartIndex),X=ne[0];else{let Q=[];for(const te of M)Q.push({...te,absDiff:Math.abs(te.lineNumber-V)});Q.length>0&&(Q.sort((te,pe)=>te.absDiff!==pe.absDiff?te.absDiff-pe.absDiff:te.lineNumber!==pe.lineNumber?te.lineNumber-pe.lineNumber:te.sourceType==="del"&&pe.sourceType!=="del"?-1:te.sourceType!=="del"&&pe.sourceType==="del"?1:te.originalPartIndex-pe.originalPartIndex),X=Q[0])}if(X)a.push(X),x=X,M=M.filter(Q=>Q.originalPartIndex!==X.originalPartIndex);else break}let P="",T="",O=1,G=1;const U=new Map;if(a.forEach((V,X)=>U.set(V.originalPartIndex,X)),f.forEach((V,X)=>{const ne=V.value||"",Q=ne.replace(/\n$/,"").split(`
`);Q.length===1&&Q[0]===""&&ne===""||Q.forEach((te,pe)=>{let et="";(V.added||V.removed)&&pe===0&&U.has(X)&&(et=`id="diff-nav-target-${U.get(X)}"`),V.added?(P+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,T+=`<div ${et} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${G++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`):V.removed?(P+=`<div ${et} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${O++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`,T+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(P+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${O++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`,T+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${G++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`)})}),s=`<div class="diff-sbs-container"><div class="diff-sbs-pane" id="diff-left-pane">${P}</div><div class="diff-sbs-pane" id="diff-right-pane">${T}</div></div>`,a.length>0||g>0||v>0){let V="";(g>0||v>0)&&(V=`<span class="diff-summary"><strong class="diff-summary-added">+${g}</strong> <strong class="diff-summary-removed">-${v}</strong></span>`),o=`<div class="diff-popup-header">JSON 비교 결과</div><div id="diff-navigation">${V}<button id="prev-change-btn" class="swal2-styled">이전 변경점</button><button id="next-change-btn" class="swal2-styled">다음 변경점</button><span id="current-change-info"></span></div>`}else o='<div class="diff-popup-header">JSON 비교 결과</div>',h===d?s='<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':s='<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>'}catch(h){s=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${h.message}</p>`,o='<div class="diff-popup-header error">오류 발생</div>'}else s='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',o='<div class="diff-popup-header error">데이터 오류</div>';const c=`${o}<div id="diff-container">${s}</div>`;return bj({title:e,html:c,buttons:r,width:"95%",customClass:{popup:"custom-swal-popup-wider-text-diff",htmlContainer:"custom-swal-html-container-text-diff"},didOpen:h=>{const d=[];if(a&&a.length>0)for(let P=0;P<a.length;P++){const T=document.getElementById(`diff-nav-target-${P}`);T&&d.push(T)}let f=-1,g=null;const v=document.getElementById("diff-navigation"),y=document.getElementById("next-change-btn"),E=document.getElementById("prev-change-btn"),C=document.getElementById("current-change-info");function M(){if(!v)return;const P=d.length===0;y&&(y.style.display=P?"none":"inline-block"),E&&(E.style.display=P?"none":"inline-block"),C&&(C.textContent=P?totalAdded>0||totalRemoved>0?"0 / 0":"변경점 없음":`${f+1} / ${d.length}`),y&&(y.disabled=f>=d.length-1),E&&(E.disabled=f<=0)}function x(P){if(P<0||P>=d.length)return;g&&g.classList.remove("diff-navigation-highlight");const T=d[P];if(T){const O=document.getElementById("diff-container");if(O){const G=T.offsetTop;O.scrollTop=G-O.clientHeight/2+T.clientHeight/2}else T.scrollIntoView({block:"center"});T.classList.add("diff-navigation-highlight"),g=T}f=P,M()}d.length>0?x(0):M(),y&&y.addEventListener("click",()=>{f<d.length-1&&x(f+1)}),E&&E.addEventListener("click",()=>{f>0&&x(f-1)}),h.addEventListener("keydown",P=>{d.length===0||!y||!E||(P.key==="ArrowDown"||P.key==="PageDown"?(P.preventDefault(),y.disabled||y.click()):(P.key==="ArrowUp"||P.key==="PageUp")&&(P.preventDefault(),E.disabled||E.click()))}),M()}})}async function Vl(t){const{title:e,inputLabel:n,inputValue:r="",inputPlaceholder:i="",inputValidator:o,confirmButtonText:s="확인",cancelButtonText:a="취소",showCancelButton:l=!0,customClass:u={},html:c,hotInstance:h}=t;h&&typeof h.deselectCell=="function"&&h.deselectCell();let d=c||"";return n&&!c&&(d=`<label style="display: block; text-align: left; margin-bottom: .5em; font-weight: normal;">${n}</label>`),yi.fire({title:e,html:d,input:"text",inputValue:r,inputPlaceholder:i,inputValidator:o,showCancelButton:l,confirmButtonText:s,cancelButtonText:a,customClass:u,didOpen:()=>{const f=yi.getInput();f&&(f.focus(),typeof f.select=="function"&&f.select())}})}async function tt(t){const{title:e,text:n="",html:r="",icon:i="warning",confirmButtonText:o="확인",cancelButtonText:s="취소",showCancelButton:a=!0,customClass:l={},hotInstance:u}=t;return u&&typeof u.deselectCell=="function"&&u.deselectCell(),yi.fire({title:e,text:n,html:r,icon:i,showCancelButton:a,confirmButtonText:o,cancelButtonText:s,customClass:l})}function bj(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u}=t,c={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:a,preConfirm:l,didOpen:u},h=i.find(g=>g.role==="confirm"||!g.role&&i.indexOf(g)===0),d=i.find(g=>g.role==="cancel");return h?(c.showConfirmButton=!0,c.confirmButtonText=h.text||yi.getConfirmButton().innerText,h.color&&(c.confirmButtonColor=h.color)):i.length>0||l?!i.some(g=>g.role!=="cancel")&&!l&&(c.showConfirmButton=!1):c.showConfirmButton=!1,d&&(c.showCancelButton=!0,c.cancelButtonText=d.text||yi.getCancelButton().innerText,d.color&&(c.cancelButtonColor=d.color)),typeof yi>"u"?Promise.reject("SweetAlert2 is not imported"):yi.fire(c).then(g=>{let v={...g,formData:{}};return g.isConfirmed&&l&&(v.formData=g.value||{}),g.isConfirmed&&h&&typeof h.action=="function"&&!l?h.action():g.isDismissed&&d&&typeof d.action=="function"&&g.dismiss===yi.DismissReason.cancel&&d.action(),v})}const sn=document.getElementById("json-input"),qr=document.getElementById("save-message"),en=document.getElementById("json-error"),Et=document.getElementById("tree-view"),jS=document.getElementById("table-view");function nu(t,e,n){t&&(t.textContent=e,setTimeout(()=>{t.textContent=""},n))}function Lc(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent&&a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(i.appendChild(document.createTextNode(o)),e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));if(t&&t!==""){let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u;for(;(u=l.exec(t))!==null;){const c=u[0];let h=c;if(a===""?a=c:c.startsWith("[")?a+=c:a+="."+c,i.appendChild(document.createTextNode(" > ")),e){const d=document.createElement("a");d.href="#",d.textContent=h,d.style.textDecoration="underline",d.style.cursor="pointer",d.onclick=(f=>g=>{g.preventDefault(),e(f)})(a),i.appendChild(d)}else i.appendChild(document.createTextNode(h))}}i.appendChild(document.createTextNode(s))}function Sj(){Et&&(Et.innerHTML=""),jS&&(jS.innerHTML=""),en&&(en.textContent=""),qr&&(qr.textContent=""),Lc(null,null)}function lu(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function US(t,e){if(typeof t=="string"){const n=t.trim();if(n.toLowerCase()==="null")return null;if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1;if(n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,"")))return Number(n);if(n.startsWith("[")&&n.endsWith("]")||n.startsWith("{")&&n.endsWith("}"))try{return JSON.parse(n)}catch{return t}return t}return t}function XH(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let zl=null;function Jc(t){zl&&zl.classList.remove("selected-node"),zl=t,zl&&zl.classList.add("selected-node")}function Rj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),Jc(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),XH(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),Jc(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function Ej(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),Sf(e,o,n,r.rootJsonData,r.depth+1,r),o}function Sf(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=Rj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=Ej(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function Tj(){return zl?zl.dataset.path:null}function Mj(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function _j(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var kg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xh=function(t){return t&&t.Math===Math&&t},vn=xh(typeof globalThis=="object"&&globalThis)||xh(typeof window=="object"&&window)||xh(typeof self=="object"&&self)||xh(typeof kg=="object"&&kg)||xh(typeof kg=="object"&&kg)||function(){return this}()||Function("return this")(),D0={},Nn=function(t){try{return!!t()}catch{return!0}},Pj=Nn,Ti=!Pj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),xj=Nn,Sv=!xj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Ij=Sv,$g=Function.prototype.call,yn=Ij?$g.bind($g):function(){return $g.apply($g,arguments)},JH={},ZH={}.propertyIsEnumerable,QH=Object.getOwnPropertyDescriptor,Oj=QH&&!ZH.call({1:2},1);JH.f=Oj?function(e){var n=QH(this,e);return!!n&&n.enumerable}:ZH;var Rv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},eN=Sv,tN=Function.prototype,zS=tN.call,Aj=eN&&tN.bind.bind(zS,zS),dn=eN?Aj:function(t){return function(){return zS.apply(t,arguments)}},nN=dn,Hj=nN({}.toString),Nj=nN("".slice),Cu=function(t){return Nj(Hj(t),8,-1)},Dj=dn,kj=Nn,$j=Cu,Iy=Object,Lj=Dj("".split),Fj=kj(function(){return!Iy("z").propertyIsEnumerable(0)})?function(t){return $j(t)==="String"?Lj(t,""):Iy(t)}:Iy,k0=function(t){return t==null},Vj=k0,Bj=TypeError,eg=function(t){if(Vj(t))throw new Bj("Can't call method on "+t);return t},Wj=Fj,jj=eg,tg=function(t){return Wj(jj(t))},Oy=typeof document=="object"&&document.all,Cn=typeof Oy>"u"&&Oy!==void 0?function(t){return typeof t=="function"||t===Oy}:function(t){return typeof t=="function"},Uj=Cn,Mi=function(t){return typeof t=="object"?t!==null:Uj(t)},Ay=vn,zj=Cn,Yj=function(t){return zj(t)?t:void 0},uh=function(t,e){return arguments.length<2?Yj(Ay[t]):Ay[t]&&Ay[t][e]},Gj=dn,ng=Gj({}.isPrototypeOf),Kj=vn,EP=Kj.navigator,TP=EP&&EP.userAgent,Ev=TP?String(TP):"",rN=vn,Hy=Ev,MP=rN.process,_P=rN.Deno,PP=MP&&MP.versions||_P&&_P.version,xP=PP&&PP.v8,Ji,pw;xP&&(Ji=xP.split("."),pw=Ji[0]>0&&Ji[0]<4?1:+(Ji[0]+Ji[1]));!pw&&Hy&&(Ji=Hy.match(/Edge\/(\d+)/),(!Ji||Ji[1]>=74)&&(Ji=Hy.match(/Chrome\/(\d+)/),Ji&&(pw=+Ji[1])));var qj=pw,IP=qj,Xj=Nn,Jj=vn,Zj=Jj.String,$0=!!Object.getOwnPropertySymbols&&!Xj(function(){var t=Symbol("symbol detection");return!Zj(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&IP&&IP<41}),Qj=$0,iN=Qj&&!Symbol.sham&&typeof Symbol.iterator=="symbol",eU=uh,tU=Cn,nU=ng,rU=iN,iU=Object,L0=rU?function(t){return typeof t=="symbol"}:function(t){var e=eU("Symbol");return tU(e)&&nU(e.prototype,iU(t))},oU=String,Tv=function(t){try{return oU(t)}catch{return"Object"}},sU=Cn,aU=Tv,lU=TypeError,Dr=function(t){if(sU(t))return t;throw new lU(aU(t)+" is not a function")},uU=Dr,cU=k0,rg=function(t,e){var n=t[e];return cU(n)?void 0:uU(n)},Ny=yn,Dy=Cn,ky=Mi,hU=TypeError,dU=function(t,e){var n,r;if(e==="string"&&Dy(n=t.toString)&&!ky(r=Ny(n,t))||Dy(n=t.valueOf)&&!ky(r=Ny(n,t))||e!=="string"&&Dy(n=t.toString)&&!ky(r=Ny(n,t)))return r;throw new hU("Can't convert object to primitive value")},oN={exports:{}},OP=vn,fU=Object.defineProperty,F0=function(t,e){try{fU(OP,t,{value:e,configurable:!0,writable:!0})}catch{OP[t]=e}return e},gU=vn,mU=F0,AP="__core-js_shared__",HP=oN.exports=gU[AP]||mU(AP,{});(HP.versions||(HP.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var V0=oN.exports,NP=V0,sN=function(t,e){return NP[t]||(NP[t]=e||{})},pU=eg,wU=Object,ch=function(t){return wU(pU(t))},vU=dn,yU=ch,CU=vU({}.hasOwnProperty),_i=Object.hasOwn||function(e,n){return CU(yU(e),n)},bU=dn,SU=0,RU=Math.random(),EU=bU(1 .toString),aN=function(t){return"Symbol("+(t===void 0?"":t)+")_"+EU(++SU+RU,36)},TU=vn,MU=sN,DP=_i,_U=aN,PU=$0,xU=iN,xc=TU.Symbol,$y=MU("wks"),IU=xU?xc.for||xc:xc&&xc.withoutSetter||_U,so=function(t){return DP($y,t)||($y[t]=PU&&DP(xc,t)?xc[t]:IU("Symbol."+t)),$y[t]},OU=yn,kP=Mi,$P=L0,AU=rg,HU=dU,NU=so,DU=TypeError,kU=NU("toPrimitive"),$U=function(t,e){if(!kP(t)||$P(t))return t;var n=AU(t,kU),r;if(n){if(e===void 0&&(e="default"),r=OU(n,t,e),!kP(r)||$P(r))return r;throw new DU("Can't convert object to primitive value")}return e===void 0&&(e="number"),HU(t,e)},LU=$U,FU=L0,lN=function(t){var e=LU(t,"string");return FU(e)?e:e+""},VU=vn,LP=Mi,YS=VU.document,BU=LP(YS)&&LP(YS.createElement),B0=function(t){return BU?YS.createElement(t):{}},WU=Ti,jU=Nn,UU=B0,uN=!WU&&!jU(function(){return Object.defineProperty(UU("div"),"a",{get:function(){return 7}}).a!==7}),zU=Ti,YU=yn,GU=JH,KU=Rv,qU=tg,XU=lN,JU=_i,ZU=uN,FP=Object.getOwnPropertyDescriptor;D0.f=zU?FP:function(e,n){if(e=qU(e),n=XU(n),ZU)try{return FP(e,n)}catch{}if(JU(e,n))return KU(!YU(GU.f,e,n),e[n])};var Ys={},QU=Ti,ez=Nn,cN=QU&&ez(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),tz=Mi,nz=String,rz=TypeError,bn=function(t){if(tz(t))return t;throw new rz(nz(t)+" is not an object")},iz=Ti,oz=uN,sz=cN,Lg=bn,VP=lN,az=TypeError,Ly=Object.defineProperty,lz=Object.getOwnPropertyDescriptor,Fy="enumerable",Vy="configurable",By="writable";Ys.f=iz?sz?function(e,n,r){if(Lg(e),n=VP(n),Lg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&By in r&&!r[By]){var i=lz(e,n);i&&i[By]&&(e[n]=r.value,r={configurable:Vy in r?r[Vy]:i[Vy],enumerable:Fy in r?r[Fy]:i[Fy],writable:!1})}return Ly(e,n,r)}:Ly:function(e,n,r){if(Lg(e),n=VP(n),Lg(r),oz)try{return Ly(e,n,r)}catch{}if("get"in r||"set"in r)throw new az("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var uz=Ti,cz=Ys,hz=Rv,hh=uz?function(t,e,n){return cz.f(t,e,hz(1,n))}:function(t,e,n){return t[e]=n,t},hN={exports:{}},GS=Ti,dz=_i,dN=Function.prototype,fz=GS&&Object.getOwnPropertyDescriptor,gz=dz(dN,"name"),mz=gz&&(!GS||GS&&fz(dN,"name").configurable),pz={CONFIGURABLE:mz},wz=dn,vz=Cn,KS=V0,yz=wz(Function.toString);vz(KS.inspectSource)||(KS.inspectSource=function(t){return yz(t)});var Cz=KS.inspectSource,bz=vn,Sz=Cn,BP=bz.WeakMap,Rz=Sz(BP)&&/native code/.test(String(BP)),Ez=sN,Tz=aN,WP=Ez("keys"),W0=function(t){return WP[t]||(WP[t]=Tz(t))},j0={},Mz=Rz,fN=vn,_z=Mi,Pz=hh,Wy=_i,jy=V0,xz=W0,Iz=j0,jP="Object already initialized",qS=fN.TypeError,Oz=fN.WeakMap,ww,Rf,vw,Az=function(t){return vw(t)?Rf(t):ww(t,{})},Hz=function(t){return function(e){var n;if(!_z(e)||(n=Rf(e)).type!==t)throw new qS("Incompatible receiver, "+t+" required");return n}};if(Mz||jy.state){var ho=jy.state||(jy.state=new Oz);ho.get=ho.get,ho.has=ho.has,ho.set=ho.set,ww=function(t,e){if(ho.has(t))throw new qS(jP);return e.facade=t,ho.set(t,e),e},Rf=function(t){return ho.get(t)||{}},vw=function(t){return ho.has(t)}}else{var Nu=xz("state");Iz[Nu]=!0,ww=function(t,e){if(Wy(t,Nu))throw new qS(jP);return e.facade=t,Pz(t,Nu,e),e},Rf=function(t){return Wy(t,Nu)?t[Nu]:{}},vw=function(t){return Wy(t,Nu)}}var gN={set:ww,get:Rf,has:vw,enforce:Az,getterFor:Hz},U0=dn,Nz=Nn,Dz=Cn,Fg=_i,XS=Ti,kz=pz.CONFIGURABLE,$z=Cz,mN=gN,Lz=mN.enforce,Fz=mN.get,UP=String,Pp=Object.defineProperty,Vz=U0("".slice),Bz=U0("".replace),Wz=U0([].join),jz=XS&&!Nz(function(){return Pp(function(){},"length",{value:8}).length!==8}),Uz=String(String).split("String"),zz=hN.exports=function(t,e,n){Vz(UP(e),0,7)==="Symbol("&&(e="["+Bz(UP(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Fg(t,"name")||kz&&t.name!==e)&&(XS?Pp(t,"name",{value:e,configurable:!0}):t.name=e),jz&&n&&Fg(n,"arity")&&t.length!==n.arity&&Pp(t,"length",{value:n.arity});try{n&&Fg(n,"constructor")&&n.constructor?XS&&Pp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=Lz(t);return Fg(r,"source")||(r.source=Wz(Uz,typeof e=="string"?e:"")),t};Function.prototype.toString=zz(function(){return Dz(this)&&Fz(this).source||$z(this)},"toString");var pN=hN.exports,Yz=Cn,Gz=Ys,Kz=pN,qz=F0,z0=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Yz(n)&&Kz(n,o,r),r.global)i?t[e]=n:qz(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:Gz.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},wN={},Xz=Math.ceil,Jz=Math.floor,Zz=Math.trunc||function(e){var n=+e;return(n>0?Jz:Xz)(n)},Qz=Zz,ig=function(t){var e=+t;return e!==e||e===0?0:Qz(e)},eY=ig,tY=Math.max,nY=Math.min,rY=function(t,e){var n=eY(t);return n<0?tY(n+e,0):nY(n,e)},iY=ig,oY=Math.min,sY=function(t){var e=iY(t);return e>0?oY(e,9007199254740991):0},aY=sY,dh=function(t){return aY(t.length)},lY=tg,uY=rY,cY=dh,hY=function(t){return function(e,n,r){var i=lY(e),o=cY(i);if(o===0)return!t&&-1;var s=uY(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},dY={indexOf:hY(!1)},fY=dn,Uy=_i,gY=tg,mY=dY.indexOf,pY=j0,zP=fY([].push),vN=function(t,e){var n=gY(t),r=0,i=[],o;for(o in n)!Uy(pY,o)&&Uy(n,o)&&zP(i,o);for(;e.length>r;)Uy(n,o=e[r++])&&(~mY(i,o)||zP(i,o));return i},Y0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],wY=vN,vY=Y0,yY=vY.concat("length","prototype");wN.f=Object.getOwnPropertyNames||function(e){return wY(e,yY)};var yN={};yN.f=Object.getOwnPropertySymbols;var CY=uh,bY=dn,SY=wN,RY=yN,EY=bn,TY=bY([].concat),MY=CY("Reflect","ownKeys")||function(e){var n=SY.f(EY(e)),r=RY.f;return r?TY(n,r(e)):n},YP=_i,_Y=MY,PY=D0,xY=Ys,CN=function(t,e,n){for(var r=_Y(e),i=xY.f,o=PY.f,s=0;s<r.length;s++){var a=r[s];!YP(t,a)&&!(n&&YP(n,a))&&i(t,a,o(e,a))}},IY=Nn,OY=Cn,AY=/#|\.prototype\./,og=function(t,e){var n=NY[HY(t)];return n===kY?!0:n===DY?!1:OY(e)?IY(e):!!e},HY=og.normalize=function(t){return String(t).replace(AY,".").toLowerCase()},NY=og.data={},DY=og.NATIVE="N",kY=og.POLYFILL="P",$Y=og,Vg=vn,LY=D0.f,FY=hh,VY=z0,BY=F0,WY=CN,jY=$Y,Ct=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Vg:i?s=Vg[n]||BY(n,{}):s=Vg[n]&&Vg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=LY(s,a),l=c&&c.value):l=s[a],o=jY(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;WY(u,l)}(t.sham||l&&l.sham)&&FY(u,"sham",!0),VY(s,a,u,t)}},UY=Sv,bN=Function.prototype,GP=bN.apply,KP=bN.call,sg=typeof Reflect=="object"&&Reflect.apply||(UY?KP.bind(GP):function(){return KP.apply(GP,arguments)}),zY=dn,YY=Dr,SN=function(t,e,n){try{return zY(YY(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},GY=Mi,KY=function(t){return GY(t)||t===null},qY=KY,XY=String,JY=TypeError,ZY=function(t){if(qY(t))return t;throw new JY("Can't set "+XY(t)+" as a prototype")},QY=SN,eG=Mi,tG=eg,nG=ZY,RN=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=QY(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return tG(i),nG(o),eG(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),rG=Ys.f,iG=function(t,e,n){n in t||rG(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},oG=Cn,sG=Mi,qP=RN,aG=function(t,e,n){var r,i;return qP&&oG(r=e.constructor)&&r!==n&&sG(i=r.prototype)&&i!==n.prototype&&qP(t,i),t},lG=so,uG=lG("toStringTag"),EN={};EN[uG]="z";var cG=String(EN)==="[object z]",hG=cG,dG=Cn,xp=Cu,fG=so,gG=fG("toStringTag"),mG=Object,pG=xp(function(){return arguments}())==="Arguments",wG=function(t,e){try{return t[e]}catch{}},TN=hG?xp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=wG(e=mG(t),gG))=="string"?n:pG?xp(e):(r=xp(e))==="Object"&&dG(e.callee)?"Arguments":r},vG=TN,yG=String,Mv=function(t){if(vG(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return yG(t)},CG=Mv,bG=function(t,e){return t===void 0?arguments.length<2?"":e:CG(t)},SG=Mi,RG=hh,EG=function(t,e){SG(e)&&"cause"in e&&RG(t,"cause",e.cause)},TG=dn,MN=Error,MG=TG("".replace),_G=function(t){return String(new MN(t).stack)}("zxcasd"),_N=/\n\s*at [^:]*:[^\n]*/,PG=_N.test(_G),xG=function(t,e){if(PG&&typeof t=="string"&&!MN.prepareStackTrace)for(;e--;)t=MG(t,_N,"");return t},IG=Nn,OG=Rv,AG=!IG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",OG(1,7)),t.stack!==7):!0}),HG=hh,NG=xG,DG=AG,XP=Error.captureStackTrace,kG=function(t,e,n,r){DG&&(XP?XP(t,e):HG(t,"stack",NG(n,r)))},JP=uh,$G=_i,ZP=hh,LG=ng,QP=RN,ex=CN,tx=iG,FG=aG,VG=bG,BG=EG,WG=kG,jG=Ti,UG=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=JP.apply(null,s);if(l){var u=l.prototype;if($G(u,"cause")&&delete u.cause,!n)return l;var c=JP("Error"),h=e(function(d,f){var g=VG(r?f:d,void 0),v=r?new l(d):new l;return g!==void 0&&ZP(v,"message",g),WG(v,h,v.stack,2),this&&LG(u,this)&&FG(v,this,h),arguments.length>o&&BG(v,arguments[o]),v});h.prototype=u,a!=="Error"?QP?QP(h,c):ex(h,c,{name:!0}):jG&&i in l&&(tx(h,l,i),tx(h,l,"prepareStackTrace")),ex(h,l);try{u.name!==a&&ZP(u,"name",a),u.constructor=h}catch{}return h}},PN=Ct,zG=vn,Xo=sg,xN=UG,JS="WebAssembly",nx=zG[JS],yw=new Error("e",{cause:7}).cause!==7,bu=function(t,e){var n={};n[t]=xN(t,e,yw),PN({global:!0,constructor:!0,arity:1,forced:yw},n)},G0=function(t,e){if(nx&&nx[t]){var n={};n[t]=xN(JS+"."+t,e,yw),PN({target:JS,stat:!0,constructor:!0,arity:1,forced:yw},n)}};bu("Error",function(t){return function(n){return Xo(t,this,arguments)}});bu("EvalError",function(t){return function(n){return Xo(t,this,arguments)}});bu("RangeError",function(t){return function(n){return Xo(t,this,arguments)}});bu("ReferenceError",function(t){return function(n){return Xo(t,this,arguments)}});bu("SyntaxError",function(t){return function(n){return Xo(t,this,arguments)}});bu("TypeError",function(t){return function(n){return Xo(t,this,arguments)}});bu("URIError",function(t){return function(n){return Xo(t,this,arguments)}});G0("CompileError",function(t){return function(n){return Xo(t,this,arguments)}});G0("LinkError",function(t){return function(n){return Xo(t,this,arguments)}});G0("RuntimeError",function(t){return function(n){return Xo(t,this,arguments)}});var YG=Cu,IN=Array.isArray||function(e){return YG(e)==="Array"},GG=Ti,KG=IN,qG=TypeError,XG=Object.getOwnPropertyDescriptor,JG=GG&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),ON=JG?function(t,e){if(KG(t)&&!XG(t,"length").writable)throw new qG("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},ZG=TypeError,QG=9007199254740991,AN=function(t){if(t>QG)throw ZG("Maximum allowed index exceeded");return t},eK=Ct,tK=ch,nK=dh,rK=ON,iK=AN,oK=Nn,sK=oK(function(){return[].push.call({length:4294967296},1)!==4294967297}),aK=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},lK=sK||!aK();eK({target:"Array",proto:!0,arity:1,forced:lK},{push:function(e){var n=tK(this),r=nK(n),i=arguments.length;iK(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return rK(n,r),r}});var uK=Cu,cK=dn,hK=function(t){if(uK(t)==="Function")return cK(t)},rx=hK,dK=Dr,fK=Sv,gK=rx(rx.bind),HN=function(t,e){return dK(t),e===void 0?t:fK?gK(t,e):function(){return t.apply(e,arguments)}},NN={},mK=so,pK=NN,wK=mK("iterator"),vK=Array.prototype,yK=function(t){return t!==void 0&&(pK.Array===t||vK[wK]===t)},CK=TN,ix=rg,bK=k0,SK=NN,RK=so,EK=RK("iterator"),K0=function(t){if(!bK(t))return ix(t,EK)||ix(t,"@@iterator")||SK[CK(t)]},TK=yn,MK=Dr,_K=bn,PK=Tv,xK=K0,IK=TypeError,OK=function(t,e){var n=arguments.length<2?xK(t):e;if(MK(n))return _K(TK(n,t));throw new IK(PK(t)+" is not iterable")},AK=yn,ox=bn,HK=rg,ei=function(t,e,n){var r,i;ox(t);try{if(r=HK(t,"return"),!r){if(e==="throw")throw n;return n}r=AK(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return ox(r),n},NK=HN,DK=yn,kK=bn,$K=Tv,LK=yK,FK=dh,sx=ng,VK=OK,BK=K0,ax=ei,WK=TypeError,Ip=function(t,e){this.stopped=t,this.result=e},lx=Ip.prototype,fh=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=NK(e,r),u,c,h,d,f,g,v,y=function(C){return u&&ax(u,"normal",C),new Ip(!0,C)},E=function(C){return i?(kK(C),a?l(C[0],C[1],y):l(C[0],C[1])):a?l(C,y):l(C)};if(o)u=t.iterator;else if(s)u=t;else{if(c=BK(t),!c)throw new WK($K(t)+" is not iterable");if(LK(c)){for(h=0,d=FK(t);d>h;h++)if(f=E(t[h]),f&&sx(lx,f))return f;return new Ip(!1)}u=VK(t,c)}for(g=o?t.next:u.next;!(v=DK(g,u)).done;){try{f=E(v.value)}catch(C){ax(u,"throw",C)}if(typeof f=="object"&&f&&sx(lx,f))return f}return new Ip(!1)},jK=Ti,UK=Ys,zK=Rv,DN=function(t,e,n){jK?UK.f(t,e,zK(0,n)):t[e]=n},YK=Ct,GK=fh,KK=DN;YK({target:"Object",stat:!0},{fromEntries:function(e){var n={};return GK(e,function(r,i){KK(n,r,i)},{AS_ENTRIES:!0}),n}});var zy=dn,Bg=Set.prototype,Jo={Set,add:zy(Bg.add),has:zy(Bg.has),remove:zy(Bg.delete),proto:Bg},qK=Jo.has,Su=function(t){return qK(t),t},XK=yn,Ru=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=XK(i,r)).done;)if(s=e(o.value),s!==void 0)return s},kN=dn,JK=Ru,$N=Jo,ZK=$N.Set,LN=$N.proto,QK=kN(LN.forEach),FN=kN(LN.keys),e3=FN(new ZK).next,ag=function(t,e,n){return n?JK({iterator:FN(t),next:e3},e):QK(t,e)},VN=Jo,t3=ag,n3=VN.Set,r3=VN.add,q0=function(t){var e=new n3;return t3(t,function(n){r3(e,n)}),e},i3=SN,o3=Jo,lg=i3(o3.proto,"size","get")||function(t){return t.size},Zo=function(t){return{iterator:t,next:t.next,done:!1}},ux=Dr,BN=bn,cx=yn,s3=ig,a3=Zo,hx="Invalid size",l3=RangeError,u3=TypeError,c3=Math.max,WN=function(t,e){this.set=t,this.size=c3(e,0),this.has=ux(t.has),this.keys=ux(t.keys)};WN.prototype={getIterator:function(){return a3(BN(cx(this.keys,this.set)))},includes:function(t){return cx(this.has,this.set,t)}};var Eu=function(t){BN(t);var e=+t.size;if(e!==e)throw new u3(hx);var n=s3(e);if(n<0)throw new l3(hx);return new WN(t,n)},h3=Su,jN=Jo,d3=q0,f3=lg,g3=Eu,m3=ag,p3=Ru,w3=jN.has,dx=jN.remove,v3=function(e){var n=h3(this),r=g3(e),i=d3(n);return f3(n)<=r.size?m3(n,function(o){r.includes(o)&&dx(i,o)}):p3(r.getIterator(),function(o){w3(n,o)&&dx(i,o)}),i},y3=uh,fx=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},gx=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},Tu=function(t,e){var n=y3("Set");try{new n()[t](fx(0));try{return new n()[t](fx(-1)),!1}catch{if(!e)return!0;try{return new n()[t](gx(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](gx(1/0)))}}}catch{return!1}},C3=Ct,b3=v3,S3=Tu,R3=!S3("difference",function(t){return t.size===0});C3({target:"Set",proto:!0,real:!0,forced:R3},{difference:b3});var E3=Su,X0=Jo,T3=lg,M3=Eu,_3=ag,P3=Ru,x3=X0.Set,mx=X0.add,I3=X0.has,O3=function(e){var n=E3(this),r=M3(e),i=new x3;return T3(n)>r.size?P3(r.getIterator(),function(o){I3(n,o)&&mx(i,o)}):_3(n,function(o){r.includes(o)&&mx(i,o)}),i},A3=Ct,H3=Nn,N3=O3,D3=Tu,k3=!D3("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||H3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});A3({target:"Set",proto:!0,real:!0,forced:k3},{intersection:N3});var $3=Su,L3=Jo.has,F3=lg,V3=Eu,B3=ag,W3=Ru,j3=ei,U3=function(e){var n=$3(this),r=V3(e);if(F3(n)<=r.size)return B3(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return W3(i,function(o){if(L3(n,o))return j3(i,"normal",!1)})!==!1},z3=Ct,Y3=U3,G3=Tu,K3=!G3("isDisjointFrom",function(t){return!t});z3({target:"Set",proto:!0,real:!0,forced:K3},{isDisjointFrom:Y3});var q3=Su,X3=lg,J3=ag,Z3=Eu,Q3=function(e){var n=q3(this),r=Z3(e);return X3(n)>r.size?!1:J3(n,function(i){if(!r.includes(i))return!1},!0)!==!1},e5=Ct,t5=Q3,n5=Tu,r5=!n5("isSubsetOf",function(t){return t});e5({target:"Set",proto:!0,real:!0,forced:r5},{isSubsetOf:t5});var i5=Su,o5=Jo.has,s5=lg,a5=Eu,l5=Ru,u5=ei,c5=function(e){var n=i5(this),r=a5(e);if(s5(n)<r.size)return!1;var i=r.getIterator();return l5(i,function(o){if(!o5(n,o))return u5(i,"normal",!1)})!==!1},h5=Ct,d5=c5,f5=Tu,g5=!f5("isSupersetOf",function(t){return!t});h5({target:"Set",proto:!0,real:!0,forced:g5},{isSupersetOf:d5});var m5=Su,J0=Jo,p5=q0,w5=Eu,v5=Ru,y5=J0.add,C5=J0.has,b5=J0.remove,S5=function(e){var n=m5(this),r=w5(e).getIterator(),i=p5(n);return v5(r,function(o){C5(n,o)?b5(i,o):y5(i,o)}),i},R5=Ct,E5=S5,T5=Tu;R5({target:"Set",proto:!0,real:!0,forced:!T5("symmetricDifference")},{symmetricDifference:E5});var M5=Su,_5=Jo.add,P5=q0,x5=Eu,I5=Ru,O5=function(e){var n=M5(this),r=x5(e).getIterator(),i=P5(n);return I5(r,function(o){_5(i,o)}),i},A5=Ct,H5=O5,N5=Tu;A5({target:"Set",proto:!0,real:!0,forced:!N5("union")},{union:H5});var D5=ng,k5=TypeError,$5=function(t,e){if(D5(e,t))return t;throw new k5("Incorrect invocation")},L5=Nn,F5=!L5(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),V5=_i,B5=Cn,W5=ch,j5=W0,U5=F5,px=j5("IE_PROTO"),ZS=Object,z5=ZS.prototype,UN=U5?ZS.getPrototypeOf:function(t){var e=W5(t);if(V5(e,px))return e[px];var n=e.constructor;return B5(n)&&e instanceof n?n.prototype:e instanceof ZS?z5:null},wx=pN,Y5=Ys,G5=function(t,e,n){return n.get&&wx(n.get,e,{getter:!0}),n.set&&wx(n.set,e,{setter:!0}),Y5.f(t,e,n)},zN={},K5=vN,q5=Y0,X5=Object.keys||function(e){return K5(e,q5)},J5=Ti,Z5=cN,Q5=Ys,eq=bn,tq=tg,nq=X5;zN.f=J5&&!Z5?Object.defineProperties:function(e,n){eq(e);for(var r=tq(n),i=nq(n),o=i.length,s=0,a;o>s;)Q5.f(e,a=i[s++],r[a]);return e};var rq=uh,YN=rq("document","documentElement"),iq=bn,oq=zN,vx=Y0,sq=j0,aq=YN,lq=B0,uq=W0,yx=">",Cx="<",QS="prototype",eR="script",GN=uq("IE_PROTO"),Yy=function(){},KN=function(t){return Cx+eR+yx+t+Cx+"/"+eR+yx},bx=function(t){t.write(KN("")),t.close();var e=t.parentWindow.Object;return t=null,e},cq=function(){var t=lq("iframe"),e="java"+eR+":",n;return t.style.display="none",aq.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(KN("document.F=Object")),n.close(),n.F},Wg,Op=function(){try{Wg=new ActiveXObject("htmlfile")}catch{}Op=typeof document<"u"?document.domain&&Wg?bx(Wg):cq():bx(Wg);for(var t=vx.length;t--;)delete Op[QS][vx[t]];return Op()};sq[GN]=!0;var qN=Object.create||function(e,n){var r;return e!==null?(Yy[QS]=iq(e),r=new Yy,Yy[QS]=null,r[GN]=e):r=Op(),n===void 0?r:oq.f(r,n)},hq=Nn,dq=Cn,fq=Mi,Sx=UN,gq=z0,mq=so,tR=mq("iterator"),uu,Gy,Ky;[].keys&&(Ky=[].keys(),"next"in Ky&&(Gy=Sx(Sx(Ky)),Gy!==Object.prototype&&(uu=Gy)));var pq=!fq(uu)||hq(function(){var t={};return uu[tR].call(t)!==t});pq&&(uu={});dq(uu[tR])||gq(uu,tR,function(){return this});var XN={IteratorPrototype:uu},wq=Ct,vq=vn,yq=$5,Cq=bn,bq=Cn,Sq=UN,Rq=G5,Eq=DN,Tq=Nn,Z0=_i,Mq=so,Uo=XN.IteratorPrototype,_q=Ti,qy="constructor",JN="Iterator",Rx=Mq("toStringTag"),ZN=TypeError,Xy=vq[JN],QN=!bq(Xy)||Xy.prototype!==Uo||!Tq(function(){Xy({})}),Q0=function(){if(yq(this,Uo),Sq(this)===Uo)throw new ZN("Abstract class Iterator not directly constructable")},eD=function(t,e){_q?Rq(Uo,t,{configurable:!0,get:function(){return e},set:function(n){if(Cq(this),this===Uo)throw new ZN("You can't redefine this property");Z0(this,t)?this[t]=n:Eq(this,t,n)}}):Uo[t]=e};Z0(Uo,Rx)||eD(Rx,JN);(QN||!Z0(Uo,qy)||Uo[qy]===Object)&&eD(qy,Q0);Q0.prototype=Uo;wq({global:!0,constructor:!0,forced:QN},{Iterator:Q0});var Pq=z0,xq=function(t,e,n){for(var r in e)Pq(t,r,e[r],n);return t},Iq=function(t,e){return{value:t,done:e}},Oq=yn,Aq=qN,Hq=hh,Nq=xq,Dq=so,tD=gN,kq=rg,$q=XN.IteratorPrototype,jg=Iq,Jy=ei,Lq=Dq("toStringTag"),nD="IteratorHelper",rD="WrapForValidIterator",Fq=tD.set,iD=function(t){var e=tD.getterFor(t?rD:nD);return Nq(Aq($q),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return jg(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:jg(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=kq(r,"return");return i?Oq(i,r):jg(void 0,!0)}if(n.inner)try{Jy(n.inner.iterator,"normal")}catch(o){return Jy(r,"throw",o)}return r&&Jy(r,"normal"),jg(void 0,!0)}})},Vq=iD(!0),oD=iD(!1);Hq(oD,Lq,"Iterator Helper");var eE=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?rD:nD,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,Fq(this,s)};return r.prototype=e?Vq:oD,r},Bq=bn,Wq=ei,sD=function(t,e,n,r){try{return r?e(Bq(n)[0],n[1]):e(n)}catch(i){Wq(t,"throw",i)}},jq=vn,Ka=function(t,e){var n=jq.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},Uq=Ct,aD=yn,zq=Dr,lD=bn,Yq=Zo,Gq=eE,Kq=sD,qq=ei,Xq=Ka,Zy=Xq("filter",TypeError),Jq=Gq(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=lD(aD(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,Kq(t,e,[o,this.counter++],!0))return o}});Uq({target:"Iterator",proto:!0,real:!0,forced:Zy},{filter:function(e){lD(this);try{zq(e)}catch(n){qq(this,"throw",n)}return Zy?aD(Zy,this,e):new Jq(Yq(this),{predicate:e})}});var Zq=Ct,Qq=yn,e4=fh,t4=Dr,n4=bn,r4=Zo,i4=ei,o4=Ka,Qy=o4("forEach",TypeError);Zq({target:"Iterator",proto:!0,real:!0,forced:Qy},{forEach:function(e){n4(this);try{t4(e)}catch(i){i4(this,"throw",i)}if(Qy)return Qq(Qy,this,e);var n=r4(this),r=0;e4(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var s4=Ct,uD=yn,a4=Dr,cD=bn,l4=Zo,u4=eE,c4=sD,h4=ei,d4=Ka,eC=d4("map",TypeError),f4=u4(function(){var t=this.iterator,e=cD(uD(this.next,t)),n=this.done=!!e.done;if(!n)return c4(t,this.mapper,[e.value,this.counter++],!0)});s4({target:"Iterator",proto:!0,real:!0,forced:eC},{map:function(e){cD(this);try{a4(e)}catch(n){h4(this,"throw",n)}return eC?uD(eC,this,e):new f4(l4(this),{mapper:e})}});var g4=dn,tE=g4([].slice),m4=TypeError,hD=function(t,e){if(t<e)throw new m4("Not enough arguments");return t},p4=Ev,w4=/(?:ipad|iphone|ipod).*applewebkit/i.test(p4),Ih=vn,v4=Ev,y4=Cu,Ug=function(t){return v4.slice(0,t.length)===t},dD=function(){return Ug("Bun/")?"BUN":Ug("Cloudflare-Workers")?"CLOUDFLARE":Ug("Deno/")?"DENO":Ug("Node.js/")?"NODE":Ih.Bun&&typeof Bun.version=="string"?"BUN":Ih.Deno&&typeof Deno.version=="object"?"DENO":y4(Ih.process)==="process"?"NODE":Ih.window&&Ih.document?"BROWSER":"REST"}(),C4=dD,b4=C4==="NODE",Xr=vn,S4=sg,R4=HN,Ex=Cn,E4=_i,fD=Nn,Tx=YN,T4=tE,Mx=B0,M4=hD,_4=w4,P4=b4,nR=Xr.setImmediate,rR=Xr.clearImmediate,x4=Xr.process,tC=Xr.Dispatch,I4=Xr.Function,_x=Xr.MessageChannel,O4=Xr.String,nC=0,zd={},Px="onreadystatechange",Ef,el,rC,iC;fD(function(){Ef=Xr.location});var nE=function(t){if(E4(zd,t)){var e=zd[t];delete zd[t],e()}},oC=function(t){return function(){nE(t)}},xx=function(t){nE(t.data)},Ix=function(t){Xr.postMessage(O4(t),Ef.protocol+"//"+Ef.host)};(!nR||!rR)&&(nR=function(e){M4(arguments.length,1);var n=Ex(e)?e:I4(e),r=T4(arguments,1);return zd[++nC]=function(){S4(n,void 0,r)},el(nC),nC},rR=function(e){delete zd[e]},P4?el=function(t){x4.nextTick(oC(t))}:tC&&tC.now?el=function(t){tC.now(oC(t))}:_x&&!_4?(rC=new _x,iC=rC.port2,rC.port1.onmessage=xx,el=R4(iC.postMessage,iC)):Xr.addEventListener&&Ex(Xr.postMessage)&&!Xr.importScripts&&Ef&&Ef.protocol!=="file:"&&!fD(Ix)?(el=Ix,Xr.addEventListener("message",xx,!1)):Px in Mx("script")?el=function(t){Tx.appendChild(Mx("script"))[Px]=function(){Tx.removeChild(this),nE(t)}}:el=function(t){setTimeout(oC(t),0)});var gD={set:nR,clear:rR},A4=Ct,H4=vn,Ox=gD.clear;A4({global:!0,bind:!0,enumerable:!0,forced:H4.clearImmediate!==Ox},{clearImmediate:Ox});var mD=vn,N4=sg,D4=Cn,k4=dD,$4=Ev,L4=tE,F4=hD,V4=mD.Function,B4=/MSIE .\./.test($4)||k4==="BUN"&&function(){var t=mD.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),W4=function(t,e){var n=e?2:1;return B4?function(r,i){var o=F4(arguments.length,1)>n,s=D4(r)?r:V4(r),a=o?L4(arguments,n):[],l=o?function(){N4(s,this,a)}:s;return e?t(l,i):t(l)}:t},j4=Ct,pD=vn,Ax=gD.set,U4=W4,Hx=pD.setImmediate?U4(Ax,!1):Ax;j4({global:!0,bind:!0,enumerable:!0,forced:pD.setImmediate!==Hx},{setImmediate:Hx});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:wD,setPrototypeOf:Nx,isFrozen:z4,getPrototypeOf:Y4,getOwnPropertyDescriptor:G4}=Object;let{freeze:hr,seal:Ri,create:vD}=Object,{apply:iR,construct:oR}=typeof Reflect<"u"&&Reflect;hr||(hr=function(e){return e});Ri||(Ri=function(e){return e});iR||(iR=function(e,n,r){return e.apply(n,r)});oR||(oR=function(e,n){return new e(...n)});const zg=dr(Array.prototype.forEach),K4=dr(Array.prototype.lastIndexOf),Dx=dr(Array.prototype.pop),Oh=dr(Array.prototype.push),q4=dr(Array.prototype.splice),Ap=dr(String.prototype.toLowerCase),sC=dr(String.prototype.toString),kx=dr(String.prototype.match),Ah=dr(String.prototype.replace),X4=dr(String.prototype.indexOf),J4=dr(String.prototype.trim),Wi=dr(Object.prototype.hasOwnProperty),tr=dr(RegExp.prototype.test),Hh=Z4(TypeError);function dr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return iR(t,e,r)}}function Z4(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return oR(t,n)}}function We(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ap;Nx&&Nx(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(z4(e)||(e[r]=o),i=o)}t[i]=!0}return t}function Q4(t){for(let e=0;e<t.length;e++)Wi(t,e)||(t[e]=null);return t}function Bl(t){const e=vD(null);for(const[n,r]of wD(t))Wi(t,n)&&(Array.isArray(r)?e[n]=Q4(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Bl(r):e[n]=r);return e}function Nh(t,e){for(;t!==null;){const r=G4(t,e);if(r){if(r.get)return dr(r.get);if(typeof r.value=="function")return dr(r.value)}t=Y4(t)}function n(){return null}return n}const $x=hr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),aC=hr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lC=hr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),eX=hr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uC=hr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),tX=hr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Lx=hr(["#text"]),Fx=hr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),cC=hr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Vx=hr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Yg=hr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),nX=Ri(/\{\{[\w\W]*|[\w\W]*\}\}/gm),rX=Ri(/<%[\w\W]*|[\w\W]*%>/gm),iX=Ri(/\$\{[\w\W]*/gm),oX=Ri(/^data-[\-\w.\u00B7-\uFFFF]+$/),sX=Ri(/^aria-[\-\w]+$/),yD=Ri(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),aX=Ri(/^(?:\w+script|data):/i),lX=Ri(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),CD=Ri(/^html$/i),uX=Ri(/^[a-z][.\w]*(-[.\w]+)+$/i);var Bx=Object.freeze({__proto__:null,ARIA_ATTR:sX,ATTR_WHITESPACE:lX,CUSTOM_ELEMENT:uX,DATA_ATTR:oX,DOCTYPE_NAME:CD,ERB_EXPR:rX,IS_ALLOWED_URI:yD,IS_SCRIPT_OR_DATA:aX,MUSTACHE_EXPR:nX,TMPLIT_EXPR:iX});const Dh={element:1,text:3,progressingInstruction:7,comment:8,document:9},cX=function(){return typeof window>"u"?null:window},hX=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Wx=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function bD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cX();const e=ye=>bD(ye);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==Dh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,v=Nh(g,"cloneNode"),y=Nh(g,"remove"),E=Nh(g,"nextSibling"),C=Nh(g,"childNodes"),M=Nh(g,"parentNode");if(typeof s=="function"){const ye=n.createElement("template");ye.content&&ye.content.ownerDocument&&(n=ye.content.ownerDocument)}let x,P="";const{implementation:T,createNodeIterator:O,createDocumentFragment:G,getElementsByTagName:U}=n,{importNode:V}=r;let X=Wx();e.isSupported=typeof wD=="function"&&typeof M=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:Q,TMPLIT_EXPR:te,DATA_ATTR:pe,ARIA_ATTR:et,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Ae,CUSTOM_ELEMENT:st}=Bx;let{IS_ALLOWED_URI:Pn}=Bx,at=null;const m=We({},[...$x,...aC,...lC,...uC,...Lx]);let w=null;const p=We({},[...Fx,...cC,...Vx,...Yg]);let A=Object.seal(vD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,j=null,K=!0,J=!0,b=!1,R=!0,S=!1,$=!0,I=!1,N=!1,W=!1,H=!1,D=!1,B=!1,F=!0,Y=!1;const ae="user-content-";let ce=!0,_e=!1,Fe={},ze=null;const Me=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ve=null;const _t=We({},["audio","video","img","source","image","track"]);let Ai=null;const rs=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ni="http://www.w3.org/1998/Math/MathML",Pt="http://www.w3.org/2000/svg",gn="http://www.w3.org/1999/xhtml";let bt=gn,xt=!1,Be=null;const ri=We({},[ni,Pt,gn],sC);let Ja=We({},["mi","mo","mn","ms","mtext"]),Za=We({},["annotation-xml"]);const VV=We({},["title","style","font","a","script"]);let Th=null;const BV=["application/xhtml+xml","text/html"],WV="text/html";let xn=null,Hu=null;const jV=n.createElement("form"),X_=function(k){return k instanceof RegExp||k instanceof Function},Ty=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Hu&&Hu===k)){if((!k||typeof k!="object")&&(k={}),k=Bl(k),Th=BV.indexOf(k.PARSER_MEDIA_TYPE)===-1?WV:k.PARSER_MEDIA_TYPE,xn=Th==="application/xhtml+xml"?sC:Ap,at=Wi(k,"ALLOWED_TAGS")?We({},k.ALLOWED_TAGS,xn):m,w=Wi(k,"ALLOWED_ATTR")?We({},k.ALLOWED_ATTR,xn):p,Be=Wi(k,"ALLOWED_NAMESPACES")?We({},k.ALLOWED_NAMESPACES,sC):ri,Ai=Wi(k,"ADD_URI_SAFE_ATTR")?We(Bl(rs),k.ADD_URI_SAFE_ATTR,xn):rs,Ve=Wi(k,"ADD_DATA_URI_TAGS")?We(Bl(_t),k.ADD_DATA_URI_TAGS,xn):_t,ze=Wi(k,"FORBID_CONTENTS")?We({},k.FORBID_CONTENTS,xn):Me,L=Wi(k,"FORBID_TAGS")?We({},k.FORBID_TAGS,xn):{},j=Wi(k,"FORBID_ATTR")?We({},k.FORBID_ATTR,xn):{},Fe=Wi(k,"USE_PROFILES")?k.USE_PROFILES:!1,K=k.ALLOW_ARIA_ATTR!==!1,J=k.ALLOW_DATA_ATTR!==!1,b=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=k.SAFE_FOR_TEMPLATES||!1,$=k.SAFE_FOR_XML!==!1,I=k.WHOLE_DOCUMENT||!1,H=k.RETURN_DOM||!1,D=k.RETURN_DOM_FRAGMENT||!1,B=k.RETURN_TRUSTED_TYPE||!1,W=k.FORCE_BODY||!1,F=k.SANITIZE_DOM!==!1,Y=k.SANITIZE_NAMED_PROPS||!1,ce=k.KEEP_CONTENT!==!1,_e=k.IN_PLACE||!1,Pn=k.ALLOWED_URI_REGEXP||yD,bt=k.NAMESPACE||gn,Ja=k.MATHML_TEXT_INTEGRATION_POINTS||Ja,Za=k.HTML_INTEGRATION_POINTS||Za,A=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&X_(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(A.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&X_(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(A.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(A.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(J=!1),D&&(H=!0),Fe&&(at=We({},Lx),w=[],Fe.html===!0&&(We(at,$x),We(w,Fx)),Fe.svg===!0&&(We(at,aC),We(w,cC),We(w,Yg)),Fe.svgFilters===!0&&(We(at,lC),We(w,cC),We(w,Yg)),Fe.mathMl===!0&&(We(at,uC),We(w,Vx),We(w,Yg))),k.ADD_TAGS&&(at===m&&(at=Bl(at)),We(at,k.ADD_TAGS,xn)),k.ADD_ATTR&&(w===p&&(w=Bl(w)),We(w,k.ADD_ATTR,xn)),k.ADD_URI_SAFE_ATTR&&We(Ai,k.ADD_URI_SAFE_ATTR,xn),k.FORBID_CONTENTS&&(ze===Me&&(ze=Bl(ze)),We(ze,k.FORBID_CONTENTS,xn)),ce&&(at["#text"]=!0),I&&We(at,["html","head","body"]),at.table&&(We(at,["tbody"]),delete L.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Hh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Hh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=k.TRUSTED_TYPES_POLICY,P=x.createHTML("")}else x===void 0&&(x=hX(f,i)),x!==null&&typeof P=="string"&&(P=x.createHTML(""));hr&&hr(k),Hu=k}},J_=We({},[...aC,...lC,...eX]),Z_=We({},[...uC,...tX]),UV=function(k){let re=M(k);(!re||!re.tagName)&&(re={namespaceURI:bt,tagName:"template"});const me=Ap(k.tagName),kt=Ap(re.tagName);return Be[k.namespaceURI]?k.namespaceURI===Pt?re.namespaceURI===gn?me==="svg":re.namespaceURI===ni?me==="svg"&&(kt==="annotation-xml"||Ja[kt]):!!J_[me]:k.namespaceURI===ni?re.namespaceURI===gn?me==="math":re.namespaceURI===Pt?me==="math"&&Za[kt]:!!Z_[me]:k.namespaceURI===gn?re.namespaceURI===Pt&&!Za[kt]||re.namespaceURI===ni&&!Ja[kt]?!1:!Z_[me]&&(VV[me]||!J_[me]):!!(Th==="application/xhtml+xml"&&Be[k.namespaceURI]):!1},uo=function(k){Oh(e.removed,{element:k});try{M(k).removeChild(k)}catch{y(k)}},Hg=function(k,re){try{Oh(e.removed,{attribute:re.getAttributeNode(k),from:re})}catch{Oh(e.removed,{attribute:null,from:re})}if(re.removeAttribute(k),k==="is")if(H||D)try{uo(re)}catch{}else try{re.setAttribute(k,"")}catch{}},Q_=function(k){let re=null,me=null;if(W)k="<remove></remove>"+k;else{const Dn=kx(k,/^[\r\n\t ]+/);me=Dn&&Dn[0]}Th==="application/xhtml+xml"&&bt===gn&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const kt=x?x.createHTML(k):k;if(bt===gn)try{re=new d().parseFromString(kt,Th)}catch{}if(!re||!re.documentElement){re=T.createDocument(bt,"template",null);try{re.documentElement.innerHTML=xt?P:kt}catch{}}const Vn=re.body||re.documentElement;return k&&me&&Vn.insertBefore(n.createTextNode(me),Vn.childNodes[0]||null),bt===gn?U.call(re,I?"html":"body")[0]:I?re.documentElement:Vn},eP=function(k){return O.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},My=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},tP=function(k){return typeof a=="function"&&k instanceof a};function is(ye,k,re){zg(ye,me=>{me.call(e,k,re,Hu)})}const nP=function(k){let re=null;if(is(X.beforeSanitizeElements,k,null),My(k))return uo(k),!0;const me=xn(k.nodeName);if(is(X.uponSanitizeElement,k,{tagName:me,allowedTags:at}),k.hasChildNodes()&&!tP(k.firstElementChild)&&tr(/<[/\w!]/g,k.innerHTML)&&tr(/<[/\w!]/g,k.textContent)||k.nodeType===Dh.progressingInstruction||$&&k.nodeType===Dh.comment&&tr(/<[/\w]/g,k.data))return uo(k),!0;if(!at[me]||L[me]){if(!L[me]&&iP(me)&&(A.tagNameCheck instanceof RegExp&&tr(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me)))return!1;if(ce&&!ze[me]){const kt=M(k)||k.parentNode,Vn=C(k)||k.childNodes;if(Vn&&kt){const Dn=Vn.length;for(let mr=Dn-1;mr>=0;--mr){const co=v(Vn[mr],!0);co.__removalCount=(k.__removalCount||0)+1,kt.insertBefore(co,E(k))}}}return uo(k),!0}return k instanceof l&&!UV(k)||(me==="noscript"||me==="noembed"||me==="noframes")&&tr(/<\/no(script|embed|frames)/i,k.innerHTML)?(uo(k),!0):(S&&k.nodeType===Dh.text&&(re=k.textContent,zg([ne,Q,te],kt=>{re=Ah(re,kt," ")}),k.textContent!==re&&(Oh(e.removed,{element:k.cloneNode()}),k.textContent=re)),is(X.afterSanitizeElements,k,null),!1)},rP=function(k,re,me){if(F&&(re==="id"||re==="name")&&(me in n||me in jV))return!1;if(!(J&&!j[re]&&tr(pe,re))){if(!(K&&tr(et,re))){if(!w[re]||j[re]){if(!(iP(k)&&(A.tagNameCheck instanceof RegExp&&tr(A.tagNameCheck,k)||A.tagNameCheck instanceof Function&&A.tagNameCheck(k))&&(A.attributeNameCheck instanceof RegExp&&tr(A.attributeNameCheck,re)||A.attributeNameCheck instanceof Function&&A.attributeNameCheck(re))||re==="is"&&A.allowCustomizedBuiltInElements&&(A.tagNameCheck instanceof RegExp&&tr(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me))))return!1}else if(!Ai[re]){if(!tr(Pn,Ah(me,Ae,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&k!=="script"&&X4(me,"data:")===0&&Ve[k])){if(!(b&&!tr(Re,Ah(me,Ae,"")))){if(me)return!1}}}}}}return!0},iP=function(k){return k!=="annotation-xml"&&kx(k,st)},oP=function(k){is(X.beforeSanitizeAttributes,k,null);const{attributes:re}=k;if(!re||My(k))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w,forceKeepAttr:void 0};let kt=re.length;for(;kt--;){const Vn=re[kt],{name:Dn,namespaceURI:mr,value:co}=Vn,Mh=xn(Dn);let er=Dn==="value"?co:J4(co);if(me.attrName=Mh,me.attrValue=er,me.keepAttr=!0,me.forceKeepAttr=void 0,is(X.uponSanitizeAttribute,k,me),er=me.attrValue,Y&&(Mh==="id"||Mh==="name")&&(Hg(Dn,k),er=ae+er),$&&tr(/((--!?|])>)|<\/(style|title)/i,er)){Hg(Dn,k);continue}if(me.forceKeepAttr||(Hg(Dn,k),!me.keepAttr))continue;if(!R&&tr(/\/>/i,er)){Hg(Dn,k);continue}S&&zg([ne,Q,te],aP=>{er=Ah(er,aP," ")});const sP=xn(k.nodeName);if(rP(sP,Mh,er)){if(x&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!mr)switch(f.getAttributeType(sP,Mh)){case"TrustedHTML":{er=x.createHTML(er);break}case"TrustedScriptURL":{er=x.createScriptURL(er);break}}try{mr?k.setAttributeNS(mr,Dn,er):k.setAttribute(Dn,er),My(k)?uo(k):Dx(e.removed)}catch{}}}is(X.afterSanitizeAttributes,k,null)},zV=function ye(k){let re=null;const me=eP(k);for(is(X.beforeSanitizeShadowDOM,k,null);re=me.nextNode();)is(X.uponSanitizeShadowNode,re,null),nP(re),oP(re),re.content instanceof o&&ye(re.content);is(X.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(ye){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,me=null,kt=null,Vn=null;if(xt=!ye,xt&&(ye="<!-->"),typeof ye!="string"&&!tP(ye))if(typeof ye.toString=="function"){if(ye=ye.toString(),typeof ye!="string")throw Hh("dirty is not a string, aborting")}else throw Hh("toString is not a function");if(!e.isSupported)return ye;if(N||Ty(k),e.removed=[],typeof ye=="string"&&(_e=!1),_e){if(ye.nodeName){const co=xn(ye.nodeName);if(!at[co]||L[co])throw Hh("root node is forbidden and cannot be sanitized in-place")}}else if(ye instanceof a)re=Q_("<!---->"),me=re.ownerDocument.importNode(ye,!0),me.nodeType===Dh.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?re=me:re.appendChild(me);else{if(!H&&!S&&!I&&ye.indexOf("<")===-1)return x&&B?x.createHTML(ye):ye;if(re=Q_(ye),!re)return H?null:B?P:""}re&&W&&uo(re.firstChild);const Dn=eP(_e?ye:re);for(;kt=Dn.nextNode();)nP(kt),oP(kt),kt.content instanceof o&&zV(kt.content);if(_e)return ye;if(H){if(D)for(Vn=G.call(re.ownerDocument);re.firstChild;)Vn.appendChild(re.firstChild);else Vn=re;return(w.shadowroot||w.shadowrootmode)&&(Vn=V.call(r,Vn,!0)),Vn}let mr=I?re.outerHTML:re.innerHTML;return I&&at["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&tr(CD,re.ownerDocument.doctype.name)&&(mr="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+mr),S&&zg([ne,Q,te],co=>{mr=Ah(mr,co," ")}),x&&B?x.createHTML(mr):mr},e.setConfig=function(){let ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ty(ye),N=!0},e.clearConfig=function(){Hu=null,N=!1},e.isValidAttribute=function(ye,k,re){Hu||Ty({});const me=xn(ye),kt=xn(k);return rP(me,kt,re)},e.addHook=function(ye,k){typeof k=="function"&&Oh(X[ye],k)},e.removeHook=function(ye,k){if(k!==void 0){const re=K4(X[ye],k);return re===-1?void 0:q4(X[ye],re,1)[0]}return Dx(X[ye])},e.removeHooks=function(ye){X[ye]=[]},e.removeAllHooks=function(){X=Wx()},e}var dX=bD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var SD;function Z(){return SD.apply(null,arguments)}function fX(t){SD=t}function ro(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ru(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function it(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function rE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(it(t,e))return!1;return!0}function Tr(t){return t===void 0}function Bs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function ug(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function RD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Pa(t,e){for(var n in e)it(e,n)&&(t[n]=e[n]);return it(e,"toString")&&(t.toString=e.toString),it(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Qo(t,e,n,r){return YD(t,e,n,r,!0).utc()}function gX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ne(t){return t._pf==null&&(t._pf=gX()),t._pf}var sR;Array.prototype.some?sR=Array.prototype.some:sR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function iE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ne(t),n=sR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function _v(t){var e=Qo(NaN);return t!=null?Pa(Ne(e),t):Ne(e).userInvalidated=!0,e}var jx=Z.momentProperties=[],hC=!1;function oE(t,e){var n,r,i,o=jx.length;if(Tr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Tr(e._i)||(t._i=e._i),Tr(e._f)||(t._f=e._f),Tr(e._l)||(t._l=e._l),Tr(e._strict)||(t._strict=e._strict),Tr(e._tzm)||(t._tzm=e._tzm),Tr(e._isUTC)||(t._isUTC=e._isUTC),Tr(e._offset)||(t._offset=e._offset),Tr(e._pf)||(t._pf=Ne(e)),Tr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=jx[n],i=e[r],Tr(i)||(t[r]=i);return t}function cg(t){oE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),hC===!1&&(hC=!0,Z.updateOffset(this),hC=!1)}function io(t){return t instanceof cg||t!=null&&t._isAMomentObject!=null}function ED(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Pi(t,e){var n=!0;return Pa(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])it(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}ED(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Ux={};function TD(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),Ux[t]||(ED(e),Ux[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function es(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function mX(t){var e,n;for(n in t)it(t,n)&&(e=t[n],es(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function aR(t,e){var n=Pa({},t),r;for(r in e)it(e,r)&&(ru(t[r])&&ru(e[r])?(n[r]={},Pa(n[r],t[r]),Pa(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)it(t,r)&&!it(e,r)&&ru(t[r])&&(n[r]=Pa({},n[r]));return n}function sE(t){t!=null&&this.set(t)}var lR;Object.keys?lR=Object.keys:lR=function(t){var e,n=[];for(e in t)it(t,e)&&n.push(e);return n};var pX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function wX(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return es(r)?r.call(e,n):r}function Ko(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var aE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Gg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,dC={},Fc={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Fc[t]=i),e&&(Fc[e[0]]=function(){return Ko(i.apply(this,arguments),e[1],e[2])}),n&&(Fc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function vX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function yX(t){var e=t.match(aE),n,r;for(n=0,r=e.length;n<r;n++)Fc[e[n]]?e[n]=Fc[e[n]]:e[n]=vX(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=es(e[s])?e[s].call(i,t):e[s];return o}}function Hp(t,e){return t.isValid()?(e=MD(e,t.localeData()),dC[e]=dC[e]||yX(e),dC[e](t)):t.localeData().invalidDate()}function MD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Gg.lastIndex=0;n>=0&&Gg.test(t);)t=t.replace(Gg,r),Gg.lastIndex=0,n-=1;return t}var CX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function bX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(aE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var SX="Invalid date";function RX(){return this._invalidDate}var EX="%d",TX=/\d{1,2}/;function MX(t){return this._ordinal.replace("%d",t)}var _X={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function PX(t,e,n,r){var i=this._relativeTime[n];return es(i)?i(t,e,n,r):i.replace(/%d/i,t)}function xX(t,e){var n=this._relativeTime[t>0?"future":"past"];return es(n)?n(e):n.replace(/%s/i,e)}var zx={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function xi(t){return typeof t=="string"?zx[t]||zx[t.toLowerCase()]:void 0}function lE(t){var e={},n,r;for(r in t)it(t,r)&&(n=xi(r),n&&(e[n]=t[r]));return e}var IX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function OX(t){var e=[],n;for(n in t)it(t,n)&&e.push({unit:n,priority:IX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var _D=/\d/,ti=/\d\d/,PD=/\d{3}/,uE=/\d{4}/,Pv=/[+-]?\d{6}/,Dt=/\d\d?/,xD=/\d\d\d\d?/,ID=/\d\d\d\d\d\d?/,xv=/\d{1,3}/,cE=/\d{1,4}/,Iv=/[+-]?\d{1,6}/,gh=/\d+/,Ov=/[+-]?\d+/,AX=/Z|[+-]\d\d:?\d\d/gi,Av=/Z|[+-]\d\d(?::?\d\d)?/gi,HX=/[+-]?\d+(\.\d{1,3})?/,hg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,mh=/^[1-9]\d?/,hE=/^([1-9]\d|\d)/,Cw;Cw={};function ue(t,e,n){Cw[t]=es(e)?e:function(r,i){return r&&n?n:e}}function NX(t,e){return it(Cw,t)?Cw[t](e._strict,e._locale):new RegExp(DX(t))}function DX(t){return Fs(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Fs(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function wi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ge(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=wi(e)),n}var uR={};function vt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Bs(e)&&(r=function(o,s){s[e]=Ge(o)}),i=t.length,n=0;n<i;n++)uR[t[n]]=r}function dg(t,e){vt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function kX(t,e,n){e!=null&&it(uR,t)&&uR[t](e,n._a,n,t)}function Hv(t){return t%4===0&&t%100!==0||t%400===0}var Xn=0,Os=1,Lo=2,Mn=3,eo=4,As=5,ql=6,$X=7,LX=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?Ko(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ue("Y",Ov);ue("YY",Dt,ti);ue("YYYY",cE,uE);ue("YYYYY",Iv,Pv);ue("YYYYYY",Iv,Pv);vt(["YYYYY","YYYYYY"],Xn);vt("YYYY",function(t,e){e[Xn]=t.length===2?Z.parseTwoDigitYear(t):Ge(t)});vt("YY",function(t,e){e[Xn]=Z.parseTwoDigitYear(t)});vt("Y",function(t,e){e[Xn]=parseInt(t,10)});function Yd(t){return Hv(t)?366:365}Z.parseTwoDigitYear=function(t){return Ge(t)+(Ge(t)>68?1900:2e3)};var OD=ph("FullYear",!0);function FX(){return Hv(this.year())}function ph(t,e){return function(n){return n!=null?(AD(this,t,n),Z.updateOffset(this,e),this):Tf(this,t)}}function Tf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function AD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Hv(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function VX(t){return t=xi(t),es(this[t])?this[t]():this}function BX(t,e){if(typeof t=="object"){t=lE(t);var n=OX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=xi(t),es(this[t]))return this[t](e);return this}function WX(t,e){return(t%e+e)%e}var an;Array.prototype.indexOf?an=Array.prototype.indexOf:an=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function dE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=WX(e,12);return t+=(e-n)/12,n===1?Hv(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Dt,mh);ue("MM",Dt,ti);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});vt(["M","MM"],function(t,e){e[Os]=Ge(t)-1});vt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Os]=i:Ne(n).invalidMonth=t});var jX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),HD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ND=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,UX=hg,zX=hg;function YX(t,e){return t?ro(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||ND).test(e)?"format":"standalone"][t.month()]:ro(this._months)?this._months:this._months.standalone}function GX(t,e){return t?ro(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[ND.test(e)?"format":"standalone"][t.month()]:ro(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function KX(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Qo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=an.call(this._shortMonthsParse,s),i!==-1?i:null):(i=an.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=an.call(this._shortMonthsParse,s),i!==-1?i:(i=an.call(this._longMonthsParse,s),i!==-1?i:null)):(i=an.call(this._longMonthsParse,s),i!==-1?i:(i=an.call(this._shortMonthsParse,s),i!==-1?i:null))}function qX(t,e,n){var r,i,o;if(this._monthsParseExact)return KX.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Qo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function DD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ge(e);else if(e=t.localeData().monthsParse(e),!Bs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,dE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function kD(t){return t!=null?(DD(this,t),Z.updateOffset(this,!0),this):Tf(this,"Month")}function XX(){return dE(this.year(),this.month())}function JX(t){return this._monthsParseExact?(it(this,"_monthsRegex")||$D.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=UX),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function ZX(t){return this._monthsParseExact?(it(this,"_monthsRegex")||$D.call(this),t?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=zX),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function $D(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Qo([2e3,i]),s=Fs(this.monthsShort(o,"")),a=Fs(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function QX(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Mf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function bw(t,e,n){var r=7+e-n,i=(7+Mf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function LD(t,e,n,r,i){var o=(7+n-r)%7,s=bw(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Yd(l)+a):a>Yd(t)?(l=t+1,u=a-Yd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function _f(t,e,n){var r=bw(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Vs(s,e,n)):i>Vs(t.year(),e,n)?(o=i-Vs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Vs(t,e,n){var r=bw(t,e,n),i=bw(t+1,e,n);return(Yd(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ue("w",Dt,mh);ue("ww",Dt,ti);ue("W",Dt,mh);ue("WW",Dt,ti);dg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Ge(t)});function e6(t){return _f(t,this._week.dow,this._week.doy).week}var t6={dow:0,doy:6};function n6(){return this._week.dow}function r6(){return this._week.doy}function i6(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function o6(t){var e=_f(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ue("d",Dt);ue("e",Dt);ue("E",Dt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});dg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ne(n).invalidWeekday=t});dg(["d","e","E"],function(t,e,n,r){e[r]=Ge(t)});function s6(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function a6(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function fE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var l6="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),FD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),u6="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),c6=hg,h6=hg,d6=hg;function f6(t,e){var n=ro(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?fE(n,this._week.dow):t?n[t.day()]:n}function g6(t){return t===!0?fE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function m6(t){return t===!0?fE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function p6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Qo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=an.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=an.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=an.call(this._weekdaysParse,s),i!==-1||(i=an.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=an.call(this._shortWeekdaysParse,s),i!==-1||(i=an.call(this._weekdaysParse,s),i!==-1)?i:(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=an.call(this._minWeekdaysParse,s),i!==-1||(i=an.call(this._weekdaysParse,s),i!==-1)?i:(i=an.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function w6(t,e,n){var r,i,o;if(this._weekdaysParseExact)return p6.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Qo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function v6(t){if(!this.isValid())return t!=null?this:NaN;var e=Tf(this,"Day");return t!=null?(t=s6(t,this.localeData()),this.add(t-e,"d")):e}function y6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function C6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=a6(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function b6(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||gE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=c6),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function S6(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||gE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=h6),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function R6(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||gE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=d6),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function gE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Qo([2e3,1]).day(o),a=Fs(this.weekdaysMin(s,"")),l=Fs(this.weekdaysShort(s,"")),u=Fs(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function mE(){return this.hours()%12||12}function E6(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,mE);Ce("k",["kk",2],0,E6);Ce("hmm",0,0,function(){return""+mE.apply(this)+Ko(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+mE.apply(this)+Ko(this.minutes(),2)+Ko(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+Ko(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+Ko(this.minutes(),2)+Ko(this.seconds(),2)});function VD(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}VD("a",!0);VD("A",!1);function BD(t,e){return e._meridiemParse}ue("a",BD);ue("A",BD);ue("H",Dt,hE);ue("h",Dt,mh);ue("k",Dt,mh);ue("HH",Dt,ti);ue("hh",Dt,ti);ue("kk",Dt,ti);ue("hmm",xD);ue("hmmss",ID);ue("Hmm",xD);ue("Hmmss",ID);vt(["H","HH"],Mn);vt(["k","kk"],function(t,e,n){var r=Ge(t);e[Mn]=r===24?0:r});vt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});vt(["h","hh"],function(t,e,n){e[Mn]=Ge(t),Ne(n).bigHour=!0});vt("hmm",function(t,e,n){var r=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[eo]=Ge(t.substr(r)),Ne(n).bigHour=!0});vt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[eo]=Ge(t.substr(r,2)),e[As]=Ge(t.substr(i)),Ne(n).bigHour=!0});vt("Hmm",function(t,e,n){var r=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[eo]=Ge(t.substr(r))});vt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[eo]=Ge(t.substr(r,2)),e[As]=Ge(t.substr(i))});function T6(t){return(t+"").toLowerCase().charAt(0)==="p"}var M6=/[ap]\.?m?\.?/i,_6=ph("Hours",!0);function P6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var WD={calendar:pX,longDateFormat:CX,invalidDate:SX,ordinal:EX,dayOfMonthOrdinalParse:TX,relativeTime:_X,months:jX,monthsShort:HD,week:t6,weekdays:l6,weekdaysMin:u6,weekdaysShort:FD,meridiemParse:M6},$t={},kh={},Pf;function x6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function Yx(t){return t&&t.toLowerCase().replace("_","-")}function I6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=Yx(t[e]).split("-"),n=o.length,r=Yx(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Nv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&x6(o,r)>=n-1)break;n--}e++}return Pf}function O6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Nv(t){var e=null,n;if($t[t]===void 0&&typeof nw<"u"&&nw&&nw.exports&&O6(t))try{e=Pf._abbr,n=require,n("./locale/"+t),Da(e)}catch{$t[t]=null}return $t[t]}function Da(t,e){var n;return t&&(Tr(e)?n=Gs(t):n=pE(t,e),n?Pf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Pf._abbr}function pE(t,e){if(e!==null){var n,r=WD;if(e.abbr=t,$t[t]!=null)TD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=$t[t]._config;else if(e.parentLocale!=null)if($t[e.parentLocale]!=null)r=$t[e.parentLocale]._config;else if(n=Nv(e.parentLocale),n!=null)r=n._config;else return kh[e.parentLocale]||(kh[e.parentLocale]=[]),kh[e.parentLocale].push({name:t,config:e}),null;return $t[t]=new sE(aR(r,e)),kh[t]&&kh[t].forEach(function(i){pE(i.name,i.config)}),Da(t),$t[t]}else return delete $t[t],null}function A6(t,e){if(e!=null){var n,r,i=WD;$t[t]!=null&&$t[t].parentLocale!=null?$t[t].set(aR($t[t]._config,e)):(r=Nv(t),r!=null&&(i=r._config),e=aR(i,e),r==null&&(e.abbr=t),n=new sE(e),n.parentLocale=$t[t],$t[t]=n),Da(t)}else $t[t]!=null&&($t[t].parentLocale!=null?($t[t]=$t[t].parentLocale,t===Da()&&Da(t)):$t[t]!=null&&delete $t[t]);return $t[t]}function Gs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Pf;if(!ro(t)){if(e=Nv(t),e)return e;t=[t]}return I6(t)}function H6(){return lR($t)}function wE(t){var e,n=t._a;return n&&Ne(t).overflow===-2&&(e=n[Os]<0||n[Os]>11?Os:n[Lo]<1||n[Lo]>dE(n[Xn],n[Os])?Lo:n[Mn]<0||n[Mn]>24||n[Mn]===24&&(n[eo]!==0||n[As]!==0||n[ql]!==0)?Mn:n[eo]<0||n[eo]>59?eo:n[As]<0||n[As]>59?As:n[ql]<0||n[ql]>999?ql:-1,Ne(t)._overflowDayOfYear&&(e<Xn||e>Lo)&&(e=Lo),Ne(t)._overflowWeeks&&e===-1&&(e=$X),Ne(t)._overflowWeekday&&e===-1&&(e=LX),Ne(t).overflow=e),t}var N6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,D6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,k6=/Z|[+-]\d\d(?::?\d\d)?/,Kg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],fC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],$6=/^\/?Date\((-?\d+)/i,L6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,F6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function jD(t){var e,n,r=t._i,i=N6.exec(r)||D6.exec(r),o,s,a,l,u=Kg.length,c=fC.length;if(i){for(Ne(t).iso=!0,e=0,n=u;e<n;e++)if(Kg[e][1].exec(i[1])){s=Kg[e][0],o=Kg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(fC[e][1].exec(i[3])){a=(i[2]||" ")+fC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(k6.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),yE(t)}else t._isValid=!1}function V6(t,e,n,r,i,o){var s=[B6(t),HD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function B6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function W6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function j6(t,e,n){if(t){var r=FD.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ne(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function U6(t,e,n){if(t)return F6[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function UD(t){var e=L6.exec(W6(t._i)),n;if(e){if(n=V6(e[4],e[3],e[2],e[5],e[6],e[7]),!j6(e[1],n,t))return;t._a=n,t._tzm=U6(e[8],e[9],e[10]),t._d=Mf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ne(t).rfc2822=!0}else t._isValid=!1}function z6(t){var e=$6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(jD(t),t._isValid===!1)delete t._isValid;else return;if(UD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=Pi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function yc(t,e,n){return t??e??n}function Y6(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function vE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=Y6(t),t._w&&t._a[Lo]==null&&t._a[Os]==null&&G6(t),t._dayOfYear!=null&&(s=yc(t._a[Xn],i[Xn]),(t._dayOfYear>Yd(s)||t._dayOfYear===0)&&(Ne(t)._overflowDayOfYear=!0),n=Mf(s,0,t._dayOfYear),t._a[Os]=n.getUTCMonth(),t._a[Lo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Mn]===24&&t._a[eo]===0&&t._a[As]===0&&t._a[ql]===0&&(t._nextDay=!0,t._a[Mn]=0),t._d=(t._useUTC?Mf:QX).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Mn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ne(t).weekdayMismatch=!0)}}function G6(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=yc(e.GG,t._a[Xn],_f(Nt(),1,4).year),r=yc(e.W,1),i=yc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=_f(Nt(),o,s),n=yc(e.gg,t._a[Xn],u.year),r=yc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Vs(n,o,s)?Ne(t)._overflowWeeks=!0:l!=null?Ne(t)._overflowWeekday=!0:(a=LD(n,r,i,o,s),t._a[Xn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function yE(t){if(t._f===Z.ISO_8601){jD(t);return}if(t._f===Z.RFC_2822){UD(t);return}t._a=[],Ne(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=MD(t._f,t._locale).match(aE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(NX(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ne(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Fc[o]?(r?Ne(t).empty=!1:Ne(t).unusedTokens.push(o),kX(o,r,t)):t._strict&&!r&&Ne(t).unusedTokens.push(o);Ne(t).charsLeftOver=a-l,e.length>0&&Ne(t).unusedInput.push(e),t._a[Mn]<=12&&Ne(t).bigHour===!0&&t._a[Mn]>0&&(Ne(t).bigHour=void 0),Ne(t).parsedDateParts=t._a.slice(0),Ne(t).meridiem=t._meridiem,t._a[Mn]=K6(t._locale,t._a[Mn],t._meridiem),u=Ne(t).era,u!==null&&(t._a[Xn]=t._locale.erasConvertYear(u,t._a[Xn])),vE(t),wE(t)}function K6(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function q6(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ne(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=oE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],yE(e),iE(e)&&(s=!0),o+=Ne(e).charsLeftOver,o+=Ne(e).unusedTokens.length*10,Ne(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Pa(t,n||e)}function X6(t){if(!t._d){var e=lE(t._i),n=e.day===void 0?e.date:e.day;t._a=RD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),vE(t)}}function J6(t){var e=new cg(wE(zD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function zD(t){var e=t._i,n=t._f;return t._locale=t._locale||Gs(t._l),e===null||n===void 0&&e===""?_v({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),io(e)?new cg(wE(e)):(ug(e)?t._d=e:ro(n)?q6(t):n?yE(t):Z6(t),iE(t)||(t._d=null),t))}function Z6(t){var e=t._i;Tr(e)?t._d=new Date(Z.now()):ug(e)?t._d=new Date(e.valueOf()):typeof e=="string"?z6(t):ro(e)?(t._a=RD(e.slice(0),function(n){return parseInt(n,10)}),vE(t)):ru(e)?X6(t):Bs(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function YD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ru(t)&&rE(t)||ro(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,J6(o)}function Nt(t,e,n,r){return YD(t,e,n,r,!1)}var Q6=Pi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Nt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:_v()}),e7=Pi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Nt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:_v()});function GD(t,e){var n,r;if(e.length===1&&ro(e[0])&&(e=e[0]),!e.length)return Nt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function t7(){var t=[].slice.call(arguments,0);return GD("isBefore",t)}function n7(){var t=[].slice.call(arguments,0);return GD("isAfter",t)}var r7=function(){return Date.now?Date.now():+new Date},$h=["year","quarter","month","week","day","hour","minute","second","millisecond"];function i7(t){var e,n=!1,r,i=$h.length;for(e in t)if(it(t,e)&&!(an.call($h,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[$h[r]]){if(n)return!1;parseFloat(t[$h[r]])!==Ge(t[$h[r]])&&(n=!0)}return!0}function o7(){return this._isValid}function s7(){return ao(NaN)}function Dv(t){var e=lE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=i7(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Gs(),this._bubble()}function Np(t){return t instanceof Dv}function cR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function a7(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Ge(t[s])!==Ge(e[s])&&o++;return o+i}function KD(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Ko(~~(n/60),2)+e+Ko(~~n%60,2)})}KD("Z",":");KD("ZZ","");ue("Z",Av);ue("ZZ",Av);vt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=CE(Av,t)});var l7=/([\+\-]|\d\d)/gi;function CE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(l7)||["-",0,0],o=+(i[1]*60)+Ge(i[2]),o===0?0:i[0]==="+"?o:-o)}function bE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(io(t)||ug(t)?t.valueOf():Nt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Nt(t).local()}function hR(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function u7(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=CE(Av,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=hR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?JD(this,ao(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:hR(this)}function c7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function h7(t){return this.utcOffset(0,t)}function d7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(hR(this),"m")),this}function f7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=CE(AX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function g7(t){return this.isValid()?(t=t?Nt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function m7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function p7(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return oE(t,this),t=zD(t),t._a?(e=t._isUTC?Qo(t._a):Nt(t._a),this._isDSTShifted=this.isValid()&&a7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function w7(){return this.isValid()?!this._isUTC:!1}function v7(){return this.isValid()?this._isUTC:!1}function qD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var y7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,C7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ao(t,e){var n=t,r=null,i,o,s;return Np(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Bs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=y7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Ge(r[Lo])*i,h:Ge(r[Mn])*i,m:Ge(r[eo])*i,s:Ge(r[As])*i,ms:Ge(cR(r[ql]*1e3))*i}):(r=C7.exec(t))?(i=r[1]==="-"?-1:1,n={y:tl(r[2],i),M:tl(r[3],i),w:tl(r[4],i),d:tl(r[5],i),h:tl(r[6],i),m:tl(r[7],i),s:tl(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=b7(Nt(n.from),Nt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Dv(n),Np(t)&&it(t,"_locale")&&(o._locale=t._locale),Np(t)&&it(t,"_isValid")&&(o._isValid=t._isValid),o}ao.fn=Dv.prototype;ao.invalid=s7;function tl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Gx(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function b7(t,e){var n;return t.isValid()&&e.isValid()?(e=bE(e,t),t.isBefore(e)?n=Gx(t,e):(n=Gx(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function XD(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(TD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ao(n,r),JD(this,i,t),this}}function JD(t,e,n,r){var i=e._milliseconds,o=cR(e._days),s=cR(e._months);t.isValid()&&(r=r??!0,s&&DD(t,Tf(t,"Month")+s*n),o&&AD(t,"Date",Tf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var S7=XD(1,"add"),R7=XD(-1,"subtract");function ZD(t){return typeof t=="string"||t instanceof String}function E7(t){return io(t)||ug(t)||ZD(t)||Bs(t)||M7(t)||T7(t)||t===null||t===void 0}function T7(t){var e=ru(t)&&!rE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||it(t,o);return e&&n}function M7(t){var e=ro(t),n=!1;return e&&(n=t.filter(function(r){return!Bs(r)&&ZD(t)}).length===0),e&&n}function _7(t){var e=ru(t)&&!rE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||it(t,o);return e&&n}function P7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function x7(t,e){arguments.length===1&&(arguments[0]?E7(arguments[0])?(t=arguments[0],e=void 0):_7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Nt(),r=bE(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(es(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Nt(n)))}function I7(){return new cg(this)}function O7(t,e){var n=io(t)?t:Nt(t);return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function A7(t,e){var n=io(t)?t:Nt(t);return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function H7(t,e,n,r){var i=io(t)?t:Nt(t),o=io(e)?e:Nt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function N7(t,e){var n=io(t)?t:Nt(t),r;return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function D7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function k7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function $7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=bE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=xi(e),e){case"year":o=Dp(this,r)/12;break;case"month":o=Dp(this,r);break;case"quarter":o=Dp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:wi(o)}function Dp(t,e){if(t.date()<e.date())return-Dp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function L7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function F7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Hp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):es(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Hp(n,"Z")):Hp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function V7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function B7(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Hp(this,t);return this.localeData().postformat(e)}function W7(t,e){return this.isValid()&&(io(t)&&t.isValid()||Nt(t).isValid())?ao({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function j7(t){return this.from(Nt(),t)}function U7(t,e){return this.isValid()&&(io(t)&&t.isValid()||Nt(t).isValid())?ao({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function z7(t){return this.to(Nt(),t)}function QD(t){var e;return t===void 0?this._locale._abbr:(e=Gs(t),e!=null&&(this._locale=e),this)}var ek=Pi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function tk(){return this._locale}var Sw=1e3,Vc=60*Sw,Rw=60*Vc,nk=(365*400+97)*24*Rw;function Bc(t,e){return(t%e+e)%e}function rk(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-nk:new Date(t,e,n).valueOf()}function ik(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-nk:Date.UTC(t,e,n)}function Y7(t){var e,n;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?ik:rk,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Bc(e+(this._isUTC?0:this.utcOffset()*Vc),Rw);break;case"minute":e=this._d.valueOf(),e-=Bc(e,Vc);break;case"second":e=this._d.valueOf(),e-=Bc(e,Sw);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function G7(t){var e,n;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?ik:rk,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Rw-Bc(e+(this._isUTC?0:this.utcOffset()*Vc),Rw)-1;break;case"minute":e=this._d.valueOf(),e+=Vc-Bc(e,Vc)-1;break;case"second":e=this._d.valueOf(),e+=Sw-Bc(e,Sw)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function K7(){return this._d.valueOf()-(this._offset||0)*6e4}function q7(){return Math.floor(this.valueOf()/1e3)}function X7(){return new Date(this.valueOf())}function J7(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Z7(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Q7(){return this.isValid()?this.toISOString():null}function e9(){return iE(this)}function t9(){return Pa({},Ne(this))}function n9(){return Ne(this).overflow}function r9(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ue("N",SE);ue("NN",SE);ue("NNN",SE);ue("NNNN",g9);ue("NNNNN",m9);vt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ne(n).era=i:Ne(n).invalidEra=t});ue("y",gh);ue("yy",gh);ue("yyy",gh);ue("yyyy",gh);ue("yo",p9);vt(["y","yy","yyy","yyyy"],Xn);vt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Xn]=n._locale.eraYearOrdinalParse(t,i):e[Xn]=parseInt(t,10)});function i9(t,e){var n,r,i,o=this._eras||Gs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function o9(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function s9(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function a9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function l9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function u9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function c9(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function h9(t){return it(this,"_erasNameRegex")||RE.call(this),t?this._erasNameRegex:this._erasRegex}function d9(t){return it(this,"_erasAbbrRegex")||RE.call(this),t?this._erasAbbrRegex:this._erasRegex}function f9(t){return it(this,"_erasNarrowRegex")||RE.call(this),t?this._erasNarrowRegex:this._erasRegex}function SE(t,e){return e.erasAbbrRegex(t)}function g9(t,e){return e.erasNameRegex(t)}function m9(t,e){return e.erasNarrowRegex(t)}function p9(t,e){return e._eraYearOrdinalRegex||gh}function RE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Fs(u[i].name),a=Fs(u[i].abbr),l=Fs(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function kv(t,e){Ce(0,[t,t.length],0,e)}kv("gggg","weekYear");kv("ggggg","weekYear");kv("GGGG","isoWeekYear");kv("GGGGG","isoWeekYear");ue("G",Ov);ue("g",Ov);ue("GG",Dt,ti);ue("gg",Dt,ti);ue("GGGG",cE,uE);ue("gggg",cE,uE);ue("GGGGG",Iv,Pv);ue("ggggg",Iv,Pv);dg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Ge(t)});dg(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function w9(t){return ok.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function v9(t){return ok.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function y9(){return Vs(this.year(),1,4)}function C9(){return Vs(this.isoWeekYear(),1,4)}function b9(){var t=this.localeData()._week;return Vs(this.year(),t.dow,t.doy)}function S9(){var t=this.localeData()._week;return Vs(this.weekYear(),t.dow,t.doy)}function ok(t,e,n,r,i){var o;return t==null?_f(this,r,i).year:(o=Vs(t,r,i),e>o&&(e=o),R9.call(this,t,e,n,r,i))}function R9(t,e,n,r,i){var o=LD(t,e,n,r,i),s=Mf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ue("Q",_D);vt("Q",function(t,e){e[Os]=(Ge(t)-1)*3});function E9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ue("D",Dt,mh);ue("DD",Dt,ti);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});vt(["D","DD"],Lo);vt("Do",function(t,e){e[Lo]=Ge(t.match(Dt)[0])});var sk=ph("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",xv);ue("DDDD",PD);vt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ge(t)});function T9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ue("m",Dt,hE);ue("mm",Dt,ti);vt(["m","mm"],eo);var M9=ph("Minutes",!1);Ce("s",["ss",2],0,"second");ue("s",Dt,hE);ue("ss",Dt,ti);vt(["s","ss"],As);var _9=ph("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",xv,_D);ue("SS",xv,ti);ue("SSS",xv,PD);var xa,ak;for(xa="SSSS";xa.length<=9;xa+="S")ue(xa,gh);function P9(t,e){e[ql]=Ge(("0."+t)*1e3)}for(xa="S";xa.length<=9;xa+="S")vt(xa,P9);ak=ph("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function x9(){return this._isUTC?"UTC":""}function I9(){return this._isUTC?"Coordinated Universal Time":""}var ee=cg.prototype;ee.add=S7;ee.calendar=x7;ee.clone=I7;ee.diff=$7;ee.endOf=G7;ee.format=B7;ee.from=W7;ee.fromNow=j7;ee.to=U7;ee.toNow=z7;ee.get=VX;ee.invalidAt=n9;ee.isAfter=O7;ee.isBefore=A7;ee.isBetween=H7;ee.isSame=N7;ee.isSameOrAfter=D7;ee.isSameOrBefore=k7;ee.isValid=e9;ee.lang=ek;ee.locale=QD;ee.localeData=tk;ee.max=e7;ee.min=Q6;ee.parsingFlags=t9;ee.set=BX;ee.startOf=Y7;ee.subtract=R7;ee.toArray=J7;ee.toObject=Z7;ee.toDate=X7;ee.toISOString=F7;ee.inspect=V7;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=Q7;ee.toString=L7;ee.unix=q7;ee.valueOf=K7;ee.creationData=r9;ee.eraName=a9;ee.eraNarrow=l9;ee.eraAbbr=u9;ee.eraYear=c9;ee.year=OD;ee.isLeapYear=FX;ee.weekYear=w9;ee.isoWeekYear=v9;ee.quarter=ee.quarters=E9;ee.month=kD;ee.daysInMonth=XX;ee.week=ee.weeks=i6;ee.isoWeek=ee.isoWeeks=o6;ee.weeksInYear=b9;ee.weeksInWeekYear=S9;ee.isoWeeksInYear=y9;ee.isoWeeksInISOWeekYear=C9;ee.date=sk;ee.day=ee.days=v6;ee.weekday=y6;ee.isoWeekday=C6;ee.dayOfYear=T9;ee.hour=ee.hours=_6;ee.minute=ee.minutes=M9;ee.second=ee.seconds=_9;ee.millisecond=ee.milliseconds=ak;ee.utcOffset=u7;ee.utc=h7;ee.local=d7;ee.parseZone=f7;ee.hasAlignedHourOffset=g7;ee.isDST=m7;ee.isLocal=w7;ee.isUtcOffset=v7;ee.isUtc=qD;ee.isUTC=qD;ee.zoneAbbr=x9;ee.zoneName=I9;ee.dates=Pi("dates accessor is deprecated. Use date instead.",sk);ee.months=Pi("months accessor is deprecated. Use month instead",kD);ee.years=Pi("years accessor is deprecated. Use year instead",OD);ee.zone=Pi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",c7);ee.isDSTShifted=Pi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",p7);function O9(t){return Nt(t*1e3)}function A9(){return Nt.apply(null,arguments).parseZone()}function lk(t){return t}var ot=sE.prototype;ot.calendar=wX;ot.longDateFormat=bX;ot.invalidDate=RX;ot.ordinal=MX;ot.preparse=lk;ot.postformat=lk;ot.relativeTime=PX;ot.pastFuture=xX;ot.set=mX;ot.eras=i9;ot.erasParse=o9;ot.erasConvertYear=s9;ot.erasAbbrRegex=d9;ot.erasNameRegex=h9;ot.erasNarrowRegex=f9;ot.months=YX;ot.monthsShort=GX;ot.monthsParse=qX;ot.monthsRegex=ZX;ot.monthsShortRegex=JX;ot.week=e6;ot.firstDayOfYear=r6;ot.firstDayOfWeek=n6;ot.weekdays=f6;ot.weekdaysMin=m6;ot.weekdaysShort=g6;ot.weekdaysParse=w6;ot.weekdaysRegex=b6;ot.weekdaysShortRegex=S6;ot.weekdaysMinRegex=R6;ot.isPM=T6;ot.meridiem=P6;function Ew(t,e,n,r){var i=Gs(),o=Qo().set(r,e);return i[n](o,t)}function uk(t,e,n){if(Bs(t)&&(e=t,t=void 0),t=t||"",e!=null)return Ew(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Ew(t,r,n,"month");return i}function EE(t,e,n,r){typeof t=="boolean"?(Bs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Bs(e)&&(n=e,e=void 0),e=e||"");var i=Gs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Ew(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Ew(e,(s+o)%7,r,"day");return a}function H9(t,e){return uk(t,e,"months")}function N9(t,e){return uk(t,e,"monthsShort")}function D9(t,e,n){return EE(t,e,n,"weekdays")}function k9(t,e,n){return EE(t,e,n,"weekdaysShort")}function $9(t,e,n){return EE(t,e,n,"weekdaysMin")}Da("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ge(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=Pi("moment.lang is deprecated. Use moment.locale instead.",Da);Z.langData=Pi("moment.langData is deprecated. Use moment.localeData instead.",Gs);var os=Math.abs;function L9(){var t=this._data;return this._milliseconds=os(this._milliseconds),this._days=os(this._days),this._months=os(this._months),t.milliseconds=os(t.milliseconds),t.seconds=os(t.seconds),t.minutes=os(t.minutes),t.hours=os(t.hours),t.months=os(t.months),t.years=os(t.years),this}function ck(t,e,n,r){var i=ao(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function F9(t,e){return ck(this,t,e,1)}function V9(t,e){return ck(this,t,e,-1)}function Kx(t){return t<0?Math.floor(t):Math.ceil(t)}function B9(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=Kx(dR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=wi(t/1e3),r.seconds=i%60,o=wi(i/60),r.minutes=o%60,s=wi(o/60),r.hours=s%24,e+=wi(s/24),l=wi(hk(e)),n+=l,e-=Kx(dR(l)),a=wi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function hk(t){return t*4800/146097}function dR(t){return t*146097/4800}function W9(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=xi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+hk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(dR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Ks(t){return function(){return this.as(t)}}var dk=Ks("ms"),j9=Ks("s"),U9=Ks("m"),z9=Ks("h"),Y9=Ks("d"),G9=Ks("w"),K9=Ks("M"),q9=Ks("Q"),X9=Ks("y"),J9=dk;function Z9(){return ao(this)}function Q9(t){return t=xi(t),this.isValid()?this[t+"s"]():NaN}function Mu(t){return function(){return this.isValid()?this._data[t]:NaN}}var e8=Mu("milliseconds"),t8=Mu("seconds"),n8=Mu("minutes"),r8=Mu("hours"),i8=Mu("days"),o8=Mu("months"),s8=Mu("years");function a8(){return wi(this.days()/7)}var Es=Math.round,Ic={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function l8(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function u8(t,e,n,r){var i=ao(t).abs(),o=Es(i.as("s")),s=Es(i.as("m")),a=Es(i.as("h")),l=Es(i.as("d")),u=Es(i.as("M")),c=Es(i.as("w")),h=Es(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,l8.apply(null,d)}function c8(t){return t===void 0?Es:typeof t=="function"?(Es=t,!0):!1}function h8(t,e){return Ic[t]===void 0?!1:e===void 0?Ic[t]:(Ic[t]=e,t==="s"&&(Ic.ss=e-1),!0)}function d8(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Ic,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Ic,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=u8(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var gC=Math.abs;function Du(t){return(t>0)-(t<0)||+t}function $v(){if(!this.isValid())return this.localeData().invalidDate();var t=gC(this._milliseconds)/1e3,e=gC(this._days),n=gC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=wi(t/60),i=wi(r/60),t%=60,r%=60,o=wi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Du(this._months)!==Du(a)?"-":"",c=Du(this._days)!==Du(a)?"-":"",h=Du(this._milliseconds)!==Du(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ze=Dv.prototype;Ze.isValid=o7;Ze.abs=L9;Ze.add=F9;Ze.subtract=V9;Ze.as=W9;Ze.asMilliseconds=dk;Ze.asSeconds=j9;Ze.asMinutes=U9;Ze.asHours=z9;Ze.asDays=Y9;Ze.asWeeks=G9;Ze.asMonths=K9;Ze.asQuarters=q9;Ze.asYears=X9;Ze.valueOf=J9;Ze._bubble=B9;Ze.clone=Z9;Ze.get=Q9;Ze.milliseconds=e8;Ze.seconds=t8;Ze.minutes=n8;Ze.hours=r8;Ze.days=i8;Ze.weeks=a8;Ze.months=o8;Ze.years=s8;Ze.humanize=d8;Ze.toISOString=$v;Ze.toString=$v;Ze.toJSON=$v;Ze.locale=QD;Ze.localeData=tk;Ze.toIsoString=Pi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",$v);Ze.lang=ek;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ue("x",Ov);ue("X",HX);vt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});vt("x",function(t,e,n){n._d=new Date(Ge(t))});//! moment.js
Z.version="2.30.1";fX(Nt);Z.fn=ee;Z.min=t7;Z.max=n7;Z.now=r7;Z.utc=Qo;Z.unix=O9;Z.months=H9;Z.isDate=ug;Z.locale=Da;Z.invalid=_v;Z.duration=ao;Z.isMoment=io;Z.weekdays=D9;Z.parseZone=A9;Z.localeData=Gs;Z.isDuration=Np;Z.monthsShort=N9;Z.weekdaysMin=$9;Z.defineLocale=pE;Z.updateLocale=A6;Z.locales=H6;Z.weekdaysShort=k9;Z.normalizeUnits=xi;Z.relativeTimeRounding=c8;Z.relativeTimeThreshold=h8;Z.calendarFormat=P7;Z.prototype=ee;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function fk(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function fR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Gd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Sn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Ba(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function _(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function gk(t){return Sn(t,(e,n)=>e+n,0)}function f8(t){return Sn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function g8(t){return Sn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function m8(t){return t.length?gk(t)/t.length:0}function mk(t){return Sn(t,(e,n)=>e.concat(Array.isArray(n)?mk(n):n),[])}function pk(t){const e=[];return _(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function gR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return _(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function p8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return _(i,s=>{o=o.filter(a=>s.includes(a))}),o}function w8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return _(i,s=>{_(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function mR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const v8=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:m8,arrayEach:_,arrayFilter:Ba,arrayFlatten:mk,arrayMap:Ue,arrayMax:f8,arrayMin:g8,arrayReduce:Sn,arraySum:gk,arrayUnique:pk,extendArray:fR,getDifferenceOfArrays:gR,getIntersectionOfArrays:p8,getUnionOfArrays:w8,pivot:Gd,stringToArray:mR,to2dArray:fk},Symbol.toStringTag,{value:"Module"}));function ht(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Sn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Tt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Ht(t){return typeof t>"u"}function Yt(t){return t===null||t===""||Ht(t)}function wk(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const $d="length",Kd=t=>parseInt(t,16),qx=t=>parseInt(t,10),Tw=(t,e,n)=>t.substr(e,n),qd=t=>t.codePointAt(0)-65,pR=t=>`${t}`.replace(/\-/g,""),y8=t=>Kd(Tw(pR(t),Kd("12"),qd("F")))/(Kd(Tw(pR(t),qd("B"),~~![][$d]))||9),C8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Xx=!1;const Jx={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Zx={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function vk(t,e){const n=!Yt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=pR(t||"");const l=b8(t);if(n||r||l)if(l){const u=Z("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=y8(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(C8()&&(s="valid",a="valid"),!Xx&&s!=="valid"&&(Jx[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Jx[s]({keyValidityDate:o,hotVersion:i})),Xx=!0),a!=="valid"&&e.parentNode&&Zx[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=Zx[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function b8(t){let e=[][$d],n=e;if(t[$d]!==qd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=qd(i.shift());o;o=qd(i.shift()||"A"))--o<""[$d]?n=n|(qx(`${qx(Kd(r)+(Kd(Tw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Tw(t,o,o?i[$d]===1?9:8:6);return n===e}const S8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:vk,isDefined:le,isEmpty:Yt,isRegExp:wk,isUndefined:Ht,stringify:Tt},Symbol.toStringTag,{value:"Module"}));function Zn(t){return t[0].toUpperCase()+t.substr(1)}function R8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Tt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function TE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function ME(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function _E(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function wR(t){return Lv(`${t}`,{ALLOWED_TAGS:[]})}function Lv(t,e){return dX.sanitize(t,e)}const E8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:R8,isPercentValue:ME,randomString:TE,sanitize:Lv,stripTags:wR,substitute:_E,toUpperCaseFirst:Zn},Symbol.toStringTag,{value:"Module"})),_u=t=>["tabindex",t],T8=()=>["role","treegrid"],Hs=()=>["role","presentation"],M8=()=>["role","gridcell"],_8=()=>["role","rowheader"],yk=()=>["role","rowgroup"],P8=()=>["role","columnheader"],vR=()=>["role","row"],x8=()=>["role","menu"],I8=()=>["role","menuitem"],O8=()=>["role","menuitemcheckbox"],A8=()=>["role","combobox"],Ck=()=>["role","listbox"],H8=()=>["role","option"],N8=()=>["role","checkbox"],D8=()=>["scope","col"],k8=()=>["scope","row"],$8=()=>["type","text"],xf=t=>["aria-label",t],Pu=()=>["aria-hidden","true"],L8=()=>["aria-disabled","true"],F8=()=>["aria-multiselectable","true"],bk=t=>["aria-haspopup",t],Sk=t=>["aria-rowcount",t],Fv=t=>["aria-colcount",t],Rk=t=>["aria-rowindex",t],PE=t=>["aria-colindex",t],bi=t=>["aria-expanded",t],V8=t=>["aria-sort",t],Qx=()=>["aria-readonly","true"],eI=()=>["aria-invalid","true"],Ek=t=>["aria-checked",t],xE=()=>["aria-selected","true"],B8=()=>["aria-autocomplete","list"],W8=t=>["aria-controls",t],j8=t=>["aria-activedescendant",t],U8=t=>["aria-live",t],z8=t=>["aria-relevant",t],Y8=t=>["aria-setsize",t],G8=t=>["aria-posinset",t];function Tk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Xd(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function Mk(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function cu(t){return Mk(t)&&t.parent}function K8(t){return!!Object.getPrototypeOf(t.parent)}function Wa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Ld(t,e,n){const r=[];let i=t;for(;i&&(i=Wa(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function _k(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function ka(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Pk(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function ga(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function xk(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Ik(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=xk(e),e.length>0&&t.classList.add(...e)}function we(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Ik(e,!0);n=xk(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function be(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function xu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Ik(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function IE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)IE(e[n])}}function qo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Ok=/(<(.*)>|&(.*);)/;function Iu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Ok.test(e)?t.innerHTML=n?Lv(e):e:ja(t,e)}function ja(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(qo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function hu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return hu(r.host.impl);if(r.host)return hu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function Ak(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Ln(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function OE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Vv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Bv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?OE(e):t.scrollTop}function AE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Vv(e):t.scrollLeft}function If(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Hk(t){return t.scrollHeight-t.clientHeight}function Nk(t){return t.scrollWidth-t.clientWidth}function Zc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Of(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function q8(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Qt(t){return t.offsetWidth}function un(t){return t.offsetHeight}function Wc(t){return t.clientHeight||t.innerHeight}function HE(t){return t.clientWidth||t.innerWidth}function X8(t,e,n){t.addEventListener(e,n,!1)}function J8(t,e,n){t.removeEventListener(e,n,!1)}function NE(t){return t.selectionStart?t.selectionStart:0}function Dk(t){return t.selectionEnd?t.selectionEnd:0}function Z8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function yR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function fg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let mC;function Q8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function _n(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return mC===void 0&&(mC=Q8(t)),mC}function DE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function kE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Wv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function eJ(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function gg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Jd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function jv(t){return Jd(t)&&t.hasAttribute("data-hot-input")===!1}function tJ(t){const e=t.ownerDocument.activeElement;jv(e)||t.select()}function $E(t){return!t.parentNode}function kk(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function LE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();be(t,"contenteditable",!0),n&&be(t,...Pu()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function FE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&we(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function $k(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;LE(t,n),e(),FE(t,n)}function zo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const nJ=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Ok,addClass:q,addEvent:X8,clearTextSelection:yR,closest:Wa,closestDown:Ld,empty:qo,fastInnerHTML:Iu,fastInnerText:ja,findFirstParentWithClass:_k,getCaretPosition:NE,getCssTransform:eJ,getFrameElement:Mk,getMaximumScrollLeft:Nk,getMaximumScrollTop:Hk,getParent:Tk,getParentWindow:cu,getScrollLeft:AE,getScrollTop:Bv,getScrollableElement:If,getScrollbarWidth:_n,getSelectionEndPosition:Dk,getSelectionText:Z8,getStyle:Of,getTrimmingContainer:Zc,getWindowScrollLeft:Vv,getWindowScrollTop:OE,hasAccessToParentWindow:K8,hasClass:ve,hasHorizontalScrollbar:kE,hasVerticalScrollbar:DE,hasZeroHeight:Ak,index:Pk,innerHeight:Wc,innerWidth:HE,isChildOf:ka,isDetached:$E,isHTMLElement:zo,isInput:Jd,isInternalElement:Xd,isOutsideInput:jv,isVisible:hu,makeElementContentEditableAndSelectItsContent:LE,matchesCSSRules:q8,observeVisibilityChangeOnce:kk,offset:Ln,outerHeight:un,outerWidth:Qt,overlayContainsElement:ga,removeAttribute:xu,removeClass:we,removeContentEditableFromElementAndDeselect:FE,removeEvent:J8,removeTextNodes:IE,resetCssTransform:gg,runWithSelectedContendEditableElement:$k,selectElementIfAllowed:tJ,setAttribute:be,setCaretPosition:fg,setOverlayPosition:Wv},Symbol.toStringTag,{value:"Module"}));function ut(t){return typeof t=="function"}function Lk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function rJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=Lk(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function mg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function iJ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Sn(i,(u,c)=>c(u),r.apply(this,a))}}function VE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function Fk(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function oJ(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Mw(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const sJ=Object.freeze(Object.defineProperty({__proto__:null,curry:Fk,curryRight:oJ,debounce:mg,fastCall:Mw,isFunction:ut,partial:VE,pipe:iJ,throttle:Lk,throttleAfterHits:rJ},Symbol.toStringTag,{value:"Module"}));var aJ=dn,tI=IN,lJ=Cn,nI=Cu,uJ=Mv,rI=aJ([].push),cJ=function(t){if(lJ(t))return t;if(tI(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?rI(n,i):(typeof i=="number"||nI(i)==="Number"||nI(i)==="String")&&rI(n,uJ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(tI(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},hJ=Ct,Vk=uh,Bk=sg,dJ=yn,pg=dn,Wk=Nn,iI=Cn,oI=L0,jk=tE,fJ=cJ,gJ=$0,mJ=String,$a=Vk("JSON","stringify"),qg=pg(/./.exec),sI=pg("".charAt),pJ=pg("".charCodeAt),wJ=pg("".replace),vJ=pg(1 .toString),yJ=/[\uD800-\uDFFF]/g,aI=/^[\uD800-\uDBFF]$/,lI=/^[\uDC00-\uDFFF]$/,uI=!gJ||Wk(function(){var t=Vk("Symbol")("stringify detection");return $a([t])!=="[null]"||$a({a:t})!=="{}"||$a(Object(t))!=="{}"}),cI=Wk(function(){return $a("\uDF06\uD834")!=='"\\udf06\\ud834"'||$a("\uDEAD")!=='"\\udead"'}),CJ=function(t,e){var n=jk(arguments),r=fJ(e);if(!(!iI(r)&&(t===void 0||oI(t))))return n[1]=function(i,o){if(iI(r)&&(o=dJ(r,this,mJ(i),o)),!oI(o))return o},Bk($a,null,n)},bJ=function(t,e,n){var r=sI(n,e-1),i=sI(n,e+1);return qg(aI,t)&&!qg(lI,i)||qg(lI,t)&&!qg(aI,r)?"\\u"+vJ(pJ(t,0),16):t};$a&&hJ({target:"JSON",stat:!0,arity:3,forced:uI||cI},{stringify:function(e,n,r){var i=jk(arguments),o=Bk(uI?CJ:$a,null,i);return cI&&typeof o=="string"?wJ(o,yJ,bJ):o}});function Qc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ke(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Qc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Qc(n[0])]:e[r]=[]:e[r]=null)})),e}function Uk(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function cn(t,e,n){const r=Array.isArray(n);return ke(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function wg(t,e){ke(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),wg(t[r],e[r])):t[r]=e[r]})}function Qn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function oo(t){const e={};return ke(t,(n,r)=>{e[r]=n}),e}function mt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _(n,i=>{t.MIXINS.push(i.MIXIN_NAME),ke(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let v=g;return(Array.isArray(v)||De(v))&&(v=Qn(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Uv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function De(t){return Object.prototype.toString.call(t)==="[object Object]"}function ts(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function ke(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function zk(t,e){const n=e.split(".");let r=t;return ke(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function kp(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(ln(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function zv(t){if(!De(t))return 0;const e=function(n){let r=0;return De(n)?ke(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function ln(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const SJ=Object.freeze(Object.defineProperty({__proto__:null,clone:oo,createObjectPropListener:Hr,deepClone:Qn,deepExtend:wg,deepObjectSize:zv,defineGetter:ts,duckSchema:Qc,extend:cn,getProperty:zk,hasOwnProperty:ln,inherit:Uk,isObject:De,isObjectEqual:Uv,mixin:mt,objectEach:ke,setProperty:kp},Symbol.toStringTag,{value:"Module"}));function Af(t){return window.requestAnimationFrame(t)}function Hf(t){window.cancelAnimationFrame(t)}function BE(){return"ontouchstart"in window}function Yk(){return typeof window<"u"}let ku;function Gk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ku||(typeof Intl=="object"?ku=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?ku=(n,r)=>`${n}`.localeCompare(r):ku=(n,r)=>n===r?0:n>r?-1:1,ku)}const RJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Hf,getComparisonFunction:Gk,isCSR:Yk,isTouchSupported:BE,requestAnimationFrame:Af},Symbol.toStringTag,{value:"Module"})),di=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},qs={chrome:di((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:di(t=>/CriOS/.test(t)),edge:di(t=>/Edge/.test(t)),edgeWebKit:di(t=>/EdgiOS/.test(t)),firefox:di(t=>/Firefox/.test(t)),firefoxWebKit:di(t=>/FxiOS/.test(t)),mobile:di(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:di((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},wh={mac:di(t=>/^Mac/.test(t)),win:di(t=>/^Win/.test(t)),linux:di(t=>/^Linux/.test(t)),ios:di(t=>/iPhone|iPad|iPod/i.test(t))};function Kk(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(qs,n=>{let{test:r}=n;return void r(t,e)})}function qk(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(wh,e=>{let{test:n}=e;return void n(t)})}Yk()&&(Kk(),qk());function WE(){return qs.chrome.value}function Xk(){return qs.chromeWebKit.value}function $p(){return qs.firefox.value}function Jk(){return qs.firefoxWebKit.value}function Nf(){return qs.safari.value}function Zk(){return qs.edge.value}function EJ(){return qs.edgeWebKit.value}function jo(){return qs.mobile.value}function jE(){return wh.ios.value}function UE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&wh.mac.value}function CR(){return wh.win.value}function _w(){return wh.mac.value}function TJ(){return wh.linux.value}const MJ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:WE,isChromeWebKit:Xk,isEdge:Zk,isEdgeWebKit:EJ,isFirefox:$p,isFirefoxWebKit:Jk,isIOS:jE,isIpadOS:UE,isLinuxOS:TJ,isMacOS:_w,isMobileBrowser:jo,isSafari:Nf,isWindowsOS:CR,setBrowserMeta:Kk,setPlatformMeta:qk},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:$p()?182:174,AUDIO_MUTE:$p()?181:173,AUDIO_UP:$p()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},_J=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function Qk(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function zE(t){return _J.includes(t)}function PJ(t){const e=[];return _w()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function e$(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function vh(t,e){const n=e.split("|");let r=!1;return _(n,i=>{if(t===de[i])return r=!0,!1}),r}const xJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:PJ,isCtrlMetaKey:e$,isFunctionKey:zE,isKey:vh,isPrintableChar:Qk},Symbol.toStringTag,{value:"Module"}));function Ii(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Sa(t){return t.isImmediatePropagationEnabled===!1}function Ua(t){return t.button===2}function Yv(t){return t.button===0}function t$(t){return t instanceof TouchEvent}function n$(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!zo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const IJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Sa,isLeftClick:Yv,isRightClick:Ua,isTouchEvent:t$,offsetRelativeTo:n$,stopImmediatePropagation:Ii},Symbol.toStringTag,{value:"Module"}));function nt(){le(console)&&console.warn(...arguments)}function YE(){le(console)&&console.error(...arguments)}const Yl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],pC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),wC=new Map([[]]);var OJ=dh,AJ=function(t,e,n){for(var r=0,i=arguments.length>2?n:OJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},HJ=vn,NJ=function(t,e){var n=HJ[t],r=n&&n.prototype;return r&&r[e]},DJ=so,kJ=qN,$J=Ys.f,bR=DJ("unscopables"),SR=Array.prototype;SR[bR]===void 0&&$J(SR,bR,{configurable:!0,value:kJ(null)});var Gv=function(t){SR[bR][t]=!0},LJ=Ct,FJ=dn,VJ=Dr,BJ=tg,WJ=AJ,jJ=NJ,UJ=Gv,zJ=Array,YJ=FJ(jJ("Array","sort"));LJ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&VJ(e);var n=BJ(this),r=WJ(zJ,n);return YJ(r,e)}});UJ("toSorted");var GJ=Ct,KJ=yn,qJ=fh,XJ=Dr,JJ=bn,ZJ=Zo,QJ=ei,eZ=Ka,vC=eZ("find",TypeError);GJ({target:"Iterator",proto:!0,real:!0,forced:vC},{find:function(e){JJ(this);try{XJ(e)}catch(i){QJ(this,"throw",i)}if(vC)return KJ(vC,this,e);var n=ZJ(this),r=0;return qJ(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function tZ(t,e){r$(t,e),e.add(t)}function yC(t,e,n){r$(t,e),e.set(t,n)}function r$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hI(t,e,n){return t.set(Pw(t,e),n),n}function $n(t,e){return t.get(Pw(t,e))}function Pw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nZ=100;var Vr=new WeakMap,Cc=new WeakMap,CC=new WeakMap,bC=new WeakSet;class dI{constructor(){tZ(this,bC),yC(this,Vr,new Map),yC(this,Cc,new Map),yC(this,CC,new Set),Yl.forEach(e=>Pw(bC,this,fI).call(this,e))}getHooks(e){var n;return(n=$n(Vr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};$n(Vr,this).has(e)||(Pw(bC,this,fI).call(this,e),Yl.push(e));const i=$n(Vr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=$n(CC,this).has(e);!u&&o!==0&&(u=!0,$n(CC,this).add(e)),u&&i.length>1&&$n(Vr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return $n(Vr,this).has(e)&&$n(Vr,this).get(e).length>0}remove(e,n){if(!$n(Vr,this).has(e))return!1;const r=$n(Vr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=$n(Cc,this).get(e);return i.skip=!0,o+=1,o>nZ&&($n(Vr,this).set(e,r.filter(s=>!s.skip)),o=0),$n(Cc,this).set(e,o),!0}return!1}destroy(){$n(Vr,this).clear(),$n(Cc,this).clear(),hI(Vr,this,null),hI(Cc,this,null)}}function fI(t){$n(Vr,this).set(t,[]),$n(Cc,this).set(t,0)}function rZ(t,e,n){return(e=iZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iZ(t){var e=oZ(t,"string");return typeof e=="symbol"?e:e+""}function oZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sZ=ht`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class oe{constructor(){rZ(this,"globalBucket",new dI)}static getSingleton(){return lZ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new dI),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,o=>this.add(e,o,r)):(pC.has(e)&&nt(_E(sZ,{hookName:e,removedInVersion:pC.get(e)})),wC.has(e)&&nt(wC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?_(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Mw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Mw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Yl.push(e)}deregister(e){this.isRegistered(e)&&Yl.splice(Yl.indexOf(e),1)}isDeprecated(e){return wC.has(e)||pC.has(e)}isRegistered(e){return Yl.indexOf(e)>=0}getRegistered(){return Yl}}const aZ=new oe;function lZ(){return aZ}const SC=new Map;function lo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";SC.has(t)||SC.set(t,new Map);const e=SC.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const RR=new WeakMap,{register:uZ,getItem:i$,hasItem:o$,getNames:cZ,getValues:g0e}=lo("editors");function hZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},oe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function s$(t,e){let n;if(typeof t=="function")RR.get(t)||Mr(null,t),n=RR.get(t);else if(typeof t=="string")n=i$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function xw(t){if(typeof t=="function")return t;if(!o$(t))throw Error(`No registered editor found under "${t}" name`);return i$(t).getConstructor()}function Mr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new hZ(e);typeof t=="string"&&uZ(t,n),RR.set(e,n)}function dZ(t,e,n){return(e=fZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fZ(t){var e=gZ(t,"string");return typeof e=="symbol"?e:e+""}function gZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Lp=0;class Ei{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;dZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,mZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Lp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Lp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Lp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function mZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ii(this)},t}function pZ(){return Lp}function wZ(t,e){vZ(t,e),e.add(t)}function vZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){return(e=yZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yZ(t){var e=CZ(t,"string");return typeof e=="symbol"?e:e+""}function CZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xg=new WeakSet;class ER{constructor(e,n,r){wZ(this,Xg),nl(this,"hot",void 0),nl(this,"tableMeta",void 0),nl(this,"selection",void 0),nl(this,"eventManager",void 0),nl(this,"destroyed",!1),nl(this,"activeEditor",void 0),nl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Ei(e),this.hot.addHook("afterDocumentKeyDown",i=>RC(Xg,this,gI).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>RC(Xg,this,gI).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>RC(Xg,this,bZ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=s$(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function gI(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Sa(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!zE(n)&&!e$(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function bZ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const mI=new WeakMap;ER.getInstance=function(t,e,n){let r=mI.get(t);return r||(r=new ER(t,e,n),mI.set(t,r)),r};function SZ(t,e){a$(t,e),e.add(t)}function Lh(t,e,n){a$(t,e),e.set(t,n)}function a$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(t,e){return t.get(Ps(t,e))}function Fh(t,e,n){return t.set(Ps(t,e),n),n}function Ps(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jc=Object.freeze({CELL:"cell",MIXED:"mixed"});var wn=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,Qg=new WeakMap,em=new WeakMap,wa=new WeakSet;class RZ{constructor(e){var n=this;SZ(this,wa),Lh(this,wn,void 0),Lh(this,Jg,void 0),Lh(this,Zg,1),Lh(this,Qg,null),Lh(this,em,new Map);const r=e.getSettings();Fh(wn,this,e),Fh(Jg,this,r.imeFastEdit?jc.MIXED:jc.CELL),St(wn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ps(wa,n,TZ).call(n,...o)}),St(wn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ps(wa,n,pI).call(n,...o)}),St(wn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ps(wa,n,pI).call(n,...o)}),St(wn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ps(wa,n,EZ).call(n,...o)})}getFocusMode(){return St(Jg,this)}setFocusMode(e){Object.values(jc).includes(e)?Fh(Jg,this,e):nt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return St(Zg,this)}setRefocusDelay(e){Fh(Zg,this,e)}setRefocusElementGetter(e){Fh(Qg,this,e)}getRefocusElement(){var e;return typeof St(Qg,this)=="function"?St(Qg,this).call(this):(e=St(wn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=St(wn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=St(wn,this).runHooks("modifyFocusedElement",s.row,s.col,r);zo(a)||(a=r),a&&!((o=St(wn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Ps(wa,this,GE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:St(Zg,this);if(St(wn,this).getSettings().imeFastEdit&&!((e=St(wn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=St(wn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),St(em,this).has(n)||St(em,this).set(n,mg(()=>{if(!St(wn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),St(em,this).get(n)()}}}function GE(t){var e;const n=(e=St(wn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!St(wn,this).selection.isCellVisible(n)){t(null);return}const r=St(wn,this).getCell(n.row,n.col,!0);r===null?St(wn,this).addHookOnce("afterScroll",()=>{t(St(wn,this).getCell(n.row,n.col,!0))}):t(r)}function pI(){Ps(wa,this,GE).call(this,t=>{const{activeElement:e}=St(wn,this).rootDocument;e&&jv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function EZ(){Ps(wa,this,GE).call(this,t=>{this.getFocusMode()===jc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function TZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?jc.MIXED:jc.CELL)}var MZ=Mi,_Z=Cu,PZ=so,xZ=PZ("match"),IZ=function(t){var e;return MZ(t)&&((e=t[xZ])!==void 0?!!e:_Z(t)==="RegExp")},OZ=bn,AZ=function(){var t=OZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},HZ=yn,NZ=_i,DZ=ng,kZ=AZ,wI=RegExp.prototype,$Z=function(t){var e=t.flags;return e===void 0&&!("flags"in wI)&&!NZ(t,"flags")&&DZ(wI,t)?HZ(kZ,t):e},KE=dn,LZ=ch,FZ=Math.floor,EC=KE("".charAt),VZ=KE("".replace),TC=KE("".slice),BZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,WZ=/\$([$&'`]|\d{1,2})/g,jZ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=WZ;return i!==void 0&&(i=LZ(i),l=BZ),VZ(o,l,function(u,c){var h;switch(EC(c,0)){case"$":return"$";case"&":return t;case"`":return TC(e,0,n);case"'":return TC(e,s);case"<":h=i[TC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=FZ(d/10);return f===0?u:f<=a?r[f-1]===void 0?EC(c,1):r[f-1]+EC(c,1):u}h=r[d-1]}return h===void 0?"":h})},UZ=Ct,zZ=yn,qE=dn,vI=eg,YZ=Cn,GZ=Mi,KZ=IZ,Vh=Mv,qZ=rg,XZ=$Z,JZ=jZ,ZZ=so,QZ=ZZ("replace"),eQ=TypeError,MC=qE("".indexOf);qE("".replace);var yI=qE("".slice),tQ=Math.max;UZ({target:"String",proto:!0},{replaceAll:function(e,n){var r=vI(this),i,o,s,a,l,u,c,h,d,f,g=0,v="";if(GZ(e)){if(i=KZ(e),i&&(o=Vh(vI(XZ(e))),!~MC(o,"g")))throw new eQ("`.replaceAll` does not allow non-global regexes");if(s=qZ(e,QZ),s)return zZ(s,e,r,n)}for(a=Vh(r),l=Vh(e),u=YZ(n),u||(n=Vh(n)),c=l.length,h=tQ(1,c),d=MC(a,l);d!==-1;)f=u?Vh(n(l,d,a)):JZ(l,a,d,[],void 0,n),v+=yI(a,g,d)+f,g=d+c,d=d+h>a.length?-1:MC(a,l,d+h);return g<a.length&&(v+=yI(a,g)),v}});var nQ=Ct,rQ=fh,iQ=Dr,oQ=bn,sQ=Zo,aQ=ei,lQ=Ka,uQ=sg,cQ=Nn,l$=TypeError,u$=cQ(function(){[].keys().reduce(function(){},void 0)}),_C=!u$&&lQ("reduce",l$);nQ({target:"Iterator",proto:!0,real:!0,forced:u$||_C},{reduce:function(e){oQ(this);try{iQ(e)}catch(s){aQ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(_C)return uQ(_C,this,n?[e]:[e,r]);var i=sQ(this),o=0;if(rQ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new l$("Reduce of empty iterator with no initial value");return r}});const c$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},hQ=new RegExp(Object.keys(c$).map(t=>`(${t})`).join("|"),"gi");function dQ(t){return(t&&t.nodeName||"")==="TABLE"}function TR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let y=0;y<s;y+=1){const E=!f&&n&&y===0;let C="";if(f)C=`<th>${t.getColHeader(y-c)}</th>`;else if(E)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const M=i[d][y],{hidden:x,rowspan:P,colspan:T}=t.getCellMeta(d-h,y-c);if(!x){const O=[];if(P&&O.push(`rowspan="${P}"`),T&&O.push(`colspan="${T}"`),Yt(M))C=`<td ${O.join(" ")}></td>`;else{const G=M.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${O.join(" ")}>${G}</td>`}}}g.push(C)}const v=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function MR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Yt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function h$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const M=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,x=>{const P=x.match(/<td\b[^>]*?>/g)[0],T=/<p.*?>/g,O=x.substring(P.length,x.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(T,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${O}</td>`});i.insertAdjacentHTML("afterbegin",`${M}`),o=i.querySelector("table")}if(!o||!dQ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((M,x)=>M+x.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const M=Array.from(o.tHead.rows).filter(x=>{const P=x.querySelector("td")!==null;return P&&h.push(x),!P});f=M.length,d=f>0,f>1?n.nestedHeaders=Array.from(M).reduce((x,P)=>{const T=Array.from(P.cells).reduce((O,G,U)=>{if(a&&U===0)return O;const{colSpan:V,innerHTML:X}=G,ne=V>1?{label:X,colspan:V}:X;return O.push(ne),O},[]);return x.push(T),x},[]):d&&(n.colHeaders=Array.from(M[0].children).reduce((x,P,T)=>(a&&T===0||x.push(P.innerHTML),x),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((M,x)=>(M.push(...Array.from(x.rows)),M),[]),...c];g=v.length;const y=new Array(g);for(let M=0;M<g;M++)y[M]=new Array(u);const E=[],C=[];for(let M=0;M<g;M++){const x=v[M],P=Array.from(x.cells),T=P.length;for(let O=0;O<T;O++){const G=P[O],{nodeName:U,innerHTML:V,rowSpan:X,colSpan:ne}=G,Q=y[M].findIndex(te=>te===void 0);if(U==="TD"){if(X>1||ne>1){for(let Re=M;Re<M+X;Re++)if(Re<g)for(let Ae=Q;Ae<Q+ne;Ae++)y[Re][Ae]=null;const pe=G.getAttribute("style");pe&&pe.includes("mso-ignore:colspan")||E.push({col:Q,row:M,rowspan:X,colspan:ne})}let te="";s&&/excel/gi.test(s.content)?te=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[M][Q]=te.replace(hQ,pe=>c$[pe])}else C.push(V)}}return E.length&&(n.mergeCells=E),C.length&&(n.rowHeaders=C),y.length&&(n.data=y),n}const fQ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:MR,htmlToGridSettings:h$,instanceToHTML:TR},Symbol.toStringTag,{value:"Module"}));function Gn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function d$(t){return Gn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function _R(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function XE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ye(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const gQ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ye,isNumeric:Gn,isNumericLike:d$,rangeEach:fe,rangeEachReverse:_R,valueAccordingPercent:XE},Symbol.toStringTag,{value:"Module"})),PR="asc",mQ="desc",CI=new Map([[PR,[-1,1]],[mQ,[1,-1]]]),pQ=t=>`The priority '${t}' is already declared in a map.`,wQ=t=>`The priority '${t}' is not a number.`;function vQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ut(t)?t:pQ,e=ut(e)?e:wQ;function r(o,s){if(!Gn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:PR;const[s,a]=CI.get(o)||CI.get(PR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const yQ=t=>`The id '${t}' is already declared in a map.`;function Kv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ut(t)?t:yQ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const CQ=t=>`'${t}' value is already declared in a unique set.`;function bQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ut(t)?t:CQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const JE=t=>`There is already registered "${t}" plugin.`,SQ=t=>`There is already registered plugin on priority "${t}".`,RQ=t=>`The priority "${t}" is not a number.`,f$=vQ({errorPriorityExists:SQ,errorPriorityNaN:RQ}),g$=bQ({errorItemExists:JE}),xR=Kv({errorIdExists:JE});function ZE(){return[...f$.getItems(),...g$.getItems()]}function vg(t){const e=Zn(t);return xR.getItem(e)}function EQ(t){return!!vg(t)}function Ke(t,e,n){[t,e,n]=MQ(t,e,n),vg(t)===void 0&&TQ(t,e,n)}function TQ(t,e,n){const r=Zn(t);if(xR.hasItem(r))throw new Error(JE(r));n===void 0?g$.addItem(r):f$.addItem(n,r),xR.addItem(r,e)}function MQ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:_Q,getItem:PQ,hasItem:m$,getNames:xQ,getValues:m0e}=lo("renderers");function Iw(t){if(typeof t=="function")return t;if(!m$(t))throw Error(`No registered renderer found under "${t}" name`);return PQ(t)}function Wr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),_Q(t,e)}const{register:IQ,getItem:OQ,hasItem:p$,getNames:AQ,getValues:p0e}=lo("validators");function QE(t){if(typeof t=="function")return t;if(!p$(t))throw Error(`No registered validator found under "${t}" name`);return OQ(t)}function Gl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),IQ(t,e)}var HQ=Ct,NQ=ch,DQ=dh,kQ=ig,$Q=Gv;HQ({target:"Array",proto:!0},{at:function(e){var n=NQ(this),r=DQ(n),i=kQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});$Q("at");var LQ=Ct,FQ=dn,VQ=eg,BQ=ig,WQ=Mv,jQ=Nn,UQ=FQ("".charAt),zQ=jQ(function(){return"𠮷".at(-2)!=="\uD842"});LQ({target:"String",proto:!0,forced:zQ},{at:function(e){var n=WQ(VQ(this)),r=n.length,i=BQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:UQ(n,o)}});function Bh(t,e,n){return(e=YQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YQ(t){var e=GQ(t,"string");return typeof e=="symbol"?e:e+""}function GQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KQ{constructor(){Bh(this,"count",0),Bh(this,"startColumn",null),Bh(this,"endColumn",null),Bh(this,"startPosition",null),Bh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Wh(t,e,n){return(e=qQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qQ(t){var e=XQ(t,"string");return typeof e=="symbol"?e:e+""}function XQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JQ{constructor(){Wh(this,"count",0),Wh(this,"startRow",null),Wh(this,"endRow",null),Wh(this,"startPosition",null),Wh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jh(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=QQ(t,"string");return typeof e=="symbol"?e:e+""}function QQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w${constructor(){jh(this,"count",0),jh(this,"startColumn",null),jh(this,"endColumn",null),jh(this,"startPosition",null),jh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Uh(t,e,n){return(e=eee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eee(t){var e=tee(t,"string");return typeof e=="symbol"?e:e+""}function tee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v${constructor(){Uh(this,"count",0),Uh(this,"startRow",null),Uh(this,"endRow",null),Uh(this,"startPosition",null),Uh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function zh(t,e,n){return(e=nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=ree(t,"string");return typeof e=="symbol"?e:e+""}function ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iee{constructor(){zh(this,"count",0),zh(this,"startColumn",0),zh(this,"endColumn",0),zh(this,"startPosition",0),zh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Yh(t,e,n){return(e=oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=see(t,"string");return typeof e=="symbol"?e:e+""}function see(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aee{constructor(){Yh(this,"count",0),Yh(this,"startRow",0),Yh(this,"endRow",0),Yh(this,"startPosition",0),Yh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function bI(t,e,n){return(e=lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lee(t){var e=uee(t,"string");return typeof e=="symbol"?e:e+""}function uee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cee extends w${constructor(){super(...arguments),bI(this,"columnStartOffset",0),bI(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function SI(t,e,n){return(e=hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hee(t){var e=dee(t,"string");return typeof e=="symbol"?e:e+""}function dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fee extends v${constructor(){super(...arguments),SI(this,"rowStartOffset",0),SI(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function RI(t,e,n){return(e=gee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gee(t){var e=mee(t,"string");return typeof e=="symbol"?e:e+""}function mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y${constructor(e){RI(this,"calculationTypes",[]),RI(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Hi(t,e,n){return(e=pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pee(t){var e=wee(t,"string");return typeof e=="symbol"?e:e+""}function wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eh=50;class vee extends y${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Hi(this,"viewportWidth",0),Hi(this,"scrollOffset",0),Hi(this,"zeroBasedScrollOffset",0),Hi(this,"totalColumns",0),Hi(this,"columnWidthFn",null),Hi(this,"columnWidth",0),Hi(this,"overrideFn",null),Hi(this,"inlineStartOffset",0),Hi(this,"totalCalculatedWidth",0),Hi(this,"startPositions",[]),Hi(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?eh:n}}function ii(t,e,n){return(e=yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:e+""}function Cee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bee extends y${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),ii(this,"viewportHeight",0),ii(this,"scrollOffset",0),ii(this,"zeroBasedScrollOffset",0),ii(this,"totalRows",0),ii(this,"rowHeightFn",null),ii(this,"rowHeight",0),ii(this,"overrideFn",null),ii(this,"horizontalScrollbarHeight",0),ii(this,"innerViewportHeight",0),ii(this,"totalCalculatedHeight",0),ii(this,"startPositions",[]),ii(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function See(t,e,n){Ree(t,e),e.set(t,n)}function Ree(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EI(t,e,n){return(e=Eee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eee(t){var e=Tee(t,"string");return typeof e=="symbol"?e:e+""}function Tee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $u(t,e){return t.get(C$(t,e))}function TI(t,e,n){return t.set(C$(t,e),n),n}function C$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ss=new WeakMap;class du{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;EI(this,"row",null),EI(this,"col",null),See(this,ss,!1),TI(ss,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return $u(ss,this)}isSouthEastOf(e){return this.row>=e.row&&($u(ss,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&($u(ss,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&($u(ss,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&($u(ss,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof du&&TI(ss,this,e.isRtl()),this}clone(){return new du(this.row,this.col,$u(ss,this))}toObject(){return{row:this.row,col:this.col}}}function Mee(t,e,n){_ee(t,e),e.set(t,n)}function _ee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PC(t,e,n){return(e=Pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=xee(t,"string");return typeof e=="symbol"?e:e+""}function xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oi(t,e){return t.get(b$(t,e))}function Iee(t,e,n){return t.set(b$(t,e),n),n}function b$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pr=new WeakMap;class yg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;PC(this,"highlight",null),PC(this,"from",null),PC(this,"to",null),Mee(this,pr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Iee(pr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return oi(pr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return oi(pr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return oi(pr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return oi(pr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return oi(pr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return oi(pr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return oi(pr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return oi(pr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof du))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(oi(pr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(oi(pr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new yg(this.highlight,this.from,this.to,oi(pr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new du(e,n,oi(pr,this))}}function fo(t,e,n){Oee(t,e),e.set(t,n)}function Oee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(S$(t,e))}function Qs(t,e,n){return t.set(S$(t,e),n),n}function S$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var si=new WeakMap,xC=new WeakMap,In=new WeakMap,Lu=new WeakMap,tm=new WeakMap,Ni=new WeakMap,IC=new WeakMap,Gh=new WeakMap,rl=new WeakMap,go=new WeakMap;let R$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;fo(this,si,void 0),fo(this,xC,void 0),fo(this,In,void 0),fo(this,Lu,void 0),fo(this,tm,void 0),fo(this,Ni,void 0),fo(this,IC,void 0),fo(this,Gh,void 0),fo(this,rl,[null,null]),fo(this,go,[null,null]),Qs(si,this,r),Qs(xC,this,n),Qs(In,this,o),Qs(Lu,this,s),Qs(tm,this,a),Qs(Ni,this,i),Qs(IC,this,e),this.registerEvents()}registerEvents(){ge(Ni,this).addEventListener(ge(In,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(Ni,this).addEventListener(ge(In,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(Ni,this).addEventListener(ge(In,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(Ni,this).addEventListener(ge(In,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(Ni,this).addEventListener(ge(In,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(Ni,this).addEventListener(ge(In,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(si,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(si,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(Ni,this).addEventListener(ge(In,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(Ni,this).addEventListener(ge(In,this).holder,"mousedown",r=>this.onMouseDown(r))};jo()?e():(BE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(Gh,this)&&r){const[i,o]=[r.row,ge(Gh,this).from.row],[s,a]=[r.col,ge(Gh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(In,this).TABLE,i=Ld(e,["TD","TH"],r);return i?(n.coords=ge(In,this).getCoords(i),n.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(n.coords=ge(Lu,this).getFocusSelection().cellRange.highlight,n.TD=ge(In,this).getCell(n.coords)):ve(e,"wtBorder")&&ve(e,"area")&&ge(Lu,this).getAreaSelection().cellRange&&(n.coords=ge(Lu,this).getAreaSelection().cellRange.to,n.TD=ge(In,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(xC,this).rootDocument.activeElement,r=VE(Tk,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ve(i,"corner")?ge(si,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(si,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(go,this)[0]=o.TD,clearTimeout(ge(rl,this)[0]),ge(rl,this)[0]=setTimeout(()=>{ge(go,this)[0]=null},1e3))}onContextMenu(e){if(ge(si,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(si,this).has("onCellMouseOver"))return;const n=ge(In,this).TABLE,r=Ld(e.target,["TD","TH"],n),i=ge(tm,this)||this;r&&r!==i.lastMouseOver&&ka(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(In,this).getCoords(r),r))}onMouseOut(e){if(!ge(si,this).has("onCellMouseOut"))return;const n=ge(In,this).TABLE,r=Ld(e.target,["TD","TH"],n),i=Ld(e.relatedTarget,["TD","TH"],n),o=ge(tm,this)||this;r&&r!==i&&ka(r,n)&&(this.callListener("onCellMouseOut",e,ge(In,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(si,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(go,this)[0]&&n.TD===ge(go,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(go,this)[0]=null,ge(go,this)[1]=null):n.TD===ge(go,this)[0]&&(ge(go,this)[1]=n.TD,clearTimeout(ge(rl,this)[1]),ge(rl,this)[1]=setTimeout(()=>{ge(go,this)[1]=null},500)))}onTouchStart(e){Qs(Gh,this,ge(Lu,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(si,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];jE()&&(Xk()||Jk())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(si,this).getSettingPure(e);o&&o(n,r,i,ge(IC,this).call(this))}destroy(){clearTimeout(ge(rl,this)[0]),clearTimeout(ge(rl,this)[1]),ge(Ni,this).destroy()}};function OC(t,e,n){return(e=Aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aee(t){var e=Hee(t,"string");return typeof e=="symbol"?e:e+""}function Hee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nee{constructor(e,n,r){OC(this,"offset",void 0),OC(this,"total",void 0),OC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function AC(t,e,n){return(e=Dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ee{constructor(e,n,r){AC(this,"offset",void 0),AC(this,"total",void 0),AC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function nm(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=Fee(t,"string");return typeof e=="symbol"?e:e+""}function Fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vee{constructor(){nm(this,"currentSize",0),nm(this,"nextSize",0),nm(this,"currentOffset",0),nm(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Bee=0,MI=1,IR=2;function HC(t,e,n){return(e=Wee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wee(t){var e=jee(t,"string");return typeof e=="symbol"?e:e+""}function jee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uee{constructor(){HC(this,"size",new Vee),HC(this,"workingSpace",Bee),HC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=MI,e.workingSpace=IR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=IR,e.workingSpace=MI,this.sharedSize=e.getViewSize()}}var _I=Tv,zee=TypeError,Yee=function(t,e){if(!delete t[e])throw new zee("Cannot delete property "+_I(e)+" of "+_I(t))},Gee=Ct,Kee=ch,qee=dh,Xee=ON,Jee=Yee,Zee=AN,Qee=[].unshift(0)!==1,ete=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},tte=Qee||!ete();Gee({target:"Array",proto:!0,arity:1,forced:tte},{unshift:function(e){var n=Kee(this),r=qee(n),i=arguments.length;if(i){Zee(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Jee(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return Xee(n,r+i)}});function nte(t,e,n){return(e=rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ite(t,"string");return typeof e=="symbol"?e:e+""}function ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PI{constructor(e,n){nte(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function ote(t,e,n){return(e=ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ste(t){var e=ate(t,"string");return typeof e=="symbol"?e:e+""}function ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lte{constructor(e){ote(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new PI(o,n),l=new PI(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(IR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Fu(t,e,n){return(e=ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ute(t){var e=cte(t,"string");return typeof e=="symbol"?e:e+""}function cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E${constructor(e,n){Fu(this,"rootNode",void 0),Fu(this,"nodesPool",void 0),Fu(this,"sizeSet",new Uee),Fu(this,"collectedNodes",[]),Fu(this,"viewDiffer",new lte(this.sizeSet)),Fu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class T$ extends E${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function xI(t,e,n){return(e=hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hte(t){var e=dte(t,"string");return typeof e=="symbol"?e:e+""}function dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fte{constructor(e){xI(this,"nodeType",void 0),xI(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Kh(t,e,n){return(e=gte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gte(t){var e=mte(t,"string");return typeof e=="symbol"?e:e+""}function mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cg{constructor(e,n){Kh(this,"nodesPool",null),Kh(this,"nodeType",void 0),Kh(this,"rootNode",void 0),Kh(this,"table",null),Kh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new fte(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function II(t,e,n){return(e=pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pte(t){var e=wte(t,"string");return typeof e=="symbol"?e:e+""}function wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vte extends Cg{constructor(){super("TH"),II(this,"orderViews",new WeakMap),II(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new T$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),xu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(d,[_8(),k8(),PE(h+1),_u(-1)]),n[h](a,d,h)}u.end()}}}class yte extends Cg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&qo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&be(this.rootNode,[yk()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&be(s,[vR(),Rk(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),xu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(u,[PE(a+1+this.table.rowHeadersCount),_u(-1),P8(),...a>=0?[D8()]:[vR()]]),r[n](l,u,n)}}}}let OI=!1;class Cte extends Cg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!OI&&e>1e3&&(OI=!0,nt(ht`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function bte(t,e,n){return(e=Ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ste(t){var e=Rte(t,"string");return typeof e=="symbol"?e:e+""}function Rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Vu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let AI=!1;class Ete extends Cg{constructor(e){super("TR",e),bte(this,"orderView",void 0),this.orderView=new E$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!AI&&e>1e3&&(AI=!0,nt(ht`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&be(this.rootNode,[yk()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;be(o,[vR(),Rk(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ve(o,Vu.rowEven)||(we(o,Vu.rowOdd),q(o,Vu.rowEven)):ve(o,Vu.rowOdd)||(we(o,Vu.rowEven),q(o,Vu.rowOdd))}this.orderView.end()}}function HI(t,e,n){return(e=Tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _te extends Cg{constructor(){super("TD"),HI(this,"orderViews",new WeakMap),HI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new T$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(ve(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),xu(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;be(g,[...g.hasAttribute("role")?[]:[M8()],_u(-1),PE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function mn(t,e,n){return(e=Pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pte(t){var e=xte(t,"string");return typeof e=="symbol"?e:e+""}function xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ite{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mn(this,"rootNode",void 0),mn(this,"rootDocument",void 0),mn(this,"rowHeaders",null),mn(this,"columnHeaders",null),mn(this,"colGroup",null),mn(this,"rows",null),mn(this,"cells",null),mn(this,"rowFilter",null),mn(this,"columnFilter",null),mn(this,"rowUtils",null),mn(this,"columnUtils",null),mn(this,"rowsToRender",0),mn(this,"columnsToRender",0),mn(this,"rowHeaderFunctions",[]),mn(this,"rowHeadersCount",0),mn(this,"columnHeaderFunctions",[]),mn(this,"columnHeadersCount",0),mn(this,"cellRenderer",void 0),mn(this,"activeOverlayName",void 0),mn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class Ote{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Ite(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new vte,columnHeaders:new yte(n),colGroup:new Cte(r),rows:new Ete(i),cells:new _te}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function NC(t,e,n){return(e=Ate(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ate(t){var e=Hte(t,"string");return typeof e=="symbol"?e:e+""}function Hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nte{constructor(e,n){NC(this,"dataAccessObject",void 0),NC(this,"wtSettings",void 0),NC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function NI(t,e,n){return(e=Dte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dte(t){var e=kte(t,"string");return typeof e=="symbol"?e:e+""}function kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $te{constructor(e,n){NI(this,"dataAccessObject",void 0),NI(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function mo(t,e,n){return(e=Lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lte(t){var e=Fte(t,"string");return typeof e=="symbol"?e:e+""}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yh{constructor(e,n,r,i,o){mo(this,"wtSettings",null),mo(this,"domBindings",void 0),mo(this,"TBODY",null),mo(this,"THEAD",null),mo(this,"COLGROUP",null),mo(this,"hasTableHeight",!0),mo(this,"hasTableWidth",!0),mo(this,"isTableVisible",!1),mo(this,"tableOffset",0),mo(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,IE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new $te(this.dataAccessObject,this.wtSettings),this.columnUtils=new Nte(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Ote({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&be(r,[Hs()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[Hs()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",be(r,[_u(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&be(r.parentNode,[Hs()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[Hs()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Ln(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Ln(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new $ee(f,o,c),this.columnFilter=new Nee(g,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),v=y.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Fo)||this.is(La))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Fo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Fo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Wc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Fo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Wa(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=Pk(r),s=n.cellIndex;ga(mu,n,this.wtRootElement)||ga(fu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):ga(La,n,this.wtRootElement)||ga(Fo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),ga(mu,n,this.wtRootElement)||ga(gu,n,this.wtRootElement)||ga(La,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=Wc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?un:Wc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Qt(this.TABLE)}getHeight(){return un(this.TABLE)}getTotalWidth(){const e=Qt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=un(this.hider);return e!==0?e:this.getHeight()}isVisible(){return hu(this.TABLE)}_modifyRowHeaderWidth(e){let n=ut(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Vte="stickyRowsBottom",eT={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ts(eT,"MIXIN_NAME",Vte,{writable:!1,enumerable:!1});const Bte="stickyColumnsStart",qv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ts(qv,"MIXIN_NAME",Bte,{writable:!1,enumerable:!1});class tT extends yh{constructor(e,n,r,i){super(e,n,r,i,La)}}mt(tT,eT);mt(tT,qv);const fu="top",Fo="bottom",gu="inline_start",mu="top_inline_start_corner",La="bottom_inline_start_corner",M$=[fu,Fo,gu,mu,La],Wte=new Map([[fu,`ht_clone_${fu}`],[Fo,`ht_clone_${Fo}`],[gu,`ht_clone_${gu} ht_clone_left`],[mu,`ht_clone_${mu} ht_clone_top_left_corner`],[La,`ht_clone_${La} ht_clone_bottom_left_corner`]]);function jte(t,e){Ute(t,e),e.add(t)}function Ute(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zte(t,e,n){return(e=Yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yte(t){var e=Gte(t,"string");return typeof e=="symbol"?e:e+""}function Gte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qh=new WeakSet;class Kte{constructor(e){jte(this,qh),zte(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return rm(qh,this,kI).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return rm(qh,this,kI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return rm(qh,this,DI).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return rm(qh,this,DI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function DI(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Ln(r.wtRootElement).left;const u=Math.abs(AE(s,s));if(l>u){const c=HE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function kI(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Ln(n.wtRootElement),a=Bv(o,o);if(s.top>a){const l=Wc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function ai(t,e,n){return(e=qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Xte(t,"string");return typeof e=="symbol"?e:e+""}function Xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nT{get eventManager(){return new Ei(this)}constructor(e,n){ai(this,"wtTable",void 0),ai(this,"wtScroll",void 0),ai(this,"wtViewport",void 0),ai(this,"wtOverlays",void 0),ai(this,"selectionManager",void 0),ai(this,"wtEvent",void 0),ai(this,"guid",`wt_${TE()}`),ai(this,"drawInterrupted",!1),ai(this,"drawn",!1),ai(this,"activeOverlayName","master"),ai(this,"domBindings",void 0),ai(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Kte(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){ja(r,e[n])}])}}createCellCoords(e,n){return new du(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new yg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||Ak(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function $I(t,e,n){return(e=Jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jte(t){var e=Zte(t,"string");return typeof e=="symbol"?e:e+""}function Zte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qte extends nT{constructor(e,n,r){super(e,n),$I(this,"cloneSource",void 0),$I(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new R$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function ene(t,e,n){return(e=tne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tne(t){var e=nne(t,"string");return typeof e=="symbol"?e:e+""}function nne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bg{constructor(e,n,r,i,o){ene(this,"wtSettings",null),ts(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Zc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Zc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=If(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){nt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+_n())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(M$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Wte.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&be(o,[Hs()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===fu||u==="vertical"&&this.type===gu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=If(e.TABLE),new Qte(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class rne extends bg{constructor(e,n,r,i,o,s){super(e,n,La,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new tT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else gg(n),this.repositionOverlay();let r=un(this.clone.wtTable.TABLE);const i=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=_n(r)),i.style.bottom=`${o}px`}}const ine="calculatedColumns",Xv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ts(Xv,"MIXIN_NAME",ine,{writable:!1,enumerable:!1});class rT extends yh{constructor(e,n,r,i){super(e,n,r,i,Fo)}}mt(rT,eT);mt(rT,Xv);function one(t,e,n){return(e=sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sne(t){var e=ane(t,"string");return typeof e=="symbol"?e:e+""}function ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lne extends bg{constructor(e,n,r,i){super(e,n,Fo,r,i),one(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new rT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=_n(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Vv(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=un(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=_n(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Bv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(we(s,"innerBorderBottom"),o=a)}return o}}const une="calculatedRows",iT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ts(iT,"MIXIN_NAME",une,{writable:!1,enumerable:!1});class oT extends yh{constructor(e,n,r,i){super(e,n,r,i,gu)}}mt(oT,iT);mt(oT,qv);const cne="localHooks",Fn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Mw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ts(Fn,"MIXIN_NAME",cne,{writable:!1,enumerable:!1});let _$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};mt(_$,Fn);const P$="active-header",sT="header",aT="area",Zd="focus",hne="fill",dne="row",fne="column",gne="custom-selection",lT=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var mne=Gv;mne("flat");function pne(t,e){x$(t,e),e.add(t)}function LI(t,e,n){x$(t,e),e.set(t,n)}function x$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wt(t,e){return t.get(Qd(t,e))}function FI(t,e,n){return t.set(Qd(t,e),n),n}function Qd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vi=new WeakMap,Un=new WeakMap,im=new WeakSet;class wne{constructor(){pne(this,im),LI(this,Vi,void 0),LI(this,Un,void 0)}setActiveOverlay(e){return FI(Un,this,e),this}setActiveSelection(e){return FI(Vi,this,e),this}scan(){const e=Wt(Vi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Wt(Vi,this).getCorners(),{wtTable:s}=Wt(Un,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const v=Wt(Un,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Wt(Vi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==h&&(g=s.getColumnHeader(v,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Wt(Vi,this).getCorners(),{wtTable:s}=Wt(Un,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const v=Wt(Un,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Wt(Vi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(g=s.getRowHeader(v,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Wt(Un,this);Qd(im,this,vne).call(this,(r,i)=>{const o=n.getCell(Wt(Un,this).createCellCoords(r,i)),s=Wt(Un,this).getSetting("onAfterDrawSelection",r,i,Wt(Vi,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Wt(Vi,this).getCorners(),{wtTable:i}=Wt(Un,this);Qd(im,this,VI).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Wt(Un,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Wt(Vi,this).getCorners(),{wtTable:i}=Wt(Un,this);Qd(im,this,VI).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Wt(Un,this).createCellCoords(o,s));e(a)}})}}function vne(t){let[e,n,r,i]=Wt(Vi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Wt(Un,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Wt(Un,this).createCellCoords(e,n));if(!zo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function VI(t){const{wtTable:e}=Wt(Un,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class BI{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=lT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ii(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),jo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};ke(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};ke(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),y-g-f*2),M=Math.min(parseInt(i+o-v/4,10),y-v-f*2);h[l]=`${C}px`,d[l]=`${M}px`;const x=Math.min(parseInt(r+s,10),E-g-f*2),P=Math.min(parseInt(r+s-v/4,10),E-v-f*2);h.top=`${x}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!zo(g)){this.disappear();return}const v=u?s.getCell(this.wot.createCellCoords(i,o)):g,y=Ln(g),E=u?Ln(v):y,C=Ln(s.TABLE),M=y.top,x=y.left,P=this.wot.wtSettings.getSetting("rtlMode");let T=0,O=0;if(P){const Re=Qt(s.TABLE),Ae=Qt(g),st=l.innerWidth-C.left-Re;O=x+Ae-E.left,T=l.innerWidth-x-Ae-st-1}else O=E.left+Qt(v)-x,T=x-C.left-1;if(this.isEntireColumnSelected(n,i)){const Re=n,Ae=this.getDimensionsFromHeader("columns",r,o,Re,C);let st=null;Ae&&([st,T,O]=Ae),st&&(g=st)}let G=M-C.top-1,U=E.top+un(v)-M;if(this.isEntireRowSelected(r,o)){const Re=r,Ae=this.getDimensionsFromHeader("rows",n,i,Re,C);let st=null;Ae&&([st,G,U]=Ae),st&&(g=st)}const V=l.getComputedStyle(g);parseInt(V.borderTopWidth,10)>0&&(G+=1,U=U>0?U-1:0),parseInt(V[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,O=O>0?O-1:0);const X=P?"right":"left";this.topStyle.top=`${G}px`,this.topStyle[X]=`${T}px`,this.topStyle.width=`${O}px`,this.topStyle.display="block",this.startStyle.top=`${G}px`,this.startStyle[X]=`${T}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${G+U-ne}px`,this.bottomStyle[X]=`${T}px`,this.bottomStyle.width=`${O}px`,this.bottomStyle.display="block",this.endStyle.top=`${G}px`,this.endStyle[X]=`${T+O-ne}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let Q=this.settings.border.cornerVisible;Q=typeof Q=="function"?Q(this.settings.layerLevel):Q;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[pe,et]=[i,o];if(te&&Array.isArray(te)&&([,,pe,et]=te),jo()||!Q||this.isPartRange(pe,et))this.cornerStyle.display="none";else{this.cornerStyle.top=`${G+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[X]=`${T+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Re=Zc(s.TABLE);const Ae=Re===l;Ae&&(Re=a.documentElement);const st=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Pn=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),at=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ae?v.getBoundingClientRect().left:v.offsetLeft;let w=!1,p=0;P?(p=m-parseInt(this.cornerDefaultStyle.width,10)/2,w=p<0):(p=m+Qt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,w=p>=HE(Re)),w&&(this.cornerStyle[X]=`${Math.floor(T+O+this.cornerCenterPointOffset-Pn-st)}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const p=(Ae?v.getBoundingClientRect().top:v.offsetTop)+un(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=Wc(Re),A=this.wot.stylesHandler.isClassicTheme();if(p){const L=Math.floor(G+U+this.cornerCenterPointOffset-at-st);A?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}jo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,G,T,O,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return un(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Qt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(g=l(n,y-i),v=l(r,y-i),!g||!v)return!1;const E=Ln(g),C=Ln(v);return g&&v&&(h=E[f]-o[f]-1,d=C[f]+u(v)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(ve(this[e],"hidden")&&we(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):we(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",jo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function yne(t,e){I$(t,e),e.add(t)}function Bu(t,e,n){I$(t,e),e.set(t,n)}function I$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(uT(t,e))}function WI(t,e,n){return t.set(uT(t,e),n),n}function uT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zn=new WeakMap,_r=new WeakMap,DC=new WeakMap,Fd=new WeakMap,kC=new WeakMap,il=new WeakMap,jI=new WeakSet;class Cne{constructor(e){yne(this,jI),Bu(this,zn,void 0),Bu(this,_r,void 0),Bu(this,DC,new wne),Bu(this,Fd,new WeakMap),Bu(this,kC,new WeakSet),Bu(this,il,new Map),WI(_r,this,e)}setActiveOverlay(e){return WI(zn,this,e),$e(DC,this).setActiveOverlay($e(zn,this)),$e(Fd,this).has($e(zn,this))||$e(Fd,this).set($e(zn,this),new Set),this}getFocusSelection(){return $e(_r,this)!==null?$e(_r,this).getFocus():null}getAreaSelection(){return $e(_r,this)!==null?$e(_r,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if($e(il,this).has(e)){const r=$e(il,this).get(e);if(r.has($e(zn,this)))return r.get($e(zn,this));const i=new BI($e(zn,this),e.settings);return r.set($e(zn,this),i),i}const n=new BI($e(zn,this),e.settings);return $e(il,this).set(e,new Map([[$e(zn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=$e(il,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){$e(il,this).get(e).forEach(n=>n.destroy()),$e(il,this).delete(e)}render(e){if($e(_r,this)===null)return;e&&uT(jI,this,bne).call(this);const n=Array.from($e(_r,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;$e(kC,this).has(s)||($e(kC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&$e(DC,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const v=r.get(g);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();$e(zn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>$e(Fd,this).get($e(zn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=$e(_r,this).options)===null||a===void 0?void 0:a.cellAttributes)&&be(s,$e(_r,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{be(o,[...i.get(o)])})}}function bne(){const t=$e(Fd,this).get($e(zn,this)),e=$e(zn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=$e(zn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=$e(_r,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=$e(_r,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=$e(_r,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...$e(_r,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)we(o[a],n),xu(o[a],s)}),t.clear()}class Sne extends bg{constructor(e,n,r,i){super(e,n,gu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new oT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Wv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),gg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,OE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Qt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=lT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=_n(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Nk(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(AE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?we(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(we(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const Rne="stickyRowsTop",cT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ts(cT,"MIXIN_NAME",Rne,{writable:!1,enumerable:!1});class hT extends yh{constructor(e,n,r,i){super(e,n,r,i,mu)}}mt(hT,cT);mt(hT,qv);function UI(t,e,n){return(e=Ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ene(t){var e=Tne(t,"string");return typeof e=="symbol"?e:e+""}function Tne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mne extends bg{constructor(e,n,r,i,o,s){super(e,n,mu,r,i),UI(this,"topOverlay",void 0),UI(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new hT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Wv(e,`${i}px`,`${o}px`)}else gg(e);let n=un(this.clone.wtTable.TABLE);const r=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class dT extends yh{constructor(e,n,r,i){super(e,n,r,i,fu)}}mt(dT,cT);mt(dT,Xv);function _ne(t,e,n){return(e=Pne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pne(t){var e=xne(t,"string");return typeof e=="symbol"?e:e+""}function xne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ine extends bg{constructor(e,n,r,i){super(e,n,fu,r,i),_ne(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new dT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Wv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),gg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Vv(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=un(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=lT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=_n(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Hk(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Bv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?we(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(we(i,"innerBorderTop"),a=h)}}return a}}function om(t,e,n){One(t,e),e.set(t,n)}function One(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function as(t,e,n){return(e=Ane(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ane(t){var e=Hne(t,"string");return typeof e=="symbol"?e:e+""}function Hne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ol(t,e,n){return t.set(O$(t,e),n),n}function ls(t,e){return t.get(O$(t,e))}function O$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wu=new WeakMap,sm=new WeakMap,ju=new WeakMap,am=new WeakMap;class Nne{constructor(e,n,r,i,o,s){as(this,"wot",null),om(this,Wu,[]),as(this,"topOverlay",null),as(this,"bottomOverlay",null),as(this,"inlineStartOverlay",null),as(this,"topInlineStartCornerOverlay",null),as(this,"bottomInlineStartCornerOverlay",null),as(this,"browserLineHeight",void 0),as(this,"wtSettings",null),om(this,sm,!1),om(this,ju,0),om(this,am,null),as(this,"resizeObserver",new ResizeObserver(c=>{Af(()=>{!Array.isArray(c)||!c.length||(ol(ju,this,ls(ju,this)+1),ls(ju,this)===100&&(nt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ls(am,this)!==null&&clearTimeout(ls(am,this)),ol(am,this,setTimeout(()=>{ol(ju,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=_n(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:If(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...ls(Wu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Ine(...e),this.bottomOverlay=new lne(...e),this.inlineStartOverlay=new Sne(...e),this.topInlineStartCornerOverlay=new Mne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new rne(...e,this.bottomOverlay,this.inlineStartOverlay),ol(Wu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ol(sm,this,ls(Wu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),ls(Wu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ls(Wu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!WE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Af(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ol(ju,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=vh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!ls(sm,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),ol(sm,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=If(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),v=f()?1:0,y=g()?1:0;d.width=`${c+y}px`,d.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return _(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];_(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function zI(t,e,n){return(e=Dne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dne(t){var e=kne(t,"string");return typeof e=="symbol"?e:e+""}function kne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ne{constructor(e){zI(this,"settings",{}),zI(this,"defaults",Object.freeze(this.getDefaults())),ke(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);ja(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?ke(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class fT extends yh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Zc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Of(e,"height",n),o=Of(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=hu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}mt(fT,iT);mt(fT,Xv);class Lne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new aee:new fee],["fullyVisible",()=>new JQ],["partiallyVisible",()=>new v$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new iee:new cee],["fullyVisible",()=>new KQ],["partiallyVisible",()=>new w$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=un(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Ln(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=un(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Qt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=_n(this.domBindings.rootDocument),new bee({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=_n(this.domBindings.rootDocument)),new vee({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){ke(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function Fne(t,e){A$(t,e),e.add(t)}function sl(t,e,n){A$(t,e),e.set(t,n)}function A$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e){return t.get(qi(t,e))}function Ki(t,e,n){return t.set(qi(t,e),n),n}function qi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const YI=23;var Po=new WeakMap,xs=new WeakMap,gT=new WeakMap,OR=new WeakMap,ma=new WeakMap,Vd=new WeakMap,Df=new WeakMap,Oo=new WeakSet;class Vne{constructor(e){Fne(this,Oo),sl(this,Po,void 0),sl(this,xs,void 0),sl(this,gT,void 0),sl(this,OR,void 0),sl(this,ma,!0),sl(this,Vd,{}),sl(this,Df,{}),Ki(xs,this,e.rootTable.parentElement.parentElement),Ki(OR,this,e.rootDocument)}isClassicTheme(){return At(ma,this)}getCSSVariableValue(e){var n;if(At(ma,this))return null;if(At(Vd,this)[`--ht-${e}`])return At(Vd,this)[`--ht-${e}`];const r=(n=qi(Oo,this,Une).call(this,`--ht-${e}`))!==null&&n!==void 0?n:qi(Oo,this,H$).call(this,`--ht-${e}`);if(r!==null)return At(Vd,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=At(Df,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(At(ma,this))return YI;const e=qi(Oo,this,Bne).call(this);return!e&&ve(At(xs,this),"ht-wrapper")?(nt(`The "${At(Po,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Ki(ma,this,!0),this.useTheme(),YI):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){qi(Oo,this,GI).call(this),Ki(ma,this,!0),Ki(Po,this,e||void 0);return}e&&e!==At(Po,this)&&(At(Po,this)&&qi(Oo,this,zne).call(this),Ki(Po,this,e),Ki(ma,this,!1),qi(Oo,this,Wne).call(this),qi(Oo,this,GI).call(this))}getThemeName(){return At(Po,this)}removeClassNames(){ve(At(xs,this),At(Po,this))&&we(At(xs,this),At(Po,this))}}function Bne(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Wne(){we(At(xs,this),/ht-theme-.*/g),q(At(xs,this),At(Po,this))}function GI(){this.isClassicTheme()||Ki(gT,this,getComputedStyle(At(xs,this)));const t=qi(Oo,this,jne).call(this,["box-sizing","border-bottom-width"]);At(Df,this).td={...At(Df,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function jne(t){const e=At(OR,this),n=At(xs,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function Une(t){const e=Math.ceil(parseFloat(qi(Oo,this,H$).call(this,t)));return Number.isNaN(e)?null:e}function H$(t){const e=At(gT,this).getPropertyValue(t);return e===""?null:e}function zne(){Ki(Df,this,{}),Ki(Vd,this,{}),Ki(ma,this,!0)}class Yne extends nT{constructor(e,n){super(e,new $ne(n)),this.stylesHandler=new Vne(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new fT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Lne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Cne(this.wtSettings.getSetting("selections")),this.wtEvent=new R$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Nne(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];ke(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),we(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!M$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class mT{constructor(e){e instanceof nT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new mT(n);return()=>r},this._wot=new Yne(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function KI(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Gne(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const Kne=new Map([["mousedown",KI],["mouseover",Gne],["touchstart",KI]]);function qI(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;Kne.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Yv(t)||t.type==="touchstart",isRightClick:Ua(t)})}const N$=new WeakMap,pT=Symbol("rootInstance");function qne(t){N$.set(t,!0)}function Xne(t){return t===pT}function Fp(t){return N$.has(t)}function Jne(t,e){D$(t,e),e.add(t)}function ea(t,e,n){D$(t,e),e.set(t,n)}function D$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ta(t,e,n){return(e=Zne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zne(t){var e=Qne(t,"string");return typeof e=="symbol"?e:e+""}function Qne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nn(t,e){return t.get(Uc(t,e))}function wr(t,e,n){return t.set(Uc(t,e),n),n}function Uc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $C=new WeakMap,lm=new WeakMap,um=new WeakMap,us=new WeakMap,Di=new WeakMap,LC=new WeakMap,FC=new WeakMap,Uu=new WeakMap,Bd=new WeakSet;class ere{constructor(e){Jne(this,Bd),ta(this,"hot",void 0),ta(this,"eventManager",void 0),ta(this,"settings",void 0),ta(this,"THEAD",void 0),ta(this,"TBODY",void 0),ta(this,"_wt",void 0),ta(this,"activeWt",void 0),ea(this,$C,0),ea(this,lm,0),ta(this,"postponedAdjustElementsSize",!1),ea(this,um,!1),ea(this,us,void 0),ea(this,Di,void 0),ea(this,LC,0),ea(this,FC,0),ea(this,Uu,null),this.hot=e,this.eventManager=new Ei(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Uc(Bd,this,nre).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),wr(Di,this,n.createElement("TABLE")),q(nn(Di,this),"htCore"),this.hot.getSettings().tableClassName&&q(nn(Di,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(be(nn(Di,this),[Hs()]),be(e,[T8(),Sk(-1),Fv(this.hot.countCols()),F8()])),this.THEAD=n.createElement("THEAD"),nn(Di,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),nn(Di,this).appendChild(this.TBODY),this.hot.table=nn(Di,this),this.hot.container.insertBefore(nn(Di,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{wr(um,this,!0),this.isTextSelectionAllowed(a.target)||(yR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{wr(um,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{nn(um,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&yR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&Yv(a)&&r.finish(),wr(us,this,!1);const l=jv(n.activeElement);Jd(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Ua(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&Ua(a)&&(r.finish(),wr(us,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),wr(us,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(nn(us,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=_n(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=cu(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=cu(s);this.eventManager.addEventListener(nn(Di,this),"selectstart",a=>{this.settings.fragmentSelection||Jd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&we(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:nn(Di,this),isDataViewInstance:()=>Fp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),wr(lm,this,o.length),this.hot.getSettings().ariaTags&&Uc(Bd,this,k$).call(this)===this.hot.countCols()&&Uc(Bd,this,tre).call(this,nn(lm,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),wr($C,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,v,f),this.hot.runHooks("afterRenderer",a,l,u,g,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&hu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,wr(us,this,!0),wr(Uu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Sa(o)&&(qI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,wr(us,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Sa(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Sa(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Sa(o)&&(nn(us,this)&&(!nn(Uu,this)||nn(Uu,this).x!==o.clientX||nn(Uu,this).y!==o.clientY)&&qI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,wr(Uu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Sa(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,v,y,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new mT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Jd(e))return!0;const n=ka(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return nn(us,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ve(r,"relative")){qo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(qo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(be(a,...Hs()),be(l,...Hs())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Iu(e,r(n,i)):(ja(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){wr(LC,this,e),wr(FC,this,n)}getLastSize(){return{width:nn(LC,this),height:nn(FC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return nn($C,this)}getRowHeadersCount(){return nn(lm,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function k$(){return parseInt(this.hot.rootElement.getAttribute(Fv()[0]),10)}function tre(t){const e=Uc(Bd,this,k$).call(this)+t;be(this.hot.rootElement,...Fv(e))}function nre(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):we(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):we(t,"htHasScrollX")}var rre=Ct,ire=yn,ore=fh,sre=Dr,are=bn,lre=Zo,ure=ei,cre=Ka,VC=cre("every",TypeError);rre({target:"Iterator",proto:!0,real:!0,forced:VC},{every:function(e){are(this);try{sre(e)}catch(i){ure(this,"throw",i)}if(VC)return ire(VC,this,e);var n=lre(this),r=0;return!ore(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const $$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",AR=$$.length;function Jv(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%AR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/AR,10);return n}function hre(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=AR**r*($$.indexOf(t[n])+1);return e-=1,e}function dre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Jv(i)+(r+1));n.push(o)}return n}function fre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Jv(i)+(r+1);n.push(o)}return n}function gre(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function wT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function vT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&De(t[0])&&(e=zv(t[0]))),e}function L$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function F$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const mre=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:vT,createEmptySpreadsheetData:gre,createSpreadsheetData:dre,createSpreadsheetObjectData:fre,dataRowToChangesArray:wT,isArrayOfArrays:L$,isArrayOfObjects:F$,spreadsheetColumnIndex:hre,spreadsheetColumnLabel:Jv},Symbol.toStringTag,{value:"Module"}));function Xh(t,e,n){return(e=pre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pre(t){var e=wre(t,"string");return typeof e=="symbol"?e:e+""}function wre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Xh(this,"hot",void 0),Xh(this,"data",void 0),Xh(this,"dataType","array"),Xh(this,"colToProp",()=>{}),Xh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return _(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(De(a)||ut(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?kp(l,d,f):l[d]=f}})}else ke(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?kp(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Hr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:kp(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?zk(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Hr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return vT(this.data)}destroy(){this.data=null,this.hot=null}}var yre=Ct,Cre=yn,bre=fh,Sre=Dr,Rre=bn,Ere=Zo,Tre=ei,Mre=Ka,BC=Mre("some",TypeError);yre({target:"Iterator",proto:!0,real:!0,forced:BC},{some:function(e){Rre(this);try{Sre(e)}catch(i){Tre(this,"throw",i)}if(BC)return Cre(BC,this,e);var n=Ere(this),r=0;return bre(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function XI(t,e,n){return(e=_re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _re(t){var e=Pre(t,"string");return typeof e=="symbol"?e:e+""}function Pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ou{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;XI(this,"indexedValues",[]),XI(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ut(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mt(Ou,Fn);function yT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>ut(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function CT(t,e){return Ba(t,(n,r)=>e.includes(r)===!1)}class qa extends Ou{insert(e,n){this.indexedValues=yT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=CT(this.indexedValues,e),super.remove(e)}}class Zv extends qa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Sn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function bT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function kf(t,e){return Ba(t,n=>e.includes(n)===!1)}function ST(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function RT(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function xre(t,e,n){return(e=Ire(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ire(t){var e=Ore(t,"string");return typeof e=="symbol"?e:e+""}function Ore(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qv extends Ou{constructor(){super(...arguments),xre(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=kf(this.orderOfIndexes,[e]),ut(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=yT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=RT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=CT(this.indexedValues,e),this.orderOfIndexes=kf(this.orderOfIndexes,e),this.orderOfIndexes=ST(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Sg extends qa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Sn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const JI=new Map([["indexesSequence",{getListWithInsertedItems:bT,getListWithRemovedItems:kf}],["physicallyIndexed",{getListWithInsertedItems:yT,getListWithRemovedItems:CT}]]),V$=t=>{if(JI.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return JI.get(t)};class B$ extends Ou{constructor(){super(e=>e)}insert(e,n){const r=RT(this.indexedValues,n);this.indexedValues=bT(r,e,n),super.insert(e,n)}remove(e){const n=kf(this.indexedValues,e);this.indexedValues=ST(n,e),super.remove(e)}}const ZI=new Map([["hiding",Zv],["index",Ou],["linkedPhysicalIndexToValue",Qv],["physicalIndexToValue",qa],["trimming",Sg]]);function Are(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!ZI.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(ZI.get(t))(e)}function Hre(t,e,n){return(e=Nre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nre(t){var e=Dre(t,"string");return typeof e=="symbol"?e:e+""}function Dre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let HR=0;class ET{constructor(){Hre(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),HR+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),HR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ht(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}mt(ET,Fn);function kre(){return HR}function WC(t,e,n){return(e=$re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $re(t){var e=Lre(t,"string");return typeof e=="symbol"?e:e+""}function Lre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QI extends ET{constructor(e,n){super(),WC(this,"mergedValuesCache",[]),WC(this,"aggregationFunction",void 0),WC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Fre(t,e,n){Vre(t,e),e.set(t,n)}function Vre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bre(t,e,n){return t.set(W$(t,e),n),n}function Wre(t,e){return t.get(W$(t,e))}function W$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jC=new WeakMap;class j${constructor(){Fre(this,jC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Wre(jC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Bre(jC,this,e)}}mt(j$,Fn);function eO(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Jh(t,e,n){jre(t,e),e.set(t,n)}function jre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function li(t,e){return t.get(U$(t,e))}function cm(t,e,n){return t.set(U$(t,e),n),n}function U$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hm=new WeakMap,Zh=new WeakMap,dm=new WeakMap,fm=new WeakMap,gm=new WeakMap;class Ure{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Jh(this,hm,new Set),Jh(this,Zh,[]),Jh(this,dm,[]),Jh(this,fm,!1),Jh(this,gm,!1),cm(gm,this,e??!1)}createObserver(){const e=new j$;return li(hm,this).add(e),e.addLocalHook("unsubscribe",()=>{li(hm,this).delete(e)}),e._writeInitialChanges(eO(li(Zh,this),li(dm,this))),e}emit(e){let n=li(dm,this);(!li(fm,this)||li(Zh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(li(gm,this)):cm(Zh,this,new Array(e.length).fill(li(gm,this))),li(fm,this)||(cm(fm,this,!0),n=li(Zh,this)));const r=eO(n,e);li(hm,this).forEach(i=>i._write(r)),cm(dm,this,e)}}function nr(t,e,n){return(e=zre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zre(t){var e=Yre(t,"string");return typeof e=="symbol"?e:e+""}function Yre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NR{constructor(){nr(this,"indexesSequence",new B$),nr(this,"trimmingMapsCollection",new QI(e=>e.some(n=>n===!0),!1)),nr(this,"hidingMapsCollection",new QI(e=>e.some(n=>n===!0),!1)),nr(this,"variousMapsCollection",new ET),nr(this,"hidingChangesObservable",new Ure({initialIndexValue:!1})),nr(this,"notTrimmedIndexesCache",[]),nr(this,"notHiddenIndexesCache",[]),nr(this,"isBatched",!1),nr(this,"indexesSequenceChanged",!1),nr(this,"indexesChangeSource",void 0),nr(this,"trimmedIndexesChanged",!1),nr(this,"hiddenIndexesChanged",!1),nr(this,"renderablePhysicalIndexesCache",[]),nr(this,"fromPhysicalToVisualIndexesCache",new Map),nr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,Are(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Sg?this.trimmingMapsCollection.register(e,n):n instanceof Zv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=kf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(bT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}mt(NR,Fn);function Gre(t,e){return ke(e,(n,r)=>{Ht(t[r])&&(t[r]=n)}),t}function z$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Y$(t){le(t)&&YE(ht`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Kre(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:qre,getValues:Xre}=lo("phraseFormatters");function Jre(t,e){qre(t,e)}function Zre(){return Xre()}Jre("pluralize",Kre);const G$="ContextMenu:items",Ie=G$,TT=`${Ie}.noItems`,MT=`${Ie}.insertRowAbove`,_T=`${Ie}.insertRowBelow`,PT=`${Ie}.insertColumnOnTheLeft`,xT=`${Ie}.insertColumnOnTheRight`,IT=`${Ie}.removeRow`,OT=`${Ie}.removeColumn`,AT=`${Ie}.undo`,HT=`${Ie}.redo`,Ow=`${Ie}.readOnly`,NT=`${Ie}.clearColumn`,DT=`${Ie}.copy`,kT=`${Ie}.copyWithHeaders`,$T=`${Ie}.copyWithGroupHeaders`,LT=`${Ie}.copyHeadersOnly`,FT=`${Ie}.cut`,VT=`${Ie}.freezeColumn`,BT=`${Ie}.unfreezeColumn`,WT=`${Ie}.mergeCells`,jT=`${Ie}.unmergeCells`,UT=`${Ie}.addComment`,zT=`${Ie}.editComment`,YT=`${Ie}.removeComment`,GT=`${Ie}.readOnlyComment`,KT=`${Ie}.align`,qT=`${Ie}.align.left`,XT=`${Ie}.align.center`,JT=`${Ie}.align.right`,ZT=`${Ie}.align.justify`,QT=`${Ie}.align.top`,eM=`${Ie}.align.middle`,tM=`${Ie}.align.bottom`,nM=`${Ie}.borders`,rM=`${Ie}.borders.top`,iM=`${Ie}.borders.right`,oM=`${Ie}.borders.bottom`,sM=`${Ie}.borders.left`,aM=`${Ie}.borders.remove`,lM=`${Ie}.nestedHeaders.insertChildRow`,uM=`${Ie}.nestedHeaders.detachFromParent`,cM=`${Ie}.hideColumn`,hM=`${Ie}.showColumn`,dM=`${Ie}.hideRow`,fM=`${Ie}.showRow`,gr="Filters:",Gt=`${gr}conditions`,ey=`${Gt}.none`,gM=`${Gt}.isEmpty`,mM=`${Gt}.isNotEmpty`,pM=`${Gt}.isEqualTo`,wM=`${Gt}.isNotEqualTo`,vM=`${Gt}.beginsWith`,yM=`${Gt}.endsWith`,CM=`${Gt}.contains`,bM=`${Gt}.doesNotContain`,Qre=`${Gt}.byValue`,SM=`${Gt}.greaterThan`,RM=`${Gt}.greaterThanOrEqualTo`,EM=`${Gt}.lessThan`,TM=`${Gt}.lessThanOrEqualTo`,MM=`${Gt}.isBetween`,_M=`${Gt}.isNotBetween`,PM=`${Gt}.after`,xM=`${Gt}.before`,IM=`${Gt}.today`,OM=`${Gt}.tomorrow`,AM=`${Gt}.yesterday`,HM=`${gr}labels.filterByCondition`,NM=`${gr}labels.filterByValue`,DM=`${gr}labels.conjunction`,ty=`${gr}labels.disjunction`,Aw=`${gr}values.blankCells`,kM=`${gr}buttons.selectAll`,$M=`${gr}buttons.clear`,LM=`${gr}buttons.ok`,FM=`${gr}buttons.cancel`,VM=`${gr}buttons.placeholder.search`,BM=`${gr}buttons.placeholder.value`,WM=`${gr}buttons.placeholder.secondValue`,jM="CheckboxRenderer:",UM=`${jM}checked`,zM=`${jM}unchecked`,eie=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:UM,CHECKBOX_RENDERER_NAMESPACE:jM,CHECKBOX_UNCHECKED:zM,CONTEXTMENU_ITEMS_ADD_COMMENT:UT,CONTEXTMENU_ITEMS_ALIGNMENT:KT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:tM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:XT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ZT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:qT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:eM,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:JT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:QT,CONTEXTMENU_ITEMS_BORDERS:nM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:oM,CONTEXTMENU_ITEMS_BORDERS_LEFT:sM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:iM,CONTEXTMENU_ITEMS_BORDERS_TOP:rM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:NT,CONTEXTMENU_ITEMS_COPY:DT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:LT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:$T,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:kT,CONTEXTMENU_ITEMS_CUT:FT,CONTEXTMENU_ITEMS_EDIT_COMMENT:zT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:VT,CONTEXTMENU_ITEMS_HIDE_COLUMN:cM,CONTEXTMENU_ITEMS_HIDE_ROW:dM,CONTEXTMENU_ITEMS_INSERT_LEFT:PT,CONTEXTMENU_ITEMS_INSERT_RIGHT:xT,CONTEXTMENU_ITEMS_MERGE_CELLS:WT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:uM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:lM,CONTEXTMENU_ITEMS_NO_ITEMS:TT,CONTEXTMENU_ITEMS_READ_ONLY:Ow,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:GT,CONTEXTMENU_ITEMS_REDO:HT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:aM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:OT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:YT,CONTEXTMENU_ITEMS_REMOVE_ROW:IT,CONTEXTMENU_ITEMS_ROW_ABOVE:MT,CONTEXTMENU_ITEMS_ROW_BELOW:_T,CONTEXTMENU_ITEMS_SHOW_COLUMN:hM,CONTEXTMENU_ITEMS_SHOW_ROW:fM,CONTEXTMENU_ITEMS_UNDO:AT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:BT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:jT,CONTEXT_MENU_ITEMS_NAMESPACE:G$,FILTERS_BUTTONS_CANCEL:FM,FILTERS_BUTTONS_CLEAR:$M,FILTERS_BUTTONS_OK:LM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:VM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:WM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:BM,FILTERS_BUTTONS_SELECT_ALL:kM,FILTERS_CONDITIONS_AFTER:PM,FILTERS_CONDITIONS_BEFORE:xM,FILTERS_CONDITIONS_BEGINS_WITH:vM,FILTERS_CONDITIONS_BETWEEN:MM,FILTERS_CONDITIONS_BY_VALUE:Qre,FILTERS_CONDITIONS_CONTAINS:CM,FILTERS_CONDITIONS_EMPTY:gM,FILTERS_CONDITIONS_ENDS_WITH:yM,FILTERS_CONDITIONS_EQUAL:pM,FILTERS_CONDITIONS_GREATER_THAN:SM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:RM,FILTERS_CONDITIONS_LESS_THAN:EM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:TM,FILTERS_CONDITIONS_NAMESPACE:Gt,FILTERS_CONDITIONS_NONE:ey,FILTERS_CONDITIONS_NOT_BETWEEN:_M,FILTERS_CONDITIONS_NOT_CONTAIN:bM,FILTERS_CONDITIONS_NOT_EMPTY:mM,FILTERS_CONDITIONS_NOT_EQUAL:wM,FILTERS_CONDITIONS_TODAY:IM,FILTERS_CONDITIONS_TOMORROW:OM,FILTERS_CONDITIONS_YESTERDAY:AM,FILTERS_DIVS_FILTER_BY_CONDITION:HM,FILTERS_DIVS_FILTER_BY_VALUE:NM,FILTERS_LABELS_CONJUNCTION:DM,FILTERS_LABELS_DISJUNCTION:ty,FILTERS_NAMESPACE:gr,FILTERS_VALUES_BLANK_CELLS:Aw},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const K$={languageCode:"en-US",[TT]:"No available options",[MT]:"Insert row above",[_T]:"Insert row below",[PT]:"Insert column left",[xT]:"Insert column right",[IT]:["Remove row","Remove rows"],[OT]:["Remove column","Remove columns"],[AT]:"Undo",[HT]:"Redo",[Ow]:"Read only",[NT]:"Clear column",[KT]:"Alignment",[qT]:"Left",[XT]:"Center",[JT]:"Right",[ZT]:"Justify",[QT]:"Top",[eM]:"Middle",[tM]:"Bottom",[VT]:"Freeze column",[BT]:"Unfreeze column",[nM]:"Borders",[rM]:"Top",[iM]:"Right",[oM]:"Bottom",[sM]:"Left",[aM]:"Remove border(s)",[UT]:"Add comment",[zT]:"Edit comment",[YT]:"Delete comment",[GT]:"Read-only comment",[WT]:"Merge cells",[jT]:"Unmerge cells",[DT]:"Copy",[kT]:["Copy with header","Copy with headers"],[$T]:["Copy with group header","Copy with group headers"],[LT]:["Copy header only","Copy headers only"],[FT]:"Cut",[lM]:"Insert child row",[uM]:"Detach from parent",[cM]:["Hide column","Hide columns"],[hM]:["Show column","Show columns"],[dM]:["Hide row","Hide rows"],[fM]:["Show row","Show rows"],[ey]:"None",[gM]:"Is empty",[mM]:"Is not empty",[pM]:"Is equal to",[wM]:"Is not equal to",[vM]:"Begins with",[yM]:"Ends with",[CM]:"Contains",[bM]:"Does not contain",[SM]:"Greater than",[RM]:"Greater than or equal to",[EM]:"Less than",[TM]:"Less than or equal to",[MM]:"Is between",[_M]:"Is not between",[PM]:"After",[xM]:"Before",[IM]:"Today",[OM]:"Tomorrow",[AM]:"Yesterday",[Aw]:"Blank cells",[HM]:"Filter by condition",[NM]:"Filter by value",[DM]:"And",[ty]:"Or",[kM]:"Select all",[$M]:"Clear",[LM]:"OK",[FM]:"Cancel",[VM]:"Search",[BM]:"Value",[WM]:"Second value",[UM]:"Checked",[zM]:"Unchecked"},tie=eie,DR=K$.languageCode,{register:nie,getItem:q$,hasItem:rie,getValues:iie}=lo("languagesDictionaries");X$(K$);function X$(t,e){let n=t,r=e;return De(t)&&(r=t,n=r.languageCode),oie(n,r),nie(n,Qn(r)),Qn(r)}function oie(t,e){t!==DR&&Gre(e,q$(DR))}function J$(t){return YM(t)?Qn(q$(t)):null}function YM(t){return rie(t)}function sie(){return iie()}function Z$(t,e,n){const r=J$(t);if(r===null)return null;const i=r[e];if(Ht(i))return null;const o=aie(i,n);return Array.isArray(o)?o[0]:o}function aie(t,e){let n=t;return _(Zre(),r=>{n=r(t,e)}),n}function lie(t){let e=z$(t);return YM(e)||(e=DR,Y$(t)),e}function uie(t,e,n){return(e=cie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cie(t){var e=hie(t,"string");return typeof e=="symbol"?e:e+""}function hie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xs extends _${constructor(e,n){super(e,null),uie(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function UC(t){let{activeHeaderClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:P$})}function die(t){let{areaCornerVisible:e,...n}=t;return new Xs({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:aT})}function fie(t){let{...e}=t;return new Xs({className:"highlight",...e,selectionType:aT})}function gie(t){let{columnClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:fne})}function mie(t){let{cellCornerVisible:e,...n}=t;return new Xs({className:"current",headerAttributes:[xE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Zd})}function pie(t){let{border:e,visualCellRange:n,...r}=t;return new Xs({...e,...r,selectionType:gne},n)}function wie(t){let{...e}=t;return new Xs({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:hne})}function tO(t){let{headerClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:sT})}function vie(t){let{rowClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:dne})}function yie(t,e){Cie(t,e),e.add(t)}function Cie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e,n){return(e=bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bie(t){var e=Sie(t,"string");return typeof e=="symbol"?e:e+""}function Sie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var po=new WeakSet;class Rie{constructor(e){yie(this,po),vr(this,"options",void 0),vr(this,"layerLevel",0),vr(this,"focus",void 0),vr(this,"fill",void 0),vr(this,"layeredAreas",new Map),vr(this,"areas",new Map),vr(this,"rowHeaders",new Map),vr(this,"columnHeaders",new Map),vr(this,"activeRowHeaders",new Map),vr(this,"activeColumnHeaders",new Map),vr(this,"activeCornerHeaders",new Map),vr(this,"rowHighlights",new Map),vr(this,"columnHighlights",new Map),vr(this,"customSelections",[]),this.options=e,this.focus=mie(e),this.fill=wie(e)}isEnabledFor(e,n){let r=e;e===Zd&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return cs(po,this,hs).call(this,this.layeredAreas,die)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return cs(po,this,hs).call(this,this.areas,fie)}getAreas(){return[...this.areas.values()]}createRowHeader(){return cs(po,this,hs).call(this,this.rowHeaders,tO)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return cs(po,this,hs).call(this,this.columnHeaders,tO)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return cs(po,this,hs).call(this,this.activeRowHeaders,UC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return cs(po,this,hs).call(this,this.activeColumnHeaders,UC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return cs(po,this,hs).call(this,this.activeCornerHeaders,UC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return cs(po,this,hs).call(this,this.rowHighlights,vie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return cs(po,this,hs).call(this,this.columnHighlights,gie)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(pie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),_(this.areas.values(),e=>void e.clear()),_(this.layeredAreas.values(),e=>void e.clear()),_(this.rowHeaders.values(),e=>void e.clear()),_(this.columnHeaders.values(),e=>void e.clear()),_(this.activeRowHeaders.values(),e=>void e.clear()),_(this.activeColumnHeaders.values(),e=>void e.clear()),_(this.activeCornerHeaders.values(),e=>void e.clear()),_(this.rowHighlights.values(),e=>void e.clear()),_(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function hs(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function nO(t,e,n){return(e=Eie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eie(t){var e=Tie(t,"string");return typeof e=="symbol"?e:e+""}function Tie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mie{constructor(e){nO(this,"ranges",[]),nO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function _ie(t,e){Q$(t,e),e.add(t)}function zC(t,e,n){Q$(t,e),e.set(t,n)}function Q$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(pn(t,e))}function mm(t,e,n){return t.set(pn(t,e),n),n}function pn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pm=new WeakMap,Rt=new WeakMap,to=new WeakMap,En=new WeakSet;class kR{constructor(e,n){_ie(this,En),zC(this,pm,void 0),zC(this,Rt,void 0),zC(this,to,{x:0,y:0}),mm(pm,this,e),mm(Rt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Je(Rt,this).createCellCoords(e,n);let o=Je(pm,this).current().highlight;const s=Je(Rt,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=pn(En,this,eL).call(this),{row:h,col:d}=pn(En,this,iO).call(this,o),f=Je(Rt,this).fixedRowsBottom(),g=Je(Rt,this).minSpareRows(),v=Je(Rt,this).minSpareCols(),y=Je(Rt,this).autoWrapRow(),E=Je(Rt,this).autoWrapCol(),C=Je(Rt,this).createCellCoords(h+i.row,d+i.col);if(C.row>=c){const P=Hr(r&&g>0&&f===0),T=C.col+1,O=Je(Rt,this).createCellCoords(C.row-c,T>=u?T-u:T);this.runLocalHooks("beforeColumnWrap",P,pn(En,this,zu).call(this,O),T>=u),P.value?this.runLocalHooks("insertRowRequire",Je(Rt,this).countRenderableRows()):E&&C.assign(O)}else if(C.row<0){const P=Hr(E),T=C.col-1,O=Je(Rt,this).createCellCoords(c+C.row,T<0?u+T:T);this.runLocalHooks("beforeColumnWrap",P,pn(En,this,zu).call(this,O),T<0),E&&C.assign(O)}if(C.col>=u){const P=Hr(r&&v>0),T=C.row+1,O=Je(Rt,this).createCellCoords(T>=c?T-c:T,C.col-u);this.runLocalHooks("beforeRowWrap",P,pn(En,this,zu).call(this,O),T>=c),P.value?this.runLocalHooks("insertColRequire",Je(Rt,this).countRenderableColumns()):y&&C.assign(O)}else if(C.col<0){const P=Hr(y),T=C.row-1,O=Je(Rt,this).createCellCoords(T<0?c+T:T,u+C.col);this.runLocalHooks("beforeRowWrap",P,pn(En,this,zu).call(this,O),T<0),y&&C.assign(O)}const{rowDir:M,colDir:x}=pn(En,this,rO).call(this,C);a=M,l=x,o=pn(En,this,zu).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Je(Rt,this).createCellCoords(e,n),i=Je(pm,this).current(),o=Je(Rt,this).visualToRenderableCoords(i.highlight),s=pn(En,this,YC).call(this,i.to.row,i.from.row),a=pn(En,this,GC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=pn(En,this,iO).call(this,i.highlight),f=Je(Rt,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),v=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const x=f.col-d;f.col=pn(En,this,GC).call(this,g.col,v.col)+x}else if(r.col>0&&a<=d&&f.col>d){const x=pn(En,this,GC).call(this,v.col,g.col),P=Math.max(f.col-x,1);f.col=x+P}if(r.row<0&&s>=h&&f.row<h){const x=f.row-h;f.row=pn(En,this,YC).call(this,g.row,y.row)+x}else if(r.row>0&&s<=h&&f.row>h){const x=pn(En,this,YC).call(this,y.row,g.row),P=Math.max(f.row-x,1);f.row=x+P}const{rowDir:E,colDir:C}=pn(En,this,rO).call(this,f);u=E,c=C;const M=pn(En,this,zu).call(this,f);r.row===0&&r.col!==0?l.col=M.col:r.row!==0&&r.col===0?l.row=M.row:(l.row=M.row,l.col=M.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;mm(to,this,{x:n,y:r})}resetOffsetSize(){mm(to,this,{x:0,y:0})}}function rO(t){const{width:e,height:n}=pn(En,this,eL).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function eL(){return{width:Je(to,this).x+Je(Rt,this).countRenderableColumns(),height:Je(to,this).y+Je(Rt,this).countRenderableRows()}}function YC(t,e){const n=Je(Rt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Je(to,this).y+n}function GC(t,e){const n=Je(Rt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Je(to,this).x+n}function iO(t){const{row:e,col:n}=Je(Rt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Je(Rt,this).createCellCoords(Je(to,this).y+e,Je(to,this).x+n)}function zu(t){const e=t.clone();return e.col=t.col-Je(to,this).x,e.row=t.row-Je(to,this).y,Je(Rt,this).renderableToVisualCoords(e)}mt(kR,Fn);const ny=0,ry=1,tL=2,GM=3,Pie=[GM,tL],xie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],KC=Symbol("root"),oO=Symbol("child");function th(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KC;if(e!==KC&&e!==oO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===KC;let i=ny;if(n){const o=t[0];t.length===0?i=ry:r&&o instanceof yg?i=GM:r&&Array.isArray(o)?i=th(o,oO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!xie[l].includes(typeof a))&&(i=tL)}return i}function $f(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Pie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===GM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ht(u)&&(u=a),Ht(c)&&(c=l),!r){const f=a,g=l,v=u,y=c;a=Math.min(f,v),l=Math.min(g,y),u=Math.max(f,v),c=Math.max(g,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Iie(t){const e=th(t.getSelected());if(e===ny||e===ry)return[];const n=$f(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Sn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Oie(t){const e=th(t.getSelected());if(e===ny||e===ry)return[];const n=$f(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Sn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Yu(t,e,n){Aie(t,e),e.set(t,n)}function Aie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function al(t,e,n){return(e=Hie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hie(t){var e=Nie(t,"string");return typeof e=="symbol"?e:e+""}function Nie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function It(t,e){return t.get(nL(t,e))}function wo(t,e,n){return t.set(nL(t,e),n),n}function nL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap,ll=new WeakMap,wm=new WeakMap,Qh=new WeakMap,vm=new WeakMap,ed=new WeakMap;class rL{constructor(e,n){var r=this;al(this,"settings",void 0),al(this,"tableProps",void 0),al(this,"inProgress",!1),al(this,"selectedRange",new Mie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),al(this,"highlight",void 0),Yu(this,Bn,void 0),Yu(this,ll,void 0),al(this,"selectedByRowHeader",new Set),al(this,"selectedByColumnHeader",new Set),Yu(this,wm,!1),Yu(this,Qh,!1),Yu(this,vm,"unknown"),Yu(this,ed,-1),this.settings=e,this.tableProps=n,this.highlight=new Rie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[xE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),wo(Bn,this,new kR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),wo(ll,this,new kR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),It(Bn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),It(Bn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),It(Bn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),It(Bn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),It(Bn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),It(Bn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),It(Bn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),It(Bn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),It(ll,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),It(ll,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){wo(vm,this,e)}markEndSource(){wo(vm,this,"unknown")}getSelectionSource(){return It(vm,this)}setExpectedLayers(e){wo(ed,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,wo(ed,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ht(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();wo(wm,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ht(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=It(ed,this)===-1||this.selectedRange.size()===It(ed,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(_(this.highlight.getAreas(),g=>void g.clear()),_(this.highlight.getLayeredAreas(),g=>void g.clear()),_(this.highlight.getRowHeaders(),g=>void g.clear()),_(this.highlight.getColumnHeaders(),g=>void g.clear()),_(this.highlight.getActiveRowHeaders(),g=>void g.clear()),_(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),_(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),_(this.highlight.getRowHighlights(),g=>void g.clear()),_(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(aT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(sT,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(C).commit(),d.add(y).commit(),f.add(C).commit()):(a.add(y).add(E).commit(),l.add(C).add(M).commit(),d.add(y).add(E).commit(),f.add(C).add(M).commit())}const g=!It(Qh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!It(Qh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Zd,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(wo(wm,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?It(Bn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):It(Bn,this).resetOffsetSize(),this.setRangeStart(It(Bn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?It(Bn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):It(Bn,this).resetOffsetSize(),this.setRangeEnd(It(Bn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?It(ll,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):It(ll,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=It(ll,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ye(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ye(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ye(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ye(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ye(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ye(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Hr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&It(wm,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;wo(Qh,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ye(d.row,u,o-1),Ye(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),wo(Qh,this,!1)}selectCells(e){var n=this;const r=th(e);if(r===ry)return!1;if(r===ny)throw new Error(ht`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=$f(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),_(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ye(r.row,u,s-1),g=Ye(r.col,Math.min(i,o),Math.max(i,o))):(f=Ye(r,u,s-1),g=i);const v=this.tableProps.createCellCoords(f,g),y=l===0?0:Ye(v.row,u,-1),E=s-1,C=this.tableProps.createCellCoords(y,i),M=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",C,M,v),C.row=y,M.row=E,this.setRangeStartOnly(C,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",C,M,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ye(r.row,Math.min(e,n),Math.max(e,n)),d=Ye(r.col,a,o-1)):(h=e,d=Ye(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Ye(f.col,a,-1),v=o-1,y=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",y,E,f),y.col=g,E.col=v,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",y,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Ye(s.row,-1/0,e-1),col:Ye(s.col,-1/0,n-1)}),i.assign({row:Ye(i.row,-1/0,e-1),col:Ye(i.col,-1/0,n-1)}),o.assign({row:Ye(o.row,0,e-1),col:Ye(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(Zd,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Zd,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}mt(rL,Fn);const sO=/^(\r\n|\n\r|\r|\n)/,Die=/^[^\t\r\n]+/,aO=/^\t/;function kie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(aO))t=t.replace(aO,""),n+=1,e[r][n]="";else if(t.match(sO))t=t.replace(sO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Die);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function ef(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ul(t,e,n){return(e=$ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:e+""}function Lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){ul(this,"hot",void 0),ul(this,"metaManager",void 0),ul(this,"tableMeta",void 0),ul(this,"dataSource",void 0),ul(this,"duckSchema",void 0),ul(this,"colToPropCache",void 0),ul(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=zv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(De(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return vT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&ke(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Qc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Qn(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},wg(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const v=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(v,n));const y=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",y,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];fR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return fk(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];fR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&ln(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Hr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Hr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&ln(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Oc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Oc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return ef(this.getRange(e,n,Oc.DESTINATION_RENDERER))}getCopyableText(e,n){return ef(this.getRange(e,n,Oc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:Fie,getItem:Vie,hasItem:iL,getNames:Bie,getValues:y0e}=lo("cellTypes");function KM(t){if(!iL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Vie(t)}function ci(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Mr(t,n),r&&Wr(t,r),i&&Gl(t,i),Fie(t,e)}function Wie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!ln(e,t)}function iy(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?KM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ke(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!De(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};ke(r,(o,s)=>{if(Wie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),cn(t,i)}function jie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Uk(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Vp(t){return Number.isInteger(t)&&t>=0}function Bp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function ym(t){return t==null}const oL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Yt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Yt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Uv(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function lO(t,e,n){return(e=Uie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uie(t){var e=zie(t,"string");return typeof e=="symbol"?e:e+""}function zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yie(){return class{}}class Gie{constructor(e){lO(this,"metaCtor",Yie()),lO(this,"meta",void 0),this.meta=this.metaCtor.prototype,cn(this.meta,oL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;cn(this.meta,e),iy(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Kie(t,e,n){return(e=qie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qie(t){var e=Xie(t,"string");return typeof e=="symbol"?e:e+""}function Xie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jie{constructor(e){Kie(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){cn(this.meta,e),iy(this.meta,e,e)}}function Cm(t,e,n){return(e=Zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zie(t){var e=Qie(t,"string");return typeof e=="symbol"?e:e+""}function Qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hw{constructor(e){Cm(this,"valueFactory",void 0),Cm(this,"data",[]),Cm(this,"index",[]),Cm(this,"holes",new Set),this.valueFactory=e}obtain(e){Bp(()=>Vp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Bp(()=>Vp(e)||ym(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=ym(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Bp(()=>Vp(e)||ym(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(ym(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function uO(t,e,n){return(e=eoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eoe(t){var e=toe(t,"string");return typeof e=="symbol"?e:e+""}function toe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const noe=["data","width"];class roe{constructor(e){uO(this,"globalMeta",void 0),uO(this,"metas",new Hw(()=>this._createMeta())),this.globalMeta=e,this.metas=new Hw(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);cn(r,n),iy(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return jie(this.globalMeta.getMetaConstructor(),noe).prototype}}function cO(t,e,n){return(e=ioe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ioe(t){var e=ooe(t,"string");return typeof e=="symbol"?e:e+""}function ooe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class soe{constructor(e){cO(this,"columnMeta",void 0),cO(this,"metas",new Hw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);cn(i,r),iy(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Bp(()=>Vp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Hw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class sL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Gie(e),this.tableMeta=new Jie(this.globalMeta),this.columnMeta=new roe(this.globalMeta),this.cellMeta=new soe(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mt(sL,Fn);function hO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Zn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ut(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Oc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let v,y=0,E=0;for(y=0,E=d.startRows;y<E;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Qn(g),t.push(v);else if(i.dataType==="array")v=Qn(g[0]),t.push(v);else{v=[];for(let C=0,M=d.startCols;C<M;C++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&be(i.rootElement,[Sk(-1),Fv(i.countCols()+(i.view?i.countRowHeaders():0))])}function dO(t,e,n){return(e=aoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aoe(t){var e=loe(t,"string");return typeof e=="symbol"?e:e+""}function loe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uoe{constructor(e){var n=this;dO(this,"metaManager",void 0),dO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),oe.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=ln(e,"type")?e.type:null;let c=ut(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function coe(t,e,n){hoe(t,e),e.set(t,n)}function hoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qC(t,e,n){return(e=doe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function doe(t){var e=foe(t,"string");return typeof e=="symbol"?e:e+""}function foe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function goe(t,e){return t.get(moe(t,e))}function moe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fO=new WeakMap;class poe{constructor(e){qC(this,"metaManager",void 0),qC(this,"usageTracker",new Set),qC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),coe(this,fO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,goe(fO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const aL="gridDefault",Xa="editorManager.handlingEditor",woe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},voe="hooksRefRegisterer",lL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){_(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ke(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ts(lL,"MIXIN_NAME",voe,{writable:!1,enumerable:!1});function ki(t,e,n){return(e=yoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yoe(t){var e=Coe(t,"string");return typeof e=="symbol"?e:e+""}function Coe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const boe="base",Jt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Ch{static get EDITOR_TYPE(){return boe}constructor(e){ki(this,"hot",void 0),ki(this,"state",Jt.VIRGIN),ki(this,"_opened",!1),ki(this,"_fullEditMode",!1),ki(this,"_closeCallback",null),ki(this,"TD",null),ki(this,"row",null),ki(this,"col",null),ki(this,"prop",null),ki(this,"originalValue",null),ki(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Jt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Jt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Jt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Tt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Jt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Jt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Jt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Jt.FINISHED,this.discardEditor(s)}):(this.state=Jt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Jt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Jt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Jt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Jt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Jt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Ln(n),a=Qt(n),l=Ln(this.hot.rootElement),u=Qt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,E=["master","inline_start"].includes(y)?d:0,C=["master","top","bottom"].includes(y)?f:0,M=s.top===l.top?0:1;let x=s.top-l.top-M-E,P=0;this.hot.isRtl()?P=o.innerWidth-s.left-a-g-1+C:P=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(y)&&(x+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(P+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const T=this.hot.hasColHeaders(),O=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),G=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),V=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(T&&O<=0||O===V)&&(x+=1),G<=0&&(P+=1);const X=i.rowsRenderCalculator.startPosition,ne=i.columnsRenderCalculator.startPosition,Q=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),pe=_n(this.hot.rootDocument);let et=n.offsetTop;if(["inline_start","master"].includes(y)&&(et+=X-te),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:K,wtTable:J}=r.bottomOverlay.clone;et+=K.getWorkspaceHeight()-J.getHeight()-pe}let Re=n.offsetLeft;this.hot.isRtl()?(Re>=0?Re=v.getWidth()-n.offsetLeft:Re=Math.abs(Re),Re+=ne-Q-a):["top","master","bottom"].includes(y)&&(Re+=ne-Q);const Ae=o.getComputedStyle(this.TD),st=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Pn=parseInt(Ae[st],10)>0?0:1,at=parseInt(Ae.borderTopWidth,10)>0?0:1,m=Qt(n)+Pn,w=un(n)+at,p=DE(c)?pe:0,A=kE(h)?pe:0,L=this.hot.view.maximumVisibleElementWidth(Re)-p+Pn,j=Math.max(this.hot.view.maximumVisibleElementHeight(et)-A+at,this.hot.view.getDefaultRowHeight());return{top:x,start:P,height:w,maxHeight:j,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}mt(Ch,lL);const Soe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Jt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},Roe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},Eoe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Toe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Moe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Ii(e))}};function _oe(){return[woe,Soe,Roe,Eoe,Toe,Moe]}const Poe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},xoe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},Ioe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},Ooe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},Aoe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},Hoe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Noe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Doe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},koe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},$oe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Loe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Foe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},Voe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},Boe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Woe(){return[Poe,xoe,Ioe,Ooe,Aoe,Hoe,Noe,Doe,koe,$oe,Loe,Foe,Voe,Boe]}const joe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Uoe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},zoe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},Yoe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},Goe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Koe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},qoe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},Xoe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},Joe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Zoe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},Qoe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},ese={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},tse={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},nse={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},rse={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},ise={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function ose(){return[joe,Uoe,zoe,Yoe,Goe,Koe,qoe,Xoe,Joe,Zoe,Qoe,ese,tse,nse,rse,ise]}const sse={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},ase={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},lse={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},use={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},cse={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},hse=[..._oe(),...Woe(),...ose(),sse,ase,lse,use,cse];function uL(t){const e={};return hse.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function dse(t){const e=t.getShortcutManager().addContext("editor"),n=uL(t),r={group:Xa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function fse(t){const e=t.getShortcutManager().addContext("grid"),n=uL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:aL};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Xa,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function gse(t){[fse,dse].forEach(e=>e(t))}function mse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=gO(t),i=gO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function gO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&be(n,[xf("Focus catcher")]),n}function pse(t){const e=wse(t);let n;const{activate:r,deactivate:i}=mse(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:$R(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:LR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:aL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?$R(t):LR(t)),u(),!1;h.preventDefault()},position:"after"}])}function $R(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function LR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function wse(t){return e=>{if(!e)return null;const n=$R(t),r=LR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function bh(t){zo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function oy(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,v=f<=h,y=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:v&&y?r.highlight.row:v?f:y?g:E.row}}}function vse(t){return e=>{const n=oy(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;bh(t.getCell(r?-1:0,n,!0))})}}function yse(){return()=>{}}function Cse(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;bh(t.getCell(n,r,!0))})}}function bse(t){return e=>{const n=oy(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;bh(t.getCell(i,o,!0))})}}function Sse(t){return e=>{const n=oy(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;bh(t.getCell(i,o,!0))})}}function Rse(t){return e=>{const n=oy(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;bh(t.getCell(n,r?-1:0,!0))})}}function Ese(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{bh(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function Tse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=Cse(t):e.isSelectedByCorner()?s=yse():e.isSelectedByRowHeader()?s=Rse(t):e.isSelectedByColumnHeader()?s=vse(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=bse(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=Ese(t):e.getSelectedRange().size()>1&&(s=Sse(t)),(o=s)===null||o===void 0||o(i)}}}const mO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),bm=t=>t.map(e=>{const n=e.toLowerCase();return mO.has(n)?mO.get(n):n}).sort().join("+"),Mse=t=>t.split("+"),pO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),XC=t=>{let{which:e,key:n}=t;if(pO.has(e))return pO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},cL=Symbol("shortcut-context");function hL(t){return De(t)&&t.__kindOf===cL}const _se=t=>{const e=Kv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:v,position:y,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ht(c))throw new Error("You need to define the shortcut's group.");if(ut(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ht`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(v)&&(C.relativeToGroup=v,C.position=y),hL(E)&&(C.forwardToContext=E),l.forEach(M=>{const x=bm(M);if(e.hasItem(x)){const T=e.getItem(x);let O=T.findIndex(G=>G.group===v);O!==-1?y==="before"?O-=1:O+=1:O=T.length,T.splice(O,0,C)}else e.addItem(x,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ke(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=bm(l);e.removeItem(u)};return{__kindOf:cL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=bm(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=bm(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(Mse(h)):(d.length=0,d.push(...f))})}}};function Pse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const xse=["meta","alt","shift","control"],td=Pse(),nd=[];let Sm=0;function Ise(t,e,n,r,i){const o=f=>xse.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),g&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Sa(f))return;const v=XC(f);let y=[];o(v)||(y=s(f));const E=[v].concat(y);!i(f,E)&&(_w()&&y.includes("meta")||!_w()&&y.includes("control"))&&i(f,[v].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=XC(f);o(g)&&td.press(g)}},u=f=>{if(typeof f.key=="string"){const g=XC(f);o(g)&&td.release(g)}},c=()=>{td.releaseAll()};return{mount:()=>{let f=t;for(Sm+=1;f;)Sm===1&&(f.document.documentElement.addEventListener("keydown",l),nd.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),nd.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=cu(f)},unmount:()=>{let f=t;for(Sm-=1;f;){if(Sm===0){for(let g=0;g<nd.length;g++){const{event:v,listener:y}=nd[g];f.document.documentElement.removeEventListener(v,y)}nd.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=cu(f)}},isPressed:f=>td.isPressed(f),releasePressedKeys:()=>td.releaseAll()}}const Ose=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Kv({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const v=_se(g);return o.addItem(g,v),v},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(ht`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=hL(y)?y:u(y);let C=!1;if(!E.hasShortcut(v))return C;const M=E.getShortcuts(v);for(let x=0;x<M.length;x++){const{callback:P,runOnlyIf:T,preventDefault:O,stopPropagation:G,captureCtrl:U,forwardToContext:V}=M[x];if(T(g)===!0){if(h=U,C=P(g,v)===!1,h=!1,O&&g.preventDefault(),G&&(Ii(g),g.stopPropagation()),C)break;V&&d(g,v,V)}}return C},f=Ise(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function wO(t){const{classNames:e}=_k(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let JC=null;const ZC=new Map;function dL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Ei(o);let a,l,u,c,h,d,f=!0;Xne(i)&&qne(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=lie(e.language);const y=Object.fromEntries(Object.entries(e).filter(m=>{let[w]=m;return!(oe.getSingleton().isRegistered(w)||oe.getSingleton().isDeprecated(w))})),E=new sL(o,y,[uoe,poe]),C=E.getTableMeta(),M=E.getGlobalMeta(),x=Kv();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),Fp(this)&&(vk(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${TE()}`,ZC.set(this.guid,this),this.columnIndexMapper=new NR,this.rowIndexMapper=new NR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new vre(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getRenderableFromVisualIndex(w):w,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},T=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getVisualFromRenderableIndex(w):w,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},O=(m,w)=>{const p=w>m?1:-1,A=Math.min(m,w),L=Math.max(m,w),j=o.rowIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<A?null:j>=0?o.rowIndexMapper.getRenderableFromVisualIndex(j):j},G=(m,w)=>{const p=w>m?1:-1,A=Math.min(m,w),L=Math.max(m,w),j=o.columnIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<A?null:j>=0?o.columnIndexMapper.getRenderableFromVisualIndex(j):j};let U=new rL(C,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,w)=>o._createCellCoords(m,w),createCellRange:(m,w,p)=>o._createCellRange(m,w,p),visualToRenderableCoords:P,renderableToVisualCoords:T,findFirstNonHiddenRenderableRow:O,findFirstNonHiddenRenderableColumn:G,isDisabledCellSelection:(m,w)=>m<0||w<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,w).disableVisualSelection});this.selection=U;const V=m=>{let{hiddenIndexesChanged:w}=m;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("afterSetRangeEnd",(m,w)=>{const p=Hr(!1),A=this.selection.getSelectedRange(),{from:L,to:j}=A.current(),K=A.size()-1;this.runHooks("afterSelection",L.row,L.col,j.row,j.col,p,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),j.row,o.colToProp(j.col),p,K),w&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m);const J=U.isSelectedByRowHeader(),b=U.isSelectedByColumnHeader();J&&b?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(we(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):b?(we(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),U.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const w=Hr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const w=m.length-1,{from:p,to:A}=m[w];this.runHooks("afterSelectionEnd",p.row,p.col,A.row,A.col,w),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),A.row,o.colToProp(A.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const w=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const j=K=>{if(K.length===0)return[];const J=[...K];return J.sort((R,S)=>{let[$]=R,[I]=S;return $===I?0:$>I?1:-1}),Sn(J,(R,S)=>{let[$,I]=S;const N=R[R.length-1],[W,H]=N,D=W+H;if($<=D){const B=Math.max(I-(D-$),0);N[1]+=B}else R.push([$,I]);return R},[J[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(C.maxRows===K)return;const J=m==="insert_row_below"?"below":"above";w=w??(J==="below"?K:0);const{delta:b,startPhysicalIndex:R}=a.createRow(w,p,{source:A,mode:J});U.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";w=w??(S==="end"?o.countSourceCols():0);const{delta:$,startPhysicalIndex:I}=a.createCol(w,p,{source:A,mode:S});if($){if(Array.isArray(C.colHeaders)){const H=[o.toVisualColumn(I),0];H.length+=$,Array.prototype.splice.apply(C.colHeaders,H)}U.shiftColumns(o.toVisualColumn(I),$)}break;case"remove_row":const N=H=>{let D=0;_(H,B=>{let[F,Y]=B;const ae=Yt(F)?o.countRows()-1:Math.max(F-D,0);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeRow(F,Y,A))return;if(U.isSelected()){const{row:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+Y-1&&c.closeEditor(!0)}const _e=o.countRows(),Fe=C.fixedRowsTop;Fe>=ae+1&&(C.fixedRowsTop-=Math.min(Y,Fe-ae));const ze=C.fixedRowsBottom;ze&&ae>=_e-ze&&(C.fixedRowsBottom-=Math.min(Y,ze)),_e===0?U.deselect():A==="ContextMenu.removeRow"?U.refresh():U.shiftRows(F,-Y),D+=Y})};Array.isArray(w)?N(j(w)):N([[w,p]]);break;case"remove_col":const W=H=>{let D=0;_(H,B=>{let[F,Y]=B;const ae=Yt(F)?o.countCols()-1:Math.max(F-D,0);let ce=o.toPhysicalColumn(ae);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeCol(F,Y,A))return;if(U.isSelected()){const{col:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+Y-1&&c.closeEditor(!0)}o.countCols()===0?U.deselect():A==="ContextMenu.removeColumn"?U.refresh():U.shiftColumns(F,-Y);const ze=C.fixedColumnsStart;ze>=ae+1&&(C.fixedColumnsStart-=Math.min(Y,ze-ae)),Array.isArray(C.colHeaders)&&(typeof ce>"u"&&(ce=-1),C.colHeaders.splice(ce,Y)),D+=Y})};Array.isArray(w)?W(j(w)):W([[w,p]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=C.minRows,w=C.minSpareRows,p=C.minCols,A=C.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(w){const L=o.countEmptyRows(!0);if(L<w){const j=w-L,K=Math.min(j,C.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(p||A)&&(L=o.countEmptyCols(!0));let j=o.countCols();if(p&&!C.columns&&j<p){const K=p-j;L+=K,a.createCol(j,K,{source:"auto"})}if(A&&!C.columns&&o.dataType==="array"&&L<A){j=o.countCols();const K=A-L,J=Math.min(K,C.maxCols-j);a.createCol(j,J,{source:"auto"})}}},populateFromArray(m,w,p,A,L){let j,K,J,b;const R=[],S={},$=[],I=m.row,N=m.col;if(K=w.length,K===0)return!1;let W=0,H=0;switch(De(p)&&(W=p.col-N+1,H=p.row-I+1),L){case"shift_down":const D=Gd(w),B=D.length,F=Math.max(B,W),Y=o.getData().slice(I),ae=Gd(Y).slice(N,N+F);for(J=0;J<F;J+=1)if(J<B){for(j=0,K=D[J].length;j<H-K;j+=1)D[J].push(D[J][j%K]);J<ae.length?$.push(D[J].concat(ae[J])):$.push(D[J].concat(new Array(Y.length).fill(null)))}else $.push(D[J%B].concat(ae[J]));o.populateFromArray(I,N,Gd($));break;case"shift_right":const ce=w.length,_e=Math.max(ce,H),Fe=o.getData().slice(I).map(Pt=>Pt.slice(N));for(j=0;j<_e;j+=1)if(j<ce){for(J=0,b=w[j].length;J<W-b;J+=1)w[j].push(w[j][J%b]);if(j<Fe.length)for(let Pt=0;Pt<Fe[j].length;Pt+=1)w[j].push(Fe[j][Pt]);else w[j].push(...new Array(Fe[0].length).fill(null))}else w.push(w[j%K].slice(0,_e).concat(Fe[j]));o.populateFromArray(I,N,w);break;case"overwrite":default:S.row=m.row,S.col=m.col;let ze=0,Me=0,Ve=!0,_t;const Ai=function(gn){let bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const xt=w[gn%w.length];return bt!==null?xt[bt%xt.length]:xt},rs=w.length,ni=p?p.row-m.row+1:0;for(p?K=ni:K=Math.max(rs,ni),j=0;j<K&&!(p&&S.row>p.row&&ni>rs||!C.allowInsertRow&&S.row>o.countRows()-1||S.row>=C.maxRows);j++){const Pt=j-ze,gn=Ai(Pt).length,bt=p?p.col-m.col+1:0;if(p?b=bt:b=Math.max(gn,bt),S.col=m.col,_t=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&_t.skipRowOnPaste){ze+=1,S.row+=1,K+=1;continue}for(Me=0,J=0;J<b&&!(p&&S.col>p.col&&bt>gn||!C.allowInsertColumn&&S.col>o.countCols()-1||S.col>=C.maxCols);J++){if(_t=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&_t.skipColumnOnPaste){Me+=1,S.col+=1,b+=1;continue}if(_t.readOnly&&A!=="UndoRedo.undo"){S.col+=1;continue}const xt=J-Me;let Be=Ai(Pt,xt),ri=o.getDataAtCell(S.row,S.col);if(Be!==null&&typeof Be=="object")if(Array.isArray(Be)&&ri===null&&(ri=[]),ri===null||typeof ri!="object")Ve=!1;else{const Ja=Qc(Array.isArray(ri)?ri:ri[0]||ri),Za=Qc(Array.isArray(Be)?Be:Be[0]||Be);Uv(Ja,Za)||Array.isArray(Ja)&&Array.isArray(Za)?Be=Qn(Be):Ve=!1}else ri!==null&&typeof ri=="object"&&(Ve=!1);Ve&&R.push([S.row,S.col,Be]),Ve=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,A||"populateFromArray");break}}};function X(m){const w=z$(m);YM(w)?(o.runHooks("beforeLanguageChange",w),M.language=w,o.runHooks("afterLanguageChange",w)):Y$(m)}function ne(m,w){const p=m==="className"?o.rootElement:o.table;if(f)q(p,w);else{let A=[],L=[];M[m]&&(A=Array.isArray(M[m])?M[m]:mR(M[m])),w&&(L=Array.isArray(w)?w:mR(w));const j=gR(A,L),K=gR(L,A);j.length&&we(p,j),K.length&&q(p,K)}M[m]=w}this.init=function(){l.setData(C.data),o.runHooks("beforeInit"),(jo()||UE())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new ere(this);const m=C.themeName||wO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=ER.getInstance(o,C,U),d=Tse(o),h=new RZ(o),Fp(this)&&pse(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&kk(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function Q(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const w=m.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):m}function pe(m,w,p){if(!m.length){p();return}const A=o.getActiveEditor(),L=new Q;let j=!0;L.onQueueEmpty=()=>{A&&j&&A.cancelChanges(),p()};for(let K=m.length-1;K>=0;K--){const[J,b]=m[K],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(J,R):S={...Object.getPrototypeOf(C),...C},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function($,I){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&I.allowInvalid===!1&&(j=!1,m.splice($,1),I.valid=!0),L.removeValidatorFormQueue()}}(K,S),w))}L.checkIfQueueIsEmpty()}function et(m,w){for(let A=m.length-1;A>=0;A--){let L=!1;if(m[A]===null){m.splice(A,1);continue}if(!((m[A][2]===null||m[A][2]===void 0)&&(m[A][3]===null||m[A][3]===void 0))){if(C.allowInsertRow)for(;m[A][0]>o.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}if(o.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(m[A][1])>o.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}L||a.set(m[A][0],m[A][1],m[A][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,w),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,w||"edit");const A=o.getActiveEditor();A&&le(A.refreshValue)&&A.refreshValue()}else o.render()}this._createCellCoords=function(m,w){return o.view._wt.createCellCoords(m,w)},this._createCellRange=function(m,w,p){return o.view._wt.createCellRange(m,w,p)},this.validateCell=function(m,w,p,A){let L=o.getCellValidator(w);function j(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){p(K);return}const b=w.visualCol,R=w.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const $=o.rowIndexMapper.getRenderableFromVisualIndex(R),I=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",$,I,S)}p(K)}wk(L)&&(L=function(K){return function(J,b){b(K.test(J))}}(L)),ut(L)?(m=o.runHooks("beforeValidate",m,w.visualRow,w.prop,A),o._registerImmediate(()=>{L.call(w,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,w.visualRow,w.prop,A),w.valid=K,j(K),o.runHooks("postAfterValidate",K,m,w.visualRow,w.prop,A))})})):o._registerImmediate(()=>{w.valid=!0,j(w.valid,!1)})};function Re(m,w,p){return Array.isArray(m)?m:[[m,w,p]]}function Ae(m,w){const p=o.runHooks("beforeChange",m,w||"edit"),A=m.filter(j=>j!==null);if(p===!1||A.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let j=A.length-1;j>=0;j--){const[K,J,,b]=A[j],R=a.propToCol(J);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(C),...C};const{type:$,checkedTemplate:I,uncheckedTemplate:N}=S;if($==="numeric"&&typeof b=="string"&&d$(b)&&(A[j][3]=te(b)),$==="checkbox"){const W=Tt(b),H=W===Tt(I),D=W===Tt(N);(H||D)&&(A[j][3]=H?I:N)}}return A}this.setDataAtCell=function(m,w,p,A){const L=Re(m,w,p),j=[];let K=A,J,b,R;for(J=0,b=L.length;J<b;J++){if(typeof L[J]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[J][1]>=this.countCols()?R=L[J][1]:R=a.colToProp(L[J][1]),j.push([L[J][0],R,l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]])}!K&&typeof m=="object"&&(K=w);const S=Ae(j,K);o.runHooks("afterSetDataAtCell",S,K),pe(S,K,()=>{et(S,K)})},this.setDataAtRowProp=function(m,w,p,A){const L=Re(m,w,p),j=[];let K=A,J,b;for(J=0,b=L.length;J<b;J++)j.push([L[J][0],L[J][1],l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]]);!K&&typeof m=="object"&&(K=w);const R=Ae(j,A);o.runHooks("afterSetDataAtRowProp",R,K),pe(R,K,()=>{et(R,K)})},this.listen=function(){o&&!o.isListening()&&(ZC.forEach(m=>{o!==m&&m.unlisten()}),JC=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(JC=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return JC===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),w&&U.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,w,p,A,L,j,K){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const J=typeof A=="number"?o._createCellCoords(A,L):null;return u.populateFromArray(o._createCellCoords(m,w),p,J,j,K)},this.spliceCol=function(m,w,p){for(var A=arguments.length,L=new Array(A>3?A-3:0),j=3;j<A;j++)L[j-3]=arguments[j];return a.spliceCol(m,w,p,...L)},this.spliceRow=function(m,w,p){for(var A=arguments.length,L=new Array(A>3?A-3:0),j=3;j<A;j++)L[j-3]=arguments[j];return a.spliceRow(m,w,p,...L)},this.getSelected=function(){if(U.isSelected())return Ue(U.getSelectedRange(),m=>{let{from:w,to:p}=m;return[w.row,w.col,p.row,p.col]})},this.getSelectedLast=function(){const m=this.getSelected();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.emptySelectedCells=function(m){if(!U.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];_(U.getSelectedRange(),p=>{if(p.isSingleHeader())return;const A=p.getTopStartCorner(),L=p.getBottomEndCorner();fe(A.row,L.row,j=>{fe(A.col,L.col,K=>{this.getCellMeta(j,K).readOnly||w.push([j,K,null])})})}),w.length>0&&this.setDataAtCell(w,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const w=m();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=m();return this.resumeExecution(w),p},this.batch=function(m){this.suspendRender(),this.suspendExecution();const w=m();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:w,height:p}=m.getLastSize(),{width:A,height:L}=o.rootElement.getBoundingClientRect(),j=A!==w||L!==p;o.runHooks("beforeRefreshDimensions",{width:w,height:p},{width:A,height:L},j)!==!1&&((j||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(A,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:w,height:p},{width:A,height:L},j))},this.updateData=function(m,w){hO(m,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),U.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:E,firstRun:f})},this.loadData=function(m,w){hO(m,p=>{a=p},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),U.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=C.columns;let w=0;if(Array.isArray(m))w=m.length;else if(ut(m))if(o.dataType==="array"){const p=this.countSourceCols();for(let A=0;A<p;A+=1)m(A)&&(w+=1)}else(o.dataType==="object"||o.dataType==="function")&&(w=a.colToPropCache.length);else if(le(C.dataSchema)){const p=a.getSchema();w=Array.isArray(p)?p.length:zv(p)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,w,p,A){return Ht(m)?a.getAll():a.getRange(o._createCellCoords(m,w),o._createCellCoords(p,A),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,w,p,A){return a.getCopyableText(o._createCellCoords(m,w),o._createCellCoords(p,A))},this.getCopyableData=function(m,w){return a.getCopyable(m,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(f?o.loadData:o.updateData).bind(this);let A=!1,L,j;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&X(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")ne("className",m.className);else if(L==="tableClassName"&&o.table)ne("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(oe.getSingleton().isRegistered(L)||oe.getSingleton().isDeprecated(L)){const S=m[L];ut(S)?(oe.getSingleton().addAsFixed(L,S,o),C[L]=S):Array.isArray(S)&&(oe.getSingleton().add(L,S,o),C[L]=S)}else!w&&ln(m,L)&&(M[L]=m[L]);m.data===void 0&&C.data===void 0?p(null,"updateSettings"):m.data!==void 0?p(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),J=C.columns;if(J&&ut(J)&&(A=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),K>0)for(L=0,j=0;L<K;L++){if(J){const S=A?J(L):J[j];S&&E.updateColumnMeta(j,S)}j+=1}le(m.cell)&&ke(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(ut(R)&&(R=R()),w&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;ut(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!w){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),$=ln(m,"themeName");S&&$&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const I=$&&m.themeName||wO(o.rootElement);o.useTheme(I),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!w&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(C.getValue){if(ut(C.getValue))return C.getValue.call(o);if(m)return o.getData()[m[0][0]][C.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,w,p,A,L){u.alter(m,w,p,A,L)},this.getCell=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=w,L=m;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||A===null||L===void 0||A===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,A),p)},this.getCoords=function(m){const w=this.view._wt.wtTable.getCoords(m);if(w===null)return null;const{row:p,col:A}=w;let L=p,j=A;return p>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(p)),A>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(A)),o._createCellCoords(L,j)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,w){return a.get(m,a.colToProp(w))},this.getDataAtRowProp=function(m,w){return a.get(m,w)},this.getDataAtCol=function(m){const w=[],p=a.getRange(o._createCellCoords(0,m),o._createCellCoords(C.data.length-1,m),a.DESTINATION_RENDERER);for(let A=0;A<p.length;A+=1)for(let L=0;L<p[A].length;L+=1)w.push(p[A][L]);return w},this.getDataAtProp=function(m){const w=[],p=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(C.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let A=0;A<p.length;A+=1)for(let L=0;L<p[A].length;L+=1)w.push(p[A][L]);return w},this.getSourceData=function(m,w,p,A){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,A)),L},this.getSourceDataArray=function(m,w,p,A){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,A),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,w,p,A){const L=Re(m,w,p),j=this.hasHook("afterSetSourceDataAtCell"),K=[];j&&_(L,b=>{let[R,S,$]=b;K.push([R,S,l.getAtCell(R,S),$])}),_(L,b=>{let[R,S,$]=b;l.setAtCell(R,S,$)}),j&&this.runHooks("afterSetSourceDataAtCell",K,A),this.render();const J=o.getActiveEditor();J&&le(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,w){return l.getAtCell(m,w)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,w,p,A){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,w,p,A],[j,K]=L;let[,,J,b]=L,R=null,S=null;J===void 0&&(J=j),b===void 0&&(b=K);let $="mixed";return fe(Math.max(Math.min(j,J),0),Math.max(j,J),I=>{let N=!0;return fe(Math.max(Math.min(K,b),0),Math.max(K,b),W=>(S=this.getCellMeta(I,W).type,R?N=R===S:R=S,N)),$=N?S:"mixed",N}),$},this.removeCellMeta=function(m,w,p){const[A,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(w)];let j=E.getCellMetaKeyValue(A,L,p);o.runHooks("beforeRemoveCellMeta",m,w,p,j)!==!1&&(E.removeCellMeta(A,L,p),o.runHooks("afterRemoveCellMeta",m,w,p,j)),j=null},this.spliceCellsMeta=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,A=new Array(p>2?p-2:0),L=2;L<p;L++)A[L-2]=arguments[L];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&E.removeRow(this.toPhysicalRow(m),w),A.length>0&&_(A.reverse(),j=>{E.createRow(this.toPhysicalRow(m)),_(j,(K,J)=>this.setCellMetaObject(m,J,K))}),o.render()},this.setCellMetaObject=function(m,w,p){typeof p=="object"&&ke(p,(A,L)=>{this.setCellMeta(m,w,L,A)})},this.setCellMeta=function(m,w,p,A){if(o.runHooks("beforeSetCellMeta",m,w,p,A)===!1)return;let j=m,K=w;m<this.countRows()&&(j=this.toPhysicalRow(m)),w<this.countCols()&&(K=this.toPhysicalColumn(w)),E.setCellMeta(j,K,p,A),o.runHooks("afterSetCellMeta",m,w,p,A)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},A=this.toPhysicalRow(m),L=this.toPhysicalColumn(w);return A===null&&(A=m),L===null&&(L=w),E.getCellMeta(A,L,{visualRow:m,visualColumn:w,...p})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||C.columns)},this.getCellRenderer=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).renderer:m.renderer;return typeof p=="string"?Iw(p):Ht(p)?Iw("text"):p},this.getCellEditor=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).editor:m.editor;return typeof p=="string"?xw(p):Ht(p)?xw("text"):p},this.getCellValidator=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).validator:m.validator;return typeof p=="string"?QE(p):p},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,w){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,m)},this.validateColumns=function(m,w){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,m)},this._validateCells=function(m,w,p){const A=new Q;m&&(A.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(w!==void 0&&w.indexOf(L)===-1){L-=1;continue}let j=o.countCols()-1;for(;j>=0;){if(p!==void 0&&p.indexOf(j)===-1){j-=1;continue}A.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,j),o.getCellMeta(L,j),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),j-=1}L-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let w=C.rowHeaders,p=m;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(w=[],fe(o.countRows()-1,A=>{w.push(o.getRowHeader(A))})):Array.isArray(w)&&w[p]!==void 0?w=w[p]:ut(w)?w=w(p):w&&typeof w!="string"&&typeof w!="number"&&(w=p+1),w},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let m=0,w=o.countCols();m<w;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",m);if(p===void 0){const J=[],b=o.countCols();for(let R=0;R<b;R++)J.push(o.getColHeader(R));return J}let A=C.colHeaders;const L=function(J){const b=[],R=o.countCols();let S=0;for(;S<R;S++)ut(C.columns)&&C.columns(S)&&b.push(S);return b[J]},j=o.toPhysicalColumn(p),K=L(j);return C.colHeaders===!1?A=null:C.columns&&ut(C.columns)&&C.columns(K)&&C.columns(K).title?A=C.columns(K).title:C.columns&&C.columns[j]&&C.columns[j].title?A=C.columns[j].title:Array.isArray(C.colHeaders)&&C.colHeaders[j]!==void 0?A=C.colHeaders[j]:ut(C.colHeaders)?A=C.colHeaders(j):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(A=Jv(p)),A=o.runHooks("modifyColumnHeaderValue",A,m,w),A},this._getColWidthFromSettings=function(m){let w;if(m>=0&&(w=o.getCellMeta(0,m).width),(w===void 0||w===C.width)&&(w=C.colWidths),w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(m,w){let p=o._getColWidthFromSettings(m);return p=o.runHooks("modifyColWidth",p,m,w),p===void 0&&(p=eh),p},this._getRowHeightFromSettings=function(m){const w=this.view.getDefaultRowHeight();let p=C.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<w?w:p},this.getRowHeight=function(m,w){let p=o._getRowHeightFromSettings(m);return p=o.runHooks("modifyRowHeight",p,m,w),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=C.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,w)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return _R(o.countRows()-1,p=>{if(o.isEmptyRow(p))w+=1;else if(m===!0)return!1}),w},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return _R(o.countCols()-1,p=>{if(o.isEmptyCol(p))w+=1;else if(m===!0)return!1}),w},this.isEmptyRow=function(m){return C.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return C.isEmptyCol.call(o,m)},this.selectCell=function(m,w,p,A){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ht(m)||Ht(w)?!1:this.selectCells([[m,w,p,A]],L,j)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const A=U.selectCells(m);return A&&p&&o.listen(),d.resume(),A},this.selectColumns=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectColumns(m,w,p)},this.selectRows=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectRows(m,w,p)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),U.selectAll(m,w,p)};const st=(m,w)=>m.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(m,w){if(typeof m=="number"){var p;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:A,col:L,considerHiddenIndexes:j}=m??{};let K=A,J=L;if(ut(w)&&this.addHookOnce("afterScroll",w),j===void 0||j){const $=Number.isInteger(A)&&A>=0,I=Number.isInteger(L)&&L>=0,N=$?st(this.rowIndexMapper,A):void 0,W=I?st(this.columnIndexMapper,L):void 0;if(N===null||W===null)return!1;K=$?o.rowIndexMapper.getRenderableFromVisualIndex(N):A,J=I?o.columnIndexMapper.getRenderableFromVisualIndex(W):L}const b=Number.isInteger(K),R=Number.isInteger(J);let S=!1;return b&&K>=0&&R&&J>=0?S=o.view.scrollViewport(o._createCellCoords(K,J),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(R&&J<0||!R)?S=o.view.scrollViewportVertically(K,m.verticalSnap):R&&J>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(J,m.horizontalSnap)),ut(w)&&(S?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;ut(m)&&this.addHookOnce("afterScroll",m);const{highlight:w}=this.getSelectedRangeLast(),p=this.scrollViewportTo(w.toObject());return p?this.view.render():ut(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),p},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),ZC.delete(this.guid),Fp(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}qo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),x.getItems().forEach(m=>{let[,w]=m;w.destroy()}),x.clear(),o.runHooks("afterDestroy")},!0),oe.getSingleton().destroy(o),ke(o,(m,w,p)=>{ut(m)?p[w]=Pn(w):w!=="guid"&&(p[w]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,U=null,c=null,o=null};function Pn(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return x.getItem(Zn(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:x.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,w,p){oe.getSingleton().add(m,w,o,p)},this.hasHook=function(m){return oe.getSingleton().has(m,o)||oe.getSingleton().has(m)},this.addHookOnce=function(m,w,p){oe.getSingleton().once(m,w,o,p)},this.removeHook=function(m,w){oe.getSingleton().remove(m,w,o)},this.runHooks=function(m,w,p,A,L,j,K){return oe.getSingleton().run(o,m,w,p,A,L,j,K)},this.getTranslatedPhrase=function(m,w){return Z$(C.language,m,w)},this.toHTML=()=>TR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",TR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=m;typeof p=="function"&&(p=setTimeout(p,w)),this.timeouts.push(p)},this._clearTimeouts=function(){_(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){_(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const at=Ose({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&at.releasePressedKeys()}),this.getShortcutManager=function(){return at},this.getFocusManager=function(){return h},ZE().forEach(m=>{const w=vg(m);x.addItem(m,new w(this))}),gse(o),at.setActiveContextName("grid"),oe.getSingleton().run(o,"construct")}function vO(t,e,n){t.addEventListener(e,n,!1)}function yO(t,e,n){t.removeEventListener(e,n,!1)}function Rm(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function fL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Rm(s).fontSize,o.style.fontFamily=Rm(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Rm(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=Rm(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+g+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>v?y.width=`${n.minWidth}px`:v>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${v}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?y.height=`${n.minHeight}px`:n.maxHeight<E?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(vO(s,"input",a),vO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){yO(s,"input",a),yO(s,"keydown",l)}}}function CO(t,e){const n=NE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}fg(e,i)}function cl(t,e,n){return(e=Ase(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ase(t){var e=Hse(t,"string");return typeof e=="symbol"?e:e+""}function Hse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Nse="ht_editor_visible",Em="ht_editor_hidden",bO="textEditor",Dse="text";class Au extends Ch{static get EDITOR_TYPE(){return Dse}constructor(e){super(e),cl(this,"eventManager",new Ei(this)),cl(this,"autoResize",fL(this.hot.rootDocument)),cl(this,"TEXTAREA",void 0),cl(this,"textareaStyle",void 0),cl(this,"TEXTAREA_PARENT",void 0),cl(this,"textareaParentStyle",void 0),cl(this,"layerClass",void 0),this.eventManager=new Ei(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Xd(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Jt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Jt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),fg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),be(this.TEXTAREA,[["data-hot-input",""],_u(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Em),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Zk()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Em)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(ve(i,"handsontableEditor"))return n=!0,!1}),ve(this.TEXTAREA_PARENT,Em)&&we(this.TEXTAREA_PARENT,Em),n?(this.layerClass=Nse,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Jt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){jE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:bO},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;CO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;CO(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(bO)}}const kse="base";function Rg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(Qx())):a&&c.push(Qx()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(eI())):(u.push(s.invalidCellClassName),a&&c.push(eI()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),we(e,u),q(e,l),xu(e,c),be(e,h)}Rg.RENDERER_TYPE=kse;const $se="text";function Js(t,e,n,r,i,o,s){Rg.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Tt(a),s.trimWhitespace&&(a=a.trim()),ja(e,a)}Js.RENDERER_TYPE=$se;const Lse="text",gL={CELL_TYPE:Lse,editor:Au,renderer:Js};ci(gL);Te.editors={BaseEditor:Ch};function Te(t,e){const n=new dL(t,e||{},pT);return n.init(),n}Te.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new dL(t,e,pT)};Te.DefaultSettings=oL();Te.hooks=oe.getSingleton();Te.CellCoords=du;Te.CellRange=yg;Te.packageName="handsontable";Te.buildDate="24/04/2025 10:59:00";Te.version="15.3.0";Te.languages={dictionaryKeys:tie,getLanguageDictionary:J$,getLanguagesDictionaries:sie,registerLanguageDictionary:X$,getTranslatedPhrase:Z$};const SO="handsontableEditor",Fse="handsontable";class qM extends Au{static get EDITOR_TYPE(){return Fse}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),fg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&cn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:SO,relativeToGroup:Xa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ii(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SO)}}function Vse(t,e){mL(t,e),e.add(t)}function RO(t,e,n){mL(t,e),e.set(t,n)}function mL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tm(t,e,n){return(e=Bse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bse(t){var e=Wse(t,"string");return typeof e=="symbol"?e:e+""}function Wse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QC(t,e){return t.get(FR(t,e))}function FR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jse="autocomplete";var eb=new WeakMap,EO=new WeakMap,tb=new WeakSet;class XM extends qM{constructor(){super(...arguments),Vse(this,tb),Tm(this,"query",null),Tm(this,"strippedChoices",[]),Tm(this,"rawChoices",[]),RO(this,eb,this.hot.guid.slice(0,9)),RO(this,EO,mg(()=>{this.focus()},100)),Tm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=wR(Tt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return jse}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[$8(),A8(),bk("listbox"),B8()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[bi("false"),W8(`${QC(eb,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",QC(EO,this)),this.htEditor.updateSettings({colWidths:e?[Qt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Js(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:v,locale:y}=this.cellProperties,E=this.query;let C=Tt(d),M,x;C&&!v&&(M=g===!0?C.indexOf(E):C.toLocaleLowerCase(y).indexOf(E.toLocaleLowerCase(y)),M!==-1&&(x=C.substr(M,E.length),C=C.replace(x,`<strong>${x}</strong>`))),n&&be(l,[H8(),...r?[Y8(i)]:[],...r?[G8(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=C},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{be(h,[xE()]),be(this.TEXTAREA,...j8(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(be(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Hs()),be(this.htEditor.rootElement,[Ck(),U8("polite"),z8("text"),["id",`${QC(eb,this)}-listbox-${o}-${s}`]]),be(this.TEXTAREA,...bi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[bi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=NE(this.TEXTAREA),r=Dk(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Gd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),fg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),FR(tb,this,TO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),FR(tb,this,TO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Tt(o));return Ue(r,o=>n?o:wR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(Qk(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function TO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+_n(this.hot.rootDocument)})}const Use="checkbox";class pL extends Ch{static get EDITOR_TYPE(){return Use}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ve(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ia=()=>window,pi=()=>window.document,VR=(t,e)=>window.setTimeout(t,e),xo=function(t,e,n,r){t.addEventListener(e,n,!!r)},ds=function(t,e,n,r){t.removeEventListener(e,n,!!r)},zse=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Br=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},nb=function(t,e){Br(t,e)||(t.className=t.className===""?e:t.className+" "+e)},rb=function(t,e){t.className=zse((" "+t.className+" ").replace(" "+e+" "," "))},JM=function(t){return/Array/.test(Object.prototype.toString.call(t))},zr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Yse=function(t){let e=t.getDay();return e===0||e===6},Gse=function(t){return t%4===0&&t%100!==0||t%400===0},MO=function(t,e){return[31,Gse(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Mm=function(t){zr(t)&&t.setHours(0,0,0,0)},_m=function(t,e){return t.getTime()===e.getTime()},Nw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?zr(e[r])?n&&(t[r]=new Date(e[r].getTime())):JM(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Nw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},_O=function(t,e,n){let r=pi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Nw(r,n),t.dispatchEvent(r)},PO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},vo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},xO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Kse=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},qse=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},Xse=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():qse(o,i))+"</td>"},Jse=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Zse=function(t){return"<tbody>"+t.join("")+"</tbody>"},Qse=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+xO(t,e)+'">'+xO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},eae=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,v=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",JM(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},tae=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Qse(t)+Zse(e)+"</table>"};function BR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Ia().event;let o=i.target||i.srcElement;if(o)if(Br(o,"is-disabled")||(Br(o,"pika-button")&&!Br(o,"is-empty")&&!Br(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&VR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Br(o,"pika-prev")?e.prevMonth():Br(o,"pika-next")&&e.nextMonth()),Br(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Ia().event;let o=i.target||i.srcElement;o&&(Br(o,"pika-select-month")?e.gotoMonth(o.value):Br(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Ia().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),zr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=pi().activeElement;do if(Br(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=VR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Ia().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Br(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),xo(o,"change",e._onChange)));do if(Br(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=pi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),xo(e.el,"mousedown",e._onMouseDown,!0),xo(e.el,"touchend",e._onMouseDown,!0),xo(e.el,"change",e._onChange),n.keyboardInput&&xo(pi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?pi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),xo(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;zr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",xo(n.trigger,"click",e._onInputClick),xo(n.trigger,"focus",e._onInputFocus),xo(n.trigger,"blur",e._onInputBlur)):this.show()}BR.prototype={config:function(t){this._o||(this._o=Nw({},vo,!0));let e=Nw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,zr(e.minDate)||(e.minDate=!1),zr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),JM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||vo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,zr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return zr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",_O(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!zr(t))return;let n=this._o.minDate,r=this._o.maxDate;zr(n)&&t<n?t=n:zr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Mm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),_O(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(zr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=PO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=PO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Mm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=vo.minDate,this._o.minYear=vo.minYear,this._o.minMonth=vo.minMonth,this._o.startRange=vo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Mm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=vo.maxDate,this._o.maxYear=vo.maxYear,this._o.maxMonth=vo.maxMonth,this._o.endRange=vo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+eae(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&VR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Ia().innerWidth||pi().documentElement.clientWidth,i=Ia().innerHeight||pi().documentElement.clientHeight,o=pi().body.scrollTop||pi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Ia().pageXOffset,a=l.bottom+Ia().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",nb(this.el,u?"left-aligned":"right-aligned"),nb(this.el,c?"bottom-aligned":"top-aligned"),rb(this.el,u?"right-aligned":"left-aligned"),rb(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=MO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Mm(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=MO(h,u),g=o+s,v=g;for(;v>7;)v-=7;g+=7-v;let y=!1;for(let E=0,C=0;E<g;E++){let M=new Date(t,e,1+(E-s)),x=zr(this._d)?_m(M,this._d):!1,P=_m(M,i),T=r.events.indexOf(M.toDateString())!==-1,O=E<s||E>=o+s,G=1+(E-s),U=e,V=t,X=r.startRange&&_m(r.startRange,M),ne=r.endRange&&_m(r.endRange,M),Q=r.startRange&&r.endRange&&r.startRange<M&&M<r.endRange,te=r.minDate&&M<r.minDate||r.maxDate&&M>r.maxDate||r.disableWeekends&&Yse(M)||r.disableDayFn&&r.disableDayFn(M);O&&(E<s?(G=f+G,U=u,V=h):(G=G-o,U=c,V=d));let pe={day:G,month:U,year:V,hasEvent:T,isSelected:x,isToday:P,isDisabled:te,isEmpty:O,isStartRange:X,isEndRange:ne,isInRange:Q,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&x&&(y=!0),l.push(Kse(pe)),++C===7&&(r.showWeekNumber&&l.unshift(Xse(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(Jse(l,r.isRTL,r.pickWholeWeek,y)),l=[],C=0,y=!1)}return tae(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),rb(this.el,"is-hidden"),this._o.bound&&(xo(pi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&ds(pi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),nb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),ds(this.el,"mousedown",this._onMouseDown,!0),ds(this.el,"touchend",this._onMouseDown,!0),ds(this.el,"change",this._onChange),t.keyboardInput&&ds(pi(),"keydown",this._onKeyChange),t.field&&(ds(t.field,"change",this._onInputChange),t.bound&&(ds(t.trigger,"click",this._onInputClick),ds(t.trigger,"focus",this._onInputFocus),ds(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function nae(t,e){rae(t,e),e.add(t)}function rae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IO(t,e,n){return(e=iae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iae(t){var e=oae(t,"string");return typeof e=="symbol"?e:e+""}function oae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ib(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wL="date",OO="dateEditor",sae="DD/MM/YYYY";var Pm=new WeakSet;class vL extends Au{constructor(){super(...arguments),nae(this,Pm),IO(this,"parentDestroyed",!1),IO(this,"$datePicker",null)}static get EDITOR_TYPE(){return wL}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof BR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(we(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();we(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{ve(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:OO})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(OO),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=ib(Pm,this,ob).call(this),r=this.hot.view.isMouseDown(),i=e?zE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new BR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&wg(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:ib(Pm,this,ob).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Z(a).format(ib(Pm,this,ob).call(this))),this.setValue(a),i&&i(),jo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+un(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Qt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function ob(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:sae}const aae="dropdown";class yL extends XM{static get EDITOR_TYPE(){return aae}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const lae="numeric";class CL extends Au{static get EDITOR_TYPE(){return lae}}function uae(t,e,n){return(e=cae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cae(t){var e=hae(t,"string");return typeof e=="symbol"?e:e+""}function hae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dae="password";class bL extends Au{constructor(){super(...arguments),uae(this,"autoResize",fL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return dae}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,qo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const sb="ht_editor_visible",AO="selectEditor",fae="select";class SL extends Ch{static get EDITOR_TYPE(){return fae}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Pu()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ve(this.selectWrapper,sb)&&we(this.selectWrapper,sb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),qo(this.select),ke(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Iu(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,sb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:AO};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(AO)}}const gae="time";class RL extends Au{static get EDITOR_TYPE(){return gae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function mae(){Mr(Ch),Mr(XM),Mr(pL),Mr(vL),Mr(yL),Mr(qM),Mr(CL),Mr(bL),Mr(SL),Mr(Au),Mr(RL)}const pae="html";function ZM(t,e,n,r,i,o,s){Rg.apply(this,[t,e,n,r,i,o,s]),Iu(e,o??"",!1)}ZM.RENDERER_TYPE=pae;const wae="autocomplete";function Sh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?ZM:Js,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Pu()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new Ei(t);t.acArrowListener=function(d){ve(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Sh.RENDERER_TYPE=wae;const vae="dropdown";function QM(t,e,n,r,i,o,s){Sh.apply(this,[t,e,n,r,i,o,s])}QM.RENDERER_TYPE=vae;const HO=new WeakMap,NO=new WeakMap,yae="htBadValue",nh="data-row",rh="data-col",Cae="checkboxRenderer",EL="checkbox";oe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===EL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function e_(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Rg.apply(this,[t,e,n,r,i,o,s]),bae(t);let u=Sae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),qo(e),o===s.checkedTemplate||Tt(o).toLocaleLowerCase(s.locale)===Tt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Tt(o).toLocaleLowerCase(s.locale)===Tt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Yt(o)?q(u,"noValue"):(u.style.display="none",q(u,yae),h=!0),be(u,[[nh,n],[rh,r]]),l&&be(u,[xf(u.checked?t.getTranslatedPhrase(UM):t.getTranslatedPhrase(zM)),Ek(u.checked),N8()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);v=E!==null?E:""}const y=Rae(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),HO.has(t)||(HO.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),E={group:Cae,relativeToGroup:Xa,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const C=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(C==null?void 0:C.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],E)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),E=[],C=new Map;let M=[],x=0;if(y){for(let P=0;P<y.length;P++){const{row:T,col:O}=y[P].getTopStartCorner(),{row:G,col:U}=y[P].getBottomEndCorner();for(let V=T;V<=G;V+=1)for(let X=O;X<=U;X+=1){const ne=t.getCellMeta(V,X);if(ne.hidden)continue;const Q={checkedTemplate:ne.checkedTemplate,uncheckedTemplate:ne.uncheckedTemplate};if(ne.type!=="checkbox"){v===!0&&!ne.readOnly&&(C.has(E.length)?C.set(E.length,[...C.get(E.length),[V,X,null]]):C.set(E.length,[[V,X,null]]));continue}if(ne.readOnly===!0)continue;typeof ne.checkedTemplate>"u"&&(ne.checkedTemplate=!0),typeof ne.uncheckedTemplate>"u"&&(ne.uncheckedTemplate=!1);const te=t.getDataAtCell(V,X);v===!1?[ne.checkedTemplate,ne.checkedTemplate.toString()].includes(te)?M.push([V,X,ne.uncheckedTemplate,Q]):[ne.uncheckedTemplate,ne.uncheckedTemplate.toString(),null,void 0].includes(te)&&M.push([V,X,ne.checkedTemplate,Q]):M.push([V,X,ne.uncheckedTemplate,Q]),x+=1}E.push(x),x=0}M.every(P=>{let[,,T]=P;return T===M[0][2]})?M=M.map(P=>{let[T,O,G]=P;return[T,O,G]}):M=M.map(P=>{let[T,O,,G]=P;return[T,O,G.checkedTemplate]}),M.length>0&&E.forEach((P,T)=>{let O=M.splice(0,P);C.size&&C.has(T)&&(O=[...O,...C.get(T)]),t.setDataAtCell(O)})}}function g(){const v=t.getSelectedRange();if(v){for(let y=0;y<v.length;y++){const E=v[y].getTopStartCorner(),C=v[y].getBottomEndCorner();for(let M=E.row;M<=C.row;M++)for(let x=E.col;x<=C.col;x++){if(t.getCellMeta(M,x).readOnly)continue;const T=t.getCell(M,x);if(zo(T)&&T.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}e_.RENDERER_TYPE=EL;function bae(t){let e=NO.get(t);if(!e){const{rootElement:n}=t;e=new Ei(t),e.addEventListener(n,"click",r=>Tae(r,t)),e.addEventListener(n,"mouseup",r=>Eae(r,t)),e.addEventListener(n,"change",r=>Mae(r,t)),NO.set(t,e)}return e}function Sae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Rae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function Eae(t,e){const{target:n}=t;t_(n)&&(!n.hasAttribute(nh)||!n.hasAttribute(rh)||setTimeout(e.listen,10))}function Tae(t,e){const{target:n}=t;if(!t_(n)||!n.hasAttribute(nh)||!n.hasAttribute(rh))return;const r=parseInt(n.getAttribute(nh),10),i=parseInt(n.getAttribute(rh),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function Mae(t,e){const{target:n}=t;if(!t_(n)||!n.hasAttribute(nh)||!n.hasAttribute(rh))return;const r=parseInt(n.getAttribute(nh),10),i=parseInt(n.getAttribute(rh),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function t_(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const _ae="handsontable";function n_(t,e,n,r,i,o,s){Sh.apply(this,[t,e,n,r,i,o,s])}n_.RENDERER_TYPE=_ae;var Pae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ab,DO;function Iae(){return DO||(DO=1,ab={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),ab}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var lb,kO;function TL(){if(kO)return lb;kO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let v="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let T=0;T<t.length;T++){let O=t[T];if(v=l.replace(RegExp(`([0-9 ])(${O.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*O.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let C=h(E);if(C&&C!=="."&&(v=l.replace(new RegExp(`${e(C)}$`),""),v!==l))return n(v,u,c,h,d,f);let M={};Object.keys(f).forEach(T=>{M[f[T]]=T});let x=Object.keys(M).sort().reverse(),P=x.length;for(let T=0;T<P;T++){let O=x[T],G=M[O];if(v=l.replace(O,""),v!==l){let U;switch(G){case"thousand":U=Math.pow(10,3);break;case"million":U=Math.pow(10,6);break;case"billion":U=Math.pow(10,9);break;case"trillion":U=Math.pow(10,12);break}return n(v,u,c,h,d,f)*U}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let v=r(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=o_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),v=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,g,v);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return lb={unformat:a},lb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ub,$O;function r_(){if($O)return ub;$O=1;let t=TL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,E){let C=d(y),M=g(E);return C&&M}function d(y){return t.unformat(y)!==void 0}function f(y,E,C,M=!1){let x=Object.keys(y).map(P=>{if(!E[P])return console.error(`${C} Invalid key: ${P}`),!1;let T=y[P],O=E[P];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!f(T,u,`[Validate ${P}]`,!0))return!1}else if(typeof T!==O.type)return console.error(`${C} ${P} type mismatched: "${O.type}" expected, "${typeof T}" provided`),!1;if(O.restrictions&&O.restrictions.length){let G=O.restrictions.length;for(let U=0;U<G;U++){let{restriction:V,message:X}=O.restrictions[U];if(!V(T,y))return console.error(`${C} ${P} invalid value: ${X}`),!1}}return O.restriction&&!O.restriction(T,y)?(console.error(`${C} ${P} invalid value: ${O.message}`),!1):O.validValues&&O.validValues.indexOf(T)===-1?(console.error(`${C} ${P} invalid value: must be among ${JSON.stringify(O.validValues)}, "${T}" provided`),!1):!(O.children&&!f(T,O.children,`[Validate ${P}]`))});return M||x.push(...Object.keys(E).map(P=>{let T=E[P];if(typeof T=="string"&&(T={type:T}),T.mandatory){let O=T.mandatory;if(typeof O=="function"&&(O=O(y)),O&&y[P]===void 0)return console.error(`${C} Missing mandatory key "${P}"`),!1}return!0})),x.reduce((P,T)=>P&&T,!0)}function g(y){return f(y,u,"[Validate format]")}function v(y){return f(y,c,"[Validate language]")}return ub={validate:h,validateFormat:g,validateInput:d,validateLanguage:v},ub}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Oae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function Aae(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function Hae(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function Nae(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Dae(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function kae(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function $ae(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function Lae(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function Fae(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function Vae(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Bae(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Wae(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function jae(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function Uae(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function zae(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Yae(t,e={}){return typeof t!="string"?t:(t=Oae(t,e),t=Aae(t,e),Hae(t,e),kae(t,e),$ae(t,e),jae(t,e),Vae(t,e),Bae(t,e),Lae(t,e),Wae(t,e),Fae(t,e),Nae(t,e),Dae(t,e),Uae(t,e),zae(t,e),e)}var i_={parseFormat:Yae};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cb,LO;function o_(){if(LO)return cb;LO=1;const t=Iae(),e=r_(),n=i_;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,cb=r,cb}function Gae(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Kae(t,e){t.forEach(n=>{let r;try{r=Gae(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var qae=t=>({loadLanguagesInNode:e=>Kae(e,t)}),ML={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(T){var O,G,U,V=p.prototype={constructor:p,toString:null,valueOf:null},X=new p(1),ne=20,Q=4,te=-7,pe=21,et=-1e7,Re=1e7,Ae=!1,st=1,Pn=0,at={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function p(b,R){var S,$,I,N,W,H,D,B,F=this;if(!(F instanceof p))return new p(b,R);if(R==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>Re?F.c=F.e=null:b.e<et?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((H=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(N=0,W=b;W>=10;W/=10,N++);N>Re?F.c=F.e=null:(F.e=N,F.c=[b]);return}B=String(b)}else{if(!r.test(B=String(b)))return U(F,B,H);F.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(N=B.indexOf("."))>-1&&(B=B.replace(".","")),(W=B.search(/e/i))>0?(N<0&&(N=W),N+=+B.slice(W+1),B=B.substring(0,W)):N<0&&(N=B.length)}else{if(C(R,2,m.length,"Base"),R==10&&w)return F=new p(b),K(F,ne+F.e+1,Q);if(B=String(b),H=typeof b=="number"){if(b*0!=0)return U(F,B,H,R);if(F.s=1/b<0?(B=B.slice(1),-1):1,p.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(S=m.slice(0,R),N=W=0,D=B.length;W<D;W++)if(S.indexOf($=B.charAt(W))<0){if($=="."){if(W>N){N=D;continue}}else if(!I&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){I=!0,W=-1,N=0;continue}return U(F,String(b),H,R)}H=!1,B=G(B,R,10,F.s),(N=B.indexOf("."))>-1?B=B.replace(".",""):N=B.length}for(W=0;B.charCodeAt(W)===48;W++);for(D=B.length;B.charCodeAt(--D)===48;);if(B=B.slice(W,++D)){if(D-=W,H&&p.DEBUG&&D>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((N=N-W-1)>Re)F.c=F.e=null;else if(N<et)F.c=[F.e=0];else{if(F.e=N,F.c=[],W=(N+1)%u,N<0&&(W+=u),W<D){for(W&&F.c.push(+B.slice(0,W)),D-=u;W<D;)F.c.push(+B.slice(W,W+=u));W=u-(B=B.slice(W)).length}else W-=D;for(;W--;B+="0");F.c.push(+B)}}else F.c=[F.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],C(S,0,f,R),ne=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],C(S,0,8,R),Q=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(C(S[0],-1e9,0,R),C(S[1],0,f,R),te=S[0],pe=S[1]):(C(S,-1e9,f,R),te=-(pe=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)C(S[0],-1e9,-1,R),C(S[1],1,f,R),et=S[0],Re=S[1];else if(C(S,-1e9,f,R),S)et=-(Re=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ae=S;else throw Ae=!S,Error(s+"crypto unavailable");else Ae=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],C(S,0,9,R),st=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],C(S,0,f,R),Pn=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")at=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))w=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:ne,ROUNDING_MODE:Q,EXPONENTIAL_AT:[te,pe],RANGE:[et,Re],CRYPTO:Ae,MODULO_MODE:st,POW_PRECISION:Pn,FORMAT:at,ALPHABET:m}},p.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,S,$=b.c,I=b.e,N=b.s;e:if({}.toString.call($)=="[object Array]"){if((N===1||N===-1)&&I>=-1e9&&I<=f&&I===o(I)){if($[0]===0){if(I===0&&$.length===1)return!0;break e}if(R=(I+1)%u,R<1&&(R+=u),String($[0]).length==R){for(R=0;R<$.length;R++)if(S=$[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if($===null&&I===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},p.maximum=p.max=function(){return L(arguments,-1)},p.minimum=p.min=function(){return L(arguments,1)},p.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var $,I,N,W,H,D=0,B=[],F=new p(X);if(S==null?S=ne:C(S,0,f),W=i(S/u),Ae)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(W*=2));D<W;)H=$[D]*131072+($[D+1]>>>11),H>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),$[D]=I[0],$[D+1]=I[1]):(B.push(H%1e14),D+=2);D=W/2}else if(crypto.randomBytes){for($=crypto.randomBytes(W*=7);D<W;)H=($[D]&31)*281474976710656+$[D+1]*1099511627776+$[D+2]*4294967296+$[D+3]*16777216+($[D+4]<<16)+($[D+5]<<8)+$[D+6],H>=9e15?crypto.randomBytes(7).copy($,D):(B.push(H%1e14),D+=7);D=W/7}else throw Ae=!1,Error(s+"crypto unavailable");if(!Ae)for(;D<W;)H=R(),H<9e15&&(B[D++]=H%1e14);for(W=B[--D],S%=u,W&&S&&(H=h[u-S],B[D]=o(W/H)*H);B[D]===0;B.pop(),D--);if(D<0)B=[N=0];else{for(N=-1;B[0]===0;B.splice(0,1),N-=u);for(D=1,H=B[0];H>=10;H/=10,D++);D<u&&(N-=u-D)}return F.e=N,F.c=B,F}}(),p.sum=function(){for(var b=1,R=arguments,S=new p(R[0]);b<R.length;)S=S.plus(R[b++]);return S},G=function(){var b="0123456789";function R(S,$,I,N){for(var W,H=[0],D,B=0,F=S.length;B<F;){for(D=H.length;D--;H[D]*=$);for(H[0]+=N.indexOf(S.charAt(B++)),W=0;W<H.length;W++)H[W]>I-1&&(H[W+1]==null&&(H[W+1]=0),H[W+1]+=H[W]/I|0,H[W]%=I)}return H.reverse()}return function(S,$,I,N,W){var H,D,B,F,Y,ae,ce,_e,Fe=S.indexOf("."),ze=ne,Me=Q;for(Fe>=0&&(F=Pn,Pn=0,S=S.replace(".",""),_e=new p($),ae=_e.pow(S.length-Fe),Pn=F,_e.c=R(P(y(ae.c),ae.e,"0"),10,I,b),_e.e=_e.c.length),ce=R(S,$,I,W?(H=m,b):(H=b,m)),B=F=ce.length;ce[--F]==0;ce.pop());if(!ce[0])return H.charAt(0);if(Fe<0?--B:(ae.c=ce,ae.e=B,ae.s=N,ae=O(ae,_e,ze,Me,I),ce=ae.c,Y=ae.r,B=ae.e),D=B+ze+1,Fe=ce[D],F=I/2,Y=Y||D<0||ce[D+1]!=null,Y=Me<4?(Fe!=null||Y)&&(Me==0||Me==(ae.s<0?3:2)):Fe>F||Fe==F&&(Me==4||Y||Me==6&&ce[D-1]&1||Me==(ae.s<0?8:7)),D<1||!ce[0])S=Y?P(H.charAt(1),-ze,H.charAt(0)):H.charAt(0);else{if(ce.length=D,Y)for(--I;++ce[--D]>I;)ce[D]=0,D||(++B,ce=[1].concat(ce));for(F=ce.length;!ce[--F];);for(Fe=0,S="";Fe<=F;S+=H.charAt(ce[Fe++]));S=P(S,B,H.charAt(0))}return S}}(),O=function(){function b($,I,N){var W,H,D,B,F=0,Y=$.length,ae=I%d,ce=I/d|0;for($=$.slice();Y--;)D=$[Y]%d,B=$[Y]/d|0,W=ce*D+B*ae,H=ae*D+W%d*d+F,F=(H/N|0)+(W/d|0)+ce*B,$[Y]=H%N;return F&&($=[F].concat($)),$}function R($,I,N,W){var H,D;if(N!=W)D=N>W?1:-1;else for(H=D=0;H<N;H++)if($[H]!=I[H]){D=$[H]>I[H]?1:-1;break}return D}function S($,I,N,W){for(var H=0;N--;)$[N]-=H,H=$[N]<I[N]?1:0,$[N]=H*W+$[N]-I[N];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,I,N,W,H){var D,B,F,Y,ae,ce,_e,Fe,ze,Me,Ve,_t,Ai,rs,ni,Pt,gn,bt=$.s==I.s?1:-1,xt=$.c,Be=I.c;if(!xt||!xt[0]||!Be||!Be[0])return new p(!$.s||!I.s||(xt?Be&&xt[0]==Be[0]:!Be)?NaN:xt&&xt[0]==0||!Be?bt*0:bt/0);for(Fe=new p(bt),ze=Fe.c=[],B=$.e-I.e,bt=N+B+1,H||(H=l,B=v($.e/u)-v(I.e/u),bt=bt/u|0),F=0;Be[F]==(xt[F]||0);F++);if(Be[F]>(xt[F]||0)&&B--,bt<0)ze.push(1),Y=!0;else{for(rs=xt.length,Pt=Be.length,F=0,bt+=2,ae=o(H/(Be[0]+1)),ae>1&&(Be=b(Be,ae,H),xt=b(xt,ae,H),Pt=Be.length,rs=xt.length),Ai=Pt,Me=xt.slice(0,Pt),Ve=Me.length;Ve<Pt;Me[Ve++]=0);gn=Be.slice(),gn=[0].concat(gn),ni=Be[0],Be[1]>=H/2&&ni++;do{if(ae=0,D=R(Be,Me,Pt,Ve),D<0){if(_t=Me[0],Pt!=Ve&&(_t=_t*H+(Me[1]||0)),ae=o(_t/ni),ae>1)for(ae>=H&&(ae=H-1),ce=b(Be,ae,H),_e=ce.length,Ve=Me.length;R(ce,Me,_e,Ve)==1;)ae--,S(ce,Pt<_e?gn:Be,_e,H),_e=ce.length,D=1;else ae==0&&(D=ae=1),ce=Be.slice(),_e=ce.length;if(_e<Ve&&(ce=[0].concat(ce)),S(Me,ce,Ve,H),Ve=Me.length,D==-1)for(;R(Be,Me,Pt,Ve)<1;)ae++,S(Me,Pt<Ve?gn:Be,Ve,H),Ve=Me.length}else D===0&&(ae++,Me=[0]);ze[F++]=ae,Me[0]?Me[Ve++]=xt[Ai]||0:(Me=[xt[Ai]],Ve=1)}while((Ai++<rs||Me[0]!=null)&&bt--);Y=Me[0]!=null,ze[0]||ze.splice(0,1)}if(H==l){for(F=1,bt=ze[0];bt>=10;bt/=10,F++);K(Fe,N+(Fe.e=F+B*u-1)+1,W,Y)}else Fe.e=B,Fe.r=+Y;return Fe}}();function A(b,R,S,$){var I,N,W,H,D;if(S==null?S=Q:C(S,0,8),!b.c)return b.toString();if(I=b.c[0],W=b.e,R==null)D=y(b.c),D=$==1||$==2&&(W<=te||W>=pe)?x(D,W):P(D,W,"0");else if(b=K(new p(b),R,S),N=b.e,D=y(b.c),H=D.length,$==1||$==2&&(R<=N||N<=te)){for(;H<R;D+="0",H++);D=x(D,N)}else if(R-=W,D=P(D,N,"0"),N+1>H){if(--R>0)for(D+=".";R--;D+="0");}else if(R+=N-H,R>0)for(N+1==H&&(D+=".");R--;D+="0");return b.s<0&&I?"-"+D:D}function L(b,R){for(var S,$,I=1,N=new p(b[0]);I<b.length;I++)$=new p(b[I]),(!$.s||(S=E(N,$))===R||S===0&&N.s===R)&&(N=$);return N}function j(b,R,S){for(var $=1,I=R.length;!R[--I];R.pop());for(I=R[0];I>=10;I/=10,$++);return(S=$+S*u-1)>Re?b.c=b.e=null:S<et?b.c=[b.e=0]:(b.e=S,b.c=R),b}U=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,W,H,D){var B,F=H?W:W.replace(I,"");if($.test(F))N.s=isNaN(F)?null:F<0?-1:1;else{if(!H&&(F=F.replace(b,function(Y,ae,ce){return B=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!D||D==B?ae:Y}),D&&(B=D,F=F.replace(R,"$1").replace(S,"0.$1")),W!=F))return new p(F,B);if(p.DEBUG)throw Error(s+"Not a"+(D?" base "+D:"")+" number: "+W);N.s=null}N.c=N.e=null}}();function K(b,R,S,$){var I,N,W,H,D,B,F,Y=b.c,ae=h;if(Y){e:{for(I=1,H=Y[0];H>=10;H/=10,I++);if(N=R-I,N<0)N+=u,W=R,D=Y[B=0],F=o(D/ae[I-W-1]%10);else if(B=i((N+1)/u),B>=Y.length)if($){for(;Y.length<=B;Y.push(0));D=F=0,I=1,N%=u,W=N-u+1}else break e;else{for(D=H=Y[B],I=1;H>=10;H/=10,I++);N%=u,W=N-u+I,F=W<0?0:o(D/ae[I-W-1]%10)}if($=$||R<0||Y[B+1]!=null||(W<0?D:D%ae[I-W-1]),$=S<4?(F||$)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||$||S==6&&(N>0?W>0?D/ae[I-W]:0:Y[B-1])%10&1||S==(b.s<0?8:7)),R<1||!Y[0])return Y.length=0,$?(R-=b.e+1,Y[0]=ae[(u-R%u)%u],b.e=-R||0):Y[0]=b.e=0,b;if(N==0?(Y.length=B,H=1,B--):(Y.length=B+1,H=ae[u-N],Y[B]=W>0?o(D/ae[I-W]%ae[W])*H:0),$)for(;;)if(B==0){for(N=1,W=Y[0];W>=10;W/=10,N++);for(W=Y[0]+=H,H=1;W>=10;W/=10,H++);N!=H&&(b.e++,Y[0]==l&&(Y[0]=1));break}else{if(Y[B]+=H,Y[B]!=l)break;Y[B--]=0,H=1}for(N=Y.length;Y[--N]===0;Y.pop());}b.e>Re?b.c=b.e=null:b.e<et&&(b.c=[b.e=0])}return b}function J(b){var R,S=b.e;return S===null?b.toString():(R=y(b.c),R=S<=te||S>=pe?x(R,S):P(R,S,"0"),b.s<0?"-"+R:R)}return V.absoluteValue=V.abs=function(){var b=new p(this);return b.s<0&&(b.s=1),b},V.comparedTo=function(b,R){return E(this,new p(b,R))},V.decimalPlaces=V.dp=function(b,R){var S,$,I,N=this;if(b!=null)return C(b,0,f),R==null?R=Q:C(R,0,8),K(new p(N),b+N.e+1,R);if(!(S=N.c))return null;if($=((I=S.length-1)-v(this.e/u))*u,I=S[I])for(;I%10==0;I/=10,$--);return $<0&&($=0),$},V.dividedBy=V.div=function(b,R){return O(this,new p(b,R),ne,Q)},V.dividedToIntegerBy=V.idiv=function(b,R){return O(this,new p(b,R),0,1)},V.exponentiatedBy=V.pow=function(b,R){var S,$,I,N,W,H,D,B,F,Y=this;if(b=new p(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+J(b));if(R!=null&&(R=new p(R)),H=b.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!b.c||!b.c[0])return F=new p(Math.pow(+J(Y),H?b.s*(2-M(b)):+J(b))),R?F.mod(R):F;if(D=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);$=!D&&Y.isInteger()&&R.isInteger(),$&&(Y=Y.mod(R))}else{if(b.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||H&&Y.c[1]>=24e7:Y.c[0]<8e13||H&&Y.c[0]<=9999975e7)))return N=Y.s<0&&M(b)?-0:0,Y.e>-1&&(N=1/N),new p(D?1/N:N);Pn&&(N=i(Pn/u+2))}for(H?(S=new p(.5),D&&(b.s=1),B=M(b)):(I=Math.abs(+J(b)),B=I%2),F=new p(X);;){if(B){if(F=F.times(Y),!F.c)break;N?F.c.length>N&&(F.c.length=N):$&&(F=F.mod(R))}if(I){if(I=o(I/2),I===0)break;B=I%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)B=M(b);else{if(I=+J(b),I===0)break;B=I%2}Y=Y.times(Y),N?Y.c&&Y.c.length>N&&(Y.c.length=N):$&&(Y=Y.mod(R))}return $?F:(D&&(F=X.div(F)),R?F.mod(R):N?K(F,Pn,Q,W):F)},V.integerValue=function(b){var R=new p(this);return b==null?b=Q:C(b,0,8),K(R,R.e+1,b)},V.isEqualTo=V.eq=function(b,R){return E(this,new p(b,R))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(b,R){return E(this,new p(b,R))>0},V.isGreaterThanOrEqualTo=V.gte=function(b,R){return(R=E(this,new p(b,R)))===1||R===0},V.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},V.isLessThan=V.lt=function(b,R){return E(this,new p(b,R))<0},V.isLessThanOrEqualTo=V.lte=function(b,R){return(R=E(this,new p(b,R)))===-1||R===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(b,R){var S,$,I,N,W=this,H=W.s;if(b=new p(b,R),R=b.s,!H||!R)return new p(NaN);if(H!=R)return b.s=-R,W.plus(b);var D=W.e/u,B=b.e/u,F=W.c,Y=b.c;if(!D||!B){if(!F||!Y)return F?(b.s=-R,b):new p(Y?W:NaN);if(!F[0]||!Y[0])return Y[0]?(b.s=-R,b):new p(F[0]?W:Q==3?-0:0)}if(D=v(D),B=v(B),F=F.slice(),H=D-B){for((N=H<0)?(H=-H,I=F):(B=D,I=Y),I.reverse(),R=H;R--;I.push(0));I.reverse()}else for($=(N=(H=F.length)<(R=Y.length))?H:R,H=R=0;R<$;R++)if(F[R]!=Y[R]){N=F[R]<Y[R];break}if(N&&(I=F,F=Y,Y=I,b.s=-b.s),R=($=Y.length)-(S=F.length),R>0)for(;R--;F[S++]=0);for(R=l-1;$>H;){if(F[--$]<Y[$]){for(S=$;S&&!F[--S];F[S]=R);--F[S],F[$]+=l}F[$]-=Y[$]}for(;F[0]==0;F.splice(0,1),--B);return F[0]?j(b,F,B):(b.s=Q==3?-1:1,b.c=[b.e=0],b)},V.modulo=V.mod=function(b,R){var S,$,I=this;return b=new p(b,R),!I.c||!b.s||b.c&&!b.c[0]?new p(NaN):!b.c||I.c&&!I.c[0]?new p(I):(st==9?($=b.s,b.s=1,S=O(I,b,0,3),b.s=$,S.s*=$):S=O(I,b,0,st),b=I.minus(S.times(b)),!b.c[0]&&st==1&&(b.s=I.s),b)},V.multipliedBy=V.times=function(b,R){var S,$,I,N,W,H,D,B,F,Y,ae,ce,_e,Fe,ze,Me=this,Ve=Me.c,_t=(b=new p(b,R)).c;if(!Ve||!_t||!Ve[0]||!_t[0])return!Me.s||!b.s||Ve&&!Ve[0]&&!_t||_t&&!_t[0]&&!Ve?b.c=b.e=b.s=null:(b.s*=Me.s,!Ve||!_t?b.c=b.e=null:(b.c=[0],b.e=0)),b;for($=v(Me.e/u)+v(b.e/u),b.s*=Me.s,D=Ve.length,Y=_t.length,D<Y&&(_e=Ve,Ve=_t,_t=_e,I=D,D=Y,Y=I),I=D+Y,_e=[];I--;_e.push(0));for(Fe=l,ze=d,I=Y;--I>=0;){for(S=0,ae=_t[I]%ze,ce=_t[I]/ze|0,W=D,N=I+W;N>I;)B=Ve[--W]%ze,F=Ve[W]/ze|0,H=ce*B+F*ae,B=ae*B+H%ze*ze+_e[N]+S,S=(B/Fe|0)+(H/ze|0)+ce*F,_e[N--]=B%Fe;_e[N]=S}return S?++$:_e.splice(0,1),j(b,_e,$)},V.negated=function(){var b=new p(this);return b.s=-b.s||null,b},V.plus=function(b,R){var S,$=this,I=$.s;if(b=new p(b,R),R=b.s,!I||!R)return new p(NaN);if(I!=R)return b.s=-R,$.minus(b);var N=$.e/u,W=b.e/u,H=$.c,D=b.c;if(!N||!W){if(!H||!D)return new p(I/0);if(!H[0]||!D[0])return D[0]?b:new p(H[0]?$:I*0)}if(N=v(N),W=v(W),H=H.slice(),I=N-W){for(I>0?(W=N,S=D):(I=-I,S=H),S.reverse();I--;S.push(0));S.reverse()}for(I=H.length,R=D.length,I-R<0&&(S=D,D=H,H=S,R=I),I=0;R;)I=(H[--R]=H[R]+D[R]+I)/l|0,H[R]=l===H[R]?0:H[R]%l;return I&&(H=[I].concat(H),++W),j(b,H,W)},V.precision=V.sd=function(b,R){var S,$,I,N=this;if(b!=null&&b!==!!b)return C(b,1,f),R==null?R=Q:C(R,0,8),K(new p(N),b,R);if(!(S=N.c))return null;if(I=S.length-1,$=I*u+1,I=S[I]){for(;I%10==0;I/=10,$--);for(I=S[0];I>=10;I/=10,$++);}return b&&N.e+1>$&&($=N.e+1),$},V.shiftedBy=function(b){return C(b,-9007199254740991,c),this.times("1e"+b)},V.squareRoot=V.sqrt=function(){var b,R,S,$,I,N=this,W=N.c,H=N.s,D=N.e,B=ne+4,F=new p("0.5");if(H!==1||!W||!W[0])return new p(!H||H<0&&(!W||W[0])?NaN:W?N:1/0);if(H=Math.sqrt(+J(N)),H==0||H==1/0?(R=y(W),(R.length+D)%2==0&&(R+="0"),H=Math.sqrt(+R),D=v((D+1)/2)-(D<0||D%2),H==1/0?R="5e"+D:(R=H.toExponential(),R=R.slice(0,R.indexOf("e")+1)+D),S=new p(R)):S=new p(H+""),S.c[0]){for(D=S.e,H=D+B,H<3&&(H=0);;)if(I=S,S=F.times(I.plus(O(N,I,B,1))),y(I.c).slice(0,H)===(R=y(S.c)).slice(0,H))if(S.e<D&&--H,R=R.slice(H-3,H+1),R=="9999"||!$&&R=="4999"){if(!$&&(K(I,I.e+ne+2,0),I.times(I).eq(N))){S=I;break}B+=4,H+=4,$=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(K(S,S.e+ne+2,1),b=!S.times(S).eq(N));break}}return K(S,S.e+ne+1,Q,b)},V.toExponential=function(b,R){return b!=null&&(C(b,0,f),b++),A(this,b,R,1)},V.toFixed=function(b,R){return b!=null&&(C(b,0,f),b=b+this.e+1),A(this,b,R)},V.toFormat=function(b,R,S){var $,I=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=at;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if($=I.toFixed(b,R),I.c){var N,W=$.split("."),H=+S.groupSize,D=+S.secondaryGroupSize,B=S.groupSeparator||"",F=W[0],Y=W[1],ae=I.s<0,ce=ae?F.slice(1):F,_e=ce.length;if(D&&(N=H,H=D,D=N,_e-=N),H>0&&_e>0){for(N=_e%H||H,F=ce.substr(0,N);N<_e;N+=H)F+=B+ce.substr(N,H);D>0&&(F+=B+ce.slice(N)),ae&&(F="-"+F)}$=Y?F+(S.decimalSeparator||"")+((D=+S.fractionGroupSize)?Y.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):Y):F}return(S.prefix||"")+$+(S.suffix||"")},V.toFraction=function(b){var R,S,$,I,N,W,H,D,B,F,Y,ae,ce=this,_e=ce.c;if(b!=null&&(H=new p(b),!H.isInteger()&&(H.c||H.s!==1)||H.lt(X)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+J(H));if(!_e)return new p(ce);for(R=new p(X),B=S=new p(X),$=D=new p(X),ae=y(_e),N=R.e=ae.length-ce.e-1,R.c[0]=h[(W=N%u)<0?u+W:W],b=!b||H.comparedTo(R)>0?N>0?R:B:H,W=Re,Re=1/0,H=new p(ae),D.c[0]=0;F=O(H,R,0,1),I=S.plus(F.times($)),I.comparedTo(b)!=1;)S=$,$=I,B=D.plus(F.times(I=B)),D=I,R=H.minus(F.times(I=R)),H=I;return I=O(b.minus(S),$,0,1),D=D.plus(I.times(B)),S=S.plus(I.times($)),D.s=B.s=ce.s,N=N*2,Y=O(B,$,N,Q).minus(ce).abs().comparedTo(O(D,S,N,Q).minus(ce).abs())<1?[B,$]:[D,S],Re=W,Y},V.toNumber=function(){return+J(this)},V.toPrecision=function(b,R){return b!=null&&C(b,1,f),A(this,b,R,2)},V.toString=function(b){var R,S=this,$=S.s,I=S.e;return I===null?$?(R="Infinity",$<0&&(R="-"+R)):R="NaN":(b==null?R=I<=te||I>=pe?x(y(S.c),I):P(y(S.c),I,"0"):b===10&&w?(S=K(new p(S),ne+I+1,Q),R=P(y(S.c),S.e,"0")):(C(b,2,m.length,"Base"),R=G(P(y(S.c),I,"0"),10,b,$,!0)),$<0&&S.c[0]&&(R="-"+R)),R},V.valueOf=V.toJSON=function(){return J(this)},V._isBigNumber=!0,T!=null&&p.set(T),p}function v(T){var O=T|0;return T>0||T===O?O:O-1}function y(T){for(var O,G,U=1,V=T.length,X=T[0]+"";U<V;){for(O=T[U++]+"",G=u-O.length;G--;O="0"+O);X+=O}for(V=X.length;X.charCodeAt(--V)===48;);return X.slice(0,V+1||1)}function E(T,O){var G,U,V=T.c,X=O.c,ne=T.s,Q=O.s,te=T.e,pe=O.e;if(!ne||!Q)return null;if(G=V&&!V[0],U=X&&!X[0],G||U)return G?U?0:-Q:ne;if(ne!=Q)return ne;if(G=ne<0,U=te==pe,!V||!X)return U?0:!V^G?1:-1;if(!U)return te>pe^G?1:-1;for(Q=(te=V.length)<(pe=X.length)?te:pe,ne=0;ne<Q;ne++)if(V[ne]!=X[ne])return V[ne]>X[ne]^G?1:-1;return te==pe?0:te>pe^G?1:-1}function C(T,O,G,U){if(T<O||T>G||T!==o(T))throw Error(s+(U||"Argument")+(typeof T=="number"?T<O||T>G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(T))}function M(T){var O=T.c.length-1;return v(T.e/u)==O&&T.c[O]%2!=0}function x(T,O){return(T.length>1?T.charAt(0)+"."+T.slice(1):T)+(O<0?"e":"e+")+O}function P(T,O,G){var U,V;if(O<0){for(V=G+".";++O;V+=G);T=V+T}else if(U=T.length,++O>U){for(V=G,O-=U;--O;V+=G);T+=V}else O<U&&(T=T.slice(0,O)+"."+T.slice(O));return T}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Pae)})(ML);var _L=ML.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ji=o_(),Xae=r_(),Jae=i_,Zae=_L,kn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Eg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:PL,decimalSuffixes:Dw}=ji.currentBytes(),s_={general:{scale:1024,suffixes:Dw},binary:{scale:1024,suffixes:PL},decimal:{scale:1e3,suffixes:Dw}};function Qae(t,e={},n){if(typeof e=="string"&&(e=Jae.parseFormat(e)),!Xae.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=ele(t,e,n);return s=yle(s,i),s=Cle(s,o),s}function ele(t,e,n){switch(e.output){case"currency":return e=bc(e,ji.currentCurrencyDefaultFormat()),lle(t,e,ji);case"percent":return e=bc(e,ji.currentPercentageDefaultFormat()),ale(t,e,ji,n);case"byte":return e=bc(e,ji.currentByteDefaultFormat()),ile(t,e,ji,n);case"time":return e=bc(e,ji.currentTimeDefaultFormat()),sle(t);case"ordinal":return e=bc(e,ji.currentOrdinalDefaultFormat()),ole(t,e,ji);case"number":default:return Tg({instance:t,providedFormat:e})}}function tle(t){let e=s_.decimal;return sy(t._value,e.suffixes,e.scale).suffix}function nle(t){let e=s_.binary;return sy(t._value,e.suffixes,e.scale).suffix}function rle(t){let e=s_.general;return sy(t._value,e.suffixes,e.scale).suffix}function sy(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function ile(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Eg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Dw,marker:"bd"},binary:{scale:1024,suffixes:s||PL,marker:"b"},decimal:{scale:1e3,suffixes:a||Dw,marker:"d"}}[i],{value:c,suffix:h}=sy(t._value,u.suffixes,u.scale);return`${Tg({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function ole(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Eg,e),o=Tg({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function sle(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function ale(t,e,n,r){let i=e.prefixSymbol,o=Tg({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Eg,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function lle(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Eg,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Tg({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function ule({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&kn[e]?(a=r[e],t=t/kn[e]):l>=kn.trillion||n&&s(l/kn.trillion)===1?(a=r.trillion,t=t/kn.trillion):l<kn.trillion&&l>=kn.billion||n&&s(l/kn.billion)===1?(a=r.billion,t=t/kn.billion):l<kn.billion&&l>=kn.million||n&&s(l/kn.million)===1?(a=r.million,t=t/kn.million):(l<kn.million&&l>=kn.thousand||n&&s(l/kn.thousand)===1)&&(a=r.thousand,t=t/kn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function cle({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function xm(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function hle(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+xm(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(xm(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=xm(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${xm(e)}`),n}function dle(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?hle(t,e):new Zae(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function fle(t,e,n,r,i,o){if(r===-1)return t;let s=dle(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function gle(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function mle(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function ple(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),mle(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function wle(t,e){return t+e}function vle(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function yle(t,e){return e+t}function Cle(t,e){return t+e}function Tg({instance:t,providedFormat:e,state:n=ji,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Eg,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,y=s.thousandSeparated,E=s.spaceSeparated,C=s.negative,M=s.forceSign,x=s.exponential,P=s.roundingFunction,T="";if(d){let G=ule({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:P,totalLength:a});o=G.value,T+=G.abbreviation,a&&(f=G.mantissaPrecision)}if(x){let G=cle({value:o,characteristicPrecision:l});o=G.value,T=G.abbreviation+T}let O=fle(o.toString(),o,g,f,v,P);return O=gle(O,o,u,l),O=ple(O,o,y,n,r),(d||x)&&(O=wle(O,T)),(M||o<0)&&(O=vle(O,o,C)),O}function bc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var ble=t=>({format:(...e)=>Qae(...e,t),getByteUnit:(...e)=>rle(...e,t),getBinaryByteUnit:(...e)=>nle(...e,t),getDecimalByteUnit:(...e)=>tle(...e,t),formatOrDefault:bc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ws=_L;function Sle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.plus(i).toNumber(),t}function xL(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.minus(i).toNumber(),t}function Rle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.times(i).toNumber(),t}function Ele(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.dividedBy(i).toNumber(),t}function Tle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function Mle(t,e,n){let r=n(t._value);return xL(r,e,n),Math.abs(r._value)}var _le=t=>({add:(e,n)=>Sle(e,n,t),subtract:(e,n)=>xL(e,n,t),multiply:(e,n)=>Rle(e,n,t),divide:(e,n)=>Ele(e,n,t),set:(e,n)=>Tle(e,n,t),difference:(e,n)=>Mle(e,n,t),BigNumber:Ws});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ple="2.5.0",ns=o_(),xle=r_(),Ile=qae(tn),Ole=TL();let hl=ble(tn),Wl=_le(tn);const Ale=i_;class IL{constructor(e){this._value=e}clone(){return tn(this._value)}format(e={}){return hl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Ale.parseFormat(e)),e=hl.formatOrDefault(e,ns.currentCurrencyDefaultFormat()),e.output="currency",hl.format(this,e)}formatTime(e={}){return e.output="time",hl.format(this,e)}binaryByteUnits(){return hl.getBinaryByteUnit(this)}decimalByteUnits(){return hl.getDecimalByteUnit(this)}byteUnits(){return hl.getByteUnit(this)}difference(e){return Wl.difference(this,e)}add(e){return Wl.add(this,e)}subtract(e){return Wl.subtract(this,e)}multiply(e){return Wl.multiply(this,e)}divide(e){return Wl.divide(this,e)}set(e){return Wl.set(this,OL(e))}value(){return this._value}valueOf(){return this._value}}function OL(t){let e=t;return tn.isNumbro(t)?e=t._value:typeof t=="string"?e=tn.unformat(t):isNaN(t)&&(e=NaN),e}function tn(t){return new IL(OL(t))}tn.version=Ple;tn.isNumbro=function(t){return t instanceof IL};tn.language=ns.currentLanguage;tn.registerLanguage=ns.registerLanguage;tn.setLanguage=ns.setLanguage;tn.languages=ns.languages;tn.languageData=ns.languageData;tn.zeroFormat=ns.setZeroFormat;tn.defaultFormat=ns.currentDefaults;tn.setDefaults=ns.setDefaults;tn.defaultCurrencyFormat=ns.currentCurrencyDefaultFormat;tn.validate=xle.validate;tn.loadLanguagesInNode=Ile.loadLanguagesInNode;tn.unformat=Ole.unformat;tn.BigNumber=Wl.BigNumber;var Hle=tn,dl=xae(Hle);const Nle="numeric";function AL(t,e){if(Gn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!dl.languages()[r]){const o=r.replace("-",""),s=dl.allLanguages?dl.allLanguages[r]:dl[o];s&&dl.registerLanguage(s)}dl.setLanguage(r),t=dl(t).format(i||"0")}return t}function a_(t,e,n,r,i,o,s){let a=o;if(Gn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=AL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Js(t,e,n,r,i,a,s)}a_.RENDERER_TYPE=Nle;const Dle="password";function l_(t,e,n,r,i,o,s){Js.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),Iu(e,u)}l_.RENDERER_TYPE=Dle;const kle="select";function u_(t,e,n,r,i,o,s){Js.apply(this,[t,e,n,r,i,o,s])}u_.RENDERER_TYPE=kle;const $le="time";function c_(t,e,n,r,i,o,s){Js.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}c_.RENDERER_TYPE=$le;function Lle(){Wr(Sh),Wr(Rg),Wr(e_),Wr(QM),Wr(n_),Wr(ZM),Wr(a_),Wr(l_),Wr(u_),Wr(Js),Wr(c_)}const Fle="autocomplete";function ay(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,FO(n,e)):FO(n,e)(this.source):e(!0)}ay.VALIDATOR_TYPE=Fle;function FO(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function HL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Vle=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:HL},Symbol.toStringTag,{value:"Module"})),Ble="date";function h_(t,e){const n=s$(wL,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=Wle(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}h_.VALIDATOR_TYPE=Ble;function Wle(t,e){const n=Z(HL(t)),r=Z(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const jle="dropdown";function d_(t,e){ay.apply(this,[t,e])}d_.VALIDATOR_TYPE=jle;const Ule="numeric";function f_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Gn(t))}f_.VALIDATOR_TYPE=Ule;const zle=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Yle="time";function g_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,zle,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}g_.VALIDATOR_TYPE=Yle;function Gle(){Gl(ay),Gl(d_),Gl(h_),Gl(f_),Gl(g_)}const Kle="autocomplete",qle={CELL_TYPE:Kle,editor:XM,renderer:Sh,validator:ay},Xle="checkbox",Jle={CELL_TYPE:Xle,editor:pL,renderer:e_},Zle="date";function NL(t,e,n,r,i,o,s){Sh.apply(this,[t,e,n,r,i,o,s])}NL.RENDERER_TYPE=Zle;const Qle="date",eue={CELL_TYPE:Qle,editor:vL,renderer:NL,validator:h_},tue="dropdown",nue={CELL_TYPE:tue,editor:yL,renderer:QM,validator:d_,filter:!1,strict:!0},rue="handsontable",iue={CELL_TYPE:rue,editor:qM,renderer:n_},oue="numeric",sue={CELL_TYPE:oue,editor:CL,renderer:a_,validator:f_,dataType:"number"},aue="password",lue={CELL_TYPE:aue,editor:bL,renderer:l_,copyable:!1},uue="select",cue={CELL_TYPE:uue,editor:SL,renderer:u_},hue="time",due={CELL_TYPE:hue,editor:RL,renderer:c_,validator:g_};function fue(){ci(qle),ci(Jle),ci(eue),ci(nue),ci(iue),ci(sue),ci(lue),ci(cue),ci(gL),ci(due)}function gue(t,e){DL(t,e),e.add(t)}function mue(t,e,n){DL(t,e),e.set(t,n)}function DL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gu(t,e,n){return(e=pue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pue(t){var e=wue(t,"string");return typeof e=="symbol"?e:e+""}function wue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ku(t,e){return t.get(kL(t,e))}function kL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const VO=new Map([["plugin",EQ],["cell-type",iL],["editor",o$],["renderer",m$],["validator",p$]]),$L=Symbol("mainSetting"),vue="base",Im=[];let fl=null;var gl=new WeakMap,BO=new WeakSet;class qe{static get PLUGIN_KEY(){return vue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){gue(this,BO),Gu(this,"eventManager",new Ei(this)),Gu(this,"pluginName",null),Gu(this,"pluginsInitializedCallbacks",[]),Gu(this,"isPluginsReady",!1),Gu(this,"enabled",!1),Gu(this,"initialized",!1),mue(this,gl,{}),ts(this,"hot",e,{writable:!1}),fl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!VO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);VO.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Im.push(o)}}if(fl||(fl=ZE()),fl.indexOf(this.pluginName)>=0&&fl.splice(fl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),fl.length===0){if(Im.length>0){const i=[`${Im.join(`
`)}
`,"You have to import and register them manually."].join("");throw Im.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||De(n))&&r[$L]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(De(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){Ku(gl,this)[e]=Ku(gl,this)[e]||[];const i=Ku(gl,this)[e];this.hot.addHook(e,n,r),i.push(n),Ku(gl,this)[e]=i}removeHooks(e){_(Ku(gl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Ku(gl,this);ke(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){_(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=kL(BO,this,yue).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ke(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function yue(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ml(t,e,n){return(e=Cue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cue(t){var e=bue(t,"string");return typeof e=="symbol"?e:e+""}function bue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let m_=class{constructor(e){ml(this,"hot",null),ml(this,"container",null),ml(this,"injected",!1),ml(this,"rows",[]),ml(this,"columns",[]),ml(this,"samples",null),ml(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),_(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),_(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{_(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{_(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{_(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),_(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{_(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Om(t,e,n){return(e=Sue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sue(t){var e=Rue(t,"string");return typeof e=="symbol"?e:e+""}function Rue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ly{static get SAMPLE_COUNT(){return 3}constructor(e){Om(this,"samples",null),Om(this,"dataFactory",null),Om(this,"customSampleCount",null),Om(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:ly.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:De(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Tt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function Eue(t,e){LL(t,e),e.add(t)}function hb(t,e,n){LL(t,e),e.set(t,n)}function LL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rd(t,e,n){return(e=Tue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tue(t){var e=Mue(t,"string");return typeof e=="symbol"?e:e+""}function Mue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oa(t,e){return t.get(xr(t,e))}function kw(t,e,n){return t.set(xr(t,e),n),n}function xr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutoColumnSizeSeed");const db="autoColumnSize",_ue=10,Pue="autoColumnSize";var p_=new WeakMap,Sc=new WeakMap,ih=new WeakMap,jr=new WeakSet;class tf extends qe{static get PLUGIN_KEY(){return db}static get PLUGIN_PRIORITY(){return _ue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Eue(this,jr),rd(this,"ghostTable",new m_(this.hot)),rd(this,"samplesGenerator",new ly((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),rd(this,"inProgress",!1),rd(this,"measuredColumns",0),rd(this,"columnWidthsMap",new qa),hb(this,p_,!1),hb(this,Sc,[]),hb(this,ih,[]),this.hot.columnIndexMapper.registerMap(Pue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>xr(jr,this,WO).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[db]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(jr,e,Oue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(jr,e,Aue).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(jr,e,Nue).call(e,...i)}),this.addHook("beforeRender",()=>xr(jr,this,Iue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>xr(jr,this,Hue).call(this)),super.enablePlugin()}updatePlugin(){kw(ih,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>xr(jr,this,WO).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&xr(jr,this,FL).call(this,s,o)}),this.ghostTable.columns.length&&(xr(jr,this,VL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Hf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+tf.CALCULATION_STEP,i)},e,n),r=r+tf.CALCULATION_STEP+1,r<i?o=Af(s):(Hf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[db];let n=tf.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return De(e)&&(n=e.syncLimit,ME(n)?n=XE(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,eh))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Oa(Sc,this).length;return(s-1<o||Oa(Sc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Oa(Sc,this).push(i):Oa(Sc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function xue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||xr(jr,this,FL).call(this,n,e))}),this.ghostTable.columns.length&&(xr(jr,this,VL).call(this),this.ghostTable.clean())}function FL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function VL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function Iue(){this.calculateVisibleColumnsWidth(),this.inProgress||(xr(jr,this,xue).call(this,Oa(ih,this)),kw(ih,this,[]))}function Oue(t,e){e||this.recalculateAllColumnsWidth()}function Aue(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Oa(ih,this).push(...e)}function WO(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function Hue(){kw(Sc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),kw(p_,this,!0)}function Nue(t){if(!Oa(p_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Oa(ih,this).push(...e)}const Xl={horizontal:"horizontal",vertical:"vertical"};function Due(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function kue(t){const e={};return t===!0?(e.directions=Object.keys(Xl),e.autoInsertRow=!0):De(t)?(le(t.autoInsertRow)?t.direction===Xl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Xl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function $ue(t,e){Lue(t,e),e.add(t)}function Lue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qu(t,e,n){return(e=Fue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fue(t){var e=Vue(t,"string");return typeof e=="symbol"?e:e+""}function Vue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function id(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutofillRange");oe.getSingleton().register("beforeAutofill");oe.getSingleton().register("afterAutofill");const jO="autofill",Bue=20,Wue=["fillHandle"],jue="insert_row_below",Uue=200;var Xu=new WeakSet;class zue extends qe{constructor(){super(...arguments),$ue(this,Xu),qu(this,"addingStarted",!1),qu(this,"mouseDownOnCellCorner",!1),qu(this,"mouseDragOutside",!1),qu(this,"handleDraggedCells",0),qu(this,"directions",[]),qu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return jO}static get PLUGIN_PRIORITY(){return Bue}static get SETTING_KEYS(){return[jO,...Wue]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>id(Xu,this,Gue).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>id(Xu,this,Yue).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>id(Xu,this,Kue).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return _(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),_(a,c=>{const h=[];_(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=Due(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),v=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,g,v,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=y;const C=y;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(E=[],c==="up"){const M=d.row-h.row+1,x=M%C.length;for(let P=0;P<M;P++)E.push(C[(P+(C.length-x))%C.length])}else{const M=d.col-h.col+1,x=M%C[0].length;for(let P=0;P<C.length;P++){E.push([]);for(let T=0;T<M;T++)E[P].push(C[P][(T+(C[P].length-x))%C[P].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,v,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Xl.vertical)&&this.directions.includes(Xl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Xl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Xl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(jue,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Uue)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Yt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Yt(s)||!Yt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Ln(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+un(this.hot.table),i=Ln(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Qt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>id(Xu,this,que).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>id(Xu,this,Xue).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=kue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Yue(){this.selectAdjacent()&&this.fillIn()}function Gue(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Kue(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function que(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Xue(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Jue(t,e){BL(t,e),e.add(t)}function UO(t,e,n){BL(t,e),e.set(t,n)}function BL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ju(t,e,n){return(e=Zue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zue(t){var e=Que(t,"string");return typeof e=="symbol"?e:e+""}function Que(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WL(t,e,n){return t.set(ko(t,e),n),n}function $w(t,e){return t.get(ko(t,e))}function ko(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fb="autoRowSize",ece=40,tce="autoRowSize";var Lf=new WeakMap,w_=new WeakMap,Cs=new WeakSet;class nf extends qe{static get PLUGIN_KEY(){return fb}static get PLUGIN_PRIORITY(){return ece}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Jue(this,Cs),Ju(this,"headerHeight",null),Ju(this,"ghostTable",new m_(this.hot)),Ju(this,"samplesGenerator",new ly((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Ju(this,"inProgress",!1),Ju(this,"measuredRows",0),Ju(this,"rowHeightsMap",new qa),UO(this,Lf,[]),UO(this,w_,!1),this.hot.rowIndexMapper.registerMap(tce,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>ko(Cs,this,zO).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[fb];return e===!0||De(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ko(Cs,e,ice).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ko(Cs,e,oce).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ko(Cs,e,ace).call(e,...i)}),this.addHook("beforeRender",()=>ko(Cs,this,rce).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>ko(Cs,this,sce).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>ko(Cs,this,zO).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Hf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+nf.CALCULATION_STEP,i)},e,n),r=r+nf.CALCULATION_STEP+1,r<i?o=Af(s):(Hf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[fb];let n=nf.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return De(e)&&(n=e.syncLimit,ME(n)?n=XE(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function nce(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function rce(){this.calculateVisibleRowsHeight(),this.inProgress||(ko(Cs,this,nce).call(this,$w(Lf,this)),WL(Lf,this,[]))}function zO(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function ice(t,e){e||this.recalculateAllRowsHeight()}function oce(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);$w(Lf,this).push(...e)}function sce(){this.recalculateAllRowsHeight(),WL(w_,this,!0)}function ace(t){if(!$w(w_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);$w(Lf,this).push(...e)}const{getListWithInsertedItems:lce,getListWithRemovedItems:uce}=V$("physicallyIndexed");class cce extends Ou{constructor(){super(e=>e)}insert(e,n){const r=RT(this.indexedValues,n);this.indexedValues=lce(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=uce(this.indexedValues,e);this.indexedValues=ST(n,e),super.remove(e)}}const{getListWithInsertedItems:hce,getListWithRemovedItems:dce}=V$("physicallyIndexed");class fce extends Ou{constructor(){super(e=>e)}insert(e,n){this.indexedValues=hce(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=dce(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function gce(t,e){mce(t,e),e.add(t)}function mce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pce(t,e,n){return(e=wce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wce(t){var e=vce(t,"string");return typeof e=="symbol"?e:e+""}function vce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const YO="bindRowsWithHeaders",Cce=210,bce="loose",GO=new Map([["loose",cce],["strict",fce]]);var KO=new WeakSet;class Sce extends qe{constructor(){super(...arguments),gce(this,KO),pce(this,"headerIndexes",null)}static get PLUGIN_KEY(){return YO}static get PLUGIN_PRIORITY(){return Cce}isEnabled(){return!!this.hot.getSettings()[YO]}enablePlugin(){var e;if(this.enabled)return;const n=(e=GO.get(this.getSetting()))!==null&&e!==void 0?e:GO.get(bce);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>yce(KO,this,Rce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Rce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Ece(t,e){jL(t,e),e.add(t)}function Tce(t,e,n){jL(t,e),e.set(t,n)}function jL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qO(t,e,n){return(e=Mce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mce(t){var e=_ce(t,"string");return typeof e=="symbol"?e:e+""}function _ce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XO(t,e){return t.get(Ac(t,e))}function gb(t,e,n){return t.set(Ac(t,e),n),n}function Ac(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wp="collapsibleColumns",Pce=290,xce=["nestedHeaders"],zc="collapsibleIndicator",JO=Wp,ZO=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Zu=new WeakMap,od=new WeakSet;class Ice extends qe{constructor(){super(...arguments),Ece(this,od),qO(this,"nestedHeadersPlugin",null),qO(this,"headerStateManager",null),Tce(this,Zu,null)}static get PLUGIN_KEY(){return Wp}static get PLUGIN_PRIORITY(){return Pce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Wp,...xce]}isEnabled(){return!!this.hot.getSettings()[Wp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||nt("You need to configure the Nested Headers plugin in order to use collapsible headers."),gb(Zu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ac(od,this,Hce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ac(od,e,Nce).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ac(od,e,Oce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Ac(od,this,Ace).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),gb(Zu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:JO,relativeToGroup:Xa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JO)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${zc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${zc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${zc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!ZO.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Ba(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;_(r,f=>{var g;let{row:v,col:y}=f;const{collapsible:E,isCollapsed:C}=(g=this.headerStateManager.getHeaderSettings(v,y))!==null&&g!==void 0?g:{};if(!E||C&&n==="collapse"||!C&&n==="expand")return i=!1,!1});const o=[],s=[];i&&_(r,f=>{let{row:g,col:v}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:C}=this.headerStateManager.triggerNodeModification(n,g,v);y>0&&(s.push(...E),o.push(C))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=pk([...a,...s]):n==="expand"&&(l=Ba(a,f=>!s.includes(f)));const u=ZO.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){_(o,f=>{f()});return}this.hot.batchExecution(()=>{_(s,f=>{XO(Zu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;y!==null&&E!==null&&this.hot.selectCell(y,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return XO(Zu,this).getHiddenIndexes()}destroy(){gb(Zu,this,null),super.destroy()}}function Oce(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${zc}`);if(xu(e,[bi("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,zc),e.querySelector("div:first-child").appendChild(u)),we(u,["collapsed","expanded"]),s?(q(u,"collapsed"),ja(u,"+"),l&&be(e,...bi(!1))):(q(u,"expanded"),ja(u,"-"),l&&be(e,...bi(!0))),l&&be(u,...Pu());else{var c;(c=u)===null||c===void 0||c.remove()}}function Ace(t,e){ve(t.target,zc)&&(ve(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ve(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ii(t))}function Hce(){this.updatePlugin()}function Nce(t,e){e||this.updatePlugin()}function pl(t,e,n){return(e=Dce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dce(t){var e=kce(t,"string");return typeof e=="symbol"?e:e+""}function kce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $ce=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Lce=!1,Fce=!0,Vce=!0;class Bce{constructor(e,n){pl(this,"hot",void 0),pl(this,"sortingStates",new Qv),pl(this,"sortEmptyCells",Lce),pl(this,"indicator",Fce),pl(this,"headerAction",Vce),pl(this,"compareFunctionFactory",void 0),pl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){De(e)&&ke(e,(n,r)=>{$ce.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return De(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function UL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Yo:Yt(i)?Yt(o)?Yo:s&&t==="asc"?Ut:zt:Yt(o)?s&&t==="asc"?zt:Ut:isNaN(i)&&!isNaN(o)?t==="asc"?zt:Ut:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Ut:zt:i>o?t==="asc"?zt:Ut:Yo}}const zL="default";function Wce(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Yo;if(a){if(Yt(r))return t==="asc"?Ut:zt;if(Yt(i))return t==="asc"?zt:Ut}return isNaN(o)?zt:isNaN(s)?Ut:o<s?t==="asc"?Ut:zt:o>s?t==="asc"?zt:Ut:Yo}}const jce="numeric";function Uce(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Yt(s),u=Yt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return zt;if(l===!1&&u)return Ut}return d===!1&&f?t==="asc"?Ut:zt:d&&f===!1?t==="asc"?zt:Ut:d===!1&&f===!1?UL(t,e,n)(s,a):c===i&&h===r?t==="asc"?Ut:zt:c===r&&h===i?t==="asc"?zt:Ut:Yo}}const zce="checkbox";function Yce(t,e,n){return JL(t,e.dateFormat,n)}const Gce="date";function Kce(t,e,n){return JL(t,e.timeFormat,n)}const qce="time",{register:Mg,getItem:QO,hasItem:Xce}=lo("sorting.compareFunctionFactory"),{register:YL,getItem:Jce}=lo("sorting.mainSortComparator");function GL(t){return Xce(t)?QO(t):QO(zL)}Mg(zce,Uce);Mg(Gce,Yce);Mg(zL,UL);Mg(jce,Wce);Mg(qce,Kce);const Yo=0,Ut=-1,zt=1;function Zce(t,e){const n=Jce(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Lw="asc",Fw="desc",KL="colHeader";function Qce(t){if(De(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Lw,Fw].includes(n)}function ehe(t){if(t.some(n=>Qce(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function e1(t){if(t!==Fw)return t===Lw?Fw:Lw}function qL(t){return t.querySelector(`.${KL}`)}function XL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function v_(t,e,n){return t===-1&&e>=0&&Ua(n)===!1}function JL(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Yo;if(Yt(r))return Yt(i)?Yo:o&&t==="asc"?Ut:zt;if(Yt(i))return o&&t==="asc"?zt:Ut;const s=Z(r,e),a=Z(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Ut:zt:a.isBefore(s)?t==="asc"?zt:Ut:Yo:Ut:zt}}function the(t,e){nt(ht`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const nhe="ascending",rhe="descending",ZL="indicatorDisabled",QL="columnSorting",eF="sortAction",tF=new Map([[Lw,nhe],[Fw,rhe]]);function ihe(t,e,n,r){const i=[QL];if(r&&i.push(eF),n===!1)return i.push(ZL),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(tF.get(o)),i}function ohe(){return Array.from(tF.values()).concat(eF,ZL,QL)}function she(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:GL(u.type))(l,u,d)(c,h)}(0)}}function ahe(t,e){lhe(t,e),e.add(t)}function lhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Am(t,e,n){return(e=uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uhe(t){var e=che(t,"string");return typeof e=="symbol"?e:e+""}function che(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vw="columnSorting",hhe=50,Bw="append",dhe="replace",t1=Vw;YL(Vw,she);oe.getSingleton().register("beforeColumnSort");oe.getSingleton().register("afterColumnSort");const sd=new WeakMap;var jl=new WeakSet;class nF extends qe{constructor(){super(...arguments),ahe(this,jl),Am(this,"columnStatesManager",null),Am(this,"columnMetaCache",null),Am(this,"pluginKey",Vw),Am(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Vw}static get PLUGIN_PRIORITY(){return hhe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(sd.has(this.hot)&&sd.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),the(sd.get(this.hot),this.pluginKey);return}this.enabled||(sd.set(this.hot,this.pluginKey),this.columnStatesManager=new Bce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new qa(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Rc(jl,this,fhe).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rc(jl,e,mhe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Rc(jl,this,WR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rc(jl,e,ghe).call(e,...r)}),this.hot.view&&Rc(jl,this,WR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=qL(r);XL(n,r)===!1||i===null||this.updateHeaderClasses(i)};sd.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Xa,position:"before",group:t1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(t1)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new B$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return ehe(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=e1(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:e1()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ht(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Bw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===dhe)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(De(e)){const n=e[this.pluginKey];if(De(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):ut(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);Zce(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(De(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||De(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(we(e,ohe()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,ihe(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ve(e.target,KL)}onAfterOnCellMouseDown(e,n){if(v_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function WR(){const t=this.getAllSavedSortSettings();if(De(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function fhe(t,e){const n=qL(e);if(XL(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);be(e,...V8(s?`${s}ending`:"none"))}}function ghe(t){t===!0&&this.hot.view&&Rc(jl,this,WR).call(this)}function mhe(t,e,n,r){v_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function wl(t,e,n){return(e=phe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function phe(t){var e=whe(t,"string");return typeof e=="symbol"?e:e+""}function whe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vhe{constructor(e,n){wl(this,"plugin",void 0),wl(this,"hot",void 0),wl(this,"endpoints",[]),wl(this,"settings",void 0),wl(this,"settingsType","array"),wl(this,"currentEndpoint",null),wl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),_(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();_(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;_(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?_(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):_(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){_(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];_(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),_(i,o=>{let s=[];_(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,_(e.ranges,r=>{_(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],_(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],_(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],_(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&_(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),_(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){nt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function mb(t){return t==null||isNaN(t)}function yhe(t,e){Che(t,e),e.add(t)}function Che(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bhe(t,e,n){return(e=She(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function She(t){var e=Rhe(t,"string");return typeof e=="symbol"?e:e+""}function Rhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pb="columnSummary",Ehe=220;var ad=new WeakSet;class The extends qe{constructor(){super(...arguments),yhe(this,ad),bhe(this,"endpoints",null)}static get PLUGIN_KEY(){return pb}static get PLUGIN_PRIORITY(){return Ehe}isEnabled(){return!!this.hot.getSettings()[pb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[pb],this.endpoints=new vhe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hm(ad,e,Mhe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hm(ad,e,Phe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hm(ad,e,_he).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hm(ad,e,xhe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return ke(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=mb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return ke(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=mb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=mb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return ke(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ht`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Mhe(){this.endpoints.initEndpoints()}function _he(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Phe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function xhe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Ihe(t,e){rF(t,e),e.add(t)}function wb(t,e,n){rF(t,e),e.set(t,n)}function rF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ec(t,e){return t.get(y_(t,e))}function jR(t,e,n){return t.set(y_(t,e),n),n}function y_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ww=new WeakMap,Nm=new WeakMap,Dm=new WeakMap,n1=new WeakSet;class iF{constructor(){Ihe(this,n1),wb(this,Ww,!0),wb(this,Nm,null),wb(this,Dm,new ResizeObserver(e=>y_(n1,this,Ohe).call(this,e)))}setObservedElement(e){jR(Nm,this,e)}unobserve(){Ec(Dm,this).unobserve(Ec(Nm,this))}observe(){jR(Ww,this,!0),Ec(Dm,this).observe(Ec(Nm,this))}destroy(){Ec(Dm,this).disconnect()}}function Ohe(t){if(Ec(Ww,this)||!Array.isArray(t)||!t.length){jR(Ww,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}mt(iF,Fn);function vl(t,e,n){Ahe(t,e),e.set(t,n)}function Ahe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(t,e){return t.get(oF(t,e))}function fs(t,e,n){return t.set(oF(t,e),n),n}function oF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yl=new WeakMap,vb=new WeakMap,gs=new WeakMap,na=new WeakMap,ra=new WeakMap,km=new WeakMap,Qu=new WeakMap;class Jl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;vl(this,yl,void 0),vl(this,vb,!1),vl(this,gs,null),vl(this,na,void 0),vl(this,ra,void 0),vl(this,km,!0),vl(this,Qu,new iF),fs(yl,this,e),fs(vb,this,n),fs(na,this,this.createEditor()),fs(ra,this,pt(na,this).style),pt(Qu,this).setObservedElement(this.getInputElement()),pt(Qu,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){pt(ra,this).left=`${e}px`,pt(ra,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Qt(this.getInputElement()),height:un(this.getInputElement())}}observeSize(){pt(Qu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){pt(ra,this).display="block",fs(km,this,!1)}hide(){pt(Qu,this).unobserve(),pt(km,this)||(pt(ra,this).display="none"),fs(km,this,!0)}isVisible(){return pt(ra,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return pt(yl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=pt(yl,this).createElement("div"),n=pt(yl,this).createElement("textarea");return e.style.display="none",fs(gs,this,pt(yl,this).createElement("div")),pt(gs,this).setAttribute("dir",pt(vb,this)?"rtl":"ltr"),q(pt(gs,this),Jl.CLASS_EDITOR_CONTAINER),pt(yl,this).body.appendChild(pt(gs,this)),q(e,Jl.CLASS_EDITOR),q(n,Jl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),pt(gs,this).appendChild(e),e}getInputElement(){return pt(na,this).querySelector(`.${Jl.CLASS_INPUT}`)}getEditorElement(){return pt(na,this)}destroy(){const e=pt(gs,this)?pt(gs,this).parentNode:null;pt(na,this).parentNode.removeChild(pt(na,this)),fs(na,this,null),fs(ra,this,null),pt(Qu,this).destroy(),e&&e.removeChild(pt(gs,this))}}mt(Jl,Fn);function yb(t,e,n){return(e=Hhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hhe(t){var e=Nhe(t,"string");return typeof e=="symbol"?e:e+""}function Nhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Dhe=250,khe=250;class sF{constructor(e){yb(this,"wasLastActionShow",!0),yb(this,"showDebounced",null),yb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},khe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dhe;this.showDebounced=mg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}mt(sF,Fn);function $he(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Lhe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Cl(t,e){const n={};return _(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function pa(t,e,n,r,i){_(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Fhe(s,a,e,n,r,i)})})}function Fhe(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=$he(s.className,r):a=Lhe(s.className,r)),o(t,e,"className",a)}function aF(t){return`<span class="selected">✓</span>${t}`}function jp(t,e){let n=!1;return Array.isArray(t)&&_(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function uy(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Le="---------";function Vhe(){return{name:Le}}const fi="alignment";function Bhe(){return{key:fi,name(){return this.getTranslatedPhrase(KT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${fi}:left`,name(){return this.getTranslatedPhrase(qT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:center`,name(){return this.getTranslatedPhrase(XT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:right`,name(){return this.getTranslatedPhrase(JT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:justify`,name(){return this.getTranslatedPhrase(ZT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Le},{key:`${fi}:top`,name(){return this.getTranslatedPhrase(QT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:middle`,name(){return this.getTranslatedPhrase(eM)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:bottom`,name(){return this.getTranslatedPhrase(tM)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const cy="clear_column";function Whe(){return{key:cy,name(){return this.getTranslatedPhrase(NT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const _g="col_left";function jhe(){return{key:_g,name(){return this.getTranslatedPhrase(PT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Pg="col_right";function Uhe(){return{key:Pg,name(){return this.getTranslatedPhrase(xT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const xg="make_read_only";function zhe(){return{key:xg,checkable:!0,ariaChecked(){return jp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Ow)},name(){let t=this.getTranslatedPhrase(Ow);return jp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=aF(t)),t},callback(){const t=this.getSelectedRange(),e=jp(t,(n,r)=>this.getCellMeta(n,r).readOnly);_(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const hy="redo";function Yhe(){return{key:hy,name(){return this.getTranslatedPhrase(HT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Ig="remove_col";function Ghe(){return{key:Ig,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(OT,e)},callback(){this.alter("remove_col",Iie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const dy="remove_row";function Khe(){return{key:dy,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(IT,e)},callback(){this.alter("remove_row",Oie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const fy="row_above";function qhe(){return{key:fy,name(){return this.getTranslatedPhrase(MT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const gy="row_below";function Xhe(){return{key:gy,name(){return this.getTranslatedPhrase(_T)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Ff="no_items";function Jhe(){return{key:Ff,name(){return this.getTranslatedPhrase(TT)},disabled:!0,isCommand:!1}}const my="undo";function Zhe(){return{key:my,name(){return this.getTranslatedPhrase(AT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Qhe=[fy,gy,_g,Pg,cy,dy,Ig,my,hy,xg,fi,Le,Ff],ede={[Le]:Vhe,[Ff]:Jhe,[fy]:qhe,[gy]:Xhe,[_g]:jhe,[Pg]:Uhe,[cy]:Whe,[dy]:Khe,[Ig]:Ghe,[my]:Zhe,[hy]:Yhe,[xg]:zhe,[fi]:Bhe};function lF(){const t={};return ke(ede,(e,n)=>{t[n]=e()}),t}function tde(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(zT):this.getTranslatedPhrase(UT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function nde(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(YT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function rde(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(GT);return jp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Up))?aF(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Up);t.updateCommentMeta(n,r,{[Up]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ide(t,e){uF(t,e),e.add(t)}function ec(t,e,n){uF(t,e),e.set(t,n)}function uF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ode(t,e,n){return(e=sde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sde(t){var e=ade(t,"string");return typeof e=="symbol"?e:e+""}function ade(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aa(t,e,n){return t.set(Rr(t,e),n),n}function He(t,e){return t.get(Rr(t,e))}function Rr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jw="comments",lde=60,Ts="comment",Wd="value",cF="style",Up="readOnly",ld=jw,UR=`plugin:${jw}`;var ft=new WeakMap,Ao=new WeakMap,py=new WeakMap,zp=new WeakMap,zR=new WeakMap,Uw=new WeakMap,kr=new WeakSet;class ude extends qe{constructor(){super(...arguments),ide(this,kr),ode(this,"range",{}),ec(this,ft,null),ec(this,Ao,null),ec(this,py,!1),ec(this,zp,!1),ec(this,zR,null),ec(this,Uw,"")}static get PLUGIN_KEY(){return jw}static get PLUGIN_PRIORITY(){return lde}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[jw]}enablePlugin(){var e=this;this.enabled||(He(ft,this)||(Aa(ft,this,new Jl(this.hot.rootDocument,this.hot.isRtl())),He(ft,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr(kr,e,wde).call(e,...r)})),He(Ao,this)||Aa(Ao,this,new sF(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Rr(kr,this,gde).call(this,n,a)),this.addHook("afterScroll",()=>Rr(kr,this,vde).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Rr(kr,this,r1).call(this,n)),this.addHook("beforeCompositionStart",n=>Rr(kr,this,r1).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr(kr,e,yde).call(e,...r)}),He(Ao,this).addLocalHook("hide",()=>this.hide()),He(Ao,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){He(Ao,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(UR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Aa(zp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(UR),this.hot._registerTimeout(()=>{Aa(zp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:ld}),r.addShortcut({keys:[["Escape"]],callback:()=>{He(ft,this).setValue(He(Uw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ft,this).isVisible()&&He(ft,this).isFocused(),group:ld}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ft,this).isVisible()&&He(ft,this).isFocused(),group:ld}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{He(ft,this).setValue(He(ft,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:ld})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ld)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Rr(kr,this,dde).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Rr(kr,this,cde).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Rr(kr,this,fde).call(this)),this.eventManager.addEventListener(n,"focus",()=>Rr(kr,this,pde).call(this)),this.eventManager.addEventListener(n,"blur",()=>Rr(kr,this,mde).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Rr(kr,this,hde).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Wa(e.target,"TD","TBODY");return!!(n&&ve(n,"htCommentCell")&&Wa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=He(ft,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Wd]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ts),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Wd)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Wd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return He(Ao,this).cancelHiding(),He(ft,this).setValue((e=i[Ts]?i[Ts][Wd]:null)!==null&&e!==void 0?e:""),He(ft,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){He(ft,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!He(ft,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;He(ft,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(i,o,cF);v?He(ft,this).setSize(v.width,v.height):He(ft,this).resetSize();const y=c?0:f.getColumnWidth(a),E=l&&!u?un(g):0,{left:C,top:M,width:x,height:P}=g.getBoundingClientRect(),{width:T,height:O}=He(ft,this).getSize(),{innerWidth:G,innerHeight:U}=this.hot.rootWindow,V=this.hot.rootDocument.documentElement,X=_n(this.hot.rootDocument),ne=DE(this.hot.rootWindow)?X:0,Q=kE(this.hot.rootWindow)?X:0;let te=C+h.scrollX+y,pe=M+h.scrollY+E;this.hot.isRtl()&&(te-=T+y),this.hot.isLtr()&&C+x+T>G-ne?te=C+h.scrollX-T-1:this.hot.isRtl()&&te<-(V.scrollWidth-V.clientWidth)&&(te=C+h.scrollX+y+1),M+O>U-Q&&(pe-=O-P+1),He(ft,this).setPosition(te,pe),He(ft,this).setReadOnlyState(this.getCommentMeta(i,o,Up)),He(ft,this).observeSize()}focusEditor(){He(ft,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Ts];let o;i?(o=Qn(i),wg(o,r)):o=r,this.hot.setCellMeta(e,n,Ts,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Ts])return i[Ts][r]}addToContextMenu(e){e.items.push({name:Le},tde(this),nde(this),rde(this))}getEditorInputElement(){return He(ft,this).getInputElement()}destroy(){var e,n;(e=He(ft,this))===null||e===void 0||e.destroy(),(n=He(Ao,this))===null||n===void 0||n.destroy(),super.destroy()}}function cde(t){if(!(!this.hot.view||!this.hot.view._wt)&&!He(py,this)&&!this.targetIsCommentTextArea(t)){const e=Wa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function hde(t){t.stopPropagation()}function dde(t){const{rootDocument:e}=this.hot;if(!(He(py,this)||He(ft,this).isFocused()||ve(t.target,"wtBorder")||He(zR,this)===t.target||!He(ft,this)))if(Aa(zR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));He(Ao,this).show(n)}else ka(t.target,e)&&!this.targetIsCommentTextArea(t)&&He(Ao,this).hide()}function fde(){Aa(py,this,!1)}function gde(t,e){e[Ts]&&e[Ts][Wd]&&q(t,e.commentedCellClassName)}function mde(){Aa(Uw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function pde(){Aa(Uw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(UR)}function wde(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[cF]:{width:t,height:e}})}function r1(t){He(ft,this).isFocused()&&Ii(t)}function vde(){He(zp,this)||this.hide()}function yde(){const t=He(ft,this).getEditorElement();we(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function Cb(t,e,n){return(e=Cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cde(t){var e=bde(t,"string");return typeof e=="symbol"?e:e+""}function bde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hF{constructor(e){Cb(this,"hot",void 0),Cb(this,"commands",{}),Cb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Sde(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||ln(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),_(u,c=>c.apply(this.hot,r))}}function Sde(t,e){let n;return _(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function bb(t,e,n){return(e=Rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rde(t){var e=Ede(t,"string");return typeof e=="symbol"?e:e+""}function Ede(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;bb(this,"hot",void 0),bb(this,"predefinedItems",lF()),bb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,ke(e,(r,i)=>{let o="";r.name===Le?(n[Le]=r,o=Le):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Tde(e,this.defaultOrderPattern,this.predefinedItems)}}function Tde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),De(i)?ke(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),De(o)?cn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):_(i,(o,s)=>{let a=n[o];!a&&Qhe.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),De(o)&&cn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ia(t,e,n){return(e=Mde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mde(t){var e=_de(t,"string");return typeof e=="symbol"?e:e+""}function _de(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pde{constructor(e,n){ia(this,"top",void 0),ia(this,"topRelative",void 0),ia(this,"left",void 0),ia(this,"leftRelative",void 0),ia(this,"scrollTop",void 0),ia(this,"scrollLeft",void 0),ia(this,"cellHeight",void 0),ia(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ud(t,e,n){xde(t,e),e.set(t,n)}function xde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(fF(t,e))}function $m(t,e,n){return t.set(fF(t,e),n),n}function fF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rr=new WeakMap,yr=new WeakMap,Cr=new WeakMap,Sb=new WeakMap,tc=new WeakMap;class Ide{constructor(e){ud(this,rr,void 0),ud(this,yr,void 0),ud(this,Cr,void 0),ud(this,Sb,!1),ud(this,tc,{above:0,below:0,left:0,right:0}),$m(Sb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Oe(tc,this)[e]=n,this}setElement(e){return $m(rr,this,e),this}setParentElement(e){return $m(yr,this,e),this}updatePosition(e){$m(Cr,this,new Pde(e,Oe(rr,this).ownerDocument.defaultView)),Oe(Sb,this)?(Oe(Cr,this).fitsBelow(Oe(rr,this))?this.setPositionBelowCursor():Oe(Cr,this).fitsAbove(Oe(rr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Oe(rr,this).dir==="rtl"?Oe(Cr,this).fitsOnLeft(Oe(rr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Oe(Cr,this).fitsOnRight(Oe(rr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Oe(tc,this).above+Oe(Cr,this).top-Oe(rr,this).offsetHeight;if(Oe(yr,this)){const r=Oe(yr,this).ownerDocument.defaultView.getComputedStyle(Oe(yr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Cr,this).top+Oe(Cr,this).cellHeight-Oe(rr,this).scrollHeight+i+o}Oe(rr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Oe(tc,this).below+Oe(Cr,this).top+1;if(Oe(yr,this)){const r=Oe(yr,this).ownerDocument.defaultView.getComputedStyle(Oe(yr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Cr,this).top-i-o-1}Oe(rr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Oe(Cr,this).left;if(Oe(yr,this)){const n=Oe(yr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(yr,this).querySelector(".htCore")).borderRightWidth,10);e+=Oe(Cr,this).cellWidth+r}else e+=Oe(tc,this).right;Oe(rr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Oe(tc,this).left+Oe(Cr,this).left-Oe(rr,this).offsetWidth;if(Oe(yr,this)){const n=Oe(yr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(yr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Oe(rr,this).style.left=`${e}px`}}function gF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ye(e,-1,g()-1);function a(y,E){const C=g()-1;return y<0&&(y=C),y>C&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(E===1?++y:--y,E)),y)}function l(y){y>-1&&y<g()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:v}}function Ode(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function YR(t){return ln(t,"submenu")}function GR(t){return new RegExp(Le,"i").test(t.name)}function Yp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function i1(t){return ln(t,"disableSelection")}function Ade(t){return ve(t,"htSeparator")}function Hde(t){return ve(t,"htSubmenu")}function Nde(t){return ve(t,"htDisabled")}function Dde(t){return ve(t,"htSelectionDisabled")}function kde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function mF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function $de(t,e){let n=t.slice(0);return n.reverse(),n=mF(n,e),n.reverse(),n}function Lde(t){const e=[];return _(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Fde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le,n=t.slice(0);return n=mF(n,e),n=$de(n,e),n=Lde(n),n}function Vde(t){return t.checkable===!0}function Bde(t){return gF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Ade(r)||Nde(r)||Dde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Wde(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const pF="menu",o1=pF;function jde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Wde(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:pF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${o1}:${u}`:o1}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Ude(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(qo(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Yp(a,t)&&!i1(a)&&!GR(a);be(n,[...Vde(a)?[O8(),xf(c),Ek(h)]:[I8(),xf(u)],...d?[_u(-1)]:[],...Yp(a,t)?[L8()]:[],...YR(a)?[bi(!1)]:[]])}n.className="",n.appendChild(l),GR(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Iu(l,u),Yp(a,t)?q(n,"htDisabled"):i1(a)?q(n,"htSelectionDisabled"):YR(a)&&q(n,"htSubmenu")}}function Rb(t,e,n){zde(t,e),e.set(t,n)}function zde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yo(t,e,n){return(e=Yde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yde(t){var e=Gde(t,"string");return typeof e=="symbol"?e:e+""}function Gde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eb(t,e,n){return t.set(wF(t,e),n),n}function bl(t,e){return t.get(wF(t,e))}function wF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const s1=215;var cd=new WeakMap,Lm=new WeakMap,Fm=new WeakMap;class Rh{get tableBorderWidth(){return bl(Fm,this)===void 0&&this.hotMenu&&Eb(Fm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),bl(Fm,this)}constructor(e,n){var r=this;yo(this,"hot",void 0),yo(this,"options",void 0),yo(this,"eventManager",new Ei(this)),yo(this,"container",void 0),yo(this,"positioner",void 0),yo(this,"hotMenu",null),yo(this,"hotSubMenus",{}),yo(this,"parentMenu",void 0),yo(this,"menuItems",null),yo(this,"origOutsideClickDeselects",null),Rb(this,cd,void 0),Rb(this,Lm,void 0),Rb(this,Fm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:s1,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Ide(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=cu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return bl(cd,this)}getKeyboardShortcutsCtrl(){return bl(Lm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=mg(a=>this.openSubMenu(a),300),n=this.options.minWidth||s1;let r=!1,i=Ba(this.menuItems,a=>(a.key===Ff&&(r=!0),kde(a,this.hot)));if(i.length<1&&!r)i.push(lF()[Ff]);else if(i.length===0)return;i=Fde(i,Le);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Ude(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{bl(cd,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),CR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!CR()||!Ua(a))&&o&&this.hasSelectedItem()&&(jo()||UE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Eb(cd,this,Bde(this.hotMenu)),Eb(Lm,this,jde(this)),bl(Lm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(bl(cd,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);be(r,[bi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Hde(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Rh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&be(n,[bi(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&be(i,[bi(!1)])}}closeAllSubMenus(){_(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Ode(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||GR(e)||Yp(e,this.hot)||YR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=Sn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?un(this.hotMenu.getCell(c,0)):0;return l+(u.name===Le?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(ut(r)&&(r=r.call(this.hot),r===null||Ht(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&be(this.hotMenu.rootElement,[x8(),_u(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ka(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ka(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&ka(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mt(Rh,Fn);function Kde(t,e){qde(t,e),e.add(t)}function qde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tb(t,e,n){return(e=Xde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xde(t){var e=Jde(t,"string");return typeof e=="symbol"?e:e+""}function Jde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jd="contextMenu",Zde=70,a1=jd;oe.getSingleton().register("afterContextMenuDefaultOptions");oe.getSingleton().register("beforeContextMenuShow");oe.getSingleton().register("afterContextMenuShow");oe.getSingleton().register("afterContextMenuHide");oe.getSingleton().register("afterContextMenuExecute");var hd=new WeakSet;class wy extends qe{constructor(){super(...arguments),Kde(this,hd),Tb(this,"commandExecutor",new hF(this.hot)),Tb(this,"itemsFactory",null),Tb(this,"menu",null)}static get PLUGIN_KEY(){return jd}static get PLUGIN_PRIORITY(){return Zde}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[fy,gy,Le,_g,Pg,Le,dy,Ig,Le,my,hy,Le,xg,Le,fi]}isEnabled(){return!!this.hot.getSettings()[jd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[jd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Rh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Vm(hd,this,efe).call(this)),this.menu.addLocalHook("afterOpen",()=>Vm(hd,this,tfe).call(this)),this.menu.addLocalHook("afterClose",()=>Vm(hd,this,nfe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Vm(hd,this,Qde).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=uy(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:a1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(a1)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;ke(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new dF(this.hot,wy.DEFAULT_ITEMS);const e=this.hot.getSettings()[jd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),_(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Qde(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=uy(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function efe(){this.hot.runHooks("beforeContextMenuShow",this)}function tfe(){this.hot.runHooks("afterContextMenuShow",this)}function nfe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}wy.SEPARATOR={name:Le};function rfe(t){return{key:"copy",name(){return this.getTranslatedPhrase(DT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ife(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(LT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ofe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase($T,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function sfe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(kT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function afe(t){return{key:"cut",name(){return this.getTranslatedPhrase(FT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class lfe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class ufe{constructor(){this.clipboardData=new lfe}preventDefault(){}composedPath(){return[]}}function cfe(t,e){vF(t,e),e.add(t)}function nc(t,e,n){vF(t,e),e.set(t,n)}function vF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(Hc(t,e))}function rc(t,e,n){return t.set(Hc(t,e),n),n}function Hc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oa=new WeakMap,Mb=new WeakMap,dd=new WeakMap,KR=new WeakMap,qR=new WeakMap,fd=new WeakMap,gd=new WeakSet;class hfe{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;cfe(this,gd),nc(this,oa,void 0),nc(this,Mb,void 0),nc(this,dd,void 0),nc(this,KR,void 0),nc(this,qR,void 0),nc(this,fd,void 0),rc(Mb,this,n),rc(dd,this,r),rc(KR,this,i),rc(qR,this,o),rc(fd,this,s)}setSelectedRange(e){rc(oa,this,e)}getCellsRange(){if(sr(Mb,this).call(this)===0||sr(dd,this).call(this)===0)return null;const{row:e,col:n}=sr(oa,this).getTopStartCorner(),{row:r,col:i}=sr(oa,this).getBottomEndCorner(),o=Hc(gd,this,dfe).call(this,e,r),s=Hc(gd,this,_b).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(sr(dd,this).call(this)===0||sr(fd,this).call(this)===0)return null;const{col:e}=sr(oa,this).getTopStartCorner(),{col:n}=sr(oa,this).getBottomEndCorner(),r=Hc(gd,this,_b).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(sr(dd,this).call(this)===0||sr(fd,this).call(this)===0)return null;const{col:e}=sr(oa,this).getTopStartCorner(),{col:n}=sr(oa,this).getBottomEndCorner(),r=Hc(gd,this,_b).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-sr(fd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function _b(t,e){return Math.min(e,Math.max(t+sr(qR,this).call(this)-1,t))}function dfe(t,e){return Math.min(e,Math.max(t+sr(KR,this).call(this)-1,t))}function yF(t){const e=[],n=[];return _(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function ffe(t,e){CF(t,e),e.add(t)}function sa(t,e,n){CF(t,e),e.set(t,n)}function CF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function md(t,e,n){return(e=gfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gfe(t){var e=mfe(t,"string");return typeof e=="symbol"?e:e+""}function mfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pr(t,e){return t.get(Ir(t,e))}function Bi(t,e,n){return t.set(Ir(t,e),n),n}function Ir(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterCopyLimit");oe.getSingleton().register("modifyCopyableRange");oe.getSingleton().register("beforeCut");oe.getSingleton().register("afterCut");oe.getSingleton().register("beforePaste");oe.getSingleton().register("afterPaste");oe.getSingleton().register("beforeCopy");oe.getSingleton().register("afterCopy");const Pb="copyPaste",pfe=80,wfe=["fragmentSelection"],l1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var XR=new WeakMap,JR=new WeakMap,ZR=new WeakMap,ic=new WeakMap,Bm=new WeakMap,Wm=new WeakMap,oc=new WeakMap,zw=new WeakMap,Ur=new WeakSet;class vfe extends qe{constructor(){super(...arguments),ffe(this,Ur),md(this,"columnsLimit",1/0),md(this,"rowsLimit",1/0),md(this,"pasteMode","overwrite"),md(this,"uiContainer",this.hot.rootDocument.body),sa(this,XR,!1),sa(this,JR,!1),sa(this,ZR,!1),sa(this,ic,"cells-only"),sa(this,Bm,!1),sa(this,Wm,!1),sa(this,oc,new hfe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),sa(this,zw,!1),md(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Pb}static get SETTING_KEYS(){return[Pb,...wfe]}static get PLUGIN_PRIORITY(){return pfe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Pb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Bi(XR,this,this.getSetting("copyColumnHeaders")),Bi(JR,this,this.getSetting("copyColumnGroupHeaders")),Bi(ZR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Ir(Ur,this,bfe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(Ur,r,Sfe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Ir(Ur,this,Rfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Nf()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(Ur,r,Efe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(Ur,r,Tfe).call(r,...o)}),this.addHook("afterSelection",()=>Ir(Ur,this,Mfe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Bi(ic,this,e),Bi(Bm,this,!0),Ir(Ur,this,u1).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Bi(Wm,this,!0),Ir(Ur,this,u1).call(this,"cut")}getRangedCopyableData(e){return ef(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=yF(e);return _(r,o=>{const s=[];_(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new ufe;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Pr(oc,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Pr(ic,this)==="column-headers-only"?n.set("headers",Pr(oc,this).getMostBottomColumnHeadersRange()):(Pr(ic,this)==="with-column-headers"?n.set("headers",Pr(oc,this).getMostBottomColumnHeadersRange()):Pr(ic,this)==="with-column-group-headers"&&n.set("headers",Pr(oc,this).getAllColumnHeadersRange()),n.set("cells",Pr(oc,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,g===!0)continue;d=v,h=a;const y=[],E=o.length%r;for(;y.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:M}=this.hot.getCellMeta(s,h);if(h=M+1,C===!0)continue;f=M;const x=y.length%i;y.push(e[E][x])}o.push(y)}return Bi(zw,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Pr(Bm,this)||this.isEditorOpened()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Xd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Bi(Bm,this,!1);const o=this.getRangedData(this.copyableRanges),s=Ir(Ur,this,yfe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=ef(o);if(e&&e.clipboardData){const u=MR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[l1,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Bi(ic,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Pr(Wm,this)||this.isEditorOpened()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Xd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Bi(Wm,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=ef(o);if(e&&e.clipboardData){const l=MR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[l1,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Xd(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Lv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=h$(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=kie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function u1(t){if(Nf()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&$k(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function yfe(t){const{rows:e}=yF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Cfe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&LE(r)}}}function bF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&FE(r)}}}function bfe(t){t.items.push({name:"---------"},rfe(this)),Pr(XR,this)&&t.items.push(sfe(this)),Pr(JR,this)&&t.items.push(ofe(this)),Pr(ZR,this)&&t.items.push(ife(this)),t.items.push(afe(this))}function Sfe(t,e,n,r,i){Pr(zw,this)&&(i.value=!0),Bi(zw,this,!1)}function Rfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Efe(){Ir(Ur,this,bF).call(this)}function Tfe(){Ir(Ur,this,Cfe).call(this)}function Mfe(){Ir(Ur,this,bF).call(this)}function SF(t,e){return`border_row${t}col${e}`}function Ud(){return{width:1,color:"#000"}}function Ns(){return{hide:!0}}function _fe(){return{width:1,color:"#000",cornerVisible:!1}}function xb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function pd(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Ib(t,e){return{id:SF(t,e),border:_fe(),row:t,col:e,top:Ns(),bottom:Ns(),start:Ns(),end:Ns()}}function Pfe(t,e){return ln(e,"border")&&e.border&&(t.border=e.border),ln(e,"top")&&le(e.top)&&(e.top?(De(e.top)||(e.top=Ud()),t.top=e.top):(e.top=Ns(),t.top=e.top)),ln(e,"bottom")&&le(e.bottom)&&(e.bottom?(De(e.bottom)||(e.bottom=Ud()),t.bottom=e.bottom):(e.bottom=Ns(),t.bottom=e.bottom)),ln(e,"start")&&le(e.start)&&(e.start?(De(e.start)||(e.start=Ud()),t.start=e.start):(e.start=Ns(),t.start=e.start)),ln(e,"end")&&le(e.end)&&(e.end?(De(e.end)||(e.end=Ud()),t.end=e.end):(e.end=Ns(),t.end=e.end)),t}function js(t,e){let n=!1;return _(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!ln(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function vy(t){return`<span class="selected">✓</span>${t}`}function xfe(t){return t.some(e=>le(e.left)||le(e.right))}function Ife(t){return t.some(e=>le(e.start)||le(e.end))}const Ofe=new Map([["left","start"],["right","end"]]);function Afe(t){var e;return(e=Ofe.get(t))!==null&&e!==void 0?e:t}function Hfe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(oM);return js(this,"bottom")&&(e=vy(e)),e},callback(e,n){const r=js(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function Nfe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(sM);return js(this,e)&&(n=vy(n)),n},callback(n,r){const i=js(this,e);t.prepareBorder(r,e,i)}}}function Dfe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(aM)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!js(this)}}}function kfe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(iM);return js(this,e)&&(n=vy(n)),n},callback(n,r){const i=js(this,e);t.prepareBorder(r,e,i)}}}function $fe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(rM);return js(this,"top")&&(e=vy(e)),e},callback(e,n){const r=js(this,"top");t.prepareBorder(n,"top",r)}}}function Lfe(t,e){Ffe(t,e),e.add(t)}function Ffe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vfe(t,e,n){return(e=Bfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bfe(t){var e=Wfe(t,"string");return typeof e=="symbol"?e:e+""}function Wfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function c1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gp="customBorders",jfe=90;var Ob=new WeakSet;class Ufe extends qe{constructor(){super(...arguments),Lfe(this,Ob),Vfe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Gp}static get PLUGIN_PRIORITY(){return jfe}isEnabled(){return!!this.hot.getSettings()[Gp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>c1(Ob,this,zfe).call(this,e)),this.addHook("init",()=>c1(Ob,this,Yfe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=xb(n));const o=th(e),s=$f(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});_(e,a=>{s(a).forAll((l,u)=>{_(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Afe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=th(e),r=$f(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return _(e,o=>{r(o).forAll((s,a)=>{_(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(pd(l))})})}),i}clearBorders(e){e?this.setBorders(e):(_(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Ib(e,n);r&&(a=Pfe(a,r),_(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",pd(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=Ib(o,s);let l=0;o===e.from.row&&ln(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&ln(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&ln(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&ln(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",pd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=SF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Ib(e,n):o=xb(o),i?(o[r]=Ns(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",pd(o)))):(o[r]=Ud(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",pd(o)))}prepareBorder(e,n,r){_(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){_(e,n=>{const r=xb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Sn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){_(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){_(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):_(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return _(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return _(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):_(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);_(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Gp];if(Array.isArray(e)){const n=Qn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=xfe(e),r=Ife(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function zfe(t){this.hot.getSettings()[Gp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(nM)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[$fe(this),kfe(this),Hfe(this),Nfe(this),Dfe(this)]}})}function Yfe(){this.changeBorderSettings()}function Gfe(t,e){Kfe(t,e),e.add(t)}function Kfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ab(t,e,n){return(e=qfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qfe(t){var e=Xfe(t,"string");return typeof e=="symbol"?e:e+""}function Xfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const d1="dragToScroll",Jfe=100;var Hb=new WeakSet;class Zfe extends qe{constructor(){super(...arguments),Gfe(this,Hb),Ab(this,"boundaries",null),Ab(this,"callback",null),Ab(this,"listening",!1)}static get PLUGIN_KEY(){return d1}static get PLUGIN_PRIORITY(){return Jfe}isEnabled(){return!!this.hot.getSettings()[d1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>h1(Hb,this,f1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>h1(Hb,this,f1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=cu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function f1(t){if(Ua(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Qfe(t,e){RF(t,e),e.add(t)}function ege(t,e,n){RF(t,e),e.set(t,n)}function RF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nb(t,e,n){return(e=tge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tge(t){var e=nge(t,"string");return typeof e=="symbol"?e:e+""}function nge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rge(t,e){return t.get(gi(t,e))}function EF(t,e,n){return t.set(gi(t,e),n),n}function gi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterDropdownMenuDefaultOptions");oe.getSingleton().register("beforeDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuHide");oe.getSingleton().register("afterDropdownMenuExecute");const Kp="dropdownMenu",ige=230,Vf="changeType",Db=Kp;var yy=new WeakMap,Ui=new WeakSet;class Cy extends qe{static get PLUGIN_KEY(){return Kp}static get PLUGIN_PRIORITY(){return ige}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[_g,Pg,Le,Ig,Le,cy,Le,xg,Le,fi]}constructor(e){super(e),Qfe(this,Ui),Nb(this,"commandExecutor",new hF(this.hot)),Nb(this,"itemsFactory",null),Nb(this,"menu",null),ege(this,yy,!1),this.hot.addHook("afterGetColHeader",(n,r)=>gi(Ui,this,sge).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Kp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new dF(this.hot,Cy.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gi(Ui,e,dge).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gi(Ui,e,hge).call(e,...o)});const n=this.hot.getSettings()[Kp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Rh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>gi(Ui,this,age).call(this)),this.menu.addLocalHook("afterOpen",()=>gi(Ui,this,lge).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>gi(Ui,this,uge).call(this,o)),this.menu.addLocalHook("afterClose",()=>gi(Ui,this,cge).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),_(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=uy(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Vf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Db},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Db}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Db)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>gi(Ui,this,oge).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function TF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function oge(t){if(ve(t.target,Vf)){const e=uy(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),EF(yy,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function sge(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Vf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Vf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(be(s,[Pu(),xf(" ")]),be(e,[bk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function age(){this.hot.runHooks("beforeDropdownMenuShow",this)}function lge(){this.hot.runHooks("afterDropdownMenuShow",this),gi(Ui,this,TF).call(this,this.menu)}function uge(t){gi(Ui,this,TF).call(this,t)}function cge(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function hge(t){return rge(yy,this)?null:t}function dge(t){ve(t.target,Vf)&&EF(yy,this,!0)}Cy.SEPARATOR={name:Le};function g1(t,e,n){return(e=fge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fge(t){var e=gge(t,"string");return typeof e=="symbol"?e:e+""}function gge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mge{constructor(e){g1(this,"hot",void 0),g1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function m1(t,e,n){return(e=pge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pge(t){var e=wge(t,"string");return typeof e=="symbol"?e:e+""}function wge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){m1(this,"dataProvider",void 0),m1(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=oo(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=cn(oo(C_.DEFAULT_OPTIONS),n),n=cn(n,e),n.filename=_E(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function vge(t,e){yge(t,e),e.add(t)}function yge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const MF="\r",Cge='"',bge=`
`,Sge="=",Rge="+",Ege="-",Tge="@",Mge="	";var kb=new WeakSet;class _ge extends C_{constructor(){super(...arguments),vge(this,kb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Ue(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),_(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Tt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=p1(kb,this,xge).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=p1(kb,this,Pge).call(this,i)),(n||i.indexOf(MF)>=0||i.indexOf(Cge)>=0||i.indexOf(bge)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Pge(t){return t.startsWith(Sge)||t.startsWith(Rge)||t.startsWith(Ege)||t.startsWith(Tge)||t.startsWith(Mge)||t.startsWith(MF)?`'${t}`:t}function xge(t,e){return e.test(t)?`'${t}`:t}const Ige="csv",QR={[Ige]:_ge};function Oge(t,e,n){return typeof QR[t]=="function"?new QR[t](e,n):null}const Age="exportFile",Hge=240;class Nge extends qe{static get PLUGIN_KEY(){return Age}static get PLUGIN_PRIORITY(){return Hge}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!QR[e])throw new Error(`Export format type "${e}" is not supported.`);return Oge(e,new mge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function sc(t,e,n){return(e=Dge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dge(t){var e=kge(t,"string");return typeof e=="symbol"?e:e+""}function kge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Og{constructor(e,n){let{id:r,stateless:i=!0}=n;sc(this,"hot",void 0),sc(this,"id",void 0),sc(this,"elements",[]),sc(this,"hidden",!1),sc(this,"stateId",""),sc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Qv)}getElements(){return this.elements}reset(){_(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),_(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mt(Og,Fn);const Bf={};function za(t,e){if(!Bf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Bf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Zl(t){if(!Bf[t])throw Error(`Filter condition "${t}" does not exist.`);return Bf[t].descriptor}function fn(t,e,n){n.key=t,Bf[t]={condition:e,descriptor:n}}const An="none";function $ge(){return!0}fn(An,$ge,{name:ey,inputsCount:0,showOperators:!1});const rf="empty";function Lge(t){return Yt(t.value)}fn(rf,Lge,{name:gM,inputsCount:0,showOperators:!0});const qp="not_empty";function Fge(t,e){return!za(rf,e)(t)}fn(qp,Fge,{name:mM,inputsCount:0,showOperators:!0});const of="eq";function Vge(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale)===Tt(n)}fn(of,Vge,{name:pM,inputsCount:1,showOperators:!0});const Xp="neq";function Bge(t,e){return!za(of,e)(t)}fn(Xp,Bge,{name:wM,inputsCount:1,showOperators:!0});const _F="gt";function Wge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}fn(_F,Wge,{name:SM,inputsCount:1,showOperators:!0});const PF="gte";function jge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}fn(PF,jge,{name:RM,inputsCount:1,showOperators:!0});const xF="lt";function Uge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}fn(xF,Uge,{name:EM,inputsCount:1,showOperators:!0});const IF="lte";function zge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}fn(IF,zge,{name:TM,inputsCount:1,showOperators:!0});const b_="date_after";function Yge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}fn(b_,Yge,{name:PM,inputsCount:1,showOperators:!0});const S_="date_before";function Gge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}fn(S_,Gge,{name:xM,inputsCount:1,showOperators:!0});const Yw="between";function Kge(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=za(S_,[o]),a=za(b_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}fn(Yw,Kge,{name:MM,inputsCount:2,showOperators:!0});const OF="not_between";function qge(t,e){return!za(Yw,e)(t)}fn(OF,qge,{name:_M,inputsCount:2,showOperators:!0});const AF="begins_with";function Xge(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Tt(n))}fn(AF,Xge,{name:vM,inputsCount:1,showOperators:!0});const HF="ends_with";function Jge(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Tt(n))}fn(HF,Jge,{name:yM,inputsCount:1,showOperators:!0});const R_="contains";function Zge(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Tt(n))>=0}fn(R_,Zge,{name:CM,inputsCount:1,showOperators:!0});const NF="not_contains";function Qge(t,e){return!za(R_,e)(t)}fn(NF,Qge,{name:bM,inputsCount:1,showOperators:!0});const DF="date_tomorrow";function eme(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}fn(DF,eme,{name:OM,inputsCount:0});const kF="date_today";function tme(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}fn(kF,tme,{name:IM,inputsCount:0});const $F="date_yesterday";function nme(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}fn($F,nme,{name:AM,inputsCount:0});Gk();function rme(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Ag(t){const e=new Set(t);return function(n){return e.has(n)}}function E_(t){return t??""}function e0(t){return Array.from(new Set(t)).map(e=>E_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function w1(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Ag(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:rme(a,n)};r&&r(u),i.push(u)}),i}const Ql="by_value";function ime(t,e){let[n]=e;return n(t.value)}fn(Ql,ime,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Ag(e)]},showOperators:!1});const Wf={};function ome(t){if(!Wf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Wf[t].func;return function(n,r){return e(n,r)}}function sme(t){return Wf[t].name}function T_(t,e,n){Wf[t]={name:e,func:n}}const Fa="conjunction",ame=DM;function lme(t,e){return t.every(n=>n.func(e))}T_(Fa,ame,lme);const Gw="disjunction",ume=ty;function cme(t,e){return t.some(n=>n.func(e))}T_(Gw,ume,cme);const M_="disjunctionWithExtraCondition",hme=ty;function dme(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}T_(M_,hme,dme);const fme="numeric",LF="text",gme="date",v1={[fme]:[An,Le,rf,qp,Le,of,Xp,Le,_F,PF,xF,IF,Yw,OF],[LF]:[An,Le,rf,qp,Le,of,Xp,Le,AF,HF,Le,R_,NF],[gme]:[An,Le,rf,qp,Le,of,Xp,Le,S_,b_,Yw,Le,DF,kF,$F]};function mme(t){const e=[];let n=t;return v1[n]||(n=LF),_(v1[n],r=>{let i;r===Le?i={name:Le}:i=oo(Zl(r)),e.push(i)}),e}function wd(t,e,n){return(e=pme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pme(t){var e=wme(t,"string");return typeof e=="symbol"?e:e+""}function wme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $b="built",Lb="building",y1=["click","input","keydown","keypress","keyup","focus","blur","change"];let no=class FF{static get DEFAULTS(){return oo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){wd(this,"hot",void 0),wd(this,"eventManager",new Ei(this)),wd(this,"options",void 0),wd(this,"_element",void 0),wd(this,"buildState",void 0),this.hot=e,this.options=cn(FF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Lb?this._element:this.buildState===$b?(this.update(),this._element):(this.buildState=Lb,this.build(),this.buildState=$b,this._element)}isBuilt(){return this.buildState===$b}translateIfPossible(e){return typeof e=="string"&&e.startsWith(gr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Lb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)_(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),ke(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),_(y1,r=>e(n,r))}else _(y1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mt(no,Fn);function vme(t,e){VF(t,e),e.add(t)}function yme(t,e,n){VF(t,e),e.set(t,n)}function VF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jm(t,e){return t.get(__(t,e))}function Cme(t,e,n){return t.set(__(t,e),n),n}function __(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ac=new WeakMap,C1=new WeakSet;class Va extends no{static get DEFAULTS(){return oo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,cn(Va.DEFAULTS,n)),vme(this,C1),yme(this,ac,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>__(C1,this,bme).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Cme(ac,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(jm(ac,this).type=this.options.type,jm(ac,this).placeholder=this.translateIfPossible(this.options.placeholder),jm(ac,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&jm(ac,this).focus()}}function bme(t){this.options.value=t.target.value}function Sme(t,e){BF(t,e),e.add(t)}function vd(t,e,n){BF(t,e),e.set(t,n)}function BF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lc(t,e,n){return t.set(sf(t,e),n),n}function Ft(t,e){return t.get(sf(t,e))}function sf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rn=new WeakMap,Um=new WeakMap,zm=new WeakMap,Fb=new WeakMap,Ym=new WeakMap,Gm=new WeakSet;class jf extends no{static get DEFAULTS(){return oo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,cn(jf.DEFAULTS,n)),Sme(this,Gm),vd(this,Rn,null),vd(this,Um,[]),vd(this,zm,void 0),vd(this,Fb,void 0),vd(this,Ym,void 0),this.registerHooks()}getMenu(){return Ft(Rn,this)}registerHooks(){this.addLocalHook("click",()=>sf(Gm,this,Tme).call(this))}setItems(e){lc(Um,this,this.translateNames(e)),Ft(Rn,this)&&Ft(Rn,this).setMenuItems(Ft(Um,this))}translateNames(e){return _(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),lc(Rn,this,new Rh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ft(Rn,this).setMenuItems(Ft(Um,this));const e=new no(this.hot,{className:"htUISelectCaption"}),n=new no(this.hot,{className:"htUISelectDropdown"});lc(zm,this,e),lc(Fb,this,e.element),lc(Ym,this,n),this.hot.getSettings().ariaTags&&(be(n.element,[Pu()]),be(this._element,[Ck()])),_([e,n],r=>this._element.appendChild(r.element)),Ft(Rn,this).addLocalHook("select",r=>sf(Gm,this,Rme).call(this,r)),Ft(Rn,this).addLocalHook("afterClose",()=>sf(Gm,this,Eme).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ft(Rn,this).hot.getTranslatedPhrase(ey),Ft(Fb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ft(Rn,this)&&(Ft(Rn,this).open(),Ft(Rn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ft(Rn,this).getNavigator().toFirstItem(),Ft(Rn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ft(Rn,this)&&Ft(Rn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ft(Rn,this)&&(Ft(Rn,this).destroy(),lc(Rn,this,null)),Ft(zm,this)&&Ft(zm,this).destroy(),Ft(Ym,this)&&Ft(Ym,this).destroy(),super.destroy()}}function Rme(t){t.name!==Le&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Eme(){this.runLocalHooks("afterClose")}function Tme(){this.openOptions()}function Mme(t,e){_me(t,e),e.add(t)}function _me(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b1(t,e,n){return(e=Pme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pme(t){var e=xme(t,"string");return typeof e=="symbol"?e:e+""}function xme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vb=new WeakSet;class t0 extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),Mme(this,Vb),b1(this,"name",""),b1(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new jf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Va(this.hot,{placeholder:BM})),this.elements.push(new Va(this.hot,{placeholder:WM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>S1(Vb,this,Ime).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),_(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>S1(Vb,this,Ome).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=oo(e.command);n.name.startsWith(Gt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),_(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Zl(An),n=[];return _(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Zl(e?e.name:An);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||_(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof jf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Va)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Zl(An)];if(e!==null){const{visualIndex:r}=e;n=mme(this.hot.getDataType(0,r,this.hot.countRows(),r))}_(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Ime(t){_(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Ome(t){vh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ii(t))}function R1(t,e,n){Ame(t,e),e.set(t,n)}function Ame(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yd(t,e){return t.get(WF(t,e))}function E1(t,e,n){return t.set(WF(t,e),n),n}function WF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uc=new WeakMap,Bb=new WeakMap;class Kw extends no{static get DEFAULTS(){return oo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,cn(Kw.DEFAULTS,n)),R1(this,uc,void 0),R1(this,Bb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),E1(Bb,this,e),E1(uc,this,this._element.firstChild),yd(uc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(yd(Bb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?yd(uc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(yd(uc,this).checked=e)}focus(){this.isBuilt()&&yd(uc,this).focus()}}function Hme(t,e){Nme(t,e),e.add(t)}function Nme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dme(t,e,n){return(e=kme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kme(t){var e=$me(t,"string");return typeof e=="symbol"?e:e+""}function $me(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const T1=0;var M1=new WeakSet;class Fme extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),Hme(this,M1),Dme(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),_(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Fa,Gw];_(e,n=>{const r=new Kw(this.hot,{name:"operator",label:{htmlFor:n,textContent:sme(n)},value:n,checked:n===e[T1],id:n});r.addLocalHook("change",i=>Lme(M1,this,Vme).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ht`Radio button with index ${e} doesn't exist.`);_(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Kw&&n.isChecked());return e?e.getValue():Fa}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&_(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fa,n=arguments.length>1?arguments[1]:void 0,r=e;r===M_&&(r=Gw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(T1)}}function Vme(t){this.setState(t.target.value)}function Bme(t,e,n){Wme(t,e),e.set(t,n)}function Wme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wb(t,e){return t.get(jF(t,e))}function jme(t,e,n){return t.set(jF(t,e),n),n}function jF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cd=new WeakMap;class Uf extends no{static get DEFAULTS(){return oo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,cn(Uf.DEFAULTS,n)),Bme(this,Cd,void 0)}build(){super.build(),jme(Cd,this,this._element.firstChild)}update(){this.isBuilt()&&(Wb(Cd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Wb(Cd,this).focus()}activate(){Wb(Cd,this).click()}}function Ume(t,e){UF(t,e),e.add(t)}function cc(t,e,n){UF(t,e),e.set(t,n)}function UF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(Nc(t,e))}function $i(t,e,n){return t.set(Nc(t,e),n),n}function Nc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _1="multipleSelect.itemBox";var zi=new WeakMap,Xt=new WeakMap,jb=new WeakMap,ms=new WeakMap,aa=new WeakMap,la=new WeakMap,bd=new WeakSet;class zf extends no{static get DEFAULTS(){return oo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,cn(zf.DEFAULTS,n)),Ume(this,bd),cc(this,zi,[]),cc(this,Xt,void 0),cc(this,jb,void 0),cc(this,ms,void 0),cc(this,aa,void 0),cc(this,la,void 0),$i(ms,this,new Va(this.hot,{placeholder:VM,className:"htUIMultipleSelectSearch"})),$i(aa,this,new Uf(this.hot,{textContent:kM,className:"htUISelectAll"})),$i(la,this,new Uf(this.hot,{textContent:$M,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return xe(Xt,this)}registerHooks(){xe(ms,this).addLocalHook("keydown",e=>Nc(bd,this,Yme).call(this,e)),xe(ms,this).addLocalHook("input",e=>Nc(bd,this,zme).call(this,e)),xe(aa,this).addLocalHook("click",e=>Nc(bd,this,Gme).call(this,e)),xe(la,this).addLocalHook("click",e=>Nc(bd,this,Kme).call(this,e))}setItems(e){var n;$i(zi,this,e),(n=xe(Xt,this))===null||n===void 0||n.loadData(xe(zi,this))}setLocale(e){$i(jb,this,e)}getLocale(){return xe(jb,this)}getItems(){return[...xe(zi,this)]}getValue(){return Xme(xe(zi,this))}getSearchInputElement(){return xe(ms,this)}getSelectAllElement(){return xe(aa,this)}getClearAllElement(){return xe(la,this)}isSelectedAllValues(){return xe(zi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new no(this.hot,{className:"htUISelectionControls",children:[xe(aa,this),xe(la,this)]});this._element.appendChild(xe(ms,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=xe(Xt,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),$i(Xt,this,new this.hot.constructor(o,{data:xe(zi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{xe(Xt,this).listen()},modifyColWidth:u=>{const c=xe(Xt,this).container.scrollWidth-_n(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),xe(Xt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||xe(Xt,this).useTheme(u)});const l=xe(Xt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:_1}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{xe(Xt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:_1})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&xe(Xt,this).listen()}reset(){xe(ms,this).reset(),xe(aa,this).reset(),xe(la,this).reset()}update(){this.isBuilt()&&(xe(Xt,this).loadData(qme(xe(zi,this),this.options.value)),super.update())}destroy(){var e;(e=xe(Xt,this))===null||e===void 0||e.destroy(),xe(ms,this).destroy(),xe(la,this).destroy(),xe(aa,this).destroy(),$i(ms,this,null),$i(la,this,null),$i(aa,this,null),$i(Xt,this,null),$i(zi,this,null),super.destroy()}}function zme(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...xe(zi,this)]:n=xe(zi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),xe(Xt,this).loadData(n)}function Yme(t){this.runLocalHooks("keydown",t,this),VE(vh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ii(t),xe(Xt,this).listen(),xe(Xt,this).selectCell(0,0))}function Gme(t){const e=[];t.preventDefault(),xe(Xt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(wT(n,r)[0])}),xe(Xt,this).setSourceDataAtCell(e)}function Kme(t){const e=[];t.preventDefault(),xe(Xt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(wT(n,r)[0])}),xe(Xt,this).setSourceDataAtCell(e)}function qme(t,e){const n=Ag(e);return t.map(r=>(r.checked=n(r.value),r))}function Xme(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Jme(t,e){Zme(t,e),e.add(t)}function Zme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qme(t,e,n){return(e=epe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function epe(t){var e=tpe(t,"string");return typeof e=="symbol"?e:e+""}function tpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Km(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sd=new WeakSet;class npe extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),Jme(this,Sd),Qme(this,"name",""),this.name=n.name,this.elements.push(new zf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Km(Sd,this,rpe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Km(Sd,this,ipe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ql){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?An:Ql},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Ba(i,h=>h.name===Ql),u={},c=this.hot.getTranslatedPhrase(Aw);if(l){const h=s(r,a),d=Ue(h,C=>C.value),f=new Map(h.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),g=e0(d);o&&(l.args[0]=o);const v=[],y=w1(g,l.args[0],c,C=>{C.checked&&v.push(C.value),Km(Sd,this,P1).call(this,C,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[v],u.command=Zl(Ql),u.itemsSnapshot=y}else u.args=[],u.command=Zl(An);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof zf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Aw),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=e0(r),s=w1(o,o,e,l=>{Km(Sd,this,P1).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:E_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function rpe(t){vh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ii(t))}function P1(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function ipe(t,e){switch(e.type){case"numeric":return AL(t,e);default:return t}}var zF;function ope(t,e){spe(t,e),e.add(t)}function spe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ape(t,e,n){return(e=lpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lpe(t){var e=upe(t,"string");return typeof e=="symbol"?e:e+""}function upe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cpe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var x1=new WeakSet;class Yf extends Og{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),ope(this,x1),ape(this,"name",""),this.name=n.name,this.elements.push(new Va(this.hot,{type:"button",value:LM,className:"htUIButton htUIButtonOK",identifier:Yf.BUTTON_OK})),this.elements.push(new Va(this.hot,{type:"button",value:FM,className:"htUIButton htUIButtonCancel",identifier:Yf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){_(this.elements,e=>{e.addLocalHook("click",(n,r)=>cpe(x1,this,hpe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),_(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}zF=Yf;function hpe(t,e){e.options.identifier===zF.BUTTON_OK?this.accept():this.cancel()}function Ub(t,e,n){return(e=dpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dpe(t){var e=fpe(t,"string");return typeof e=="symbol"?e:e+""}function fpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const I1="ConditionCollection.filteringStates";class P_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Ub(this,"hot",void 0),Ub(this,"isMapRegistrable",void 0),Ub(this,"filteringStates",new Qv),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(I1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fa;return e.length?ome(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fa,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ht`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ht(Wf[r]))throw new Error(ht`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:za(a,s)}]},i):u.push({name:a,args:s,func:za(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(I1),this.filteringStates=null,this.clearLocalHooks()}}mt(P_,Fn);function O1(t,e,n){return(e=gpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gpe(t){var e=mpe(t,"string");return typeof e=="symbol"?e:e+""}function mpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];O1(this,"conditionCollection",void 0),O1(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return _(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return _(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return _(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function ppe(t,e){wpe(t,e),e.add(t)}function wpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sl(t,e,n){return(e=vpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vpe(t){var e=ype(t,"string");return typeof e=="symbol"?e:e+""}function ype(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qm=new WeakSet;class GF{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];ppe(this,qm),Sl(this,"hot",void 0),Sl(this,"conditionCollection",void 0),Sl(this,"columnDataFactory",void 0),Sl(this,"changes",[]),Sl(this,"grouping",!1),Sl(this,"latestEditedColumnPosition",-1),Sl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>zb(qm,this,Cpe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>zb(qm,this,bpe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>zb(qm,this,Spe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,_(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=Fk(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new P_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const v=r.columnDataFactory(h);let y;f.isEmpty()?y=v:y=new YF(f,C=>r.columnDataFactory(C)).filter(),y=Ue(y,C=>C.meta.visualRow);const E=Ag(y);return f.destroy(),Ba(v,C=>E(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),ke(this,(e,n)=>{this[n]=null})}}function Cpe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function bpe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Spe(){_(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}mt(GF,Fn);function Rpe(t){return gF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof zf)return r;if(i.element&&!hu(i.element))return!1;i.focus()}})}const Rd="filters";function Epe(t,e){let n=-1,r;const i=Rpe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Rd),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof no&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Rd),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Rd)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const v=r.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const v=e[i.getCurrentPage()];v instanceof jf&&(v.openOptions(),g.preventDefault()),v instanceof Uf&&(v.activate(),g.preventDefault()),v instanceof no||g.preventDefault()}}],Rd)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Rd)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Tpe(t,e){KF(t,e),e.add(t)}function Yb(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ed(t,e,n){return(e=Mpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mpe(t){var e=_pe(t,"string");return typeof e=="symbol"?e:e+""}function _pe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jp(t,e,n){return t.set(Er(t,e),n),n}function mi(t,e){return t.get(Er(t,e))}function Er(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const n0="filters",Ppe=250,A1=n0;var bs=new WeakMap,r0=new WeakMap,Kl=new WeakMap,$r=new WeakSet;class xpe extends qe{static get PLUGIN_KEY(){return n0}static get PLUGIN_PRIORITY(){return Ppe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Tpe(this,$r),Ed(this,"dropdownMenuPlugin",null),Ed(this,"conditionCollection",null),Ed(this,"conditionUpdateObserver",null),Ed(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Ed(this,"filtersRowsMap",null),Yb(this,bs,void 0),Yb(this,r0,new WeakSet),Yb(this,Kl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Er($r,n,kpe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[n0]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Sg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>Er($r,this,H1).call(this,"accept")),a.addLocalHook("cancel",()=>Er($r,this,H1).call(this,"cancel")),a.addLocalHook("change",l=>Er($r,this,Dpe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(HM)}:`,s=()=>`${this.hot.getTranslatedPhrase(NM)}:`;if(!this.components.get("filter_by_condition")){const a=new t0(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Er($r,this,N1).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Fme(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new t0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Er($r,this,N1).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new npe(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Yf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new P_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new GF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Er($r,this,$pe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Er($r,e,Npe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Er($r,this,Hpe).call(this)),this.addHook("afterDropdownMenuShow",()=>Er($r,this,Ope).call(this)),this.addHook("afterDropdownMenuHide",()=>Er($r,this,Ape).call(this)),this.addHook("afterChange",a=>Er($r,this,Ipe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!mi(bs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=mi(bs,this).getMenu(),c=u.getNavigator(),h=mi(bs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Jp(bs,this,Epe(this.dropdownMenuPlugin.menu,a));const l=u=>{mi(bs,this).listen(),u.preventDefault(),vh(u.keyCode,"TAB")&&(u.shiftKey?mi(bs,this).toPreviousItem():mi(bs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:A1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(A1)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Fa;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,mi(Kl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=Ag(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),_(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Jp(Kl,this,this.exportConditions())}else s!==!1&&!r?(Jp(Kl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(mi(Kl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return _(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:E_(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=e0(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Gw&&n.command.key!==An&&r.command.key!==An&&i.command.key!==An?o=M_:i.command.key!==An&&(n.command.key===An||r.command.key===An)&&(o=Fa),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new YF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _(i,s=>{_(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Ipe(t){t&&_(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Ope(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Ape(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Hpe(){const t=this.dropdownMenuPlugin.menu;mi(r0,this).has(t)||mi(bs,this).setMenu(t),mi(r0,this).add(t)}function Npe(t){t.items.push({name:Le}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function H1(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==An&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==An&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==An&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Dpe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===t0&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function N1(){this.setListeningDropdownMenu()}function kpe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):we(e,"htFiltersActive")}function $pe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Jp(Kl,this,mi(Kl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Ql),s=n.filter(a=>a.name!==Ql);if(o.length>=2||s.length>=3)nt(ht`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const qF="internal-use-in-handsontable",i0={licenseKey:qF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function XF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Kn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function JF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Lpe(t){var e;const n=t[Kn],r=JF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=XF(t);return{...i0,...r,...i}}function Fpe(t){var e;const n=t[Kn],r=JF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=XF(t);return{...r,...i}}function Vpe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function by(){const t="engine_relationship",e=lo(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function x_(){const t="shared_engine_usage",e=lo(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Bpe(t){const e=t.getSettings(),n=e[Kn],r=n==null?void 0:n.engine;if(n===!0||Ht(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Wpe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ht(r.hyperformula)){const o=by(),s=x_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:qF}),(r.getConfig().leapYear1900!==i0.leapYear1900||Uv(r.getConfig().nullDate,i0.nullDate)===!1)&&nt(ht`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Wpe(t,e,n){const r=e[Kn],i=Lpe(e),o=by(),s=x_();jpe(t,r.functions),Upe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),zpe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function D1(t){var e;const n=by(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function k1(t,e){if(t){const n=by(),r=n.get(t),i=x_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function jpe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){nt(s.message)}})}function Upe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){nt(r.message)}}}function zpe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){nt(a.message)}}),t.resumeEvaluation())}function Ype(t,e){return(Ht(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const ZF="DD/MM/YYYY";function Gpe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Kpe(t){return Gpe(t)?t.substr(1):t}function qpe(t){return typeof t=="string"&&t.startsWith("=")}function I_(t,e){return typeof t=="string"&&e==="date"}function QF(t,e){return Z(t,e,!0).isValid()}function eV(t,e){return Z(t,e,!0).format(ZF)}function Xpe(t,e){return Z(t,ZF,!0).format(e)}function tV(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function Jpe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Zpe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Qpe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function O_(t,e,n){const r=Zpe(t,Jpe(t,e,n));return Qpe(r)}function Rl(t,e,n){ewe(t,e),e.set(t,n)}function ewe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e){return t.get(nV(t,e))}function ua(t,e,n){return t.set(nV(t,e),n),n}function nV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Td=new WeakMap,ca=new WeakMap,Lr=new WeakMap,Xm=new WeakMap,Gb=new WeakMap,Kb=new WeakMap,Jm=new WeakMap;class $1{constructor(e,n,r){Rl(this,Td,void 0),Rl(this,ca,void 0),Rl(this,Lr,void 0),Rl(this,Xm,[]),Rl(this,Gb,[]),Rl(this,Kb,void 0),Rl(this,Jm,[]),ua(Td,this,e),ua(ca,this,n),ua(Lr,this,r)}setRemovedHfIndexes(e){return ua(Jm,this,e.map(n=>{const r=Ot(ca,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Ot(Jm,this)}getRemovedHfIndexes(){return Ot(Jm,this)}getHfIndexFromVisualIndex(e){const n=Ot(ca,this).getIndexesSequence(),r=Ot(ca,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Zn(Ot(Td,this))}s`;Ot(Lr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Ot(Lr,this).getEngine()[r](Ot(Lr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ua(Gb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),ua(Kb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Ot(Lr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=O_(Ot(Gb,this),Ot(Kb,this),Ot(ca,this).getNumberOfIndexes());Ot(Lr,this).getSheetId()===null?Ot(Lr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Zn(Ot(Td,this))}Order`;return n=>{if(Ot(Lr,this).isPerformingUndoRedo())return;const r=Ot(ca,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Ot(Xm,this).map(l=>r.indexOf(l)),o=Ot(Lr,this).getEngine().getSheetDimensions(Ot(Lr,this).getSheetId());let s;Ot(Td,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Ot(Lr,this).getEngine()[e](Ot(Lr,this).getSheetId(),i)}ua(Xm,this,r)}}init(){ua(Xm,this,Ot(ca,this).getIndexesSequence())}}function El(t,e,n){twe(t,e),e.set(t,n)}function twe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ps(t,e){return t.get(rV(t,e))}function Tl(t,e,n){return t.set(rV(t,e),n),n}function rV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zm=new WeakMap,Qm=new WeakMap,qb=new WeakMap,Xb=new WeakMap,Jb=new WeakMap,Zb=new WeakMap,Qb=new WeakMap;class nwe{constructor(e,n,r){El(this,Zm,void 0),El(this,Qm,void 0),El(this,qb,void 0),El(this,Xb,!1),El(this,Jb,!1),El(this,Zb,null),El(this,Qb,null),Tl(Zm,this,new $1("row",e,this)),Tl(Qm,this,new $1("column",n,this)),Tl(qb,this,r)}getForAxis(e){return e==="row"?ps(Zm,this):ps(Qm,this)}setPerformUndo(e){Tl(Xb,this,e)}setPerformRedo(e){Tl(Jb,this,e)}isPerformingUndoRedo(){return ps(Xb,this)||ps(Jb,this)}getSheetId(){return ps(Qb,this)}getEngine(){return ps(Zb,this)}getPostponeAction(){return ps(qb,this)}setupSyncEndpoint(e,n){Tl(Zb,this,e),Tl(Qb,this,n),ps(Zm,this).init(),ps(Qm,this).init()}}function rwe(t,e){iV(t,e),e.add(t)}function Ml(t,e,n){return(e=iwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iwe(t){var e=owe(t,"string");return typeof e=="symbol"?e:e+""}function owe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eS(t,e,n){iV(t,e),e.set(t,n)}function iV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ya(t,e,n){return t.set(Xe(t,e),n),n}function iu(t,e){return t.get(Xe(t,e))}function Xe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Kn="formulas",swe=["maxRows","maxColumns","language"],awe=260;oe.getSingleton().register("afterNamedExpressionAdded");oe.getSingleton().register("afterNamedExpressionRemoved");oe.getSingleton().register("afterSheetAdded");oe.getSingleton().register("afterSheetRemoved");oe.getSingleton().register("afterSheetRenamed");oe.getSingleton().register("afterFormulasValuesUpdate");const Eh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Us=new WeakMap,Sy=new WeakMap,Md=new WeakMap,Qe=new WeakSet;class lwe extends qe{constructor(){var e;super(...arguments),e=this,rwe(this,Qe),eS(this,Us,!1),eS(this,Sy,!1),eS(this,Md,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,Ewe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,Twe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,Mwe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,_we).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,Pwe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,xwe).call(e,...r)}]]),Ml(this,"staticRegister",lo("formulas")),Ml(this,"engine",null),Ml(this,"sheetId",null),Ml(this,"sheetName",null),Ml(this,"indexSyncer",null),Ml(this,"rowAxisSyncer",null),Ml(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Kn}static get PLUGIN_PRIORITY(){return awe}static get SETTING_KEYS(){return[Kn,...swe]}isEnabled(){return!!this.hot.getSettings()[Kn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Bpe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){nt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Xe(Qe,this,af).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,L1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,F1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,L1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,F1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,dwe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,fwe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,uwe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,gwe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,V1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,V1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,mwe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,pwe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,ywe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Cwe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,wwe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,vwe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,bwe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Swe).call(n,...i)}),this.indexSyncer=new nwe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,hwe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Rwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,cwe).call(n,...i)}),iu(Md,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){iu(Md,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),k1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Fpe(this.hot.getSettings());Vpe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Kn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Kn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Xe(Qe,this,af).call(this,o)}}super.updatePlugin(e)}destroy(){iu(Md,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ya(Md,this,null),k1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!L$(n))return nt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return nt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return nt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){YE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Xe(Qe,this,af).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Zn(Kn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),D1(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=D1(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){nt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return I_(r,o.type)&&(QF(r,o.dateFormat)?r=eV(r,o.dateFormat):qpe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function af(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function uwe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Gn(s)&&(s=tV(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function cwe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:v}=h.start,{row:y,col:E}=h.end,C=y-g+1,M=E-v+1;for(let x=0;x<f.length;x+=1)for(let P=0;P<f[x].length;P+=1){const T=f[x][P],O=g+x%C,G=v+P%M,U=this.hot.getCellMeta(O,G);I_(T,U.type)&&(T.startsWith("'")?f[x][P]=T.slice(1):this.isFormulaCellType(O,G,this.sheetId)===!1&&(f[x][P]=Xpe(T,U.dateFormat)))}return f}function L1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Zn(Kn))||Ya(Sy,this,Ht(this.hot.getSettings().data))}function hwe(){if(iu(Sy,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;I_(i,s.type)&&(QF(i,a)?t[r][o]=eV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Ya(Us,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ya(Us,this,!1)}function F1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Zn(Kn)))return;const r=Ype(this.engine,this.hot.getSettings()[Kn].sheetName);if(Xe(Qe,this,af).call(this,r),n!=="updateSettings")if(iu(Sy,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Ya(Us,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Ya(Us,this,!1)}}}function dwe(t,e,n,r){if(r!=="get"||iu(Us,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=Kpe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Gn(a)&&(a=tV(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function fwe(t,e,n,r){if(r!=="get"||iu(Us,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function V1(t,e){if(Eh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function gwe(t,e){if(Eh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Gn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){nt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function mwe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function pwe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function wwe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function vwe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function ywe(t,e,n){if(Eh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Cwe(t,e,n){if(Eh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function bwe(t,e,n,r){if(Eh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Swe(t,e,n,r){if(Eh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Rwe(t,e,n){var r;Ya(Us,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ya(Us,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Ewe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Twe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Mwe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function _we(t){this.hot.runHooks("afterSheetAdded",t)}function Pwe(t,e){Xe(Qe,this,af).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function xwe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Iwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(cM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Owe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(hM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return _(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Awe(t,e){oV(t,e),e.add(t)}function Hwe(t,e,n){oV(t,e),e.set(t,n)}function oV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e){return t.get(va(t,e))}function B1(t,e,n){return t.set(va(t,e),n),n}function va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideColumns");oe.getSingleton().register("afterHideColumns");oe.getSingleton().register("beforeUnhideColumns");oe.getSingleton().register("afterUnhideColumns");const W1="hiddenColumns",Nwe=310;var Co=new WeakMap,Pl=new WeakSet;class Dwe extends qe{constructor(){super(...arguments),Awe(this,Pl),Hwe(this,Co,null)}static get PLUGIN_KEY(){return W1}static get PLUGIN_PRIORITY(){return Nwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[W1]}enablePlugin(){var e=this;this.enabled||(B1(Co,this,new Zv),_l(Co,this).addLocalHook("init",()=>va(Pl,this,Bwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_l(Co,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Pl,e,Vwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>va(Pl,this,$we).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>va(Pl,this,kwe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Pl,e,Fwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>va(Pl,this,Lwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=_l(Co,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));_(l,u=>{o[u]=!1}),i=Sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&_l(Co,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{_l(Co,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(_l(Co,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return _l(Co,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){B1(Co,this,null),super.destroy()}}function kwe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function $we(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Lwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return _(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Fwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function Vwe(t){t.items.push({name:Le},Iwe(this),Owe(this))}function Bwe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Wwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(dM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function jwe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(fM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return _(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Uwe(t,e){sV(t,e),e.add(t)}function zwe(t,e,n){sV(t,e),e.set(t,n)}function sV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xl(t,e){return t.get(ya(t,e))}function j1(t,e,n){return t.set(ya(t,e),n),n}function ya(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideRows");oe.getSingleton().register("afterHideRows");oe.getSingleton().register("beforeUnhideRows");oe.getSingleton().register("afterUnhideRows");const U1="hiddenRows",Ywe=320;var bo=new WeakMap,Il=new WeakSet;class Gwe extends qe{constructor(){super(...arguments),Uwe(this,Il),zwe(this,bo,null)}static get PLUGIN_KEY(){return U1}static get PLUGIN_PRIORITY(){return Ywe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[U1]}enablePlugin(){var e=this;this.enabled||(j1(bo,this,new Zv),xl(bo,this).addLocalHook("init",()=>ya(Il,this,Qwe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,xl(bo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,Zwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>ya(Il,this,qwe).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>ya(Il,this,Kwe).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,Jwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>ya(Il,this,Xwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=xl(bo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));_(l,u=>{o[u]=!1}),i=Sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&xl(bo,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{xl(bo,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(xl(bo,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return xl(bo,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){j1(bo,this,null),super.destroy()}}function Kwe(t,e){return this.isHidden(e)?0:t}function qwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Xwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return _(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Jwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function Zwe(t){t.items.push({name:Le},Wwe(this),jwe(this))}function Qwe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function eve(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(VT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function tve(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(BT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function nve(t,e){aV(t,e),e.add(t)}function rve(t,e,n){aV(t,e),e.set(t,n)}function aV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o0(t,e){return t.get(qw(t,e))}function tS(t,e,n){return t.set(qw(t,e),n),n}function qw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnFreeze");oe.getSingleton().register("afterColumnFreeze");oe.getSingleton().register("beforeColumnUnfreeze");oe.getSingleton().register("afterColumnUnfreeze");const z1="manualColumnFreeze",ive=110;var Ul=new WeakMap,nS=new WeakSet;class ove extends qe{constructor(){super(...arguments),nve(this,nS),rve(this,Ul,!1)}static get PLUGIN_KEY(){return z1}static get PLUGIN_PRIORITY(){return ive}isEnabled(){return!!this.hot.getSettings()[z1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>qw(nS,this,sve).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>qw(nS,this,ave).call(this,e,n)),super.enablePlugin())}disablePlugin(){tS(Ul,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;o0(Ul,this)||tS(Ul,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;o0(Ul,this)||tS(Ul,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function sve(t){t.items.push({name:"---------"},eve(this),tve(this))}function ave(t,e){if(o0(Ul,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function ep(t,e,n){return(e=lve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lve(t){var e=uve(t,"string");return typeof e=="symbol"?e:e+""}function uve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rS=0,Y1=1,G1=2,hc="px";let lV=class{constructor(e){ep(this,"hot",void 0),ep(this,"_element",null),ep(this,"state",rS),ep(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=G1}build(){this.state===rS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Y1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=rS}isAppended(){return this.state===G1}isBuilt(){return this.state>=Y1}setPosition(e,n){Gn(e)&&(this._element.style.top=e+hc),Gn(n)&&(this._element.style[this.inlineProperty]=n+hc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Gn(e)&&(this._element.style.width=e+hc),Gn(n)&&(this._element.style.height=n+hc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Gn(e)&&(this._element.style.marginTop=e+hc),Gn(n)&&(this._element.style[`margin${Zn(this.inlineProperty)}`]=n+hc)}getOffset(){const e=this._element.style,n=`margin${Zn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const cve="ht__manualColumnMove--backlight";let hve=class extends lV{build(){super.build(),q(this._element,cve)}};const dve="ht__manualColumnMove--guideline";let fve=class extends lV{build(){super.build(),q(this._element,dve)}};function gve(t,e){uV(t,e),e.add(t)}function Li(t,e,n){uV(t,e),e.set(t,n)}function uV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(t,e,n){return t.set(Ca(t,e),n),n}function he(t,e){return t.get(Ca(t,e))}function Ca(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnMove");oe.getSingleton().register("afterColumnMove");const iS="manualColumnMove",mve=120,K1="ht__manualColumnMove",Xw="show-ui",s0="on-moving--columns",a0="after-selection--columns";var lr=new WeakMap,Ra=new WeakMap,Ds=new WeakMap,Zp=new WeakMap,Ha=new WeakMap,ar=new WeakMap,tp=new WeakMap,hi=new WeakMap,Tc=new WeakMap,Jw=new WeakMap,lf=new WeakMap,Ol=new WeakSet;class pve extends qe{constructor(){super(...arguments),gve(this,Ol),Li(this,lr,new hve(this.hot)),Li(this,Ra,new fve(this.hot)),Li(this,Ds,[]),Li(this,Zp,0),Li(this,Ha,!1),Li(this,ar,{}),Li(this,tp,void 0),Li(this,hi,void 0),Li(this,Tc,void 0),Li(this,Jw,void 0),Li(this,lf,void 0)}static get PLUGIN_KEY(){return iS}static get PLUGIN_PRIORITY(){return mve}isEnabled(){return!!this.hot.getSettings()[iS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,wve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,yve).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ca(Ol,this,bve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,Sve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,K1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,K1),this.unregisterEvents(),he(lr,this).destroy(),he(Ra,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(tp,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Or(tp,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Or(tp,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Sn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[iS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(hi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(hi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(lr,this).getOffset().start,u=he(lr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,v=Qt(this.hot.rootElement),y=g.innerWidth-he(Tc,this)-v;h=g.innerWidth-he(ar,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=he(ar,this).eventPageX-(he(Tc,this)-(r.scrollX===void 0?i:0));if(he(Jw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(hi,this))&&(o+=i),o+=c,he(hi,this)<0)he(lf,this)>0?he(ar,this).col=0:he(ar,this).col=e>0?e-1:e;else if(he(ar,this).TD.offsetWidth/2+o<=h){const g=he(hi,this)>=he(Zp,this)?he(Zp,this)-1:he(hi,this);he(ar,this).col=g+1,o+=he(ar,this).TD.offsetWidth}else he(ar,this).col=he(hi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(hi,this)<he(lf,this)&&(f-=he(Tc,this)<=r.scrollX?he(Tc,this):0),he(lr,this).setPosition(null,d),he(Ra,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ca(Ol,this,vve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ca(Ol,this,Cve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(lr,this).build(),he(Ra,this).build()}destroy(){he(lr,this).destroy(),he(Ra,this).destroy(),super.destroy()}}function wve(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ve(t.target,"sortAction");if(!s||!o||he(Ha,this)||t.button!==0||a){Or(Ha,this,!1),he(Ds,this).length=0,we(this.hot.rootElement,[s0,Xw]);return}const l=he(Ra,this).isBuilt()&&!he(Ra,this).isAppended(),u=he(lr,this).isBuilt()&&!he(lr,this).isAppended();l&&u&&(he(Ra,this).appendTo(i.hider),he(lr,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Or(Ha,this,!0);const g=n.firstChild?n$(t,n.firstChild).x:t.offsetX;he(ar,this).eventPageX=t.pageX,Or(hi,this,e.col),he(ar,this).TD=n,he(ar,this).col=e.col,Or(Ds,this,this.prepareColumnsToMoving(d,f)),Or(Jw,this,!!this.hot.getSettings().rowHeaders),Or(Zp,this,this.hot.countCols()),Or(lf,this,this.hot.getSettings().fixedColumnsStart),Or(Tc,this,Ln(this.hot.rootElement).left);const v=he(Jw,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(lf,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),x=this.getColumnsWidth(d,e.col-1)+M,P=this.getColumnsWidth(v,d-1)+(E?C:0)+x;he(lr,this).setPosition(y,P),he(lr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),he(lr,this).setOffset(null,-x),q(this.hot.rootElement,s0)}else we(this.hot.rootElement,a0),Or(Ha,this,!1),he(Ds,this).length=0}function vve(t){he(Ha,this)&&(he(ar,this).eventPageX=t.pageX,this.refreshPositions())}function yve(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(Ha,this)||(he(Ds,this).indexOf(e.col)>-1?we(this.hot.rootElement,Xw):q(this.hot.rootElement,Xw),r.row=!0,r.column=!0,r.cell=!0,Or(hi,this,e.col),he(ar,this).TD=n)}function Cve(){const t=he(ar,this).col,e=he(Ds,this).length;if(Or(hi,this,void 0),Or(Ha,this,!1),we(this.hot.rootElement,[s0,Xw,a0]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,a0),e<1||t===void 0)return;const n=he(Ds,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(Ds,this),t);if(he(Ds,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function bve(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(lr,this).setPosition(r),he(lr,this).setSize(null,t.hider.offsetHeight-r)}function Sve(){this.moveBySettingsOrLoad()}function Rve(t,e){cV(t,e),e.add(t)}function Wn(t,e,n){cV(t,e),e.set(t,n)}function cV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zt(t,e,n){return t.set(Yi(t,e),n),n}function se(t,e){return t.get(Yi(t,e))}function Yi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zw="manualColumnResize",Eve=130,q1="manualColumnWidths";var Ms=new WeakMap,np=new WeakMap,Yr=new WeakMap,Qw=new WeakMap,Vo=new WeakMap,Tve=new WeakMap,Yc=new WeakMap,rp=new WeakMap,Sr=new WeakMap,Ss=new WeakMap,pu=new WeakMap,ev=new WeakMap,uf=new WeakMap,cf=new WeakMap,Kr=new WeakMap,hf=new WeakMap,So=new WeakSet;class Mve extends qe{static get PLUGIN_KEY(){return Zw}static get PLUGIN_PRIORITY(){return Eve}constructor(e){super(e),Rve(this,So),Wn(this,Ms,null),Wn(this,np,null),Wn(this,Yr,[]),Wn(this,Qw,null),Wn(this,Vo,null),Wn(this,Tve,null),Wn(this,Yc,null),Wn(this,rp,null),Wn(this,Sr,this.hot.rootDocument.createElement("DIV")),Wn(this,Ss,this.hot.rootDocument.createElement("DIV")),Wn(this,pu,null),Wn(this,ev,!1),Wn(this,uf,0),Wn(this,cf,null),Wn(this,Kr,void 0),Wn(this,hf,void 0),q(se(Sr,this),"manualColumnResizer"),q(se(Ss,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Zw]}enablePlugin(){var e=this;this.enabled||(Zt(Kr,this,new qa),se(Kr,this).addLocalHook("init",()=>Yi(So,this,_ve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,se(Kr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yi(So,e,Hve).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yi(So,e,Nve).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yi(So,e,Dve).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Zt(hf,this,se(Kr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",q1,se(Kr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",q1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return se(Kr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);se(Kr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Zt(Ms,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(se(Ms,this)),i=r.col;if(i<0)return;const o=un(se(Ms,this)),s=se(Ms,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(Ms,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(se(Ms,this),r.row,r.col)),Zt(np,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Zt(Yr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();_(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{se(Yr,this).includes(g)||se(Yr,this).push(g)})})}se(Yr,this).includes(se(np,this))||Zt(Yr,this,[se(np,this)]),Zt(rp,this,l.start-6),Zt(Yc,this,parseInt(s.width,10)),se(Sr,this).style.top=`${l.top}px`,se(Sr,this).style[this.inlineDir]=`${se(rp,this)+se(Yc,this)}px`,se(Sr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(se(Sr,this))}refreshHandlePosition(){se(Sr,this).style[this.inlineDir]=`${se(rp,this)+se(Qw,this)}px`}setupGuidePosition(){const e=parseInt(un(se(Sr,this)),10),n=parseInt(se(Sr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(se(Sr,this),"active"),q(se(Ss,this),"active"),se(Ss,this).style.top=`${n}px`,this.refreshGuidePosition(),se(Ss,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(se(Ss,this))}refreshGuidePosition(){se(Ss,this).style[this.inlineDir]=se(Sr,this).style[this.inlineDir]}hideHandleAndGuide(){we(se(Sr,this),"active"),we(se(Ss,this),"active")}checkIfColumnHeader(e){const n=Wa(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",se(Vo,this),r,!0);o!==void 0&&Zt(Vo,this,o),this.setManualSize(r,se(Vo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Vo,this),r,!0),i&&e()};se(uf,this)>=2&&(se(Yr,this).length>1?(_(se(Yr,this),i=>{n(i)}),e()):_(se(Yr,this),i=>{n(i,!0)})),Zt(uf,this,0),Zt(cf,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Yi(So,this,Pve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Yi(So,this,xve).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Yi(So,this,Ive).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Yi(So,this,Ove).call(this)),this.eventManager.addEventListener(se(Sr,this),"contextmenu",()=>Yi(So,this,Ave).call(this))}destroy(){super.destroy()}}function _ve(){const t=this.hot.getSettings()[Zw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{se(Kr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{se(Kr,this).setValueAtIndex(r,n)})},!0),Zt(hf,this,t)):t===!0&&Array.isArray(se(hf,this))&&this.hot.batchExecution(()=>{se(hf,this).forEach((n,r)=>{se(Kr,this).setValueAtIndex(r,n)})},!0)}function Pve(t){if(!$E(t.target)&&se(ev,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(se(pu,this)||this.setupHandlePosition(e))}}function xve(t){t.target.parentNode===this.hot.rootElement&&ve(t.target,"manualColumnResizer")&&(this.setupHandlePosition(se(Ms,this)),this.setupGuidePosition(),Zt(pu,this,!0),se(cf,this)===null&&(Zt(cf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(cf,this))),Zt(uf,this,se(uf,this)+1),this.startX=t.pageX,Zt(Vo,this,se(Yc,this)))}function Ive(t){if(se(pu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Zt(Qw,this,se(Yc,this)+e),_(se(Yr,this),n=>{Zt(Vo,this,this.setManualSize(n,se(Qw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Ove(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",se(Vo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Vo,this),n,!1)};se(pu,this)&&(this.hideHandleAndGuide(),Zt(pu,this,!1),se(Vo,this)!==se(Yc,this)&&(se(Yr,this).length>1?(_(se(Yr,this),r=>{e(r)}),t()):_(se(Yr,this),r=>{e(r,!0)})),this.setupHandlePosition(se(Ms,this)))}function Ave(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(Sr,this)),this.hot.rootElement.removeChild(se(Ss,this)),Zt(pu,this,!1),Zt(ev,this,!0),this.hot._registerImmediate(()=>{Zt(ev,this,!1)})}function Hve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=se(Kr,this).getValueAtIndex(r);this.hot.getSettings()[Zw]&&i&&(n=i)}return n}function Nve(t,e){const n=se(Kr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Dve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function oS(t,e,n){return(e=kve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kve(t){var e=$ve(t,"string");return typeof e=="symbol"?e:e+""}function $ve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sS=0,X1=1,J1=2,dc="px";let hV=class{constructor(e){oS(this,"hot",void 0),oS(this,"_element",null),oS(this,"state",sS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=J1}build(){this.state===sS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=X1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=sS}isAppended(){return this.state===J1}isBuilt(){return this.state>=X1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+dc),n!==void 0&&(this._element.style.left=n+dc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+dc),n&&(this._element.style.height=n+dc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+dc),n&&(this._element.style.marginLeft=n+dc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Lve="ht__manualRowMove--backlight";class Fve extends hV{build(){super.build(),q(this._element,Lve)}}const Vve="ht__manualRowMove--guideline";class Bve extends hV{build(){super.build(),q(this._element,Vve)}}function Wve(t,e){dV(t,e),e.add(t)}function fc(t,e,n){dV(t,e),e.set(t,n)}function dV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eu(t,e,n){return t.set(ba(t,e),n),n}function Pe(t,e){return t.get(ba(t,e))}function ba(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeRowMove");oe.getSingleton().register("afterRowMove");const aS="manualRowMove",jve=140,Z1="ht__manualRowMove",tv="show-ui",l0="on-moving--rows",u0="after-selection--rows";var ur=new WeakMap,Ea=new WeakMap,ks=new WeakMap,Na=new WeakMap,Ar=new WeakMap,ip=new WeakMap,Al=new WeakSet;class Uve extends qe{constructor(){super(...arguments),Wve(this,Al),fc(this,ur,new Fve(this.hot)),fc(this,Ea,new Bve(this.hot)),fc(this,ks,[]),fc(this,Na,void 0),fc(this,Ar,{}),fc(this,ip,void 0)}static get PLUGIN_KEY(){return aS}static get PLUGIN_PRIORITY(){return jve}isEnabled(){return!!this.hot.getSettings()[aS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Al,e,zve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Al,e,Gve).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ba(Al,this,qve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Al,e,Xve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,Z1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,Z1),this.unregisterEvents(),Pe(ur,this).destroy(),Pe(Ea,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Pe(ip,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(eu(ip,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return eu(ip,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Sn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[aS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Pe(Ar,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Pe(Ar,this).TD,a=this.hot.rootElement,l=Ln(a),u=Zc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Pe(Ar,this).eventPageY-d+c,g=o.hider.offsetHeight,v=o.TBODY.offsetTop,y=Pe(ur,this).getOffset().top,E=Pe(ur,this).getSize().height,C=s.offsetHeight/2,M=s.offsetHeight;let x=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=f>=x+C;this.isFixedRowTop(e.row)&&(x+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Pe(Ar,this).row=n>0?n-1:n:P?(Pe(Ar,this).row=e.row+1,x+=e.row===0?M-1:M):Pe(Ar,this).row=e.row;let T=f,O=x;f+E+y>=g?T=g-E-y:f+y<v&&(T=v+Math.abs(y)),x>=g-1&&(O=g-1),Pe(ur,this).setPosition(T),Pe(Ea,this).setPosition(O)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ba(Al,this,Yve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ba(Al,this,Kve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(ur,this).build(),Pe(Ea,this).build()}destroy(){Pe(ur,this).destroy(),Pe(Ea,this).destroy(),super.destroy()}}function zve(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Pe(Na,this)||t.button!==0){eu(Na,this,!1),Pe(ks,this).length=0,we(this.hot.rootElement,[l0,tv]);return}const l=Pe(Ea,this).isBuilt()&&!Pe(Ea,this).isAppended(),u=Pe(ur,this).isBuilt()&&!Pe(ur,this).isAppended();l&&u&&(Pe(Ea,this).appendTo(i.hider),Pe(ur,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,eu(Na,this,!0),Pe(Ar,this).eventPageY=t.pageY,Pe(Ar,this).coords=e,Pe(Ar,this).TD=n,eu(ks,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Pe(ur,this).setPosition(null,g),Pe(ur,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Pe(ur,this).setOffset(-v,null),q(this.hot.rootElement,l0),this.refreshPositions()}else we(this.hot.rootElement,u0),eu(Na,this,!1),Pe(ks,this).length=0}function Yve(t){Pe(Na,this)&&(Pe(Ar,this).eventPageY=t.pageY,this.refreshPositions())}function Gve(t,e,n,r){!this.hot.getSelectedRangeLast()||!Pe(Na,this)||(Pe(ks,this).indexOf(e.row)>-1?we(this.hot.rootElement,tv):q(this.hot.rootElement,tv),r.row=!0,r.column=!0,r.cell=!0,Pe(Ar,this).coords=e,Pe(Ar,this).TD=n)}function Kve(){const t=Pe(Ar,this).row,e=Pe(ks,this).length;if(eu(Na,this,!1),we(this.hot.rootElement,[l0,tv,u0]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,u0),e<1||t===void 0)return;const n=Pe(ks,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Pe(ks,this),t);if(Pe(ks,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function qve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Pe(ur,this).setPosition(null,r),Pe(ur,this).setSize(t.hider.offsetWidth-r)}function Xve(){this.moveBySettingsOrLoad()}function Jve(t,e){fV(t,e),e.add(t)}function jn(t,e,n){fV(t,e),e.set(t,n)}function fV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jt(t,e,n){return t.set(_s(t,e),n),n}function ie(t,e){return t.get(_s(t,e))}function _s(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nv="manualRowResize",Zve=30,Q1="manualRowHeights";var Ho=new WeakMap,op=new WeakMap,Gr=new WeakMap,df=new WeakMap,Ta=new WeakMap,A_=new WeakMap,Gc=new WeakMap,sp=new WeakMap,or=new WeakMap,Io=new WeakMap,wu=new WeakMap,rv=new WeakMap,ff=new WeakMap,gf=new WeakMap,Xi=new WeakMap,mf=new WeakMap,ha=new WeakSet;class Qve extends qe{static get PLUGIN_KEY(){return nv}static get PLUGIN_PRIORITY(){return Zve}constructor(e){super(e),Jve(this,ha),jn(this,Ho,null),jn(this,op,null),jn(this,Gr,[]),jn(this,df,null),jn(this,Ta,null),jn(this,A_,null),jn(this,Gc,null),jn(this,sp,null),jn(this,or,this.hot.rootDocument.createElement("DIV")),jn(this,Io,this.hot.rootDocument.createElement("DIV")),jn(this,wu,!1),jn(this,rv,!1),jn(this,ff,0),jn(this,gf,null),jn(this,Xi,void 0),jn(this,mf,void 0),q(ie(or,this),"manualRowResizer"),q(ie(Io,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[nv]}enablePlugin(){this.enabled||(jt(Xi,this,new qa),ie(Xi,this).addLocalHook("init",()=>_s(ha,this,sye).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ie(Xi,this)),this.addHook("modifyRowHeight",(e,n)=>_s(ha,this,oye).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){jt(mf,this,ie(Xi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",Q1,ie(Xi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",Q1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return ie(Xi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ie(df,this)}setupHandlePosition(e){jt(Ho,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ie(Ho,this)),o=i.row;if(o<0)return;const s=Qt(ie(Ho,this)),a=ie(Ho,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(Ho,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ie(Ho,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ie(Ho,this),i.row,i.col)),jt(op,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),jt(Gr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();_(d,f=>{const g=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;fe(g,v,y=>{ie(Gr,this).includes(y)||ie(Gr,this).push(y)})})}ie(Gr,this).includes(ie(op,this))||jt(Gr,this,[ie(op,this)]),jt(sp,this,c.top-6),jt(Gc,this,parseInt(a.height,10)),ie(or,this).style.top=`${ie(sp,this)+ie(Gc,this)}px`,ie(or,this).style[this.inlineDir]=`${c.start}px`,ie(or,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ie(or,this))}refreshHandlePosition(){ie(or,this).style.top=`${ie(sp,this)+ie(df,this)}px`}setupGuidePosition(){const e=parseInt(Qt(ie(or,this)),10),n=parseInt(ie(or,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(ie(or,this),"active"),q(ie(Io,this),"active"),ie(Io,this).style.top=ie(or,this).style.top,ie(Io,this).style[this.inlineDir]=`${n}px`,ie(Io,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ie(Io,this))}refreshGuidePosition(){ie(Io,this).style.top=ie(or,this).style.top}hideHandleAndGuide(){we(ie(or,this),"active"),we(ie(Io,this),"active")}checkIfRowHeader(e){const n=Wa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ie(Ta,this)<n?n:ie(Ta,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&jt(Ta,this,o),this.setManualSize(r,ie(Ta,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ie(ff,this)>=2&&(ie(Gr,this).length>1?(_(ie(Gr,this),i=>{n(i)}),e()):_(ie(Gr,this),i=>{n(i,!0)})),jt(ff,this,0),jt(gf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>_s(ha,this,eye).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>_s(ha,this,tye).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>_s(ha,this,nye).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>_s(ha,this,rye).call(this)),this.eventManager.addEventListener(ie(or,this),"contextmenu",()=>_s(ha,this,iye).call(this))}destroy(){super.destroy()}}function eye(t){if(!$E(t.target)&&ie(rv,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ie(wu,this)||this.setupHandlePosition(e))}}function tye(t){ve(t.target,"manualRowResizer")&&(this.setupHandlePosition(ie(Ho,this)),this.setupGuidePosition(),jt(wu,this,!0),ie(gf,this)===null&&(jt(gf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(gf,this))),jt(ff,this,ie(ff,this)+1),jt(A_,this,t.pageY),jt(Ta,this,ie(Gc,this)))}function nye(t){ie(wu,this)&&(jt(df,this,ie(Gc,this)+(t.pageY-ie(A_,this))),_(ie(Gr,this),e=>{jt(Ta,this,this.setManualSize(e,ie(df,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function rye(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ie(wu,this)&&(this.hideHandleAndGuide(),jt(wu,this,!1),ie(Ta,this)!==ie(Gc,this)&&(ie(Gr,this).length>1?(_(ie(Gr,this),r=>{e(r)}),t()):_(ie(Gr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(Ho,this)))}function iye(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(or,this)),this.hot.rootElement.removeChild(ie(Io,this)),jt(wu,this,!1),jt(rv,this,!0),this.hot._registerImmediate(()=>{jt(rv,this,!1)})}function oye(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ie(Xi,this).getValueAtIndex(r);this.hot.getSettings()[nv]&&i&&(n=i)}return n}function sye(){const t=this.hot.getSettings()[nv],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ie(Xi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ie(Xi,this).setValueAtIndex(r,n)}),jt(mf,this,t)):t===!0&&Array.isArray(ie(mf,this))&&ie(mf,this).forEach((n,r)=>{ie(Xi,this).setValueAtIndex(r,n)})},!0)}var aye=Gv;aye("flatMap");var lye=yn,eA=bn,uye=Zo,cye=K0,hye=function(t,e){(!e||typeof t!="string")&&eA(t);var n=cye(t);return uye(eA(n!==void 0?lye(n,t):t))},dye=Ct,c0=yn,fye=Dr,h0=bn,gye=Zo,mye=hye,pye=eE,d0=ei,wye=Ka,lS=wye("flatMap",TypeError),vye=pye(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=h0(c0(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){d0(t,"throw",i)}if(n=h0(c0(this.next,t)),this.done=!!n.done)return;try{this.inner=mye(e(n.value,this.counter++),!1)}catch(i){d0(t,"throw",i)}}});dye({target:"Iterator",proto:!0,real:!0,forced:lS},{flatMap:function(e){h0(this);try{fye(e)}catch(n){d0(this,"throw",n)}return lS?c0(lS,this,e):new vye(gye(this),{mapper:e,inner:null})}});function yye(t,e,n){Cye(t,e),e.set(t,n)}function Cye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hl(t,e,n){return(e=bye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bye(t){var e=Sye(t,"string");return typeof e=="symbol"?e:e+""}function Sye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tA(t,e){return t.get(gV(t,e))}function ap(t,e,n){return t.set(gV(t,e),n),n}function gV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nl=new WeakMap;class No{constructor(e,n,r,i,o,s){Hl(this,"row",void 0),Hl(this,"col",void 0),Hl(this,"rowspan",void 0),Hl(this,"colspan",void 0),Hl(this,"removed",!1),Hl(this,"cellCoordsFactory",void 0),Hl(this,"cellRangeFactory",void 0),yye(this,Nl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return ht`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return ht`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return ht`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return ht`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),ap(Nl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,ap(Nl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return ap(Nl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return tA(Nl,this)||ap(Nl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),tA(Nl,this)}}function Rye(t,e){Eye(t,e),e.add(t)}function Eye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lp(t,e,n){return(e=Tye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tye(t){var e=Mye(t,"string");return typeof e=="symbol"?e:e+""}function Mye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var da=new WeakSet;class iv{constructor(e){Rye(this,da),lp(this,"plugin",void 0),lp(this,"mergedCells",[]),lp(this,"mergedCellsMatrix",new Map),lp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return ht`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){nt(iv.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new No(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Dl(da,this,nA).call(this,a),a):(u&&nt(iv.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Dl(da,this,_ye).call(this,r),r):!1}clear(){_(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ye(u,i,i+s-1),d=Ye(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Dl(da,this,up).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Dl(da,this,up).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Dl(da,this,up).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Dl(da,this,up).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Dl(da,this,nA).call(this,s)})}}function up(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function nA(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function _ye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function uS(t,e,n){return(e=Pye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pye(t){var e=xye(t,"string");return typeof e=="symbol"?e:e+""}function xye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iye{constructor(e){uS(this,"plugin",void 0),uS(this,"mergedCellsCollection",void 0),uS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const y=v.row+v.rowspan-a-g;o[2]+y>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?y:0}else if(r==="right"){const y=v.col+v.colspan-l-g;o[3]+y>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?y:0}else if(r==="up"){const y=u-g-v.row+1;o[0]+y<0?o[0]+=g:o[0]-=g?y:0}else if(r==="left"){const y=c-g-v.col+1;o[1]+y<0?o[1]+=g:o[1]-=g?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),cn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,v=d-g;let y=null,E=null,C=null;switch(r){case"up":y="includesVertically",C=c-v+1;break;case"left":y="includesHorizontally",C=c-v+1;break;case"down":y="includesVertically",C=h+v-1;break;case"right":y="includesHorizontally",C=h+v-1;break}return _(i,M=>{M[y](C)&&M.isFarther(E,r)&&(E=M)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return _(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:v}=g;return v===h.getWidth()}):!f.every(g=>{let{rowspan:v}=g;return v===h.getHeight()})}}function cS(t,e,n){return(e=Oye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oye(t){var e=Aye(t,"string");return typeof e=="symbol"?e:e+""}function Aye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hye{constructor(e){cS(this,"plugin",void 0),cS(this,"hot",void 0),cS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Nye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(jT)}return this.getTranslatedPhrase(WT)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?No.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function pf(t,e,n){return(e=Dye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dye(t){var e=kye(t,"string");return typeof e=="symbol"?e:e+""}function kye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rA{constructor(e){pf(this,"data",void 0),pf(this,"next",null),pf(this,"prev",null),this.data=e}}class cp{constructor(){pf(this,"first",null),pf(this,"last",null)}push(e){const n=new rA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new rA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function $ye(t,e){mV(t,e),e.add(t)}function kl(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(t,e){return t.get(ov(t,e))}function Fr(t,e,n){return t.set(ov(t,e),n),n}function ov(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ro=new WeakMap,Eo=new WeakMap,To=new WeakMap,Mo=new WeakMap,f0=new WeakMap,hp=new WeakMap,dp=new WeakMap,hS=new WeakSet;class Lye{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;$ye(this,hS),kl(this,Ro,new cp),kl(this,Eo,new cp),kl(this,To,null),kl(this,Mo,null),kl(this,f0,null),kl(this,hp,null),kl(this,dp,null),Fr(f0,this,n),Fr(hp,this,r),Fr(dp,this,i)}getCurrentVerticalNode(){return lt(Mo,this).data}getFirstVerticalNode(){return lt(Eo,this).first.data}getNextVerticalNode(){return lt(Mo,this).next.data}getPrevVerticalNode(){return lt(Mo,this).prev.data}getCurrentHorizontalNode(){return lt(To,this).data}getFirstHorizontalNode(){return lt(Ro,this).first.data}getNextHorizontalNode(){return lt(To,this).next.data}getPrevHorizontalNode(){return lt(To,this).prev.data}setPrevNodeAsActive(){Fr(Mo,this,lt(Mo,this).prev),Fr(To,this,lt(To,this).prev)}setNextNodeAsActive(){Fr(Mo,this,lt(Mo,this).next),Fr(To,this,lt(To,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Fr(Ro,this,new cp);for(let s=n.row;s<=r.row;s++)if(!lt(hp,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(lt(dp,this).isHidden(a))continue;const l=ov(hS,this,iA).call(this,e,lt(Ro,this),i,s,a);l&&Fr(To,this,l)}lt(Ro,this).first&&(lt(Ro,this).first.prev=lt(Ro,this).last,lt(Ro,this).last.next=lt(Ro,this).first);const o=new WeakSet;Fr(Eo,this,new cp);for(let s=n.col;s<=r.col;s++)if(!lt(dp,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(lt(hp,this).isHidden(a))continue;const l=ov(hS,this,iA).call(this,e,lt(Eo,this),o,a,s);l&&Fr(Mo,this,l)}lt(Eo,this).first&&(lt(Eo,this).first.prev=lt(Eo,this).last,lt(Eo,this).last.next=lt(Eo,this).first)}setActiveNode(e,n){return lt(Ro,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Fr(To,this,r),!1}),lt(Eo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Fr(Mo,this,r),!1}),this}}function iA(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=lt(f0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function pV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function Fye(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!De(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Nf()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[v,y]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if(Nf()&&d===0&&!e.getSettings().rowHeaders){const V=pV(e,h,g);i.set(l,V/g)}const C=n.getRenderableFromVisualIndex(l),M=r.getRenderableFromVisualIndex(u),x=v-C+1,P=y-M+1;let T=n.getNearestNotHiddenIndex(h,1),O=r.getNearestNotHiddenIndex(d,1);if(E){const V=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(V)||(T=Math.max(T,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(V)||(O=Math.max(O,e.getFirstRenderedVisibleColumn()))}const G=Math.min(g,x),U=Math.min(f,P);T===l&&O===u?(a.setAttribute("rowspan",G),a.setAttribute("colspan",U)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function Vye(t,e){wV(t,e),e.add(t)}function fp(t,e,n){wV(t,e),e.set(t,n)}function wV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dS(t,e,n){return(e=Bye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bye(t){var e=Wye(t,"string");return typeof e=="symbol"?e:e+""}function Wye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gf(t,e,n){return t.set(dt(t,e),n),n}function yt(t,e){return t.get(dt(t,e))}function dt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeMergeCells");oe.getSingleton().register("afterMergeCells");oe.getSingleton().register("beforeUnmergeCells");oe.getSingleton().register("afterUnmergeCells");const g0="mergeCells",jye=150,oA=g0;var vi=new WeakMap,Ci=new WeakMap,Bo=new WeakMap,sA=new WeakMap,wt=new WeakSet;class Uye extends qe{constructor(){super(...arguments),Vye(this,wt),dS(this,"mergedCellsCollection",null),dS(this,"autofillCalculations",null),dS(this,"selectionCalculations",null),fp(this,vi,null),fp(this,Ci,{row:0,col:0}),fp(this,Bo,new Lye({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),fp(this,sA,Fye(this))}static get PLUGIN_KEY(){return g0}static get PLUGIN_PRIORITY(){return jye}static get DEFAULT_SETTINGS(){return{[$L]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[g0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new iv(this),this.autofillCalculations=new Iye(this),this.selectionCalculations=new Hye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,zye).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Gye).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Kye).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,qye).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Xye).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,lA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,lA).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Zye).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Qye).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,eCe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,aA).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,aA).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Yye).call(e,...r)}),this.addHook("afterRenderer",function(){return yt(sA,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Jye).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,tCe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,nCe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,rCe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,iCe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,oCe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,sCe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,aCe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,lCe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,uCe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,cCe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,hCe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,dCe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,fCe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,gCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!WE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Of(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Of(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?No.containsNegativeValues(e)?(nt(No.NEGATIVE_VALUES_WARNING(e)),!1):No.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(nt(No.IS_OUT_OF_BOUNDS_WARNING(e)),!1):No.isSingleCell(e)?(nt(No.IS_SINGLE_CELL(e)),!1):No.containsZeroSpan(e)?(nt(No.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),_(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:oA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function zye(){this.generateFromSettings(),this.hot.render()}function Yye(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Gye(t){yt(Ci,this).row=t.row,yt(Ci,this).col=t.col}function Kye(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;yt(vi,this)&&(i.getRenderableFromVisualIndex(yt(vi,this).row)!==null&&(n.row=yt(vi,this).row),r.getRenderableFromVisualIndex(yt(vi,this).col)!==null&&(n.col=yt(vi,this).col),Gf(vi,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function qye(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Xye(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Gf(vi,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Gf(vi,this,e.clone()),n&&e.assign(n)}function aA(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ye(g,u,h),Ye(v,c,d),Ye(this.hot.getLastRenderedVisibleRow(),u,h),Ye(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Jye(t){t.items.push({name:"---------"},Nye(this))}function lA(){Gf(vi,this,null)}function Zye(){if(yt(vi,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=yt(vi,this).clone().normalize();yt(Bo,this).setActiveNode(r.row,r.col),yt(Ci,this).row>0||yt(Ci,this).col>0?yt(Bo,this).setPrevNodeAsActive():(n==="E-W"&&yt(Ci,this).col<0||e==="S-N"&&yt(Ci,this).row<0)&&yt(Bo,this).setNextNodeAsActive()}function Qye(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(yt(Ci,this).col<0){const{rowEnd:a,colEnd:l}=yt(Bo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(yt(Ci,this).col>0){const{rowStart:a,colStart:l}=yt(Bo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(yt(Ci,this).row<0){const{rowEnd:a,colEnd:l}=yt(Bo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(yt(Ci,this).row>0){const{rowStart:a,colStart:l}=yt(Bo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}yt(Bo,this).setActiveNode(t,e),Gf(Ci,this,{row:0,col:0})}function eCe(){this.hot.getSelectedRangeLast().isHeader()||yt(Bo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function tCe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function nCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function rCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function iCe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function oCe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function sCe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function aCe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function lCe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function uCe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function cCe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);_(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function hCe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function dCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function fCe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function gCe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,pV(this.hot,e,g))}),t}function mCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:GL(u.type))(l,u,d)(c,h);if(g===Yo){const v=a+1;if(typeof e[v]<"u")return s(v)}return g}(0)}}const vV="sort";function pCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${vV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function wCe(t){const e=t.className.split(" "),n=new RegExp(`^${vV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function vCe(t,e,n){return(e=yCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yCe(t){var e=CCe(t,"string");return typeof e=="symbol"?e:e+""}function CCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sv="multiColumnSorting",bCe=170,uA=sv;YL(sv,mCe);class SCe extends nF{constructor(){super(...arguments),vCe(this,"pluginKey",sv)}static get PLUGIN_KEY(){return sv}static get PLUGIN_PRIORITY(){return bCe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Bw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Xa,position:"before",group:uA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),we(e,wCe(e)),this.enabled!==!1&&q(e,pCe(...r))}onAfterOnCellMouseDown(e,n){v_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Bw))):this.sort(this.getColumnNextConfig(n.col)))}}function cA(t,e,n){return(e=RCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RCe(t){var e=ECe(t,"string");return typeof e=="symbol"?e:e+""}function ECe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const TCe="multipleSelectionHandles",MCe=160;class _Ce extends qe{constructor(){super(...arguments),cA(this,"dragged",[]),cA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return TCe}static get PLUGIN_PRIORITY(){return MCe}isEnabled(){return jo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ve(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ve(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function m0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function yV(){return{label:"",isPlaceholder:!0}}function PCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;_(t,i=>{const o=[];let s=0;n.push(o),_(i,a=>{const l=m0();if(De(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Tt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Tt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(yV());return!u})});const r=Math.max(...Ue(n,i=>i.length));return _(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>m0());i.splice(i.length,0,...o)}}),n}function fS(t,e,n){xCe(t,e),e.set(t,n)}function xCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fi(t,e){return t.get(CV(t,e))}function _d(t,e,n){return t.set(CV(t,e),n),n}function CV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hA=["label","collapsible"];var ws=new WeakMap,$l=new WeakMap,gS=new WeakMap;class ICe{constructor(){fS(this,ws,[]),fS(this,$l,0),fS(this,gS,1/0)}setColumnsLimit(e){_d(gS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_d(ws,this,PCe(e,Fi(gS,this))),_d($l,this,Fi(ws,this).length)}getData(){return Fi(ws,this)}mergeWith(e){_(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&cn(s,o,hA)})}map(e){_(Fi(ws,this),n=>{_(n,r=>{const i=e({...r});De(i)&&cn(r,i,hA)})})}getHeaderSettings(e,n){var r;if(e>=Fi($l,this)||e<0)return null;const i=Fi(ws,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Fi($l,this)||e<0)return i;const o=Fi(ws,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Fi($l,this)}getColumnsCount(){return Fi($l,this)>0?Fi(ws,this)[0].length:0}clear(){_d(ws,this,[]),_d($l,this,0)}}function mS(t,e,n){return(e=OCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OCe(t){var e=ACe(t,"string");return typeof e=="symbol"?e:e+""}function ACe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bV="DF-pre-order";function SV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=SV.call(this.childs[r],t,e)}return n}const HCe="DF-post-order";function RV(t,e){for(let n=0;n<this.childs.length;n++)if(RV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const EV="BF";function NCe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const DCe=EV,dA=new Map([[bV,SV],[HCe,RV],[EV,NCe]]);class av{constructor(e){mS(this,"data",{}),mS(this,"parent",null),mS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new av({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DCe;if(!dA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);dA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function pS(t,e,n){kCe(t,e),e.set(t,n)}function kCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(t,e){return t.get(TV(t,e))}function $Ce(t,e,n){return t.set(TV(t,e),n),n}function TV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gc=new WeakMap,Ll=new WeakMap,mc=new WeakMap;class LCe{constructor(e){pS(this,gc,new Map),pS(this,Ll,new Map),pS(this,mc,null),$Ce(mc,this,e)}getRoots(){return Array.from(ir(gc,this).values())}getRootByColumn(e){let n;return ir(Ll,this).has(e)&&(n=ir(gc,this).get(ir(Ll,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-ir(Ll,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;ir(Ll,this).clear(),_(ir(gc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)ir(Ll,this).set(i,e);e+=r})}buildTree(){this.clear();const e=ir(mc,this).getColumnsCount();let n=0;for(;n<e;){const r=ir(mc,this).getHeaderSettings(0,n),i=new av;ir(gc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=ir(mc,this).getHeadersSettings(r,n,i);r+=1,_(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new av(a),e.addChild(l)),r<ir(mc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){ir(gc,this).clear(),ir(Ll,this).clear()}}function MV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function lv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function uv(t){return lv(t,"origColspan")===t.data.origColspan}function H_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(uv(t))return H_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)_(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,MV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):uv(a)&&(l.isCollapsed=lv(a,"isCollapsed"))}),{rollbackModification:()=>N_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function N_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(uv(t))return N_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)_(o,l=>{MV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=lv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):uv(l)&&(u.isCollapsed=lv(l,"isCollapsed"))}),{rollbackModification:()=>H_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function FCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function VCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const fA=new Map([["collapse",N_],["expand",H_],["hide-column",FCe],["show-column",VCe]]);function BCe(t,e,n){if(!fA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return fA.get(t)(e,n)}function gp(t){const e=[];return _(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=jCe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(yV());else{const f=WCe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function WCe(t){const{crossHiddenColumns:e,...n}=m0(t);return n}function jCe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function wS(t,e,n){UCe(t,e),e.set(t,n)}function UCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pd(t,e,n){return t.set(_V(t,e),n),n}function Vt(t,e){return t.get(_V(t,e))}function _V(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _o=new WeakMap,br=new WeakMap,Fl=new WeakMap;class zCe{constructor(){wS(this,_o,new ICe),wS(this,br,new LCe(Vt(_o,this))),wS(this,Fl,[[]])}setState(e){Vt(_o,this).setData(e);let n=!1;try{Vt(br,this).buildTree()}catch{Vt(br,this).clear(),Vt(_o,this).clear(),n=!0}return Pd(Fl,this,gp(Vt(br,this).getRoots())),n}setColumnsLimit(e){Vt(_o,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Vt(_o,this).mergeWith(n),Vt(br,this).buildTree(),Pd(Fl,this,gp(Vt(br,this).getRoots()))}mapState(e){Vt(_o,this).map(e),Vt(br,this).buildTree(),Pd(Fl,this,gp(Vt(br,this).getRoots()))}mapNodes(e){return Sn(Vt(br,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Vt(br,this).getNode(n,r);let o;return i&&(o=BCe(e,i,r),Pd(Fl,this,gp(Vt(br,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Vt(Fl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Vt(br,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Vt(br,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},bV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Vt(_o,this).getLayersCount()}getColumnsCount(){return Vt(_o,this).getColumnsCount()}clear(){Pd(Fl,this,[]),Vt(_o,this).clear(),Vt(br,this).clear()}}function xd(t,e,n){return(e=YCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YCe(t){var e=GCe(t,"string");return typeof e=="symbol"?e:e+""}function GCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KCe{constructor(e,n){xd(this,"hot",void 0),xd(this,"nestedHeaderSettingsGetter",void 0),xd(this,"layersCount",0),xd(this,"container",void 0),xd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),Iu(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function qCe(t,e){PV(t,e),e.add(t)}function gA(t,e,n){return(e=XCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XCe(t){var e=JCe(t,"string");return typeof e=="symbol"?e:e+""}function JCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Id(t,e,n){PV(t,e),e.set(t,n)}function PV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $s(t,e,n){return t.set(Bt(t,e),n),n}function je(t,e){return t.get(Bt(t,e))}function Bt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mA="nestedHeaders",ZCe=280;var gt=new WeakMap,fa=new WeakMap,wf=new WeakMap,Ry=new WeakMap,cv=new WeakMap,Kt=new WeakSet;class QCe extends qe{constructor(){super(...arguments),qCe(this,Kt),Id(this,gt,new zCe),Id(this,fa,null),Id(this,wf,null),Id(this,Ry,!1),Id(this,cv,null),gA(this,"ghostTable",new KCe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),gA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return mA}static get PLUGIN_PRIORITY(){return ZCe}isEnabled(){return!!this.hot.getSettings()[mA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&nt(ht`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Bt(Kt,this,mbe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,pbe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,rbe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,ibe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,obe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,sbe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,abe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,lbe).call(e,...i)}),this.addHook("afterSelection",()=>Bt(Kt,this,mp).call(this)),this.addHook("afterSelectionFocusSet",()=>Bt(Kt,this,mp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,ebe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Bt(Kt,this,cbe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,dbe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,fbe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,tbe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,nbe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,ube).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,hbe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,gbe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Bt(Kt,this,mp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Bt(Kt,this,mp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();je(gt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=je(gt,this).setState(e)),this.detectedOverlappedHeaders&&nt(ht`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";je(gt,this).triggerColumnModification(i,r)}),!je(fa,this)&&this.enabled&&$s(fa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";je(gt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),je(gt,this).clear(),je(fa,this).unsubscribe(),$s(fa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return je(gt,this)}getLayersCount(){return je(gt,this).getLayersCount()}getHeaderSettings(e,n){return je(gt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),we(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),we(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),we(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),we(o,"hiddenHeader"),we(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=je(gt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,v,y;const{wtOverlays:E}=l._wt,C=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),M=(v=E.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((y=E.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const P=C||M?Math.min(c,r-i):c;P>1&&o.setAttribute("colspan",P)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(we(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=je(gt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){$s(gt,this,null),je(fa,this)!==null&&(je(fa,this).unsubscribe(),$s(fa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return je(gt,this).getHeaderTreeNodeData(e.row,e.col)}}function mp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=je(gt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function ebe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=je(cv,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if($s(cv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=je(gt,this).findLeftMostColumnIndex(a,l),g=je(gt,this).findRightMostColumnIndex(a,l),v=g-f+1;if(f<c&&g>h)return f;if(s){let y=null;return f>=c&&g>h?v>d?(e.value="start",y=f):(e.value="end",y=g):f<c&&g<=h&&(v>d?(e.value="end",y=g):(e.value="start",y=f)),y}return f<=c?f:g}function tbe(t,e,n){const r=je(gt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=je(gt,this).getHeaderSettings(e,t);if(o===sT){if(!a)return r.columnIndex}else if(o===P$&&(l>s-i||!a))return null;return t}function nbe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,v=d-a;if(v===0)continue;((i=je(gt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][v]="")}}}function rbe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function ibe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;$s(wf,this,e.clone()),$s(Ry,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Yv(t)||Ua(t)&&l||t$(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function obe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ye(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function sbe(){$s(Ry,this,!1)}function abe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!je(Ry,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=je(gt,this).getHeaderTreeNodeData(je(wf,this).row,je(wf,this).col);if(e.setHighlight(je(wf,this)),o>e.getWidth()||i<n||i+o-1>r){const s=je(gt,this).findTopMostEntireHeaderLevel(Ye(n,i,i+o-1),Ye(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function lbe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=je(gt,this).findLeftMostColumnIndex(n.row,n.col),o=je(gt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function ube(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});$s(cv,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function cbe(t){if(je(gt,this).getLayersCount()>0){t.length=0;for(let e=0;e<je(gt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function hbe(t){const e=je(gt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=je(gt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Gn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?je(gt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function dbe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function fbe(t,e,n){var r;const{label:i}=(r=je(gt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function gbe(t,e){if(t<0)return this.hot.getCell(t,je(gt,this).findLeftMostColumnIndex(t,e),!0)}function mbe(){this.updatePlugin()}function pbe(t,e){e||this.updatePlugin()}function Od(t,e,n){return(e=wbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wbe(t){var e=vbe(t,"string");return typeof e=="symbol"?e:e+""}function vbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ybe{constructor(e,n){Od(this,"hot",void 0),Od(this,"data",null),Od(this,"plugin",void 0),Od(this,"parentReference",new WeakMap),Od(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&_(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&_(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ke(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(_(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];_(r,o=>{i.push(this.getDataObject(o))}),_(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function pA(t,e,n){return(e=Cbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cbe(t){var e=bbe(t,"string");return typeof e=="symbol"?e:e+""}function bbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D_{constructor(e,n){pA(this,"hot",void 0),pA(this,"plugin",void 0),this.hot=n,this.plugin=e}}class $o extends D_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(_(l,c=>{c&&s.removeChild(c)}),q(n,$o.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");q(d,$o.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&be(c,[Pu()]),q(n,$o.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.expandButton}`),u&&be(n,[bi(!1)])):(q(c,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.collapseButton}`),u&&be(n,[bi(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class Sbe extends D_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),_(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&_(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&_(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&_(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ve(e.target,$o.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ii(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Rbe(t,e,n){Ebe(t,e),e.set(t,n)}function Ebe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tbe(t,e,n){return(e=Mbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mbe(t){var e=_be(t,"string");return typeof e=="symbol"?e:e+""}function _be(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pbe(t,e){return t.get(xbe(t,e))}function xbe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wA=new WeakMap;class Ibe extends D_{constructor(){super(...arguments),Tbe(this,"dataManager",this.plugin.dataManager),Rbe(this,wA,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(lM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(uM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return _(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=Pbe(wA,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function pp(t,e,n){return(e=Obe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Obe(t){var e=Abe(t,"string");return typeof e=="symbol"?e:e+""}function Abe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hbe{constructor(e){pp(this,"plugin",void 0),pp(this,"hot",void 0),pp(this,"dataManager",void 0),pp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Ht(i)&&(nt(ht`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Nbe(t,e){xV(t,e),e.add(t)}function vA(t,e,n){xV(t,e),e.set(t,n)}function xV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vS(t,e,n){return(e=Dbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dbe(t){var e=kbe(t,"string");return typeof e=="symbol"?e:e+""}function kbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qp(t,e){return t.get(Tn(t,e))}function hv(t,e,n){return t.set(Tn(t,e),n),n}function Tn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dv="nestedRows",$be=300,yA=dv,Lbe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Ey=new WeakMap,pc=new WeakMap,On=new WeakSet;class Fbe extends qe{constructor(){super(...arguments),Nbe(this,On),vS(this,"dataManager",null),vS(this,"headersUI",null),vS(this,"collapsedRowsMap",null),vA(this,Ey,!1),vA(this,pc,!1)}static get PLUGIN_KEY(){return dv}static get PLUGIN_PRIORITY(){return $be}isEnabled(){return!!this.hot.getSettings()[dv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Sg),this.dataManager=new ybe(this,this.hot),this.collapsingUI=new Sbe(this,this.hot),this.headersUI=new $o(this,this.hot),this.contextMenuUI=new Ibe(this,this.hot),this.rowMoveController=new Hbe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Qbe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,eSe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Wbe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,jbe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Ube).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Bbe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Gbe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Ybe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Kbe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,qbe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Xbe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Jbe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,zbe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Zbe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Vbe).call(e,...r)}),this.addHook("beforeLoadData",n=>Tn(On,this,CA).call(this,n)),this.addHook("beforeUpdateData",n=>Tn(On,this,CA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:yA,relativeToGroup:Xa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yA)}disableCoreAPIModifiers(){hv(pc,this,!0)}enableCoreAPIModifiers(){hv(pc,this,!1)}onModifyRowData(e){if(!Qp(pc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Qp(pc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Qp(pc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Vbe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Bbe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Wbe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),hv(Ey,this,!0),this.dataManager.getData().slice()}function jbe(t){return this.contextMenuUI.appendOptions(t)}function Ube(t,e){this.headersUI.appendLevelIndicators(t,e)}function zbe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Ybe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{hv(Ey,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Gbe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Kbe(){this.collapsingUI.collapsedRowsStash.stash()}function qbe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Xbe(){this.collapsingUI.collapsedRowsStash.stash()}function Jbe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Zbe(){this.dataManager.rewriteCache()}function Qbe(){this.headersUI.updateRowHeaderWidth()}function eSe(t,e){Qp(Ey,this)&&(e.skipRender=!0)}function CA(t){if(!F$(t)){YE(Lbe),this.hot.getSettings()[dv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function yS(t,e,n){return(e=tSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tSe(t){var e=nSe(t,"string");return typeof e=="symbol"?e:e+""}function nSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rSe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;yS(this,"rootWindow",void 0),yS(this,"prefix",void 0),yS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){_(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function iSe(t,e,n){return(e=oSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oSe(t){var e=sSe(t,"string");return typeof e=="symbol"?e:e+""}function sSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}oe.getSingleton().register("persistentStateSave");oe.getSingleton().register("persistentStateLoad");oe.getSingleton().register("persistentStateReset");const bA="persistentState",aSe=0;class lSe extends qe{constructor(){super(...arguments),iSe(this,"storage",void 0)}static get PLUGIN_KEY(){return bA}static get PLUGIN_PRIORITY(){return aSe}isEnabled(){return!!this.hot.getSettings()[bA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new rSe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function uSe(t,e){cSe(t,e),e.add(t)}function cSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CS(t,e,n){return(e=hSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hSe(t){var e=dSe(t,"string");return typeof e=="symbol"?e:e+""}function dSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bS="search",fSe=190,gSe="htSearchResult",mSe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},pSe=function(t,e,n){return Ht(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ht(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var SS=new WeakSet;class wSe extends qe{constructor(){super(...arguments),uSe(this,SS),CS(this,"callback",mSe),CS(this,"queryMethod",pSe),CS(this,"searchResultClass",gSe)}static get PLUGIN_KEY(){return bS}static get PLUGIN_PRIORITY(){return fSe}isEnabled(){return this.hot.getSettings()[bS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[bS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return SA(SS,e,RA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return SA(SS,e,RA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){De(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function RA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function wp(t,e,n){return(e=vSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vSe(t){var e=ySe(t,"string");return typeof e=="symbol"?e:e+""}function ySe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IV{constructor(e){wp(this,"viewportWidth",void 0),wp(this,"overwriteColumnWidthFn",void 0),wp(this,"baseWidths",new Map),wp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class CSe extends IV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=eh?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=eh){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,v=g;o.includes(f)||(v=Math.round(g*l)),this.stretchedWidths.set(f,v),u=f,d<i.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function EA(t,e,n){bSe(t,e),e.set(t,n)}function bSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RS(t,e){return t.get(OV(t,e))}function vp(t,e,n){return t.set(OV(t,e),n),n}function OV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yp=new WeakMap,Ad=new WeakMap;class SSe extends IV{constructor(){super(...arguments),EA(this,yp,0),EA(this,Ad,-1)}prepare(e){super.prepare(e),vp(yp,this,0),vp(Ad,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),vp(Ad,this,e),vp(yp,this,n)}calculate(){if(RS(Ad,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+RS(yp,this),0);this.stretchedWidths.set(RS(Ad,this),n)}}function RSe(t,e){AV(t,e),e.add(t)}function Cp(t,e,n){AV(t,e),e.set(t,n)}function AV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e){return t.get(Dc(t,e))}function ES(t,e,n){return t.set(Dc(t,e),n),n}function Dc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ESe="stretchColumns";var Yn=new WeakMap,wc=new WeakMap,TS=new WeakMap,bp=new WeakMap,Hd=new WeakSet;class TSe{constructor(e){RSe(this,Hd),Cp(this,Yn,void 0),Cp(this,wc,void 0),Cp(this,TS,new Map([["all",new CSe(Dc(Hd,this,TA).bind(this))],["last",new SSe(Dc(Hd,this,TA).bind(this))]])),Cp(this,bp,"none"),ES(Yn,this,e),ES(wc,this,qt(Yn,this).columnIndexMapper.createAndRegisterIndexMap(ESe,"physicalIndexToValue"))}useStrategy(e){ES(bp,this,qt(TS,this).has(e)?e:"none")}refreshStretching(){if(qt(bp,this)==="none"){qt(wc,this).clear();return}qt(Yn,this).batchExecution(()=>{qt(wc,this).clear();const e=qt(TS,this).get(qt(bp,this));let r=qt(Yn,this).view.getViewportWidth();Dc(Hd,this,MSe).call(this)&&(r-=_n(qt(Yn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<qt(Yn,this).countCols();i++)qt(Yn,this).columnIndexMapper.isHidden(qt(Yn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Dc(Hd,this,_Se).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;qt(wc,this).setValueAtIndex(qt(Yn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return qt(wc,this).getValueAtIndex(qt(Yn,this).toPhysicalColumn(e))}}function MSe(){const{view:t}=qt(Yn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=qt(Yn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=qt(Yn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function _Se(t){var e;return(e=qt(Yn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:eh}function TA(t,e){return qt(Yn,this).runHooks("beforeStretchingColumnWidth",t,e)}function PSe(t,e){HV(t,e),e.add(t)}function MS(t,e,n){HV(t,e),e.set(t,n)}function HV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _S(t,e,n){return t.set(fv(t,e),n),n}function Rs(t,e){return t.get(fv(t,e))}function fv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xSe="stretchColumns",ISe=155;var Mc=new WeakMap,Sp=new WeakMap,Nd=new WeakMap,PS=new WeakSet;class OSe extends qe{constructor(){super(...arguments),PSe(this,PS),MS(this,Mc,new TSe(this.hot)),MS(this,Sp,null),MS(this,Nd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Rs(Sp,this)!==null&&Rs(Sp,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),_S(Sp,this,i.width)})})}))}static get PLUGIN_KEY(){return xSe}static get PLUGIN_PRIORITY(){return ISe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Rs(Mc,this).useStrategy(this.hot.getSettings().stretchH),Rs(Nd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fv(PS,e,HSe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fv(PS,e,ASe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Rs(Mc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Rs(Nd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Rs(Mc,this).getStretchedWidth(e)}destroy(){Rs(Nd,this).disconnect(),_S(Nd,this,null),_S(Mc,this,null),super.destroy()}}function ASe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function HSe(t){t&&Rs(Mc,this).refreshStretching()}function NSe(t,e){DSe(t,e),e.add(t)}function DSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rp(t,e,n){return(e=kSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kSe(t){var e=$Se(t,"string");return typeof e=="symbol"?e:e+""}function $Se(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const LSe="touchScroll",FSe=200;var Ep=new WeakSet;class VSe extends qe{constructor(){super(...arguments),NSe(this,Ep),Rp(this,"scrollbars",[]),Rp(this,"clones",[]),Rp(this,"lockedCollection",!1),Rp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return LSe}static get PLUGIN_PRIORITY(){return FSe}static get SETTING_KEYS(){return!0}isEnabled(){return BE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>xS(Ep,this,BSe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>xS(Ep,this,WSe).call(this)),this.addHook("afterMomentumScroll",()=>xS(Ep,this,jSe).call(this))}}function BSe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function WSe(){this.freezeOverlays=!0,_(this.clones,t=>{q(t,"hide-tween")})}function jSe(){this.freezeOverlays=!1,_(this.clones,t=>{we(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{_(this.clones,t=>{we(t,"show-tween")})},400),_(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function USe(t,e){zSe(t,e),e.add(t)}function zSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YSe(t,e,n){return(e=GSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GSe(t){var e=KSe(t,"string");return typeof e=="symbol"?e:e+""}function KSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qSe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ew="trimRows",XSe=330;var MA=new WeakSet;class JSe extends qe{constructor(){super(...arguments),USe(this,MA),YSe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return ew}static get PLUGIN_PRIORITY(){return XSe}isEnabled(){return!!this.hot.getSettings()[ew]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Sg),this.trimmedRowsMap.addLocalHook("init",()=>qSe(MA,this,ZSe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[ew];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),_(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(_(e,l=>{o[l]=!1}),i=Sn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function ZSe(){const t=this.hot.getSettings()[ew];Array.isArray(t)&&this.hot.batchExecution(()=>{_(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function QSe(t,e,n){return(e=eRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eRe(t){var e=tRe(t,"string");return typeof e=="symbol"?e:e+""}function tRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oi{constructor(e){QSe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Tp(t,e,n){return(e=nRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nRe(t){var e=rRe(t,"string");return typeof e=="symbol"?e:e+""}function rRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k_ extends Oi{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Tp(this,"stateBefore",void 0),Tp(this,"range",void 0),Tp(this,"type",void 0),Tp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new k_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){_(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){pa(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function _A(t,e,n){return(e=iRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iRe(t){var e=oRe(t,"string");return typeof e=="symbol"?e:e+""}function oRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $_ extends Oi{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),_A(this,"columns",void 0),_A(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new $_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),O_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function PA(t,e,n){return(e=sRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sRe(t){var e=aRe(t,"string");return typeof e=="symbol"?e:e+""}function aRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L_ extends Oi{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),PA(this,"previousSortState",void 0),PA(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new L_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function xA(t,e,n){return(e=lRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lRe(t){var e=uRe(t,"string");return typeof e=="symbol"?e:e+""}function uRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F_ extends Oi{constructor(e){let{index:n,amount:r}=e;super("insert_col"),xA(this,"index",void 0),xA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new F_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function IA(t,e,n){return(e=cRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cRe(t){var e=hRe(t,"string");return typeof e=="symbol"?e:e+""}function hRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V_ extends Oi{constructor(e){let{index:n,amount:r}=e;super("insert_row"),IA(this,"index",void 0),IA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new V_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Mp(t,e,n){return(e=dRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dRe(t){var e=fRe(t,"string");return typeof e=="symbol"?e:e+""}function fRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B_ extends Oi{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Mp(this,"changes",void 0),Mp(this,"selected",void 0),Mp(this,"countCols",void 0),Mp(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new B_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Qn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Qn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function OA(t,e,n){return(e=gRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gRe(t){var e=mRe(t,"string");return typeof e=="symbol"?e:e+""}function mRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W_ extends Oi{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),OA(this,"conditionsStack",void 0),OA(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new W_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function pRe(t,e,n){return(e=wRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wRe(t){var e=vRe(t,"string");return typeof e=="symbol"?e:e+""}function vRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j_ extends Oi{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),pRe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new j_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function NV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function vs(t,e,n){return(e=yRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yRe(t){var e=CRe(t,"string");return typeof e=="symbol"?e:e+""}function CRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U_ extends Oi{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),vs(this,"index",void 0),vs(this,"indexes",void 0),vs(this,"data",void 0),vs(this,"amount",void 0),vs(this,"headers",void 0),vs(this,"columnPositions",void 0),vs(this,"rowPositions",void 0),vs(this,"fixedColumnsStart",void 0),vs(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const v=[],y=l[g];fe(u,c,E=>{v.push(y[e.toPhysicalColumn(E)])}),h.push(v)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new U_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:NV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ue(this.data[c],o));const l=Ue(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),_(e.getSourceDataArray(),(c,h)=>{_(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&_(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function vc(t,e,n){return(e=bRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bRe(t){var e=SRe(t,"string");return typeof e=="symbol"?e:e+""}function SRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z_ extends Oi{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),vc(this,"index",void 0),vc(this,"data",void 0),vc(this,"fixedRowsBottom",void 0),vc(this,"fixedRowsTop",void 0),vc(this,"rowIndexesSequence",void 0),vc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Qn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new z_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:NV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function AA(t,e,n){return(e=RRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RRe(t){var e=ERe(t,"string");return typeof e=="symbol"?e:e+""}function ERe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y_ extends Oi{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),AA(this,"rows",void 0),AA(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new Y_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),O_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function TRe(t,e,n){return(e=MRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MRe(t){var e=_Re(t,"string");return typeof e=="symbol"?e:e+""}function _Re(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G_ extends Oi{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),TRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new G_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function PRe(t,e){[k_,$_,L_,F_,V_,B_,W_,j_,U_,z_,Y_,G_].forEach(n=>n.startRegisteringEvents(t,e))}function xRe(t,e){IRe(t,e),e.add(t)}function IRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IS(t,e,n){return(e=ORe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ORe(t){var e=ARe(t,"string");return typeof e=="symbol"?e:e+""}function ARe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const HA="undoRedo",HRe="undoRedo",NRe=1e3;oe.getSingleton().register("beforeUndo");oe.getSingleton().register("afterUndo");oe.getSingleton().register("beforeRedo");oe.getSingleton().register("afterRedo");const NA=new Set;var _p=new WeakSet;class DRe extends qe{static get PLUGIN_KEY(){return HRe}static get PLUGIN_PRIORITY(){return NRe}static get SETTING_KEYS(){return!0}constructor(e){super(e),xRe(this,_p),IS(this,"doneActions",[]),IS(this,"undoneActions",[]),IS(this,"ignoreNewActions",!1),PRe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return OS(_p,e,kRe).call(e,...r)}),this.registerShortcuts(),OS(_p,this,$Re).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),OS(_p,this,LRe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:HA};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HA)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function kRe(t,e){e==="loadData"&&this.clear()}function $Re(){const t=e=>{NA.has(e)||(nt(ht`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),NA.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function LRe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function FRe(){Ke(tf),Ke(zue),Ke(nf),Ke(Sce),Ke(Ice),Ke(nF),Ke(The),Ke(ude),Ke(wy),Ke(vfe),Ke(Ufe),Ke(Zfe),Ke(Cy),Ke(Nge),Ke(xpe),Ke(lwe),Ke(Dwe),Ke(Gwe),Ke(ove),Ke(pve),Ke(Mve),Ke(Uve),Ke(Qve),Ke(Uye),Ke(SCe),Ke(_Ce),Ke(QCe),Ke(Fbe),Ke(lSe),Ke(wSe),Ke(OSe),Ke(VSe),Ke(JSe),Ke(DRe)}function VRe(){mae(),Lle(),Gle(),fue(),FRe()}function BRe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var AS,HS,NS,DS,kS;VRe();BRe(Te);Te.__GhostTable=m_;Te._getListenersCounter=pZ;Te._getRegisteredMapsCounter=kre;Te.EventManager=Ei;const WRe=[v8,MJ,mre,Vle,RJ,sJ,S8,gQ,SJ,E8,xJ,fQ],jRe=[nJ,IJ];Te.helper={};Te.dom={};_(WRe,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.helper[e]=t[e])})});_(jRe,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.dom[e]=t[e])})});Te.cellTypes=(AS=Te.cellTypes)!==null&&AS!==void 0?AS:{};_(Bie(),t=>{Te.cellTypes[t]=KM(t)});Te.cellTypes.registerCellType=ci;Te.cellTypes.getCellType=KM;Te.editors=(HS=Te.editors)!==null&&HS!==void 0?HS:{};_(cZ(),t=>{Te.editors[`${Zn(t)}Editor`]=xw(t)});Te.editors.registerEditor=Mr;Te.editors.getEditor=xw;Te.renderers=(NS=Te.renderers)!==null&&NS!==void 0?NS:{};_(xQ(),t=>{const e=Iw(t);t==="base"&&(Te.renderers.cellDecorator=e),Te.renderers[`${Zn(t)}Renderer`]=e});Te.renderers.registerRenderer=Wr;Te.renderers.getRenderer=Iw;Te.validators=(DS=Te.validators)!==null&&DS!==void 0?DS:{};_(AQ(),t=>{Te.validators[`${Zn(t)}Validator`]=QE(t)});Te.validators.registerValidator=Gl;Te.validators.getValidator=QE;Te.plugins=(kS=Te.plugins)!==null&&kS!==void 0?kS:{};_(ZE(),t=>{Te.plugins[t]=vg(t)});Te.plugins[`${Zn(qe.PLUGIN_KEY)}Plugin`]=qe;Te.plugins.registerPlugin=Ke;Te.plugins.getPlugin=vg;let vf=null,rn=new Map,_c={row:-1,col:-1,time:0};function ys(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return t===void 0?(o="undefined",s.readOnly=!1):typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function ui(t,e,n){let r=[],i=!0,o=new Map;const s={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback},a=n.dataPathString||"";if(Array.isArray(t)){const l=t.length>0?t[0]:null;if(l&&typeof l=="object"&&l!==null&&!Array.isArray(l)){let u=Object.keys(l);if(u.length===0){for(let c=1;c<t.length;c++)if(t[c]&&typeof t[c]=="object"&&Object.keys(t[c]).length>0){u=Object.keys(t[c]);break}}i=u.length>0?u:t.length>0?["(내용 없음)"]:["새 열"],t.forEach((c,h)=>{const d=[],f=typeof c=="object"&&c!==null?c:{};i.forEach((g,v)=>{const y=f[g],E=`${a}[${h}]`,{displayValue:C,cellMeta:M}=ys(y,E,g,!1,s);d.push(C),o.set(`${h}-${v}`,M)}),r.push(d)}),t.length===0&&Array.isArray(i)&&i.length===1&&(i[0]==="새 열"||i[0]==="(내용 없음)"||i[0])}else i=["Index","Value"],r=t.map((u,c)=>{const h=a,{displayValue:d,cellMeta:f}=ys(c,h,String(c),!0,s),{displayValue:g,cellMeta:v}=ys(u,h,String(c),!1,s);return o.set(`${c}-0`,f),o.set(`${c}-1`,v),[d,g]})}else if(typeof t=="object"&&t!==null){const l=Object.keys(t);if(l.length>0&&l.every(c=>Array.isArray(t[c]))){let c=0;l.forEach(d=>{c=Math.max(c,t[d].length)});const h=["항목 (Key)"];for(let d=0;d<c;d++)h.push(String(d));i=h,r=l.map((d,f)=>{const g=t[d],v=[],y=a,{displayValue:E,cellMeta:C}=ys(d,y,d,!0,s);v.push(E),o.set(`${f}-0`,C);for(let M=0;M<c;M++)if(M<g.length){const x=g[M],P=`${a?a+".":""}${d}`,{displayValue:T,cellMeta:O}=ys(x,P,String(M),!1,s);v.push(T),o.set(`${f}-${1+M}`,O)}else v.push(""),o.set(`${f}-${1+M}`,{readOnly:!0,originalValue:null,isPadding:!0});return v})}else i=["항목 (Key)","값 (Value)"],r=l.map((c,h)=>{const d=t[c],f=a,{displayValue:g,cellMeta:v}=ys(c,f,c,!0,s),{displayValue:y,cellMeta:E}=ys(d,f,c,!1,s);return o.set(`${h}-0`,v),o.set(`${h}-1`,E),[g,y]})}else{i=["항목","값"];const l=e||(t==null?String(t):"Value"),u=a,{displayValue:c,cellMeta:h}=ys(l,u,"",!0,s),{displayValue:d,cellMeta:f}=ys(t,u,"",!1,s);o.set("0-0",h),o.set("0-1",f),r=[[c,d]]}return{preparedHotData:r,preparedColHeaders:i,preparedCellMetaMap:o}}function DV(){return vf&&(vf.destroy(),vf=null),rn.clear(),_c={row:-1,col:-1,time:0},null}function URe(t,e,n){const r=n.tableViewDomElement;DV(),r&&(r.innerHTML="");const{preparedHotData:i,preparedColHeaders:o,preparedCellMetaMap:s}=ui(t,e,n);return rn=s,r?(vf=new Te(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{view_key_content:{name:"내용 보기 (View Content)",hidden:function(){const l=this.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row;if(u.col!==0||typeof t!="object"||t===null||Array.isArray(t))return!0;const d=Object.keys(t);if(c>=d.length)return!0;const f=d[c],g=t[f];return typeof g!="object"||g===null},callback:function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start){console.error("View Content callback: 유효하지 않은 selection 객체입니다.",l);return}const h=l[0].start.row,d=Object.keys(t);if(h>=d.length){console.error("View Content callback: 행 인덱스가 범위를 벗어났습니다.",h,d);return}const f=d[h],g=t[f];if(typeof g!="object"||g===null){console.error("View Content callback: 대상 값이 객체나 배열이 아닙니다.",g),tt({title:"오류",text:"내용을 볼 수 있는 대상(객체/배열)이 아닙니다.",icon:"error",showCancelButton:!1,hotInstance:u});return}const v=n.dataPathString||"",y=v?`${v}.${f}`:f;n.displayTableCallback(g,f,n.rootJsonData,y)}},row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입"},col_right:{name:"오른쪽에 열 삽입"},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제"},"---------":Te.plugins.ContextMenu.SEPARATOR,duplicate_row:{name:"선택 행 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)||typeof t=="object"&&t!==null&&!Array.isArray(t)):!0},callback:async function(a,l){const u=this,c=l[0].start.row;if(Array.isArray(t)){if(c>=0&&c<t.length){const h=JSON.parse(JSON.stringify(t[c]));t.splice(c+1,0,h),n.refreshTreeViewCallback("row_duplicated_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=ui(t,e,n);rn=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}else if(typeof t=="object"&&t!==null){const h=Object.keys(t);if(c<0||c>=h.length)return;const d=h[c];let f=d+"_복제본",g=f,v=1;for(;t.hasOwnProperty(g);)g=`${f}_${v++}`;Vl({title:"새 키 입력 (행 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:y=>{const E=y.trim();return E?E!==d&&t.hasOwnProperty(E)?"이미 사용 중인 키입니다.":/^\d+$/.test(E)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(y=>{if(y.isConfirmed&&y.value!==void 0){const E=y.value.trim(),C=JSON.parse(JSON.stringify(t[d])),M={};for(const O of Object.keys(t))M[O]=t[O],O===d&&(M[E]=C);Object.keys(t).forEach(O=>delete t[O]),Object.assign(t,M),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered");const{preparedHotData:x,preparedColHeaders:P,preparedCellMetaMap:T}=ui(t,e,n);rn=T,u.updateSettings({colHeaders:P}),u.loadData(x)}})}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])):!0},callback:async function(a,l){const u=this,c=l[0].start.col,h=u.getColHeader();if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])&&Array.isArray(h)&&c>=0&&c<h.length){const d=h[c];if(typeof d!="string")return;let f=d+"_복제본",g=f,v=1;for(;t[0].hasOwnProperty(g);)g=`${f}_${v++}`;Vl({title:"새 열 키 입력 (열 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:y=>{const E=y.trim();return E?t.length>0&&t[0].hasOwnProperty(E)&&E!==d?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(E)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(y=>{if(y.isConfirmed&&y.value!==void 0){const E=y.value.trim();t.forEach(P=>{if(typeof P=="object"&&P!==null){const T=P.hasOwnProperty(d)?JSON.parse(JSON.stringify(P[d])):null,O={};let G=!1;for(const U in P)P.hasOwnProperty(U)&&(O[U]=P[U],U===d&&(O[E]=T,G=!0));G||(O[E]=T),Object.keys(P).forEach(U=>delete P[U]),Object.assign(P,O)}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered");const{preparedHotData:C,preparedColHeaders:M,preparedCellMetaMap:x}=ui(t,e,n);rn=x,u.updateSettings({colHeaders:M}),u.loadData(C)}})}}},set_template:{name:"템플릿 설정",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=rn.get(`${c}-${h}`);if(d&&d.isPadding)return!0;const f=a.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn};return Dd(c,h,g)===null},callback:async function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col;u&&typeof u.deselectCell=="function"&&u.deselectCell();const f=n.getTemplates();if(!f||f.length===0){tt({title:"알림",text:"사용 가능한 템플릿이 없습니다. 먼저 템플릿을 추가해주세요.",icon:"info",showCancelButton:!1,hotInstance:u});return}const g={};f.forEach((y,E)=>{g[`tpl_idx_${E}`]=y.name});const{value:v}=await yi.fire({title:"템플릿 선택 (Select Template)",input:"select",inputOptions:g,inputPlaceholder:"적용할 템플릿을 선택하세요",showCancelButton:!0,confirmButtonText:"적용 (Apply)",cancelButtonText:"취소 (Cancel)",customClass:{popup:"custom-swal-popup"}});if(v){const y=parseInt(v.replace("tpl_idx_",""),10),E=f[y].value,C=JSON.stringify(E),M=u.getColHeader(),x={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(M)?M:M===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn},P=Dd(h,d,x);if(P!==null){n.updateJsonDataCallback(P,C,!1);let T=t;const O=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;n.dataPathString?T=n.getObjectByPathCallback(O,n.dataPathString):T=O,T===void 0&&(T=P.includes("[")||P.includes(".")?{}:null);const{preparedHotData:G,preparedColHeaders:U,preparedCellMetaMap:V}=ui(T,e,n);rn=V,u.updateSettings({colHeaders:U}),u.loadData(G)}else tt({title:"오류",text:"템플릿을 적용할 수 없는 셀입니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},add_as_template:{name:"템플릿으로 추가",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=a.getColHeader(),f={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(d)?d:d===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn},g=Dd(c,h,f);if(g===null)return!0;const v=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,y=n.getObjectByPathCallback(v,g);return!(typeof y=="object"&&y!==null)},callback:async function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col,f=u.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn},v=Dd(h,d,g);if(v===null)return;const y=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,E=n.getObjectByPathCallback(y,v);if(!(typeof E=="object"&&E!==null)){tt({title:"알림",text:"객체 또는 배열 형식의 값만 템플릿으로 추가할 수 있습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}u&&typeof u.deselectCell=="function"&&u.deselectCell();const{value:C}=await Vl({title:"새 템플릿 이름 입력",inputLabel:"저장할 템플릿의 이름을 입력하세요:",inputValue:"",confirmButtonText:"추가",inputValidator:M=>{const x=M.trim();return x?n.getTemplates().some(T=>T.name===x)?"이미 사용중인 템플릿 이름입니다.":null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:u});if(C&&C.trim()){const M=Array.isArray(E)?"array":"object",x=n.addTemplate(C.trim(),M,E);tt(x===!0?{title:"성공",text:`템플릿 "${C.trim()}"이(가) 추가되었습니다.`,icon:"success",showCancelButton:!1,hotInstance:u}:x==="duplicate_name"?{title:"오류",text:`템플릿 이름 "${C.trim()}"이(가) 이미 존재합니다. 다른 이름을 사용해주세요.`,icon:"error",showCancelButton:!1,hotInstance:u}:{title:"오류",text:"템플릿 추가에 실패했습니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(a,l,u){const c={},h=rn.get(`${a}-${l}`);return h&&(c.readOnly=h.readOnly,h.isDrillable&&(c.renderer=function(d,f,g,v,y,E){Te.renderers.TextRenderer.apply(this,arguments),f.style.color="#007bff",f.style.textDecoration="underline",f.style.cursor="pointer"})),c},afterOnCellMouseDown:function(a,l,u){if(a.button!==0)return;const c=new Date().getTime(),{row:h,col:d}=l,f=rn.get(`${h}-${d}`),g=300;let v=!1;if(f&&h===_c.row&&d===_c.col&&c-_c.time<g?(v=!0,_c={row:-1,col:-1,time:0}):_c={row:h,col:d,time:c},v){let y=!1;const E=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(E)&&E.length>0&&E[0]==="항목 (Key)"&&d===0&&f&&(y=!0),y){const C=f.originalKey,M=t,x=n.dataPathString;Vl({title:`키 이름 변경: "${C}"`,inputValue:C,customClass:{popup:"custom-swal-popup"},confirmButtonText:"저장",inputValidator:P=>{const T=P.trim();return T?/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다!":M.hasOwnProperty(T)&&T!==C?"이미 사용 중인 키입니다!":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:this}).then(P=>{if(P.isConfirmed&&P.value!==void 0){const T=P.value.trim();T!==C&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(x,C,T,M)}});return}}if(f&&f.isDrillable&&f.originalValue!==void 0){const y=typeof t=="object"&&t!==null&&!Array.isArray(t)&&d===0&&f&&f.isDrillable;(!v||v&&!y&&f.drillPath)&&typeof f.originalValue=="object"&&f.originalValue!==null&&n.displayTableCallback(f.originalValue,f.originalKey,n.rootJsonData,f.drillPath)}},afterChange:function(a,l){if(l==="loadData"||!a||!Array.isArray(a)||a.length===0)return;const u=l==="CopyPaste.paste"||l==="Autofill.fill"||a.length>1,c=this.getColHeader();a.forEach(([h,d,f,g])=>{let v=-1;if(typeof d=="number"?v=d:typeof d=="string"&&Array.isArray(c)&&(v=c.indexOf(d)),v===-1)if(typeof d=="number"&&c===!0)v=d;else{console.warn("afterChange: 컬럼 인덱스 결정 불가:",h,d,c);return}const y={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(c)?c:c===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn};let E=Dd(h,v,y);E!==null&&(n.updateJsonDataCallback(E,String(g),u,f),n.convertToTypedValueCallback(String(g),f))}),u&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_update_handsontable_afterChange")},afterCreateRow:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)){const f=c.getColHeader();for(let g=0;g<l;g++){let v=null;Array.isArray(f)&&f.length>0&&(f.length!==2||f[0]!=="Index"||f[1]!=="Value")&&(v={},f.forEach(y=>{typeof y=="string"&&(v[y]=null)})),h.splice(a+g,0,v)}d=!0,d&&n.refreshTreeViewCallback("row_added_array_hot")}else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){(async()=>{let f={...h},g=0;for(let C=0;C<l;C++){const M=a+C,x=await Vl({title:`새 항목 키 입력 (${C+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:P=>{const T=P.trim();return T?f.hasOwnProperty(T)?"이미 사용 중인 키입니다.":/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(x.isConfirmed&&x.value!==void 0){const P=x.value.trim(),T=null,O=Object.keys(f),G={};let U=!1;for(let V=0;V<O.length;V++)V===M&&!U&&(G[P]=T,U=!0),G[O[V]]=f[O[V]];U||(G[P]=T),f=G,g++}else break}g>0&&(Object.keys(h).forEach(C=>delete h[C]),Object.assign(h,f),d=!0,n.refreshTreeViewCallback("key_added_object_hot_ordered"));const{preparedHotData:v,preparedColHeaders:y,preparedCellMetaMap:E}=ui(h,e,n);rn=E,c.updateSettings({colHeaders:y}),c.loadData(v)})();return}if(d||u!=="loadData"){const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(h,e,n);rn=v,c.updateSettings({colHeaders:g}),c.loadData(f)}},afterCreateCol:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){(async()=>{for(let y=0;y<l;y++){const E=a+y,C=await Vl({title:`새 열(속성)의 키 입력 (${y+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:M=>{const x=M.trim();return x?h[0].hasOwnProperty(x)?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(x)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(C.isConfirmed&&C.value!==void 0){const M=C.value.trim();h.forEach(x=>{if(typeof x=="object"&&x!==null){const P=Object.keys(x),T={};let O=!1;if(E>=P.length)x[M]=null;else{for(let G=0;G<P.length;G++)G===E&&!O&&(T[M]=null,O=!0),T[P[G]]=x[P[G]];O||(T[M]=null),Object.keys(x).forEach(G=>delete x[G]),Object.assign(x,T)}}}),d=!0}else break}d&&n.refreshTreeViewCallback("col_added_array_of_obj_hot_ordered");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(h,e,n);rn=v,c.updateSettings({colHeaders:g}),c.loadData(f)})();return}else if(typeof h=="object"&&h!==null&&!Array.isArray(h))tt({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c}).then(()=>{const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(h,e,n);rn=v,c.updateSettings({colHeaders:g}),c.loadData(f)});else{tt({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c});const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(h,e,n);rn=v,c.updateSettings({colHeaders:g}),c.loadData(f)}},beforeRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;if(u.sort((d,f)=>f-d),Array.isArray(h))u.forEach(d=>{d>=0&&d<h.length&&h.splice(d,1)});else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=Object.keys(h),f=u.map(g=>d[g]).filter(g=>g!==void 0);f.length>0&&f.forEach(g=>{delete h[g]})}else return!1;return!0},afterRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef||c==="ContextMenu.remove_row_custom")return;const h=this;let d=t;n.refreshTreeViewCallback("row_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(d,e,n);rn=v,h.updateSettings({colHeaders:g}),h.loadData(f)},beforeRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;const d=this.getColHeader();if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){if(!Array.isArray(d))return tt({title:"오류",text:"열 헤더 정보를 가져올 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1;u.sort((f,g)=>g-f),u.forEach(f=>{if(f>=0&&f<d.length){const g=d[f];typeof g=="string"&&h.forEach(v=>{typeof v=="object"&&v!==null&&delete v[g]})}})}else return typeof h=="object"&&h!==null&&!Array.isArray(h)?(tt({title:"오류",text:"이 뷰에서 특정 열 부분 삭제는 지원되지 않습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1):(tt({title:"오류",text:"현재 데이터 구조에서는 열을 삭제할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1);return!0},afterRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return;const h=this;let d=t;n.refreshTreeViewCallback("col_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(d,e,n);rn=v,h.updateSettings({colHeaders:g}),h.loadData(f)}}),vf):(console.error("Handsontable 컨테이너를 찾을 수 없습니다."),null)}function Dd(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a,cellMetaMap:l}=n;let u="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const c=o[e];u=`[${t}].${c}`}else return null;else if(e===1)u=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){const c=l.get(`${t}-0`);if(!c||c.originalKey===void 0)return null;const h=c.originalKey;if(e===0)return null;const d=Array.isArray(o)&&o.length>1&&o[0]==="항목 (Key)"&&!isNaN(parseInt(o[1],10)),f=Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)";if(d)if(e>0&&e<o.length){const g=o[e],v=r[h];if(Array.isArray(v)){const y=l.get(`${t}-${e}`);if(y&&y.isPadding)return null;u=`.${h}[${g}]`}else return null}else return null;else if(f)if(e===1)u=`.${h}`;else return null;else return Object.keys(r).length===0&&Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)",null}else return t===0&&e===1?i||"":null;return i?u.startsWith(".")||u.startsWith("[")?i+u:u?i+"."+u:i:u.startsWith(".")?u.substring(1):u}let Gi=[],Zi=-1;const zRe=30;let K_=!1;function YRe(){Gi=[],Zi=-1,K_=!1}function GRe(t){if(K_)return;const{dataPathString:e,dataKeyName:n}=t,r=Gi[Zi];r&&r.dataPathString===e&&r.dataKeyName===n||(Zi<Gi.length-1&&(Gi=Gi.slice(0,Zi+1)),Gi.push({dataPathString:e,dataKeyName:n}),Zi=Gi.length-1,Gi.length>zRe&&(Gi.shift(),Zi--))}function KRe(t){let e=!1,n=Zi;return t==="back"&&Zi>0?(n--,e=!0):t==="forward"&&Zi<Gi.length-1&&(n++,e=!0),e?(Zi=n,Gi[Zi]):null}function DA(t){K_=t}function qRe(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function XRe(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=qRe(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function kA(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}const gv="userJsonEditorTemplates_v1";let Qi=[];const kd=[{name:"빈 객체 (Empty Object)",type:"object",value:{},isDefault:!0},{name:"빈 배열 (Empty Array)",type:"array",value:[],isDefault:!0}];function p0(){try{const t=localStorage.getItem(gv);if(t){const e=JSON.parse(t);if(Array.isArray(e)){const n=kd.map(i=>i.name),r=e.filter(i=>!n.includes(i.name)||!i.isDefault);Qi=[...kd,...r]}else console.warn("Stored templates are not in array format, resetting to defaults."),Qi=[...kd]}else Qi=[...kd]}catch(t){console.error("Error loading templates from localStorage, resetting to defaults:",t),Qi=[...kd]}return kV(),Qi}function JRe(){return(Qi.length===0&&localStorage.getItem(gv)===null||Qi.length===0&&localStorage.getItem(gv)!==null)&&p0(),Qi}function ZRe(t,e,n){if(!t||!e||n===void 0)return console.error("Template name, type, and value are required."),!1;const r=t.trim();if(Qi.some(o=>o.name===r))return console.warn(`Template with name "${r}" already exists.`),"duplicate_name";const i={name:r,type:e,value:JSON.parse(JSON.stringify(n)),isDefault:!1};return Qi.push(i),kV(),!0}function kV(){try{localStorage.setItem(gv,JSON.stringify(Qi))}catch(t){console.error("Error saving templates to localStorage:",t)}}p0();const $V="selected_theme_json_editor",mv=[{buttonId:"theme-btn-1",themeClass:"theme-high-contrast-dark",name:"High Contrast Dark"},{buttonId:"theme-btn-2",themeClass:"theme-classic-purple",name:"Classic Purple Light"},{buttonId:"theme-btn-3",themeClass:"theme-soft-mint",name:"Soft Mint"}],LV="theme-classic-purple";let $S=null,ou=null,Pc=null;function w0(t){Pc||(Pc=document.body),mv.forEach(n=>{Pc.classList.contains(n.themeClass)&&Pc.classList.remove(n.themeClass)});let e=LV;t&&mv.some(n=>n.themeClass===t)&&(e=t),Pc.classList.add(e),localStorage.setItem($V,e),QRe(e)}function QRe(t){ou&&ou.forEach(e=>{const n=mv.find(r=>r.buttonId===e.id);n&&n.themeClass===t?e.classList.add("active-theme"):e.classList.remove("active-theme")})}function e0e(){ou&&ou.forEach(t=>{t.addEventListener("click",()=>{const e=mv.find(n=>n.buttonId===t.id);e&&w0(e.themeClass)})})}function t0e(){if(Pc=document.body,$S=document.querySelector(".theme-switcher"),!$S){console.warn("Theme switcher element not found by theme-switcher.js during initialization.");return}if(ou=$S.querySelectorAll(".theme-button"),!ou||ou.length===0){console.warn("Theme buttons not found by theme-switcher.js during initialization.");return}e0e();const t=localStorage.getItem($V);w0(t!==null?t:LV),console.log("Theme switcher initialized.")}let Ee=null,su=null,Is,yf,qn,Lt=null;function n0e(){const t=document.getElementById("loadBtn");t&&t.addEventListener("click",q_);const e=document.getElementById("saveBtn");e&&e.addEventListener("click",l0e);const n=document.getElementById("minifyBtn");n&&n.addEventListener("click",()=>{if(sn&&sn.value)try{sn.value=GV(sn.value)}catch(h){en&&(en.textContent="Minify 오류: "+h.message)}else sn&&(sn.value="")});const r=document.getElementById("uglifyBtn");r&&r.addEventListener("click",()=>{if(sn&&sn.value)try{sn.value=KV(sn.value)}catch(h){en&&(en.textContent="Uglify(포맷팅) 오류: "+h.message)}else sn&&(sn.value="")});const i=document.getElementById("diffBtn");i&&i.addEventListener("click",()=>{if(!su&&!Ee){tt({title:"알림",text:"먼저 JSON 데이터를 로드해주세요.",icon:"info",showCancelButton:!1,hotInstance:Lt});return}if(!su){tt({title:"알림",text:"로드 시점의 원본 JSON 데이터가 없습니다. 변경사항을 비교할 수 없습니다.",icon:"info",showCancelButton:!1,hotInstance:Lt});return}Cj({title:"JSON 데이터 변경사항",jsonDiffData:{left:su,right:Ee===null?{}:Ee},buttons:[{text:"닫기",role:"confirm"}],hotInstance:Lt}).catch(d=>{console.error("showJsonDiffPopup 실행 중 오류:",d),tt({title:"오류",text:"변경점 확인 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})})});const o=document.getElementById("loadFromFileBtn");o&&o.addEventListener("click",s0e);const s=document.getElementById("saveToFileBtn");s&&s.addEventListener("click",a0e),Is=document.getElementById("searchInput"),yf=document.getElementById("searchTargetSelect"),qn=document.getElementById("searchResultsDropdown"),Is&&Is.addEventListener("input",LA),yf&&yf.addEventListener("change",LA),document.addEventListener("click",h=>{qn&&Is&&!Is.contains(h.target)&&!qn.contains(h.target)&&(qn.style.display="none")}),qn&&qn.addEventListener("click",h=>h.stopPropagation()),window.addEventListener("mousedown",h=>{(h.button===3||h.button===4)&&(h.preventDefault(),h.button===3?VA("back"):h.button===4&&VA("forward"))}),window.addEventListener("contextmenu",h=>{h.preventDefault()});const a=document.querySelector(".json-control-panel");a?(a.addEventListener("dragover",r0e),a.addEventListener("dragleave",i0e),a.addEventListener("drop",o0e)):console.warn(".json-control-panel 요소를 찾을 수 없어 드래그앤드롭 기능을 활성화할 수 없습니다.");const l=document.querySelector(".main-layout-triple-panel"),u=[document.querySelector(".json-control-panel"),document.querySelector(".tree-view-panel"),document.querySelector(".table-view-panel")],c=[document.getElementById("resizer-1"),document.getElementById("resizer-2")];l&&u.every(h=>h)&&c.every(h=>h)?($A(l,u,c),window.addEventListener("resize",()=>$A(l,u,c)),c.forEach((h,d)=>{let f=!1,g=0,v=[];h.addEventListener("mousedown",C=>{C.preventDefault(),f=!0,g=C.clientX,v=[u[d].offsetWidth,u[d+1].offsetWidth],document.addEventListener("mousemove",y),document.addEventListener("mouseup",E)});function y(C){if(!f)return;const M=C.clientX-g,x=50;let P=v[0]+M,T=v[1]-M;P<x&&(P=x,T=v[0]+v[1]-P),T<x&&(T=x,P=v[0]+v[1]-T),u[d].style.flexBasis=`${P}px`,u[d+1].style.flexBasis=`${T}px`}function E(){f&&(f=!1,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",E))}})):console.warn("3-패널 레이아웃에 필요한 요소를 모두 찾을 수 없습니다. 리사이저가 동작하지 않을 수 있습니다."),t0e()}function r0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.add("dragover-active"),t.dataTransfer.dropEffect="copy"}function i0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active")}function o0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active");const e=t.dataTransfer.files;if(e.length>0){const n=e[0];if(n.type==="application/json"||n.name.toLowerCase().endsWith(".json")){const r=new FileReader;r.onload=i=>{try{const o=i.target.result;sn?(sn.value=o,q_(),nu(qr,`${n.name} 파일이 드롭되어 로드되었습니다.`,3e3)):(console.error("JSON 입력 필드를 찾을 수 없습니다."),tt({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt}))}catch(o){console.error("파일 읽기 또는 JSON 파싱 오류 (드롭):",o),en&&(en.textContent=`파일 오류 (드롭): ${o.message}`),tt({title:"파일 로드 오류 (드롭)",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}},r.onerror=i=>{console.error("파일 읽기 오류 (드롭):",i),en&&(en.textContent="파일을 읽는 중 오류가 발생했습니다 (드롭)."),tt({title:"파일 읽기 오류 (드롭)",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})},r.readAsText(n)}else tt({title:"잘못된 파일 타입",text:"JSON 파일(.json)만 드롭해주세요.",icon:"warning",showCancelButton:!1,hotInstance:Lt})}}function $A(t,e,n){const r=t.offsetWidth,i=n.reduce((l,u)=>l+u.offsetWidth,0),o=r-i,s=[.1,.15,.75],a=50;if(o>0){let l=Math.max(a,Math.floor(o*s[0])),u=Math.max(a,Math.floor(o*s[1])),c=Math.max(a,o-l-u);l+u+c>o&&(c=o-l-u),e[0].style.flexBasis=`${l}px`,e[1].style.flexBasis=`${u}px`,e[2].style.flexBasis=`${c}px`}}function LA(){if(!Is||!yf||!qn)return;const t=Is.value.trim().toLowerCase(),e=yf.value;if(!t){qn.innerHTML="",qn.style.display="none";return}if(Ee==null){kA([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],qn,t,FA);return}const n=XRe(t,e,Ee);kA(n,qn,t,FA)}function FA(t){t&&typeof Ga=="function"&&(Ga(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString||""),qn&&(qn.style.display="none"))}function s0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",t.addEventListener("change",e=>{const n=e.target.files[0];if(!n)return;const r=new FileReader;r.onload=i=>{try{const o=i.target.result;sn?(sn.value=o,q_(),nu(qr,`${n.name} 파일이 로드되었습니다.`,3e3)):(console.error("JSON 입력 필드를 찾을 수 없습니다."),tt({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt}))}catch(o){console.error("파일 읽기 또는 JSON 파싱 오류:",o),en&&(en.textContent=`파일 오류: ${o.message}`),tt({title:"파일 로드 오류",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}},r.onerror=i=>{console.error("파일 읽기 오류:",i),en&&(en.textContent="파일을 읽는 중 오류가 발생했습니다."),tt({title:"파일 읽기 오류",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})},r.readAsText(n),document.body.removeChild(t)}),document.body.appendChild(t),t.click()}async function a0e(){if(Ee==null){nu(qr,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await Vl({title:"파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:Lt});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".json")||(e+=".json");const n=JSON.stringify(Ee,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),nu(qr,`${e} 파일이 성공적으로 저장되었습니다!`,3e3)}else nu(qr,"파일 저장이 취소되었습니다.",3e3)}catch(t){console.error("JSON 파일 저장 오류:",t),en&&(en.textContent="JSON 파일 저장 오류: "+t.message),tt({title:"파일 저장 오류",text:`JSON 데이터를 파일로 저장하는 중 오류가 발생했습니다: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}}function q_(){u0e(),YRe();try{const t=sn.value.trim();if(!t){Ee=null,su=null,Lc(null,Cf),tw();return}Ee=JSON.parse(t),su=JSON.parse(JSON.stringify(Ee));const e=FV();if(Et&&(Et.innerHTML=""),typeof Ee=="object"&&Ee!==null)Sf(Ee,Et,"",Ee,0,e);else{const r={["value"]:Ee};Sf(r,Et,"",r,0,e)}tw(),Lc(null,Cf)}catch(t){en&&(en.textContent="JSON 파싱 오류: "+t.message),Ee=null,su=null,Et&&(Et.innerHTML=""),tw(),Lc(null,Cf)}}function l0e(){if(en&&(en.textContent=""),Ee!=null)try{const t=JSON.stringify(Ee,null,2);sn&&(sn.value=t),qr&&nu(qr,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){en&&(en.textContent="JSON 문자열 변환 오류: "+t.message),qr&&(qr.textContent="")}else sn&&(sn.value=""),qr&&nu(qr,"저장할 JSON 데이터가 없습니다.",3e3)}function u0e(){Sj(),tw(),Ee=null,su=null,Jc(null),qn&&(qn.innerHTML="",qn.style.display="none"),Is&&(Is.value=""),Et&&(Et.innerHTML=""),Lc(null,Cf)}function tw(){Lt=DV()}function c0e(t,e,n=!1){if(Ee==null){console.error("데이터 업데이트 오류: currentJsonData가 없습니다.");return}const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Ee:s=lu(Ee,o),o===""&&t===i&&(typeof Ee!="object"||Ee===null)){if(Ee=US(e,Ee),n)return;pv(t),Ga(Ee,"value",Ee,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){console.error("데이터 업데이트 오류: 부모 객체를 찾을 수 없거나 객체/배열이 아님.",{pathString:t,parentPath:o,parentObject:s}),tt({title:"오류",text:"데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).",icon:"error",showCancelButton:!1,hotInstance:Lt});return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){console.error("데이터 업데이트 오류: 배열 인덱스 범위 초과.",{targetKeyOrIndex:a,arrayLength:s.length}),tt({title:"오류",text:"배열 인덱스 범위를 벗어났습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt});return}let l=!0;const u=s[a],c=US(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&Et){const f=Et.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(XH(g,c),l=!1)}}!n&&l&&pv(t)}}function h0e(t,e,n,r){let i;if(r&&(t===""||lu(Ee,t)===r)?i=r:i=t===""?Ee:lu(Ee,t),typeof i!="object"||i===null||Array.isArray(i)){tt({title:"오류",text:"키를 업데이트할 부모 객체를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt});return}if(!i.hasOwnProperty(e)){tt({title:"오류",text:`기존 키 "${e}"를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt});return}if(n===e){tt({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다.",showCancelButton:!1,hotInstance:Lt});return}if(i.hasOwnProperty(n)){tt({title:"오류",text:`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt});return}const o={},s=i[e];for(const a in i)i.hasOwnProperty(a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)i.hasOwnProperty(a)&&delete i[a];for(const a in o)o.hasOwnProperty(a)&&(i[a]=o[a]);tt({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`,showCancelButton:!1,hotInstance:Lt}),pv(`key_renamed_in_parent:${t}`),Ga(i,n,Ee,t)}function pv(t="N/A"){if(Et&&Ee!=null){const e=Tj(),n=Mj(Et);Et.innerHTML="";const r=FV();if(typeof Ee=="object"&&Ee!==null)Sf(Ee,Et,"",Ee,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Ee};Sf(o,Et,"",o,0,r)}if(_j(Et,n),e){const i=Et.querySelector(`.tree-node[data-path="${e}"]`);i&&Jc(i)}}else Et&&(Et.innerHTML="")}function FV(){return{displayTableCallback:Ga,getObjectByPathCallback:lu,rootJsonData:Ee}}function Cf(t){const e=lu(Ee,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}Ga(e,n,Ee,t,{syncTreeView:!0})}else console.warn(`Data not found for path: ${t}`),tt({title:"오류",text:`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt})}function Ga(t,e,n,r,i={syncTreeView:!0}){if(GRe({dataPathString:r,dataKeyName:e}),Lc(r,Cf),Lt=URe(t,e,{tableViewDomElement:jS,updateJsonDataCallback:c0e,updateJsonKeyCallback:h0e,refreshTreeViewCallback:pv,getObjectByPathCallback:lu,convertToTypedValueCallback:US,rootJsonData:n,currentJsonDataRef:()=>Ee,dataPathString:r,displayTableCallback:Ga,getTemplates:JRe,addTemplate:ZRe}),i.syncTreeView&&Et&&r!==void 0&&r!==null){const s=Et.querySelector(`.tree-node[data-path="${r}"]`);s?(Jc(s),setTimeout(()=>{const a=Et.querySelector(`.tree-node[data-path="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},50)):r===""?(Jc(null),Et.firstChild&&(Et.scrollTop=0)):console.warn(`Tree node for path "${r}" not found for synchronization.`)}}function VA(t){const e=KRe(t);if(e){DA(!0);try{const n=lu(Ee,e.dataPathString);Ga(n,e.dataKeyName,Ee,e.dataPathString,{syncTreeView:!1})}catch(n){console.error("Error navigating history:",n),tt({title:"오류",text:"히스토리 복원 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})}finally{DA(!1)}}}document.addEventListener("DOMContentLoaded",n0e)});export default d0e();
