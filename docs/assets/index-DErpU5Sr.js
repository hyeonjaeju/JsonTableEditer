var EV=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var kRe=EV((JRe,jp)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function TV(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function MV(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function SA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function _V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j_(t,e){return t.get(SA(t,e))}function PV(t,e,n){_V(t,e),e.set(t,n)}function xV(t,e,n){return t.set(SA(t,e),n),n}const OV=100,Se={},IV=()=>{Se.previousActiveElement instanceof HTMLElement?(Se.previousActiveElement.focus(),Se.previousActiveElement=null):document.body&&document.body.focus()},AV=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Se.restoreFocusTimeout=setTimeout(()=>{IV(),e()},OV),window.scrollTo(n,r)}),RA="swal2-",HV=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],z=HV.reduce((t,e)=>(t[e]=RA+e,t),{}),NV=["success","warning","info","question","error"],Up=NV.reduce((t,e)=>(t[e]=RA+e,t),{}),EA="SweetAlert2:",e0=t=>t.charAt(0).toUpperCase()+t.slice(1),ar=t=>{console.warn(`${EA} ${typeof t=="object"?t.join(" "):t}`)},uu=t=>{console.error(`${EA} ${t}`)},U_=[],DV=t=>{U_.includes(t)||(U_.push(t),ar(t))},TA=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;DV(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},rv=t=>typeof t=="function"?t():t,t0=t=>t&&typeof t.toPromise=="function",Df=t=>t0(t)?t.toPromise():Promise.resolve(t),n0=t=>t&&Promise.resolve(t)===t,cr=()=>document.body.querySelector(`.${z.container}`),kf=t=>{const e=cr();return e?e.querySelector(t):null},Kr=t=>kf(`.${t}`),tt=()=>Kr(z.popup),Kc=()=>Kr(z.icon),kV=()=>Kr(z["icon-content"]),MA=()=>Kr(z.title),r0=()=>Kr(z["html-container"]),_A=()=>Kr(z.image),i0=()=>Kr(z["progress-steps"]),iv=()=>Kr(z["validation-message"]),Vo=()=>kf(`.${z.actions} .${z.confirm}`),qc=()=>kf(`.${z.actions} .${z.cancel}`),cu=()=>kf(`.${z.actions} .${z.deny}`),$V=()=>Kr(z["input-label"]),Xc=()=>kf(`.${z.loader}`),$f=()=>Kr(z.actions),PA=()=>Kr(z.footer),ov=()=>Kr(z["timer-progress-bar"]),o0=()=>Kr(z.close),LV=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,s0=()=>{const t=tt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(LV),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>Ir(o))},a0=()=>Os(document.body,z.shown)&&!Os(document.body,z["toast-shown"])&&!Os(document.body,z["no-backdrop"]),sv=()=>{const t=tt();return t?Os(t,z.toast):!1},FV=()=>{const t=tt();return t?t.hasAttribute("data-loading"):!1},qr=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},Os=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},VV=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(z).includes(n)&&!Object.values(Up).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Gr=(t,e,n)=>{if(VV(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){ar(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}lt(t,r)}},av=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${z.popup} > .${z[e]}`);case"checkbox":return t.querySelector(`.${z.popup} > .${z.checkbox} input`);case"radio":return t.querySelector(`.${z.popup} > .${z.radio} input:checked`)||t.querySelector(`.${z.popup} > .${z.radio} input:first-child`);case"range":return t.querySelector(`.${z.popup} > .${z.range} input`);default:return t.querySelector(`.${z.popup} > .${z.input}`)}},xA=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},OA=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},lt=(t,e)=>{OA(t,e,!0)},pi=(t,e)=>{OA(t,e,!1)},ya=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&Os(i,e))return i}},ql=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},xn=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},Kn=t=>{t&&(t.style.display="none")},l0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{Lf(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},z_=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},Lf=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?xn(t,n):Kn(t)},Ir=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),WV=()=>!Ir(Vo())&&!Ir(cu())&&!Ir(qc()),Y_=t=>t.scrollHeight>t.clientHeight,IA=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},u0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=ov();n&&Ir(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},BV=()=>{const t=ov();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},jV=()=>typeof window>"u"||typeof document>"u",UV=`
 <div aria-labelledby="${z.title}" aria-describedby="${z["html-container"]}" class="${z.popup}" tabindex="-1">
   <button type="button" class="${z.close}"></button>
   <ul class="${z["progress-steps"]}"></ul>
   <div class="${z.icon}"></div>
   <img class="${z.image}" />
   <h2 class="${z.title}" id="${z.title}"></h2>
   <div class="${z["html-container"]}" id="${z["html-container"]}"></div>
   <input class="${z.input}" id="${z.input}" />
   <input type="file" class="${z.file}" />
   <div class="${z.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${z.select}" id="${z.select}"></select>
   <div class="${z.radio}"></div>
   <label class="${z.checkbox}">
     <input type="checkbox" id="${z.checkbox}" />
     <span class="${z.label}"></span>
   </label>
   <textarea class="${z.textarea}" id="${z.textarea}"></textarea>
   <div class="${z["validation-message"]}" id="${z["validation-message"]}"></div>
   <div class="${z.actions}">
     <div class="${z.loader}"></div>
     <button type="button" class="${z.confirm}"></button>
     <button type="button" class="${z.deny}"></button>
     <button type="button" class="${z.cancel}"></button>
   </div>
   <div class="${z.footer}"></div>
   <div class="${z["timer-progress-bar-container"]}">
     <div class="${z["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),zV=()=>{const t=cr();return t?(t.remove(),pi([document.documentElement,document.body],[z["no-backdrop"],z["toast-shown"],z["has-column"]]),!0):!1},Ga=()=>{Se.currentInstance.resetValidationMessage()},YV=()=>{const t=tt(),e=ya(t,z.input),n=ya(t,z.file),r=t.querySelector(`.${z.range} input`),i=t.querySelector(`.${z.range} output`),o=ya(t,z.select),s=t.querySelector(`.${z.checkbox} input`),a=ya(t,z.textarea);e.oninput=Ga,n.onchange=Ga,o.onchange=Ga,s.onchange=Ga,a.oninput=Ga,r.oninput=()=>{Ga(),i.value=r.value},r.onchange=()=>{Ga(),i.value=r.value}},GV=t=>typeof t=="string"?document.querySelector(t):t,KV=t=>{const e=tt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},qV=t=>{window.getComputedStyle(t).direction==="rtl"&&lt(cr(),z.rtl)},XV=t=>{const e=zV();if(jV()){uu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=z.container,e&&lt(n,z["no-transition"]),qr(n,UV),n.dataset.swal2Theme=t.theme;const r=GV(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),KV(t),qV(r),YV()},c0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?JV(t,e):t&&qr(e,t)},JV=(t,e)=>{t.jquery?ZV(e,t):qr(e,t.toString())},ZV=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},QV=(t,e)=>{const n=$f(),r=Xc();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?Kn(n):xn(n),Gr(n,e,"actions"),eW(n,r,e),qr(r,e.loaderHtml||""),Gr(r,e,"loader"))};function eW(t,e,n){const r=Vo(),i=cu(),o=qc();!r||!i||!o||(gy(r,"confirm",n),gy(i,"deny",n),gy(o,"cancel",n),tW(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function tW(t,e,n,r){if(!r.buttonsStyling){pi([t,e,n],z.styled);return}lt([t,e,n],z.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),fy(t),fy(e),fy(n)}function fy(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function gy(t,e,n){const r=e0(e);Lf(t,n[`show${r}Button`],"inline-block"),qr(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=z[e],Gr(t,n,`${e}Button`)}const nW=(t,e)=>{const n=o0();n&&(qr(n,e.closeButtonHtml||""),Gr(n,e,"closeButton"),Lf(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},rW=(t,e)=>{const n=cr();n&&(iW(n,e.backdrop),oW(n,e.position),sW(n,e.grow),Gr(n,e,"container"))};function iW(t,e){typeof e=="string"?t.style.background=e:e||lt([document.documentElement,document.body],z["no-backdrop"])}function oW(t,e){e&&(e in z?lt(t,z[e]):(ar('The "position" parameter is not valid, defaulting to "center"'),lt(t,z.center)))}function sW(t,e){e&&lt(t,z[`grow-${e}`])}var Et={innerParams:new WeakMap,domCache:new WeakMap};const aW=["input","file","range","select","radio","checkbox","textarea"],lW=(t,e)=>{const n=tt();if(!n)return;const r=Et.innerParams.get(t),i=!r||e.input!==r.input;aW.forEach(o=>{const s=ya(n,z[o]);s&&(hW(o,e.inputAttributes),s.className=z[o],i&&Kn(s))}),e.input&&(i&&uW(e),dW(e))},uW=t=>{if(!t.input)return;if(!en[t.input]){uu(`Unexpected type of input! Expected ${Object.keys(en).join(" | ")}, got "${t.input}"`);return}const e=AA(t.input);if(!e)return;const n=en[t.input](e,t);xn(e),t.inputAutoFocus&&setTimeout(()=>{xA(n)})},cW=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},hW=(t,e)=>{const n=tt();if(!n)return;const r=av(n,t);if(r){cW(r);for(const i in e)r.setAttribute(i,e[i])}},dW=t=>{if(!t.input)return;const e=AA(t.input);e&&Gr(e,t,"input")},h0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},Ff=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=z["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&lt(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},AA=t=>{const e=tt();if(e)return ya(e,z[t]||z.input)},zp=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:n0(e)||ar(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},en={};en.text=en.email=en.password=en.number=en.tel=en.url=en.search=en.date=en["datetime-local"]=en.time=en.week=en.month=(t,e)=>(zp(t,e.inputValue),Ff(t,t,e),h0(t,e),t.type=e.input,t);en.file=(t,e)=>(Ff(t,t,e),h0(t,e),t);en.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return zp(n,e.inputValue),n.type=e.input,zp(r,e.inputValue),Ff(n,t,e),t};en.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");qr(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return Ff(t,t,e),t};en.radio=t=>(t.textContent="",t);en.checkbox=(t,e)=>{const n=av(tt(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return qr(r,e.inputPlaceholder||e.inputLabel),n};en.textarea=(t,e)=>{zp(t,e.inputValue),h0(t,e),Ff(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(tt()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?tt().style.width=`${o}px`:ql(tt(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const fW=(t,e)=>{const n=r0();n&&(l0(n),Gr(n,e,"htmlContainer"),e.html?(c0(e.html,n),xn(n,"block")):e.text?(n.textContent=e.text,xn(n,"block")):Kn(n),lW(t,e))},gW=(t,e)=>{const n=PA();n&&(l0(n),Lf(n,e.footer,"block"),e.footer&&c0(e.footer,n),Gr(n,e,"footer"))},mW=(t,e)=>{const n=Et.innerParams.get(t),r=Kc();if(!r)return;if(n&&e.icon===n.icon){K_(r,e),G_(r,e);return}if(!e.icon&&!e.iconHtml){Kn(r);return}if(e.icon&&Object.keys(Up).indexOf(e.icon)===-1){uu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),Kn(r);return}xn(r),K_(r,e),G_(r,e),lt(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",HA)},G_=(t,e)=>{for(const[n,r]of Object.entries(Up))e.icon!==n&&pi(t,r);lt(t,e.icon&&Up[e.icon]),vW(t,e),HA(),Gr(t,e,"icon")},HA=()=>{const t=tt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},pW=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,wW=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,K_=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=q_(e.iconHtml):e.icon==="success"?(r=pW,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=wW:e.icon&&(r=q_({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&qr(t,r)},vW=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])z_(t,n,"background-color",e.iconColor);z_(t,".swal2-success-ring","border-color",e.iconColor)}},q_=t=>`<div class="${z["icon-content"]}">${t}</div>`,yW=(t,e)=>{const n=_A();if(n){if(!e.imageUrl){Kn(n);return}xn(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),ql(n,"width",e.imageWidth),ql(n,"height",e.imageHeight),n.className=z.image,Gr(n,e,"image")}};let d0=!1,NA=0,DA=0,kA=0,$A=0;const CW=t=>{t.addEventListener("mousedown",Yp),document.body.addEventListener("mousemove",Gp),t.addEventListener("mouseup",Kp),t.addEventListener("touchstart",Yp),document.body.addEventListener("touchmove",Gp),t.addEventListener("touchend",Kp)},bW=t=>{t.removeEventListener("mousedown",Yp),document.body.removeEventListener("mousemove",Gp),t.removeEventListener("mouseup",Kp),t.removeEventListener("touchstart",Yp),document.body.removeEventListener("touchmove",Gp),t.removeEventListener("touchend",Kp)},Yp=t=>{const e=tt();if(t.target===e||Kc().contains(t.target)){d0=!0;const n=LA(t);NA=n.clientX,DA=n.clientY,kA=parseInt(e.style.insetInlineStart)||0,$A=parseInt(e.style.insetBlockStart)||0,lt(e,"swal2-dragging")}},Gp=t=>{const e=tt();if(d0){let{clientX:n,clientY:r}=LA(t);e.style.insetInlineStart=`${kA+(n-NA)}px`,e.style.insetBlockStart=`${$A+(r-DA)}px`}},Kp=()=>{const t=tt();d0=!1,pi(t,"swal2-dragging")},LA=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},SW=(t,e)=>{const n=cr(),r=tt();if(!(!n||!r)){if(e.toast){ql(n,"width",e.width),r.style.width="100%";const i=Xc();i&&r.insertBefore(i,Kc())}else ql(r,"width",e.width);ql(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),Kn(iv()),RW(r,e),e.draggable&&!e.toast?(lt(r,z.draggable),CW(r)):(pi(r,z.draggable),bW(r))}},RW=(t,e)=>{const n=e.showClass||{};t.className=`${z.popup} ${Ir(t)?n.popup:""}`,e.toast?(lt([document.documentElement,document.body],z["toast-shown"]),lt(t,z.toast)):lt(t,z.modal),Gr(t,e,"popup"),typeof e.customClass=="string"&&lt(t,e.customClass),e.icon&&lt(t,z[`icon-${e.icon}`])},EW=(t,e)=>{const n=i0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){Kn(n);return}xn(n),n.textContent="",i>=r.length&&ar("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=TW(o);if(n.appendChild(a),s===i&&lt(a,z["active-progress-step"]),s!==r.length-1){const l=MW(e);n.appendChild(l)}})},TW=t=>{const e=document.createElement("li");return lt(e,z["progress-step"]),qr(e,t),e},MW=t=>{const e=document.createElement("li");return lt(e,z["progress-step-line"]),t.progressStepsDistance&&ql(e,"width",t.progressStepsDistance),e},_W=(t,e)=>{const n=MA();n&&(l0(n),Lf(n,e.title||e.titleText,"block"),e.title&&c0(e.title,n),e.titleText&&(n.innerText=e.titleText),Gr(n,e,"title"))},FA=(t,e)=>{SW(t,e),rW(t,e),EW(t,e),mW(t,e),yW(t,e),_W(t,e),nW(t,e),fW(t,e),QV(t,e),gW(t,e);const n=tt();typeof e.didRender=="function"&&n&&e.didRender(n),Se.eventEmitter.emit("didRender",n)},PW=()=>Ir(tt()),VA=()=>{var t;return(t=Vo())===null||t===void 0?void 0:t.click()},xW=()=>{var t;return(t=cu())===null||t===void 0?void 0:t.click()},OW=()=>{var t;return(t=qc())===null||t===void 0?void 0:t.click()},Jc=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),WA=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},IW=(t,e,n)=>{WA(t),e.toast||(t.keydownHandler=r=>HW(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:tt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},RS=(t,e)=>{var n;const r=s0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=tt())===null||n===void 0||n.focus()},BA=["ArrowRight","ArrowDown"],AW=["ArrowLeft","ArrowUp"],HW=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?NW(e,t):e.key==="Tab"?DW(e):[...BA,...AW].includes(e.key)?kW(e.key):e.key==="Escape"&&$W(e,t,n)))},NW=(t,e)=>{if(!rv(e.allowEnterKey))return;const n=av(tt(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;VA(),t.preventDefault()}},DW=t=>{const e=t.target,n=s0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?RS(r,-1):RS(r,1),t.stopPropagation(),t.preventDefault()},kW=t=>{const e=$f(),n=Vo(),r=cu(),i=qc();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=BA.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Ir(a))break}a instanceof HTMLButtonElement&&a.focus()}},$W=(t,e,n)=>{rv(e.allowEscapeKey)&&(t.preventDefault(),n(Jc.esc))};var $c={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const LW=()=>{const t=cr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},jA=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},UA=typeof window<"u"&&!!window.GestureEvent,FW=()=>{if(UA&&!Os(document.body,z.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,lt(document.body,z.iosfix),VW()}},VW=()=>{const t=cr();if(!t)return;let e;t.ontouchstart=n=>{e=WW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},WW=t=>{const e=t.target,n=cr(),r=r0();return!n||!r||BW(t)||jW(t)?!1:e===n||!Y_(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(Y_(r)&&r.contains(e))},BW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",jW=t=>t.touches&&t.touches.length>1,UW=()=>{if(Os(document.body,z.iosfix)){const t=parseInt(document.body.style.top,10);pi(document.body,z.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},zW=()=>{const t=document.createElement("div");t.className=z["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let Tc=null;const YW=t=>{Tc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(Tc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Tc+zW()}px`)},GW=()=>{Tc!==null&&(document.body.style.paddingRight=`${Tc}px`,Tc=null)};function zA(t,e,n,r){sv()?X_(t,r):(AV(n).then(()=>X_(t,r)),WA(Se)),UA?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),a0()&&(GW(),UW(),jA()),KW()}function KW(){pi([document.documentElement,document.body],[z.shown,z["height-auto"],z["no-backdrop"],z["toast-shown"]])}function Ca(t){t=XW(t);const e=$c.swalPromiseResolve.get(this),n=qW(this);this.isAwaitingPromise?t.isDismissed||(Vf(this),e(t)):n&&e(t)}const qW=t=>{const e=tt();if(!e)return!1;const n=Et.innerParams.get(t);if(!n||Os(e,n.hideClass.popup))return!1;pi(e,n.showClass.popup),lt(e,n.hideClass.popup);const r=cr();return pi(r,n.showClass.backdrop),lt(r,n.hideClass.backdrop),JW(t,e,n),!0};function YA(t){const e=$c.swalPromiseReject.get(this);Vf(this),e&&e(t)}const Vf=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Et.innerParams.get(t)||t._destroy())},XW=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),JW=(t,e,n)=>{var r;const i=cr(),o=IA(e);typeof n.willClose=="function"&&n.willClose(e),(r=Se.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?ZW(t,e,i,n.returnFocus,n.didClose):zA(t,i,n.returnFocus,n.didClose)},ZW=(t,e,n,r,i)=>{Se.swalCloseEventFinishedCallback=zA.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Se.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Se),delete Se.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},X_=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Se.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Lc=t=>{let e=tt();if(e||new Qt,e=tt(),!e)return;const n=Xc();sv()?Kn(Kc()):QW(e,t),xn(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},QW=(t,e)=>{const n=$f(),r=Xc();!n||!r||(!e&&Ir(Vo())&&(e=Vo()),xn(n),e&&(Kn(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),lt([t,n],z.loading))},eB=(t,e)=>{e.input==="select"||e.input==="radio"?oB(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(t0(e.inputValue)||n0(e.inputValue))&&(Lc(Vo()),sB(t,e))},tB=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return nB(n);case"radio":return rB(n);case"file":return iB(n);default:return e.inputAutoTrim?n.value.trim():n.value}},nB=t=>t.checked?1:0,rB=t=>t.checked?t.value:null,iB=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,oB=(t,e)=>{const n=tt();if(!n)return;const r=i=>{e.input==="select"?aB(n,qp(i),e):e.input==="radio"&&lB(n,qp(i),e)};t0(e.inputOptions)||n0(e.inputOptions)?(Lc(Vo()),Df(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):uu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},sB=(t,e)=>{const n=t.getInput();n&&(Kn(n),Df(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,xn(n),n.focus(),t.hideLoading()}).catch(r=>{uu(`Error in inputValue promise: ${r}`),n.value="",xn(n),n.focus(),t.hideLoading()}))};function aB(t,e,n){const r=ya(t,z.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,qr(l,s),l.selected=GA(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function lB(t,e,n){const r=ya(t,z.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=z.radio,l.value=s,GA(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");qr(c,a),c.className=z.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const qp=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=qp(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=qp(r)),e.push([n,r])}),e},GA=(t,e)=>!!e&&e.toString()===t.toString(),uB=t=>{const e=Et.innerParams.get(t);t.disableButtons(),e.input?KA(t,"confirm"):g0(t,!0)},cB=t=>{const e=Et.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?KA(t,"deny"):f0(t,!1)},hB=(t,e)=>{t.disableButtons(),e(Jc.cancel)},KA=(t,e)=>{const n=Et.innerParams.get(t);if(!n.input){uu(`The "input" parameter is needed to be set when using returnInputValueOn${e0(e)}`);return}const r=t.getInput(),i=tB(t,n);n.inputValidator?dB(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?f0(t,i):g0(t,i)},dB=(t,e,n)=>{const r=Et.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Df(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?f0(t,e):g0(t,e)})},f0=(t,e)=>{const n=Et.innerParams.get(t||void 0);n.showLoaderOnDeny&&Lc(cu()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Df(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),Vf(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>qA(t||void 0,i))):t.close({isDenied:!0,value:e})},J_=(t,e)=>{t.close({isConfirmed:!0,value:e})},qA=(t,e)=>{t.rejectPromise(e)},g0=(t,e)=>{const n=Et.innerParams.get(t||void 0);n.showLoaderOnConfirm&&Lc(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Df(n.preConfirm(e,n.validationMessage))).then(i=>{Ir(iv())||i===!1?(t.hideLoading(),Vf(t)):J_(t,typeof i>"u"?e:i)}).catch(i=>qA(t||void 0,i))):J_(t,e)};function Xp(){const t=Et.innerParams.get(this);if(!t)return;const e=Et.domCache.get(this);Kn(e.loader),sv()?t.icon&&xn(Kc()):fB(e),pi([e.popup,e.actions],z.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const fB=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?xn(e[0],"inline-block"):WV()&&Kn(t.actions)};function XA(){const t=Et.innerParams.get(this),e=Et.domCache.get(this);return e?av(e.popup,t.input):null}function JA(t,e,n){const r=Et.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function ZA(t,e){const n=tt();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${z.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function QA(){JA(this,["confirmButton","denyButton","cancelButton"],!1)}function eH(){JA(this,["confirmButton","denyButton","cancelButton"],!0)}function tH(){ZA(this.getInput(),!1)}function nH(){ZA(this.getInput(),!0)}function rH(t){const e=Et.domCache.get(this),n=Et.innerParams.get(this);qr(e.validationMessage,t),e.validationMessage.className=z["validation-message"],n.customClass&&n.customClass.validationMessage&&lt(e.validationMessage,n.customClass.validationMessage),xn(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",z["validation-message"]),xA(r),lt(r,z.inputerror))}function iH(){const t=Et.domCache.get(this);t.validationMessage&&Kn(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),pi(e,z.inputerror))}const Mc={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},gB=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],mB={allowEnterKey:void 0},pB=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],oH=t=>Object.prototype.hasOwnProperty.call(Mc,t),sH=t=>gB.indexOf(t)!==-1,aH=t=>mB[t],wB=t=>{oH(t)||ar(`Unknown parameter "${t}"`)},vB=t=>{pB.includes(t)&&ar(`The parameter "${t}" is incompatible with toasts`)},yB=t=>{const e=aH(t);e&&TA(t,e)},lH=t=>{t.backdrop===!1&&t.allowOutsideClick&&ar('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&ar(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)wB(e),t.toast&&vB(e),yB(e)};function uH(t){const e=cr(),n=tt(),r=Et.innerParams.get(this);if(!n||Os(n,r.hideClass.popup)){ar("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=CB(t),o=Object.assign({},r,i);lH(o),e.dataset.swal2Theme=o.theme,FA(this,o),Et.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const CB=t=>{const e={};return Object.keys(t).forEach(n=>{sH(n)?e[n]=t[n]:ar(`Invalid parameter to update: ${n}`)}),e};function cH(){const t=Et.domCache.get(this),e=Et.innerParams.get(this);if(!e){hH(this);return}t.popup&&Se.swalCloseEventFinishedCallback&&(Se.swalCloseEventFinishedCallback(),delete Se.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Se.eventEmitter.emit("didDestroy"),bB(this)}const bB=t=>{hH(t),delete t.params,delete Se.keydownHandler,delete Se.keydownTarget,delete Se.currentInstance},hH=t=>{t.isAwaitingPromise?(my(Et,t),t.isAwaitingPromise=!0):(my($c,t),my(Et,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},my=(t,e)=>{for(const n in t)t[n].delete(e)};var SB=Object.freeze({__proto__:null,_destroy:cH,close:Ca,closeModal:Ca,closePopup:Ca,closeToast:Ca,disableButtons:eH,disableInput:nH,disableLoading:Xp,enableButtons:QA,enableInput:tH,getInput:XA,handleAwaitingPromise:Vf,hideLoading:Xp,rejectPromise:YA,resetValidationMessage:iH,showValidationMessage:rH,update:uH});const RB=(t,e,n)=>{t.toast?EB(t,e,n):(MB(e),_B(e),PB(t,e,n))},EB=(t,e,n)=>{e.popup.onclick=()=>{t&&(TB(t)||t.timer||t.input)||n(Jc.close)}},TB=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let Jp=!1;const MB=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(Jp=!0)}}},_B=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(Jp=!0)}}},PB=(t,e,n)=>{e.container.onclick=r=>{if(Jp){Jp=!1;return}r.target===e.container&&rv(t.allowOutsideClick)&&n(Jc.backdrop)}},xB=t=>typeof t=="object"&&t.jquery,Z_=t=>t instanceof Element||xB(t),OB=t=>{const e={};return typeof t[0]=="object"&&!Z_(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||Z_(i)?e[n]=i:i!==void 0&&uu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function IB(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function AB(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const HB=()=>Se.timeout&&Se.timeout.getTimerLeft(),dH=()=>{if(Se.timeout)return BV(),Se.timeout.stop()},fH=()=>{if(Se.timeout){const t=Se.timeout.start();return u0(t),t}},NB=()=>{const t=Se.timeout;return t&&(t.running?dH():fH())},DB=t=>{if(Se.timeout){const e=Se.timeout.increase(t);return u0(e,!0),e}},kB=()=>!!(Se.timeout&&Se.timeout.isRunning());let Q_=!1;const ES={};function $B(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";ES[t]=this,Q_||(document.body.addEventListener("click",LB),Q_=!0)}const LB=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in ES){const r=e.getAttribute(n);if(r){ES[n].fire({template:r});return}}};class FB{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Se.eventEmitter=new FB;const VB=(t,e)=>{Se.eventEmitter.on(t,e)},WB=(t,e)=>{Se.eventEmitter.once(t,e)},BB=(t,e)=>{if(!t){Se.eventEmitter.reset();return}e?Se.eventEmitter.removeListener(t,e):Se.eventEmitter.removeAllListeners(t)};var jB=Object.freeze({__proto__:null,argsToParams:OB,bindClickHandler:$B,clickCancel:OW,clickConfirm:VA,clickDeny:xW,enableLoading:Lc,fire:IB,getActions:$f,getCancelButton:qc,getCloseButton:o0,getConfirmButton:Vo,getContainer:cr,getDenyButton:cu,getFocusableElements:s0,getFooter:PA,getHtmlContainer:r0,getIcon:Kc,getIconContent:kV,getImage:_A,getInputLabel:$V,getLoader:Xc,getPopup:tt,getProgressSteps:i0,getTimerLeft:HB,getTimerProgressBar:ov,getTitle:MA,getValidationMessage:iv,increaseTimer:DB,isDeprecatedParameter:aH,isLoading:FV,isTimerRunning:kB,isUpdatableParameter:sH,isValidParameter:oH,isVisible:PW,mixin:AB,off:BB,on:VB,once:WB,resumeTimer:fH,showLoading:Lc,stopTimer:dH,toggleTimer:NB});class UB{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const gH=["swal-title","swal-html","swal-footer"],zB=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return QB(n),Object.assign(YB(n),GB(n),KB(n),qB(n),XB(n),JB(n),ZB(n,gH))},YB=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{Ql(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof Mc[i]=="boolean"?e[i]=o!=="false":typeof Mc[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},GB=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},KB=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{Ql(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${e0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},qB=t=>{const e={},n=t.querySelector("swal-image");return n&&(Ql(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},XB=t=>{const e={},n=t.querySelector("swal-icon");return n&&(Ql(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},JB=t=>{const e={},n=t.querySelector("swal-input");n&&(Ql(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{Ql(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},ZB=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(Ql(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},QB=t=>{const e=gH.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||ar(`Unrecognized element <${r}>`)})},Ql=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&ar([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},mH=10,e2=t=>{const e=cr(),n=tt();typeof t.willOpen=="function"&&t.willOpen(n),Se.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;r2(e,n,t),setTimeout(()=>{t2(e,n)},mH),a0()&&(n2(e,t.scrollbarPadding,i),LW()),!sv()&&!Se.previousActiveElement&&(Se.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Se.eventEmitter.emit("didOpen",n),pi(e,z["no-transition"])},Zp=t=>{const e=tt();if(t.target!==e)return;const n=cr();e.removeEventListener("animationend",Zp),e.removeEventListener("transitionend",Zp),n.style.overflowY="auto"},t2=(t,e)=>{IA(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",Zp),e.addEventListener("transitionend",Zp)):t.style.overflowY="auto"},n2=(t,e,n)=>{FW(),e&&n!=="hidden"&&YW(n),setTimeout(()=>{t.scrollTop=0})},r2=(t,e,n)=>{lt(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),xn(e,"grid"),setTimeout(()=>{lt(e,n.showClass.popup),e.style.removeProperty("opacity")},mH)):xn(e,"grid"),lt([document.documentElement,document.body],z.shown),n.heightAuto&&n.backdrop&&!n.toast&&lt([document.documentElement,document.body],z["height-auto"])};var eP={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function i2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=eP.email),t.input==="url"&&(t.inputValidator=eP.url))}function o2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(ar('Target parameter is not valid, defaulting to "body"'),t.target="body")}function s2(t){i2(t),t.showLoaderOnConfirm&&!t.preConfirm&&ar(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),o2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),XV(t)}let Mo;var bg=new WeakMap;class sn{constructor(){if(PV(this,bg,void 0),typeof window>"u")return;Mo=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,xV(bg,this,this._main(Mo.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(lH(Object.assign({},n,e)),Se.currentInstance){const o=$c.swalPromiseResolve.get(Se.currentInstance),{isAwaitingPromise:s}=Se.currentInstance;Se.currentInstance._destroy(),s||o({isDismissed:!0}),a0()&&jA()}Se.currentInstance=Mo;const r=l2(e,n);s2(r),Object.freeze(r),Se.timeout&&(Se.timeout.stop(),delete Se.timeout),clearTimeout(Se.restoreFocusTimeout);const i=u2(Mo);return FA(Mo,r),Et.innerParams.set(Mo,r),a2(Mo,i,r)}then(e){return j_(bg,this).then(e)}finally(e){return j_(bg,this).finally(e)}}const a2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};$c.swalPromiseResolve.set(t,r),$c.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{uB(t)},e.denyButton.onclick=()=>{cB(t)},e.cancelButton.onclick=()=>{hB(t,o)},e.closeButton.onclick=()=>{o(Jc.close)},RB(n,e,o),IW(Se,n,o),eB(t,n),e2(n),c2(Se,n,o),h2(e,n),setTimeout(()=>{e.container.scrollTop=0})}),l2=(t,e)=>{const n=zB(t),r=Object.assign({},Mc,e,n,t);return r.showClass=Object.assign({},Mc.showClass,r.showClass),r.hideClass=Object.assign({},Mc.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},u2=t=>{const e={popup:tt(),container:cr(),actions:$f(),confirmButton:Vo(),denyButton:cu(),cancelButton:qc(),loader:Xc(),closeButton:o0(),validationMessage:iv(),progressSteps:i0()};return Et.domCache.set(t,e),e},c2=(t,e,n)=>{const r=ov();Kn(r),e.timer&&(t.timeout=new UB(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(xn(r),Gr(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&u0(e.timer)})))},h2=(t,e)=>{if(!e.toast){if(!rv(e.allowEnterKey)){TA("allowEnterKey"),g2();return}d2(t)||f2(t,e)||RS(-1,1)}},d2=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&Ir(n))return n.focus(),!0;return!1},f2=(t,e)=>e.focusDeny&&Ir(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Ir(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&Ir(t.confirmButton)?(t.confirmButton.focus(),!0):!1,g2=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}sn.prototype.disableButtons=eH;sn.prototype.enableButtons=QA;sn.prototype.getInput=XA;sn.prototype.disableInput=nH;sn.prototype.enableInput=tH;sn.prototype.hideLoading=Xp;sn.prototype.disableLoading=Xp;sn.prototype.showValidationMessage=rH;sn.prototype.resetValidationMessage=iH;sn.prototype.close=Ca;sn.prototype.closePopup=Ca;sn.prototype.closeModal=Ca;sn.prototype.closeToast=Ca;sn.prototype.rejectPromise=YA;sn.prototype.update=uH;sn.prototype._destroy=cH;Object.assign(sn,jB);Object.keys(SB).forEach(t=>{sn[t]=function(){return Mo&&Mo[t]?Mo[t](...arguments):null}});sn.DismissReason=Jc;sn.version="11.21.0";const Qt=sn;Qt.default=Qt;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var $s=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(_){if(_=o.postProcess(_,r),i){setTimeout(function(){i(_)},0);return}else return _},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],w=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&w+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var y=-1/0,E=1/0,C=function(){for(var _=Math.max(y,-c);_<=Math.min(E,c);_+=2){var $=void 0,I=g[_-1],M=g[_+1];I&&(g[_-1]=void 0);var G=!1;if(M){var V=M.oldPos-_;G=M&&0<=V&&V<l}var W=I&&I.oldPos+1<u;if(!G&&!W){g[_]=void 0;continue}if(!W||G&&I.oldPos<M.oldPos?$=o.addToPath(M,!0,!1,0,r):$=o.addToPath(I,!1,!0,1,r),w=o.extractCommon($,n,e,_,r),$.oldPos+1>=u&&w+1>=l)return a(o.buildValues($.lastComponent,n,e))||!0;g[_]=$,$.oldPos+1>=u&&(E=Math.min(E,_-1)),w+1>=l&&(y=Math.max(y,_+1))}c++};if(i)(function _(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);C()||_()},0)})();else for(;c<=h&&Date.now()<=f;){var A=C();if(A)return A}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),m2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),p2=function(t){m2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}($s),pH=new p2;function w2(t,e,n){return pH.diff(t,e,n)}function tP(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function nP(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function TS(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function MS(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function ph(t,e){return TS(t,e,"")}function Sg(t,e){return MS(t,e,"")}function rP(t,e){return e.slice(0,v2(t,e))}function v2(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function y2(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function C2(t){return!t.includes(`\r
`)&&t.includes(`
`)}function wh(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function Us(t){var e=t.match(/^\s*/);return e?e[0]:""}var wH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qp="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",b2=new RegExp("[".concat(Qp,"]+|\\s+|[^").concat(Qp,"]"),"ug"),S2=function(t){wH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(b2)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&iP(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&iP(i,s,o,null),n},e}($s),vH=new S2;function R2(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?CH(t,e,n):vH.diff(t,e,n)}function iP(t,e,n,r){if(e&&n){var i=Us(e.value),o=wh(e.value),s=Us(n.value),a=wh(n.value);if(t){var l=tP(i,s);t.value=MS(t.value,s,l),e.value=ph(e.value,l),n.value=ph(n.value,l)}if(r){var u=nP(o,a);r.value=TS(r.value,a,u),e.value=Sg(e.value,u),n.value=Sg(n.value,u)}}else if(n){if(t){var c=Us(n.value);n.value=n.value.substring(c.length)}if(r){var c=Us(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=Us(r.value),d=Us(e.value),f=wh(e.value),g=tP(h,d);e.value=ph(e.value,g);var w=nP(ph(h,g),f);e.value=Sg(e.value,w),r.value=TS(r.value,h,w),t.value=MS(t.value,h,h.slice(0,h.length-w.length))}else if(r){var y=Us(r.value),E=wh(e.value),C=rP(E,y);e.value=Sg(e.value,C)}else if(t){var A=wh(t.value),_=Us(e.value),C=rP(A,_);e.value=ph(e.value,C)}}var E2=function(t){wH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(Qp,"]+|[^\\S\\n\\r]+|[^").concat(Qp,"]"),"ug");return n.match(r)||[]},e}($s),yH=new E2;function CH(t,e,n){return yH.diff(t,e,n)}function T2(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var M2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_2=function(t){M2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=bH,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}($s),m0=new _2;function lf(t,e,n){return m0.diff(t,e,n)}function P2(t,e,n){return n=T2(n,{ignoreWhitespace:!0}),m0.diff(t,e,n)}function bH(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var x2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),O2=function(t){x2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}($s),SH=new O2;function I2(t,e,n){return SH.diff(t,e,n)}var A2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),H2=function(t){A2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}($s),RH=new H2;function N2(t,e,n){return RH.diff(t,e,n)}var D2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),k2=function(t){D2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=bH,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(ew(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}($s),EH=new k2;function $2(t,e,n){return EH.diff(t,e,n)}function ew(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=ew(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=ew(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var L2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),F2=function(t){L2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}($s),TH=new F2;function V2(t,e,n){return TH.diff(t,e,n)}var Do=function(){return Do=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Do.apply(this,arguments)};function MH(t){return Array.isArray(t)?t.map(function(e){return MH(e)}):Do(Do({},t),{hunks:t.hunks.map(function(e){return Do(Do({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function _H(t){return Array.isArray(t)?t.map(function(e){return _H(e)}):Do(Do({},t),{hunks:t.hunks.map(function(e){return Do(Do({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function W2(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function B2(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function p0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function j2(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function PH(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=p0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return U2(t,r[0],n)}function U2(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(y2(t)&&W2(e)?e=MH(e):C2(t)&&B2(e)&&(e=_H(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(G,V,W,Q){return V===Q},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(G,V,W,Q,J,ee,se){Q===void 0&&(Q=0),J===void 0&&(J=!0),ee===void 0&&(ee=[]),se===void 0&&(se=0);for(var be=0,gt=!1;Q<G.length;Q++){var Re=G[Q],Ae=Re.length>0?Re[0]:" ",it=Re.length>0?Re.substr(1):Re;if(Ae==="-")if(o(V+1,r[V],Ae,it))V++,be=0;else return!W||r[V]==null?null:(ee[se]=r[V],f(G,V+1,W-1,Q,!1,ee,se+1));if(Ae==="+"){if(!J)return null;ee[se]=it,se++,be=0,gt=!0}if(Ae===" ")if(be++,ee[se]=r[V],o(V+1,r[V],Ae,it))se++,J=!0,gt=!1,V++;else return gt||!W?null:r[V]&&(f(G,V+1,W-1,Q+1,!1,ee,se+1)||f(G,V+1,W-1,Q,!1,ee,se+1))||f(G,V,W-1,Q+1,!1,ee,se)}return se-=be,V-=be,ee.length=se,{patchedLines:ee,oldLineLastI:V-1}}for(var g=[],w=0,h=0;h<i.length;h++){for(var y=i[h],E=void 0,C=r.length-y.oldLines+s,A=void 0,_=0;_<=s;_++){A=y.oldStart+w-1;for(var $=j2(A,a,C);A!==void 0&&(E=f(y.lines,A,_),!E);A=$());if(E)break}if(!E)return!1;for(var I=a;I<A;I++)g.push(r[I]);for(var M=0;M<E.patchedLines.length;M++){var d=E.patchedLines[M];g.push(d)}a=E.oldLineLastI+1,w=A+1-y.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function z2(t,e){var n=typeof t=="string"?p0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=PH(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var tw=function(){return tw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},tw.apply(this,arguments)};function xH(t){return Array.isArray(t)?t.map(function(e){return xH(e)}).reverse():tw(tw({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var Fc=function(){return Fc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Fc.apply(this,arguments)};function _S(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;lf(n,r,Fc(Fc({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(lf(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(Ae){return Ae.map(function(it){return" "+it})}for(var f=[],g=0,w=0,y=[],E=1,C=1,A=0;A<h.length;A++){var _=h[A],$=_.lines||G2(_.value);if(_.lines=$,_.added||_.removed){if(!g){var I=h[A-1];g=E,w=C,I&&(y=l>0?d(I.lines.slice(-l)):[],g-=y.length,w-=y.length)}for(var M=0,G=$;M<G.length;M++){var V=G[M];y.push((_.added?"+":"-")+V)}_.added?C+=$.length:E+=$.length}else{if(g)if($.length<=l*2&&A<h.length-2)for(var W=0,Q=d($);W<Q.length;W++){var V=Q[W];y.push(V)}else{for(var J=Math.min($.length,l),ee=0,se=d($.slice(0,J));ee<se.length;ee++){var V=se[ee];y.push(V)}var be={oldStart:g,oldLines:E-g+J,newStart:w,newLines:C-w+J,lines:y};f.push(be),g=0,w=0,y=[]}E+=$.length,C+=$.length}}for(var gt=0,Re=f;gt<Re.length;gt++)for(var be=Re[gt],A=0;A<be.lines.length;A++)be.lines[A].endsWith(`
`)?be.lines[A]=be.lines[A].slice(0,-1):(be.lines.splice(A+1,0,"\\ No newline at end of file"),A++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function nw(t){if(Array.isArray(t))return t.map(nw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function OH(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;_S(t,e,n,r,i,o,Fc(Fc({},s),{callback:function(u){l(u?nw(u):void 0)}}))}else{var a=_S(t,e,n,r,i,o,s);return a?nw(a):void 0}}function Y2(t,e,n,r,i,o){return OH(t,t,e,n,r,i,o)}function G2(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function K2(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function q2(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(X2(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function X2(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const J2=Object.freeze(Object.defineProperty({__proto__:null,Diff:$s,applyPatch:PH,applyPatches:z2,arrayDiff:TH,canonicalize:ew,characterDiff:pH,convertChangesToDMP:K2,convertChangesToXML:q2,createPatch:Y2,createTwoFilesPatch:OH,cssDiff:RH,diffArrays:V2,diffChars:w2,diffCss:N2,diffJson:$2,diffLines:lf,diffSentences:I2,diffTrimmedLines:P2,diffWords:R2,diffWordsWithSpace:CH,formatPatch:nw,jsonDiff:EH,lineDiff:m0,parsePatch:p0,reversePatch:xH,sentenceDiff:SH,structuredPatch:_S,wordDiff:vH,wordsWithSpaceDiff:yH},Symbol.toStringTag,{value:"Module"}));function Z2(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[]}=t;let i="",o="",s=[];const a=(c,h=2)=>{const d=f=>{if(typeof f!="object"||f===null)return f;if(Array.isArray(f))return f.map(d);const g={};return Object.keys(f).forEach(w=>{g[w]=d(f[w])}),g};try{return JSON.stringify(d(c),null,h)}catch(f){return console.error("Error stringifying object while preserving key order:",f),JSON.stringify(c,null,h)}};function l(c){return c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}if(n&&n.left!==void 0&&n.right!==void 0)if(typeof J2>"u"||typeof lf!="function")console.error("Diff 라이브러리(jsdiff)가 제대로 import되지 않았거나 전역으로 사용 불가능합니다."),o='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다. (Diff is not defined)</p>',i='<div class="diff-popup-header error">라이브러리 오류</div>';else try{const c=a(n.left),h=a(n.right),d=lf(c,h);let f=0,g=0;d.forEach(V=>{const W=V.value||"",Q=W.split(`
`);let J=Q.length;Q[Q.length-1]===""&&W.length>0&&(J-=1),W===""&&(J=0),V.added?f+=J:V.removed&&(g+=J)});const w=[];let y=1,E=1;d.forEach((V,W)=>{const Q=V.value||"",J=Q.split(`
`);let ee=J.length;J[J.length-1]===""&&Q.length>0&&(ee-=1),Q===""&&(ee=0),V.removed?(w.push({originalPartIndex:W,part:V,sourceType:"del",lineNumber:y,numLines:ee}),y+=ee):V.added?(w.push({originalPartIndex:W,part:V,sourceType:"ins",lineNumber:E,numLines:ee}),E+=ee):(y+=ee,E+=ee)}),s=[];let C=[...w],A=null;for(C.length>0&&(C.sort((V,W)=>V.lineNumber!==W.lineNumber?V.lineNumber-W.lineNumber:V.sourceType==="del"&&W.sourceType!=="del"?-1:V.sourceType!=="del"&&W.sourceType==="del"?1:V.originalPartIndex-W.originalPartIndex),A=C[0],s.push(A),C=C.filter(V=>V.originalPartIndex!==A.originalPartIndex));C.length>0&&A;){const V=A.lineNumber;let W=null,Q=[];for(const J of C)J.lineNumber>=V&&Q.push({...J,diff:J.lineNumber-V});if(Q.length>0)Q.sort((J,ee)=>J.diff!==ee.diff?J.diff-ee.diff:J.sourceType==="del"&&ee.sourceType!=="del"?-1:J.sourceType!=="del"&&ee.sourceType==="del"?1:J.originalPartIndex-ee.originalPartIndex),W=Q[0];else{let J=[];for(const ee of C)J.push({...ee,absDiff:Math.abs(ee.lineNumber-V)});J.length>0&&(J.sort((ee,se)=>ee.absDiff!==se.absDiff?ee.absDiff-se.absDiff:ee.lineNumber!==se.lineNumber?ee.lineNumber-se.lineNumber:ee.sourceType==="del"&&se.sourceType!=="del"?-1:ee.sourceType!=="del"&&se.sourceType==="del"?1:ee.originalPartIndex-se.originalPartIndex),W=J[0])}if(W)s.push(W),A=W,C=C.filter(J=>J.originalPartIndex!==W.originalPartIndex);else break}let _="",$="",I=1,M=1;const G=new Map;if(s.forEach((V,W)=>{G.set(V.originalPartIndex,W)}),d.forEach((V,W)=>{const Q=V.value||"",J=Q.replace(/\n$/,"").split(`
`);J.length===1&&J[0]===""&&Q!==""||J.length===1&&J[0]===""&&Q===""||J.forEach((ee,se)=>{let be="";(V.added||V.removed)&&se===0&&G.has(W)&&(be=`id="diff-nav-target-${G.get(W)}"`),V.added?(_+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,$+=`<div ${be} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${M++}</span><span class="diff-sbs-line-content">${l(ee)}</span></div>
`):V.removed?(_+=`<div ${be} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${I++}</span><span class="diff-sbs-line-content">${l(ee)}</span></div>
`,$+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(_+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${I++}</span><span class="diff-sbs-line-content">${l(ee)}</span></div>
`,$+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${M++}</span><span class="diff-sbs-line-content">${l(ee)}</span></div>
`)})}),o=`
                    <div class="diff-sbs-container">
                        <div class="diff-sbs-pane" id="diff-left-pane">${_}</div>
                        <div class="diff-sbs-pane" id="diff-right-pane">${$}</div>
                    </div>
                `,s.length>0||f>0||g>0){let V="";(f>0||g>0)&&(V=`
                            <span class="diff-summary">
                                <strong class="diff-summary-added">+${f}</strong>
                                <strong class="diff-summary-removed">-${g}</strong>
                            </span>`),i=`
                        <div class="diff-popup-header">JSON 비교 결과 (텍스트 기반 Side-by-Side)</div>
                        <div id="diff-navigation">
                            ${V}
                            <button id="prev-change-btn" class="swal2-styled">이전 변경점</button>
                            <button id="next-change-btn" class="swal2-styled">다음 변경점</button>
                            <span id="current-change-info"></span>
                        </div>`}else i='<div class="diff-popup-header">JSON 비교 결과</div>',c===h?o='<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':o='<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>'}catch(c){console.error("JSON diff 생성 또는 HTML 렌더링 중 오류:",c),o=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${c.message}</p>`,i='<div class="diff-popup-header error">오류 발생</div>'}else o='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',i='<div class="diff-popup-header error">데이터 오류</div>';const u=`
        ${i}
        <div id="diff-container">
            ${o}
        </div>`;return Q2({title:e,html:u,buttons:r,width:"95%",customClass:{popup:"custom-swal-popup-wider-text-diff",htmlContainer:"custom-swal-html-container-text-diff"},didOpen:c=>{const h=[];if(s&&s.length>0)for(let _=0;_<s.length;_++){const $=document.getElementById(`diff-nav-target-${_}`);$&&h.push($)}let d=-1,f=null;const g=document.getElementById("diff-navigation"),w=document.getElementById("next-change-btn"),y=document.getElementById("prev-change-btn"),E=document.getElementById("current-change-info");function C(){g&&(h.length===0?(w&&(w.style.display="none"),y&&(y.style.display="none"),E&&(E.textContent=totalAdded>0||totalRemoved>0?"0 / 0":"변경점 없음")):(w&&(w.style.display="inline-block"),y&&(y.style.display="inline-block")),E&&(d>=0&&d<h.length?E.textContent=`${d+1} / ${h.length}`:h.length>0?E.textContent=`0 / ${h.length}`:E.textContent="변경점 없음"),w&&(w.disabled=d>=h.length-1),y&&(y.disabled=d<=0))}function A(_){if(_<0||_>=h.length)return;f&&f.classList.remove("diff-navigation-highlight");const $=h[_];if($){const I=document.getElementById("diff-container");if(I){const M=$.offsetTop;I.scrollTop=M-I.clientHeight/2+$.clientHeight/2}else $.scrollIntoView({behavior:"auto",block:"center"});$.classList.add("diff-navigation-highlight"),f=$}d=_,C()}h.length>0?A(0):C(),w&&w.addEventListener("click",()=>{d<h.length-1&&A(d+1)}),y&&y.addEventListener("click",()=>{d>0&&A(d-1)}),c.addEventListener("keydown",_=>{h.length!==0&&(!w||!y||(_.key==="ArrowDown"||_.key==="PageDown"?(_.preventDefault(),w.disabled||w.click()):(_.key==="ArrowUp"||_.key==="PageUp")&&(_.preventDefault(),y.disabled||y.click())))}),C()}})}function Q2(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u}=t,c={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:a,preConfirm:l,didOpen:u},h=i.find(g=>g.role==="confirm"||!g.role&&i.indexOf(g)===0),d=i.find(g=>g.role==="cancel");return h?(c.showConfirmButton=!0,c.confirmButtonText=h.text||Qt.getConfirmButton().innerText,h.color&&(c.confirmButtonColor=h.color)):i.length>0||l?!i.some(g=>g.role!=="cancel")&&!l&&(c.showConfirmButton=!1):c.showConfirmButton=!1,d&&(c.showCancelButton=!0,c.cancelButtonText=d.text||Qt.getCancelButton().innerText,d.color&&(c.cancelButtonColor=d.color)),typeof Qt>"u"?(console.error("Swal (SweetAlert2)이 import되지 않았습니다."),Promise.reject("SweetAlert2 is not imported")):Qt.fire(c).then(g=>{let w={...g,formData:{}};return g.isConfirmed&&l&&(w.formData=g.value||{}),g.isConfirmed&&h&&typeof h.action=="function"&&!l?h.action():g.isDismissed&&d&&typeof d.action=="function"&&g.dismiss===Qt.DismissReason.cancel&&d.action(),w})}const Nn=document.getElementById("json-input"),ua=document.getElementById("save-message"),ba=document.getElementById("json-error"),fn=document.getElementById("tree-view"),IH=document.getElementById("table-view");function oP(t,e,n){t.textContent=e,setTimeout(()=>{t.textContent=""},n)}function _c(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(t!=null){if(i.appendChild(document.createTextNode(o)),t==="")if(e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));else{let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u,c=!0;for(;(u=l.exec(t))!==null;){const h=u[0];let d=h,f;if(c?(a=h,c=!1):h.startsWith("[")?a+=h:(a+="."+h,i.appendChild(document.createTextNode(" > "))),f=a,h.startsWith("[")&&h.endsWith("]")&&(d=h),e){const g=document.createElement("a");g.href="#",g.textContent=d,g.style.textDecoration="underline",g.style.cursor="pointer",g.onclick=w=>{w.preventDefault(),e(f)},i.appendChild(g)}else i.appendChild(document.createTextNode(d))}}i.appendChild(document.createTextNode(s))}}function ej(){fn.innerHTML="",IH.innerHTML="",ba&&(ba.textContent=""),ua&&(ua.textContent=""),_c(null)}function Vc(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function PS(t,e){if(typeof t=="string"){const n=t.trim();return n.toLowerCase()==="null"?null:n.toLowerCase()==="true"?!0:n.toLowerCase()==="false"?!1:n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,""))?Number(n):t}return t}function AH(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let Fl=null;function rw(t){Fl&&Fl.classList.remove("selected-node"),Fl=t,Fl&&Fl.classList.add("selected-node")}function tj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),rw(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),AH(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),rw(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function nj(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),uf(e,o,n,r.rootJsonData,r.depth+1,r),o}function uf(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=tj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=nj(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function rj(){return Fl?Fl.dataset.path:null}function ij(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function oj(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var Rg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},vh=function(t){return t&&t.Math===Math&&t},gn=vh(typeof globalThis=="object"&&globalThis)||vh(typeof window=="object"&&window)||vh(typeof self=="object"&&self)||vh(typeof Rg=="object"&&Rg)||vh(typeof Rg=="object"&&Rg)||function(){return this}()||Function("return this")(),w0={},On=function(t){try{return!!t()}catch{return!0}},sj=On,yi=!sj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),aj=On,lv=!aj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),lj=lv,Eg=Function.prototype.call,mn=lj?Eg.bind(Eg):function(){return Eg.apply(Eg,arguments)},HH={},NH={}.propertyIsEnumerable,DH=Object.getOwnPropertyDescriptor,uj=DH&&!NH.call({1:2},1);HH.f=uj?function(e){var n=DH(this,e);return!!n&&n.enumerable}:NH;var uv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},kH=lv,$H=Function.prototype,xS=$H.call,cj=kH&&$H.bind.bind(xS,xS),an=kH?cj:function(t){return function(){return xS.apply(t,arguments)}},LH=an,hj=LH({}.toString),dj=LH("".slice),hu=function(t){return dj(hj(t),8,-1)},fj=an,gj=On,mj=hu,py=Object,pj=fj("".split),wj=gj(function(){return!py("z").propertyIsEnumerable(0)})?function(t){return mj(t)==="String"?pj(t,""):py(t)}:py,v0=function(t){return t==null},vj=v0,yj=TypeError,Wf=function(t){if(vj(t))throw new yj("Can't call method on "+t);return t},Cj=wj,bj=Wf,Bf=function(t){return Cj(bj(t))},wy=typeof document=="object"&&document.all,pn=typeof wy>"u"&&wy!==void 0?function(t){return typeof t=="function"||t===wy}:function(t){return typeof t=="function"},Sj=pn,Ci=function(t){return typeof t=="object"?t!==null:Sj(t)},vy=gn,Rj=pn,Ej=function(t){return Rj(t)?t:void 0},Zc=function(t,e){return arguments.length<2?Ej(vy[t]):vy[t]&&vy[t][e]},Tj=an,jf=Tj({}.isPrototypeOf),Mj=gn,sP=Mj.navigator,aP=sP&&sP.userAgent,cv=aP?String(aP):"",FH=gn,yy=cv,lP=FH.process,uP=FH.Deno,cP=lP&&lP.versions||uP&&uP.version,hP=cP&&cP.v8,Ui,iw;hP&&(Ui=hP.split("."),iw=Ui[0]>0&&Ui[0]<4?1:+(Ui[0]+Ui[1]));!iw&&yy&&(Ui=yy.match(/Edge\/(\d+)/),(!Ui||Ui[1]>=74)&&(Ui=yy.match(/Chrome\/(\d+)/),Ui&&(iw=+Ui[1])));var _j=iw,dP=_j,Pj=On,xj=gn,Oj=xj.String,y0=!!Object.getOwnPropertySymbols&&!Pj(function(){var t=Symbol("symbol detection");return!Oj(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&dP&&dP<41}),Ij=y0,VH=Ij&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Aj=Zc,Hj=pn,Nj=jf,Dj=VH,kj=Object,C0=Dj?function(t){return typeof t=="symbol"}:function(t){var e=Aj("Symbol");return Hj(e)&&Nj(e.prototype,kj(t))},$j=String,hv=function(t){try{return $j(t)}catch{return"Object"}},Lj=pn,Fj=hv,Vj=TypeError,Ar=function(t){if(Lj(t))return t;throw new Vj(Fj(t)+" is not a function")},Wj=Ar,Bj=v0,Uf=function(t,e){var n=t[e];return Bj(n)?void 0:Wj(n)},Cy=mn,by=pn,Sy=Ci,jj=TypeError,Uj=function(t,e){var n,r;if(e==="string"&&by(n=t.toString)&&!Sy(r=Cy(n,t))||by(n=t.valueOf)&&!Sy(r=Cy(n,t))||e!=="string"&&by(n=t.toString)&&!Sy(r=Cy(n,t)))return r;throw new jj("Can't convert object to primitive value")},WH={exports:{}},fP=gn,zj=Object.defineProperty,b0=function(t,e){try{zj(fP,t,{value:e,configurable:!0,writable:!0})}catch{fP[t]=e}return e},Yj=gn,Gj=b0,gP="__core-js_shared__",mP=WH.exports=Yj[gP]||Gj(gP,{});(mP.versions||(mP.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var S0=WH.exports,pP=S0,BH=function(t,e){return pP[t]||(pP[t]=e||{})},Kj=Wf,qj=Object,Qc=function(t){return qj(Kj(t))},Xj=an,Jj=Qc,Zj=Xj({}.hasOwnProperty),bi=Object.hasOwn||function(e,n){return Zj(Jj(e),n)},Qj=an,eU=0,tU=Math.random(),nU=Qj(1 .toString),jH=function(t){return"Symbol("+(t===void 0?"":t)+")_"+nU(++eU+tU,36)},rU=gn,iU=BH,wP=bi,oU=jH,sU=y0,aU=VH,vc=rU.Symbol,Ry=iU("wks"),lU=aU?vc.for||vc:vc&&vc.withoutSetter||oU,Ji=function(t){return wP(Ry,t)||(Ry[t]=sU&&wP(vc,t)?vc[t]:lU("Symbol."+t)),Ry[t]},uU=mn,vP=Ci,yP=C0,cU=Uf,hU=Uj,dU=Ji,fU=TypeError,gU=dU("toPrimitive"),mU=function(t,e){if(!vP(t)||yP(t))return t;var n=cU(t,gU),r;if(n){if(e===void 0&&(e="default"),r=uU(n,t,e),!vP(r)||yP(r))return r;throw new fU("Can't convert object to primitive value")}return e===void 0&&(e="number"),hU(t,e)},pU=mU,wU=C0,UH=function(t){var e=pU(t,"string");return wU(e)?e:e+""},vU=gn,CP=Ci,OS=vU.document,yU=CP(OS)&&CP(OS.createElement),R0=function(t){return yU?OS.createElement(t):{}},CU=yi,bU=On,SU=R0,zH=!CU&&!bU(function(){return Object.defineProperty(SU("div"),"a",{get:function(){return 7}}).a!==7}),RU=yi,EU=mn,TU=HH,MU=uv,_U=Bf,PU=UH,xU=bi,OU=zH,bP=Object.getOwnPropertyDescriptor;w0.f=RU?bP:function(e,n){if(e=_U(e),n=PU(n),OU)try{return bP(e,n)}catch{}if(xU(e,n))return MU(!EU(TU.f,e,n),e[n])};var Ls={},IU=yi,AU=On,YH=IU&&AU(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),HU=Ci,NU=String,DU=TypeError,wn=function(t){if(HU(t))return t;throw new DU(NU(t)+" is not an object")},kU=yi,$U=zH,LU=YH,Tg=wn,SP=UH,FU=TypeError,Ey=Object.defineProperty,VU=Object.getOwnPropertyDescriptor,Ty="enumerable",My="configurable",_y="writable";Ls.f=kU?LU?function(e,n,r){if(Tg(e),n=SP(n),Tg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&_y in r&&!r[_y]){var i=VU(e,n);i&&i[_y]&&(e[n]=r.value,r={configurable:My in r?r[My]:i[My],enumerable:Ty in r?r[Ty]:i[Ty],writable:!1})}return Ey(e,n,r)}:Ey:function(e,n,r){if(Tg(e),n=SP(n),Tg(r),$U)try{return Ey(e,n,r)}catch{}if("get"in r||"set"in r)throw new FU("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var WU=yi,BU=Ls,jU=uv,eh=WU?function(t,e,n){return BU.f(t,e,jU(1,n))}:function(t,e,n){return t[e]=n,t},GH={exports:{}},IS=yi,UU=bi,KH=Function.prototype,zU=IS&&Object.getOwnPropertyDescriptor,YU=UU(KH,"name"),GU=YU&&(!IS||IS&&zU(KH,"name").configurable),KU={CONFIGURABLE:GU},qU=an,XU=pn,AS=S0,JU=qU(Function.toString);XU(AS.inspectSource)||(AS.inspectSource=function(t){return JU(t)});var ZU=AS.inspectSource,QU=gn,ez=pn,RP=QU.WeakMap,tz=ez(RP)&&/native code/.test(String(RP)),nz=BH,rz=jH,EP=nz("keys"),E0=function(t){return EP[t]||(EP[t]=rz(t))},T0={},iz=tz,qH=gn,oz=Ci,sz=eh,Py=bi,xy=S0,az=E0,lz=T0,TP="Object already initialized",HS=qH.TypeError,uz=qH.WeakMap,ow,cf,sw,cz=function(t){return sw(t)?cf(t):ow(t,{})},hz=function(t){return function(e){var n;if(!oz(e)||(n=cf(e)).type!==t)throw new HS("Incompatible receiver, "+t+" required");return n}};if(iz||xy.state){var no=xy.state||(xy.state=new uz);no.get=no.get,no.has=no.has,no.set=no.set,ow=function(t,e){if(no.has(t))throw new HS(TP);return e.facade=t,no.set(t,e),e},cf=function(t){return no.get(t)||{}},sw=function(t){return no.has(t)}}else{var Tu=az("state");lz[Tu]=!0,ow=function(t,e){if(Py(t,Tu))throw new HS(TP);return e.facade=t,sz(t,Tu,e),e},cf=function(t){return Py(t,Tu)?t[Tu]:{}},sw=function(t){return Py(t,Tu)}}var XH={set:ow,get:cf,has:sw,enforce:cz,getterFor:hz},M0=an,dz=On,fz=pn,Mg=bi,NS=yi,gz=KU.CONFIGURABLE,mz=ZU,JH=XH,pz=JH.enforce,wz=JH.get,MP=String,mp=Object.defineProperty,vz=M0("".slice),yz=M0("".replace),Cz=M0([].join),bz=NS&&!dz(function(){return mp(function(){},"length",{value:8}).length!==8}),Sz=String(String).split("String"),Rz=GH.exports=function(t,e,n){vz(MP(e),0,7)==="Symbol("&&(e="["+yz(MP(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Mg(t,"name")||gz&&t.name!==e)&&(NS?mp(t,"name",{value:e,configurable:!0}):t.name=e),bz&&n&&Mg(n,"arity")&&t.length!==n.arity&&mp(t,"length",{value:n.arity});try{n&&Mg(n,"constructor")&&n.constructor?NS&&mp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=pz(t);return Mg(r,"source")||(r.source=Cz(Sz,typeof e=="string"?e:"")),t};Function.prototype.toString=Rz(function(){return fz(this)&&wz(this).source||mz(this)},"toString");var ZH=GH.exports,Ez=pn,Tz=Ls,Mz=ZH,_z=b0,_0=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Ez(n)&&Mz(n,o,r),r.global)i?t[e]=n:_z(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:Tz.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},QH={},Pz=Math.ceil,xz=Math.floor,Oz=Math.trunc||function(e){var n=+e;return(n>0?xz:Pz)(n)},Iz=Oz,zf=function(t){var e=+t;return e!==e||e===0?0:Iz(e)},Az=zf,Hz=Math.max,Nz=Math.min,Dz=function(t,e){var n=Az(t);return n<0?Hz(n+e,0):Nz(n,e)},kz=zf,$z=Math.min,Lz=function(t){var e=kz(t);return e>0?$z(e,9007199254740991):0},Fz=Lz,th=function(t){return Fz(t.length)},Vz=Bf,Wz=Dz,Bz=th,jz=function(t){return function(e,n,r){var i=Vz(e),o=Bz(i);if(o===0)return!t&&-1;var s=Wz(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Uz={indexOf:jz(!1)},zz=an,Oy=bi,Yz=Bf,Gz=Uz.indexOf,Kz=T0,_P=zz([].push),eN=function(t,e){var n=Yz(t),r=0,i=[],o;for(o in n)!Oy(Kz,o)&&Oy(n,o)&&_P(i,o);for(;e.length>r;)Oy(n,o=e[r++])&&(~Gz(i,o)||_P(i,o));return i},P0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],qz=eN,Xz=P0,Jz=Xz.concat("length","prototype");QH.f=Object.getOwnPropertyNames||function(e){return qz(e,Jz)};var tN={};tN.f=Object.getOwnPropertySymbols;var Zz=Zc,Qz=an,eY=QH,tY=tN,nY=wn,rY=Qz([].concat),iY=Zz("Reflect","ownKeys")||function(e){var n=eY.f(nY(e)),r=tY.f;return r?rY(n,r(e)):n},PP=bi,oY=iY,sY=w0,aY=Ls,nN=function(t,e,n){for(var r=oY(e),i=aY.f,o=sY.f,s=0;s<r.length;s++){var a=r[s];!PP(t,a)&&!(n&&PP(n,a))&&i(t,a,o(e,a))}},lY=On,uY=pn,cY=/#|\.prototype\./,Yf=function(t,e){var n=dY[hY(t)];return n===gY?!0:n===fY?!1:uY(e)?lY(e):!!e},hY=Yf.normalize=function(t){return String(t).replace(cY,".").toLowerCase()},dY=Yf.data={},fY=Yf.NATIVE="N",gY=Yf.POLYFILL="P",mY=Yf,_g=gn,pY=w0.f,wY=eh,vY=_0,yY=b0,CY=nN,bY=mY,yt=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=_g:i?s=_g[n]||yY(n,{}):s=_g[n]&&_g[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=pY(s,a),l=c&&c.value):l=s[a],o=bY(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;CY(u,l)}(t.sham||l&&l.sham)&&wY(u,"sham",!0),vY(s,a,u,t)}},SY=lv,rN=Function.prototype,xP=rN.apply,OP=rN.call,Gf=typeof Reflect=="object"&&Reflect.apply||(SY?OP.bind(xP):function(){return OP.apply(xP,arguments)}),RY=an,EY=Ar,iN=function(t,e,n){try{return RY(EY(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},TY=Ci,MY=function(t){return TY(t)||t===null},_Y=MY,PY=String,xY=TypeError,OY=function(t){if(_Y(t))return t;throw new xY("Can't set "+PY(t)+" as a prototype")},IY=iN,AY=Ci,HY=Wf,NY=OY,oN=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=IY(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return HY(i),NY(o),AY(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),DY=Ls.f,kY=function(t,e,n){n in t||DY(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},$Y=pn,LY=Ci,IP=oN,FY=function(t,e,n){var r,i;return IP&&$Y(r=e.constructor)&&r!==n&&LY(i=r.prototype)&&i!==n.prototype&&IP(t,i),t},VY=Ji,WY=VY("toStringTag"),sN={};sN[WY]="z";var BY=String(sN)==="[object z]",jY=BY,UY=pn,pp=hu,zY=Ji,YY=zY("toStringTag"),GY=Object,KY=pp(function(){return arguments}())==="Arguments",qY=function(t,e){try{return t[e]}catch{}},aN=jY?pp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=qY(e=GY(t),YY))=="string"?n:KY?pp(e):(r=pp(e))==="Object"&&UY(e.callee)?"Arguments":r},XY=aN,JY=String,dv=function(t){if(XY(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return JY(t)},ZY=dv,QY=function(t,e){return t===void 0?arguments.length<2?"":e:ZY(t)},eG=Ci,tG=eh,nG=function(t,e){eG(e)&&"cause"in e&&tG(t,"cause",e.cause)},rG=an,lN=Error,iG=rG("".replace),oG=function(t){return String(new lN(t).stack)}("zxcasd"),uN=/\n\s*at [^:]*:[^\n]*/,sG=uN.test(oG),aG=function(t,e){if(sG&&typeof t=="string"&&!lN.prepareStackTrace)for(;e--;)t=iG(t,uN,"");return t},lG=On,uG=uv,cG=!lG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",uG(1,7)),t.stack!==7):!0}),hG=eh,dG=aG,fG=cG,AP=Error.captureStackTrace,gG=function(t,e,n,r){fG&&(AP?AP(t,e):hG(t,"stack",dG(n,r)))},HP=Zc,mG=bi,NP=eh,pG=jf,DP=oN,kP=nN,$P=kY,wG=FY,vG=QY,yG=nG,CG=gG,bG=yi,SG=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=HP.apply(null,s);if(l){var u=l.prototype;if(mG(u,"cause")&&delete u.cause,!n)return l;var c=HP("Error"),h=e(function(d,f){var g=vG(r?f:d,void 0),w=r?new l(d):new l;return g!==void 0&&NP(w,"message",g),CG(w,h,w.stack,2),this&&pG(u,this)&&wG(w,this,h),arguments.length>o&&yG(w,arguments[o]),w});h.prototype=u,a!=="Error"?DP?DP(h,c):kP(h,c,{name:!0}):bG&&i in l&&($P(h,l,i),$P(h,l,"prepareStackTrace")),kP(h,l);try{u.name!==a&&NP(u,"name",a),u.constructor=h}catch{}return h}},cN=yt,RG=gn,jo=Gf,hN=SG,DS="WebAssembly",LP=RG[DS],aw=new Error("e",{cause:7}).cause!==7,du=function(t,e){var n={};n[t]=hN(t,e,aw),cN({global:!0,constructor:!0,arity:1,forced:aw},n)},x0=function(t,e){if(LP&&LP[t]){var n={};n[t]=hN(DS+"."+t,e,aw),cN({target:DS,stat:!0,constructor:!0,arity:1,forced:aw},n)}};du("Error",function(t){return function(n){return jo(t,this,arguments)}});du("EvalError",function(t){return function(n){return jo(t,this,arguments)}});du("RangeError",function(t){return function(n){return jo(t,this,arguments)}});du("ReferenceError",function(t){return function(n){return jo(t,this,arguments)}});du("SyntaxError",function(t){return function(n){return jo(t,this,arguments)}});du("TypeError",function(t){return function(n){return jo(t,this,arguments)}});du("URIError",function(t){return function(n){return jo(t,this,arguments)}});x0("CompileError",function(t){return function(n){return jo(t,this,arguments)}});x0("LinkError",function(t){return function(n){return jo(t,this,arguments)}});x0("RuntimeError",function(t){return function(n){return jo(t,this,arguments)}});var EG=hu,dN=Array.isArray||function(e){return EG(e)==="Array"},TG=yi,MG=dN,_G=TypeError,PG=Object.getOwnPropertyDescriptor,xG=TG&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),fN=xG?function(t,e){if(MG(t)&&!PG(t,"length").writable)throw new _G("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},OG=TypeError,IG=9007199254740991,gN=function(t){if(t>IG)throw OG("Maximum allowed index exceeded");return t},AG=yt,HG=Qc,NG=th,DG=fN,kG=gN,$G=On,LG=$G(function(){return[].push.call({length:4294967296},1)!==4294967297}),FG=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},VG=LG||!FG();AG({target:"Array",proto:!0,arity:1,forced:VG},{push:function(e){var n=HG(this),r=NG(n),i=arguments.length;kG(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return DG(n,r),r}});var WG=hu,BG=an,jG=function(t){if(WG(t)==="Function")return BG(t)},FP=jG,UG=Ar,zG=lv,YG=FP(FP.bind),mN=function(t,e){return UG(t),e===void 0?t:zG?YG(t,e):function(){return t.apply(e,arguments)}},pN={},GG=Ji,KG=pN,qG=GG("iterator"),XG=Array.prototype,JG=function(t){return t!==void 0&&(KG.Array===t||XG[qG]===t)},ZG=aN,VP=Uf,QG=v0,eK=pN,tK=Ji,nK=tK("iterator"),O0=function(t){if(!QG(t))return VP(t,nK)||VP(t,"@@iterator")||eK[ZG(t)]},rK=mn,iK=Ar,oK=wn,sK=hv,aK=O0,lK=TypeError,uK=function(t,e){var n=arguments.length<2?aK(t):e;if(iK(n))return oK(rK(n,t));throw new lK(sK(t)+" is not iterable")},cK=mn,WP=wn,hK=Uf,Xr=function(t,e,n){var r,i;WP(t);try{if(r=hK(t,"return"),!r){if(e==="throw")throw n;return n}r=cK(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return WP(r),n},dK=mN,fK=mn,gK=wn,mK=hv,pK=JG,wK=th,BP=jf,vK=uK,yK=O0,jP=Xr,CK=TypeError,wp=function(t,e){this.stopped=t,this.result=e},UP=wp.prototype,nh=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=dK(e,r),u,c,h,d,f,g,w,y=function(C){return u&&jP(u,"normal",C),new wp(!0,C)},E=function(C){return i?(gK(C),a?l(C[0],C[1],y):l(C[0],C[1])):a?l(C,y):l(C)};if(o)u=t.iterator;else if(s)u=t;else{if(c=yK(t),!c)throw new CK(mK(t)+" is not iterable");if(pK(c)){for(h=0,d=wK(t);d>h;h++)if(f=E(t[h]),f&&BP(UP,f))return f;return new wp(!1)}u=vK(t,c)}for(g=o?t.next:u.next;!(w=fK(g,u)).done;){try{f=E(w.value)}catch(C){jP(u,"throw",C)}if(typeof f=="object"&&f&&BP(UP,f))return f}return new wp(!1)},bK=yi,SK=Ls,RK=uv,wN=function(t,e,n){bK?SK.f(t,e,RK(0,n)):t[e]=n},EK=yt,TK=nh,MK=wN;EK({target:"Object",stat:!0},{fromEntries:function(e){var n={};return TK(e,function(r,i){MK(n,r,i)},{AS_ENTRIES:!0}),n}});var Iy=an,Pg=Set.prototype,Uo={Set,add:Iy(Pg.add),has:Iy(Pg.has),remove:Iy(Pg.delete),proto:Pg},_K=Uo.has,fu=function(t){return _K(t),t},PK=mn,gu=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=PK(i,r)).done;)if(s=e(o.value),s!==void 0)return s},vN=an,xK=gu,yN=Uo,OK=yN.Set,CN=yN.proto,IK=vN(CN.forEach),bN=vN(CN.keys),AK=bN(new OK).next,Kf=function(t,e,n){return n?xK({iterator:bN(t),next:AK},e):IK(t,e)},SN=Uo,HK=Kf,NK=SN.Set,DK=SN.add,I0=function(t){var e=new NK;return HK(t,function(n){DK(e,n)}),e},kK=iN,$K=Uo,qf=kK($K.proto,"size","get")||function(t){return t.size},zo=function(t){return{iterator:t,next:t.next,done:!1}},zP=Ar,RN=wn,YP=mn,LK=zf,FK=zo,GP="Invalid size",VK=RangeError,WK=TypeError,BK=Math.max,EN=function(t,e){this.set=t,this.size=BK(e,0),this.has=zP(t.has),this.keys=zP(t.keys)};EN.prototype={getIterator:function(){return FK(RN(YP(this.keys,this.set)))},includes:function(t){return YP(this.has,this.set,t)}};var mu=function(t){RN(t);var e=+t.size;if(e!==e)throw new WK(GP);var n=LK(e);if(n<0)throw new VK(GP);return new EN(t,n)},jK=fu,TN=Uo,UK=I0,zK=qf,YK=mu,GK=Kf,KK=gu,qK=TN.has,KP=TN.remove,XK=function(e){var n=jK(this),r=YK(e),i=UK(n);return zK(n)<=r.size?GK(n,function(o){r.includes(o)&&KP(i,o)}):KK(r.getIterator(),function(o){qK(n,o)&&KP(i,o)}),i},JK=Zc,qP=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},XP=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},pu=function(t,e){var n=JK("Set");try{new n()[t](qP(0));try{return new n()[t](qP(-1)),!1}catch{if(!e)return!0;try{return new n()[t](XP(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](XP(1/0)))}}}catch{return!1}},ZK=yt,QK=XK,e3=pu,t3=!e3("difference",function(t){return t.size===0});ZK({target:"Set",proto:!0,real:!0,forced:t3},{difference:QK});var n3=fu,A0=Uo,r3=qf,i3=mu,o3=Kf,s3=gu,a3=A0.Set,JP=A0.add,l3=A0.has,u3=function(e){var n=n3(this),r=i3(e),i=new a3;return r3(n)>r.size?s3(r.getIterator(),function(o){l3(n,o)&&JP(i,o)}):o3(n,function(o){r.includes(o)&&JP(i,o)}),i},c3=yt,h3=On,d3=u3,f3=pu,g3=!f3("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||h3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});c3({target:"Set",proto:!0,real:!0,forced:g3},{intersection:d3});var m3=fu,p3=Uo.has,w3=qf,v3=mu,y3=Kf,C3=gu,b3=Xr,S3=function(e){var n=m3(this),r=v3(e);if(w3(n)<=r.size)return y3(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return C3(i,function(o){if(p3(n,o))return b3(i,"normal",!1)})!==!1},R3=yt,E3=S3,T3=pu,M3=!T3("isDisjointFrom",function(t){return!t});R3({target:"Set",proto:!0,real:!0,forced:M3},{isDisjointFrom:E3});var _3=fu,P3=qf,x3=Kf,O3=mu,I3=function(e){var n=_3(this),r=O3(e);return P3(n)>r.size?!1:x3(n,function(i){if(!r.includes(i))return!1},!0)!==!1},A3=yt,H3=I3,N3=pu,D3=!N3("isSubsetOf",function(t){return t});A3({target:"Set",proto:!0,real:!0,forced:D3},{isSubsetOf:H3});var k3=fu,$3=Uo.has,L3=qf,F3=mu,V3=gu,W3=Xr,B3=function(e){var n=k3(this),r=F3(e);if(L3(n)<r.size)return!1;var i=r.getIterator();return V3(i,function(o){if(!$3(n,o))return W3(i,"normal",!1)})!==!1},j3=yt,U3=B3,z3=pu,Y3=!z3("isSupersetOf",function(t){return!t});j3({target:"Set",proto:!0,real:!0,forced:Y3},{isSupersetOf:U3});var G3=fu,H0=Uo,K3=I0,q3=mu,X3=gu,J3=H0.add,Z3=H0.has,Q3=H0.remove,e5=function(e){var n=G3(this),r=q3(e).getIterator(),i=K3(n);return X3(r,function(o){Z3(n,o)?Q3(i,o):J3(i,o)}),i},t5=yt,n5=e5,r5=pu;t5({target:"Set",proto:!0,real:!0,forced:!r5("symmetricDifference")},{symmetricDifference:n5});var i5=fu,o5=Uo.add,s5=I0,a5=mu,l5=gu,u5=function(e){var n=i5(this),r=a5(e).getIterator(),i=s5(n);return l5(r,function(o){o5(i,o)}),i},c5=yt,h5=u5,d5=pu;c5({target:"Set",proto:!0,real:!0,forced:!d5("union")},{union:h5});var f5=jf,g5=TypeError,m5=function(t,e){if(f5(e,t))return t;throw new g5("Incorrect invocation")},p5=On,w5=!p5(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),v5=bi,y5=pn,C5=Qc,b5=E0,S5=w5,ZP=b5("IE_PROTO"),kS=Object,R5=kS.prototype,MN=S5?kS.getPrototypeOf:function(t){var e=C5(t);if(v5(e,ZP))return e[ZP];var n=e.constructor;return y5(n)&&e instanceof n?n.prototype:e instanceof kS?R5:null},QP=ZH,E5=Ls,T5=function(t,e,n){return n.get&&QP(n.get,e,{getter:!0}),n.set&&QP(n.set,e,{setter:!0}),E5.f(t,e,n)},_N={},M5=eN,_5=P0,P5=Object.keys||function(e){return M5(e,_5)},x5=yi,O5=YH,I5=Ls,A5=wn,H5=Bf,N5=P5;_N.f=x5&&!O5?Object.defineProperties:function(e,n){A5(e);for(var r=H5(n),i=N5(n),o=i.length,s=0,a;o>s;)I5.f(e,a=i[s++],r[a]);return e};var D5=Zc,PN=D5("document","documentElement"),k5=wn,$5=_N,ex=P0,L5=T0,F5=PN,V5=R0,W5=E0,tx=">",nx="<",$S="prototype",LS="script",xN=W5("IE_PROTO"),Ay=function(){},ON=function(t){return nx+LS+tx+t+nx+"/"+LS+tx},rx=function(t){t.write(ON("")),t.close();var e=t.parentWindow.Object;return t=null,e},B5=function(){var t=V5("iframe"),e="java"+LS+":",n;return t.style.display="none",F5.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(ON("document.F=Object")),n.close(),n.F},xg,vp=function(){try{xg=new ActiveXObject("htmlfile")}catch{}vp=typeof document<"u"?document.domain&&xg?rx(xg):B5():rx(xg);for(var t=ex.length;t--;)delete vp[$S][ex[t]];return vp()};L5[xN]=!0;var IN=Object.create||function(e,n){var r;return e!==null?(Ay[$S]=k5(e),r=new Ay,Ay[$S]=null,r[xN]=e):r=vp(),n===void 0?r:$5.f(r,n)},j5=On,U5=pn,z5=Ci,ix=MN,Y5=_0,G5=Ji,FS=G5("iterator"),eu,Hy,Ny;[].keys&&(Ny=[].keys(),"next"in Ny&&(Hy=ix(ix(Ny)),Hy!==Object.prototype&&(eu=Hy)));var K5=!z5(eu)||j5(function(){var t={};return eu[FS].call(t)!==t});K5&&(eu={});U5(eu[FS])||Y5(eu,FS,function(){return this});var AN={IteratorPrototype:eu},q5=yt,X5=gn,J5=m5,Z5=wn,Q5=pn,eq=MN,tq=T5,nq=wN,rq=On,N0=bi,iq=Ji,$o=AN.IteratorPrototype,oq=yi,Dy="constructor",HN="Iterator",ox=iq("toStringTag"),NN=TypeError,ky=X5[HN],DN=!Q5(ky)||ky.prototype!==$o||!rq(function(){ky({})}),D0=function(){if(J5(this,$o),eq(this)===$o)throw new NN("Abstract class Iterator not directly constructable")},kN=function(t,e){oq?tq($o,t,{configurable:!0,get:function(){return e},set:function(n){if(Z5(this),this===$o)throw new NN("You can't redefine this property");N0(this,t)?this[t]=n:nq(this,t,n)}}):$o[t]=e};N0($o,ox)||kN(ox,HN);(DN||!N0($o,Dy)||$o[Dy]===Object)&&kN(Dy,D0);D0.prototype=$o;q5({global:!0,constructor:!0,forced:DN},{Iterator:D0});var sq=_0,aq=function(t,e,n){for(var r in e)sq(t,r,e[r],n);return t},lq=function(t,e){return{value:t,done:e}},uq=mn,cq=IN,hq=eh,dq=aq,fq=Ji,$N=XH,gq=Uf,mq=AN.IteratorPrototype,Og=lq,$y=Xr,pq=fq("toStringTag"),LN="IteratorHelper",FN="WrapForValidIterator",wq=$N.set,VN=function(t){var e=$N.getterFor(t?FN:LN);return dq(cq(mq),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return Og(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:Og(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=gq(r,"return");return i?uq(i,r):Og(void 0,!0)}if(n.inner)try{$y(n.inner.iterator,"normal")}catch(o){return $y(r,"throw",o)}return r&&$y(r,"normal"),Og(void 0,!0)}})},vq=VN(!0),WN=VN(!1);hq(WN,pq,"Iterator Helper");var k0=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?FN:LN,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,wq(this,s)};return r.prototype=e?vq:WN,r},yq=wn,Cq=Xr,BN=function(t,e,n,r){try{return r?e(yq(n)[0],n[1]):e(n)}catch(i){Cq(t,"throw",i)}},bq=gn,Ba=function(t,e){var n=bq.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},Sq=yt,jN=mn,Rq=Ar,UN=wn,Eq=zo,Tq=k0,Mq=BN,_q=Xr,Pq=Ba,Ly=Pq("filter",TypeError),xq=Tq(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=UN(jN(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,Mq(t,e,[o,this.counter++],!0))return o}});Sq({target:"Iterator",proto:!0,real:!0,forced:Ly},{filter:function(e){UN(this);try{Rq(e)}catch(n){_q(this,"throw",n)}return Ly?jN(Ly,this,e):new xq(Eq(this),{predicate:e})}});var Oq=yt,Iq=mn,Aq=nh,Hq=Ar,Nq=wn,Dq=zo,kq=Xr,$q=Ba,Fy=$q("forEach",TypeError);Oq({target:"Iterator",proto:!0,real:!0,forced:Fy},{forEach:function(e){Nq(this);try{Hq(e)}catch(i){kq(this,"throw",i)}if(Fy)return Iq(Fy,this,e);var n=Dq(this),r=0;Aq(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var Lq=yt,zN=mn,Fq=Ar,YN=wn,Vq=zo,Wq=k0,Bq=BN,jq=Xr,Uq=Ba,Vy=Uq("map",TypeError),zq=Wq(function(){var t=this.iterator,e=YN(zN(this.next,t)),n=this.done=!!e.done;if(!n)return Bq(t,this.mapper,[e.value,this.counter++],!0)});Lq({target:"Iterator",proto:!0,real:!0,forced:Vy},{map:function(e){YN(this);try{Fq(e)}catch(n){jq(this,"throw",n)}return Vy?zN(Vy,this,e):new zq(Vq(this),{mapper:e})}});var Yq=an,$0=Yq([].slice),Gq=TypeError,GN=function(t,e){if(t<e)throw new Gq("Not enough arguments");return t},Kq=cv,qq=/(?:ipad|iphone|ipod).*applewebkit/i.test(Kq),yh=gn,Xq=cv,Jq=hu,Ig=function(t){return Xq.slice(0,t.length)===t},KN=function(){return Ig("Bun/")?"BUN":Ig("Cloudflare-Workers")?"CLOUDFLARE":Ig("Deno/")?"DENO":Ig("Node.js/")?"NODE":yh.Bun&&typeof Bun.version=="string"?"BUN":yh.Deno&&typeof Deno.version=="object"?"DENO":Jq(yh.process)==="process"?"NODE":yh.window&&yh.document?"BROWSER":"REST"}(),Zq=KN,Qq=Zq==="NODE",Yr=gn,e4=Gf,t4=mN,sx=pn,n4=bi,qN=On,ax=PN,r4=$0,lx=R0,i4=GN,o4=qq,s4=Qq,VS=Yr.setImmediate,WS=Yr.clearImmediate,a4=Yr.process,Wy=Yr.Dispatch,l4=Yr.Function,ux=Yr.MessageChannel,u4=Yr.String,By=0,Ad={},cx="onreadystatechange",hf,Ka,jy,Uy;qN(function(){hf=Yr.location});var L0=function(t){if(n4(Ad,t)){var e=Ad[t];delete Ad[t],e()}},zy=function(t){return function(){L0(t)}},hx=function(t){L0(t.data)},dx=function(t){Yr.postMessage(u4(t),hf.protocol+"//"+hf.host)};(!VS||!WS)&&(VS=function(e){i4(arguments.length,1);var n=sx(e)?e:l4(e),r=r4(arguments,1);return Ad[++By]=function(){e4(n,void 0,r)},Ka(By),By},WS=function(e){delete Ad[e]},s4?Ka=function(t){a4.nextTick(zy(t))}:Wy&&Wy.now?Ka=function(t){Wy.now(zy(t))}:ux&&!o4?(jy=new ux,Uy=jy.port2,jy.port1.onmessage=hx,Ka=t4(Uy.postMessage,Uy)):Yr.addEventListener&&sx(Yr.postMessage)&&!Yr.importScripts&&hf&&hf.protocol!=="file:"&&!qN(dx)?(Ka=dx,Yr.addEventListener("message",hx,!1)):cx in lx("script")?Ka=function(t){ax.appendChild(lx("script"))[cx]=function(){ax.removeChild(this),L0(t)}}:Ka=function(t){setTimeout(zy(t),0)});var XN={set:VS,clear:WS},c4=yt,h4=gn,fx=XN.clear;c4({global:!0,bind:!0,enumerable:!0,forced:h4.clearImmediate!==fx},{clearImmediate:fx});var JN=gn,d4=Gf,f4=pn,g4=KN,m4=cv,p4=$0,w4=GN,v4=JN.Function,y4=/MSIE .\./.test(m4)||g4==="BUN"&&function(){var t=JN.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),C4=function(t,e){var n=e?2:1;return y4?function(r,i){var o=w4(arguments.length,1)>n,s=f4(r)?r:v4(r),a=o?p4(arguments,n):[],l=o?function(){d4(s,this,a)}:s;return e?t(l,i):t(l)}:t},b4=yt,ZN=gn,gx=XN.set,S4=C4,mx=ZN.setImmediate?S4(gx,!1):gx;b4({global:!0,bind:!0,enumerable:!0,forced:ZN.setImmediate!==mx},{setImmediate:mx});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:QN,setPrototypeOf:px,isFrozen:R4,getPrototypeOf:E4,getOwnPropertyDescriptor:T4}=Object;let{freeze:lr,seal:wi,create:eD}=Object,{apply:BS,construct:jS}=typeof Reflect<"u"&&Reflect;lr||(lr=function(e){return e});wi||(wi=function(e){return e});BS||(BS=function(e,n,r){return e.apply(n,r)});jS||(jS=function(e,n){return new e(...n)});const Ag=ur(Array.prototype.forEach),M4=ur(Array.prototype.lastIndexOf),wx=ur(Array.prototype.pop),Ch=ur(Array.prototype.push),_4=ur(Array.prototype.splice),yp=ur(String.prototype.toLowerCase),Yy=ur(String.prototype.toString),vx=ur(String.prototype.match),bh=ur(String.prototype.replace),P4=ur(String.prototype.indexOf),x4=ur(String.prototype.trim),ki=ur(Object.prototype.hasOwnProperty),Zn=ur(RegExp.prototype.test),Sh=O4(TypeError);function ur(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return BS(t,e,r)}}function O4(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return jS(t,n)}}function Be(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:yp;px&&px(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(R4(e)||(e[r]=o),i=o)}t[i]=!0}return t}function I4(t){for(let e=0;e<t.length;e++)ki(t,e)||(t[e]=null);return t}function Dl(t){const e=eD(null);for(const[n,r]of QN(t))ki(t,n)&&(Array.isArray(r)?e[n]=I4(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Dl(r):e[n]=r);return e}function Rh(t,e){for(;t!==null;){const r=T4(t,e);if(r){if(r.get)return ur(r.get);if(typeof r.value=="function")return ur(r.value)}t=E4(t)}function n(){return null}return n}const yx=lr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Gy=lr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ky=lr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),A4=lr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),qy=lr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),H4=lr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Cx=lr(["#text"]),bx=lr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Xy=lr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Sx=lr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Hg=lr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),N4=wi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),D4=wi(/<%[\w\W]*|[\w\W]*%>/gm),k4=wi(/\$\{[\w\W]*/gm),$4=wi(/^data-[\-\w.\u00B7-\uFFFF]+$/),L4=wi(/^aria-[\-\w]+$/),tD=wi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),F4=wi(/^(?:\w+script|data):/i),V4=wi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),nD=wi(/^html$/i),W4=wi(/^[a-z][.\w]*(-[.\w]+)+$/i);var Rx=Object.freeze({__proto__:null,ARIA_ATTR:L4,ATTR_WHITESPACE:V4,CUSTOM_ELEMENT:W4,DATA_ATTR:$4,DOCTYPE_NAME:nD,ERB_EXPR:D4,IS_ALLOWED_URI:tD,IS_SCRIPT_OR_DATA:F4,MUSTACHE_EXPR:N4,TMPLIT_EXPR:k4});const Eh={element:1,text:3,progressingInstruction:7,comment:8,document:9},B4=function(){return typeof window>"u"?null:window},j4=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Ex=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function rD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:B4();const e=ve=>rD(ve);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==Eh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,w=Rh(g,"cloneNode"),y=Rh(g,"remove"),E=Rh(g,"nextSibling"),C=Rh(g,"childNodes"),A=Rh(g,"parentNode");if(typeof s=="function"){const ve=n.createElement("template");ve.content&&ve.content.ownerDocument&&(n=ve.content.ownerDocument)}let _,$="";const{implementation:I,createNodeIterator:M,createDocumentFragment:G,getElementsByTagName:V}=n,{importNode:W}=r;let Q=Ex();e.isSupported=typeof QN=="function"&&typeof A=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:J,ERB_EXPR:ee,TMPLIT_EXPR:se,DATA_ATTR:be,ARIA_ATTR:gt,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Ae,CUSTOM_ELEMENT:it}=Rx;let{IS_ALLOWED_URI:En}=Rx,ot=null;const m=Be({},[...yx,...Gy,...Ky,...qy,...Cx]);let v=null;const p=Be({},[...bx,...Xy,...Sx,...Hg]);let x=Object.seal(eD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,U=null,K=!0,X=!0,b=!1,R=!0,S=!1,k=!0,P=!1,H=!1,j=!1,O=!1,N=!1,B=!1,F=!0,Y=!1;const ae="user-content-";let ce=!0,Me=!1,Fe={},ze=null;const Te=Be({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ve=null;const Tt=Be({},["audio","video","img","source","image","track"]);let Mi=null;const Xo=Be({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Zr="http://www.w3.org/1998/Math/MathML",Mt="http://www.w3.org/2000/svg",un="http://www.w3.org/1999/xhtml";let Ct=un,_t=!1,We=null;const Qr=Be({},[Zr,Mt,un],Yy);let za=Be({},["mi","mo","mn","ms","mtext"]),Ya=Be({},["annotation-xml"]);const vV=Be({},["title","style","font","a","script"]);let gh=null;const yV=["application/xhtml+xml","text/html"],CV="text/html";let Tn=null,Eu=null;const bV=n.createElement("form"),I_=function(D){return D instanceof RegExp||D instanceof Function},hy=function(){let D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Eu&&Eu===D)){if((!D||typeof D!="object")&&(D={}),D=Dl(D),gh=yV.indexOf(D.PARSER_MEDIA_TYPE)===-1?CV:D.PARSER_MEDIA_TYPE,Tn=gh==="application/xhtml+xml"?Yy:yp,ot=ki(D,"ALLOWED_TAGS")?Be({},D.ALLOWED_TAGS,Tn):m,v=ki(D,"ALLOWED_ATTR")?Be({},D.ALLOWED_ATTR,Tn):p,We=ki(D,"ALLOWED_NAMESPACES")?Be({},D.ALLOWED_NAMESPACES,Yy):Qr,Mi=ki(D,"ADD_URI_SAFE_ATTR")?Be(Dl(Xo),D.ADD_URI_SAFE_ATTR,Tn):Xo,Ve=ki(D,"ADD_DATA_URI_TAGS")?Be(Dl(Tt),D.ADD_DATA_URI_TAGS,Tn):Tt,ze=ki(D,"FORBID_CONTENTS")?Be({},D.FORBID_CONTENTS,Tn):Te,L=ki(D,"FORBID_TAGS")?Be({},D.FORBID_TAGS,Tn):{},U=ki(D,"FORBID_ATTR")?Be({},D.FORBID_ATTR,Tn):{},Fe=ki(D,"USE_PROFILES")?D.USE_PROFILES:!1,K=D.ALLOW_ARIA_ATTR!==!1,X=D.ALLOW_DATA_ATTR!==!1,b=D.ALLOW_UNKNOWN_PROTOCOLS||!1,R=D.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=D.SAFE_FOR_TEMPLATES||!1,k=D.SAFE_FOR_XML!==!1,P=D.WHOLE_DOCUMENT||!1,O=D.RETURN_DOM||!1,N=D.RETURN_DOM_FRAGMENT||!1,B=D.RETURN_TRUSTED_TYPE||!1,j=D.FORCE_BODY||!1,F=D.SANITIZE_DOM!==!1,Y=D.SANITIZE_NAMED_PROPS||!1,ce=D.KEEP_CONTENT!==!1,Me=D.IN_PLACE||!1,En=D.ALLOWED_URI_REGEXP||tD,Ct=D.NAMESPACE||un,za=D.MATHML_TEXT_INTEGRATION_POINTS||za,Ya=D.HTML_INTEGRATION_POINTS||Ya,x=D.CUSTOM_ELEMENT_HANDLING||{},D.CUSTOM_ELEMENT_HANDLING&&I_(D.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(x.tagNameCheck=D.CUSTOM_ELEMENT_HANDLING.tagNameCheck),D.CUSTOM_ELEMENT_HANDLING&&I_(D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(x.attributeNameCheck=D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),D.CUSTOM_ELEMENT_HANDLING&&typeof D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(x.allowCustomizedBuiltInElements=D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(X=!1),N&&(O=!0),Fe&&(ot=Be({},Cx),v=[],Fe.html===!0&&(Be(ot,yx),Be(v,bx)),Fe.svg===!0&&(Be(ot,Gy),Be(v,Xy),Be(v,Hg)),Fe.svgFilters===!0&&(Be(ot,Ky),Be(v,Xy),Be(v,Hg)),Fe.mathMl===!0&&(Be(ot,qy),Be(v,Sx),Be(v,Hg))),D.ADD_TAGS&&(ot===m&&(ot=Dl(ot)),Be(ot,D.ADD_TAGS,Tn)),D.ADD_ATTR&&(v===p&&(v=Dl(v)),Be(v,D.ADD_ATTR,Tn)),D.ADD_URI_SAFE_ATTR&&Be(Mi,D.ADD_URI_SAFE_ATTR,Tn),D.FORBID_CONTENTS&&(ze===Te&&(ze=Dl(ze)),Be(ze,D.FORBID_CONTENTS,Tn)),ce&&(ot["#text"]=!0),P&&Be(ot,["html","head","body"]),ot.table&&(Be(ot,["tbody"]),delete L.tbody),D.TRUSTED_TYPES_POLICY){if(typeof D.TRUSTED_TYPES_POLICY.createHTML!="function")throw Sh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof D.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Sh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=D.TRUSTED_TYPES_POLICY,$=_.createHTML("")}else _===void 0&&(_=j4(f,i)),_!==null&&typeof $=="string"&&($=_.createHTML(""));lr&&lr(D),Eu=D}},A_=Be({},[...Gy,...Ky,...A4]),H_=Be({},[...qy,...H4]),SV=function(D){let ne=A(D);(!ne||!ne.tagName)&&(ne={namespaceURI:Ct,tagName:"template"});const me=yp(D.tagName),Nt=yp(ne.tagName);return We[D.namespaceURI]?D.namespaceURI===Mt?ne.namespaceURI===un?me==="svg":ne.namespaceURI===Zr?me==="svg"&&(Nt==="annotation-xml"||za[Nt]):!!A_[me]:D.namespaceURI===Zr?ne.namespaceURI===un?me==="math":ne.namespaceURI===Mt?me==="math"&&Ya[Nt]:!!H_[me]:D.namespaceURI===un?ne.namespaceURI===Mt&&!Ya[Nt]||ne.namespaceURI===Zr&&!za[Nt]?!1:!H_[me]&&(vV[me]||!A_[me]):!!(gh==="application/xhtml+xml"&&We[D.namespaceURI]):!1},eo=function(D){Ch(e.removed,{element:D});try{A(D).removeChild(D)}catch{y(D)}},Cg=function(D,ne){try{Ch(e.removed,{attribute:ne.getAttributeNode(D),from:ne})}catch{Ch(e.removed,{attribute:null,from:ne})}if(ne.removeAttribute(D),D==="is")if(O||N)try{eo(ne)}catch{}else try{ne.setAttribute(D,"")}catch{}},N_=function(D){let ne=null,me=null;if(j)D="<remove></remove>"+D;else{const In=vx(D,/^[\r\n\t ]+/);me=In&&In[0]}gh==="application/xhtml+xml"&&Ct===un&&(D='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+D+"</body></html>");const Nt=_?_.createHTML(D):D;if(Ct===un)try{ne=new d().parseFromString(Nt,gh)}catch{}if(!ne||!ne.documentElement){ne=I.createDocument(Ct,"template",null);try{ne.documentElement.innerHTML=_t?$:Nt}catch{}}const $n=ne.body||ne.documentElement;return D&&me&&$n.insertBefore(n.createTextNode(me),$n.childNodes[0]||null),Ct===un?V.call(ne,P?"html":"body")[0]:P?ne.documentElement:$n},D_=function(D){return M.call(D.ownerDocument||D,D,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},dy=function(D){return D instanceof h&&(typeof D.nodeName!="string"||typeof D.textContent!="string"||typeof D.removeChild!="function"||!(D.attributes instanceof c)||typeof D.removeAttribute!="function"||typeof D.setAttribute!="function"||typeof D.namespaceURI!="string"||typeof D.insertBefore!="function"||typeof D.hasChildNodes!="function")},k_=function(D){return typeof a=="function"&&D instanceof a};function Jo(ve,D,ne){Ag(ve,me=>{me.call(e,D,ne,Eu)})}const $_=function(D){let ne=null;if(Jo(Q.beforeSanitizeElements,D,null),dy(D))return eo(D),!0;const me=Tn(D.nodeName);if(Jo(Q.uponSanitizeElement,D,{tagName:me,allowedTags:ot}),D.hasChildNodes()&&!k_(D.firstElementChild)&&Zn(/<[/\w!]/g,D.innerHTML)&&Zn(/<[/\w!]/g,D.textContent)||D.nodeType===Eh.progressingInstruction||k&&D.nodeType===Eh.comment&&Zn(/<[/\w]/g,D.data))return eo(D),!0;if(!ot[me]||L[me]){if(!L[me]&&F_(me)&&(x.tagNameCheck instanceof RegExp&&Zn(x.tagNameCheck,me)||x.tagNameCheck instanceof Function&&x.tagNameCheck(me)))return!1;if(ce&&!ze[me]){const Nt=A(D)||D.parentNode,$n=C(D)||D.childNodes;if($n&&Nt){const In=$n.length;for(let dr=In-1;dr>=0;--dr){const to=w($n[dr],!0);to.__removalCount=(D.__removalCount||0)+1,Nt.insertBefore(to,E(D))}}}return eo(D),!0}return D instanceof l&&!SV(D)||(me==="noscript"||me==="noembed"||me==="noframes")&&Zn(/<\/no(script|embed|frames)/i,D.innerHTML)?(eo(D),!0):(S&&D.nodeType===Eh.text&&(ne=D.textContent,Ag([J,ee,se],Nt=>{ne=bh(ne,Nt," ")}),D.textContent!==ne&&(Ch(e.removed,{element:D.cloneNode()}),D.textContent=ne)),Jo(Q.afterSanitizeElements,D,null),!1)},L_=function(D,ne,me){if(F&&(ne==="id"||ne==="name")&&(me in n||me in bV))return!1;if(!(X&&!U[ne]&&Zn(be,ne))){if(!(K&&Zn(gt,ne))){if(!v[ne]||U[ne]){if(!(F_(D)&&(x.tagNameCheck instanceof RegExp&&Zn(x.tagNameCheck,D)||x.tagNameCheck instanceof Function&&x.tagNameCheck(D))&&(x.attributeNameCheck instanceof RegExp&&Zn(x.attributeNameCheck,ne)||x.attributeNameCheck instanceof Function&&x.attributeNameCheck(ne))||ne==="is"&&x.allowCustomizedBuiltInElements&&(x.tagNameCheck instanceof RegExp&&Zn(x.tagNameCheck,me)||x.tagNameCheck instanceof Function&&x.tagNameCheck(me))))return!1}else if(!Mi[ne]){if(!Zn(En,bh(me,Ae,""))){if(!((ne==="src"||ne==="xlink:href"||ne==="href")&&D!=="script"&&P4(me,"data:")===0&&Ve[D])){if(!(b&&!Zn(Re,bh(me,Ae,"")))){if(me)return!1}}}}}}return!0},F_=function(D){return D!=="annotation-xml"&&vx(D,it)},V_=function(D){Jo(Q.beforeSanitizeAttributes,D,null);const{attributes:ne}=D;if(!ne||dy(D))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:v,forceKeepAttr:void 0};let Nt=ne.length;for(;Nt--;){const $n=ne[Nt],{name:In,namespaceURI:dr,value:to}=$n,mh=Tn(In);let Jn=In==="value"?to:x4(to);if(me.attrName=mh,me.attrValue=Jn,me.keepAttr=!0,me.forceKeepAttr=void 0,Jo(Q.uponSanitizeAttribute,D,me),Jn=me.attrValue,Y&&(mh==="id"||mh==="name")&&(Cg(In,D),Jn=ae+Jn),k&&Zn(/((--!?|])>)|<\/(style|title)/i,Jn)){Cg(In,D);continue}if(me.forceKeepAttr||(Cg(In,D),!me.keepAttr))continue;if(!R&&Zn(/\/>/i,Jn)){Cg(In,D);continue}S&&Ag([J,ee,se],B_=>{Jn=bh(Jn,B_," ")});const W_=Tn(D.nodeName);if(L_(W_,mh,Jn)){if(_&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!dr)switch(f.getAttributeType(W_,mh)){case"TrustedHTML":{Jn=_.createHTML(Jn);break}case"TrustedScriptURL":{Jn=_.createScriptURL(Jn);break}}try{dr?D.setAttributeNS(dr,In,Jn):D.setAttribute(In,Jn),dy(D)?eo(D):wx(e.removed)}catch{}}}Jo(Q.afterSanitizeAttributes,D,null)},RV=function ve(D){let ne=null;const me=D_(D);for(Jo(Q.beforeSanitizeShadowDOM,D,null);ne=me.nextNode();)Jo(Q.uponSanitizeShadowNode,ne,null),$_(ne),V_(ne),ne.content instanceof o&&ve(ne.content);Jo(Q.afterSanitizeShadowDOM,D,null)};return e.sanitize=function(ve){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ne=null,me=null,Nt=null,$n=null;if(_t=!ve,_t&&(ve="<!-->"),typeof ve!="string"&&!k_(ve))if(typeof ve.toString=="function"){if(ve=ve.toString(),typeof ve!="string")throw Sh("dirty is not a string, aborting")}else throw Sh("toString is not a function");if(!e.isSupported)return ve;if(H||hy(D),e.removed=[],typeof ve=="string"&&(Me=!1),Me){if(ve.nodeName){const to=Tn(ve.nodeName);if(!ot[to]||L[to])throw Sh("root node is forbidden and cannot be sanitized in-place")}}else if(ve instanceof a)ne=N_("<!---->"),me=ne.ownerDocument.importNode(ve,!0),me.nodeType===Eh.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?ne=me:ne.appendChild(me);else{if(!O&&!S&&!P&&ve.indexOf("<")===-1)return _&&B?_.createHTML(ve):ve;if(ne=N_(ve),!ne)return O?null:B?$:""}ne&&j&&eo(ne.firstChild);const In=D_(Me?ve:ne);for(;Nt=In.nextNode();)$_(Nt),V_(Nt),Nt.content instanceof o&&RV(Nt.content);if(Me)return ve;if(O){if(N)for($n=G.call(ne.ownerDocument);ne.firstChild;)$n.appendChild(ne.firstChild);else $n=ne;return(v.shadowroot||v.shadowrootmode)&&($n=W.call(r,$n,!0)),$n}let dr=P?ne.outerHTML:ne.innerHTML;return P&&ot["!doctype"]&&ne.ownerDocument&&ne.ownerDocument.doctype&&ne.ownerDocument.doctype.name&&Zn(nD,ne.ownerDocument.doctype.name)&&(dr="<!DOCTYPE "+ne.ownerDocument.doctype.name+`>
`+dr),S&&Ag([J,ee,se],to=>{dr=bh(dr,to," ")}),_&&B?_.createHTML(dr):dr},e.setConfig=function(){let ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hy(ve),H=!0},e.clearConfig=function(){Eu=null,H=!1},e.isValidAttribute=function(ve,D,ne){Eu||hy({});const me=Tn(ve),Nt=Tn(D);return L_(me,Nt,ne)},e.addHook=function(ve,D){typeof D=="function"&&Ch(Q[ve],D)},e.removeHook=function(ve,D){if(D!==void 0){const ne=M4(Q[ve],D);return ne===-1?void 0:_4(Q[ve],ne,1)[0]}return wx(Q[ve])},e.removeHooks=function(ve){Q[ve]=[]},e.removeAllHooks=function(){Q=Ex()},e}var U4=rD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var iD;function Z(){return iD.apply(null,arguments)}function z4(t){iD=t}function Ki(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Xl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function nt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function F0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(nt(t,e))return!1;return!0}function Sr(t){return t===void 0}function Hs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Xf(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function oD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Sa(t,e){for(var n in e)nt(e,n)&&(t[n]=e[n]);return nt(e,"toString")&&(t.toString=e.toString),nt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Yo(t,e,n,r){return PD(t,e,n,r,!0).utc()}function Y4(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ne(t){return t._pf==null&&(t._pf=Y4()),t._pf}var US;Array.prototype.some?US=Array.prototype.some:US=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function V0(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ne(t),n=US.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function fv(t){var e=Yo(NaN);return t!=null?Sa(Ne(e),t):Ne(e).userInvalidated=!0,e}var Tx=Z.momentProperties=[],Jy=!1;function W0(t,e){var n,r,i,o=Tx.length;if(Sr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Sr(e._i)||(t._i=e._i),Sr(e._f)||(t._f=e._f),Sr(e._l)||(t._l=e._l),Sr(e._strict)||(t._strict=e._strict),Sr(e._tzm)||(t._tzm=e._tzm),Sr(e._isUTC)||(t._isUTC=e._isUTC),Sr(e._offset)||(t._offset=e._offset),Sr(e._pf)||(t._pf=Ne(e)),Sr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=Tx[n],i=e[r],Sr(i)||(t[r]=i);return t}function Jf(t){W0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Jy===!1&&(Jy=!0,Z.updateOffset(this),Jy=!1)}function qi(t){return t instanceof Jf||t!=null&&t._isAMomentObject!=null}function sD(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Si(t,e){var n=!0;return Sa(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])nt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}sD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Mx={};function aD(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),Mx[t]||(sD(e),Mx[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function Go(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function G4(t){var e,n;for(n in t)nt(t,n)&&(e=t[n],Go(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function zS(t,e){var n=Sa({},t),r;for(r in e)nt(e,r)&&(Xl(t[r])&&Xl(e[r])?(n[r]={},Sa(n[r],t[r]),Sa(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)nt(t,r)&&!nt(e,r)&&Xl(t[r])&&(n[r]=Sa({},n[r]));return n}function B0(t){t!=null&&this.set(t)}var YS;Object.keys?YS=Object.keys:YS=function(t){var e,n=[];for(e in t)nt(t,e)&&n.push(e);return n};var K4={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function q4(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Go(r)?r.call(e,n):r}function Wo(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var j0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ng=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Zy={},Pc={};function ye(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Pc[t]=i),e&&(Pc[e[0]]=function(){return Wo(i.apply(this,arguments),e[1],e[2])}),n&&(Pc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function X4(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function J4(t){var e=t.match(j0),n,r;for(n=0,r=e.length;n<r;n++)Pc[e[n]]?e[n]=Pc[e[n]]:e[n]=X4(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Go(e[s])?e[s].call(i,t):e[s];return o}}function Cp(t,e){return t.isValid()?(e=lD(e,t.localeData()),Zy[e]=Zy[e]||J4(e),Zy[e](t)):t.localeData().invalidDate()}function lD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Ng.lastIndex=0;n>=0&&Ng.test(t);)t=t.replace(Ng,r),Ng.lastIndex=0,n-=1;return t}var Z4={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Q4(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(j0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var eX="Invalid date";function tX(){return this._invalidDate}var nX="%d",rX=/\d{1,2}/;function iX(t){return this._ordinal.replace("%d",t)}var oX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function sX(t,e,n,r){var i=this._relativeTime[n];return Go(i)?i(t,e,n,r):i.replace(/%d/i,t)}function aX(t,e){var n=this._relativeTime[t>0?"future":"past"];return Go(n)?n(e):n.replace(/%s/i,e)}var _x={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ri(t){return typeof t=="string"?_x[t]||_x[t.toLowerCase()]:void 0}function U0(t){var e={},n,r;for(r in t)nt(t,r)&&(n=Ri(r),n&&(e[n]=t[r]));return e}var lX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function uX(t){var e=[],n;for(n in t)nt(t,n)&&e.push({unit:n,priority:lX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var uD=/\d/,Jr=/\d\d/,cD=/\d{3}/,z0=/\d{4}/,gv=/[+-]?\d{6}/,Ht=/\d\d?/,hD=/\d\d\d\d?/,dD=/\d\d\d\d\d\d?/,mv=/\d{1,3}/,Y0=/\d{1,4}/,pv=/[+-]?\d{1,6}/,rh=/\d+/,wv=/[+-]?\d+/,cX=/Z|[+-]\d\d:?\d\d/gi,vv=/Z|[+-]\d\d(?::?\d\d)?/gi,hX=/[+-]?\d+(\.\d{1,3})?/,Zf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ih=/^[1-9]\d?/,G0=/^([1-9]\d|\d)/,lw;lw={};function ue(t,e,n){lw[t]=Go(e)?e:function(r,i){return r&&n?n:e}}function dX(t,e){return nt(lw,t)?lw[t](e._strict,e._locale):new RegExp(fX(t))}function fX(t){return Is(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Is(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function di(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ge(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=di(e)),n}var GS={};function wt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Hs(e)&&(r=function(o,s){s[e]=Ge(o)}),i=t.length,n=0;n<i;n++)GS[t[n]]=r}function Qf(t,e){wt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function gX(t,e,n){e!=null&&nt(GS,t)&&GS[t](e,n._a,n,t)}function yv(t){return t%4===0&&t%100!==0||t%400===0}var Gn=0,Rs=1,Oo=2,Sn=3,zi=4,Es=5,jl=6,mX=7,pX=8;ye("Y",0,0,function(){var t=this.year();return t<=9999?Wo(t,4):"+"+t});ye(0,["YY",2],0,function(){return this.year()%100});ye(0,["YYYY",4],0,"year");ye(0,["YYYYY",5],0,"year");ye(0,["YYYYYY",6,!0],0,"year");ue("Y",wv);ue("YY",Ht,Jr);ue("YYYY",Y0,z0);ue("YYYYY",pv,gv);ue("YYYYYY",pv,gv);wt(["YYYYY","YYYYYY"],Gn);wt("YYYY",function(t,e){e[Gn]=t.length===2?Z.parseTwoDigitYear(t):Ge(t)});wt("YY",function(t,e){e[Gn]=Z.parseTwoDigitYear(t)});wt("Y",function(t,e){e[Gn]=parseInt(t,10)});function Hd(t){return yv(t)?366:365}Z.parseTwoDigitYear=function(t){return Ge(t)+(Ge(t)>68?1900:2e3)};var fD=oh("FullYear",!0);function wX(){return yv(this.year())}function oh(t,e){return function(n){return n!=null?(gD(this,t,n),Z.updateOffset(this,e),this):df(this,t)}}function df(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function gD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!yv(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function vX(t){return t=Ri(t),Go(this[t])?this[t]():this}function yX(t,e){if(typeof t=="object"){t=U0(t);var n=uX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Ri(t),Go(this[t]))return this[t](e);return this}function CX(t,e){return(t%e+e)%e}var tn;Array.prototype.indexOf?tn=Array.prototype.indexOf:tn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function K0(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=CX(e,12);return t+=(e-n)/12,n===1?yv(t)?29:28:31-n%7%2}ye("M",["MM",2],"Mo",function(){return this.month()+1});ye("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ye("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Ht,ih);ue("MM",Ht,Jr);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});wt(["M","MM"],function(t,e){e[Rs]=Ge(t)-1});wt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Rs]=i:Ne(n).invalidMonth=t});var bX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),mD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),pD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,SX=Zf,RX=Zf;function EX(t,e){return t?Ki(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||pD).test(e)?"format":"standalone"][t.month()]:Ki(this._months)?this._months:this._months.standalone}function TX(t,e){return t?Ki(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[pD.test(e)?"format":"standalone"][t.month()]:Ki(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function MX(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Yo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=tn.call(this._shortMonthsParse,s),i!==-1?i:null):(i=tn.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=tn.call(this._shortMonthsParse,s),i!==-1?i:(i=tn.call(this._longMonthsParse,s),i!==-1?i:null)):(i=tn.call(this._longMonthsParse,s),i!==-1?i:(i=tn.call(this._shortMonthsParse,s),i!==-1?i:null))}function _X(t,e,n){var r,i,o;if(this._monthsParseExact)return MX.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Yo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function wD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ge(e);else if(e=t.localeData().monthsParse(e),!Hs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,K0(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function vD(t){return t!=null?(wD(this,t),Z.updateOffset(this,!0),this):df(this,"Month")}function PX(){return K0(this.year(),this.month())}function xX(t){return this._monthsParseExact?(nt(this,"_monthsRegex")||yD.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(nt(this,"_monthsShortRegex")||(this._monthsShortRegex=SX),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function OX(t){return this._monthsParseExact?(nt(this,"_monthsRegex")||yD.call(this),t?this._monthsStrictRegex:this._monthsRegex):(nt(this,"_monthsRegex")||(this._monthsRegex=RX),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function yD(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Yo([2e3,i]),s=Is(this.monthsShort(o,"")),a=Is(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function IX(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function ff(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function uw(t,e,n){var r=7+e-n,i=(7+ff(t,0,r).getUTCDay()-e)%7;return-i+r-1}function CD(t,e,n,r,i){var o=(7+n-r)%7,s=uw(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Hd(l)+a):a>Hd(t)?(l=t+1,u=a-Hd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function gf(t,e,n){var r=uw(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+As(s,e,n)):i>As(t.year(),e,n)?(o=i-As(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function As(t,e,n){var r=uw(t,e,n),i=uw(t+1,e,n);return(Hd(t)-r+i)/7}ye("w",["ww",2],"wo","week");ye("W",["WW",2],"Wo","isoWeek");ue("w",Ht,ih);ue("ww",Ht,Jr);ue("W",Ht,ih);ue("WW",Ht,Jr);Qf(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Ge(t)});function AX(t){return gf(t,this._week.dow,this._week.doy).week}var HX={dow:0,doy:6};function NX(){return this._week.dow}function DX(){return this._week.doy}function kX(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function $X(t){var e=gf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}ye("d",0,"do","day");ye("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ye("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ye("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ye("e",0,0,"weekday");ye("E",0,0,"isoWeekday");ue("d",Ht);ue("e",Ht);ue("E",Ht);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});Qf(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ne(n).invalidWeekday=t});Qf(["d","e","E"],function(t,e,n,r){e[r]=Ge(t)});function LX(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function FX(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function q0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var VX="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),bD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),WX="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),BX=Zf,jX=Zf,UX=Zf;function zX(t,e){var n=Ki(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?q0(n,this._week.dow):t?n[t.day()]:n}function YX(t){return t===!0?q0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function GX(t){return t===!0?q0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function KX(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Yo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=tn.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=tn.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=tn.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=tn.call(this._weekdaysParse,s),i!==-1||(i=tn.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=tn.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=tn.call(this._shortWeekdaysParse,s),i!==-1||(i=tn.call(this._weekdaysParse,s),i!==-1)?i:(i=tn.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=tn.call(this._minWeekdaysParse,s),i!==-1||(i=tn.call(this._weekdaysParse,s),i!==-1)?i:(i=tn.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function qX(t,e,n){var r,i,o;if(this._weekdaysParseExact)return KX.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Yo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function XX(t){if(!this.isValid())return t!=null?this:NaN;var e=df(this,"Day");return t!=null?(t=LX(t,this.localeData()),this.add(t-e,"d")):e}function JX(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function ZX(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=FX(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function QX(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||X0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(nt(this,"_weekdaysRegex")||(this._weekdaysRegex=BX),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function e6(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||X0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(nt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jX),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function t6(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||X0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(nt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=UX),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function X0(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Yo([2e3,1]).day(o),a=Is(this.weekdaysMin(s,"")),l=Is(this.weekdaysShort(s,"")),u=Is(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function J0(){return this.hours()%12||12}function n6(){return this.hours()||24}ye("H",["HH",2],0,"hour");ye("h",["hh",2],0,J0);ye("k",["kk",2],0,n6);ye("hmm",0,0,function(){return""+J0.apply(this)+Wo(this.minutes(),2)});ye("hmmss",0,0,function(){return""+J0.apply(this)+Wo(this.minutes(),2)+Wo(this.seconds(),2)});ye("Hmm",0,0,function(){return""+this.hours()+Wo(this.minutes(),2)});ye("Hmmss",0,0,function(){return""+this.hours()+Wo(this.minutes(),2)+Wo(this.seconds(),2)});function SD(t,e){ye(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}SD("a",!0);SD("A",!1);function RD(t,e){return e._meridiemParse}ue("a",RD);ue("A",RD);ue("H",Ht,G0);ue("h",Ht,ih);ue("k",Ht,ih);ue("HH",Ht,Jr);ue("hh",Ht,Jr);ue("kk",Ht,Jr);ue("hmm",hD);ue("hmmss",dD);ue("Hmm",hD);ue("Hmmss",dD);wt(["H","HH"],Sn);wt(["k","kk"],function(t,e,n){var r=Ge(t);e[Sn]=r===24?0:r});wt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});wt(["h","hh"],function(t,e,n){e[Sn]=Ge(t),Ne(n).bigHour=!0});wt("hmm",function(t,e,n){var r=t.length-2;e[Sn]=Ge(t.substr(0,r)),e[zi]=Ge(t.substr(r)),Ne(n).bigHour=!0});wt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Sn]=Ge(t.substr(0,r)),e[zi]=Ge(t.substr(r,2)),e[Es]=Ge(t.substr(i)),Ne(n).bigHour=!0});wt("Hmm",function(t,e,n){var r=t.length-2;e[Sn]=Ge(t.substr(0,r)),e[zi]=Ge(t.substr(r))});wt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Sn]=Ge(t.substr(0,r)),e[zi]=Ge(t.substr(r,2)),e[Es]=Ge(t.substr(i))});function r6(t){return(t+"").toLowerCase().charAt(0)==="p"}var i6=/[ap]\.?m?\.?/i,o6=oh("Hours",!0);function s6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var ED={calendar:K4,longDateFormat:Z4,invalidDate:eX,ordinal:nX,dayOfMonthOrdinalParse:rX,relativeTime:oX,months:bX,monthsShort:mD,week:HX,weekdays:VX,weekdaysMin:WX,weekdaysShort:bD,meridiemParse:i6},Dt={},Th={},mf;function a6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function Px(t){return t&&t.toLowerCase().replace("_","-")}function l6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=Px(t[e]).split("-"),n=o.length,r=Px(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Cv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&a6(o,r)>=n-1)break;n--}e++}return mf}function u6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Cv(t){var e=null,n;if(Dt[t]===void 0&&typeof jp<"u"&&jp&&jp.exports&&u6(t))try{e=mf._abbr,n=require,n("./locale/"+t),xa(e)}catch{Dt[t]=null}return Dt[t]}function xa(t,e){var n;return t&&(Sr(e)?n=Fs(t):n=Z0(t,e),n?mf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),mf._abbr}function Z0(t,e){if(e!==null){var n,r=ED;if(e.abbr=t,Dt[t]!=null)aD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Dt[t]._config;else if(e.parentLocale!=null)if(Dt[e.parentLocale]!=null)r=Dt[e.parentLocale]._config;else if(n=Cv(e.parentLocale),n!=null)r=n._config;else return Th[e.parentLocale]||(Th[e.parentLocale]=[]),Th[e.parentLocale].push({name:t,config:e}),null;return Dt[t]=new B0(zS(r,e)),Th[t]&&Th[t].forEach(function(i){Z0(i.name,i.config)}),xa(t),Dt[t]}else return delete Dt[t],null}function c6(t,e){if(e!=null){var n,r,i=ED;Dt[t]!=null&&Dt[t].parentLocale!=null?Dt[t].set(zS(Dt[t]._config,e)):(r=Cv(t),r!=null&&(i=r._config),e=zS(i,e),r==null&&(e.abbr=t),n=new B0(e),n.parentLocale=Dt[t],Dt[t]=n),xa(t)}else Dt[t]!=null&&(Dt[t].parentLocale!=null?(Dt[t]=Dt[t].parentLocale,t===xa()&&xa(t)):Dt[t]!=null&&delete Dt[t]);return Dt[t]}function Fs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return mf;if(!Ki(t)){if(e=Cv(t),e)return e;t=[t]}return l6(t)}function h6(){return YS(Dt)}function Q0(t){var e,n=t._a;return n&&Ne(t).overflow===-2&&(e=n[Rs]<0||n[Rs]>11?Rs:n[Oo]<1||n[Oo]>K0(n[Gn],n[Rs])?Oo:n[Sn]<0||n[Sn]>24||n[Sn]===24&&(n[zi]!==0||n[Es]!==0||n[jl]!==0)?Sn:n[zi]<0||n[zi]>59?zi:n[Es]<0||n[Es]>59?Es:n[jl]<0||n[jl]>999?jl:-1,Ne(t)._overflowDayOfYear&&(e<Gn||e>Oo)&&(e=Oo),Ne(t)._overflowWeeks&&e===-1&&(e=mX),Ne(t)._overflowWeekday&&e===-1&&(e=pX),Ne(t).overflow=e),t}var d6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,f6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,g6=/Z|[+-]\d\d(?::?\d\d)?/,Dg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Qy=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],m6=/^\/?Date\((-?\d+)/i,p6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,w6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function TD(t){var e,n,r=t._i,i=d6.exec(r)||f6.exec(r),o,s,a,l,u=Dg.length,c=Qy.length;if(i){for(Ne(t).iso=!0,e=0,n=u;e<n;e++)if(Dg[e][1].exec(i[1])){s=Dg[e][0],o=Dg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Qy[e][1].exec(i[3])){a=(i[2]||" ")+Qy[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(g6.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),tE(t)}else t._isValid=!1}function v6(t,e,n,r,i,o){var s=[y6(t),mD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function y6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function C6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function b6(t,e,n){if(t){var r=bD.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ne(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function S6(t,e,n){if(t)return w6[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function MD(t){var e=p6.exec(C6(t._i)),n;if(e){if(n=v6(e[4],e[3],e[2],e[5],e[6],e[7]),!b6(e[1],n,t))return;t._a=n,t._tzm=S6(e[8],e[9],e[10]),t._d=ff.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ne(t).rfc2822=!0}else t._isValid=!1}function R6(t){var e=m6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(TD(t),t._isValid===!1)delete t._isValid;else return;if(MD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=Si("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function cc(t,e,n){return t??e??n}function E6(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function eE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=E6(t),t._w&&t._a[Oo]==null&&t._a[Rs]==null&&T6(t),t._dayOfYear!=null&&(s=cc(t._a[Gn],i[Gn]),(t._dayOfYear>Hd(s)||t._dayOfYear===0)&&(Ne(t)._overflowDayOfYear=!0),n=ff(s,0,t._dayOfYear),t._a[Rs]=n.getUTCMonth(),t._a[Oo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Sn]===24&&t._a[zi]===0&&t._a[Es]===0&&t._a[jl]===0&&(t._nextDay=!0,t._a[Sn]=0),t._d=(t._useUTC?ff:IX).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Sn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ne(t).weekdayMismatch=!0)}}function T6(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=cc(e.GG,t._a[Gn],gf(At(),1,4).year),r=cc(e.W,1),i=cc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=gf(At(),o,s),n=cc(e.gg,t._a[Gn],u.year),r=cc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>As(n,o,s)?Ne(t)._overflowWeeks=!0:l!=null?Ne(t)._overflowWeekday=!0:(a=CD(n,r,i,o,s),t._a[Gn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function tE(t){if(t._f===Z.ISO_8601){TD(t);return}if(t._f===Z.RFC_2822){MD(t);return}t._a=[],Ne(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=lD(t._f,t._locale).match(j0)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(dX(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ne(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Pc[o]?(r?Ne(t).empty=!1:Ne(t).unusedTokens.push(o),gX(o,r,t)):t._strict&&!r&&Ne(t).unusedTokens.push(o);Ne(t).charsLeftOver=a-l,e.length>0&&Ne(t).unusedInput.push(e),t._a[Sn]<=12&&Ne(t).bigHour===!0&&t._a[Sn]>0&&(Ne(t).bigHour=void 0),Ne(t).parsedDateParts=t._a.slice(0),Ne(t).meridiem=t._meridiem,t._a[Sn]=M6(t._locale,t._a[Sn],t._meridiem),u=Ne(t).era,u!==null&&(t._a[Gn]=t._locale.erasConvertYear(u,t._a[Gn])),eE(t),Q0(t)}function M6(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function _6(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ne(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=W0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],tE(e),V0(e)&&(s=!0),o+=Ne(e).charsLeftOver,o+=Ne(e).unusedTokens.length*10,Ne(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Sa(t,n||e)}function P6(t){if(!t._d){var e=U0(t._i),n=e.day===void 0?e.date:e.day;t._a=oD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),eE(t)}}function x6(t){var e=new Jf(Q0(_D(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function _D(t){var e=t._i,n=t._f;return t._locale=t._locale||Fs(t._l),e===null||n===void 0&&e===""?fv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),qi(e)?new Jf(Q0(e)):(Xf(e)?t._d=e:Ki(n)?_6(t):n?tE(t):O6(t),V0(t)||(t._d=null),t))}function O6(t){var e=t._i;Sr(e)?t._d=new Date(Z.now()):Xf(e)?t._d=new Date(e.valueOf()):typeof e=="string"?R6(t):Ki(e)?(t._a=oD(e.slice(0),function(n){return parseInt(n,10)}),eE(t)):Xl(e)?P6(t):Hs(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function PD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Xl(t)&&F0(t)||Ki(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,x6(o)}function At(t,e,n,r){return PD(t,e,n,r,!1)}var I6=Si("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=At.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:fv()}),A6=Si("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=At.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:fv()});function xD(t,e){var n,r;if(e.length===1&&Ki(e[0])&&(e=e[0]),!e.length)return At();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function H6(){var t=[].slice.call(arguments,0);return xD("isBefore",t)}function N6(){var t=[].slice.call(arguments,0);return xD("isAfter",t)}var D6=function(){return Date.now?Date.now():+new Date},Mh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function k6(t){var e,n=!1,r,i=Mh.length;for(e in t)if(nt(t,e)&&!(tn.call(Mh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Mh[r]]){if(n)return!1;parseFloat(t[Mh[r]])!==Ge(t[Mh[r]])&&(n=!0)}return!0}function $6(){return this._isValid}function L6(){return Zi(NaN)}function bv(t){var e=U0(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=k6(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Fs(),this._bubble()}function bp(t){return t instanceof bv}function KS(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function F6(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Ge(t[s])!==Ge(e[s])&&o++;return o+i}function OD(t,e){ye(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Wo(~~(n/60),2)+e+Wo(~~n%60,2)})}OD("Z",":");OD("ZZ","");ue("Z",vv);ue("ZZ",vv);wt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=nE(vv,t)});var V6=/([\+\-]|\d\d)/gi;function nE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(V6)||["-",0,0],o=+(i[1]*60)+Ge(i[2]),o===0?0:i[0]==="+"?o:-o)}function rE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(qi(t)||Xf(t)?t.valueOf():At(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):At(t).local()}function qS(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function W6(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=nE(vv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=qS(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?HD(this,Zi(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:qS(this)}function B6(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function j6(t){return this.utcOffset(0,t)}function U6(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(qS(this),"m")),this}function z6(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=nE(cX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Y6(t){return this.isValid()?(t=t?At(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function G6(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function K6(){if(!Sr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return W0(t,this),t=_D(t),t._a?(e=t._isUTC?Yo(t._a):At(t._a),this._isDSTShifted=this.isValid()&&F6(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function q6(){return this.isValid()?!this._isUTC:!1}function X6(){return this.isValid()?this._isUTC:!1}function ID(){return this.isValid()?this._isUTC&&this._offset===0:!1}var J6=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Z6=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Zi(t,e){var n=t,r=null,i,o,s;return bp(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Hs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=J6.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Ge(r[Oo])*i,h:Ge(r[Sn])*i,m:Ge(r[zi])*i,s:Ge(r[Es])*i,ms:Ge(KS(r[jl]*1e3))*i}):(r=Z6.exec(t))?(i=r[1]==="-"?-1:1,n={y:qa(r[2],i),M:qa(r[3],i),w:qa(r[4],i),d:qa(r[5],i),h:qa(r[6],i),m:qa(r[7],i),s:qa(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=Q6(At(n.from),At(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new bv(n),bp(t)&&nt(t,"_locale")&&(o._locale=t._locale),bp(t)&&nt(t,"_isValid")&&(o._isValid=t._isValid),o}Zi.fn=bv.prototype;Zi.invalid=L6;function qa(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function xx(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Q6(t,e){var n;return t.isValid()&&e.isValid()?(e=rE(e,t),t.isBefore(e)?n=xx(t,e):(n=xx(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function AD(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(aD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Zi(n,r),HD(this,i,t),this}}function HD(t,e,n,r){var i=e._milliseconds,o=KS(e._days),s=KS(e._months);t.isValid()&&(r=r??!0,s&&wD(t,df(t,"Month")+s*n),o&&gD(t,"Date",df(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var e7=AD(1,"add"),t7=AD(-1,"subtract");function ND(t){return typeof t=="string"||t instanceof String}function n7(t){return qi(t)||Xf(t)||ND(t)||Hs(t)||i7(t)||r7(t)||t===null||t===void 0}function r7(t){var e=Xl(t)&&!F0(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||nt(t,o);return e&&n}function i7(t){var e=Ki(t),n=!1;return e&&(n=t.filter(function(r){return!Hs(r)&&ND(t)}).length===0),e&&n}function o7(t){var e=Xl(t)&&!F0(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||nt(t,o);return e&&n}function s7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function a7(t,e){arguments.length===1&&(arguments[0]?n7(arguments[0])?(t=arguments[0],e=void 0):o7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||At(),r=rE(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(Go(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,At(n)))}function l7(){return new Jf(this)}function u7(t,e){var n=qi(t)?t:At(t);return this.isValid()&&n.isValid()?(e=Ri(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function c7(t,e){var n=qi(t)?t:At(t);return this.isValid()&&n.isValid()?(e=Ri(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function h7(t,e,n,r){var i=qi(t)?t:At(t),o=qi(e)?e:At(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function d7(t,e){var n=qi(t)?t:At(t),r;return this.isValid()&&n.isValid()?(e=Ri(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function f7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function g7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function m7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=rE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Ri(e),e){case"year":o=Sp(this,r)/12;break;case"month":o=Sp(this,r);break;case"quarter":o=Sp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:di(o)}function Sp(t,e){if(t.date()<e.date())return-Sp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function p7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function w7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Cp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Go(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Cp(n,"Z")):Cp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function v7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function y7(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Cp(this,t);return this.localeData().postformat(e)}function C7(t,e){return this.isValid()&&(qi(t)&&t.isValid()||At(t).isValid())?Zi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function b7(t){return this.from(At(),t)}function S7(t,e){return this.isValid()&&(qi(t)&&t.isValid()||At(t).isValid())?Zi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function R7(t){return this.to(At(),t)}function DD(t){var e;return t===void 0?this._locale._abbr:(e=Fs(t),e!=null&&(this._locale=e),this)}var kD=Si("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function $D(){return this._locale}var cw=1e3,xc=60*cw,hw=60*xc,LD=(365*400+97)*24*hw;function Oc(t,e){return(t%e+e)%e}function FD(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-LD:new Date(t,e,n).valueOf()}function VD(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-LD:Date.UTC(t,e,n)}function E7(t){var e,n;if(t=Ri(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?VD:FD,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Oc(e+(this._isUTC?0:this.utcOffset()*xc),hw);break;case"minute":e=this._d.valueOf(),e-=Oc(e,xc);break;case"second":e=this._d.valueOf(),e-=Oc(e,cw);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function T7(t){var e,n;if(t=Ri(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?VD:FD,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=hw-Oc(e+(this._isUTC?0:this.utcOffset()*xc),hw)-1;break;case"minute":e=this._d.valueOf(),e+=xc-Oc(e,xc)-1;break;case"second":e=this._d.valueOf(),e+=cw-Oc(e,cw)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function M7(){return this._d.valueOf()-(this._offset||0)*6e4}function _7(){return Math.floor(this.valueOf()/1e3)}function P7(){return new Date(this.valueOf())}function x7(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function O7(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function I7(){return this.isValid()?this.toISOString():null}function A7(){return V0(this)}function H7(){return Sa({},Ne(this))}function N7(){return Ne(this).overflow}function D7(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ye("N",0,0,"eraAbbr");ye("NN",0,0,"eraAbbr");ye("NNN",0,0,"eraAbbr");ye("NNNN",0,0,"eraName");ye("NNNNN",0,0,"eraNarrow");ye("y",["y",1],"yo","eraYear");ye("y",["yy",2],0,"eraYear");ye("y",["yyy",3],0,"eraYear");ye("y",["yyyy",4],0,"eraYear");ue("N",iE);ue("NN",iE);ue("NNN",iE);ue("NNNN",Y7);ue("NNNNN",G7);wt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ne(n).era=i:Ne(n).invalidEra=t});ue("y",rh);ue("yy",rh);ue("yyy",rh);ue("yyyy",rh);ue("yo",K7);wt(["y","yy","yyy","yyyy"],Gn);wt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Gn]=n._locale.eraYearOrdinalParse(t,i):e[Gn]=parseInt(t,10)});function k7(t,e){var n,r,i,o=this._eras||Fs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function $7(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function L7(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function F7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function V7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function W7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function B7(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function j7(t){return nt(this,"_erasNameRegex")||oE.call(this),t?this._erasNameRegex:this._erasRegex}function U7(t){return nt(this,"_erasAbbrRegex")||oE.call(this),t?this._erasAbbrRegex:this._erasRegex}function z7(t){return nt(this,"_erasNarrowRegex")||oE.call(this),t?this._erasNarrowRegex:this._erasRegex}function iE(t,e){return e.erasAbbrRegex(t)}function Y7(t,e){return e.erasNameRegex(t)}function G7(t,e){return e.erasNarrowRegex(t)}function K7(t,e){return e._eraYearOrdinalRegex||rh}function oE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Is(u[i].name),a=Is(u[i].abbr),l=Is(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}ye(0,["gg",2],0,function(){return this.weekYear()%100});ye(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Sv(t,e){ye(0,[t,t.length],0,e)}Sv("gggg","weekYear");Sv("ggggg","weekYear");Sv("GGGG","isoWeekYear");Sv("GGGGG","isoWeekYear");ue("G",wv);ue("g",wv);ue("GG",Ht,Jr);ue("gg",Ht,Jr);ue("GGGG",Y0,z0);ue("gggg",Y0,z0);ue("GGGGG",pv,gv);ue("ggggg",pv,gv);Qf(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Ge(t)});Qf(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function q7(t){return WD.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function X7(t){return WD.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function J7(){return As(this.year(),1,4)}function Z7(){return As(this.isoWeekYear(),1,4)}function Q7(){var t=this.localeData()._week;return As(this.year(),t.dow,t.doy)}function e9(){var t=this.localeData()._week;return As(this.weekYear(),t.dow,t.doy)}function WD(t,e,n,r,i){var o;return t==null?gf(this,r,i).year:(o=As(t,r,i),e>o&&(e=o),t9.call(this,t,e,n,r,i))}function t9(t,e,n,r,i){var o=CD(t,e,n,r,i),s=ff(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}ye("Q",0,"Qo","quarter");ue("Q",uD);wt("Q",function(t,e){e[Rs]=(Ge(t)-1)*3});function n9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ye("D",["DD",2],"Do","date");ue("D",Ht,ih);ue("DD",Ht,Jr);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});wt(["D","DD"],Oo);wt("Do",function(t,e){e[Oo]=Ge(t.match(Ht)[0])});var BD=oh("Date",!0);ye("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",mv);ue("DDDD",cD);wt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ge(t)});function r9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}ye("m",["mm",2],0,"minute");ue("m",Ht,G0);ue("mm",Ht,Jr);wt(["m","mm"],zi);var i9=oh("Minutes",!1);ye("s",["ss",2],0,"second");ue("s",Ht,G0);ue("ss",Ht,Jr);wt(["s","ss"],Es);var o9=oh("Seconds",!1);ye("S",0,0,function(){return~~(this.millisecond()/100)});ye(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ye(0,["SSS",3],0,"millisecond");ye(0,["SSSS",4],0,function(){return this.millisecond()*10});ye(0,["SSSSS",5],0,function(){return this.millisecond()*100});ye(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ye(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ye(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ye(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",mv,uD);ue("SS",mv,Jr);ue("SSS",mv,cD);var Ra,jD;for(Ra="SSSS";Ra.length<=9;Ra+="S")ue(Ra,rh);function s9(t,e){e[jl]=Ge(("0."+t)*1e3)}for(Ra="S";Ra.length<=9;Ra+="S")wt(Ra,s9);jD=oh("Milliseconds",!1);ye("z",0,0,"zoneAbbr");ye("zz",0,0,"zoneName");function a9(){return this._isUTC?"UTC":""}function l9(){return this._isUTC?"Coordinated Universal Time":""}var te=Jf.prototype;te.add=e7;te.calendar=a7;te.clone=l7;te.diff=m7;te.endOf=T7;te.format=y7;te.from=C7;te.fromNow=b7;te.to=S7;te.toNow=R7;te.get=vX;te.invalidAt=N7;te.isAfter=u7;te.isBefore=c7;te.isBetween=h7;te.isSame=d7;te.isSameOrAfter=f7;te.isSameOrBefore=g7;te.isValid=A7;te.lang=kD;te.locale=DD;te.localeData=$D;te.max=A6;te.min=I6;te.parsingFlags=H7;te.set=yX;te.startOf=E7;te.subtract=t7;te.toArray=x7;te.toObject=O7;te.toDate=P7;te.toISOString=w7;te.inspect=v7;typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});te.toJSON=I7;te.toString=p7;te.unix=_7;te.valueOf=M7;te.creationData=D7;te.eraName=F7;te.eraNarrow=V7;te.eraAbbr=W7;te.eraYear=B7;te.year=fD;te.isLeapYear=wX;te.weekYear=q7;te.isoWeekYear=X7;te.quarter=te.quarters=n9;te.month=vD;te.daysInMonth=PX;te.week=te.weeks=kX;te.isoWeek=te.isoWeeks=$X;te.weeksInYear=Q7;te.weeksInWeekYear=e9;te.isoWeeksInYear=J7;te.isoWeeksInISOWeekYear=Z7;te.date=BD;te.day=te.days=XX;te.weekday=JX;te.isoWeekday=ZX;te.dayOfYear=r9;te.hour=te.hours=o6;te.minute=te.minutes=i9;te.second=te.seconds=o9;te.millisecond=te.milliseconds=jD;te.utcOffset=W6;te.utc=j6;te.local=U6;te.parseZone=z6;te.hasAlignedHourOffset=Y6;te.isDST=G6;te.isLocal=q6;te.isUtcOffset=X6;te.isUtc=ID;te.isUTC=ID;te.zoneAbbr=a9;te.zoneName=l9;te.dates=Si("dates accessor is deprecated. Use date instead.",BD);te.months=Si("months accessor is deprecated. Use month instead",vD);te.years=Si("years accessor is deprecated. Use year instead",fD);te.zone=Si("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",B6);te.isDSTShifted=Si("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",K6);function u9(t){return At(t*1e3)}function c9(){return At.apply(null,arguments).parseZone()}function UD(t){return t}var rt=B0.prototype;rt.calendar=q4;rt.longDateFormat=Q4;rt.invalidDate=tX;rt.ordinal=iX;rt.preparse=UD;rt.postformat=UD;rt.relativeTime=sX;rt.pastFuture=aX;rt.set=G4;rt.eras=k7;rt.erasParse=$7;rt.erasConvertYear=L7;rt.erasAbbrRegex=U7;rt.erasNameRegex=j7;rt.erasNarrowRegex=z7;rt.months=EX;rt.monthsShort=TX;rt.monthsParse=_X;rt.monthsRegex=OX;rt.monthsShortRegex=xX;rt.week=AX;rt.firstDayOfYear=DX;rt.firstDayOfWeek=NX;rt.weekdays=zX;rt.weekdaysMin=GX;rt.weekdaysShort=YX;rt.weekdaysParse=qX;rt.weekdaysRegex=QX;rt.weekdaysShortRegex=e6;rt.weekdaysMinRegex=t6;rt.isPM=r6;rt.meridiem=s6;function dw(t,e,n,r){var i=Fs(),o=Yo().set(r,e);return i[n](o,t)}function zD(t,e,n){if(Hs(t)&&(e=t,t=void 0),t=t||"",e!=null)return dw(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=dw(t,r,n,"month");return i}function sE(t,e,n,r){typeof t=="boolean"?(Hs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Hs(e)&&(n=e,e=void 0),e=e||"");var i=Fs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return dw(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=dw(e,(s+o)%7,r,"day");return a}function h9(t,e){return zD(t,e,"months")}function d9(t,e){return zD(t,e,"monthsShort")}function f9(t,e,n){return sE(t,e,n,"weekdays")}function g9(t,e,n){return sE(t,e,n,"weekdaysShort")}function m9(t,e,n){return sE(t,e,n,"weekdaysMin")}xa("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ge(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=Si("moment.lang is deprecated. Use moment.locale instead.",xa);Z.langData=Si("moment.langData is deprecated. Use moment.localeData instead.",Fs);var Zo=Math.abs;function p9(){var t=this._data;return this._milliseconds=Zo(this._milliseconds),this._days=Zo(this._days),this._months=Zo(this._months),t.milliseconds=Zo(t.milliseconds),t.seconds=Zo(t.seconds),t.minutes=Zo(t.minutes),t.hours=Zo(t.hours),t.months=Zo(t.months),t.years=Zo(t.years),this}function YD(t,e,n,r){var i=Zi(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function w9(t,e){return YD(this,t,e,1)}function v9(t,e){return YD(this,t,e,-1)}function Ox(t){return t<0?Math.floor(t):Math.ceil(t)}function y9(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=Ox(XS(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=di(t/1e3),r.seconds=i%60,o=di(i/60),r.minutes=o%60,s=di(o/60),r.hours=s%24,e+=di(s/24),l=di(GD(e)),n+=l,e-=Ox(XS(l)),a=di(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function GD(t){return t*4800/146097}function XS(t){return t*146097/4800}function C9(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Ri(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+GD(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(XS(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Vs(t){return function(){return this.as(t)}}var KD=Vs("ms"),b9=Vs("s"),S9=Vs("m"),R9=Vs("h"),E9=Vs("d"),T9=Vs("w"),M9=Vs("M"),_9=Vs("Q"),P9=Vs("y"),x9=KD;function O9(){return Zi(this)}function I9(t){return t=Ri(t),this.isValid()?this[t+"s"]():NaN}function wu(t){return function(){return this.isValid()?this._data[t]:NaN}}var A9=wu("milliseconds"),H9=wu("seconds"),N9=wu("minutes"),D9=wu("hours"),k9=wu("days"),$9=wu("months"),L9=wu("years");function F9(){return di(this.days()/7)}var ps=Math.round,yc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function V9(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function W9(t,e,n,r){var i=Zi(t).abs(),o=ps(i.as("s")),s=ps(i.as("m")),a=ps(i.as("h")),l=ps(i.as("d")),u=ps(i.as("M")),c=ps(i.as("w")),h=ps(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,V9.apply(null,d)}function B9(t){return t===void 0?ps:typeof t=="function"?(ps=t,!0):!1}function j9(t,e){return yc[t]===void 0?!1:e===void 0?yc[t]:(yc[t]=e,t==="s"&&(yc.ss=e-1),!0)}function U9(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=yc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},yc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=W9(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var eC=Math.abs;function Mu(t){return(t>0)-(t<0)||+t}function Rv(){if(!this.isValid())return this.localeData().invalidDate();var t=eC(this._milliseconds)/1e3,e=eC(this._days),n=eC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=di(t/60),i=di(r/60),t%=60,r%=60,o=di(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Mu(this._months)!==Mu(a)?"-":"",c=Mu(this._days)!==Mu(a)?"-":"",h=Mu(this._milliseconds)!==Mu(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ze=bv.prototype;Ze.isValid=$6;Ze.abs=p9;Ze.add=w9;Ze.subtract=v9;Ze.as=C9;Ze.asMilliseconds=KD;Ze.asSeconds=b9;Ze.asMinutes=S9;Ze.asHours=R9;Ze.asDays=E9;Ze.asWeeks=T9;Ze.asMonths=M9;Ze.asQuarters=_9;Ze.asYears=P9;Ze.valueOf=x9;Ze._bubble=y9;Ze.clone=O9;Ze.get=I9;Ze.milliseconds=A9;Ze.seconds=H9;Ze.minutes=N9;Ze.hours=D9;Ze.days=k9;Ze.weeks=F9;Ze.months=$9;Ze.years=L9;Ze.humanize=U9;Ze.toISOString=Rv;Ze.toString=Rv;Ze.toJSON=Rv;Ze.locale=DD;Ze.localeData=$D;Ze.toIsoString=Si("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Rv);Ze.lang=kD;ye("X",0,0,"unix");ye("x",0,0,"valueOf");ue("x",wv);ue("X",hX);wt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});wt("x",function(t,e,n){n._d=new Date(Ge(t))});//! moment.js
Z.version="2.30.1";z4(At);Z.fn=te;Z.min=H6;Z.max=N6;Z.now=D6;Z.utc=Yo;Z.unix=u9;Z.months=h9;Z.isDate=Xf;Z.locale=xa;Z.invalid=fv;Z.duration=Zi;Z.isMoment=qi;Z.weekdays=f9;Z.parseZone=c9;Z.localeData=Fs;Z.isDuration=bp;Z.monthsShort=d9;Z.weekdaysMin=m9;Z.defineLocale=Z0;Z.updateLocale=c6;Z.locales=h6;Z.weekdaysShort=g9;Z.normalizeUnits=Ri;Z.relativeTimeRounding=B9;Z.relativeTimeThreshold=j9;Z.calendarFormat=s7;Z.prototype=te;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function qD(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function JS(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Nd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function vn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Da(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function T(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function XD(t){return vn(t,(e,n)=>e+n,0)}function z9(t){return vn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function Y9(t){return vn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function G9(t){return t.length?XD(t)/t.length:0}function JD(t){return vn(t,(e,n)=>e.concat(Array.isArray(n)?JD(n):n),[])}function ZD(t){const e=[];return T(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function ZS(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function K9(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>s.includes(a))}),o}function q9(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return T(i,s=>{T(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function QS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const X9=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:G9,arrayEach:T,arrayFilter:Da,arrayFlatten:JD,arrayMap:Ue,arrayMax:z9,arrayMin:Y9,arrayReduce:vn,arraySum:XD,arrayUnique:ZD,extendArray:JS,getDifferenceOfArrays:ZS,getIntersectionOfArrays:K9,getUnionOfArrays:q9,pivot:Nd,stringToArray:QS,to2dArray:qD},Symbol.toStringTag,{value:"Module"}));function ut(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return vn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Rt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function It(t){return typeof t>"u"}function jt(t){return t===null||t===""||It(t)}function QD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Ed="length",Dd=t=>parseInt(t,16),Ix=t=>parseInt(t,10),fw=(t,e,n)=>t.substr(e,n),kd=t=>t.codePointAt(0)-65,eR=t=>`${t}`.replace(/\-/g,""),J9=t=>Dd(fw(eR(t),Dd("12"),kd("F")))/(Dd(fw(eR(t),kd("B"),~~![][Ed]))||9),Z9=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Ax=!1;const Hx={invalid:()=>ut`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ut`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ut`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Nx={invalid:()=>ut`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ut`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ut`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function ek(t,e){const n=!jt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=eR(t||"");const l=Q9(t);if(n||r||l)if(l){const u=Z("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=J9(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(Z9()&&(s="valid",a="valid"),!Ax&&s!=="valid"&&(Hx[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Hx[s]({keyValidityDate:o,hotVersion:i})),Ax=!0),a!=="valid"&&e.parentNode&&Nx[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=Nx[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function Q9(t){let e=[][Ed],n=e;if(t[Ed]!==kd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=kd(i.shift());o;o=kd(i.shift()||"A"))--o<""[Ed]?n=n|(Ix(`${Ix(Dd(r)+(Dd(fw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=fw(t,o,o?i[Ed]===1?9:8:6);return n===e}const e8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:ek,isDefined:le,isEmpty:jt,isRegExp:QD,isUndefined:It,stringify:Rt},Symbol.toStringTag,{value:"Module"}));function qn(t){return t[0].toUpperCase()+t.substr(1)}function t8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Rt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function aE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function lE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function uE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function tR(t){return Ev(`${t}`,{ALLOWED_TAGS:[]})}function Ev(t,e){return U4.sanitize(t,e)}const n8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:t8,isPercentValue:lE,randomString:aE,sanitize:Ev,stripTags:tR,substitute:uE,toUpperCaseFirst:qn},Symbol.toStringTag,{value:"Module"})),vu=t=>["tabindex",t],r8=()=>["role","treegrid"],Ts=()=>["role","presentation"],i8=()=>["role","gridcell"],o8=()=>["role","rowheader"],tk=()=>["role","rowgroup"],s8=()=>["role","columnheader"],nR=()=>["role","row"],a8=()=>["role","menu"],l8=()=>["role","menuitem"],u8=()=>["role","menuitemcheckbox"],c8=()=>["role","combobox"],nk=()=>["role","listbox"],h8=()=>["role","option"],d8=()=>["role","checkbox"],f8=()=>["scope","col"],g8=()=>["scope","row"],m8=()=>["type","text"],pf=t=>["aria-label",t],yu=()=>["aria-hidden","true"],p8=()=>["aria-disabled","true"],w8=()=>["aria-multiselectable","true"],rk=t=>["aria-haspopup",t],ik=t=>["aria-rowcount",t],Tv=t=>["aria-colcount",t],ok=t=>["aria-rowindex",t],cE=t=>["aria-colindex",t],mi=t=>["aria-expanded",t],v8=t=>["aria-sort",t],Dx=()=>["aria-readonly","true"],kx=()=>["aria-invalid","true"],sk=t=>["aria-checked",t],hE=()=>["aria-selected","true"],y8=()=>["aria-autocomplete","list"],C8=t=>["aria-controls",t],b8=t=>["aria-activedescendant",t],S8=t=>["aria-live",t],R8=t=>["aria-relevant",t],E8=t=>["aria-setsize",t],T8=t=>["aria-posinset",t];function ak(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function $d(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function lk(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function tu(t){return lk(t)&&t.parent}function M8(t){return!!Object.getPrototypeOf(t.parent)}function ka(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Td(t,e,n){const r=[];let i=t;for(;i&&(i=ka(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function uk(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Oa(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function ck(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function sa(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function hk(t){return!t||!t.length?[]:t.filter(e=>!!e)}function dk(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function we(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=hk(e),e.length>0&&t.classList.add(...e)}function pe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=dk(e,!0);n=hk(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Cu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=dk(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function dE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)dE(e[n])}}function Bo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const fk=/(<(.*)>|&(.*);)/;function bu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;fk.test(e)?t.innerHTML=n?Ev(e):e:$a(t,e)}function $a(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Bo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function nu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return nu(r.host.impl);if(r.host)return nu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function gk(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Dn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function fE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Mv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function _v(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?fE(e):t.scrollTop}function gE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Mv(e):t.scrollLeft}function wf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function mk(t){return t.scrollHeight-t.clientHeight}function pk(t){return t.scrollWidth-t.clientWidth}function Wc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function vf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function _8(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Xt(t){return t.offsetWidth}function rn(t){return t.offsetHeight}function Ic(t){return t.clientHeight||t.innerHeight}function mE(t){return t.clientWidth||t.innerWidth}function P8(t,e,n){t.addEventListener(e,n,!1)}function x8(t,e,n){t.removeEventListener(e,n,!1)}function pE(t){return t.selectionStart?t.selectionStart:0}function wk(t){return t.selectionEnd?t.selectionEnd:0}function O8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function rR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function eg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let tC;function I8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Rn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return tC===void 0&&(tC=I8(t)),tC}function wE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function vE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Pv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function A8(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function tg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Ld(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function xv(t){return Ld(t)&&t.hasAttribute("data-hot-input")===!1}function H8(t){const e=t.ownerDocument.activeElement;xv(e)||t.select()}function yE(t){return!t.parentNode}function vk(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function CE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ce(t,"contenteditable",!0),n&&Ce(t,...yu()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function bE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&pe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function yk(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;CE(t,n),e(),bE(t,n)}function Lo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const N8=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:fk,addClass:q,addEvent:P8,clearTextSelection:rR,closest:ka,closestDown:Td,empty:Bo,fastInnerHTML:bu,fastInnerText:$a,findFirstParentWithClass:uk,getCaretPosition:pE,getCssTransform:A8,getFrameElement:lk,getMaximumScrollLeft:pk,getMaximumScrollTop:mk,getParent:ak,getParentWindow:tu,getScrollLeft:gE,getScrollTop:_v,getScrollableElement:wf,getScrollbarWidth:Rn,getSelectionEndPosition:wk,getSelectionText:O8,getStyle:vf,getTrimmingContainer:Wc,getWindowScrollLeft:Mv,getWindowScrollTop:fE,hasAccessToParentWindow:M8,hasClass:we,hasHorizontalScrollbar:vE,hasVerticalScrollbar:wE,hasZeroHeight:gk,index:ck,innerHeight:Ic,innerWidth:mE,isChildOf:Oa,isDetached:yE,isHTMLElement:Lo,isInput:Ld,isInternalElement:$d,isOutsideInput:xv,isVisible:nu,makeElementContentEditableAndSelectItsContent:CE,matchesCSSRules:_8,observeVisibilityChangeOnce:vk,offset:Dn,outerHeight:rn,outerWidth:Xt,overlayContainsElement:sa,removeAttribute:Cu,removeClass:pe,removeContentEditableFromElementAndDeselect:bE,removeEvent:x8,removeTextNodes:dE,resetCssTransform:tg,runWithSelectedContendEditableElement:yk,selectElementIfAllowed:H8,setAttribute:Ce,setCaretPosition:eg,setOverlayPosition:Pv},Symbol.toStringTag,{value:"Module"}));function at(t){return typeof t=="function"}function Ck(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function D8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=Ck(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function ng(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function k8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return vn(i,(u,c)=>c(u),r.apply(this,a))}}function SE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function bk(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function $8(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function gw(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const L8=Object.freeze(Object.defineProperty({__proto__:null,curry:bk,curryRight:$8,debounce:ng,fastCall:gw,isFunction:at,partial:SE,pipe:k8,throttle:Ck,throttleAfterHits:D8},Symbol.toStringTag,{value:"Module"}));var F8=an,$x=dN,V8=pn,Lx=hu,W8=dv,Fx=F8([].push),B8=function(t){if(V8(t))return t;if($x(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?Fx(n,i):(typeof i=="number"||Lx(i)==="Number"||Lx(i)==="String")&&Fx(n,W8(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if($x(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},j8=yt,Sk=Zc,Rk=Gf,U8=mn,rg=an,Ek=On,Vx=pn,Wx=C0,Tk=$0,z8=B8,Y8=y0,G8=String,Ia=Sk("JSON","stringify"),kg=rg(/./.exec),Bx=rg("".charAt),K8=rg("".charCodeAt),q8=rg("".replace),X8=rg(1 .toString),J8=/[\uD800-\uDFFF]/g,jx=/^[\uD800-\uDBFF]$/,Ux=/^[\uDC00-\uDFFF]$/,zx=!Y8||Ek(function(){var t=Sk("Symbol")("stringify detection");return Ia([t])!=="[null]"||Ia({a:t})!=="{}"||Ia(Object(t))!=="{}"}),Yx=Ek(function(){return Ia("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ia("\uDEAD")!=='"\\udead"'}),Z8=function(t,e){var n=Tk(arguments),r=z8(e);if(!(!Vx(r)&&(t===void 0||Wx(t))))return n[1]=function(i,o){if(Vx(r)&&(o=U8(r,this,G8(i),o)),!Wx(o))return o},Rk(Ia,null,n)},Q8=function(t,e,n){var r=Bx(n,e-1),i=Bx(n,e+1);return kg(jx,t)&&!kg(Ux,i)||kg(Ux,t)&&!kg(jx,r)?"\\u"+X8(K8(t,0),16):t};Ia&&j8({target:"JSON",stat:!0,arity:3,forced:zx||Yx},{stringify:function(e,n,r){var i=Tk(arguments),o=Rk(zx?Z8:Ia,null,i);return Yx&&typeof o=="string"?q8(o,J8,Q8):o}});function Bc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ke(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Bc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Bc(n[0])]:e[r]=[]:e[r]=null)})),e}function Mk(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function on(t,e,n){const r=Array.isArray(n);return ke(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function ig(t,e){ke(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),ig(t[r],e[r])):t[r]=e[r]})}function Xn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Xi(t){const e={};return ke(t,(n,r)=>{e[r]=n}),e}function ft(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return T(n,i=>{t.MIXINS.push(i.MIXIN_NAME),ke(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let w=g;return(Array.isArray(w)||De(w))&&(w=Xn(w)),w};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Ov(t,e){return JSON.stringify(t)===JSON.stringify(e)}function De(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ko(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function ke(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function _k(t,e){const n=e.split(".");let r=t;return ke(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Rp(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(nn(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function Iv(t){if(!De(t))return 0;const e=function(n){let r=0;return De(n)?ke(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Or(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function nn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const eJ=Object.freeze(Object.defineProperty({__proto__:null,clone:Xi,createObjectPropListener:Or,deepClone:Xn,deepExtend:ig,deepObjectSize:Iv,defineGetter:Ko,duckSchema:Bc,extend:on,getProperty:_k,hasOwnProperty:nn,inherit:Mk,isObject:De,isObjectEqual:Ov,mixin:ft,objectEach:ke,setProperty:Rp},Symbol.toStringTag,{value:"Module"}));function yf(t){return window.requestAnimationFrame(t)}function Cf(t){window.cancelAnimationFrame(t)}function RE(){return"ontouchstart"in window}function Pk(){return typeof window<"u"}let _u;function xk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _u||(typeof Intl=="object"?_u=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?_u=(n,r)=>`${n}`.localeCompare(r):_u=(n,r)=>n===r?0:n>r?-1:1,_u)}const tJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Cf,getComparisonFunction:xk,isCSR:Pk,isTouchSupported:RE,requestAnimationFrame:yf},Symbol.toStringTag,{value:"Module"})),ai=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Ws={chrome:ai((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ai(t=>/CriOS/.test(t)),edge:ai(t=>/Edge/.test(t)),edgeWebKit:ai(t=>/EdgiOS/.test(t)),firefox:ai(t=>/Firefox/.test(t)),firefoxWebKit:ai(t=>/FxiOS/.test(t)),mobile:ai(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ai((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},sh={mac:ai(t=>/^Mac/.test(t)),win:ai(t=>/^Win/.test(t)),linux:ai(t=>/^Linux/.test(t)),ios:ai(t=>/iPhone|iPad|iPod/i.test(t))};function Ok(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(Ws,n=>{let{test:r}=n;return void r(t,e)})}function Ik(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(sh,e=>{let{test:n}=e;return void n(t)})}Pk()&&(Ok(),Ik());function EE(){return Ws.chrome.value}function Ak(){return Ws.chromeWebKit.value}function Ep(){return Ws.firefox.value}function Hk(){return Ws.firefoxWebKit.value}function bf(){return Ws.safari.value}function Nk(){return Ws.edge.value}function nJ(){return Ws.edgeWebKit.value}function ko(){return Ws.mobile.value}function TE(){return sh.ios.value}function ME(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&sh.mac.value}function iR(){return sh.win.value}function mw(){return sh.mac.value}function rJ(){return sh.linux.value}const iJ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:EE,isChromeWebKit:Ak,isEdge:Nk,isEdgeWebKit:nJ,isFirefox:Ep,isFirefoxWebKit:Hk,isIOS:TE,isIpadOS:ME,isLinuxOS:rJ,isMacOS:mw,isMobileBrowser:ko,isSafari:bf,isWindowsOS:iR,setBrowserMeta:Ok,setPlatformMeta:Ik},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Ep()?182:174,AUDIO_MUTE:Ep()?181:173,AUDIO_UP:Ep()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},oJ=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function Dk(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function _E(t){return oJ.includes(t)}function sJ(t){const e=[];return mw()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function kk(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function ah(t,e){const n=e.split("|");let r=!1;return T(n,i=>{if(t===de[i])return r=!0,!1}),r}const aJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:sJ,isCtrlMetaKey:kk,isFunctionKey:_E,isKey:ah,isPrintableChar:Dk},Symbol.toStringTag,{value:"Module"}));function Ei(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ma(t){return t.isImmediatePropagationEnabled===!1}function La(t){return t.button===2}function Av(t){return t.button===0}function $k(t){return t instanceof TouchEvent}function Lk(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!Lo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const lJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ma,isLeftClick:Av,isRightClick:La,isTouchEvent:$k,offsetRelativeTo:Lk,stopImmediatePropagation:Ei},Symbol.toStringTag,{value:"Module"}));function et(){le(console)&&console.warn(...arguments)}function PE(){le(console)&&console.error(...arguments)}const Vl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],nC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),rC=new Map([[]]);var uJ=th,cJ=function(t,e,n){for(var r=0,i=arguments.length>2?n:uJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},hJ=gn,dJ=function(t,e){var n=hJ[t],r=n&&n.prototype;return r&&r[e]},fJ=Ji,gJ=IN,mJ=Ls.f,oR=fJ("unscopables"),sR=Array.prototype;sR[oR]===void 0&&mJ(sR,oR,{configurable:!0,value:gJ(null)});var Hv=function(t){sR[oR][t]=!0},pJ=yt,wJ=an,vJ=Ar,yJ=Bf,CJ=cJ,bJ=dJ,SJ=Hv,RJ=Array,EJ=wJ(bJ("Array","sort"));pJ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&vJ(e);var n=yJ(this),r=CJ(RJ,n);return EJ(r,e)}});SJ("toSorted");var TJ=yt,MJ=mn,_J=nh,PJ=Ar,xJ=wn,OJ=zo,IJ=Xr,AJ=Ba,iC=AJ("find",TypeError);TJ({target:"Iterator",proto:!0,real:!0,forced:iC},{find:function(e){xJ(this);try{PJ(e)}catch(i){IJ(this,"throw",i)}if(iC)return MJ(iC,this,e);var n=OJ(this),r=0;return _J(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function HJ(t,e){Fk(t,e),e.add(t)}function oC(t,e,n){Fk(t,e),e.set(t,n)}function Fk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gx(t,e,n){return t.set(pw(t,e),n),n}function Hn(t,e){return t.get(pw(t,e))}function pw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const NJ=100;var $r=new WeakMap,hc=new WeakMap,sC=new WeakMap,aC=new WeakSet;class Kx{constructor(){HJ(this,aC),oC(this,$r,new Map),oC(this,hc,new Map),oC(this,sC,new Set),Vl.forEach(e=>pw(aC,this,qx).call(this,e))}getHooks(e){var n;return(n=Hn($r,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Hn($r,this).has(e)||(pw(aC,this,qx).call(this,e),Vl.push(e));const i=Hn($r,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Hn(sC,this).has(e);!u&&o!==0&&(u=!0,Hn(sC,this).add(e)),u&&i.length>1&&Hn($r,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Hn($r,this).has(e)&&Hn($r,this).get(e).length>0}remove(e,n){if(!Hn($r,this).has(e))return!1;const r=Hn($r,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Hn(hc,this).get(e);return i.skip=!0,o+=1,o>NJ&&(Hn($r,this).set(e,r.filter(s=>!s.skip)),o=0),Hn(hc,this).set(e,o),!0}return!1}destroy(){Hn($r,this).clear(),Hn(hc,this).clear(),Gx($r,this,null),Gx(hc,this,null)}}function qx(t){Hn($r,this).set(t,[]),Hn(hc,this).set(t,0)}function DJ(t,e,n){return(e=kJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kJ(t){var e=$J(t,"string");return typeof e=="symbol"?e:e+""}function $J(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const LJ=ut`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ie{constructor(){DJ(this,"globalBucket",new Kx)}static getSingleton(){return VJ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new Kx),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?T(n,o=>this.add(e,o,r)):(nC.has(e)&&et(uE(LJ,{hookName:e,removedInVersion:nC.get(e)})),rC.has(e)&&et(rC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?T(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?T(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=gw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=gw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Vl.push(e)}deregister(e){this.isRegistered(e)&&Vl.splice(Vl.indexOf(e),1)}isDeprecated(e){return rC.has(e)||nC.has(e)}isRegistered(e){return Vl.indexOf(e)>=0}getRegistered(){return Vl}}const FJ=new ie;function VJ(){return FJ}const lC=new Map;function Qi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";lC.has(t)||lC.set(t,new Map);const e=lC.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const aR=new WeakMap,{register:WJ,getItem:Vk,hasItem:Wk,getNames:BJ,getValues:LRe}=Qi("editors");function jJ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ie.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Bk(t,e){let n;if(typeof t=="function")aR.get(t)||Rr(null,t),n=aR.get(t);else if(typeof t=="string")n=Vk(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function ww(t){if(typeof t=="function")return t;if(!Wk(t))throw Error(`No registered editor found under "${t}" name`);return Vk(t).getConstructor()}function Rr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new jJ(e);typeof t=="string"&&WJ(t,n),aR.set(e,n)}function UJ(t,e,n){return(e=zJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zJ(t){var e=YJ(t,"string");return typeof e=="symbol"?e:e+""}function YJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Tp=0;class vi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;UJ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,GJ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Tp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Tp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Tp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function GJ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ei(this)},t}function KJ(){return Tp}function qJ(t,e){XJ(t,e),e.add(t)}function XJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){return(e=JJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JJ(t){var e=ZJ(t,"string");return typeof e=="symbol"?e:e+""}function ZJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $g=new WeakSet;class lR{constructor(e,n,r){qJ(this,$g),Xa(this,"hot",void 0),Xa(this,"tableMeta",void 0),Xa(this,"selection",void 0),Xa(this,"eventManager",void 0),Xa(this,"destroyed",!1),Xa(this,"activeEditor",void 0),Xa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new vi(e),this.hot.addHook("afterDocumentKeyDown",i=>uC($g,this,Xx).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>uC($g,this,Xx).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>uC($g,this,QJ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=Bk(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Xx(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ma(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!_E(n)&&!kk(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function QJ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const Jx=new WeakMap;lR.getInstance=function(t,e,n){let r=Jx.get(t);return r||(r=new lR(t,e,n),Jx.set(t,r)),r};function eZ(t,e){jk(t,e),e.add(t)}function _h(t,e,n){jk(t,e),e.set(t,n)}function jk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){return t.get(Cs(t,e))}function Ph(t,e,n){return t.set(Cs(t,e),n),n}function Cs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ac=Object.freeze({CELL:"cell",MIXED:"mixed"});var dn=new WeakMap,Lg=new WeakMap,Fg=new WeakMap,Vg=new WeakMap,Wg=new WeakMap,ca=new WeakSet;class tZ{constructor(e){var n=this;eZ(this,ca),_h(this,dn,void 0),_h(this,Lg,void 0),_h(this,Fg,1),_h(this,Vg,null),_h(this,Wg,new Map);const r=e.getSettings();Ph(dn,this,e),Ph(Lg,this,r.imeFastEdit?Ac.MIXED:Ac.CELL),bt(dn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Cs(ca,n,rZ).call(n,...o)}),bt(dn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Cs(ca,n,Zx).call(n,...o)}),bt(dn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Cs(ca,n,Zx).call(n,...o)}),bt(dn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Cs(ca,n,nZ).call(n,...o)})}getFocusMode(){return bt(Lg,this)}setFocusMode(e){Object.values(Ac).includes(e)?Ph(Lg,this,e):et(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return bt(Fg,this)}setRefocusDelay(e){Ph(Fg,this,e)}setRefocusElementGetter(e){Ph(Vg,this,e)}getRefocusElement(){var e;return typeof bt(Vg,this)=="function"?bt(Vg,this).call(this):(e=bt(dn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=bt(dn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=bt(dn,this).runHooks("modifyFocusedElement",s.row,s.col,r);Lo(a)||(a=r),a&&!((o=bt(dn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Cs(ca,this,xE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bt(Fg,this);if(bt(dn,this).getSettings().imeFastEdit&&!((e=bt(dn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=bt(dn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),bt(Wg,this).has(n)||bt(Wg,this).set(n,ng(()=>{if(!bt(dn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),bt(Wg,this).get(n)()}}}function xE(t){var e;const n=(e=bt(dn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!bt(dn,this).selection.isCellVisible(n)){t(null);return}const r=bt(dn,this).getCell(n.row,n.col,!0);r===null?bt(dn,this).addHookOnce("afterScroll",()=>{t(bt(dn,this).getCell(n.row,n.col,!0))}):t(r)}function Zx(){Cs(ca,this,xE).call(this,t=>{const{activeElement:e}=bt(dn,this).rootDocument;e&&xv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function nZ(){Cs(ca,this,xE).call(this,t=>{this.getFocusMode()===Ac.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function rZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Ac.MIXED:Ac.CELL)}var iZ=Ci,oZ=hu,sZ=Ji,aZ=sZ("match"),lZ=function(t){var e;return iZ(t)&&((e=t[aZ])!==void 0?!!e:oZ(t)==="RegExp")},uZ=wn,cZ=function(){var t=uZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},hZ=mn,dZ=bi,fZ=jf,gZ=cZ,Qx=RegExp.prototype,mZ=function(t){var e=t.flags;return e===void 0&&!("flags"in Qx)&&!dZ(t,"flags")&&fZ(Qx,t)?hZ(gZ,t):e},OE=an,pZ=Qc,wZ=Math.floor,cC=OE("".charAt),vZ=OE("".replace),hC=OE("".slice),yZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,CZ=/\$([$&'`]|\d{1,2})/g,bZ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=CZ;return i!==void 0&&(i=pZ(i),l=yZ),vZ(o,l,function(u,c){var h;switch(cC(c,0)){case"$":return"$";case"&":return t;case"`":return hC(e,0,n);case"'":return hC(e,s);case"<":h=i[hC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=wZ(d/10);return f===0?u:f<=a?r[f-1]===void 0?cC(c,1):r[f-1]+cC(c,1):u}h=r[d-1]}return h===void 0?"":h})},SZ=yt,RZ=mn,IE=an,eO=Wf,EZ=pn,TZ=Ci,MZ=lZ,xh=dv,_Z=Uf,PZ=mZ,xZ=bZ,OZ=Ji,IZ=OZ("replace"),AZ=TypeError,dC=IE("".indexOf);IE("".replace);var tO=IE("".slice),HZ=Math.max;SZ({target:"String",proto:!0},{replaceAll:function(e,n){var r=eO(this),i,o,s,a,l,u,c,h,d,f,g=0,w="";if(TZ(e)){if(i=MZ(e),i&&(o=xh(eO(PZ(e))),!~dC(o,"g")))throw new AZ("`.replaceAll` does not allow non-global regexes");if(s=_Z(e,IZ),s)return RZ(s,e,r,n)}for(a=xh(r),l=xh(e),u=EZ(n),u||(n=xh(n)),c=l.length,h=HZ(1,c),d=dC(a,l);d!==-1;)f=u?xh(n(l,d,a)):xZ(l,a,d,[],void 0,n),w+=tO(a,g,d)+f,g=d+c,d=d+h>a.length?-1:dC(a,l,d+h);return g<a.length&&(w+=tO(a,g)),w}});var NZ=yt,DZ=nh,kZ=Ar,$Z=wn,LZ=zo,FZ=Xr,VZ=Ba,WZ=Gf,BZ=On,Uk=TypeError,zk=BZ(function(){[].keys().reduce(function(){},void 0)}),fC=!zk&&VZ("reduce",Uk);NZ({target:"Iterator",proto:!0,real:!0,forced:zk||fC},{reduce:function(e){$Z(this);try{kZ(e)}catch(s){FZ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(fC)return WZ(fC,this,n?[e]:[e,r]);var i=LZ(this),o=0;if(DZ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new Uk("Reduce of empty iterator with no initial value");return r}});const Yk={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},jZ=new RegExp(Object.keys(Yk).map(t=>`(${t})`).join("|"),"gi");function UZ(t){return(t&&t.nodeName||"")==="TABLE"}function uR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let y=0;y<s;y+=1){const E=!f&&n&&y===0;let C="";if(f)C=`<th>${t.getColHeader(y-c)}</th>`;else if(E)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const A=i[d][y],{hidden:_,rowspan:$,colspan:I}=t.getCellMeta(d-h,y-c);if(!_){const M=[];if($&&M.push(`rowspan="${$}"`),I&&M.push(`colspan="${I}"`),jt(A))C=`<td ${M.join(" ")}></td>`;else{const G=A.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${M.join(" ")}>${G}</td>`}}}g.push(C)}const w=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function cR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=jt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function Gk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const A=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,_=>{const $=_.match(/<td\b[^>]*?>/g)[0],I=/<p.*?>/g,M=_.substring($.length,_.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(I,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${$}${M}</td>`});i.insertAdjacentHTML("afterbegin",`${A}`),o=i.querySelector("table")}if(!o||!UZ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((A,_)=>A+_.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const A=Array.from(o.tHead.rows).filter(_=>{const $=_.querySelector("td")!==null;return $&&h.push(_),!$});f=A.length,d=f>0,f>1?n.nestedHeaders=Array.from(A).reduce((_,$)=>{const I=Array.from($.cells).reduce((M,G,V)=>{if(a&&V===0)return M;const{colSpan:W,innerHTML:Q}=G,J=W>1?{label:Q,colspan:W}:Q;return M.push(J),M},[]);return _.push(I),_},[]):d&&(n.colHeaders=Array.from(A[0].children).reduce((_,$,I)=>(a&&I===0||_.push($.innerHTML),_),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const w=[...h,...Array.from(o.tBodies).reduce((A,_)=>(A.push(...Array.from(_.rows)),A),[]),...c];g=w.length;const y=new Array(g);for(let A=0;A<g;A++)y[A]=new Array(u);const E=[],C=[];for(let A=0;A<g;A++){const _=w[A],$=Array.from(_.cells),I=$.length;for(let M=0;M<I;M++){const G=$[M],{nodeName:V,innerHTML:W,rowSpan:Q,colSpan:J}=G,ee=y[A].findIndex(se=>se===void 0);if(V==="TD"){if(Q>1||J>1){for(let Re=A;Re<A+Q;Re++)if(Re<g)for(let Ae=ee;Ae<ee+J;Ae++)y[Re][Ae]=null;const be=G.getAttribute("style");be&&be.includes("mso-ignore:colspan")||E.push({col:ee,row:A,rowspan:Q,colspan:J})}let se="";s&&/excel/gi.test(s.content)?se=W.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):se=W.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[A][ee]=se.replace(jZ,be=>Yk[be])}else C.push(W)}}return E.length&&(n.mergeCells=E),C.length&&(n.rowHeaders=C),y.length&&(n.data=y),n}const zZ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:cR,htmlToGridSettings:Gk,instanceToHTML:uR},Symbol.toStringTag,{value:"Module"}));function Un(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Kk(t){return Un(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function hR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function AE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ye(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const YZ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ye,isNumeric:Un,isNumericLike:Kk,rangeEach:fe,rangeEachReverse:hR,valueAccordingPercent:AE},Symbol.toStringTag,{value:"Module"})),dR="asc",GZ="desc",nO=new Map([[dR,[-1,1]],[GZ,[1,-1]]]),KZ=t=>`The priority '${t}' is already declared in a map.`,qZ=t=>`The priority '${t}' is not a number.`;function XZ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=at(t)?t:KZ,e=at(e)?e:qZ;function r(o,s){if(!Un(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dR;const[s,a]=nO.get(o)||nO.get(dR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const JZ=t=>`The id '${t}' is already declared in a map.`;function Nv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=at(t)?t:JZ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const ZZ=t=>`'${t}' value is already declared in a unique set.`;function QZ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=at(t)?t:ZZ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const HE=t=>`There is already registered "${t}" plugin.`,eQ=t=>`There is already registered plugin on priority "${t}".`,tQ=t=>`The priority "${t}" is not a number.`,qk=XZ({errorPriorityExists:eQ,errorPriorityNaN:tQ}),Xk=QZ({errorItemExists:HE}),fR=Nv({errorIdExists:HE});function NE(){return[...qk.getItems(),...Xk.getItems()]}function og(t){const e=qn(t);return fR.getItem(e)}function nQ(t){return!!og(t)}function Ke(t,e,n){[t,e,n]=iQ(t,e,n),og(t)===void 0&&rQ(t,e,n)}function rQ(t,e,n){const r=qn(t);if(fR.hasItem(r))throw new Error(HE(r));n===void 0?Xk.addItem(r):qk.addItem(n,r),fR.addItem(r,e)}function iQ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:oQ,getItem:sQ,hasItem:Jk,getNames:aQ,getValues:FRe}=Qi("renderers");function vw(t){if(typeof t=="function")return t;if(!Jk(t))throw Error(`No registered renderer found under "${t}" name`);return sQ(t)}function Fr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),oQ(t,e)}const{register:lQ,getItem:uQ,hasItem:Zk,getNames:cQ,getValues:VRe}=Qi("validators");function DE(t){if(typeof t=="function")return t;if(!Zk(t))throw Error(`No registered validator found under "${t}" name`);return uQ(t)}function Wl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),lQ(t,e)}var hQ=yt,dQ=Qc,fQ=th,gQ=zf,mQ=Hv;hQ({target:"Array",proto:!0},{at:function(e){var n=dQ(this),r=fQ(n),i=gQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});mQ("at");var pQ=yt,wQ=an,vQ=Wf,yQ=zf,CQ=dv,bQ=On,SQ=wQ("".charAt),RQ=bQ(function(){return"𠮷".at(-2)!=="\uD842"});pQ({target:"String",proto:!0,forced:RQ},{at:function(e){var n=CQ(vQ(this)),r=n.length,i=yQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:SQ(n,o)}});function Oh(t,e,n){return(e=EQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EQ(t){var e=TQ(t,"string");return typeof e=="symbol"?e:e+""}function TQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MQ{constructor(){Oh(this,"count",0),Oh(this,"startColumn",null),Oh(this,"endColumn",null),Oh(this,"startPosition",null),Oh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ih(t,e,n){return(e=_Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Q(t){var e=PQ(t,"string");return typeof e=="symbol"?e:e+""}function PQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xQ{constructor(){Ih(this,"count",0),Ih(this,"startRow",null),Ih(this,"endRow",null),Ih(this,"startPosition",null),Ih(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ah(t,e,n){return(e=OQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OQ(t){var e=IQ(t,"string");return typeof e=="symbol"?e:e+""}function IQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qk{constructor(){Ah(this,"count",0),Ah(this,"startColumn",null),Ah(this,"endColumn",null),Ah(this,"startPosition",null),Ah(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Hh(t,e,n){return(e=AQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AQ(t){var e=HQ(t,"string");return typeof e=="symbol"?e:e+""}function HQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e${constructor(){Hh(this,"count",0),Hh(this,"startRow",null),Hh(this,"endRow",null),Hh(this,"startPosition",null),Hh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Nh(t,e,n){return(e=NQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NQ(t){var e=DQ(t,"string");return typeof e=="symbol"?e:e+""}function DQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kQ{constructor(){Nh(this,"count",0),Nh(this,"startColumn",0),Nh(this,"endColumn",0),Nh(this,"startPosition",0),Nh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Dh(t,e,n){return(e=$Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Q(t){var e=LQ(t,"string");return typeof e=="symbol"?e:e+""}function LQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FQ{constructor(){Dh(this,"count",0),Dh(this,"startRow",0),Dh(this,"endRow",0),Dh(this,"startPosition",0),Dh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function rO(t,e,n){return(e=VQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VQ(t){var e=WQ(t,"string");return typeof e=="symbol"?e:e+""}function WQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BQ extends Qk{constructor(){super(...arguments),rO(this,"columnStartOffset",0),rO(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function iO(t,e,n){return(e=jQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jQ(t){var e=UQ(t,"string");return typeof e=="symbol"?e:e+""}function UQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zQ extends e${constructor(){super(...arguments),iO(this,"rowStartOffset",0),iO(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function oO(t,e,n){return(e=YQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YQ(t){var e=GQ(t,"string");return typeof e=="symbol"?e:e+""}function GQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t${constructor(e){oO(this,"calculationTypes",[]),oO(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function _i(t,e,n){return(e=KQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KQ(t){var e=qQ(t,"string");return typeof e=="symbol"?e:e+""}function qQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jc=50;class XQ extends t${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),_i(this,"viewportWidth",0),_i(this,"scrollOffset",0),_i(this,"zeroBasedScrollOffset",0),_i(this,"totalColumns",0),_i(this,"columnWidthFn",null),_i(this,"columnWidth",0),_i(this,"overrideFn",null),_i(this,"inlineStartOffset",0),_i(this,"totalCalculatedWidth",0),_i(this,"startPositions",[]),_i(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?jc:n}}function ei(t,e,n){return(e=JQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JQ(t){var e=ZQ(t,"string");return typeof e=="symbol"?e:e+""}function ZQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QQ extends t${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),ei(this,"viewportHeight",0),ei(this,"scrollOffset",0),ei(this,"zeroBasedScrollOffset",0),ei(this,"totalRows",0),ei(this,"rowHeightFn",null),ei(this,"rowHeight",0),ei(this,"overrideFn",null),ei(this,"horizontalScrollbarHeight",0),ei(this,"innerViewportHeight",0),ei(this,"totalCalculatedHeight",0),ei(this,"startPositions",[]),ei(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function eee(t,e,n){tee(t,e),e.set(t,n)}function tee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sO(t,e,n){return(e=nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=ree(t,"string");return typeof e=="symbol"?e:e+""}function ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pu(t,e){return t.get(n$(t,e))}function aO(t,e,n){return t.set(n$(t,e),n),n}function n$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qo=new WeakMap;class ru{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;sO(this,"row",null),sO(this,"col",null),eee(this,Qo,!1),aO(Qo,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Pu(Qo,this)}isSouthEastOf(e){return this.row>=e.row&&(Pu(Qo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Pu(Qo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Pu(Qo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Pu(Qo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof ru&&aO(Qo,this,e.isRtl()),this}clone(){return new ru(this.row,this.col,Pu(Qo,this))}toObject(){return{row:this.row,col:this.col}}}function iee(t,e,n){oee(t,e),e.set(t,n)}function oee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gC(t,e,n){return(e=see(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function see(t){var e=aee(t,"string");return typeof e=="symbol"?e:e+""}function aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ti(t,e){return t.get(r$(t,e))}function lee(t,e,n){return t.set(r$(t,e),n),n}function r$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fr=new WeakMap;class sg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;gC(this,"highlight",null),gC(this,"from",null),gC(this,"to",null),iee(this,fr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),lee(fr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ti(fr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ti(fr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ti(fr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ti(fr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ti(fr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ti(fr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ti(fr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ti(fr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof ru))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(ti(fr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(ti(fr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new sg(this.highlight,this.from,this.to,ti(fr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new ru(e,n,ti(fr,this))}}function ro(t,e,n){uee(t,e),e.set(t,n)}function uee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(i$(t,e))}function zs(t,e,n){return t.set(i$(t,e),n),n}function i$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ni=new WeakMap,mC=new WeakMap,Mn=new WeakMap,xu=new WeakMap,Bg=new WeakMap,Pi=new WeakMap,pC=new WeakMap,kh=new WeakMap,Ja=new WeakMap,io=new WeakMap;let o$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ro(this,ni,void 0),ro(this,mC,void 0),ro(this,Mn,void 0),ro(this,xu,void 0),ro(this,Bg,void 0),ro(this,Pi,void 0),ro(this,pC,void 0),ro(this,kh,void 0),ro(this,Ja,[null,null]),ro(this,io,[null,null]),zs(ni,this,r),zs(mC,this,n),zs(Mn,this,o),zs(xu,this,s),zs(Bg,this,a),zs(Pi,this,i),zs(pC,this,e),this.registerEvents()}registerEvents(){ge(Pi,this).addEventListener(ge(Mn,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(Pi,this).addEventListener(ge(Mn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(Pi,this).addEventListener(ge(Mn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(Pi,this).addEventListener(ge(Mn,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(Pi,this).addEventListener(ge(Mn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(Pi,this).addEventListener(ge(Mn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(ni,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(ni,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(Pi,this).addEventListener(ge(Mn,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(Pi,this).addEventListener(ge(Mn,this).holder,"mousedown",r=>this.onMouseDown(r))};ko()?e():(RE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(kh,this)&&r){const[i,o]=[r.row,ge(kh,this).from.row],[s,a]=[r.col,ge(kh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(Mn,this).TABLE,i=Td(e,["TD","TH"],r);return i?(n.coords=ge(Mn,this).getCoords(i),n.TD=i):we(e,"wtBorder")&&we(e,"current")?(n.coords=ge(xu,this).getFocusSelection().cellRange.highlight,n.TD=ge(Mn,this).getCell(n.coords)):we(e,"wtBorder")&&we(e,"area")&&ge(xu,this).getAreaSelection().cellRange&&(n.coords=ge(xu,this).getAreaSelection().cellRange.to,n.TD=ge(Mn,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(mC,this).rootDocument.activeElement,r=SE(ak,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);we(i,"corner")?ge(ni,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(ni,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(io,this)[0]=o.TD,clearTimeout(ge(Ja,this)[0]),ge(Ja,this)[0]=setTimeout(()=>{ge(io,this)[0]=null},1e3))}onContextMenu(e){if(ge(ni,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(ni,this).has("onCellMouseOver"))return;const n=ge(Mn,this).TABLE,r=Td(e.target,["TD","TH"],n),i=ge(Bg,this)||this;r&&r!==i.lastMouseOver&&Oa(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(Mn,this).getCoords(r),r))}onMouseOut(e){if(!ge(ni,this).has("onCellMouseOut"))return;const n=ge(Mn,this).TABLE,r=Td(e.target,["TD","TH"],n),i=Td(e.relatedTarget,["TD","TH"],n),o=ge(Bg,this)||this;r&&r!==i&&Oa(r,n)&&(this.callListener("onCellMouseOut",e,ge(Mn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(ni,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(io,this)[0]&&n.TD===ge(io,this)[1]?(we(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(io,this)[0]=null,ge(io,this)[1]=null):n.TD===ge(io,this)[0]&&(ge(io,this)[1]=n.TD,clearTimeout(ge(Ja,this)[1]),ge(Ja,this)[1]=setTimeout(()=>{ge(io,this)[1]=null},500)))}onTouchStart(e){zs(kh,this,ge(xu,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(ni,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];TE()&&(Ak()||Hk())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(ni,this).getSettingPure(e);o&&o(n,r,i,ge(pC,this).call(this))}destroy(){clearTimeout(ge(Ja,this)[0]),clearTimeout(ge(Ja,this)[1]),ge(Pi,this).destroy()}};function wC(t,e,n){return(e=cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cee(t){var e=hee(t,"string");return typeof e=="symbol"?e:e+""}function hee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dee{constructor(e,n,r){wC(this,"offset",void 0),wC(this,"total",void 0),wC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function vC(t,e,n){return(e=fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fee(t){var e=gee(t,"string");return typeof e=="symbol"?e:e+""}function gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mee{constructor(e,n,r){vC(this,"offset",void 0),vC(this,"total",void 0),vC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function jg(t,e,n){return(e=pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pee(t){var e=wee(t,"string");return typeof e=="symbol"?e:e+""}function wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vee{constructor(){jg(this,"currentSize",0),jg(this,"nextSize",0),jg(this,"currentOffset",0),jg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const yee=0,lO=1,gR=2;function yC(t,e,n){return(e=Cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cee(t){var e=bee(t,"string");return typeof e=="symbol"?e:e+""}function bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class See{constructor(){yC(this,"size",new vee),yC(this,"workingSpace",yee),yC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=lO,e.workingSpace=gR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=gR,e.workingSpace=lO,this.sharedSize=e.getViewSize()}}var uO=hv,Ree=TypeError,Eee=function(t,e){if(!delete t[e])throw new Ree("Cannot delete property "+uO(e)+" of "+uO(t))},Tee=yt,Mee=Qc,_ee=th,Pee=fN,xee=Eee,Oee=gN,Iee=[].unshift(0)!==1,Aee=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},Hee=Iee||!Aee();Tee({target:"Array",proto:!0,arity:1,forced:Hee},{unshift:function(e){var n=Mee(this),r=_ee(n),i=arguments.length;if(i){Oee(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:xee(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return Pee(n,r+i)}});function Nee(t,e,n){return(e=Dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cO{constructor(e,n){Nee(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function $ee(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=Fee(t,"string");return typeof e=="symbol"?e:e+""}function Fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vee{constructor(e){$ee(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new cO(o,n),l=new cO(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(gR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Ou(t,e,n){return(e=Wee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wee(t){var e=Bee(t,"string");return typeof e=="symbol"?e:e+""}function Bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s${constructor(e,n){Ou(this,"rootNode",void 0),Ou(this,"nodesPool",void 0),Ou(this,"sizeSet",new See),Ou(this,"collectedNodes",[]),Ou(this,"viewDiffer",new Vee(this.sizeSet)),Ou(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class a$ extends s${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function hO(t,e,n){return(e=jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jee(t){var e=Uee(t,"string");return typeof e=="symbol"?e:e+""}function Uee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zee{constructor(e){hO(this,"nodeType",void 0),hO(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function $h(t,e,n){return(e=Yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:e+""}function Gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ag{constructor(e,n){$h(this,"nodesPool",null),$h(this,"nodeType",void 0),$h(this,"rootNode",void 0),$h(this,"table",null),$h(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new zee(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function dO(t,e,n){return(e=Kee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kee(t){var e=qee(t,"string");return typeof e=="symbol"?e:e+""}function qee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xee extends ag{constructor(){super("TH"),dO(this,"orderViews",new WeakMap),dO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new a$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Cu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(d,[o8(),g8(),cE(h+1),vu(-1)]),n[h](a,d,h)}u.end()}}}class Jee extends ag{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Bo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ce(this.rootNode,[tk()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ce(s,[nR(),ok(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Cu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(u,[cE(a+1+this.table.rowHeadersCount),vu(-1),s8(),...a>=0?[f8()]:[nR()]]),r[n](l,u,n)}}}}let fO=!1;class Zee extends ag{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!fO&&e>1e3&&(fO=!0,et(ut`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function Qee(t,e,n){return(e=ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ete(t){var e=tte(t,"string");return typeof e=="symbol"?e:e+""}function tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Iu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let gO=!1;class nte extends ag{constructor(e){super("TR",e),Qee(this,"orderView",void 0),this.orderView=new s$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!gO&&e>1e3&&(gO=!0,et(ut`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ce(this.rootNode,[tk()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ce(o,[nR(),ok(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?we(o,Iu.rowEven)||(pe(o,Iu.rowOdd),q(o,Iu.rowEven)):we(o,Iu.rowOdd)||(pe(o,Iu.rowEven),q(o,Iu.rowOdd))}this.orderView.end()}}function mO(t,e,n){return(e=rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ite(t,"string");return typeof e=="symbol"?e:e+""}function ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ote extends ag{constructor(){super("TD"),mO(this,"orderViews",new WeakMap),mO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new a$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(we(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Cu(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;Ce(g,[...g.hasAttribute("role")?[]:[i8()],vu(-1),cE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function cn(t,e,n){return(e=ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ste(t){var e=ate(t,"string");return typeof e=="symbol"?e:e+""}function ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lte{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cn(this,"rootNode",void 0),cn(this,"rootDocument",void 0),cn(this,"rowHeaders",null),cn(this,"columnHeaders",null),cn(this,"colGroup",null),cn(this,"rows",null),cn(this,"cells",null),cn(this,"rowFilter",null),cn(this,"columnFilter",null),cn(this,"rowUtils",null),cn(this,"columnUtils",null),cn(this,"rowsToRender",0),cn(this,"columnsToRender",0),cn(this,"rowHeaderFunctions",[]),cn(this,"rowHeadersCount",0),cn(this,"columnHeaderFunctions",[]),cn(this,"columnHeadersCount",0),cn(this,"cellRenderer",void 0),cn(this,"activeOverlayName",void 0),cn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class ute{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new lte(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new Xee,columnHeaders:new Jee(n),colGroup:new Zee(r),rows:new nte(i),cells:new ote}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function CC(t,e,n){return(e=cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cte(t){var e=hte(t,"string");return typeof e=="symbol"?e:e+""}function hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dte{constructor(e,n){CC(this,"dataAccessObject",void 0),CC(this,"wtSettings",void 0),CC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function pO(t,e,n){return(e=fte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fte(t){var e=gte(t,"string");return typeof e=="symbol"?e:e+""}function gte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mte{constructor(e,n){pO(this,"dataAccessObject",void 0),pO(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function oo(t,e,n){return(e=pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pte(t){var e=wte(t,"string");return typeof e=="symbol"?e:e+""}function wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lh{constructor(e,n,r,i,o){oo(this,"wtSettings",null),oo(this,"domBindings",void 0),oo(this,"TBODY",null),oo(this,"THEAD",null),oo(this,"COLGROUP",null),oo(this,"hasTableHeight",!0),oo(this,"hasTableWidth",!0),oo(this,"isTableVisible",!1),oo(this,"tableOffset",0),oo(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,dE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new mte(this.dataAccessObject,this.wtSettings),this.columnUtils=new dte(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ute({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ce(r,[Ts()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[Ts()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",Ce(r,[vu(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ce(r.parentNode,[Ts()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[Ts()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Dn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Dn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new mee(f,o,c),this.columnFilter=new dee(g,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),w=y.skipRender!==!0}w&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Io)||this.is(Aa))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Io))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Io)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Ic(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Io))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=ka(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=ck(r),s=n.cellIndex;sa(su,n,this.wtRootElement)||sa(iu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):sa(Aa,n,this.wtRootElement)||sa(Io,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),sa(su,n,this.wtRootElement)||sa(ou,n,this.wtRootElement)||sa(Aa,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=Ic(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?rn:Ic,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Xt(this.TABLE)}getHeight(){return rn(this.TABLE)}getTotalWidth(){const e=Xt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=rn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return nu(this.TABLE)}_modifyRowHeaderWidth(e){let n=at(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const vte="stickyRowsBottom",kE={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Ko(kE,"MIXIN_NAME",vte,{writable:!1,enumerable:!1});const yte="stickyColumnsStart",Dv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ko(Dv,"MIXIN_NAME",yte,{writable:!1,enumerable:!1});class $E extends lh{constructor(e,n,r,i){super(e,n,r,i,Aa)}}ft($E,kE);ft($E,Dv);const iu="top",Io="bottom",ou="inline_start",su="top_inline_start_corner",Aa="bottom_inline_start_corner",l$=[iu,Io,ou,su,Aa],Cte=new Map([[iu,`ht_clone_${iu}`],[Io,`ht_clone_${Io}`],[ou,`ht_clone_${ou} ht_clone_left`],[su,`ht_clone_${su} ht_clone_top_left_corner`],[Aa,`ht_clone_${Aa} ht_clone_bottom_left_corner`]]);function bte(t,e){Ste(t,e),e.add(t)}function Ste(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rte(t,e,n){return(e=Ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ete(t){var e=Tte(t,"string");return typeof e=="symbol"?e:e+""}function Tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ug(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lh=new WeakSet;class Mte{constructor(e){bte(this,Lh),Rte(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Or(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Or(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Ug(Lh,this,vO).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Ug(Lh,this,vO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Ug(Lh,this,wO).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Ug(Lh,this,wO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function wO(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Dn(r.wtRootElement).left;const u=Math.abs(gE(s,s));if(l>u){const c=mE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function vO(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Dn(n.wtRootElement),a=_v(o,o);if(s.top>a){const l=Ic(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function ri(t,e,n){return(e=_te(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _te(t){var e=Pte(t,"string");return typeof e=="symbol"?e:e+""}function Pte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LE{get eventManager(){return new vi(this)}constructor(e,n){ri(this,"wtTable",void 0),ri(this,"wtScroll",void 0),ri(this,"wtViewport",void 0),ri(this,"wtOverlays",void 0),ri(this,"selectionManager",void 0),ri(this,"wtEvent",void 0),ri(this,"guid",`wt_${aE()}`),ri(this,"drawInterrupted",!1),ri(this,"drawn",!1),ri(this,"activeOverlayName","master"),ri(this,"domBindings",void 0),ri(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Mte(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){$a(r,e[n])}])}}createCellCoords(e,n){return new ru(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new sg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||gk(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function yO(t,e,n){return(e=xte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Ote(t,"string");return typeof e=="symbol"?e:e+""}function Ote(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ite extends LE{constructor(e,n,r){super(e,n),yO(this,"cloneSource",void 0),yO(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new o$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function Ate(t,e,n){return(e=Hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hte(t){var e=Nte(t,"string");return typeof e=="symbol"?e:e+""}function Nte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lg{constructor(e,n,r,i,o){Ate(this,"wtSettings",null),Ko(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Wc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Wc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=wf(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){et(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Rn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(l$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Cte.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ce(o,[Ts()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===iu||u==="vertical"&&this.type===ou?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=wf(e.TABLE),new Ite(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Dte extends lg{constructor(e,n,r,i,o,s){super(e,n,Aa,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new $E(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else tg(n),this.repositionOverlay();let r=rn(this.clone.wtTable.TABLE);const i=Xt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Rn(r)),i.style.bottom=`${o}px`}}const kte="calculatedColumns",kv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ko(kv,"MIXIN_NAME",kte,{writable:!1,enumerable:!1});class FE extends lh{constructor(e,n,r,i){super(e,n,r,i,Io)}}ft(FE,kE);ft(FE,kv);function $te(t,e,n){return(e=Lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lte(t){var e=Fte(t,"string");return typeof e=="symbol"?e:e+""}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vte extends lg{constructor(e,n,r,i){super(e,n,Io,r,i),$te(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new FE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Rn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Mv(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Rn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=rn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Rn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return _v(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=we(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(pe(s,"innerBorderBottom"),o=a)}return o}}const Wte="calculatedRows",VE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ko(VE,"MIXIN_NAME",Wte,{writable:!1,enumerable:!1});class WE extends lh{constructor(e,n,r,i){super(e,n,r,i,ou)}}ft(WE,VE);ft(WE,Dv);const Bte="localHooks",kn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)gw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Ko(kn,"MIXIN_NAME",Bte,{writable:!1,enumerable:!1});let u$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ft(u$,kn);const c$="active-header",BE="header",jE="area",Fd="focus",jte="fill",Ute="row",zte="column",Yte="custom-selection",UE=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var Gte=Hv;Gte("flat");function Kte(t,e){h$(t,e),e.add(t)}function CO(t,e,n){h$(t,e),e.set(t,n)}function h$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(Vd(t,e))}function bO(t,e,n){return t.set(Vd(t,e),n),n}function Vd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ni=new WeakMap,Wn=new WeakMap,zg=new WeakSet;class qte{constructor(){Kte(this,zg),CO(this,Ni,void 0),CO(this,Wn,void 0)}setActiveOverlay(e){return bO(Wn,this,e),this}setActiveSelection(e){return bO(Ni,this,e),this}scan(){const e=Ft(Ni,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Ft(Ni,this).getCorners(),{wtTable:s}=Ft(Wn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const w=Ft(Wn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Ft(Ni,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});w!==null&&(w!==h&&(g=s.getColumnHeader(w,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Ft(Ni,this).getCorners(),{wtTable:s}=Ft(Wn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const w=Ft(Wn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Ft(Ni,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});w!==null&&(w!==h&&(g=s.getRowHeader(w,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Ft(Wn,this);Vd(zg,this,Xte).call(this,(r,i)=>{const o=n.getCell(Ft(Wn,this).createCellCoords(r,i)),s=Ft(Wn,this).getSetting("onAfterDrawSelection",r,i,Ft(Ni,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Ft(Ni,this).getCorners(),{wtTable:i}=Ft(Wn,this);Vd(zg,this,SO).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Ft(Wn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Ft(Ni,this).getCorners(),{wtTable:i}=Ft(Wn,this);Vd(zg,this,SO).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Ft(Wn,this).createCellCoords(o,s));e(a)}})}}function Xte(t){let[e,n,r,i]=Ft(Ni,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Ft(Wn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Ft(Wn,this).createCellCoords(e,n));if(!Lo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function SO(t){const{wtTable:e}=Ft(Wn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class RO{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=UE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ei(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ko()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};ke(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};ke(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),w=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-w/4*3,10)}px`,c[l]=`${parseInt(i-w/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),y-g-f*2),A=Math.min(parseInt(i+o-w/4,10),y-w-f*2);h[l]=`${C}px`,d[l]=`${A}px`;const _=Math.min(parseInt(r+s,10),E-g-f*2),$=Math.min(parseInt(r+s-w/4,10),E-w-f*2);h.top=`${_}px`,d.top=`${$}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!Lo(g)){this.disappear();return}const w=u?s.getCell(this.wot.createCellCoords(i,o)):g,y=Dn(g),E=u?Dn(w):y,C=Dn(s.TABLE),A=y.top,_=y.left,$=this.wot.wtSettings.getSetting("rtlMode");let I=0,M=0;if($){const Re=Xt(s.TABLE),Ae=Xt(g),it=l.innerWidth-C.left-Re;M=_+Ae-E.left,I=l.innerWidth-_-Ae-it-1}else M=E.left+Xt(w)-_,I=_-C.left-1;if(this.isEntireColumnSelected(n,i)){const Re=n,Ae=this.getDimensionsFromHeader("columns",r,o,Re,C);let it=null;Ae&&([it,I,M]=Ae),it&&(g=it)}let G=A-C.top-1,V=E.top+rn(w)-A;if(this.isEntireRowSelected(r,o)){const Re=r,Ae=this.getDimensionsFromHeader("rows",n,i,Re,C);let it=null;Ae&&([it,G,V]=Ae),it&&(g=it)}const W=l.getComputedStyle(g);parseInt(W.borderTopWidth,10)>0&&(G+=1,V=V>0?V-1:0),parseInt(W[$?"borderRightWidth":"borderLeftWidth"],10)>0&&(I+=1,M=M>0?M-1:0);const Q=$?"right":"left";this.topStyle.top=`${G}px`,this.topStyle[Q]=`${I}px`,this.topStyle.width=`${M}px`,this.topStyle.display="block",this.startStyle.top=`${G}px`,this.startStyle[Q]=`${I}px`,this.startStyle.height=`${V}px`,this.startStyle.display="block";const J=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${G+V-J}px`,this.bottomStyle[Q]=`${I}px`,this.bottomStyle.width=`${M}px`,this.bottomStyle.display="block",this.endStyle.top=`${G}px`,this.endStyle[Q]=`${I+M-J}px`,this.endStyle.height=`${V+1}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const se=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[be,gt]=[i,o];if(se&&Array.isArray(se)&&([,,be,gt]=se),ko()||!ee||this.isPartRange(be,gt))this.cornerStyle.display="none";else{this.cornerStyle.top=`${G+V+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Q]=`${I+M+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Re=Wc(s.TABLE);const Ae=Re===l;Ae&&(Re=a.documentElement);const it=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,En=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),ot=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ae?w.getBoundingClientRect().left:w.offsetLeft;let v=!1,p=0;$?(p=m-parseInt(this.cornerDefaultStyle.width,10)/2,v=p<0):(p=m+Xt(w)+parseInt(this.cornerDefaultStyle.width,10)/2,v=p>=mE(Re)),v&&(this.cornerStyle[Q]=`${Math.floor(I+M+this.cornerCenterPointOffset-En-it)}px`,this.cornerStyle[$?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const p=(Ae?w.getBoundingClientRect().top:w.offsetTop)+rn(w)+parseInt(this.cornerDefaultStyle.height,10)/2>=Ic(Re),x=this.wot.stylesHandler.isClassicTheme();if(p){const L=Math.floor(G+V+this.cornerCenterPointOffset-ot-it);x?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}ko()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,G,I,M,V)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return rn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Xt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(g=l(n,y-i),w=l(r,y-i),!g||!w)return!1;const E=Dn(g),C=Dn(w);return g&&w&&(h=E[f]-o[f]-1,d=C[f]+u(w)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(we(this[e],"hidden")&&pe(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):pe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",ko()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Jte(t,e){d$(t,e),e.add(t)}function Au(t,e,n){d$(t,e),e.set(t,n)}function d$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(zE(t,e))}function EO(t,e,n){return t.set(zE(t,e),n),n}function zE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap,Er=new WeakMap,bC=new WeakMap,Md=new WeakMap,SC=new WeakMap,Za=new WeakMap,TO=new WeakSet;class Zte{constructor(e){Jte(this,TO),Au(this,Bn,void 0),Au(this,Er,void 0),Au(this,bC,new qte),Au(this,Md,new WeakMap),Au(this,SC,new WeakSet),Au(this,Za,new Map),EO(Er,this,e)}setActiveOverlay(e){return EO(Bn,this,e),$e(bC,this).setActiveOverlay($e(Bn,this)),$e(Md,this).has($e(Bn,this))||$e(Md,this).set($e(Bn,this),new Set),this}getFocusSelection(){return $e(Er,this)!==null?$e(Er,this).getFocus():null}getAreaSelection(){return $e(Er,this)!==null?$e(Er,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if($e(Za,this).has(e)){const r=$e(Za,this).get(e);if(r.has($e(Bn,this)))return r.get($e(Bn,this));const i=new RO($e(Bn,this),e.settings);return r.set($e(Bn,this),i),i}const n=new RO($e(Bn,this),e.settings);return $e(Za,this).set(e,new Map([[$e(Bn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=$e(Za,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){$e(Za,this).get(e).forEach(n=>n.destroy()),$e(Za,this).delete(e)}render(e){if($e(Er,this)===null)return;e&&zE(TO,this,Qte).call(this);const n=Array.from($e(Er,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;$e(SC,this).has(s)||($e(SC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&$e(bC,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const w=r.get(g);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();$e(Bn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>$e(Md,this).get($e(Bn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=$e(Er,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ce(s,$e(Er,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ce(o,[...i.get(o)])})}}function Qte(){const t=$e(Md,this).get($e(Bn,this)),e=$e(Bn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=$e(Bn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=$e(Er,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=$e(Er,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=$e(Er,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...$e(Er,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)pe(o[a],n),Cu(o[a],s)}),t.clear()}class ene extends lg{constructor(e,n,r,i){super(e,n,ou,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new WE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Pv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),tg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,fE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Rn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Xt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=UE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!we(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Rn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,pk(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(gE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?pe(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=we(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(pe(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const tne="stickyRowsTop",YE={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ko(YE,"MIXIN_NAME",tne,{writable:!1,enumerable:!1});class GE extends lh{constructor(e,n,r,i){super(e,n,r,i,su)}}ft(GE,YE);ft(GE,Dv);function MO(t,e,n){return(e=nne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nne(t){var e=rne(t,"string");return typeof e=="symbol"?e:e+""}function rne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ine extends lg{constructor(e,n,r,i,o,s){super(e,n,su,r,i),MO(this,"topOverlay",void 0),MO(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new GE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Pv(e,`${i}px`,`${o}px`)}else tg(e);let n=rn(this.clone.wtTable.TABLE);const r=Xt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class KE extends lh{constructor(e,n,r,i){super(e,n,r,i,iu)}}ft(KE,YE);ft(KE,kv);function one(t,e,n){return(e=sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sne(t){var e=ane(t,"string");return typeof e=="symbol"?e:e+""}function ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lne extends lg{constructor(e,n,r,i){super(e,n,iu,r,i),one(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new KE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Pv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),tg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Mv(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Rn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=rn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=UE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!we(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=Rn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,mk(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return _v(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?pe(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=we(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(pe(i,"innerBorderTop"),a=h)}}return a}}function Yg(t,e,n){une(t,e),e.set(t,n)}function une(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function es(t,e,n){return(e=cne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cne(t){var e=hne(t,"string");return typeof e=="symbol"?e:e+""}function hne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qa(t,e,n){return t.set(f$(t,e),n),n}function ts(t,e){return t.get(f$(t,e))}function f$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hu=new WeakMap,Gg=new WeakMap,Nu=new WeakMap,Kg=new WeakMap;class dne{constructor(e,n,r,i,o,s){es(this,"wot",null),Yg(this,Hu,[]),es(this,"topOverlay",null),es(this,"bottomOverlay",null),es(this,"inlineStartOverlay",null),es(this,"topInlineStartCornerOverlay",null),es(this,"bottomInlineStartCornerOverlay",null),es(this,"browserLineHeight",void 0),es(this,"wtSettings",null),Yg(this,Gg,!1),Yg(this,Nu,0),Yg(this,Kg,null),es(this,"resizeObserver",new ResizeObserver(c=>{yf(()=>{!Array.isArray(c)||!c.length||(Qa(Nu,this,ts(Nu,this)+1),ts(Nu,this)===100&&(et("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ts(Kg,this)!==null&&clearTimeout(ts(Kg,this)),Qa(Kg,this,setTimeout(()=>{Qa(Nu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Rn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:wf(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...ts(Hu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new lne(...e),this.bottomOverlay=new Vte(...e),this.inlineStartOverlay=new ene(...e),this.topInlineStartCornerOverlay=new ine(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Dte(...e,this.bottomOverlay,this.inlineStartOverlay),Qa(Hu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Qa(Gg,this,ts(Hu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),ts(Hu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ts(Hu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!EE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{yf(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Qa(Nu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=ah(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!ts(Gg,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),Qa(Gg,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=wf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),w=f()?1:0,y=g()?1:0;d.width=`${c+y}px`,d.height=`${u+w}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return T(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function _O(t,e,n){return(e=fne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fne(t){var e=gne(t,"string");return typeof e=="symbol"?e:e+""}function gne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mne{constructor(e){_O(this,"settings",{}),_O(this,"defaults",Object.freeze(this.getDefaults())),ke(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);$a(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?ke(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class qE extends lh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Wc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=vf(e,"height",n),o=vf(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=nu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}ft(qE,VE);ft(qE,kv);class pne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new FQ:new zQ],["fullyVisible",()=>new xQ],["partiallyVisible",()=>new e$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new kQ:new BQ],["fullyVisible",()=>new MQ],["partiallyVisible",()=>new Qk]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=rn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Dn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=rn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Xt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Rn(this.domBindings.rootDocument),new QQ({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Rn(this.domBindings.rootDocument)),new XQ({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){ke(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function wne(t,e){g$(t,e),e.add(t)}function el(t,e,n){g$(t,e),e.set(t,n)}function g$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e){return t.get(Bi(t,e))}function Wi(t,e,n){return t.set(Bi(t,e),n),n}function Bi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const PO=23;var yo=new WeakMap,bs=new WeakMap,XE=new WeakMap,mR=new WeakMap,aa=new WeakMap,_d=new WeakMap,Sf=new WeakMap,So=new WeakSet;class vne{constructor(e){wne(this,So),el(this,yo,void 0),el(this,bs,void 0),el(this,XE,void 0),el(this,mR,void 0),el(this,aa,!0),el(this,_d,{}),el(this,Sf,{}),Wi(bs,this,e.rootTable.parentElement.parentElement),Wi(mR,this,e.rootDocument)}isClassicTheme(){return Ot(aa,this)}getCSSVariableValue(e){var n;if(Ot(aa,this))return null;if(Ot(_d,this)[`--ht-${e}`])return Ot(_d,this)[`--ht-${e}`];const r=(n=Bi(So,this,Sne).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Bi(So,this,m$).call(this,`--ht-${e}`);if(r!==null)return Ot(_d,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=Ot(Sf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Ot(aa,this))return PO;const e=Bi(So,this,yne).call(this);return!e&&we(Ot(bs,this),"ht-wrapper")?(et(`The "${Ot(yo,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Wi(aa,this,!0),this.useTheme(),PO):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Bi(So,this,xO).call(this),Wi(aa,this,!0),Wi(yo,this,e||void 0);return}e&&e!==Ot(yo,this)&&(Ot(yo,this)&&Bi(So,this,Rne).call(this),Wi(yo,this,e),Wi(aa,this,!1),Bi(So,this,Cne).call(this),Bi(So,this,xO).call(this))}getThemeName(){return Ot(yo,this)}removeClassNames(){we(Ot(bs,this),Ot(yo,this))&&pe(Ot(bs,this),Ot(yo,this))}}function yne(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Cne(){pe(Ot(bs,this),/ht-theme-.*/g),q(Ot(bs,this),Ot(yo,this))}function xO(){this.isClassicTheme()||Wi(XE,this,getComputedStyle(Ot(bs,this)));const t=Bi(So,this,bne).call(this,["box-sizing","border-bottom-width"]);Ot(Sf,this).td={...Ot(Sf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function bne(t){const e=Ot(mR,this),n=Ot(bs,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function Sne(t){const e=Math.ceil(parseFloat(Bi(So,this,m$).call(this,t)));return Number.isNaN(e)?null:e}function m$(t){const e=Ot(XE,this).getPropertyValue(t);return e===""?null:e}function Rne(){Wi(Sf,this,{}),Wi(_d,this,{}),Wi(aa,this,!0)}class Ene extends LE{constructor(e,n){super(e,new mne(n)),this.stylesHandler=new vne(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new qE(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new pne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Zte(this.wtSettings.getSetting("selections")),this.wtEvent=new o$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new dne(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];ke(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),pe(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!l$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class JE{constructor(e){e instanceof LE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new JE(n);return()=>r},this._wot=new Ene(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function OO(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Tne(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const Mne=new Map([["mousedown",OO],["mouseover",Tne],["touchstart",OO]]);function IO(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;Mne.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Av(t)||t.type==="touchstart",isRightClick:La(t)})}const p$=new WeakMap,ZE=Symbol("rootInstance");function _ne(t){p$.set(t,!0)}function Pne(t){return t===ZE}function Mp(t){return p$.has(t)}function xne(t,e){w$(t,e),e.add(t)}function Ys(t,e,n){w$(t,e),e.set(t,n)}function w$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gs(t,e,n){return(e=One(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function One(t){var e=Ine(t,"string");return typeof e=="symbol"?e:e+""}function Ine(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zt(t,e){return t.get(Hc(t,e))}function gr(t,e,n){return t.set(Hc(t,e),n),n}function Hc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var RC=new WeakMap,qg=new WeakMap,Xg=new WeakMap,ns=new WeakMap,xi=new WeakMap,EC=new WeakMap,TC=new WeakMap,Du=new WeakMap,Pd=new WeakSet;class Ane{constructor(e){xne(this,Pd),Gs(this,"hot",void 0),Gs(this,"eventManager",void 0),Gs(this,"settings",void 0),Gs(this,"THEAD",void 0),Gs(this,"TBODY",void 0),Gs(this,"_wt",void 0),Gs(this,"activeWt",void 0),Ys(this,RC,0),Ys(this,qg,0),Gs(this,"postponedAdjustElementsSize",!1),Ys(this,Xg,!1),Ys(this,ns,void 0),Ys(this,xi,void 0),Ys(this,EC,0),Ys(this,TC,0),Ys(this,Du,null),this.hot=e,this.eventManager=new vi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Hc(Pd,this,Nne).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),gr(xi,this,n.createElement("TABLE")),q(Zt(xi,this),"htCore"),this.hot.getSettings().tableClassName&&q(Zt(xi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ce(Zt(xi,this),[Ts()]),Ce(e,[r8(),ik(-1),Tv(this.hot.countCols()),w8()])),this.THEAD=n.createElement("THEAD"),Zt(xi,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Zt(xi,this).appendChild(this.TBODY),this.hot.table=Zt(xi,this),this.hot.container.insertBefore(Zt(xi,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{gr(Xg,this,!0),this.isTextSelectionAllowed(a.target)||(rR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{gr(Xg,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Zt(Xg,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&rR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&Av(a)&&r.finish(),gr(ns,this,!1);const l=xv(n.activeElement);Ld(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!La(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&La(a)&&(r.finish(),gr(ns,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),gr(ns,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Zt(ns,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=Rn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=tu(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=tu(s);this.eventManager.addEventListener(Zt(xi,this),"selectstart",a=>{this.settings.fragmentSelection||Ld(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&pe(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Zt(xi,this),isDataViewInstance:()=>Mp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),gr(qg,this,o.length),this.hot.getSettings().ariaTags&&Hc(Pd,this,v$).call(this)===this.hot.countCols()&&Hc(Pd,this,Hne).call(this,Zt(qg,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),gr(RC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,w,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,w,f),this.hot.runHooks("afterRenderer",a,l,u,g,w,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&nu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,gr(ns,this,!0),gr(Du,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ma(o)&&(IO(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,gr(ns,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ma(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ma(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ma(o)&&(Zt(ns,this)&&(!Zt(Du,this)||Zt(Du,this).x!==o.clientX||Zt(Du,this).y!==o.clientY)&&IO(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,gr(Du,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ma(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,w,y,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new JE(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Ld(e))return!0;const n=Oa(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Zt(ns,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!we(r,"relative")){Bo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;we(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(Bo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ce(a,...Ts()),Ce(l,...Ts())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(we(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):we(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?bu(e,r(n,i)):($a(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){gr(EC,this,e),gr(TC,this,n)}getLastSize(){return{width:Zt(EC,this),height:Zt(TC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Zt(RC,this)}getRowHeadersCount(){return Zt(qg,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function v$(){return parseInt(this.hot.rootElement.getAttribute(Tv()[0]),10)}function Hne(t){const e=Hc(Pd,this,v$).call(this)+t;Ce(this.hot.rootElement,...Tv(e))}function Nne(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):pe(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):pe(t,"htHasScrollX")}var Dne=yt,kne=mn,$ne=nh,Lne=Ar,Fne=wn,Vne=zo,Wne=Xr,Bne=Ba,MC=Bne("every",TypeError);Dne({target:"Iterator",proto:!0,real:!0,forced:MC},{every:function(e){Fne(this);try{Lne(e)}catch(i){Wne(this,"throw",i)}if(MC)return kne(MC,this,e);var n=Vne(this),r=0;return!$ne(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const y$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",pR=y$.length;function $v(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%pR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/pR,10);return n}function jne(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=pR**r*(y$.indexOf(t[n])+1);return e-=1,e}function Une(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push($v(i)+(r+1));n.push(o)}return n}function zne(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=$v(i)+(r+1);n.push(o)}return n}function Yne(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function QE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function eT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&De(t[0])&&(e=Iv(t[0]))),e}function C$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function b$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const Gne=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:eT,createEmptySpreadsheetData:Yne,createSpreadsheetData:Une,createSpreadsheetObjectData:zne,dataRowToChangesArray:QE,isArrayOfArrays:C$,isArrayOfObjects:b$,spreadsheetColumnIndex:jne,spreadsheetColumnLabel:$v},Symbol.toStringTag,{value:"Module"}));function Fh(t,e,n){return(e=Kne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kne(t){var e=qne(t,"string");return typeof e=="symbol"?e:e+""}function qne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xne{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Fh(this,"hot",void 0),Fh(this,"data",void 0),Fh(this,"dataType","array"),Fh(this,"colToProp",()=>{}),Fh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return T(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(De(a)||at(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Rp(l,d,f):l[d]=f}})}else ke(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Rp(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Or(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Rp(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?_k(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Or(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return eT(this.data)}destroy(){this.data=null,this.hot=null}}var Jne=yt,Zne=mn,Qne=nh,ere=Ar,tre=wn,nre=zo,rre=Xr,ire=Ba,_C=ire("some",TypeError);Jne({target:"Iterator",proto:!0,real:!0,forced:_C},{some:function(e){tre(this);try{ere(e)}catch(i){rre(this,"throw",i)}if(_C)return Zne(_C,this,e);var n=nre(this),r=0;return Qne(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function AO(t,e,n){return(e=ore(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ore(t){var e=sre(t,"string");return typeof e=="symbol"?e:e+""}function sre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Su{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;AO(this,"indexedValues",[]),AO(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,at(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ft(Su,kn);function tT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>at(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function nT(t,e){return Da(t,(n,r)=>e.includes(r)===!1)}class ja extends Su{insert(e,n){this.indexedValues=tT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=nT(this.indexedValues,e),super.remove(e)}}class Lv extends ja{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return vn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function rT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Rf(t,e){return Da(t,n=>e.includes(n)===!1)}function iT(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function oT(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function are(t,e,n){return(e=lre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lre(t){var e=ure(t,"string");return typeof e=="symbol"?e:e+""}function ure(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fv extends Su{constructor(){super(...arguments),are(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Rf(this.orderOfIndexes,[e]),at(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=tT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=oT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=nT(this.indexedValues,e),this.orderOfIndexes=Rf(this.orderOfIndexes,e),this.orderOfIndexes=iT(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class ug extends ja{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return vn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const HO=new Map([["indexesSequence",{getListWithInsertedItems:rT,getListWithRemovedItems:Rf}],["physicallyIndexed",{getListWithInsertedItems:tT,getListWithRemovedItems:nT}]]),S$=t=>{if(HO.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return HO.get(t)};class R$ extends Su{constructor(){super(e=>e)}insert(e,n){const r=oT(this.indexedValues,n);this.indexedValues=rT(r,e,n),super.insert(e,n)}remove(e){const n=Rf(this.indexedValues,e);this.indexedValues=iT(n,e),super.remove(e)}}const NO=new Map([["hiding",Lv],["index",Su],["linkedPhysicalIndexToValue",Fv],["physicalIndexToValue",ja],["trimming",ug]]);function cre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!NO.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(NO.get(t))(e)}function hre(t,e,n){return(e=dre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dre(t){var e=fre(t,"string");return typeof e=="symbol"?e:e+""}function fre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let wR=0;class sT{constructor(){hre(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),wR+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),wR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return It(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ft(sT,kn);function gre(){return wR}function PC(t,e,n){return(e=mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mre(t){var e=pre(t,"string");return typeof e=="symbol"?e:e+""}function pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DO extends sT{constructor(e,n){super(),PC(this,"mergedValuesCache",[]),PC(this,"aggregationFunction",void 0),PC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function wre(t,e,n){vre(t,e),e.set(t,n)}function vre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yre(t,e,n){return t.set(E$(t,e),n),n}function Cre(t,e){return t.get(E$(t,e))}function E$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xC=new WeakMap;class T${constructor(){wre(this,xC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Cre(xC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){yre(xC,this,e)}}ft(T$,kn);function kO(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Vh(t,e,n){bre(t,e),e.set(t,n)}function bre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ii(t,e){return t.get(M$(t,e))}function Jg(t,e,n){return t.set(M$(t,e),n),n}function M$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zg=new WeakMap,Wh=new WeakMap,Qg=new WeakMap,em=new WeakMap,tm=new WeakMap;class Sre{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Vh(this,Zg,new Set),Vh(this,Wh,[]),Vh(this,Qg,[]),Vh(this,em,!1),Vh(this,tm,!1),Jg(tm,this,e??!1)}createObserver(){const e=new T$;return ii(Zg,this).add(e),e.addLocalHook("unsubscribe",()=>{ii(Zg,this).delete(e)}),e._writeInitialChanges(kO(ii(Wh,this),ii(Qg,this))),e}emit(e){let n=ii(Qg,this);(!ii(em,this)||ii(Wh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(ii(tm,this)):Jg(Wh,this,new Array(e.length).fill(ii(tm,this))),ii(em,this)||(Jg(em,this,!0),n=ii(Wh,this)));const r=kO(n,e);ii(Zg,this).forEach(i=>i._write(r)),Jg(Qg,this,e)}}function Qn(t,e,n){return(e=Rre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rre(t){var e=Ere(t,"string");return typeof e=="symbol"?e:e+""}function Ere(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vR{constructor(){Qn(this,"indexesSequence",new R$),Qn(this,"trimmingMapsCollection",new DO(e=>e.some(n=>n===!0),!1)),Qn(this,"hidingMapsCollection",new DO(e=>e.some(n=>n===!0),!1)),Qn(this,"variousMapsCollection",new sT),Qn(this,"hidingChangesObservable",new Sre({initialIndexValue:!1})),Qn(this,"notTrimmedIndexesCache",[]),Qn(this,"notHiddenIndexesCache",[]),Qn(this,"isBatched",!1),Qn(this,"indexesSequenceChanged",!1),Qn(this,"indexesChangeSource",void 0),Qn(this,"trimmedIndexesChanged",!1),Qn(this,"hiddenIndexesChanged",!1),Qn(this,"renderablePhysicalIndexesCache",[]),Qn(this,"fromPhysicalToVisualIndexesCache",new Map),Qn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,cre(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof ug?this.trimmingMapsCollection.register(e,n):n instanceof Lv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Rf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(rT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}ft(vR,kn);function Tre(t,e){return ke(e,(n,r)=>{It(t[r])&&(t[r]=n)}),t}function _$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function P$(t){le(t)&&PE(ut`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Mre(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:_re,getValues:Pre}=Qi("phraseFormatters");function xre(t,e){_re(t,e)}function Ore(){return Pre()}xre("pluralize",Mre);const x$="ContextMenu:items",xe=x$,aT=`${xe}.noItems`,lT=`${xe}.insertRowAbove`,uT=`${xe}.insertRowBelow`,cT=`${xe}.insertColumnOnTheLeft`,hT=`${xe}.insertColumnOnTheRight`,dT=`${xe}.removeRow`,fT=`${xe}.removeColumn`,gT=`${xe}.undo`,mT=`${xe}.redo`,yw=`${xe}.readOnly`,pT=`${xe}.clearColumn`,wT=`${xe}.copy`,vT=`${xe}.copyWithHeaders`,yT=`${xe}.copyWithGroupHeaders`,CT=`${xe}.copyHeadersOnly`,bT=`${xe}.cut`,ST=`${xe}.freezeColumn`,RT=`${xe}.unfreezeColumn`,ET=`${xe}.mergeCells`,TT=`${xe}.unmergeCells`,MT=`${xe}.addComment`,_T=`${xe}.editComment`,PT=`${xe}.removeComment`,xT=`${xe}.readOnlyComment`,OT=`${xe}.align`,IT=`${xe}.align.left`,AT=`${xe}.align.center`,HT=`${xe}.align.right`,NT=`${xe}.align.justify`,DT=`${xe}.align.top`,kT=`${xe}.align.middle`,$T=`${xe}.align.bottom`,LT=`${xe}.borders`,FT=`${xe}.borders.top`,VT=`${xe}.borders.right`,WT=`${xe}.borders.bottom`,BT=`${xe}.borders.left`,jT=`${xe}.borders.remove`,UT=`${xe}.nestedHeaders.insertChildRow`,zT=`${xe}.nestedHeaders.detachFromParent`,YT=`${xe}.hideColumn`,GT=`${xe}.showColumn`,KT=`${xe}.hideRow`,qT=`${xe}.showRow`,hr="Filters:",Ut=`${hr}conditions`,Vv=`${Ut}.none`,XT=`${Ut}.isEmpty`,JT=`${Ut}.isNotEmpty`,ZT=`${Ut}.isEqualTo`,QT=`${Ut}.isNotEqualTo`,eM=`${Ut}.beginsWith`,tM=`${Ut}.endsWith`,nM=`${Ut}.contains`,rM=`${Ut}.doesNotContain`,Ire=`${Ut}.byValue`,iM=`${Ut}.greaterThan`,oM=`${Ut}.greaterThanOrEqualTo`,sM=`${Ut}.lessThan`,aM=`${Ut}.lessThanOrEqualTo`,lM=`${Ut}.isBetween`,uM=`${Ut}.isNotBetween`,cM=`${Ut}.after`,hM=`${Ut}.before`,dM=`${Ut}.today`,fM=`${Ut}.tomorrow`,gM=`${Ut}.yesterday`,mM=`${hr}labels.filterByCondition`,pM=`${hr}labels.filterByValue`,wM=`${hr}labels.conjunction`,Wv=`${hr}labels.disjunction`,Cw=`${hr}values.blankCells`,vM=`${hr}buttons.selectAll`,yM=`${hr}buttons.clear`,CM=`${hr}buttons.ok`,bM=`${hr}buttons.cancel`,SM=`${hr}buttons.placeholder.search`,RM=`${hr}buttons.placeholder.value`,EM=`${hr}buttons.placeholder.secondValue`,TM="CheckboxRenderer:",MM=`${TM}checked`,_M=`${TM}unchecked`,Are=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:MM,CHECKBOX_RENDERER_NAMESPACE:TM,CHECKBOX_UNCHECKED:_M,CONTEXTMENU_ITEMS_ADD_COMMENT:MT,CONTEXTMENU_ITEMS_ALIGNMENT:OT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:$T,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:AT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:NT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:IT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:kT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:HT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:DT,CONTEXTMENU_ITEMS_BORDERS:LT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:WT,CONTEXTMENU_ITEMS_BORDERS_LEFT:BT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:VT,CONTEXTMENU_ITEMS_BORDERS_TOP:FT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:pT,CONTEXTMENU_ITEMS_COPY:wT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:CT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:yT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:vT,CONTEXTMENU_ITEMS_CUT:bT,CONTEXTMENU_ITEMS_EDIT_COMMENT:_T,CONTEXTMENU_ITEMS_FREEZE_COLUMN:ST,CONTEXTMENU_ITEMS_HIDE_COLUMN:YT,CONTEXTMENU_ITEMS_HIDE_ROW:KT,CONTEXTMENU_ITEMS_INSERT_LEFT:cT,CONTEXTMENU_ITEMS_INSERT_RIGHT:hT,CONTEXTMENU_ITEMS_MERGE_CELLS:ET,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:zT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:UT,CONTEXTMENU_ITEMS_NO_ITEMS:aT,CONTEXTMENU_ITEMS_READ_ONLY:yw,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:xT,CONTEXTMENU_ITEMS_REDO:mT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:jT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:fT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:PT,CONTEXTMENU_ITEMS_REMOVE_ROW:dT,CONTEXTMENU_ITEMS_ROW_ABOVE:lT,CONTEXTMENU_ITEMS_ROW_BELOW:uT,CONTEXTMENU_ITEMS_SHOW_COLUMN:GT,CONTEXTMENU_ITEMS_SHOW_ROW:qT,CONTEXTMENU_ITEMS_UNDO:gT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:RT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:TT,CONTEXT_MENU_ITEMS_NAMESPACE:x$,FILTERS_BUTTONS_CANCEL:bM,FILTERS_BUTTONS_CLEAR:yM,FILTERS_BUTTONS_OK:CM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:SM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:EM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:RM,FILTERS_BUTTONS_SELECT_ALL:vM,FILTERS_CONDITIONS_AFTER:cM,FILTERS_CONDITIONS_BEFORE:hM,FILTERS_CONDITIONS_BEGINS_WITH:eM,FILTERS_CONDITIONS_BETWEEN:lM,FILTERS_CONDITIONS_BY_VALUE:Ire,FILTERS_CONDITIONS_CONTAINS:nM,FILTERS_CONDITIONS_EMPTY:XT,FILTERS_CONDITIONS_ENDS_WITH:tM,FILTERS_CONDITIONS_EQUAL:ZT,FILTERS_CONDITIONS_GREATER_THAN:iM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:oM,FILTERS_CONDITIONS_LESS_THAN:sM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:aM,FILTERS_CONDITIONS_NAMESPACE:Ut,FILTERS_CONDITIONS_NONE:Vv,FILTERS_CONDITIONS_NOT_BETWEEN:uM,FILTERS_CONDITIONS_NOT_CONTAIN:rM,FILTERS_CONDITIONS_NOT_EMPTY:JT,FILTERS_CONDITIONS_NOT_EQUAL:QT,FILTERS_CONDITIONS_TODAY:dM,FILTERS_CONDITIONS_TOMORROW:fM,FILTERS_CONDITIONS_YESTERDAY:gM,FILTERS_DIVS_FILTER_BY_CONDITION:mM,FILTERS_DIVS_FILTER_BY_VALUE:pM,FILTERS_LABELS_CONJUNCTION:wM,FILTERS_LABELS_DISJUNCTION:Wv,FILTERS_NAMESPACE:hr,FILTERS_VALUES_BLANK_CELLS:Cw},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const O$={languageCode:"en-US",[aT]:"No available options",[lT]:"Insert row above",[uT]:"Insert row below",[cT]:"Insert column left",[hT]:"Insert column right",[dT]:["Remove row","Remove rows"],[fT]:["Remove column","Remove columns"],[gT]:"Undo",[mT]:"Redo",[yw]:"Read only",[pT]:"Clear column",[OT]:"Alignment",[IT]:"Left",[AT]:"Center",[HT]:"Right",[NT]:"Justify",[DT]:"Top",[kT]:"Middle",[$T]:"Bottom",[ST]:"Freeze column",[RT]:"Unfreeze column",[LT]:"Borders",[FT]:"Top",[VT]:"Right",[WT]:"Bottom",[BT]:"Left",[jT]:"Remove border(s)",[MT]:"Add comment",[_T]:"Edit comment",[PT]:"Delete comment",[xT]:"Read-only comment",[ET]:"Merge cells",[TT]:"Unmerge cells",[wT]:"Copy",[vT]:["Copy with header","Copy with headers"],[yT]:["Copy with group header","Copy with group headers"],[CT]:["Copy header only","Copy headers only"],[bT]:"Cut",[UT]:"Insert child row",[zT]:"Detach from parent",[YT]:["Hide column","Hide columns"],[GT]:["Show column","Show columns"],[KT]:["Hide row","Hide rows"],[qT]:["Show row","Show rows"],[Vv]:"None",[XT]:"Is empty",[JT]:"Is not empty",[ZT]:"Is equal to",[QT]:"Is not equal to",[eM]:"Begins with",[tM]:"Ends with",[nM]:"Contains",[rM]:"Does not contain",[iM]:"Greater than",[oM]:"Greater than or equal to",[sM]:"Less than",[aM]:"Less than or equal to",[lM]:"Is between",[uM]:"Is not between",[cM]:"After",[hM]:"Before",[dM]:"Today",[fM]:"Tomorrow",[gM]:"Yesterday",[Cw]:"Blank cells",[mM]:"Filter by condition",[pM]:"Filter by value",[wM]:"And",[Wv]:"Or",[vM]:"Select all",[yM]:"Clear",[CM]:"OK",[bM]:"Cancel",[SM]:"Search",[RM]:"Value",[EM]:"Second value",[MM]:"Checked",[_M]:"Unchecked"},Hre=Are,yR=O$.languageCode,{register:Nre,getItem:I$,hasItem:Dre,getValues:kre}=Qi("languagesDictionaries");A$(O$);function A$(t,e){let n=t,r=e;return De(t)&&(r=t,n=r.languageCode),$re(n,r),Nre(n,Xn(r)),Xn(r)}function $re(t,e){t!==yR&&Tre(e,I$(yR))}function H$(t){return PM(t)?Xn(I$(t)):null}function PM(t){return Dre(t)}function Lre(){return kre()}function N$(t,e,n){const r=H$(t);if(r===null)return null;const i=r[e];if(It(i))return null;const o=Fre(i,n);return Array.isArray(o)?o[0]:o}function Fre(t,e){let n=t;return T(Ore(),r=>{n=r(t,e)}),n}function Vre(t){let e=_$(t);return PM(e)||(e=yR,P$(t)),e}function Wre(t,e,n){return(e=Bre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bre(t){var e=jre(t,"string");return typeof e=="symbol"?e:e+""}function jre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bs extends u${constructor(e,n){super(e,null),Wre(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function OC(t){let{activeHeaderClassName:e,...n}=t;return new Bs({className:e,...n,selectionType:c$})}function Ure(t){let{areaCornerVisible:e,...n}=t;return new Bs({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:jE})}function zre(t){let{...e}=t;return new Bs({className:"highlight",...e,selectionType:jE})}function Yre(t){let{columnClassName:e,...n}=t;return new Bs({className:e,...n,selectionType:zte})}function Gre(t){let{cellCornerVisible:e,...n}=t;return new Bs({className:"current",headerAttributes:[hE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Fd})}function Kre(t){let{border:e,visualCellRange:n,...r}=t;return new Bs({...e,...r,selectionType:Yte},n)}function qre(t){let{...e}=t;return new Bs({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:jte})}function $O(t){let{headerClassName:e,...n}=t;return new Bs({className:e,...n,selectionType:BE})}function Xre(t){let{rowClassName:e,...n}=t;return new Bs({className:e,...n,selectionType:Ute})}function Jre(t,e){Zre(t,e),e.add(t)}function Zre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mr(t,e,n){return(e=Qre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qre(t){var e=eie(t,"string");return typeof e=="symbol"?e:e+""}function eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var so=new WeakSet;class tie{constructor(e){Jre(this,so),mr(this,"options",void 0),mr(this,"layerLevel",0),mr(this,"focus",void 0),mr(this,"fill",void 0),mr(this,"layeredAreas",new Map),mr(this,"areas",new Map),mr(this,"rowHeaders",new Map),mr(this,"columnHeaders",new Map),mr(this,"activeRowHeaders",new Map),mr(this,"activeColumnHeaders",new Map),mr(this,"activeCornerHeaders",new Map),mr(this,"rowHighlights",new Map),mr(this,"columnHighlights",new Map),mr(this,"customSelections",[]),this.options=e,this.focus=Gre(e),this.fill=qre(e)}isEnabledFor(e,n){let r=e;e===Fd&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return rs(so,this,is).call(this,this.layeredAreas,Ure)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return rs(so,this,is).call(this,this.areas,zre)}getAreas(){return[...this.areas.values()]}createRowHeader(){return rs(so,this,is).call(this,this.rowHeaders,$O)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return rs(so,this,is).call(this,this.columnHeaders,$O)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return rs(so,this,is).call(this,this.activeRowHeaders,OC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return rs(so,this,is).call(this,this.activeColumnHeaders,OC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return rs(so,this,is).call(this,this.activeCornerHeaders,OC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return rs(so,this,is).call(this,this.rowHighlights,Xre)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return rs(so,this,is).call(this,this.columnHighlights,Yre)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Kre({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),T(this.areas.values(),e=>void e.clear()),T(this.layeredAreas.values(),e=>void e.clear()),T(this.rowHeaders.values(),e=>void e.clear()),T(this.columnHeaders.values(),e=>void e.clear()),T(this.activeRowHeaders.values(),e=>void e.clear()),T(this.activeColumnHeaders.values(),e=>void e.clear()),T(this.activeCornerHeaders.values(),e=>void e.clear()),T(this.rowHighlights.values(),e=>void e.clear()),T(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function is(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function LO(t,e,n){return(e=nie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nie(t){var e=rie(t,"string");return typeof e=="symbol"?e:e+""}function rie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iie{constructor(e){LO(this,"ranges",[]),LO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function oie(t,e){D$(t,e),e.add(t)}function IC(t,e,n){D$(t,e),e.set(t,n)}function D$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(hn(t,e))}function nm(t,e,n){return t.set(hn(t,e),n),n}function hn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rm=new WeakMap,St=new WeakMap,Yi=new WeakMap,Cn=new WeakSet;class CR{constructor(e,n){oie(this,Cn),IC(this,rm,void 0),IC(this,St,void 0),IC(this,Yi,{x:0,y:0}),nm(rm,this,e),nm(St,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Je(St,this).createCellCoords(e,n);let o=Je(rm,this).current().highlight;const s=Je(St,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=hn(Cn,this,k$).call(this),{row:h,col:d}=hn(Cn,this,VO).call(this,o),f=Je(St,this).fixedRowsBottom(),g=Je(St,this).minSpareRows(),w=Je(St,this).minSpareCols(),y=Je(St,this).autoWrapRow(),E=Je(St,this).autoWrapCol(),C=Je(St,this).createCellCoords(h+i.row,d+i.col);if(C.row>=c){const $=Or(r&&g>0&&f===0),I=C.col+1,M=Je(St,this).createCellCoords(C.row-c,I>=u?I-u:I);this.runLocalHooks("beforeColumnWrap",$,hn(Cn,this,ku).call(this,M),I>=u),$.value?this.runLocalHooks("insertRowRequire",Je(St,this).countRenderableRows()):E&&C.assign(M)}else if(C.row<0){const $=Or(E),I=C.col-1,M=Je(St,this).createCellCoords(c+C.row,I<0?u+I:I);this.runLocalHooks("beforeColumnWrap",$,hn(Cn,this,ku).call(this,M),I<0),E&&C.assign(M)}if(C.col>=u){const $=Or(r&&w>0),I=C.row+1,M=Je(St,this).createCellCoords(I>=c?I-c:I,C.col-u);this.runLocalHooks("beforeRowWrap",$,hn(Cn,this,ku).call(this,M),I>=c),$.value?this.runLocalHooks("insertColRequire",Je(St,this).countRenderableColumns()):y&&C.assign(M)}else if(C.col<0){const $=Or(y),I=C.row-1,M=Je(St,this).createCellCoords(I<0?c+I:I,u+C.col);this.runLocalHooks("beforeRowWrap",$,hn(Cn,this,ku).call(this,M),I<0),y&&C.assign(M)}const{rowDir:A,colDir:_}=hn(Cn,this,FO).call(this,C);a=A,l=_,o=hn(Cn,this,ku).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Je(St,this).createCellCoords(e,n),i=Je(rm,this).current(),o=Je(St,this).visualToRenderableCoords(i.highlight),s=hn(Cn,this,AC).call(this,i.to.row,i.from.row),a=hn(Cn,this,HC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=hn(Cn,this,VO).call(this,i.highlight),f=Je(St,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),w=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const _=f.col-d;f.col=hn(Cn,this,HC).call(this,g.col,w.col)+_}else if(r.col>0&&a<=d&&f.col>d){const _=hn(Cn,this,HC).call(this,w.col,g.col),$=Math.max(f.col-_,1);f.col=_+$}if(r.row<0&&s>=h&&f.row<h){const _=f.row-h;f.row=hn(Cn,this,AC).call(this,g.row,y.row)+_}else if(r.row>0&&s<=h&&f.row>h){const _=hn(Cn,this,AC).call(this,y.row,g.row),$=Math.max(f.row-_,1);f.row=_+$}const{rowDir:E,colDir:C}=hn(Cn,this,FO).call(this,f);u=E,c=C;const A=hn(Cn,this,ku).call(this,f);r.row===0&&r.col!==0?l.col=A.col:r.row!==0&&r.col===0?l.row=A.row:(l.row=A.row,l.col=A.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;nm(Yi,this,{x:n,y:r})}resetOffsetSize(){nm(Yi,this,{x:0,y:0})}}function FO(t){const{width:e,height:n}=hn(Cn,this,k$).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function k$(){return{width:Je(Yi,this).x+Je(St,this).countRenderableColumns(),height:Je(Yi,this).y+Je(St,this).countRenderableRows()}}function AC(t,e){const n=Je(St,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Je(Yi,this).y+n}function HC(t,e){const n=Je(St,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Je(Yi,this).x+n}function VO(t){const{row:e,col:n}=Je(St,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Je(St,this).createCellCoords(Je(Yi,this).y+e,Je(Yi,this).x+n)}function ku(t){const e=t.clone();return e.col=t.col-Je(Yi,this).x,e.row=t.row-Je(Yi,this).y,Je(St,this).renderableToVisualCoords(e)}ft(CR,kn);const Bv=0,jv=1,$$=2,xM=3,sie=[xM,$$],aie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],NC=Symbol("root"),WO=Symbol("child");function Uc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NC;if(e!==NC&&e!==WO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===NC;let i=Bv;if(n){const o=t[0];t.length===0?i=jv:r&&o instanceof sg?i=xM:r&&Array.isArray(o)?i=Uc(o,WO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!aie[l].includes(typeof a))&&(i=$$)}return i}function Ef(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!sie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===xM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),It(u)&&(u=a),It(c)&&(c=l),!r){const f=a,g=l,w=u,y=c;a=Math.min(f,w),l=Math.min(g,y),u=Math.max(f,w),c=Math.max(g,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function lie(t){const e=Uc(t.getSelected());if(e===Bv||e===jv)return[];const n=Ef(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;T(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return vn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function uie(t){const e=Uc(t.getSelected());if(e===Bv||e===jv)return[];const n=Ef(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;T(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return vn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function $u(t,e,n){cie(t,e),e.set(t,n)}function cie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tl(t,e,n){return(e=hie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hie(t){var e=die(t,"string");return typeof e=="symbol"?e:e+""}function die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pt(t,e){return t.get(L$(t,e))}function ao(t,e,n){return t.set(L$(t,e),n),n}function L$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ln=new WeakMap,nl=new WeakMap,im=new WeakMap,Bh=new WeakMap,om=new WeakMap,jh=new WeakMap;class F${constructor(e,n){var r=this;tl(this,"settings",void 0),tl(this,"tableProps",void 0),tl(this,"inProgress",!1),tl(this,"selectedRange",new iie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),tl(this,"highlight",void 0),$u(this,Ln,void 0),$u(this,nl,void 0),tl(this,"selectedByRowHeader",new Set),tl(this,"selectedByColumnHeader",new Set),$u(this,im,!1),$u(this,Bh,!1),$u(this,om,"unknown"),$u(this,jh,-1),this.settings=e,this.tableProps=n,this.highlight=new tie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[hE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),ao(Ln,this,new CR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),ao(nl,this,new CR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Pt(Ln,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Pt(Ln,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Pt(Ln,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Pt(Ln,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Pt(Ln,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Pt(Ln,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Pt(Ln,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Pt(Ln,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Pt(nl,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Pt(nl,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){ao(om,this,e)}markEndSource(){ao(om,this,"unknown")}getSelectionSource(){return Pt(om,this)}setExpectedLayers(e){ao(jh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,ao(jh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=It(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();ao(im,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&It(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Pt(jh,this)===-1||this.selectedRange.size()===Pt(jh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(T(this.highlight.getAreas(),g=>void g.clear()),T(this.highlight.getLayeredAreas(),g=>void g.clear()),T(this.highlight.getRowHeaders(),g=>void g.clear()),T(this.highlight.getColumnHeaders(),g=>void g.clear()),T(this.highlight.getActiveRowHeaders(),g=>void g.clear()),T(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),T(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),T(this.highlight.getRowHighlights(),g=>void g.clear()),T(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(jE,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(BE,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),A=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(C).commit(),d.add(y).commit(),f.add(C).commit()):(a.add(y).add(E).commit(),l.add(C).add(A).commit(),d.add(y).add(E).commit(),f.add(C).add(A).commit())}const g=!Pt(Bh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!Pt(Bh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Fd,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(ao(im,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Pt(Ln,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Pt(Ln,this).resetOffsetSize(),this.setRangeStart(Pt(Ln,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?Pt(Ln,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Pt(Ln,this).resetOffsetSize(),this.setRangeEnd(Pt(Ln,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?Pt(nl,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Pt(nl,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Pt(nl,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ye(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ye(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ye(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ye(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ye(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ye(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Or(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Pt(im,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;ao(Bh,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ye(d.row,u,o-1),Ye(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),ao(Bh,this,!1)}selectCells(e){var n=this;const r=Uc(e);if(r===jv)return!1;if(r===Bv)throw new Error(ut`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Ef(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),T(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ye(r.row,u,s-1),g=Ye(r.col,Math.min(i,o),Math.max(i,o))):(f=Ye(r,u,s-1),g=i);const w=this.tableProps.createCellCoords(f,g),y=l===0?0:Ye(w.row,u,-1),E=s-1,C=this.tableProps.createCellCoords(y,i),A=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",C,A,w),C.row=y,A.row=E,this.setRangeStartOnly(C,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(A),this.runLocalHooks("afterSelectColumns",C,A,w),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ye(r.row,Math.min(e,n),Math.max(e,n)),d=Ye(r.col,a,o-1)):(h=e,d=Ye(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Ye(f.col,a,-1),w=o-1,y=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",y,E,f),y.col=g,E.col=w,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",y,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Ye(s.row,-1/0,e-1),col:Ye(s.col,-1/0,n-1)}),i.assign({row:Ye(i.row,-1/0,e-1),col:Ye(i.col,-1/0,n-1)}),o.assign({row:Ye(o.row,0,e-1),col:Ye(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(Fd,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Fd,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ft(F$,kn);const BO=/^(\r\n|\n\r|\r|\n)/,fie=/^[^\t\r\n]+/,jO=/^\t/;function gie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(jO))t=t.replace(jO,""),n+=1,e[r][n]="";else if(t.match(BO))t=t.replace(BO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(fie);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Wd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function rl(t,e,n){return(e=mie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mie(t){var e=pie(t,"string");return typeof e=="symbol"?e:e+""}function pie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){rl(this,"hot",void 0),rl(this,"metaManager",void 0),rl(this,"tableMeta",void 0),rl(this,"dataSource",void 0),rl(this,"duckSchema",void 0),rl(this,"colToPropCache",void 0),rl(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Iv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(De(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return eT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&ke(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Bc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Xn(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},ig(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const w=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(w,n));const y=this.hot.toVisualColumn(w);return this.hot.runHooks("afterCreateCol",y,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:w}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];JS(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return qD(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];JS(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&nn(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Or(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Or(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&nn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Cc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Cc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Wd(this.getRange(e,n,Cc.DESTINATION_RENDERER))}getCopyableText(e,n){return Wd(this.getRange(e,n,Cc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:wie,getItem:vie,hasItem:V$,getNames:yie,getValues:jRe}=Qi("cellTypes");function OM(t){if(!V$(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return vie(t)}function oi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Rr(t,n),r&&Fr(t,r),i&&Wl(t,i),wie(t,e)}function Cie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!nn(e,t)}function Uv(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?OM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ke(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!De(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};ke(r,(o,s)=>{if(Cie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),on(t,i)}function bie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Mk(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function _p(t){return Number.isInteger(t)&&t>=0}function Pp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function sm(t){return t==null}const W$=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),jt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),jt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Ov(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function UO(t,e,n){return(e=Sie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sie(t){var e=Rie(t,"string");return typeof e=="symbol"?e:e+""}function Rie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eie(){return class{}}class Tie{constructor(e){UO(this,"metaCtor",Eie()),UO(this,"meta",void 0),this.meta=this.metaCtor.prototype,on(this.meta,W$()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;on(this.meta,e),Uv(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Mie(t,e,n){return(e=_ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=Pie(t,"string");return typeof e=="symbol"?e:e+""}function Pie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xie{constructor(e){Mie(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){on(this.meta,e),Uv(this.meta,e,e)}}function am(t,e,n){return(e=Oie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oie(t){var e=Iie(t,"string");return typeof e=="symbol"?e:e+""}function Iie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bw{constructor(e){am(this,"valueFactory",void 0),am(this,"data",[]),am(this,"index",[]),am(this,"holes",new Set),this.valueFactory=e}obtain(e){Pp(()=>_p(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Pp(()=>_p(e)||sm(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=sm(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Pp(()=>_p(e)||sm(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(sm(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function zO(t,e,n){return(e=Aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aie(t){var e=Hie(t,"string");return typeof e=="symbol"?e:e+""}function Hie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Nie=["data","width"];class Die{constructor(e){zO(this,"globalMeta",void 0),zO(this,"metas",new bw(()=>this._createMeta())),this.globalMeta=e,this.metas=new bw(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);on(r,n),Uv(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return bie(this.globalMeta.getMetaConstructor(),Nie).prototype}}function YO(t,e,n){return(e=kie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kie(t){var e=$ie(t,"string");return typeof e=="symbol"?e:e+""}function $ie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lie{constructor(e){YO(this,"columnMeta",void 0),YO(this,"metas",new bw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);on(i,r),Uv(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Pp(()=>_p(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new bw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class B${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Tie(e),this.tableMeta=new xie(this.globalMeta),this.columnMeta=new Die(this.globalMeta),this.cellMeta=new Lie(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ft(B$,kn);function GO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=qn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":at(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Cc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let w,y=0,E=0;for(y=0,E=d.startRows;y<E;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)w=Xn(g),t.push(w);else if(i.dataType==="array")w=Xn(g[0]),t.push(w);else{w=[];for(let C=0,A=d.startCols;C<A;C++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ce(i.rootElement,[ik(-1),Tv(i.countCols()+(i.view?i.countRowHeaders():0))])}function KO(t,e,n){return(e=Fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fie(t){var e=Vie(t,"string");return typeof e=="symbol"?e:e+""}function Vie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wie{constructor(e){var n=this;KO(this,"metaManager",void 0),KO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ie.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=nn(e,"type")?e.type:null;let c=at(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Bie(t,e,n){jie(t,e),e.set(t,n)}function jie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DC(t,e,n){return(e=Uie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uie(t){var e=zie(t,"string");return typeof e=="symbol"?e:e+""}function zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yie(t,e){return t.get(Gie(t,e))}function Gie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qO=new WeakMap;class Kie{constructor(e){DC(this,"metaManager",void 0),DC(this,"usageTracker",new Set),DC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Bie(this,qO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,Yie(qO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const j$="gridDefault",Ua="editorManager.handlingEditor",qie={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Xie="hooksRefRegisterer",U$={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){T(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ke(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Ko(U$,"MIXIN_NAME",Xie,{writable:!1,enumerable:!1});function Oi(t,e,n){return(e=Jie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jie(t){var e=Zie(t,"string");return typeof e=="symbol"?e:e+""}function Zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qie="base",Kt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class uh{static get EDITOR_TYPE(){return Qie}constructor(e){Oi(this,"hot",void 0),Oi(this,"state",Kt.VIRGIN),Oi(this,"_opened",!1),Oi(this,"_fullEditMode",!1),Oi(this,"_closeCallback",null),Oi(this,"TD",null),Oi(this,"row",null),Oi(this,"col",null),Oi(this,"prop",null),Oi(this,"originalValue",null),Oi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Kt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Kt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Kt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Rt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Kt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Kt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Kt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Kt.FINISHED,this.discardEditor(s)}):(this.state=Kt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Kt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Kt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Kt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Kt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Kt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Dn(n),a=Xt(n),l=Dn(this.hot.rootElement),u=Xt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:w}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=w.name,E=["master","inline_start"].includes(y)?d:0,C=["master","top","bottom"].includes(y)?f:0,A=s.top===l.top?0:1;let _=s.top-l.top-A-E,$=0;this.hot.isRtl()?$=o.innerWidth-s.left-a-g-1+C:$=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(y)&&(_+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&($+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const I=this.hot.hasColHeaders(),M=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),G=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),W=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(I&&M<=0||M===W)&&(_+=1),G<=0&&($+=1);const Q=i.rowsRenderCalculator.startPosition,J=i.columnsRenderCalculator.startPosition,ee=Math.abs(r.inlineStartOverlay.getScrollPosition()),se=r.topOverlay.getScrollPosition(),be=Rn(this.hot.rootDocument);let gt=n.offsetTop;if(["inline_start","master"].includes(y)&&(gt+=Q-se),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:K,wtTable:X}=r.bottomOverlay.clone;gt+=K.getWorkspaceHeight()-X.getHeight()-be}let Re=n.offsetLeft;this.hot.isRtl()?(Re>=0?Re=w.getWidth()-n.offsetLeft:Re=Math.abs(Re),Re+=J-ee-a):["top","master","bottom"].includes(y)&&(Re+=J-ee);const Ae=o.getComputedStyle(this.TD),it=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",En=parseInt(Ae[it],10)>0?0:1,ot=parseInt(Ae.borderTopWidth,10)>0?0:1,m=Xt(n)+En,v=rn(n)+ot,p=wE(c)?be:0,x=vE(h)?be:0,L=this.hot.view.maximumVisibleElementWidth(Re)-p+En,U=Math.max(this.hot.view.maximumVisibleElementHeight(gt)-x+ot,this.hot.view.getDefaultRowHeight());return{top:_,start:$,height:v,maxHeight:U,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ft(uh,U$);const eoe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Kt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},toe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},noe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},roe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},ioe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Ei(e))}};function ooe(){return[qie,eoe,toe,noe,roe,ioe]}const soe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},aoe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},loe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},uoe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},coe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},hoe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},doe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},foe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},goe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},moe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},poe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},woe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},voe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},yoe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Coe(){return[soe,aoe,loe,uoe,coe,hoe,doe,foe,goe,moe,poe,woe,voe,yoe]}const boe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Soe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Roe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},Eoe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},Toe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Moe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},_oe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},Poe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},xoe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Ooe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},Ioe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Aoe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Hoe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},Noe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},Doe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},koe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function $oe(){return[boe,Soe,Roe,Eoe,Toe,Moe,_oe,Poe,xoe,Ooe,Ioe,Aoe,Hoe,Noe,Doe,koe]}const Loe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Foe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Voe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Woe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Boe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},joe=[...ooe(),...Coe(),...$oe(),Loe,Foe,Voe,Woe,Boe];function z$(t){const e={};return joe.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Uoe(t){const e=t.getShortcutManager().addContext("editor"),n=z$(t),r={group:Ua};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function zoe(t){const e=t.getShortcutManager().addContext("grid"),n=z$(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:j$};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ua,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function Yoe(t){[zoe,Uoe].forEach(e=>e(t))}function Goe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=XO(t),i=XO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function XO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ce(n,[pf("Focus catcher")]),n}function Koe(t){const e=qoe(t);let n;const{activate:r,deactivate:i}=Goe(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:bR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:SR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:j$,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?bR(t):SR(t)),u(),!1;h.preventDefault()},position:"after"}])}function bR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function SR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function qoe(t){return e=>{if(!e)return null;const n=bR(t),r=SR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function ch(t){Lo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function zv(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,w=f<=h,y=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:w&&y?r.highlight.row:w?f:y?g:E.row}}}function Xoe(t){return e=>{const n=zv(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;ch(t.getCell(r?-1:0,n,!0))})}}function Joe(){return()=>{}}function Zoe(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;ch(t.getCell(n,r,!0))})}}function Qoe(t){return e=>{const n=zv(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;ch(t.getCell(i,o,!0))})}}function ese(t){return e=>{const n=zv(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;ch(t.getCell(i,o,!0))})}}function tse(t){return e=>{const n=zv(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;ch(t.getCell(n,r?-1:0,!0))})}}function nse(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{ch(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function rse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=Zoe(t):e.isSelectedByCorner()?s=Joe():e.isSelectedByRowHeader()?s=tse(t):e.isSelectedByColumnHeader()?s=Xoe(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=Qoe(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=nse(t):e.getSelectedRange().size()>1&&(s=ese(t)),(o=s)===null||o===void 0||o(i)}}}const JO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),lm=t=>t.map(e=>{const n=e.toLowerCase();return JO.has(n)?JO.get(n):n}).sort().join("+"),ise=t=>t.split("+"),ZO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),kC=t=>{let{which:e,key:n}=t;if(ZO.has(e))return ZO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},Y$=Symbol("shortcut-context");function G$(t){return De(t)&&t.__kindOf===Y$}const ose=t=>{const e=Nv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:w,position:y,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(It(c))throw new Error("You need to define the shortcut's group.");if(at(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ut`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(w)&&(C.relativeToGroup=w,C.position=y),G$(E)&&(C.forwardToContext=E),l.forEach(A=>{const _=lm(A);if(e.hasItem(_)){const I=e.getItem(_);let M=I.findIndex(G=>G.group===w);M!==-1?y==="before"?M-=1:M+=1:M=I.length,I.splice(M,0,C)}else e.addItem(_,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ke(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=lm(l);e.removeItem(u)};return{__kindOf:Y$,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=lm(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=lm(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(ise(h)):(d.length=0,d.push(...f))})}}};function sse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const ase=["meta","alt","shift","control"],Uh=sse(),zh=[];let um=0;function lse(t,e,n,r,i){const o=f=>ase.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),g&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||ma(f))return;const w=kC(f);let y=[];o(w)||(y=s(f));const E=[w].concat(y);!i(f,E)&&(mw()&&y.includes("meta")||!mw()&&y.includes("control"))&&i(f,[w].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=kC(f);o(g)&&Uh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=kC(f);o(g)&&Uh.release(g)}},c=()=>{Uh.releaseAll()};return{mount:()=>{let f=t;for(um+=1;f;)um===1&&(f.document.documentElement.addEventListener("keydown",l),zh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),zh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=tu(f)},unmount:()=>{let f=t;for(um-=1;f;){if(um===0){for(let g=0;g<zh.length;g++){const{event:w,listener:y}=zh[g];f.document.documentElement.removeEventListener(w,y)}zh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=tu(f)}},isPressed:f=>Uh.isPressed(f),releasePressedKeys:()=>Uh.releaseAll()}}const use=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Nv({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const w=ose(g);return o.addItem(g,w),w},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(ut`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=G$(y)?y:u(y);let C=!1;if(!E.hasShortcut(w))return C;const A=E.getShortcuts(w);for(let _=0;_<A.length;_++){const{callback:$,runOnlyIf:I,preventDefault:M,stopPropagation:G,captureCtrl:V,forwardToContext:W}=A[_];if(I(g)===!0){if(h=V,C=$(g,w)===!1,h=!1,M&&g.preventDefault(),G&&(Ei(g),g.stopPropagation()),C)break;W&&d(g,w,W)}}return C},f=lse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function QO(t){const{classNames:e}=uk(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let $C=null;const LC=new Map;function K$(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new vi(o);let a,l,u,c,h,d,f=!0;Pne(i)&&_ne(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",w=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=Vre(e.language);const y=Object.fromEntries(Object.entries(e).filter(m=>{let[v]=m;return!(ie.getSingleton().isRegistered(v)||ie.getSingleton().isDeprecated(v))})),E=new B$(o,y,[Wie,Kie]),C=E.getTableMeta(),A=E.getGlobalMeta(),_=Nv();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),Mp(this)&&(ek(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${aE()}`,LC.set(this.guid,this),this.columnIndexMapper=new vR,this.rowIndexMapper=new vR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new Xne(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const $=m=>{const{row:v,col:p}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getRenderableFromVisualIndex(v):v,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},I=m=>{const{row:v,col:p}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getVisualFromRenderableIndex(v):v,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},M=(m,v)=>{const p=v>m?1:-1,x=Math.min(m,v),L=Math.max(m,v),U=o.rowIndexMapper.getNearestNotHiddenIndex(m,p);return U===null||p===1&&U>L||p===-1&&U<x?null:U>=0?o.rowIndexMapper.getRenderableFromVisualIndex(U):U},G=(m,v)=>{const p=v>m?1:-1,x=Math.min(m,v),L=Math.max(m,v),U=o.columnIndexMapper.getNearestNotHiddenIndex(m,p);return U===null||p===1&&U>L||p===-1&&U<x?null:U>=0?o.columnIndexMapper.getRenderableFromVisualIndex(U):U};let V=new F$(C,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,v)=>o._createCellCoords(m,v),createCellRange:(m,v,p)=>o._createCellRange(m,v,p),visualToRenderableCoords:$,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:M,findFirstNonHiddenRenderableColumn:G,isDisabledCellSelection:(m,v)=>m<0||v<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,v).disableVisualSelection});this.selection=V;const W=m=>{let{hiddenIndexesChanged:v}=m;this.forceFullRender=!0,v&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",W),this.rowIndexMapper.addLocalHook("cacheUpdated",W),this.selection.addLocalHook("afterSetRangeEnd",(m,v)=>{const p=Or(!1),x=this.selection.getSelectedRange(),{from:L,to:U}=x.current(),K=x.size()-1;this.runHooks("afterSelection",L.row,L.col,U.row,U.col,p,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),U.row,o.colToProp(U.col),p,K),v&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m);const X=V.isSelectedByRowHeader(),b=V.isSelectedByColumnHeader();X&&b?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):X?(pe(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):b?(pe(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),V.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const v=Or(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,v),(!v.isTouched()||v.isTouched()&&!v.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const v=m.length-1,{from:p,to:x}=m[v];this.runHooks("afterSelectionEnd",p.row,p.col,x.row,x.col,v),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),x.row,o.colToProp(x.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const v=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=v)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...v)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...v)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...v)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSelectColumns",...v)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterSelectColumns",...v)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeSelectRows",...v)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterSelectRows",...v)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("modifyTransformStart",...v)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...v)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("modifyTransformFocus",...v)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterModifyTransformFocus",...v)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("modifyTransformEnd",...v)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...v)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeRowWrap",...v)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];return r.runHooks("beforeColumnWrap",...v)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,v){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const U=K=>{if(K.length===0)return[];const X=[...K];return X.sort((R,S)=>{let[k]=R,[P]=S;return k===P?0:k>P?1:-1}),vn(X,(R,S)=>{let[k,P]=S;const H=R[R.length-1],[j,O]=H,N=j+O;if(k<=N){const B=Math.max(P-(N-k),0);H[1]+=B}else R.push([k,P]);return R},[X[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(C.maxRows===K)return;const X=m==="insert_row_below"?"below":"above";v=v??(X==="below"?K:0);const{delta:b,startPhysicalIndex:R}=a.createRow(v,p,{source:x,mode:X});V.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";v=v??(S==="end"?o.countSourceCols():0);const{delta:k,startPhysicalIndex:P}=a.createCol(v,p,{source:x,mode:S});if(k){if(Array.isArray(C.colHeaders)){const O=[o.toVisualColumn(P),0];O.length+=k,Array.prototype.splice.apply(C.colHeaders,O)}V.shiftColumns(o.toVisualColumn(P),k)}break;case"remove_row":const H=O=>{let N=0;T(O,B=>{let[F,Y]=B;const ae=jt(F)?o.countRows()-1:Math.max(F-N,0);if(Number.isInteger(F)&&(F=Math.max(F-N,0)),!a.removeRow(F,Y,x))return;if(V.isSelected()){const{row:Te}=o.getSelectedRangeLast().highlight;Te>=F&&Te<=F+Y-1&&c.closeEditor(!0)}const Me=o.countRows(),Fe=C.fixedRowsTop;Fe>=ae+1&&(C.fixedRowsTop-=Math.min(Y,Fe-ae));const ze=C.fixedRowsBottom;ze&&ae>=Me-ze&&(C.fixedRowsBottom-=Math.min(Y,ze)),Me===0?V.deselect():x==="ContextMenu.removeRow"?V.refresh():V.shiftRows(F,-Y),N+=Y})};Array.isArray(v)?H(U(v)):H([[v,p]]);break;case"remove_col":const j=O=>{let N=0;T(O,B=>{let[F,Y]=B;const ae=jt(F)?o.countCols()-1:Math.max(F-N,0);let ce=o.toPhysicalColumn(ae);if(Number.isInteger(F)&&(F=Math.max(F-N,0)),!a.removeCol(F,Y,x))return;if(V.isSelected()){const{col:Te}=o.getSelectedRangeLast().highlight;Te>=F&&Te<=F+Y-1&&c.closeEditor(!0)}o.countCols()===0?V.deselect():x==="ContextMenu.removeColumn"?V.refresh():V.shiftColumns(F,-Y);const ze=C.fixedColumnsStart;ze>=ae+1&&(C.fixedColumnsStart-=Math.min(Y,ze-ae)),Array.isArray(C.colHeaders)&&(typeof ce>"u"&&(ce=-1),C.colHeaders.splice(ce,Y)),N+=Y})};Array.isArray(v)?j(U(v)):j([[v,p]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=C.minRows,v=C.minSpareRows,p=C.minCols,x=C.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(v){const L=o.countEmptyRows(!0);if(L<v){const U=v-L,K=Math.min(U,C.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(p||x)&&(L=o.countEmptyCols(!0));let U=o.countCols();if(p&&!C.columns&&U<p){const K=p-U;L+=K,a.createCol(U,K,{source:"auto"})}if(x&&!C.columns&&o.dataType==="array"&&L<x){U=o.countCols();const K=x-L,X=Math.min(K,C.maxCols-U);a.createCol(U,X,{source:"auto"})}}},populateFromArray(m,v,p,x,L){let U,K,X,b;const R=[],S={},k=[],P=m.row,H=m.col;if(K=v.length,K===0)return!1;let j=0,O=0;switch(De(p)&&(j=p.col-H+1,O=p.row-P+1),L){case"shift_down":const N=Nd(v),B=N.length,F=Math.max(B,j),Y=o.getData().slice(P),ae=Nd(Y).slice(H,H+F);for(X=0;X<F;X+=1)if(X<B){for(U=0,K=N[X].length;U<O-K;U+=1)N[X].push(N[X][U%K]);X<ae.length?k.push(N[X].concat(ae[X])):k.push(N[X].concat(new Array(Y.length).fill(null)))}else k.push(N[X%B].concat(ae[X]));o.populateFromArray(P,H,Nd(k));break;case"shift_right":const ce=v.length,Me=Math.max(ce,O),Fe=o.getData().slice(P).map(Mt=>Mt.slice(H));for(U=0;U<Me;U+=1)if(U<ce){for(X=0,b=v[U].length;X<j-b;X+=1)v[U].push(v[U][X%b]);if(U<Fe.length)for(let Mt=0;Mt<Fe[U].length;Mt+=1)v[U].push(Fe[U][Mt]);else v[U].push(...new Array(Fe[0].length).fill(null))}else v.push(v[U%K].slice(0,Me).concat(Fe[U]));o.populateFromArray(P,H,v);break;case"overwrite":default:S.row=m.row,S.col=m.col;let ze=0,Te=0,Ve=!0,Tt;const Mi=function(un){let Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const _t=v[un%v.length];return Ct!==null?_t[Ct%_t.length]:_t},Xo=v.length,Zr=p?p.row-m.row+1:0;for(p?K=Zr:K=Math.max(Xo,Zr),U=0;U<K&&!(p&&S.row>p.row&&Zr>Xo||!C.allowInsertRow&&S.row>o.countRows()-1||S.row>=C.maxRows);U++){const Mt=U-ze,un=Mi(Mt).length,Ct=p?p.col-m.col+1:0;if(p?b=Ct:b=Math.max(un,Ct),S.col=m.col,Tt=o.getCellMeta(S.row,S.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Tt.skipRowOnPaste){ze+=1,S.row+=1,K+=1;continue}for(Te=0,X=0;X<b&&!(p&&S.col>p.col&&Ct>un||!C.allowInsertColumn&&S.col>o.countCols()-1||S.col>=C.maxCols);X++){if(Tt=o.getCellMeta(S.row,S.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Tt.skipColumnOnPaste){Te+=1,S.col+=1,b+=1;continue}if(Tt.readOnly&&x!=="UndoRedo.undo"){S.col+=1;continue}const _t=X-Te;let We=Mi(Mt,_t),Qr=o.getDataAtCell(S.row,S.col);if(We!==null&&typeof We=="object")if(Array.isArray(We)&&Qr===null&&(Qr=[]),Qr===null||typeof Qr!="object")Ve=!1;else{const za=Bc(Array.isArray(Qr)?Qr:Qr[0]||Qr),Ya=Bc(Array.isArray(We)?We:We[0]||We);Ov(za,Ya)||Array.isArray(za)&&Array.isArray(Ya)?We=Xn(We):Ve=!1}else Qr!==null&&typeof Qr=="object"&&(Ve=!1);Ve&&R.push([S.row,S.col,We]),Ve=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,x||"populateFromArray");break}}};function Q(m){const v=_$(m);PM(v)?(o.runHooks("beforeLanguageChange",v),A.language=v,o.runHooks("afterLanguageChange",v)):P$(m)}function J(m,v){const p=m==="className"?o.rootElement:o.table;if(f)q(p,v);else{let x=[],L=[];A[m]&&(x=Array.isArray(A[m])?A[m]:QS(A[m])),v&&(L=Array.isArray(v)?v:QS(v));const U=ZS(x,L),K=ZS(L,x);U.length&&pe(p,U),K.length&&q(p,K)}A[m]=v}this.init=function(){l.setData(C.data),o.runHooks("beforeInit"),(ko()||ME())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Ane(this);const m=C.themeName||QO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=lR.getInstance(o,C,V),d=rse(o),h=new tZ(o),Mp(this)&&Koe(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&vk(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function ee(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function se(m){const v=m.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):m}function be(m,v,p){if(!m.length){p();return}const x=o.getActiveEditor(),L=new ee;let U=!0;L.onQueueEmpty=()=>{x&&U&&x.cancelChanges(),p()};for(let K=m.length-1;K>=0;K--){const[X,b]=m[K],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(X,R):S={...Object.getPrototypeOf(C),...C},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function(k,P){return function(H){if(typeof H!="boolean")throw new Error("Validation error: result is not boolean");H===!1&&P.allowInvalid===!1&&(U=!1,m.splice(k,1),P.valid=!0),L.removeValidatorFormQueue()}}(K,S),v))}L.checkIfQueueIsEmpty()}function gt(m,v){for(let x=m.length-1;x>=0;x--){let L=!1;if(m[x]===null){m.splice(x,1);continue}if(!((m[x][2]===null||m[x][2]===void 0)&&(m[x][3]===null||m[x][3]===void 0))){if(C.allowInsertRow)for(;m[x][0]>o.countRows()-1;){const{delta:U}=a.createRow(void 0,void 0,{source:"auto"});if(U===0){L=!0;break}}if(o.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(m[x][1])>o.countCols()-1;){const{delta:U}=a.createCol(void 0,void 0,{source:"auto"});if(U===0){L=!0;break}}L||a.set(m[x][0],m[x][1],m[x][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,v),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,v||"edit");const x=o.getActiveEditor();x&&le(x.refreshValue)&&x.refreshValue()}else o.render()}this._createCellCoords=function(m,v){return o.view._wt.createCellCoords(m,v)},this._createCellRange=function(m,v,p){return o.view._wt.createCellRange(m,v,p)},this.validateCell=function(m,v,p,x){let L=o.getCellValidator(v);function U(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||v.hidden===!0){p(K);return}const b=v.visualCol,R=v.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const k=o.rowIndexMapper.getRenderableFromVisualIndex(R),P=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",k,P,S)}p(K)}QD(L)&&(L=function(K){return function(X,b){b(K.test(X))}}(L)),at(L)?(m=o.runHooks("beforeValidate",m,v.visualRow,v.prop,x),o._registerImmediate(()=>{L.call(v,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,v.visualRow,v.prop,x),v.valid=K,U(K),o.runHooks("postAfterValidate",K,m,v.visualRow,v.prop,x))})})):o._registerImmediate(()=>{v.valid=!0,U(v.valid,!1)})};function Re(m,v,p){return Array.isArray(m)?m:[[m,v,p]]}function Ae(m,v){const p=o.runHooks("beforeChange",m,v||"edit"),x=m.filter(U=>U!==null);if(p===!1||x.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let U=x.length-1;U>=0;U--){const[K,X,,b]=x[U],R=a.propToCol(X);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(C),...C};const{type:k,checkedTemplate:P,uncheckedTemplate:H}=S;if(k==="numeric"&&typeof b=="string"&&Kk(b)&&(x[U][3]=se(b)),k==="checkbox"){const j=Rt(b),O=j===Rt(P),N=j===Rt(H);(O||N)&&(x[U][3]=O?P:H)}}return x}this.setDataAtCell=function(m,v,p,x){const L=Re(m,v,p),U=[];let K=x,X,b,R;for(X=0,b=L.length;X<b;X++){if(typeof L[X]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[X][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[X][1]>=this.countCols()?R=L[X][1]:R=a.colToProp(L[X][1]),U.push([L[X][0],R,l.getAtCell(this.toPhysicalRow(L[X][0]),L[X][1]),L[X][2]])}!K&&typeof m=="object"&&(K=v);const S=Ae(U,K);o.runHooks("afterSetDataAtCell",S,K),be(S,K,()=>{gt(S,K)})},this.setDataAtRowProp=function(m,v,p,x){const L=Re(m,v,p),U=[];let K=x,X,b;for(X=0,b=L.length;X<b;X++)U.push([L[X][0],L[X][1],l.getAtCell(this.toPhysicalRow(L[X][0]),L[X][1]),L[X][2]]);!K&&typeof m=="object"&&(K=v);const R=Ae(U,x);o.runHooks("afterSetDataAtRowProp",R,K),be(R,K,()=>{gt(R,K)})},this.listen=function(){o&&!o.isListening()&&(LC.forEach(m=>{o!==m&&m.unlisten()}),$C=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&($C=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return $C===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),v&&V.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,v,p,x,L,U,K){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const X=typeof x=="number"?o._createCellCoords(x,L):null;return u.populateFromArray(o._createCellCoords(m,v),p,X,U,K)},this.spliceCol=function(m,v,p){for(var x=arguments.length,L=new Array(x>3?x-3:0),U=3;U<x;U++)L[U-3]=arguments[U];return a.spliceCol(m,v,p,...L)},this.spliceRow=function(m,v,p){for(var x=arguments.length,L=new Array(x>3?x-3:0),U=3;U<x;U++)L[U-3]=arguments[U];return a.spliceRow(m,v,p,...L)},this.getSelected=function(){if(V.isSelected())return Ue(V.getSelectedRange(),m=>{let{from:v,to:p}=m;return[v.row,v.col,p.row,p.col]})},this.getSelectedLast=function(){const m=this.getSelected();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.getSelectedRange=function(){if(V.isSelected())return Array.from(V.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.emptySelectedCells=function(m){if(!V.isSelected()||this.countRows()===0||this.countCols()===0)return;const v=[];T(V.getSelectedRange(),p=>{if(p.isSingleHeader())return;const x=p.getTopStartCorner(),L=p.getBottomEndCorner();fe(x.row,L.row,U=>{fe(x.col,L.col,K=>{this.getCellMeta(U,K).readOnly||v.push([U,K,null])})})}),v.length>0&&this.setDataAtCell(v,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const v=m();return this.resumeRender(),v},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(v,0),(!this.isExecutionSuspended()&&v===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=m();return this.resumeExecution(v),p},this.batch=function(m){this.suspendRender(),this.suspendExecution();const v=m();return this.resumeExecution(),this.resumeRender(),v},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:v,height:p}=m.getLastSize(),{width:x,height:L}=o.rootElement.getBoundingClientRect(),U=x!==v||L!==p;o.runHooks("beforeRefreshDimensions",{width:v,height:p},{width:x,height:L},U)!==!1&&((U||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(x,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:v,height:p},{width:x,height:L},U))},this.updateData=function(m,v){GO(m,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),V.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:v,metaManager:E,firstRun:f})},this.loadData=function(m,v){GO(m,p=>{a=p},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),V.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:v,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=C.columns;let v=0;if(Array.isArray(m))v=m.length;else if(at(m))if(o.dataType==="array"){const p=this.countSourceCols();for(let x=0;x<p;x+=1)m(x)&&(v+=1)}else(o.dataType==="object"||o.dataType==="function")&&(v=a.colToPropCache.length);else if(le(C.dataSchema)){const p=a.getSchema();v=Array.isArray(p)?p.length:Iv(p)}else v=this.countSourceCols();return v},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,v,p,x){return It(m)?a.getAll():a.getRange(o._createCellCoords(m,v),o._createCellCoords(p,x),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,v,p,x){return a.getCopyableText(o._createCellCoords(m,v),o._createCellCoords(p,x))},this.getCopyableData=function(m,v){return a.getCopyable(m,a.colToProp(v))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(f?o.loadData:o.updateData).bind(this);let x=!1,L,U;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&Q(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")J("className",m.className);else if(L==="tableClassName"&&o.table)J("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ie.getSingleton().isRegistered(L)||ie.getSingleton().isDeprecated(L)){const S=m[L];at(S)?(ie.getSingleton().addAsFixed(L,S,o),C[L]=S):Array.isArray(S)&&(ie.getSingleton().add(L,S,o),C[L]=S)}else!v&&nn(m,L)&&(A[L]=m[L]);m.data===void 0&&C.data===void 0?p(null,"updateSettings"):m.data!==void 0?p(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),X=C.columns;if(X&&at(X)&&(x=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),K>0)for(L=0,U=0;L<K;L++){if(X){const S=x?X(L):X[U];S&&E.updateColumnMeta(U,S)}U+=1}le(m.cell)&&ke(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(at(R)&&(R=R()),v&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;at(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!v){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),k=nn(m,"themeName");S&&k&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const P=k&&m.themeName||QO(o.rootElement);o.useTheme(P),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!v&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(C.getValue){if(at(C.getValue))return C.getValue.call(o);if(m)return o.getData()[m[0][0]][C.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,v,p,x,L){u.alter(m,v,p,x,L)},this.getCell=function(m,v){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=v,L=m;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||x===null||L===void 0||x===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,x),p)},this.getCoords=function(m){const v=this.view._wt.wtTable.getCoords(m);if(v===null)return null;const{row:p,col:x}=v;let L=p,U=x;return p>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(p)),x>=0&&(U=this.columnIndexMapper.getVisualFromRenderableIndex(x)),o._createCellCoords(L,U)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,v){return a.get(m,a.colToProp(v))},this.getDataAtRowProp=function(m,v){return a.get(m,v)},this.getDataAtCol=function(m){const v=[],p=a.getRange(o._createCellCoords(0,m),o._createCellCoords(C.data.length-1,m),a.DESTINATION_RENDERER);for(let x=0;x<p.length;x+=1)for(let L=0;L<p[x].length;L+=1)v.push(p[x][L]);return v},this.getDataAtProp=function(m){const v=[],p=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(C.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let x=0;x<p.length;x+=1)for(let L=0;L<p[x].length;L+=1)v.push(p[x][L]);return v},this.getSourceData=function(m,v,p,x){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(p,x)),L},this.getSourceDataArray=function(m,v,p,x){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(p,x),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,v,p,x){const L=Re(m,v,p),U=this.hasHook("afterSetSourceDataAtCell"),K=[];U&&T(L,b=>{let[R,S,k]=b;K.push([R,S,l.getAtCell(R,S),k])}),T(L,b=>{let[R,S,k]=b;l.setAtCell(R,S,k)}),U&&this.runHooks("afterSetSourceDataAtCell",K,x),this.render();const X=o.getActiveEditor();X&&le(X.refreshValue)&&X.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,v){return l.getAtCell(m,v)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,v,p,x){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,v,p,x],[U,K]=L;let[,,X,b]=L,R=null,S=null;X===void 0&&(X=U),b===void 0&&(b=K);let k="mixed";return fe(Math.max(Math.min(U,X),0),Math.max(U,X),P=>{let H=!0;return fe(Math.max(Math.min(K,b),0),Math.max(K,b),j=>(S=this.getCellMeta(P,j).type,R?H=R===S:R=S,H)),k=H?S:"mixed",H}),k},this.removeCellMeta=function(m,v,p){const[x,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(v)];let U=E.getCellMetaKeyValue(x,L,p);o.runHooks("beforeRemoveCellMeta",m,v,p,U)!==!1&&(E.removeCellMeta(x,L,p),o.runHooks("afterRemoveCellMeta",m,v,p,U)),U=null},this.spliceCellsMeta=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,x=new Array(p>2?p-2:0),L=2;L<p;L++)x[L-2]=arguments[L];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&E.removeRow(this.toPhysicalRow(m),v),x.length>0&&T(x.reverse(),U=>{E.createRow(this.toPhysicalRow(m)),T(U,(K,X)=>this.setCellMetaObject(m,X,K))}),o.render()},this.setCellMetaObject=function(m,v,p){typeof p=="object"&&ke(p,(x,L)=>{this.setCellMeta(m,v,L,x)})},this.setCellMeta=function(m,v,p,x){if(o.runHooks("beforeSetCellMeta",m,v,p,x)===!1)return;let U=m,K=v;m<this.countRows()&&(U=this.toPhysicalRow(m)),v<this.countCols()&&(K=this.toPhysicalColumn(v)),E.setCellMeta(U,K,p,x),o.runHooks("afterSetCellMeta",m,v,p,x)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,v){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},x=this.toPhysicalRow(m),L=this.toPhysicalColumn(v);return x===null&&(x=m),L===null&&(L=v),E.getCellMeta(x,L,{visualRow:m,visualColumn:v,...p})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||C.columns)},this.getCellRenderer=function(m,v){const p=typeof m=="number"?o.getCellMeta(m,v).renderer:m.renderer;return typeof p=="string"?vw(p):It(p)?vw("text"):p},this.getCellEditor=function(m,v){const p=typeof m=="number"?o.getCellMeta(m,v).editor:m.editor;return typeof p=="string"?ww(p):It(p)?ww("text"):p},this.getCellValidator=function(m,v){const p=typeof m=="number"?o.getCellMeta(m,v).validator:m.validator;return typeof p=="string"?DE(p):p},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,v){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,m)},this.validateColumns=function(m,v){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,m)},this._validateCells=function(m,v,p){const x=new ee;m&&(x.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(v!==void 0&&v.indexOf(L)===-1){L-=1;continue}let U=o.countCols()-1;for(;U>=0;){if(p!==void 0&&p.indexOf(U)===-1){U-=1;continue}x.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,U),o.getCellMeta(L,U),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),U-=1}L-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let v=C.rowHeaders,p=m;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(v=[],fe(o.countRows()-1,x=>{v.push(o.getRowHeader(x))})):Array.isArray(v)&&v[p]!==void 0?v=v[p]:at(v)?v=v(p):v&&typeof v!="string"&&typeof v!="number"&&(v=p+1),v},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let m=0,v=o.countCols();m<v;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",m);if(p===void 0){const X=[],b=o.countCols();for(let R=0;R<b;R++)X.push(o.getColHeader(R));return X}let x=C.colHeaders;const L=function(X){const b=[],R=o.countCols();let S=0;for(;S<R;S++)at(C.columns)&&C.columns(S)&&b.push(S);return b[X]},U=o.toPhysicalColumn(p),K=L(U);return C.colHeaders===!1?x=null:C.columns&&at(C.columns)&&C.columns(K)&&C.columns(K).title?x=C.columns(K).title:C.columns&&C.columns[U]&&C.columns[U].title?x=C.columns[U].title:Array.isArray(C.colHeaders)&&C.colHeaders[U]!==void 0?x=C.colHeaders[U]:at(C.colHeaders)?x=C.colHeaders(U):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(x=$v(p)),x=o.runHooks("modifyColumnHeaderValue",x,m,v),x},this._getColWidthFromSettings=function(m){let v;if(m>=0&&(v=o.getCellMeta(0,m).width),(v===void 0||v===C.width)&&(v=C.colWidths),v!=null){switch(typeof v){case"object":v=v[m];break;case"function":v=v(m);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(m,v){let p=o._getColWidthFromSettings(m);return p=o.runHooks("modifyColWidth",p,m,v),p===void 0&&(p=jc),p},this._getRowHeightFromSettings=function(m){const v=this.view.getDefaultRowHeight();let p=C.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<v?v:p},this.getRowHeight=function(m,v){let p=o._getRowHeightFromSettings(m);return p=o.runHooks("modifyRowHeight",p,m,v),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=C.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,v)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return hR(o.countRows()-1,p=>{if(o.isEmptyRow(p))v+=1;else if(m===!0)return!1}),v},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return hR(o.countCols()-1,p=>{if(o.isEmptyCol(p))v+=1;else if(m===!0)return!1}),v},this.isEmptyRow=function(m){return C.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return C.isEmptyCol.call(o,m)},this.selectCell=function(m,v,p,x){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,U=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return It(m)||It(v)?!1:this.selectCells([[m,v,p,x]],L,U)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;v===!1&&d.suspend();const x=V.selectCells(m);return x&&p&&o.listen(),d.resume(),x},this.selectColumns=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return V.selectColumns(m,v,p)},this.selectRows=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return V.selectRows(m,v,p)},this.deselectCell=function(){V.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),V.selectAll(m,v,p)};const it=(m,v)=>m.getNearestNotHiddenIndex(v,1,!0);this.scrollViewportTo=function(m,v){if(typeof m=="number"){var p;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:x,col:L,considerHiddenIndexes:U}=m??{};let K=x,X=L;if(at(v)&&this.addHookOnce("afterScroll",v),U===void 0||U){const k=Number.isInteger(x)&&x>=0,P=Number.isInteger(L)&&L>=0,H=k?it(this.rowIndexMapper,x):void 0,j=P?it(this.columnIndexMapper,L):void 0;if(H===null||j===null)return!1;K=k?o.rowIndexMapper.getRenderableFromVisualIndex(H):x,X=P?o.columnIndexMapper.getRenderableFromVisualIndex(j):L}const b=Number.isInteger(K),R=Number.isInteger(X);let S=!1;return b&&K>=0&&R&&X>=0?S=o.view.scrollViewport(o._createCellCoords(K,X),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(R&&X<0||!R)?S=o.view.scrollViewportVertically(K,m.verticalSnap):R&&X>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(X,m.horizontalSnap)),at(v)&&(S?this.view.render():(this.removeHook("afterScroll",v),this._registerMicrotask(()=>v()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;at(m)&&this.addHookOnce("afterScroll",m);const{highlight:v}=this.getSelectedRangeLast(),p=this.scrollViewportTo(v.toObject());return p?this.view.render():at(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),p},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),LC.delete(this.guid),Mp(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}Bo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(m=>{let[,v]=m;v.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),ie.getSingleton().destroy(o),ke(o,(m,v,p)=>{at(m)?p[v]=En(v):v!=="guid"&&(p[v]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,V=null,c=null,o=null};function En(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return _.getItem(qn(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,v,p){ie.getSingleton().add(m,v,o,p)},this.hasHook=function(m){return ie.getSingleton().has(m,o)||ie.getSingleton().has(m)},this.addHookOnce=function(m,v,p){ie.getSingleton().once(m,v,o,p)},this.removeHook=function(m,v){ie.getSingleton().remove(m,v,o)},this.runHooks=function(m,v,p,x,L,U,K){return ie.getSingleton().run(o,m,v,p,x,L,U,K)},this.getTranslatedPhrase=function(m,v){return N$(C.language,m,v)},this.toHTML=()=>uR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",uR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=m;typeof p=="function"&&(p=setTimeout(p,v)),this.timeouts.push(p)},this._clearTimeouts=function(){T(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){T(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const ot=use({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&ot.releasePressedKeys()}),this.getShortcutManager=function(){return ot},this.getFocusManager=function(){return h},NE().forEach(m=>{const v=og(m);_.addItem(m,new v(this))}),Yoe(o),ot.setActiveContextName("grid"),ie.getSingleton().run(o,"construct")}function eI(t,e,n){t.addEventListener(e,n,!1)}function tI(t,e,n){t.removeEventListener(e,n,!1)}function cm(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function q$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=cm(s).fontSize,o.style.fontFamily=cm(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=cm(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=cm(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),w=o.clientWidth+f+g+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>w?y.width=`${n.minWidth}px`:w>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${w}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?y.height=`${n.minHeight}px`:n.maxHeight<E?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(eI(s,"input",a),eI(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){tI(s,"input",a),tI(s,"keydown",l)}}}function nI(t,e){const n=pE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}eg(e,i)}function il(t,e,n){return(e=cse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cse(t){var e=hse(t,"string");return typeof e=="symbol"?e:e+""}function hse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dse="ht_editor_visible",hm="ht_editor_hidden",rI="textEditor",fse="text";class Ru extends uh{static get EDITOR_TYPE(){return fse}constructor(e){super(e),il(this,"eventManager",new vi(this)),il(this,"autoResize",q$(this.hot.rootDocument)),il(this,"TEXTAREA",void 0),il(this,"textareaStyle",void 0),il(this,"TEXTAREA_PARENT",void 0),il(this,"textareaParentStyle",void 0),il(this,"layerClass",void 0),this.eventManager=new vi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),$d(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Kt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Kt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),eg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ce(this.TEXTAREA,[["data-hot-input",""],vu(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),we(this.TEXTAREA_PARENT,this.layerClass)&&pe(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,hm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Nk()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",pe(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,hm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(we(i,"handsontableEditor"))return n=!0,!1}),we(this.TEXTAREA_PARENT,hm)&&pe(this.TEXTAREA_PARENT,hm),n?(this.layerClass=dse,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Kt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){TE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Kt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Kt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:rI},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;nI(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;nI(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(rI)}}const gse="base";function cg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(Dx())):a&&c.push(Dx()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(kx())):(u.push(s.invalidCellClassName),a&&c.push(kx()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),pe(e,u),q(e,l),Cu(e,c),Ce(e,h)}cg.RENDERER_TYPE=gse;const mse="text";function js(t,e,n,r,i,o,s){cg.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Rt(a),s.trimWhitespace&&(a=a.trim()),$a(e,a)}js.RENDERER_TYPE=mse;const pse="text",X$={CELL_TYPE:pse,editor:Ru,renderer:js};oi(X$);Ee.editors={BaseEditor:uh};function Ee(t,e){const n=new K$(t,e||{},ZE);return n.init(),n}Ee.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new K$(t,e,ZE)};Ee.DefaultSettings=W$();Ee.hooks=ie.getSingleton();Ee.CellCoords=ru;Ee.CellRange=sg;Ee.packageName="handsontable";Ee.buildDate="24/04/2025 10:59:00";Ee.version="15.3.0";Ee.languages={dictionaryKeys:Hre,getLanguageDictionary:H$,getLanguagesDictionaries:Lre,registerLanguageDictionary:A$,getTranslatedPhrase:N$};const iI="handsontableEditor",wse="handsontable";class IM extends Ru{static get EDITOR_TYPE(){return wse}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),eg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&on(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:iI,relativeToGroup:Ua,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ei(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(iI)}}function vse(t,e){J$(t,e),e.add(t)}function oI(t,e,n){J$(t,e),e.set(t,n)}function J$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dm(t,e,n){return(e=yse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yse(t){var e=Cse(t,"string");return typeof e=="symbol"?e:e+""}function Cse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FC(t,e){return t.get(RR(t,e))}function RR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bse="autocomplete";var VC=new WeakMap,sI=new WeakMap,WC=new WeakSet;class AM extends IM{constructor(){super(...arguments),vse(this,WC),dm(this,"query",null),dm(this,"strippedChoices",[]),dm(this,"rawChoices",[]),oI(this,VC,this.hot.guid.slice(0,9)),oI(this,sI,ng(()=>{this.focus()},100)),dm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=tR(Rt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return bse}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[m8(),c8(),rk("listbox"),y8()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[mi("false"),C8(`${FC(VC,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",FC(sI,this)),this.htEditor.updateSettings({colWidths:e?[Xt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{js(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:w,locale:y}=this.cellProperties,E=this.query;let C=Rt(d),A,_;C&&!w&&(A=g===!0?C.indexOf(E):C.toLocaleLowerCase(y).indexOf(E.toLocaleLowerCase(y)),A!==-1&&(_=C.substr(A,E.length),C=C.replace(_,`<strong>${_}</strong>`))),n&&Ce(l,[h8(),...r?[E8(i)]:[],...r?[T8(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=C},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{Ce(h,[hE()]),Ce(this.TEXTAREA,...b8(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(Ce(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ts()),Ce(this.htEditor.rootElement,[nk(),S8("polite"),R8("text"),["id",`${FC(VC,this)}-listbox-${o}-${s}`]]),Ce(this.TEXTAREA,...mi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[mi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=pE(this.TEXTAREA),r=wk(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Nd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),eg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),RR(WC,this,aI).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),RR(WC,this,aI).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Rt(o));return Ue(r,o=>n?o:tR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(Dk(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function aI(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+Rn(this.hot.rootDocument)})}const Sse="checkbox";class Z$ extends uh{static get EDITOR_TYPE(){return Sse}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');we(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ea=()=>window,hi=()=>window.document,ER=(t,e)=>window.setTimeout(t,e),Co=function(t,e,n,r){t.addEventListener(e,n,!!r)},os=function(t,e,n,r){t.removeEventListener(e,n,!!r)},Rse=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Lr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},BC=function(t,e){Lr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},jC=function(t,e){t.className=Rse((" "+t.className+" ").replace(" "+e+" "," "))},HM=function(t){return/Array/.test(Object.prototype.toString.call(t))},Br=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Ese=function(t){let e=t.getDay();return e===0||e===6},Tse=function(t){return t%4===0&&t%100!==0||t%400===0},lI=function(t,e){return[31,Tse(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},fm=function(t){Br(t)&&t.setHours(0,0,0,0)},gm=function(t,e){return t.getTime()===e.getTime()},Sw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Br(e[r])?n&&(t[r]=new Date(e[r].getTime())):HM(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Sw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},uI=function(t,e,n){let r=hi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Sw(r,n),t.dispatchEvent(r)},cI=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},lo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},hI=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Mse=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},_se=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},Pse=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():_se(o,i))+"</td>"},xse=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Ose=function(t){return"<tbody>"+t.join("")+"</tbody>"},Ise=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+hI(t,e)+'">'+hI(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Ase=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,w=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",HM(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(w=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},Hse=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Ise(t)+Ose(e)+"</table>"};function TR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Ea().event;let o=i.target||i.srcElement;if(o)if(Lr(o,"is-disabled")||(Lr(o,"pika-button")&&!Lr(o,"is-empty")&&!Lr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&ER(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Lr(o,"pika-prev")?e.prevMonth():Lr(o,"pika-next")&&e.nextMonth()),Lr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Ea().event;let o=i.target||i.srcElement;o&&(Lr(o,"pika-select-month")?e.gotoMonth(o.value):Lr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Ea().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Br(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=hi().activeElement;do if(Lr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=ER(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Ea().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Lr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Co(o,"change",e._onChange)));do if(Lr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=hi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Co(e.el,"mousedown",e._onMouseDown,!0),Co(e.el,"touchend",e._onMouseDown,!0),Co(e.el,"change",e._onChange),n.keyboardInput&&Co(hi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?hi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Co(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Br(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Co(n.trigger,"click",e._onInputClick),Co(n.trigger,"focus",e._onInputFocus),Co(n.trigger,"blur",e._onInputBlur)):this.show()}TR.prototype={config:function(t){this._o||(this._o=Sw({},lo,!0));let e=Sw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Br(e.minDate)||(e.minDate=!1),Br(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),HM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||lo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Br(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Br(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",uI(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Br(t))return;let n=this._o.minDate,r=this._o.maxDate;Br(n)&&t<n?t=n:Br(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),fm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),uI(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Br(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=cI(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=cI({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(fm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=lo.minDate,this._o.minYear=lo.minYear,this._o.minMonth=lo.minMonth,this._o.startRange=lo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(fm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=lo.maxDate,this._o.maxYear=lo.maxYear,this._o.maxMonth=lo.maxMonth,this._o.endRange=lo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Ase(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&ER(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Ea().innerWidth||hi().documentElement.clientWidth,i=Ea().innerHeight||hi().documentElement.clientHeight,o=hi().body.scrollTop||hi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Ea().pageXOffset,a=l.bottom+Ea().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",BC(this.el,u?"left-aligned":"right-aligned"),BC(this.el,c?"bottom-aligned":"top-aligned"),jC(this.el,u?"right-aligned":"left-aligned"),jC(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=lI(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];fm(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=lI(h,u),g=o+s,w=g;for(;w>7;)w-=7;g+=7-w;let y=!1;for(let E=0,C=0;E<g;E++){let A=new Date(t,e,1+(E-s)),_=Br(this._d)?gm(A,this._d):!1,$=gm(A,i),I=r.events.indexOf(A.toDateString())!==-1,M=E<s||E>=o+s,G=1+(E-s),V=e,W=t,Q=r.startRange&&gm(r.startRange,A),J=r.endRange&&gm(r.endRange,A),ee=r.startRange&&r.endRange&&r.startRange<A&&A<r.endRange,se=r.minDate&&A<r.minDate||r.maxDate&&A>r.maxDate||r.disableWeekends&&Ese(A)||r.disableDayFn&&r.disableDayFn(A);M&&(E<s?(G=f+G,V=u,W=h):(G=G-o,V=c,W=d));let be={day:G,month:V,year:W,hasEvent:I,isSelected:_,isToday:$,isDisabled:se,isEmpty:M,isStartRange:Q,isEndRange:J,isInRange:ee,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&_&&(y=!0),l.push(Mse(be)),++C===7&&(r.showWeekNumber&&l.unshift(Pse(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(xse(l,r.isRTL,r.pickWholeWeek,y)),l=[],C=0,y=!1)}return Hse(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),jC(this.el,"is-hidden"),this._o.bound&&(Co(hi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&os(hi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),BC(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),os(this.el,"mousedown",this._onMouseDown,!0),os(this.el,"touchend",this._onMouseDown,!0),os(this.el,"change",this._onChange),t.keyboardInput&&os(hi(),"keydown",this._onKeyChange),t.field&&(os(t.field,"change",this._onInputChange),t.bound&&(os(t.trigger,"click",this._onInputClick),os(t.trigger,"focus",this._onInputFocus),os(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Nse(t,e){Dse(t,e),e.add(t)}function Dse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dI(t,e,n){return(e=kse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kse(t){var e=$se(t,"string");return typeof e=="symbol"?e:e+""}function $se(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Q$="date",fI="dateEditor",Lse="DD/MM/YYYY";var mm=new WeakSet;class eL extends Ru{constructor(){super(...arguments),Nse(this,mm),dI(this,"parentDestroyed",!1),dI(this,"$datePicker",null)}static get EDITOR_TYPE(){return Q$}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof TR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(pe(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();pe(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{we(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:fI})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(fI),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=UC(mm,this,zC).call(this),r=this.hot.view.isMouseDown(),i=e?_E(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new TR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&ig(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:UC(mm,this,zC).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Z(a).format(UC(mm,this,zC).call(this))),this.setValue(a),i&&i(),ko()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Kt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+rn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Xt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function zC(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:Lse}const Fse="dropdown";class tL extends AM{static get EDITOR_TYPE(){return Fse}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const Vse="numeric";class nL extends Ru{static get EDITOR_TYPE(){return Vse}}function Wse(t,e,n){return(e=Bse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bse(t){var e=jse(t,"string");return typeof e=="symbol"?e:e+""}function jse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Use="password";class rL extends Ru{constructor(){super(...arguments),Wse(this,"autoResize",q$(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Use}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Bo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const YC="ht_editor_visible",gI="selectEditor",zse="select";class iL extends uh{static get EDITOR_TYPE(){return zse}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...yu()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",we(this.selectWrapper,YC)&&pe(this.selectWrapper,YC),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Bo(this.select),ke(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,bu(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Kt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,YC)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:gI};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(gI)}}const Yse="time";class oL extends Ru{static get EDITOR_TYPE(){return Yse}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function Gse(){Rr(uh),Rr(AM),Rr(Z$),Rr(eL),Rr(tL),Rr(IM),Rr(nL),Rr(rL),Rr(iL),Rr(Ru),Rr(oL)}const Kse="html";function NM(t,e,n,r,i,o,s){cg.apply(this,[t,e,n,r,i,o,s]),bu(e,o??"",!1)}NM.RENDERER_TYPE=Kse;const qse="autocomplete";function hh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?NM:js,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...yu()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new vi(t);t.acArrowListener=function(d){we(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}hh.RENDERER_TYPE=qse;const Xse="dropdown";function DM(t,e,n,r,i,o,s){hh.apply(this,[t,e,n,r,i,o,s])}DM.RENDERER_TYPE=Xse;const mI=new WeakMap,pI=new WeakMap,Jse="htBadValue",zc="data-row",Yc="data-col",Zse="checkboxRenderer",sL="checkbox";ie.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===sL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function kM(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;cg.apply(this,[t,e,n,r,i,o,s]),Qse(t);let u=eae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Bo(e),o===s.checkedTemplate||Rt(o).toLocaleLowerCase(s.locale)===Rt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Rt(o).toLocaleLowerCase(s.locale)===Rt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:jt(o)?q(u,"noValue"):(u.style.display="none",q(u,Jse),h=!0),Ce(u,[[zc,n],[Yc,r]]),l&&Ce(u,[pf(u.checked?t.getTranslatedPhrase(MM):t.getTranslatedPhrase(_M)),sk(u.checked),d8()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);w=E!==null?E:""}const y=tae(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),mI.has(t)||(mI.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),E={group:Zse,relativeToGroup:Ua,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const C=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(C==null?void 0:C.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],E)}function f(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),E=[],C=new Map;let A=[],_=0;if(y){for(let $=0;$<y.length;$++){const{row:I,col:M}=y[$].getTopStartCorner(),{row:G,col:V}=y[$].getBottomEndCorner();for(let W=I;W<=G;W+=1)for(let Q=M;Q<=V;Q+=1){const J=t.getCellMeta(W,Q);if(J.hidden)continue;const ee={checkedTemplate:J.checkedTemplate,uncheckedTemplate:J.uncheckedTemplate};if(J.type!=="checkbox"){w===!0&&!J.readOnly&&(C.has(E.length)?C.set(E.length,[...C.get(E.length),[W,Q,null]]):C.set(E.length,[[W,Q,null]]));continue}if(J.readOnly===!0)continue;typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);const se=t.getDataAtCell(W,Q);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(se)?A.push([W,Q,J.uncheckedTemplate,ee]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(se)&&A.push([W,Q,J.checkedTemplate,ee]):A.push([W,Q,J.uncheckedTemplate,ee]),_+=1}E.push(_),_=0}A.every($=>{let[,,I]=$;return I===A[0][2]})?A=A.map($=>{let[I,M,G]=$;return[I,M,G]}):A=A.map($=>{let[I,M,,G]=$;return[I,M,G.checkedTemplate]}),A.length>0&&E.forEach(($,I)=>{let M=A.splice(0,$);C.size&&C.has(I)&&(M=[...M,...C.get(I)]),t.setDataAtCell(M)})}}function g(){const w=t.getSelectedRange();if(w){for(let y=0;y<w.length;y++){const E=w[y].getTopStartCorner(),C=w[y].getBottomEndCorner();for(let A=E.row;A<=C.row;A++)for(let _=E.col;_<=C.col;_++){if(t.getCellMeta(A,_).readOnly)continue;const I=t.getCell(A,_);if(Lo(I)&&I.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}kM.RENDERER_TYPE=sL;function Qse(t){let e=pI.get(t);if(!e){const{rootElement:n}=t;e=new vi(t),e.addEventListener(n,"click",r=>rae(r,t)),e.addEventListener(n,"mouseup",r=>nae(r,t)),e.addEventListener(n,"change",r=>iae(r,t)),pI.set(t,e)}return e}function eae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function tae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function nae(t,e){const{target:n}=t;$M(n)&&(!n.hasAttribute(zc)||!n.hasAttribute(Yc)||setTimeout(e.listen,10))}function rae(t,e){const{target:n}=t;if(!$M(n)||!n.hasAttribute(zc)||!n.hasAttribute(Yc))return;const r=parseInt(n.getAttribute(zc),10),i=parseInt(n.getAttribute(Yc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function iae(t,e){const{target:n}=t;if(!$M(n)||!n.hasAttribute(zc)||!n.hasAttribute(Yc))return;const r=parseInt(n.getAttribute(zc),10),i=parseInt(n.getAttribute(Yc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function $M(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const oae="handsontable";function LM(t,e,n,r,i,o,s){hh.apply(this,[t,e,n,r,i,o,s])}LM.RENDERER_TYPE=oae;var sae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function aae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var GC,wI;function lae(){return wI||(wI=1,GC={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),GC}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var KC,vI;function aL(){if(vI)return KC;vI=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let w="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let I=0;I<t.length;I++){let M=t[I];if(w=l.replace(RegExp(`([0-9 ])(${M.key})$`),"$1"),w!==l)return n(w,u,c,h,d,f)*M.factor}if(w=l.replace("%",""),w!==l)return n(w,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let C=h(E);if(C&&C!=="."&&(w=l.replace(new RegExp(`${e(C)}$`),""),w!==l))return n(w,u,c,h,d,f);let A={};Object.keys(f).forEach(I=>{A[f[I]]=I});let _=Object.keys(A).sort().reverse(),$=_.length;for(let I=0;I<$;I++){let M=_[I],G=A[M];if(w=l.replace(M,""),w!==l){let V;switch(G){case"thousand":V=Math.pow(10,3);break;case"million":V=Math.pow(10,6);break;case"billion":V=Math.pow(10,9);break;case"trillion":V=Math.pow(10,12);break}return n(w,u,c,h,d,f)*V}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let w=r(l,u,c);return n(w,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=WM();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),w=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,g,w);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return KC={unformat:a},KC}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var qC,yI;function FM(){if(yI)return qC;yI=1;let t=aL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,E){let C=d(y),A=g(E);return C&&A}function d(y){return t.unformat(y)!==void 0}function f(y,E,C,A=!1){let _=Object.keys(y).map($=>{if(!E[$])return console.error(`${C} Invalid key: ${$}`),!1;let I=y[$],M=E[$];if(typeof M=="string"&&(M={type:M}),M.type==="format"){if(!f(I,u,`[Validate ${$}]`,!0))return!1}else if(typeof I!==M.type)return console.error(`${C} ${$} type mismatched: "${M.type}" expected, "${typeof I}" provided`),!1;if(M.restrictions&&M.restrictions.length){let G=M.restrictions.length;for(let V=0;V<G;V++){let{restriction:W,message:Q}=M.restrictions[V];if(!W(I,y))return console.error(`${C} ${$} invalid value: ${Q}`),!1}}return M.restriction&&!M.restriction(I,y)?(console.error(`${C} ${$} invalid value: ${M.message}`),!1):M.validValues&&M.validValues.indexOf(I)===-1?(console.error(`${C} ${$} invalid value: must be among ${JSON.stringify(M.validValues)}, "${I}" provided`),!1):!(M.children&&!f(I,M.children,`[Validate ${$}]`))});return A||_.push(...Object.keys(E).map($=>{let I=E[$];if(typeof I=="string"&&(I={type:I}),I.mandatory){let M=I.mandatory;if(typeof M=="function"&&(M=M(y)),M&&y[$]===void 0)return console.error(`${C} Missing mandatory key "${$}"`),!1}return!0})),_.reduce(($,I)=>$&&I,!0)}function g(y){return f(y,u,"[Validate format]")}function w(y){return f(y,c,"[Validate language]")}return qC={validate:h,validateFormat:g,validateInput:d,validateLanguage:w},qC}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function uae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function cae(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function hae(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function dae(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function fae(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function gae(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function mae(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function pae(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function wae(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function vae(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function yae(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Cae(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function bae(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function Sae(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Rae(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Eae(t,e={}){return typeof t!="string"?t:(t=uae(t,e),t=cae(t,e),hae(t,e),gae(t,e),mae(t,e),bae(t,e),vae(t,e),yae(t,e),pae(t,e),Cae(t,e),wae(t,e),dae(t,e),fae(t,e),Sae(t,e),Rae(t,e),e)}var VM={parseFormat:Eae};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var XC,CI;function WM(){if(CI)return XC;CI=1;const t=lae(),e=FM(),n=VM;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,XC=r,XC}function Tae(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Mae(t,e){t.forEach(n=>{let r;try{r=Tae(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var _ae=t=>({loadLanguagesInNode:e=>Mae(e,t)}),lL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(I){var M,G,V,W=p.prototype={constructor:p,toString:null,valueOf:null},Q=new p(1),J=20,ee=4,se=-7,be=21,gt=-1e7,Re=1e7,Ae=!1,it=1,En=0,ot={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",v=!0;function p(b,R){var S,k,P,H,j,O,N,B,F=this;if(!(F instanceof p))return new p(b,R);if(R==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>Re?F.c=F.e=null:b.e<gt?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((O=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(H=0,j=b;j>=10;j/=10,H++);H>Re?F.c=F.e=null:(F.e=H,F.c=[b]);return}B=String(b)}else{if(!r.test(B=String(b)))return V(F,B,O);F.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(H=B.indexOf("."))>-1&&(B=B.replace(".","")),(j=B.search(/e/i))>0?(H<0&&(H=j),H+=+B.slice(j+1),B=B.substring(0,j)):H<0&&(H=B.length)}else{if(C(R,2,m.length,"Base"),R==10&&v)return F=new p(b),K(F,J+F.e+1,ee);if(B=String(b),O=typeof b=="number"){if(b*0!=0)return V(F,B,O,R);if(F.s=1/b<0?(B=B.slice(1),-1):1,p.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(S=m.slice(0,R),H=j=0,N=B.length;j<N;j++)if(S.indexOf(k=B.charAt(j))<0){if(k=="."){if(j>H){H=N;continue}}else if(!P&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){P=!0,j=-1,H=0;continue}return V(F,String(b),O,R)}O=!1,B=G(B,R,10,F.s),(H=B.indexOf("."))>-1?B=B.replace(".",""):H=B.length}for(j=0;B.charCodeAt(j)===48;j++);for(N=B.length;B.charCodeAt(--N)===48;);if(B=B.slice(j,++N)){if(N-=j,O&&p.DEBUG&&N>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((H=H-j-1)>Re)F.c=F.e=null;else if(H<gt)F.c=[F.e=0];else{if(F.e=H,F.c=[],j=(H+1)%u,H<0&&(j+=u),j<N){for(j&&F.c.push(+B.slice(0,j)),N-=u;j<N;)F.c.push(+B.slice(j,j+=u));j=u-(B=B.slice(j)).length}else j-=N;for(;j--;B+="0");F.c.push(+B)}}else F.c=[F.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],C(S,0,f,R),J=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],C(S,0,8,R),ee=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(C(S[0],-1e9,0,R),C(S[1],0,f,R),se=S[0],be=S[1]):(C(S,-1e9,f,R),se=-(be=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)C(S[0],-1e9,-1,R),C(S[1],1,f,R),gt=S[0],Re=S[1];else if(C(S,-1e9,f,R),S)gt=-(Re=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ae=S;else throw Ae=!S,Error(s+"crypto unavailable");else Ae=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],C(S,0,9,R),it=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],C(S,0,f,R),En=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")ot=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))v=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:J,ROUNDING_MODE:ee,EXPONENTIAL_AT:[se,be],RANGE:[gt,Re],CRYPTO:Ae,MODULO_MODE:it,POW_PRECISION:En,FORMAT:ot,ALPHABET:m}},p.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,S,k=b.c,P=b.e,H=b.s;e:if({}.toString.call(k)=="[object Array]"){if((H===1||H===-1)&&P>=-1e9&&P<=f&&P===o(P)){if(k[0]===0){if(P===0&&k.length===1)return!0;break e}if(R=(P+1)%u,R<1&&(R+=u),String(k[0]).length==R){for(R=0;R<k.length;R++)if(S=k[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if(k===null&&P===null&&(H===null||H===1||H===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},p.maximum=p.max=function(){return L(arguments,-1)},p.minimum=p.min=function(){return L(arguments,1)},p.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var k,P,H,j,O,N=0,B=[],F=new p(Q);if(S==null?S=J:C(S,0,f),j=i(S/u),Ae)if(crypto.getRandomValues){for(k=crypto.getRandomValues(new Uint32Array(j*=2));N<j;)O=k[N]*131072+(k[N+1]>>>11),O>=9e15?(P=crypto.getRandomValues(new Uint32Array(2)),k[N]=P[0],k[N+1]=P[1]):(B.push(O%1e14),N+=2);N=j/2}else if(crypto.randomBytes){for(k=crypto.randomBytes(j*=7);N<j;)O=(k[N]&31)*281474976710656+k[N+1]*1099511627776+k[N+2]*4294967296+k[N+3]*16777216+(k[N+4]<<16)+(k[N+5]<<8)+k[N+6],O>=9e15?crypto.randomBytes(7).copy(k,N):(B.push(O%1e14),N+=7);N=j/7}else throw Ae=!1,Error(s+"crypto unavailable");if(!Ae)for(;N<j;)O=R(),O<9e15&&(B[N++]=O%1e14);for(j=B[--N],S%=u,j&&S&&(O=h[u-S],B[N]=o(j/O)*O);B[N]===0;B.pop(),N--);if(N<0)B=[H=0];else{for(H=-1;B[0]===0;B.splice(0,1),H-=u);for(N=1,O=B[0];O>=10;O/=10,N++);N<u&&(H-=u-N)}return F.e=H,F.c=B,F}}(),p.sum=function(){for(var b=1,R=arguments,S=new p(R[0]);b<R.length;)S=S.plus(R[b++]);return S},G=function(){var b="0123456789";function R(S,k,P,H){for(var j,O=[0],N,B=0,F=S.length;B<F;){for(N=O.length;N--;O[N]*=k);for(O[0]+=H.indexOf(S.charAt(B++)),j=0;j<O.length;j++)O[j]>P-1&&(O[j+1]==null&&(O[j+1]=0),O[j+1]+=O[j]/P|0,O[j]%=P)}return O.reverse()}return function(S,k,P,H,j){var O,N,B,F,Y,ae,ce,Me,Fe=S.indexOf("."),ze=J,Te=ee;for(Fe>=0&&(F=En,En=0,S=S.replace(".",""),Me=new p(k),ae=Me.pow(S.length-Fe),En=F,Me.c=R($(y(ae.c),ae.e,"0"),10,P,b),Me.e=Me.c.length),ce=R(S,k,P,j?(O=m,b):(O=b,m)),B=F=ce.length;ce[--F]==0;ce.pop());if(!ce[0])return O.charAt(0);if(Fe<0?--B:(ae.c=ce,ae.e=B,ae.s=H,ae=M(ae,Me,ze,Te,P),ce=ae.c,Y=ae.r,B=ae.e),N=B+ze+1,Fe=ce[N],F=P/2,Y=Y||N<0||ce[N+1]!=null,Y=Te<4?(Fe!=null||Y)&&(Te==0||Te==(ae.s<0?3:2)):Fe>F||Fe==F&&(Te==4||Y||Te==6&&ce[N-1]&1||Te==(ae.s<0?8:7)),N<1||!ce[0])S=Y?$(O.charAt(1),-ze,O.charAt(0)):O.charAt(0);else{if(ce.length=N,Y)for(--P;++ce[--N]>P;)ce[N]=0,N||(++B,ce=[1].concat(ce));for(F=ce.length;!ce[--F];);for(Fe=0,S="";Fe<=F;S+=O.charAt(ce[Fe++]));S=$(S,B,O.charAt(0))}return S}}(),M=function(){function b(k,P,H){var j,O,N,B,F=0,Y=k.length,ae=P%d,ce=P/d|0;for(k=k.slice();Y--;)N=k[Y]%d,B=k[Y]/d|0,j=ce*N+B*ae,O=ae*N+j%d*d+F,F=(O/H|0)+(j/d|0)+ce*B,k[Y]=O%H;return F&&(k=[F].concat(k)),k}function R(k,P,H,j){var O,N;if(H!=j)N=H>j?1:-1;else for(O=N=0;O<H;O++)if(k[O]!=P[O]){N=k[O]>P[O]?1:-1;break}return N}function S(k,P,H,j){for(var O=0;H--;)k[H]-=O,O=k[H]<P[H]?1:0,k[H]=O*j+k[H]-P[H];for(;!k[0]&&k.length>1;k.splice(0,1));}return function(k,P,H,j,O){var N,B,F,Y,ae,ce,Me,Fe,ze,Te,Ve,Tt,Mi,Xo,Zr,Mt,un,Ct=k.s==P.s?1:-1,_t=k.c,We=P.c;if(!_t||!_t[0]||!We||!We[0])return new p(!k.s||!P.s||(_t?We&&_t[0]==We[0]:!We)?NaN:_t&&_t[0]==0||!We?Ct*0:Ct/0);for(Fe=new p(Ct),ze=Fe.c=[],B=k.e-P.e,Ct=H+B+1,O||(O=l,B=w(k.e/u)-w(P.e/u),Ct=Ct/u|0),F=0;We[F]==(_t[F]||0);F++);if(We[F]>(_t[F]||0)&&B--,Ct<0)ze.push(1),Y=!0;else{for(Xo=_t.length,Mt=We.length,F=0,Ct+=2,ae=o(O/(We[0]+1)),ae>1&&(We=b(We,ae,O),_t=b(_t,ae,O),Mt=We.length,Xo=_t.length),Mi=Mt,Te=_t.slice(0,Mt),Ve=Te.length;Ve<Mt;Te[Ve++]=0);un=We.slice(),un=[0].concat(un),Zr=We[0],We[1]>=O/2&&Zr++;do{if(ae=0,N=R(We,Te,Mt,Ve),N<0){if(Tt=Te[0],Mt!=Ve&&(Tt=Tt*O+(Te[1]||0)),ae=o(Tt/Zr),ae>1)for(ae>=O&&(ae=O-1),ce=b(We,ae,O),Me=ce.length,Ve=Te.length;R(ce,Te,Me,Ve)==1;)ae--,S(ce,Mt<Me?un:We,Me,O),Me=ce.length,N=1;else ae==0&&(N=ae=1),ce=We.slice(),Me=ce.length;if(Me<Ve&&(ce=[0].concat(ce)),S(Te,ce,Ve,O),Ve=Te.length,N==-1)for(;R(We,Te,Mt,Ve)<1;)ae++,S(Te,Mt<Ve?un:We,Ve,O),Ve=Te.length}else N===0&&(ae++,Te=[0]);ze[F++]=ae,Te[0]?Te[Ve++]=_t[Mi]||0:(Te=[_t[Mi]],Ve=1)}while((Mi++<Xo||Te[0]!=null)&&Ct--);Y=Te[0]!=null,ze[0]||ze.splice(0,1)}if(O==l){for(F=1,Ct=ze[0];Ct>=10;Ct/=10,F++);K(Fe,H+(Fe.e=F+B*u-1)+1,j,Y)}else Fe.e=B,Fe.r=+Y;return Fe}}();function x(b,R,S,k){var P,H,j,O,N;if(S==null?S=ee:C(S,0,8),!b.c)return b.toString();if(P=b.c[0],j=b.e,R==null)N=y(b.c),N=k==1||k==2&&(j<=se||j>=be)?_(N,j):$(N,j,"0");else if(b=K(new p(b),R,S),H=b.e,N=y(b.c),O=N.length,k==1||k==2&&(R<=H||H<=se)){for(;O<R;N+="0",O++);N=_(N,H)}else if(R-=j,N=$(N,H,"0"),H+1>O){if(--R>0)for(N+=".";R--;N+="0");}else if(R+=H-O,R>0)for(H+1==O&&(N+=".");R--;N+="0");return b.s<0&&P?"-"+N:N}function L(b,R){for(var S,k,P=1,H=new p(b[0]);P<b.length;P++)k=new p(b[P]),(!k.s||(S=E(H,k))===R||S===0&&H.s===R)&&(H=k);return H}function U(b,R,S){for(var k=1,P=R.length;!R[--P];R.pop());for(P=R[0];P>=10;P/=10,k++);return(S=k+S*u-1)>Re?b.c=b.e=null:S<gt?b.c=[b.e=0]:(b.e=S,b.c=R),b}V=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,P=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(H,j,O,N){var B,F=O?j:j.replace(P,"");if(k.test(F))H.s=isNaN(F)?null:F<0?-1:1;else{if(!O&&(F=F.replace(b,function(Y,ae,ce){return B=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!N||N==B?ae:Y}),N&&(B=N,F=F.replace(R,"$1").replace(S,"0.$1")),j!=F))return new p(F,B);if(p.DEBUG)throw Error(s+"Not a"+(N?" base "+N:"")+" number: "+j);H.s=null}H.c=H.e=null}}();function K(b,R,S,k){var P,H,j,O,N,B,F,Y=b.c,ae=h;if(Y){e:{for(P=1,O=Y[0];O>=10;O/=10,P++);if(H=R-P,H<0)H+=u,j=R,N=Y[B=0],F=o(N/ae[P-j-1]%10);else if(B=i((H+1)/u),B>=Y.length)if(k){for(;Y.length<=B;Y.push(0));N=F=0,P=1,H%=u,j=H-u+1}else break e;else{for(N=O=Y[B],P=1;O>=10;O/=10,P++);H%=u,j=H-u+P,F=j<0?0:o(N/ae[P-j-1]%10)}if(k=k||R<0||Y[B+1]!=null||(j<0?N:N%ae[P-j-1]),k=S<4?(F||k)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||k||S==6&&(H>0?j>0?N/ae[P-j]:0:Y[B-1])%10&1||S==(b.s<0?8:7)),R<1||!Y[0])return Y.length=0,k?(R-=b.e+1,Y[0]=ae[(u-R%u)%u],b.e=-R||0):Y[0]=b.e=0,b;if(H==0?(Y.length=B,O=1,B--):(Y.length=B+1,O=ae[u-H],Y[B]=j>0?o(N/ae[P-j]%ae[j])*O:0),k)for(;;)if(B==0){for(H=1,j=Y[0];j>=10;j/=10,H++);for(j=Y[0]+=O,O=1;j>=10;j/=10,O++);H!=O&&(b.e++,Y[0]==l&&(Y[0]=1));break}else{if(Y[B]+=O,Y[B]!=l)break;Y[B--]=0,O=1}for(H=Y.length;Y[--H]===0;Y.pop());}b.e>Re?b.c=b.e=null:b.e<gt&&(b.c=[b.e=0])}return b}function X(b){var R,S=b.e;return S===null?b.toString():(R=y(b.c),R=S<=se||S>=be?_(R,S):$(R,S,"0"),b.s<0?"-"+R:R)}return W.absoluteValue=W.abs=function(){var b=new p(this);return b.s<0&&(b.s=1),b},W.comparedTo=function(b,R){return E(this,new p(b,R))},W.decimalPlaces=W.dp=function(b,R){var S,k,P,H=this;if(b!=null)return C(b,0,f),R==null?R=ee:C(R,0,8),K(new p(H),b+H.e+1,R);if(!(S=H.c))return null;if(k=((P=S.length-1)-w(this.e/u))*u,P=S[P])for(;P%10==0;P/=10,k--);return k<0&&(k=0),k},W.dividedBy=W.div=function(b,R){return M(this,new p(b,R),J,ee)},W.dividedToIntegerBy=W.idiv=function(b,R){return M(this,new p(b,R),0,1)},W.exponentiatedBy=W.pow=function(b,R){var S,k,P,H,j,O,N,B,F,Y=this;if(b=new p(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+X(b));if(R!=null&&(R=new p(R)),O=b.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!b.c||!b.c[0])return F=new p(Math.pow(+X(Y),O?b.s*(2-A(b)):+X(b))),R?F.mod(R):F;if(N=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);k=!N&&Y.isInteger()&&R.isInteger(),k&&(Y=Y.mod(R))}else{if(b.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||O&&Y.c[1]>=24e7:Y.c[0]<8e13||O&&Y.c[0]<=9999975e7)))return H=Y.s<0&&A(b)?-0:0,Y.e>-1&&(H=1/H),new p(N?1/H:H);En&&(H=i(En/u+2))}for(O?(S=new p(.5),N&&(b.s=1),B=A(b)):(P=Math.abs(+X(b)),B=P%2),F=new p(Q);;){if(B){if(F=F.times(Y),!F.c)break;H?F.c.length>H&&(F.c.length=H):k&&(F=F.mod(R))}if(P){if(P=o(P/2),P===0)break;B=P%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)B=A(b);else{if(P=+X(b),P===0)break;B=P%2}Y=Y.times(Y),H?Y.c&&Y.c.length>H&&(Y.c.length=H):k&&(Y=Y.mod(R))}return k?F:(N&&(F=Q.div(F)),R?F.mod(R):H?K(F,En,ee,j):F)},W.integerValue=function(b){var R=new p(this);return b==null?b=ee:C(b,0,8),K(R,R.e+1,b)},W.isEqualTo=W.eq=function(b,R){return E(this,new p(b,R))===0},W.isFinite=function(){return!!this.c},W.isGreaterThan=W.gt=function(b,R){return E(this,new p(b,R))>0},W.isGreaterThanOrEqualTo=W.gte=function(b,R){return(R=E(this,new p(b,R)))===1||R===0},W.isInteger=function(){return!!this.c&&w(this.e/u)>this.c.length-2},W.isLessThan=W.lt=function(b,R){return E(this,new p(b,R))<0},W.isLessThanOrEqualTo=W.lte=function(b,R){return(R=E(this,new p(b,R)))===-1||R===0},W.isNaN=function(){return!this.s},W.isNegative=function(){return this.s<0},W.isPositive=function(){return this.s>0},W.isZero=function(){return!!this.c&&this.c[0]==0},W.minus=function(b,R){var S,k,P,H,j=this,O=j.s;if(b=new p(b,R),R=b.s,!O||!R)return new p(NaN);if(O!=R)return b.s=-R,j.plus(b);var N=j.e/u,B=b.e/u,F=j.c,Y=b.c;if(!N||!B){if(!F||!Y)return F?(b.s=-R,b):new p(Y?j:NaN);if(!F[0]||!Y[0])return Y[0]?(b.s=-R,b):new p(F[0]?j:ee==3?-0:0)}if(N=w(N),B=w(B),F=F.slice(),O=N-B){for((H=O<0)?(O=-O,P=F):(B=N,P=Y),P.reverse(),R=O;R--;P.push(0));P.reverse()}else for(k=(H=(O=F.length)<(R=Y.length))?O:R,O=R=0;R<k;R++)if(F[R]!=Y[R]){H=F[R]<Y[R];break}if(H&&(P=F,F=Y,Y=P,b.s=-b.s),R=(k=Y.length)-(S=F.length),R>0)for(;R--;F[S++]=0);for(R=l-1;k>O;){if(F[--k]<Y[k]){for(S=k;S&&!F[--S];F[S]=R);--F[S],F[k]+=l}F[k]-=Y[k]}for(;F[0]==0;F.splice(0,1),--B);return F[0]?U(b,F,B):(b.s=ee==3?-1:1,b.c=[b.e=0],b)},W.modulo=W.mod=function(b,R){var S,k,P=this;return b=new p(b,R),!P.c||!b.s||b.c&&!b.c[0]?new p(NaN):!b.c||P.c&&!P.c[0]?new p(P):(it==9?(k=b.s,b.s=1,S=M(P,b,0,3),b.s=k,S.s*=k):S=M(P,b,0,it),b=P.minus(S.times(b)),!b.c[0]&&it==1&&(b.s=P.s),b)},W.multipliedBy=W.times=function(b,R){var S,k,P,H,j,O,N,B,F,Y,ae,ce,Me,Fe,ze,Te=this,Ve=Te.c,Tt=(b=new p(b,R)).c;if(!Ve||!Tt||!Ve[0]||!Tt[0])return!Te.s||!b.s||Ve&&!Ve[0]&&!Tt||Tt&&!Tt[0]&&!Ve?b.c=b.e=b.s=null:(b.s*=Te.s,!Ve||!Tt?b.c=b.e=null:(b.c=[0],b.e=0)),b;for(k=w(Te.e/u)+w(b.e/u),b.s*=Te.s,N=Ve.length,Y=Tt.length,N<Y&&(Me=Ve,Ve=Tt,Tt=Me,P=N,N=Y,Y=P),P=N+Y,Me=[];P--;Me.push(0));for(Fe=l,ze=d,P=Y;--P>=0;){for(S=0,ae=Tt[P]%ze,ce=Tt[P]/ze|0,j=N,H=P+j;H>P;)B=Ve[--j]%ze,F=Ve[j]/ze|0,O=ce*B+F*ae,B=ae*B+O%ze*ze+Me[H]+S,S=(B/Fe|0)+(O/ze|0)+ce*F,Me[H--]=B%Fe;Me[H]=S}return S?++k:Me.splice(0,1),U(b,Me,k)},W.negated=function(){var b=new p(this);return b.s=-b.s||null,b},W.plus=function(b,R){var S,k=this,P=k.s;if(b=new p(b,R),R=b.s,!P||!R)return new p(NaN);if(P!=R)return b.s=-R,k.minus(b);var H=k.e/u,j=b.e/u,O=k.c,N=b.c;if(!H||!j){if(!O||!N)return new p(P/0);if(!O[0]||!N[0])return N[0]?b:new p(O[0]?k:P*0)}if(H=w(H),j=w(j),O=O.slice(),P=H-j){for(P>0?(j=H,S=N):(P=-P,S=O),S.reverse();P--;S.push(0));S.reverse()}for(P=O.length,R=N.length,P-R<0&&(S=N,N=O,O=S,R=P),P=0;R;)P=(O[--R]=O[R]+N[R]+P)/l|0,O[R]=l===O[R]?0:O[R]%l;return P&&(O=[P].concat(O),++j),U(b,O,j)},W.precision=W.sd=function(b,R){var S,k,P,H=this;if(b!=null&&b!==!!b)return C(b,1,f),R==null?R=ee:C(R,0,8),K(new p(H),b,R);if(!(S=H.c))return null;if(P=S.length-1,k=P*u+1,P=S[P]){for(;P%10==0;P/=10,k--);for(P=S[0];P>=10;P/=10,k++);}return b&&H.e+1>k&&(k=H.e+1),k},W.shiftedBy=function(b){return C(b,-9007199254740991,c),this.times("1e"+b)},W.squareRoot=W.sqrt=function(){var b,R,S,k,P,H=this,j=H.c,O=H.s,N=H.e,B=J+4,F=new p("0.5");if(O!==1||!j||!j[0])return new p(!O||O<0&&(!j||j[0])?NaN:j?H:1/0);if(O=Math.sqrt(+X(H)),O==0||O==1/0?(R=y(j),(R.length+N)%2==0&&(R+="0"),O=Math.sqrt(+R),N=w((N+1)/2)-(N<0||N%2),O==1/0?R="5e"+N:(R=O.toExponential(),R=R.slice(0,R.indexOf("e")+1)+N),S=new p(R)):S=new p(O+""),S.c[0]){for(N=S.e,O=N+B,O<3&&(O=0);;)if(P=S,S=F.times(P.plus(M(H,P,B,1))),y(P.c).slice(0,O)===(R=y(S.c)).slice(0,O))if(S.e<N&&--O,R=R.slice(O-3,O+1),R=="9999"||!k&&R=="4999"){if(!k&&(K(P,P.e+J+2,0),P.times(P).eq(H))){S=P;break}B+=4,O+=4,k=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(K(S,S.e+J+2,1),b=!S.times(S).eq(H));break}}return K(S,S.e+J+1,ee,b)},W.toExponential=function(b,R){return b!=null&&(C(b,0,f),b++),x(this,b,R,1)},W.toFixed=function(b,R){return b!=null&&(C(b,0,f),b=b+this.e+1),x(this,b,R)},W.toFormat=function(b,R,S){var k,P=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=ot;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if(k=P.toFixed(b,R),P.c){var H,j=k.split("."),O=+S.groupSize,N=+S.secondaryGroupSize,B=S.groupSeparator||"",F=j[0],Y=j[1],ae=P.s<0,ce=ae?F.slice(1):F,Me=ce.length;if(N&&(H=O,O=N,N=H,Me-=H),O>0&&Me>0){for(H=Me%O||O,F=ce.substr(0,H);H<Me;H+=O)F+=B+ce.substr(H,O);N>0&&(F+=B+ce.slice(H)),ae&&(F="-"+F)}k=Y?F+(S.decimalSeparator||"")+((N=+S.fractionGroupSize)?Y.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):Y):F}return(S.prefix||"")+k+(S.suffix||"")},W.toFraction=function(b){var R,S,k,P,H,j,O,N,B,F,Y,ae,ce=this,Me=ce.c;if(b!=null&&(O=new p(b),!O.isInteger()&&(O.c||O.s!==1)||O.lt(Q)))throw Error(s+"Argument "+(O.isInteger()?"out of range: ":"not an integer: ")+X(O));if(!Me)return new p(ce);for(R=new p(Q),B=S=new p(Q),k=N=new p(Q),ae=y(Me),H=R.e=ae.length-ce.e-1,R.c[0]=h[(j=H%u)<0?u+j:j],b=!b||O.comparedTo(R)>0?H>0?R:B:O,j=Re,Re=1/0,O=new p(ae),N.c[0]=0;F=M(O,R,0,1),P=S.plus(F.times(k)),P.comparedTo(b)!=1;)S=k,k=P,B=N.plus(F.times(P=B)),N=P,R=O.minus(F.times(P=R)),O=P;return P=M(b.minus(S),k,0,1),N=N.plus(P.times(B)),S=S.plus(P.times(k)),N.s=B.s=ce.s,H=H*2,Y=M(B,k,H,ee).minus(ce).abs().comparedTo(M(N,S,H,ee).minus(ce).abs())<1?[B,k]:[N,S],Re=j,Y},W.toNumber=function(){return+X(this)},W.toPrecision=function(b,R){return b!=null&&C(b,1,f),x(this,b,R,2)},W.toString=function(b){var R,S=this,k=S.s,P=S.e;return P===null?k?(R="Infinity",k<0&&(R="-"+R)):R="NaN":(b==null?R=P<=se||P>=be?_(y(S.c),P):$(y(S.c),P,"0"):b===10&&v?(S=K(new p(S),J+P+1,ee),R=$(y(S.c),S.e,"0")):(C(b,2,m.length,"Base"),R=G($(y(S.c),P,"0"),10,b,k,!0)),k<0&&S.c[0]&&(R="-"+R)),R},W.valueOf=W.toJSON=function(){return X(this)},W._isBigNumber=!0,I!=null&&p.set(I),p}function w(I){var M=I|0;return I>0||I===M?M:M-1}function y(I){for(var M,G,V=1,W=I.length,Q=I[0]+"";V<W;){for(M=I[V++]+"",G=u-M.length;G--;M="0"+M);Q+=M}for(W=Q.length;Q.charCodeAt(--W)===48;);return Q.slice(0,W+1||1)}function E(I,M){var G,V,W=I.c,Q=M.c,J=I.s,ee=M.s,se=I.e,be=M.e;if(!J||!ee)return null;if(G=W&&!W[0],V=Q&&!Q[0],G||V)return G?V?0:-ee:J;if(J!=ee)return J;if(G=J<0,V=se==be,!W||!Q)return V?0:!W^G?1:-1;if(!V)return se>be^G?1:-1;for(ee=(se=W.length)<(be=Q.length)?se:be,J=0;J<ee;J++)if(W[J]!=Q[J])return W[J]>Q[J]^G?1:-1;return se==be?0:se>be^G?1:-1}function C(I,M,G,V){if(I<M||I>G||I!==o(I))throw Error(s+(V||"Argument")+(typeof I=="number"?I<M||I>G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(I))}function A(I){var M=I.c.length-1;return w(I.e/u)==M&&I.c[M]%2!=0}function _(I,M){return(I.length>1?I.charAt(0)+"."+I.slice(1):I)+(M<0?"e":"e+")+M}function $(I,M,G){var V,W;if(M<0){for(W=G+".";++M;W+=G);I=W+I}else if(V=I.length,++M>V){for(W=G,M-=V;--M;W+=G);I+=W}else M<V&&(I=I.slice(0,M)+"."+I.slice(M));return I}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(sae)})(lL);var uL=lL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const $i=WM(),Pae=FM(),xae=VM,Oae=uL,An={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},hg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:cL,decimalSuffixes:Rw}=$i.currentBytes(),BM={general:{scale:1024,suffixes:Rw},binary:{scale:1024,suffixes:cL},decimal:{scale:1e3,suffixes:Rw}};function Iae(t,e={},n){if(typeof e=="string"&&(e=xae.parseFormat(e)),!Pae.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=Aae(t,e,n);return s=Jae(s,i),s=Zae(s,o),s}function Aae(t,e,n){switch(e.output){case"currency":return e=dc(e,$i.currentCurrencyDefaultFormat()),Vae(t,e,$i);case"percent":return e=dc(e,$i.currentPercentageDefaultFormat()),Fae(t,e,$i,n);case"byte":return e=dc(e,$i.currentByteDefaultFormat()),kae(t,e,$i,n);case"time":return e=dc(e,$i.currentTimeDefaultFormat()),Lae(t);case"ordinal":return e=dc(e,$i.currentOrdinalDefaultFormat()),$ae(t,e,$i);case"number":default:return dg({instance:t,providedFormat:e})}}function Hae(t){let e=BM.decimal;return Yv(t._value,e.suffixes,e.scale).suffix}function Nae(t){let e=BM.binary;return Yv(t._value,e.suffixes,e.scale).suffix}function Dae(t){let e=BM.general;return Yv(t._value,e.suffixes,e.scale).suffix}function Yv(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function kae(t,e,n,r){let i=e.base||"binary",o=Object.assign({},hg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Rw,marker:"bd"},binary:{scale:1024,suffixes:s||cL,marker:"b"},decimal:{scale:1e3,suffixes:a||Rw,marker:"d"}}[i],{value:c,suffix:h}=Yv(t._value,u.suffixes,u.scale);return`${dg({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function $ae(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},hg,e),o=dg({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function Lae(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function Fae(t,e,n,r){let i=e.prefixSymbol,o=dg({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},hg,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function Vae(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},hg,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=dg({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function Wae({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&An[e]?(a=r[e],t=t/An[e]):l>=An.trillion||n&&s(l/An.trillion)===1?(a=r.trillion,t=t/An.trillion):l<An.trillion&&l>=An.billion||n&&s(l/An.billion)===1?(a=r.billion,t=t/An.billion):l<An.billion&&l>=An.million||n&&s(l/An.million)===1?(a=r.million,t=t/An.million):(l<An.million&&l>=An.thousand||n&&s(l/An.thousand)===1)&&(a=r.thousand,t=t/An.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function Bae({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function pm(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function jae(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+pm(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(pm(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=pm(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${pm(e)}`),n}function Uae(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?jae(t,e):new Oae(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function zae(t,e,n,r,i,o){if(r===-1)return t;let s=Uae(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function Yae(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function Gae(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function Kae(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),Gae(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function qae(t,e){return t+e}function Xae(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function Jae(t,e){return e+t}function Zae(t,e){return t+e}function dg({instance:t,providedFormat:e,state:n=$i,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},hg,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,w=s.trimMantissa,y=s.thousandSeparated,E=s.spaceSeparated,C=s.negative,A=s.forceSign,_=s.exponential,$=s.roundingFunction,I="";if(d){let G=Wae({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:$,totalLength:a});o=G.value,I+=G.abbreviation,a&&(f=G.mantissaPrecision)}if(_){let G=Bae({value:o,characteristicPrecision:l});o=G.value,I=G.abbreviation+I}let M=zae(o.toString(),o,g,f,w,$);return M=Yae(M,o,u,l),M=Kae(M,o,y,n,r),(d||_)&&(M=qae(M,I)),(A||o<0)&&(M=Xae(M,o,C)),M}function dc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var Qae=t=>({format:(...e)=>Iae(...e,t),getByteUnit:(...e)=>Dae(...e,t),getBinaryByteUnit:(...e)=>Nae(...e,t),getDecimalByteUnit:(...e)=>Hae(...e,t),formatOrDefault:dc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ns=uL;function ele(t,e,n){let r=new Ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ns(i),t._value=r.plus(i).toNumber(),t}function hL(t,e,n){let r=new Ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ns(i),t._value=r.minus(i).toNumber(),t}function tle(t,e,n){let r=new Ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ns(i),t._value=r.times(i).toNumber(),t}function nle(t,e,n){let r=new Ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ns(i),t._value=r.dividedBy(i).toNumber(),t}function rle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function ile(t,e,n){let r=n(t._value);return hL(r,e,n),Math.abs(r._value)}var ole=t=>({add:(e,n)=>ele(e,n,t),subtract:(e,n)=>hL(e,n,t),multiply:(e,n)=>tle(e,n,t),divide:(e,n)=>nle(e,n,t),set:(e,n)=>rle(e,n,t),difference:(e,n)=>ile(e,n,t),BigNumber:Ns});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const sle="2.5.0",qo=WM(),ale=FM(),lle=_ae(Jt),ule=aL();let ol=Qae(Jt),kl=ole(Jt);const cle=VM;class dL{constructor(e){this._value=e}clone(){return Jt(this._value)}format(e={}){return ol.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=cle.parseFormat(e)),e=ol.formatOrDefault(e,qo.currentCurrencyDefaultFormat()),e.output="currency",ol.format(this,e)}formatTime(e={}){return e.output="time",ol.format(this,e)}binaryByteUnits(){return ol.getBinaryByteUnit(this)}decimalByteUnits(){return ol.getDecimalByteUnit(this)}byteUnits(){return ol.getByteUnit(this)}difference(e){return kl.difference(this,e)}add(e){return kl.add(this,e)}subtract(e){return kl.subtract(this,e)}multiply(e){return kl.multiply(this,e)}divide(e){return kl.divide(this,e)}set(e){return kl.set(this,fL(e))}value(){return this._value}valueOf(){return this._value}}function fL(t){let e=t;return Jt.isNumbro(t)?e=t._value:typeof t=="string"?e=Jt.unformat(t):isNaN(t)&&(e=NaN),e}function Jt(t){return new dL(fL(t))}Jt.version=sle;Jt.isNumbro=function(t){return t instanceof dL};Jt.language=qo.currentLanguage;Jt.registerLanguage=qo.registerLanguage;Jt.setLanguage=qo.setLanguage;Jt.languages=qo.languages;Jt.languageData=qo.languageData;Jt.zeroFormat=qo.setZeroFormat;Jt.defaultFormat=qo.currentDefaults;Jt.setDefaults=qo.setDefaults;Jt.defaultCurrencyFormat=qo.currentCurrencyDefaultFormat;Jt.validate=ale.validate;Jt.loadLanguagesInNode=lle.loadLanguagesInNode;Jt.unformat=ule.unformat;Jt.BigNumber=kl.BigNumber;var hle=Jt,sl=aae(hle);const dle="numeric";function gL(t,e){if(Un(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!sl.languages()[r]){const o=r.replace("-",""),s=sl.allLanguages?sl.allLanguages[r]:sl[o];s&&sl.registerLanguage(s)}sl.setLanguage(r),t=sl(t).format(i||"0")}return t}function jM(t,e,n,r,i,o,s){let a=o;if(Un(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=gL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}js(t,e,n,r,i,a,s)}jM.RENDERER_TYPE=dle;const fle="password";function UM(t,e,n,r,i,o,s){js.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),bu(e,u)}UM.RENDERER_TYPE=fle;const gle="select";function zM(t,e,n,r,i,o,s){js.apply(this,[t,e,n,r,i,o,s])}zM.RENDERER_TYPE=gle;const mle="time";function YM(t,e,n,r,i,o,s){js.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}YM.RENDERER_TYPE=mle;function ple(){Fr(hh),Fr(cg),Fr(kM),Fr(DM),Fr(LM),Fr(NM),Fr(jM),Fr(UM),Fr(zM),Fr(js),Fr(YM)}const wle="autocomplete";function Gv(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,bI(n,e)):bI(n,e)(this.source):e(!0)}Gv.VALIDATOR_TYPE=wle;function bI(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function mL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const vle=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:mL},Symbol.toStringTag,{value:"Module"})),yle="date";function GM(t,e){const n=Bk(Q$,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=Cle(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}GM.VALIDATOR_TYPE=yle;function Cle(t,e){const n=Z(mL(t)),r=Z(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const ble="dropdown";function KM(t,e){Gv.apply(this,[t,e])}KM.VALIDATOR_TYPE=ble;const Sle="numeric";function qM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Un(t))}qM.VALIDATOR_TYPE=Sle;const Rle=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Ele="time";function XM(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,Rle,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}XM.VALIDATOR_TYPE=Ele;function Tle(){Wl(Gv),Wl(KM),Wl(GM),Wl(qM),Wl(XM)}const Mle="autocomplete",_le={CELL_TYPE:Mle,editor:AM,renderer:hh,validator:Gv},Ple="checkbox",xle={CELL_TYPE:Ple,editor:Z$,renderer:kM},Ole="date";function pL(t,e,n,r,i,o,s){hh.apply(this,[t,e,n,r,i,o,s])}pL.RENDERER_TYPE=Ole;const Ile="date",Ale={CELL_TYPE:Ile,editor:eL,renderer:pL,validator:GM},Hle="dropdown",Nle={CELL_TYPE:Hle,editor:tL,renderer:DM,validator:KM,filter:!1,strict:!0},Dle="handsontable",kle={CELL_TYPE:Dle,editor:IM,renderer:LM},$le="numeric",Lle={CELL_TYPE:$le,editor:nL,renderer:jM,validator:qM,dataType:"number"},Fle="password",Vle={CELL_TYPE:Fle,editor:rL,renderer:UM,copyable:!1},Wle="select",Ble={CELL_TYPE:Wle,editor:iL,renderer:zM},jle="time",Ule={CELL_TYPE:jle,editor:oL,renderer:YM,validator:XM};function zle(){oi(_le),oi(xle),oi(Ale),oi(Nle),oi(kle),oi(Lle),oi(Vle),oi(Ble),oi(X$),oi(Ule)}function Yle(t,e){wL(t,e),e.add(t)}function Gle(t,e,n){wL(t,e),e.set(t,n)}function wL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lu(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=qle(t,"string");return typeof e=="symbol"?e:e+""}function qle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fu(t,e){return t.get(vL(t,e))}function vL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SI=new Map([["plugin",nQ],["cell-type",V$],["editor",Wk],["renderer",Jk],["validator",Zk]]),yL=Symbol("mainSetting"),Xle="base",wm=[];let al=null;var ll=new WeakMap,RI=new WeakSet;class qe{static get PLUGIN_KEY(){return Xle}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){Yle(this,RI),Lu(this,"eventManager",new vi(this)),Lu(this,"pluginName",null),Lu(this,"pluginsInitializedCallbacks",[]),Lu(this,"isPluginsReady",!1),Lu(this,"enabled",!1),Lu(this,"initialized",!1),Gle(this,ll,{}),Ko(this,"hot",e,{writable:!1}),al=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!SI.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);SI.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");wm.push(o)}}if(al||(al=NE()),al.indexOf(this.pluginName)>=0&&al.splice(al.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),al.length===0){if(wm.length>0){const i=[`${wm.join(`
`)}
`,"You have to import and register them manually."].join("");throw wm.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||De(n))&&r[yL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(De(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){Fu(ll,this)[e]=Fu(ll,this)[e]||[];const i=Fu(ll,this)[e];this.hot.addHook(e,n,r),i.push(n),Fu(ll,this)[e]=i}removeHooks(e){T(Fu(ll,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Fu(ll,this);ke(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){T(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=vL(RI,this,Jle).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ke(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function Jle(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ul(t,e,n){return(e=Zle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zle(t){var e=Qle(t,"string");return typeof e=="symbol"?e:e+""}function Qle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let JM=class{constructor(e){ul(this,"hot",null),ul(this,"container",null),ul(this,"injected",!1),ul(this,"rows",[]),ul(this,"columns",[]),ul(this,"samples",null),ul(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),T(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),T(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{T(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{T(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{T(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),T(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{T(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function vm(t,e,n){return(e=eue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eue(t){var e=tue(t,"string");return typeof e=="symbol"?e:e+""}function tue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kv{static get SAMPLE_COUNT(){return 3}constructor(e){vm(this,"samples",null),vm(this,"dataFactory",null),vm(this,"customSampleCount",null),vm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Kv.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:De(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Rt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function nue(t,e){CL(t,e),e.add(t)}function JC(t,e,n){CL(t,e),e.set(t,n)}function CL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yh(t,e,n){return(e=rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rue(t){var e=iue(t,"string");return typeof e=="symbol"?e:e+""}function iue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ta(t,e){return t.get(Mr(t,e))}function Ew(t,e,n){return t.set(Mr(t,e),n),n}function Mr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutoColumnSizeSeed");const ZC="autoColumnSize",oue=10,sue="autoColumnSize";var ZM=new WeakMap,fc=new WeakMap,Gc=new WeakMap,Vr=new WeakSet;class Bd extends qe{static get PLUGIN_KEY(){return ZC}static get PLUGIN_PRIORITY(){return oue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),nue(this,Vr),Yh(this,"ghostTable",new JM(this.hot)),Yh(this,"samplesGenerator",new Kv((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Yh(this,"inProgress",!1),Yh(this,"measuredColumns",0),Yh(this,"columnWidthsMap",new ja),JC(this,ZM,!1),JC(this,fc,[]),JC(this,Gc,[]),this.hot.columnIndexMapper.registerMap(sue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Mr(Vr,this,EI).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[ZC]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Mr(Vr,e,uue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Mr(Vr,e,cue).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Mr(Vr,e,due).call(e,...i)}),this.addHook("beforeRender",()=>Mr(Vr,this,lue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Mr(Vr,this,hue).call(this)),super.enablePlugin()}updatePlugin(){Ew(Gc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Mr(Vr,this,EI).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Mr(Vr,this,bL).call(this,s,o)}),this.ghostTable.columns.length&&(Mr(Vr,this,SL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Cf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Bd.CALCULATION_STEP,i)},e,n),r=r+Bd.CALCULATION_STEP+1,r<i?o=yf(s):(Cf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[ZC];let n=Bd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return De(e)&&(n=e.syncLimit,lE(n)?n=AE(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,jc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Ta(fc,this).length;return(s-1<o||Ta(fc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Ta(fc,this).push(i):Ta(fc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function aue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||Mr(Vr,this,bL).call(this,n,e))}),this.ghostTable.columns.length&&(Mr(Vr,this,SL).call(this),this.ghostTable.clean())}function bL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function SL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function lue(){this.calculateVisibleColumnsWidth(),this.inProgress||(Mr(Vr,this,aue).call(this,Ta(Gc,this)),Ew(Gc,this,[]))}function uue(t,e){e||this.recalculateAllColumnsWidth()}function cue(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Ta(Gc,this).push(...e)}function EI(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function hue(){Ew(fc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Ew(ZM,this,!0)}function due(t){if(!Ta(ZM,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Ta(Gc,this).push(...e)}const Ul={horizontal:"horizontal",vertical:"vertical"};function fue(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function gue(t){const e={};return t===!0?(e.directions=Object.keys(Ul),e.autoInsertRow=!0):De(t)?(le(t.autoInsertRow)?t.direction===Ul.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ul)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function mue(t,e){pue(t,e),e.add(t)}function pue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vu(t,e,n){return(e=wue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wue(t){var e=vue(t,"string");return typeof e=="symbol"?e:e+""}function vue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutofillRange");ie.getSingleton().register("beforeAutofill");ie.getSingleton().register("afterAutofill");const TI="autofill",yue=20,Cue=["fillHandle"],bue="insert_row_below",Sue=200;var Wu=new WeakSet;class Rue extends qe{constructor(){super(...arguments),mue(this,Wu),Vu(this,"addingStarted",!1),Vu(this,"mouseDownOnCellCorner",!1),Vu(this,"mouseDragOutside",!1),Vu(this,"handleDraggedCells",0),Vu(this,"directions",[]),Vu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return TI}static get PLUGIN_PRIORITY(){return yue}static get SETTING_KEYS(){return[TI,...Cue]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Gh(Wu,this,Tue).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Gh(Wu,this,Eue).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Gh(Wu,this,Mue).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return T(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),T(a,c=>{const h=[];T(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=fue(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),w=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,g,w,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=y;const C=y;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(E=[],c==="up"){const A=d.row-h.row+1,_=A%C.length;for(let $=0;$<A;$++)E.push(C[($+(C.length-_))%C.length])}else{const A=d.col-h.col+1,_=A%C[0].length;for(let $=0;$<C.length;$++){E.push([]);for(let I=0;I<A;I++)E[$].push(C[$][(I+(C[$].length-_))%C[$].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,w,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Ul.vertical)&&this.directions.includes(Ul.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Ul.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Ul.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(bue,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Sue)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!jt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!jt(s)||!jt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Dn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+rn(this.hot.table),i=Dn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Xt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Gh(Wu,this,_ue).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Gh(Wu,this,Pue).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=gue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Eue(){this.selectAdjacent()&&this.fillIn()}function Tue(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Mue(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function _ue(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Pue(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function xue(t,e){RL(t,e),e.add(t)}function MI(t,e,n){RL(t,e),e.set(t,n)}function RL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bu(t,e,n){return(e=Oue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oue(t){var e=Iue(t,"string");return typeof e=="symbol"?e:e+""}function Iue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EL(t,e,n){return t.set(_o(t,e),n),n}function Tw(t,e){return t.get(_o(t,e))}function _o(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const QC="autoRowSize",Aue=40,Hue="autoRowSize";var Tf=new WeakMap,QM=new WeakMap,ds=new WeakSet;class jd extends qe{static get PLUGIN_KEY(){return QC}static get PLUGIN_PRIORITY(){return Aue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),xue(this,ds),Bu(this,"headerHeight",null),Bu(this,"ghostTable",new JM(this.hot)),Bu(this,"samplesGenerator",new Kv((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Bu(this,"inProgress",!1),Bu(this,"measuredRows",0),Bu(this,"rowHeightsMap",new ja),MI(this,Tf,[]),MI(this,QM,!1),this.hot.rowIndexMapper.registerMap(Hue,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>_o(ds,this,_I).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[QC];return e===!0||De(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _o(ds,e,kue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _o(ds,e,$ue).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _o(ds,e,Fue).call(e,...i)}),this.addHook("beforeRender",()=>_o(ds,this,Due).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>_o(ds,this,Lue).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>_o(ds,this,_I).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Cf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+jd.CALCULATION_STEP,i)},e,n),r=r+jd.CALCULATION_STEP+1,r<i?o=yf(s):(Cf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[QC];let n=jd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return De(e)&&(n=e.syncLimit,lE(n)?n=AE(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Nue(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Due(){this.calculateVisibleRowsHeight(),this.inProgress||(_o(ds,this,Nue).call(this,Tw(Tf,this)),EL(Tf,this,[]))}function _I(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function kue(t,e){e||this.recalculateAllRowsHeight()}function $ue(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Tw(Tf,this).push(...e)}function Lue(){this.recalculateAllRowsHeight(),EL(QM,this,!0)}function Fue(t){if(!Tw(QM,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Tw(Tf,this).push(...e)}const{getListWithInsertedItems:Vue,getListWithRemovedItems:Wue}=S$("physicallyIndexed");class Bue extends Su{constructor(){super(e=>e)}insert(e,n){const r=oT(this.indexedValues,n);this.indexedValues=Vue(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Wue(this.indexedValues,e);this.indexedValues=iT(n,e),super.remove(e)}}const{getListWithInsertedItems:jue,getListWithRemovedItems:Uue}=S$("physicallyIndexed");class zue extends Su{constructor(){super(e=>e)}insert(e,n){this.indexedValues=jue(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=Uue(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Yue(t,e){Gue(t,e),e.add(t)}function Gue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kue(t,e,n){return(e=que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function que(t){var e=Xue(t,"string");return typeof e=="symbol"?e:e+""}function Xue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jue(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const PI="bindRowsWithHeaders",Zue=210,Que="loose",xI=new Map([["loose",Bue],["strict",zue]]);var OI=new WeakSet;class ece extends qe{constructor(){super(...arguments),Yue(this,OI),Kue(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PI}static get PLUGIN_PRIORITY(){return Zue}isEnabled(){return!!this.hot.getSettings()[PI]}enablePlugin(){var e;if(this.enabled)return;const n=(e=xI.get(this.getSetting()))!==null&&e!==void 0?e:xI.get(Que);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>Jue(OI,this,tce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function tce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function nce(t,e){TL(t,e),e.add(t)}function rce(t,e,n){TL(t,e),e.set(t,n)}function TL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function II(t,e,n){return(e=ice(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ice(t){var e=oce(t,"string");return typeof e=="symbol"?e:e+""}function oce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AI(t,e){return t.get(bc(t,e))}function eb(t,e,n){return t.set(bc(t,e),n),n}function bc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xp="collapsibleColumns",sce=290,ace=["nestedHeaders"],Nc="collapsibleIndicator",HI=xp,NI=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var ju=new WeakMap,Kh=new WeakSet;class lce extends qe{constructor(){super(...arguments),nce(this,Kh),II(this,"nestedHeadersPlugin",null),II(this,"headerStateManager",null),rce(this,ju,null)}static get PLUGIN_KEY(){return xp}static get PLUGIN_PRIORITY(){return sce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[xp,...ace]}isEnabled(){return!!this.hot.getSettings()[xp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||et("You need to configure the Nested Headers plugin in order to use collapsible headers."),eb(ju,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>bc(Kh,this,hce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return bc(Kh,e,dce).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return bc(Kh,e,uce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>bc(Kh,this,cce).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),eb(ju,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:HI,relativeToGroup:Ua,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HI)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Nc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Nc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Nc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!NI.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Da(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;T(r,f=>{var g;let{row:w,col:y}=f;const{collapsible:E,isCollapsed:C}=(g=this.headerStateManager.getHeaderSettings(w,y))!==null&&g!==void 0?g:{};if(!E||C&&n==="collapse"||!C&&n==="expand")return i=!1,!1});const o=[],s=[];i&&T(r,f=>{let{row:g,col:w}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:C}=this.headerStateManager.triggerNodeModification(n,g,w);y>0&&(s.push(...E),o.push(C))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=ZD([...a,...s]):n==="expand"&&(l=Da(a,f=>!s.includes(f)));const u=NI.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){T(o,f=>{f()});return}this.hot.batchExecution(()=>{T(s,f=>{AI(ju,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;y!==null&&E!==null&&this.hot.selectCell(y,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return AI(ju,this).getHiddenIndexes()}destroy(){eb(ju,this,null),super.destroy()}}function uce(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Nc}`);if(Cu(e,[mi("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,Nc),e.querySelector("div:first-child").appendChild(u)),pe(u,["collapsed","expanded"]),s?(q(u,"collapsed"),$a(u,"+"),l&&Ce(e,...mi(!1))):(q(u,"expanded"),$a(u,"-"),l&&Ce(e,...mi(!0))),l&&Ce(u,...yu());else{var c;(c=u)===null||c===void 0||c.remove()}}function cce(t,e){we(t.target,Nc)&&(we(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):we(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ei(t))}function hce(){this.updatePlugin()}function dce(t,e){e||this.updatePlugin()}function cl(t,e,n){return(e=fce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fce(t){var e=gce(t,"string");return typeof e=="symbol"?e:e+""}function gce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mce=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],pce=!1,wce=!0,vce=!0;class yce{constructor(e,n){cl(this,"hot",void 0),cl(this,"sortingStates",new Fv),cl(this,"sortEmptyCells",pce),cl(this,"indicator",wce),cl(this,"headerAction",vce),cl(this,"compareFunctionFactory",void 0),cl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){De(e)&&ke(e,(n,r)=>{mce.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return De(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function ML(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Fo:jt(i)?jt(o)?Fo:s&&t==="asc"?Wt:Bt:jt(o)?s&&t==="asc"?Bt:Wt:isNaN(i)&&!isNaN(o)?t==="asc"?Bt:Wt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Wt:Bt:i>o?t==="asc"?Bt:Wt:Fo}}const _L="default";function Cce(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Fo;if(a){if(jt(r))return t==="asc"?Wt:Bt;if(jt(i))return t==="asc"?Bt:Wt}return isNaN(o)?Bt:isNaN(s)?Wt:o<s?t==="asc"?Wt:Bt:o>s?t==="asc"?Bt:Wt:Fo}}const bce="numeric";function Sce(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=jt(s),u=jt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Bt;if(l===!1&&u)return Wt}return d===!1&&f?t==="asc"?Wt:Bt:d&&f===!1?t==="asc"?Bt:Wt:d===!1&&f===!1?ML(t,e,n)(s,a):c===i&&h===r?t==="asc"?Wt:Bt:c===r&&h===i?t==="asc"?Bt:Wt:Fo}}const Rce="checkbox";function Ece(t,e,n){return HL(t,e.dateFormat,n)}const Tce="date";function Mce(t,e,n){return HL(t,e.timeFormat,n)}const _ce="time",{register:fg,getItem:DI,hasItem:Pce}=Qi("sorting.compareFunctionFactory"),{register:PL,getItem:xce}=Qi("sorting.mainSortComparator");function xL(t){return Pce(t)?DI(t):DI(_L)}fg(Rce,Sce);fg(Tce,Ece);fg(_L,ML);fg(bce,Cce);fg(_ce,Mce);const Fo=0,Wt=-1,Bt=1;function Oce(t,e){const n=xce(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Mw="asc",_w="desc",OL="colHeader";function Ice(t){if(De(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Mw,_w].includes(n)}function Ace(t){if(t.some(n=>Ice(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function kI(t){if(t!==_w)return t===Mw?_w:Mw}function IL(t){return t.querySelector(`.${OL}`)}function AL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function e_(t,e,n){return t===-1&&e>=0&&La(n)===!1}function HL(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Fo;if(jt(r))return jt(i)?Fo:o&&t==="asc"?Wt:Bt;if(jt(i))return o&&t==="asc"?Bt:Wt;const s=Z(r,e),a=Z(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Wt:Bt:a.isBefore(s)?t==="asc"?Bt:Wt:Fo:Wt:Bt}}function Hce(t,e){et(ut`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const Nce="ascending",Dce="descending",NL="indicatorDisabled",DL="columnSorting",kL="sortAction",$L=new Map([[Mw,Nce],[_w,Dce]]);function kce(t,e,n,r){const i=[DL];if(r&&i.push(kL),n===!1)return i.push(NL),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push($L.get(o)),i}function $ce(){return Array.from($L.values()).concat(kL,NL,DL)}function Lce(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:xL(u.type))(l,u,d)(c,h)}(0)}}function Fce(t,e){Vce(t,e),e.add(t)}function Vce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ym(t,e,n){return(e=Wce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wce(t){var e=Bce(t,"string");return typeof e=="symbol"?e:e+""}function Bce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Pw="columnSorting",jce=50,xw="append",Uce="replace",$I=Pw;PL(Pw,Lce);ie.getSingleton().register("beforeColumnSort");ie.getSingleton().register("afterColumnSort");const qh=new WeakMap;var $l=new WeakSet;class LL extends qe{constructor(){super(...arguments),Fce(this,$l),ym(this,"columnStatesManager",null),ym(this,"columnMetaCache",null),ym(this,"pluginKey",Pw),ym(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Pw}static get PLUGIN_PRIORITY(){return jce}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(qh.has(this.hot)&&qh.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),Hce(qh.get(this.hot),this.pluginKey);return}this.enabled||(qh.set(this.hot,this.pluginKey),this.columnStatesManager=new yce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ja(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>gc($l,this,zce).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gc($l,e,Gce).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>gc($l,this,MR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gc($l,e,Yce).call(e,...r)}),this.hot.view&&gc($l,this,MR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=IL(r);AL(n,r)===!1||i===null||this.updateHeaderClasses(i)};qh.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Ua,position:"before",group:$I})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($I)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new R$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Ace(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=kI(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:kI()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(It(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===xw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Uce)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(De(e)){const n=e[this.pluginKey];if(De(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):at(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);Oce(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(De(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||De(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(pe(e,$ce()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,kce(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&we(e.target,OL)}onAfterOnCellMouseDown(e,n){if(e_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function MR(){const t=this.getAllSavedSortSettings();if(De(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function zce(t,e){const n=IL(e);if(AL(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ce(e,...v8(s?`${s}ending`:"none"))}}function Yce(t){t===!0&&this.hot.view&&gc($l,this,MR).call(this)}function Gce(t,e,n,r){e_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function hl(t,e,n){return(e=Kce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kce(t){var e=qce(t,"string");return typeof e=="symbol"?e:e+""}function qce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xce{constructor(e,n){hl(this,"plugin",void 0),hl(this,"hot",void 0),hl(this,"endpoints",[]),hl(this,"settings",void 0),hl(this,"settingsType","array"),hl(this,"currentEndpoint",null),hl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),T(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();T(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;T(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?T(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):T(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){T(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];T(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),T(i,o=>{let s=[];T(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,T(e.ranges,r=>{T(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],T(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],T(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],T(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&T(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),T(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){et("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function tb(t){return t==null||isNaN(t)}function Jce(t,e){Zce(t,e),e.add(t)}function Zce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qce(t,e,n){return(e=ehe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ehe(t){var e=the(t,"string");return typeof e=="symbol"?e:e+""}function the(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nb="columnSummary",nhe=220;var Xh=new WeakSet;class rhe extends qe{constructor(){super(...arguments),Jce(this,Xh),Qce(this,"endpoints",null)}static get PLUGIN_KEY(){return nb}static get PLUGIN_PRIORITY(){return nhe}isEnabled(){return!!this.hot.getSettings()[nb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[nb],this.endpoints=new Xce(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cm(Xh,e,ihe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cm(Xh,e,she).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cm(Xh,e,ohe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cm(Xh,e,ahe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return ke(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=tb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return ke(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=tb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=tb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return ke(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ut`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function ihe(){this.endpoints.initEndpoints()}function ohe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function she(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function ahe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function lhe(t,e){FL(t,e),e.add(t)}function rb(t,e,n){FL(t,e),e.set(t,n)}function FL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mc(t,e){return t.get(t_(t,e))}function _R(t,e,n){return t.set(t_(t,e),n),n}function t_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ow=new WeakMap,bm=new WeakMap,Sm=new WeakMap,LI=new WeakSet;class VL{constructor(){lhe(this,LI),rb(this,Ow,!0),rb(this,bm,null),rb(this,Sm,new ResizeObserver(e=>t_(LI,this,uhe).call(this,e)))}setObservedElement(e){_R(bm,this,e)}unobserve(){mc(Sm,this).unobserve(mc(bm,this))}observe(){_R(Ow,this,!0),mc(Sm,this).observe(mc(bm,this))}destroy(){mc(Sm,this).disconnect()}}function uhe(t){if(mc(Ow,this)||!Array.isArray(t)||!t.length){_R(Ow,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}ft(VL,kn);function dl(t,e,n){che(t,e),e.set(t,n)}function che(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return t.get(WL(t,e))}function ss(t,e,n){return t.set(WL(t,e),n),n}function WL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fl=new WeakMap,ib=new WeakMap,as=new WeakMap,Ks=new WeakMap,qs=new WeakMap,Rm=new WeakMap,Uu=new WeakMap;class zl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;dl(this,fl,void 0),dl(this,ib,!1),dl(this,as,null),dl(this,Ks,void 0),dl(this,qs,void 0),dl(this,Rm,!0),dl(this,Uu,new VL),ss(fl,this,e),ss(ib,this,n),ss(Ks,this,this.createEditor()),ss(qs,this,mt(Ks,this).style),mt(Uu,this).setObservedElement(this.getInputElement()),mt(Uu,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){mt(qs,this).left=`${e}px`,mt(qs,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Xt(this.getInputElement()),height:rn(this.getInputElement())}}observeSize(){mt(Uu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){mt(qs,this).display="block",ss(Rm,this,!1)}hide(){mt(Uu,this).unobserve(),mt(Rm,this)||(mt(qs,this).display="none"),ss(Rm,this,!0)}isVisible(){return mt(qs,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return mt(fl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=mt(fl,this).createElement("div"),n=mt(fl,this).createElement("textarea");return e.style.display="none",ss(as,this,mt(fl,this).createElement("div")),mt(as,this).setAttribute("dir",mt(ib,this)?"rtl":"ltr"),q(mt(as,this),zl.CLASS_EDITOR_CONTAINER),mt(fl,this).body.appendChild(mt(as,this)),q(e,zl.CLASS_EDITOR),q(n,zl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),mt(as,this).appendChild(e),e}getInputElement(){return mt(Ks,this).querySelector(`.${zl.CLASS_INPUT}`)}getEditorElement(){return mt(Ks,this)}destroy(){const e=mt(as,this)?mt(as,this).parentNode:null;mt(Ks,this).parentNode.removeChild(mt(Ks,this)),ss(Ks,this,null),ss(qs,this,null),mt(Uu,this).destroy(),e&&e.removeChild(mt(as,this))}}ft(zl,kn);function ob(t,e,n){return(e=hhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hhe(t){var e=dhe(t,"string");return typeof e=="symbol"?e:e+""}function dhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fhe=250,ghe=250;class BL{constructor(e){ob(this,"wasLastActionShow",!0),ob(this,"showDebounced",null),ob(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},ghe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fhe;this.showDebounced=ng(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ft(BL,kn);function mhe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function phe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function gl(t,e){const n={};return T(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function la(t,e,n,r,i){T(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&whe(s,a,e,n,r,i)})})}function whe(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=mhe(s.className,r):a=phe(s.className,r)),o(t,e,"className",a)}function jL(t){return`<span class="selected">✓</span>${t}`}function Op(t,e){let n=!1;return Array.isArray(t)&&T(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function qv(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Le="---------";function vhe(){return{name:Le}}const li="alignment";function yhe(){return{key:li,name(){return this.getTranslatedPhrase(OT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${li}:left`,name(){return this.getTranslatedPhrase(IT)},callback(){const t=this.getSelectedRange(),e=gl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),la(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${li}:center`,name(){return this.getTranslatedPhrase(AT)},callback(){const t=this.getSelectedRange(),e=gl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),la(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${li}:right`,name(){return this.getTranslatedPhrase(HT)},callback(){const t=this.getSelectedRange(),e=gl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),la(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${li}:justify`,name(){return this.getTranslatedPhrase(NT)},callback(){const t=this.getSelectedRange(),e=gl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),la(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Le},{key:`${li}:top`,name(){return this.getTranslatedPhrase(DT)},callback(){const t=this.getSelectedRange(),e=gl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),la(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${li}:middle`,name(){return this.getTranslatedPhrase(kT)},callback(){const t=this.getSelectedRange(),e=gl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),la(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${li}:bottom`,name(){return this.getTranslatedPhrase($T)},callback(){const t=this.getSelectedRange(),e=gl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),la(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Xv="clear_column";function Che(){return{key:Xv,name(){return this.getTranslatedPhrase(pT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const gg="col_left";function bhe(){return{key:gg,name(){return this.getTranslatedPhrase(cT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const mg="col_right";function She(){return{key:mg,name(){return this.getTranslatedPhrase(hT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const pg="make_read_only";function Rhe(){return{key:pg,checkable:!0,ariaChecked(){return Op(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(yw)},name(){let t=this.getTranslatedPhrase(yw);return Op(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=jL(t)),t},callback(){const t=this.getSelectedRange(),e=Op(t,(n,r)=>this.getCellMeta(n,r).readOnly);T(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Jv="redo";function Ehe(){return{key:Jv,name(){return this.getTranslatedPhrase(mT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const wg="remove_col";function The(){return{key:wg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(fT,e)},callback(){this.alter("remove_col",lie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Zv="remove_row";function Mhe(){return{key:Zv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(dT,e)},callback(){this.alter("remove_row",uie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Qv="row_above";function _he(){return{key:Qv,name(){return this.getTranslatedPhrase(lT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const ey="row_below";function Phe(){return{key:ey,name(){return this.getTranslatedPhrase(uT)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Mf="no_items";function xhe(){return{key:Mf,name(){return this.getTranslatedPhrase(aT)},disabled:!0,isCommand:!1}}const ty="undo";function Ohe(){return{key:ty,name(){return this.getTranslatedPhrase(gT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Ihe=[Qv,ey,gg,mg,Xv,Zv,wg,ty,Jv,pg,li,Le,Mf],Ahe={[Le]:vhe,[Mf]:xhe,[Qv]:_he,[ey]:Phe,[gg]:bhe,[mg]:She,[Xv]:Che,[Zv]:Mhe,[wg]:The,[ty]:Ohe,[Jv]:Ehe,[pg]:Rhe,[li]:yhe};function UL(){const t={};return ke(Ahe,(e,n)=>{t[n]=e()}),t}function Hhe(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(_T):this.getTranslatedPhrase(MT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Nhe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(PT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Dhe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(xT);return Op(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Ip))?jL(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Ip);t.updateCommentMeta(n,r,{[Ip]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function khe(t,e){zL(t,e),e.add(t)}function zu(t,e,n){zL(t,e),e.set(t,n)}function zL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $he(t,e,n){return(e=Lhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lhe(t){var e=Fhe(t,"string");return typeof e=="symbol"?e:e+""}function Fhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ma(t,e,n){return t.set(Cr(t,e),n),n}function He(t,e){return t.get(Cr(t,e))}function Cr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Iw="comments",Vhe=60,ws="comment",xd="value",YL="style",Ip="readOnly",Jh=Iw,PR=`plugin:${Iw}`;var ht=new WeakMap,Ro=new WeakMap,ny=new WeakMap,Ap=new WeakMap,xR=new WeakMap,Aw=new WeakMap,Hr=new WeakSet;class Whe extends qe{constructor(){super(...arguments),khe(this,Hr),$he(this,"range",{}),zu(this,ht,null),zu(this,Ro,null),zu(this,ny,!1),zu(this,Ap,!1),zu(this,xR,null),zu(this,Aw,"")}static get PLUGIN_KEY(){return Iw}static get PLUGIN_PRIORITY(){return Vhe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Iw]}enablePlugin(){var e=this;this.enabled||(He(ht,this)||(Ma(ht,this,new zl(this.hot.rootDocument,this.hot.isRtl())),He(ht,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cr(Hr,e,qhe).call(e,...r)})),He(Ro,this)||Ma(Ro,this,new BL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Cr(Hr,this,Yhe).call(this,n,a)),this.addHook("afterScroll",()=>Cr(Hr,this,Xhe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Cr(Hr,this,FI).call(this,n)),this.addHook("beforeCompositionStart",n=>Cr(Hr,this,FI).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cr(Hr,e,Jhe).call(e,...r)}),He(Ro,this).addLocalHook("hide",()=>this.hide()),He(Ro,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){He(Ro,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(PR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Ma(Ap,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(PR),this.hot._registerTimeout(()=>{Ma(Ap,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:Jh}),r.addShortcut({keys:[["Escape"]],callback:()=>{He(ht,this).setValue(He(Aw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ht,this).isVisible()&&He(ht,this).isFocused(),group:Jh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ht,this).isVisible()&&He(ht,this).isFocused(),group:Jh}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{He(ht,this).setValue(He(ht,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:Jh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Jh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Cr(Hr,this,Uhe).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Cr(Hr,this,Bhe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Cr(Hr,this,zhe).call(this)),this.eventManager.addEventListener(n,"focus",()=>Cr(Hr,this,Khe).call(this)),this.eventManager.addEventListener(n,"blur",()=>Cr(Hr,this,Ghe).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Cr(Hr,this,jhe).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=ka(e.target,"TD","TBODY");return!!(n&&we(n,"htCommentCell")&&ka(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=He(ht,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[xd]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ws),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,xd)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,xd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return He(Ro,this).cancelHiding(),He(ht,this).setValue((e=i[ws]?i[ws][xd]:null)!==null&&e!==void 0?e:""),He(ht,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){He(ht,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!He(ht,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;He(ht,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),w=this.getCommentMeta(i,o,YL);w?He(ht,this).setSize(w.width,w.height):He(ht,this).resetSize();const y=c?0:f.getColumnWidth(a),E=l&&!u?rn(g):0,{left:C,top:A,width:_,height:$}=g.getBoundingClientRect(),{width:I,height:M}=He(ht,this).getSize(),{innerWidth:G,innerHeight:V}=this.hot.rootWindow,W=this.hot.rootDocument.documentElement,Q=Rn(this.hot.rootDocument),J=wE(this.hot.rootWindow)?Q:0,ee=vE(this.hot.rootWindow)?Q:0;let se=C+h.scrollX+y,be=A+h.scrollY+E;this.hot.isRtl()&&(se-=I+y),this.hot.isLtr()&&C+_+I>G-J?se=C+h.scrollX-I-1:this.hot.isRtl()&&se<-(W.scrollWidth-W.clientWidth)&&(se=C+h.scrollX+y+1),A+M>V-ee&&(be-=M-$+1),He(ht,this).setPosition(se,be),He(ht,this).setReadOnlyState(this.getCommentMeta(i,o,Ip)),He(ht,this).observeSize()}focusEditor(){He(ht,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[ws];let o;i?(o=Xn(i),ig(o,r)):o=r,this.hot.setCellMeta(e,n,ws,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[ws])return i[ws][r]}addToContextMenu(e){e.items.push({name:Le},Hhe(this),Nhe(this),Dhe(this))}getEditorInputElement(){return He(ht,this).getInputElement()}destroy(){var e,n;(e=He(ht,this))===null||e===void 0||e.destroy(),(n=He(Ro,this))===null||n===void 0||n.destroy(),super.destroy()}}function Bhe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!He(ny,this)&&!this.targetIsCommentTextArea(t)){const e=ka(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function jhe(t){t.stopPropagation()}function Uhe(t){const{rootDocument:e}=this.hot;if(!(He(ny,this)||He(ht,this).isFocused()||we(t.target,"wtBorder")||He(xR,this)===t.target||!He(ht,this)))if(Ma(xR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));He(Ro,this).show(n)}else Oa(t.target,e)&&!this.targetIsCommentTextArea(t)&&He(Ro,this).hide()}function zhe(){Ma(ny,this,!1)}function Yhe(t,e){e[ws]&&e[ws][xd]&&q(t,e.commentedCellClassName)}function Ghe(){Ma(Aw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Khe(){Ma(Aw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(PR)}function qhe(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[YL]:{width:t,height:e}})}function FI(t){He(ht,this).isFocused()&&Ei(t)}function Xhe(){He(Ap,this)||this.hide()}function Jhe(){const t=He(ht,this).getEditorElement();pe(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function sb(t,e,n){return(e=Zhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zhe(t){var e=Qhe(t,"string");return typeof e=="symbol"?e:e+""}function Qhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GL{constructor(e){sb(this,"hot",void 0),sb(this,"commands",{}),sb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=ede(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||nn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),T(u,c=>c.apply(this.hot,r))}}function ede(t,e){let n;return T(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function ab(t,e,n){return(e=tde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tde(t){var e=nde(t,"string");return typeof e=="symbol"?e:e+""}function nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;ab(this,"hot",void 0),ab(this,"predefinedItems",UL()),ab(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,ke(e,(r,i)=>{let o="";r.name===Le?(n[Le]=r,o=Le):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return rde(e,this.defaultOrderPattern,this.predefinedItems)}}function rde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),De(i)?ke(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),De(o)?on(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):T(i,(o,s)=>{let a=n[o];!a&&Ihe.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),De(o)&&on(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Xs(t,e,n){return(e=ide(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ide(t){var e=ode(t,"string");return typeof e=="symbol"?e:e+""}function ode(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sde{constructor(e,n){Xs(this,"top",void 0),Xs(this,"topRelative",void 0),Xs(this,"left",void 0),Xs(this,"leftRelative",void 0),Xs(this,"scrollTop",void 0),Xs(this,"scrollLeft",void 0),Xs(this,"cellHeight",void 0),Xs(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Zh(t,e,n){ade(t,e),e.set(t,n)}function ade(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(qL(t,e))}function Em(t,e,n){return t.set(qL(t,e),n),n}function qL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var er=new WeakMap,pr=new WeakMap,wr=new WeakMap,lb=new WeakMap,Yu=new WeakMap;class lde{constructor(e){Zh(this,er,void 0),Zh(this,pr,void 0),Zh(this,wr,void 0),Zh(this,lb,!1),Zh(this,Yu,{above:0,below:0,left:0,right:0}),Em(lb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Oe(Yu,this)[e]=n,this}setElement(e){return Em(er,this,e),this}setParentElement(e){return Em(pr,this,e),this}updatePosition(e){Em(wr,this,new sde(e,Oe(er,this).ownerDocument.defaultView)),Oe(lb,this)?(Oe(wr,this).fitsBelow(Oe(er,this))?this.setPositionBelowCursor():Oe(wr,this).fitsAbove(Oe(er,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Oe(er,this).dir==="rtl"?Oe(wr,this).fitsOnLeft(Oe(er,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Oe(wr,this).fitsOnRight(Oe(er,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Oe(Yu,this).above+Oe(wr,this).top-Oe(er,this).offsetHeight;if(Oe(pr,this)){const r=Oe(pr,this).ownerDocument.defaultView.getComputedStyle(Oe(pr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(wr,this).top+Oe(wr,this).cellHeight-Oe(er,this).scrollHeight+i+o}Oe(er,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Oe(Yu,this).below+Oe(wr,this).top+1;if(Oe(pr,this)){const r=Oe(pr,this).ownerDocument.defaultView.getComputedStyle(Oe(pr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(wr,this).top-i-o-1}Oe(er,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Oe(wr,this).left;if(Oe(pr,this)){const n=Oe(pr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(pr,this).querySelector(".htCore")).borderRightWidth,10);e+=Oe(wr,this).cellWidth+r}else e+=Oe(Yu,this).right;Oe(er,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Oe(Yu,this).left+Oe(wr,this).left-Oe(er,this).offsetWidth;if(Oe(pr,this)){const n=Oe(pr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(pr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Oe(er,this).style.left=`${e}px`}}function XL(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ye(e,-1,g()-1);function a(y,E){const C=g()-1;return y<0&&(y=C),y>C&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(E===1?++y:--y,E)),y)}function l(y){y>-1&&y<g()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function w(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:w}}function ude(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function OR(t){return nn(t,"submenu")}function IR(t){return new RegExp(Le,"i").test(t.name)}function Hp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function VI(t){return nn(t,"disableSelection")}function cde(t){return we(t,"htSeparator")}function hde(t){return we(t,"htSubmenu")}function dde(t){return we(t,"htDisabled")}function fde(t){return we(t,"htSelectionDisabled")}function gde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function JL(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function mde(t,e){let n=t.slice(0);return n.reverse(),n=JL(n,e),n.reverse(),n}function pde(t){const e=[];return T(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function wde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le,n=t.slice(0);return n=JL(n,e),n=mde(n,e),n=pde(n),n}function vde(t){return t.checkable===!0}function yde(t){return XL({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||cde(r)||dde(r)||fde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Cde(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const ZL="menu",WI=ZL;function bde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Cde(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:ZL})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${WI}:${u}`:WI}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Sde(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Bo(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Hp(a,t)&&!VI(a)&&!IR(a);Ce(n,[...vde(a)?[u8(),pf(c),sk(h)]:[l8(),pf(u)],...d?[vu(-1)]:[],...Hp(a,t)?[p8()]:[],...OR(a)?[mi(!1)]:[]])}n.className="",n.appendChild(l),IR(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):bu(l,u),Hp(a,t)?q(n,"htDisabled"):VI(a)?q(n,"htSelectionDisabled"):OR(a)&&q(n,"htSubmenu")}}function ub(t,e,n){Rde(t,e),e.set(t,n)}function Rde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uo(t,e,n){return(e=Ede(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ede(t){var e=Tde(t,"string");return typeof e=="symbol"?e:e+""}function Tde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cb(t,e,n){return t.set(QL(t,e),n),n}function ml(t,e){return t.get(QL(t,e))}function QL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const BI=215;var Qh=new WeakMap,Tm=new WeakMap,Mm=new WeakMap;class dh{get tableBorderWidth(){return ml(Mm,this)===void 0&&this.hotMenu&&cb(Mm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ml(Mm,this)}constructor(e,n){var r=this;uo(this,"hot",void 0),uo(this,"options",void 0),uo(this,"eventManager",new vi(this)),uo(this,"container",void 0),uo(this,"positioner",void 0),uo(this,"hotMenu",null),uo(this,"hotSubMenus",{}),uo(this,"parentMenu",void 0),uo(this,"menuItems",null),uo(this,"origOutsideClickDeselects",null),ub(this,Qh,void 0),ub(this,Tm,void 0),ub(this,Mm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:BI,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new lde(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=tu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ml(Qh,this)}getKeyboardShortcutsCtrl(){return ml(Tm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=ng(a=>this.openSubMenu(a),300),n=this.options.minWidth||BI;let r=!1,i=Da(this.menuItems,a=>(a.key===Mf&&(r=!0),gde(a,this.hot)));if(i.length<1&&!r)i.push(UL()[Mf]);else if(i.length===0)return;i=wde(i,Le);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Sde(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{ml(Qh,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),iR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!iR()||!La(a))&&o&&this.hasSelectedItem()&&(ko()||ME()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),cb(Qh,this,yde(this.hotMenu)),cb(Tm,this,bde(this)),ml(Tm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ml(Qh,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ce(r,[mi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!hde(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new dh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ce(n,[mi(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ce(i,[mi(!1)])}}closeAllSubMenus(){T(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?ude(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||IR(e)||Hp(e,this.hot)||OR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=vn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?rn(this.hotMenu.getCell(c,0)):0;return l+(u.name===Le?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(at(r)&&(r=r.call(this.hot),r===null||It(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ce(this.hotMenu.rootElement,[a8(),vu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Oa(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Oa(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&we(e.target,"htCore")&&Oa(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ft(dh,kn);function Mde(t,e){_de(t,e),e.add(t)}function _de(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hb(t,e,n){return(e=Pde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pde(t){var e=xde(t,"string");return typeof e=="symbol"?e:e+""}function xde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _m(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Od="contextMenu",Ode=70,jI=Od;ie.getSingleton().register("afterContextMenuDefaultOptions");ie.getSingleton().register("beforeContextMenuShow");ie.getSingleton().register("afterContextMenuShow");ie.getSingleton().register("afterContextMenuHide");ie.getSingleton().register("afterContextMenuExecute");var ed=new WeakSet;class ry extends qe{constructor(){super(...arguments),Mde(this,ed),hb(this,"commandExecutor",new GL(this.hot)),hb(this,"itemsFactory",null),hb(this,"menu",null)}static get PLUGIN_KEY(){return Od}static get PLUGIN_PRIORITY(){return Ode}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Qv,ey,Le,gg,mg,Le,Zv,wg,Le,ty,Jv,Le,pg,Le,li]}isEnabled(){return!!this.hot.getSettings()[Od]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Od];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new dh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>_m(ed,this,Ade).call(this)),this.menu.addLocalHook("afterOpen",()=>_m(ed,this,Hde).call(this)),this.menu.addLocalHook("afterClose",()=>_m(ed,this,Nde).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>_m(ed,this,Ide).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=qv(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:jI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jI)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;ke(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new KL(this.hot,ry.DEFAULT_ITEMS);const e=this.hot.getSettings()[Od],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),T(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Ide(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),we(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(we(o,"current")&&we(o,"wtBorder"))))return;const s=qv(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Ade(){this.hot.runHooks("beforeContextMenuShow",this)}function Hde(){this.hot.runHooks("afterContextMenuShow",this)}function Nde(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ry.SEPARATOR={name:Le};function Dde(t){return{key:"copy",name(){return this.getTranslatedPhrase(wT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function kde(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function $de(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(yT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Lde(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(vT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Fde(t){return{key:"cut",name(){return this.getTranslatedPhrase(bT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Vde{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Wde{constructor(){this.clipboardData=new Vde}preventDefault(){}composedPath(){return[]}}function Bde(t,e){eF(t,e),e.add(t)}function Gu(t,e,n){eF(t,e),e.set(t,n)}function eF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(t,e){return t.get(Sc(t,e))}function Ku(t,e,n){return t.set(Sc(t,e),n),n}function Sc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Js=new WeakMap,db=new WeakMap,td=new WeakMap,AR=new WeakMap,HR=new WeakMap,nd=new WeakMap,rd=new WeakSet;class jde{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Bde(this,rd),Gu(this,Js,void 0),Gu(this,db,void 0),Gu(this,td,void 0),Gu(this,AR,void 0),Gu(this,HR,void 0),Gu(this,nd,void 0),Ku(db,this,n),Ku(td,this,r),Ku(AR,this,i),Ku(HR,this,o),Ku(nd,this,s)}setSelectedRange(e){Ku(Js,this,e)}getCellsRange(){if(rr(db,this).call(this)===0||rr(td,this).call(this)===0)return null;const{row:e,col:n}=rr(Js,this).getTopStartCorner(),{row:r,col:i}=rr(Js,this).getBottomEndCorner(),o=Sc(rd,this,Ude).call(this,e,r),s=Sc(rd,this,fb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(rr(td,this).call(this)===0||rr(nd,this).call(this)===0)return null;const{col:e}=rr(Js,this).getTopStartCorner(),{col:n}=rr(Js,this).getBottomEndCorner(),r=Sc(rd,this,fb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(rr(td,this).call(this)===0||rr(nd,this).call(this)===0)return null;const{col:e}=rr(Js,this).getTopStartCorner(),{col:n}=rr(Js,this).getBottomEndCorner(),r=Sc(rd,this,fb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-rr(nd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function fb(t,e){return Math.min(e,Math.max(t+rr(HR,this).call(this)-1,t))}function Ude(t,e){return Math.min(e,Math.max(t+rr(AR,this).call(this)-1,t))}function tF(t){const e=[],n=[];return T(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function zde(t,e){nF(t,e),e.add(t)}function Zs(t,e,n){nF(t,e),e.set(t,n)}function nF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function id(t,e,n){return(e=Yde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yde(t){var e=Gde(t,"string");return typeof e=="symbol"?e:e+""}function Gde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tr(t,e){return t.get(_r(t,e))}function Di(t,e,n){return t.set(_r(t,e),n),n}function _r(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterCopyLimit");ie.getSingleton().register("modifyCopyableRange");ie.getSingleton().register("beforeCut");ie.getSingleton().register("afterCut");ie.getSingleton().register("beforePaste");ie.getSingleton().register("afterPaste");ie.getSingleton().register("beforeCopy");ie.getSingleton().register("afterCopy");const gb="copyPaste",Kde=80,qde=["fragmentSelection"],UI=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var NR=new WeakMap,DR=new WeakMap,kR=new WeakMap,qu=new WeakMap,Pm=new WeakMap,xm=new WeakMap,Xu=new WeakMap,Hw=new WeakMap,Wr=new WeakSet;class Xde extends qe{constructor(){super(...arguments),zde(this,Wr),id(this,"columnsLimit",1/0),id(this,"rowsLimit",1/0),id(this,"pasteMode","overwrite"),id(this,"uiContainer",this.hot.rootDocument.body),Zs(this,NR,!1),Zs(this,DR,!1),Zs(this,kR,!1),Zs(this,qu,"cells-only"),Zs(this,Pm,!1),Zs(this,xm,!1),Zs(this,Xu,new jde({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Zs(this,Hw,!1),id(this,"copyableRanges",[])}static get PLUGIN_KEY(){return gb}static get SETTING_KEYS(){return[gb,...qde]}static get PLUGIN_PRIORITY(){return Kde}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[gb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Di(NR,this,this.getSetting("copyColumnHeaders")),Di(DR,this,this.getSetting("copyColumnGroupHeaders")),Di(kR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>_r(Wr,this,Qde).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _r(Wr,r,efe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>_r(Wr,this,tfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),bf()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _r(Wr,r,nfe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _r(Wr,r,rfe).call(r,...o)}),this.addHook("afterSelection",()=>_r(Wr,this,ife).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Di(qu,this,e),Di(Pm,this,!0),_r(Wr,this,zI).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Di(xm,this,!0),_r(Wr,this,zI).call(this,"cut")}getRangedCopyableData(e){return Wd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=tF(e);return T(r,o=>{const s=[];T(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Wde;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Tr(Xu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Tr(qu,this)==="column-headers-only"?n.set("headers",Tr(Xu,this).getMostBottomColumnHeadersRange()):(Tr(qu,this)==="with-column-headers"?n.set("headers",Tr(Xu,this).getMostBottomColumnHeadersRange()):Tr(qu,this)==="with-column-group-headers"&&n.set("headers",Tr(Xu,this).getAllColumnHeadersRange()),n.set("cells",Tr(Xu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:w}=this.hot.getCellMeta(c,a);if(c=w+1,g===!0)continue;d=w,h=a;const y=[],E=o.length%r;for(;y.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:A}=this.hot.getCellMeta(s,h);if(h=A+1,C===!0)continue;f=A;const _=y.length%i;y.push(e[E][_])}o.push(y)}return Di(Hw,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Tr(Pm,this)||this.isEditorOpened()||Lo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!$d(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Di(Pm,this,!1);const o=this.getRangedData(this.copyableRanges),s=_r(Wr,this,Jde).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Wd(o);if(e&&e.clipboardData){const u=cR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[UI,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Di(qu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Tr(xm,this)||this.isEditorOpened()||Lo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!$d(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Di(xm,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Wd(o);if(e&&e.clipboardData){const l=cR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[UI,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Lo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!$d(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Ev(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=Gk(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=gie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function zI(t){if(bf()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&yk(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Jde(t){const{rows:e}=tF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Zde(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&CE(r)}}}function rF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&bE(r)}}}function Qde(t){t.items.push({name:"---------"},Dde(this)),Tr(NR,this)&&t.items.push(Lde(this)),Tr(DR,this)&&t.items.push($de(this)),Tr(kR,this)&&t.items.push(kde(this)),t.items.push(Fde(this))}function efe(t,e,n,r,i){Tr(Hw,this)&&(i.value=!0),Di(Hw,this,!1)}function tfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function nfe(){_r(Wr,this,rF).call(this)}function rfe(){_r(Wr,this,Zde).call(this)}function ife(){_r(Wr,this,rF).call(this)}function iF(t,e){return`border_row${t}col${e}`}function Id(){return{width:1,color:"#000"}}function Ms(){return{hide:!0}}function ofe(){return{width:1,color:"#000",cornerVisible:!1}}function mb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function od(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function pb(t,e){return{id:iF(t,e),border:ofe(),row:t,col:e,top:Ms(),bottom:Ms(),start:Ms(),end:Ms()}}function sfe(t,e){return nn(e,"border")&&e.border&&(t.border=e.border),nn(e,"top")&&le(e.top)&&(e.top?(De(e.top)||(e.top=Id()),t.top=e.top):(e.top=Ms(),t.top=e.top)),nn(e,"bottom")&&le(e.bottom)&&(e.bottom?(De(e.bottom)||(e.bottom=Id()),t.bottom=e.bottom):(e.bottom=Ms(),t.bottom=e.bottom)),nn(e,"start")&&le(e.start)&&(e.start?(De(e.start)||(e.start=Id()),t.start=e.start):(e.start=Ms(),t.start=e.start)),nn(e,"end")&&le(e.end)&&(e.end?(De(e.end)||(e.end=Id()),t.end=e.end):(e.end=Ms(),t.end=e.end)),t}function Ds(t,e){let n=!1;return T(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!nn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function iy(t){return`<span class="selected">✓</span>${t}`}function afe(t){return t.some(e=>le(e.left)||le(e.right))}function lfe(t){return t.some(e=>le(e.start)||le(e.end))}const ufe=new Map([["left","start"],["right","end"]]);function cfe(t){var e;return(e=ufe.get(t))!==null&&e!==void 0?e:t}function hfe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(WT);return Ds(this,"bottom")&&(e=iy(e)),e},callback(e,n){const r=Ds(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function dfe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(BT);return Ds(this,e)&&(n=iy(n)),n},callback(n,r){const i=Ds(this,e);t.prepareBorder(r,e,i)}}}function ffe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(jT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Ds(this)}}}function gfe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(VT);return Ds(this,e)&&(n=iy(n)),n},callback(n,r){const i=Ds(this,e);t.prepareBorder(r,e,i)}}}function mfe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(FT);return Ds(this,"top")&&(e=iy(e)),e},callback(e,n){const r=Ds(this,"top");t.prepareBorder(n,"top",r)}}}function pfe(t,e){wfe(t,e),e.add(t)}function wfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vfe(t,e,n){return(e=yfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yfe(t){var e=Cfe(t,"string");return typeof e=="symbol"?e:e+""}function Cfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Np="customBorders",bfe=90;var wb=new WeakSet;class Sfe extends qe{constructor(){super(...arguments),pfe(this,wb),vfe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Np}static get PLUGIN_PRIORITY(){return bfe}isEnabled(){return!!this.hot.getSettings()[Np]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>YI(wb,this,Rfe).call(this,e)),this.addHook("init",()=>YI(wb,this,Efe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=mb(n));const o=Uc(e),s=Ef(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});T(e,a=>{s(a).forAll((l,u)=>{T(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,cfe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Uc(e),r=Ef(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return T(e,o=>{r(o).forAll((s,a)=>{T(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(od(l))})})}),i}clearBorders(e){e?this.setBorders(e):(T(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=pb(e,n);r&&(a=sfe(a,r),T(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",od(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=pb(o,s);let l=0;o===e.from.row&&nn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&nn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&nn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&nn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",od(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=iF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=pb(e,n):o=mb(o),i?(o[r]=Ms(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",od(o)))):(o[r]=Id(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",od(o)))}prepareBorder(e,n,r){T(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){T(e,n=>{const r=mb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return vn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){T(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){T(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):T(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return T(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return T(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):T(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);T(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Np];if(Array.isArray(e)){const n=Xn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=afe(e),r=lfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Rfe(t){this.hot.getSettings()[Np]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(LT)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[mfe(this),gfe(this),hfe(this),dfe(this),ffe(this)]}})}function Efe(){this.changeBorderSettings()}function Tfe(t,e){Mfe(t,e),e.add(t)}function Mfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vb(t,e,n){return(e=_fe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _fe(t){var e=Pfe(t,"string");return typeof e=="symbol"?e:e+""}function Pfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const KI="dragToScroll",xfe=100;var yb=new WeakSet;class Ofe extends qe{constructor(){super(...arguments),Tfe(this,yb),vb(this,"boundaries",null),vb(this,"callback",null),vb(this,"listening",!1)}static get PLUGIN_KEY(){return KI}static get PLUGIN_PRIORITY(){return xfe}isEnabled(){return!!this.hot.getSettings()[KI]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>GI(yb,this,qI).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>GI(yb,this,qI).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=tu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function qI(t){if(La(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Ife(t,e){oF(t,e),e.add(t)}function Afe(t,e,n){oF(t,e),e.set(t,n)}function oF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cb(t,e,n){return(e=Hfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hfe(t){var e=Nfe(t,"string");return typeof e=="symbol"?e:e+""}function Nfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dfe(t,e){return t.get(ui(t,e))}function sF(t,e,n){return t.set(ui(t,e),n),n}function ui(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterDropdownMenuDefaultOptions");ie.getSingleton().register("beforeDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuHide");ie.getSingleton().register("afterDropdownMenuExecute");const Dp="dropdownMenu",kfe=230,_f="changeType",bb=Dp;var oy=new WeakMap,Li=new WeakSet;class sy extends qe{static get PLUGIN_KEY(){return Dp}static get PLUGIN_PRIORITY(){return kfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[gg,mg,Le,wg,Le,Xv,Le,pg,Le,li]}constructor(e){super(e),Ife(this,Li),Cb(this,"commandExecutor",new GL(this.hot)),Cb(this,"itemsFactory",null),Cb(this,"menu",null),Afe(this,oy,!1),this.hot.addHook("afterGetColHeader",(n,r)=>ui(Li,this,Lfe).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Dp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new KL(this.hot,sy.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ui(Li,e,Ufe).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ui(Li,e,jfe).call(e,...o)});const n=this.hot.getSettings()[Dp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new dh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ui(Li,this,Ffe).call(this)),this.menu.addLocalHook("afterOpen",()=>ui(Li,this,Vfe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>ui(Li,this,Wfe).call(this,o)),this.menu.addLocalHook("afterClose",()=>ui(Li,this,Bfe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),T(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=qv(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${_f}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:bb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:bb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ui(Li,this,$fe).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function aF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function $fe(t){if(we(t.target,_f)){const e=qv(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),sF(oy,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Lfe(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${_f}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=_f,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ce(s,[yu(),pf(" ")]),Ce(e,[rk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Ffe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Vfe(){this.hot.runHooks("afterDropdownMenuShow",this),ui(Li,this,aF).call(this,this.menu)}function Wfe(t){ui(Li,this,aF).call(this,t)}function Bfe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function jfe(t){return Dfe(oy,this)?null:t}function Ufe(t){we(t.target,_f)&&sF(oy,this,!0)}sy.SEPARATOR={name:Le};function XI(t,e,n){return(e=zfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zfe(t){var e=Yfe(t,"string");return typeof e=="symbol"?e:e+""}function Yfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gfe{constructor(e){XI(this,"hot",void 0),XI(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function JI(t,e,n){return(e=Kfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kfe(t){var e=qfe(t,"string");return typeof e=="symbol"?e:e+""}function qfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){JI(this,"dataProvider",void 0),JI(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Xi(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=on(Xi(n_.DEFAULT_OPTIONS),n),n=on(n,e),n.filename=uE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function Xfe(t,e){Jfe(t,e),e.add(t)}function Jfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lF="\r",Zfe='"',Qfe=`
`,ege="=",tge="+",nge="-",rge="@",ige="	";var Sb=new WeakSet;class oge extends n_{constructor(){super(...arguments),Xfe(this,Sb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Ue(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),T(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Rt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=ZI(Sb,this,age).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=ZI(Sb,this,sge).call(this,i)),(n||i.indexOf(lF)>=0||i.indexOf(Zfe)>=0||i.indexOf(Qfe)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function sge(t){return t.startsWith(ege)||t.startsWith(tge)||t.startsWith(nge)||t.startsWith(rge)||t.startsWith(ige)||t.startsWith(lF)?`'${t}`:t}function age(t,e){return e.test(t)?`'${t}`:t}const lge="csv",$R={[lge]:oge};function uge(t,e,n){return typeof $R[t]=="function"?new $R[t](e,n):null}const cge="exportFile",hge=240;class dge extends qe{static get PLUGIN_KEY(){return cge}static get PLUGIN_PRIORITY(){return hge}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!$R[e])throw new Error(`Export format type "${e}" is not supported.`);return uge(e,new Gfe(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ju(t,e,n){return(e=fge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fge(t){var e=gge(t,"string");return typeof e=="symbol"?e:e+""}function gge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vg{constructor(e,n){let{id:r,stateless:i=!0}=n;Ju(this,"hot",void 0),Ju(this,"id",void 0),Ju(this,"elements",[]),Ju(this,"hidden",!1),Ju(this,"stateId",""),Ju(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Fv)}getElements(){return this.elements}reset(){T(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ft(vg,kn);const Pf={};function Fa(t,e){if(!Pf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Pf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Yl(t){if(!Pf[t])throw Error(`Filter condition "${t}" does not exist.`);return Pf[t].descriptor}function ln(t,e,n){n.key=t,Pf[t]={condition:e,descriptor:n}}const Pn="none";function mge(){return!0}ln(Pn,mge,{name:Vv,inputsCount:0,showOperators:!1});const Ud="empty";function pge(t){return jt(t.value)}ln(Ud,pge,{name:XT,inputsCount:0,showOperators:!0});const kp="not_empty";function wge(t,e){return!Fa(Ud,e)(t)}ln(kp,wge,{name:JT,inputsCount:0,showOperators:!0});const zd="eq";function vge(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale)===Rt(n)}ln(zd,vge,{name:ZT,inputsCount:1,showOperators:!0});const $p="neq";function yge(t,e){return!Fa(zd,e)(t)}ln($p,yge,{name:QT,inputsCount:1,showOperators:!0});const uF="gt";function Cge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}ln(uF,Cge,{name:iM,inputsCount:1,showOperators:!0});const cF="gte";function bge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}ln(cF,bge,{name:oM,inputsCount:1,showOperators:!0});const hF="lt";function Sge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}ln(hF,Sge,{name:sM,inputsCount:1,showOperators:!0});const dF="lte";function Rge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}ln(dF,Rge,{name:aM,inputsCount:1,showOperators:!0});const r_="date_after";function Ege(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}ln(r_,Ege,{name:cM,inputsCount:1,showOperators:!0});const i_="date_before";function Tge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}ln(i_,Tge,{name:hM,inputsCount:1,showOperators:!0});const Nw="between";function Mge(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Fa(i_,[o]),a=Fa(r_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}ln(Nw,Mge,{name:lM,inputsCount:2,showOperators:!0});const fF="not_between";function _ge(t,e){return!Fa(Nw,e)(t)}ln(fF,_ge,{name:uM,inputsCount:2,showOperators:!0});const gF="begins_with";function Pge(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Rt(n))}ln(gF,Pge,{name:eM,inputsCount:1,showOperators:!0});const mF="ends_with";function xge(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Rt(n))}ln(mF,xge,{name:tM,inputsCount:1,showOperators:!0});const o_="contains";function Oge(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Rt(n))>=0}ln(o_,Oge,{name:nM,inputsCount:1,showOperators:!0});const pF="not_contains";function Ige(t,e){return!Fa(o_,e)(t)}ln(pF,Ige,{name:rM,inputsCount:1,showOperators:!0});const wF="date_tomorrow";function Age(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}ln(wF,Age,{name:fM,inputsCount:0});const vF="date_today";function Hge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}ln(vF,Hge,{name:dM,inputsCount:0});const yF="date_yesterday";function Nge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}ln(yF,Nge,{name:gM,inputsCount:0});xk();function Dge(t,e){let n=t;return n===""&&(n=`(${e})`),n}function yg(t){const e=new Set(t);return function(n){return e.has(n)}}function s_(t){return t??""}function LR(t){return Array.from(new Set(t)).map(e=>s_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function QI(t,e,n,r){const i=[],o=t===e;let s;return o||(s=yg(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Dge(a,n)};r&&r(u),i.push(u)}),i}const Gl="by_value";function kge(t,e){let[n]=e;return n(t.value)}ln(Gl,kge,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[yg(e)]},showOperators:!1});const xf={};function $ge(t){if(!xf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=xf[t].func;return function(n,r){return e(n,r)}}function Lge(t){return xf[t].name}function a_(t,e,n){xf[t]={name:e,func:n}}const Ha="conjunction",Fge=wM;function Vge(t,e){return t.every(n=>n.func(e))}a_(Ha,Fge,Vge);const Dw="disjunction",Wge=Wv;function Bge(t,e){return t.some(n=>n.func(e))}a_(Dw,Wge,Bge);const l_="disjunctionWithExtraCondition",jge=Wv;function Uge(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}a_(l_,jge,Uge);const zge="numeric",CF="text",Yge="date",e1={[zge]:[Pn,Le,Ud,kp,Le,zd,$p,Le,uF,cF,hF,dF,Nw,fF],[CF]:[Pn,Le,Ud,kp,Le,zd,$p,Le,gF,mF,Le,o_,pF],[Yge]:[Pn,Le,Ud,kp,Le,zd,$p,Le,i_,r_,Nw,Le,wF,vF,yF]};function Gge(t){const e=[];let n=t;return e1[n]||(n=CF),T(e1[n],r=>{let i;r===Le?i={name:Le}:i=Xi(Yl(r)),e.push(i)}),e}function sd(t,e,n){return(e=Kge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kge(t){var e=qge(t,"string");return typeof e=="symbol"?e:e+""}function qge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Rb="built",Eb="building",t1=["click","input","keydown","keypress","keyup","focus","blur","change"];let Gi=class bF{static get DEFAULTS(){return Xi({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){sd(this,"hot",void 0),sd(this,"eventManager",new vi(this)),sd(this,"options",void 0),sd(this,"_element",void 0),sd(this,"buildState",void 0),this.hot=e,this.options=on(bF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Eb?this._element:this.buildState===Rb?(this.update(),this._element):(this.buildState=Eb,this.build(),this.buildState=Rb,this._element)}isBuilt(){return this.buildState===Rb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(hr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Eb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)T(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),ke(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),T(t1,r=>e(n,r))}else T(t1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ft(Gi,kn);function Xge(t,e){SF(t,e),e.add(t)}function Jge(t,e,n){SF(t,e),e.set(t,n)}function SF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Om(t,e){return t.get(u_(t,e))}function Zge(t,e,n){return t.set(u_(t,e),n),n}function u_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zu=new WeakMap,n1=new WeakSet;class Na extends Gi{static get DEFAULTS(){return Xi({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,on(Na.DEFAULTS,n)),Xge(this,n1),Jge(this,Zu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>u_(n1,this,Qge).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Zge(Zu,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Om(Zu,this).type=this.options.type,Om(Zu,this).placeholder=this.translateIfPossible(this.options.placeholder),Om(Zu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Om(Zu,this).focus()}}function Qge(t){this.options.value=t.target.value}function eme(t,e){RF(t,e),e.add(t)}function ad(t,e,n){RF(t,e),e.set(t,n)}function RF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qu(t,e,n){return t.set(Yd(t,e),n),n}function kt(t,e){return t.get(Yd(t,e))}function Yd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yn=new WeakMap,Im=new WeakMap,Am=new WeakMap,Tb=new WeakMap,Hm=new WeakMap,Nm=new WeakSet;class Of extends Gi{static get DEFAULTS(){return Xi({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,on(Of.DEFAULTS,n)),eme(this,Nm),ad(this,yn,null),ad(this,Im,[]),ad(this,Am,void 0),ad(this,Tb,void 0),ad(this,Hm,void 0),this.registerHooks()}getMenu(){return kt(yn,this)}registerHooks(){this.addLocalHook("click",()=>Yd(Nm,this,rme).call(this))}setItems(e){Qu(Im,this,this.translateNames(e)),kt(yn,this)&&kt(yn,this).setMenuItems(kt(Im,this))}translateNames(e){return T(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Qu(yn,this,new dh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),kt(yn,this).setMenuItems(kt(Im,this));const e=new Gi(this.hot,{className:"htUISelectCaption"}),n=new Gi(this.hot,{className:"htUISelectDropdown"});Qu(Am,this,e),Qu(Tb,this,e.element),Qu(Hm,this,n),this.hot.getSettings().ariaTags&&(Ce(n.element,[yu()]),Ce(this._element,[nk()])),T([e,n],r=>this._element.appendChild(r.element)),kt(yn,this).addLocalHook("select",r=>Yd(Nm,this,tme).call(this,r)),kt(yn,this).addLocalHook("afterClose",()=>Yd(Nm,this,nme).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=kt(yn,this).hot.getTranslatedPhrase(Vv),kt(Tb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();kt(yn,this)&&(kt(yn,this).open(),kt(yn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),kt(yn,this).getNavigator().toFirstItem(),kt(yn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){kt(yn,this)&&kt(yn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){kt(yn,this)&&(kt(yn,this).destroy(),Qu(yn,this,null)),kt(Am,this)&&kt(Am,this).destroy(),kt(Hm,this)&&kt(Hm,this).destroy(),super.destroy()}}function tme(t){t.name!==Le&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function nme(){this.runLocalHooks("afterClose")}function rme(){this.openOptions()}function ime(t,e){ome(t,e),e.add(t)}function ome(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r1(t,e,n){return(e=sme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sme(t){var e=ame(t,"string");return typeof e=="symbol"?e:e+""}function ame(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mb=new WeakSet;class FR extends vg{constructor(e,n){super(e,{id:n.id,stateless:!1}),ime(this,Mb),r1(this,"name",""),r1(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Of(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Na(this.hot,{placeholder:RM})),this.elements.push(new Na(this.hot,{placeholder:EM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>i1(Mb,this,lme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),T(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>i1(Mb,this,ume).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Xi(e.command);n.name.startsWith(Ut)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),T(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Yl(Pn),n=[];return T(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Yl(e?e.name:Pn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||T(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Of)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Na)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Yl(Pn)];if(e!==null){const{visualIndex:r}=e;n=Gge(this.hot.getDataType(0,r,this.hot.countRows(),r))}T(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function lme(t){T(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function ume(t){ah(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ei(t))}function o1(t,e,n){cme(t,e),e.set(t,n)}function cme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ld(t,e){return t.get(EF(t,e))}function s1(t,e,n){return t.set(EF(t,e),n),n}function EF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ec=new WeakMap,_b=new WeakMap;class kw extends Gi{static get DEFAULTS(){return Xi({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,on(kw.DEFAULTS,n)),o1(this,ec,void 0),o1(this,_b,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),s1(_b,this,e),s1(ec,this,this._element.firstChild),ld(ec,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ld(_b,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?ld(ec,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(ld(ec,this).checked=e)}focus(){this.isBuilt()&&ld(ec,this).focus()}}function hme(t,e){dme(t,e),e.add(t)}function dme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fme(t,e,n){return(e=gme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gme(t){var e=mme(t,"string");return typeof e=="symbol"?e:e+""}function mme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const a1=0;var l1=new WeakSet;class wme extends vg{constructor(e,n){super(e,{id:n.id,stateless:!1}),hme(this,l1),fme(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),T(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Ha,Dw];T(e,n=>{const r=new kw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Lge(n)},value:n,checked:n===e[a1],id:n});r.addLocalHook("change",i=>pme(l1,this,vme).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ut`Radio button with index ${e} doesn't exist.`);T(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof kw&&n.isChecked());return e?e.getValue():Ha}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&T(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ha,n=arguments.length>1?arguments[1]:void 0,r=e;r===l_&&(r=Dw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(a1)}}function vme(t){this.setState(t.target.value)}function yme(t,e,n){Cme(t,e),e.set(t,n)}function Cme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e){return t.get(TF(t,e))}function bme(t,e,n){return t.set(TF(t,e),n),n}function TF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ud=new WeakMap;class If extends Gi{static get DEFAULTS(){return Xi({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,on(If.DEFAULTS,n)),yme(this,ud,void 0)}build(){super.build(),bme(ud,this,this._element.firstChild)}update(){this.isBuilt()&&(Pb(ud,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Pb(ud,this).focus()}activate(){Pb(ud,this).click()}}function Sme(t,e){MF(t,e),e.add(t)}function tc(t,e,n){MF(t,e),e.set(t,n)}function MF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get(Rc(t,e))}function Ii(t,e,n){return t.set(Rc(t,e),n),n}function Rc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const u1="multipleSelect.itemBox";var Fi=new WeakMap,Gt=new WeakMap,xb=new WeakMap,ls=new WeakMap,Qs=new WeakMap,ea=new WeakMap,cd=new WeakSet;class Af extends Gi{static get DEFAULTS(){return Xi({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,on(Af.DEFAULTS,n)),Sme(this,cd),tc(this,Fi,[]),tc(this,Gt,void 0),tc(this,xb,void 0),tc(this,ls,void 0),tc(this,Qs,void 0),tc(this,ea,void 0),Ii(ls,this,new Na(this.hot,{placeholder:SM,className:"htUIMultipleSelectSearch"})),Ii(Qs,this,new If(this.hot,{textContent:vM,className:"htUISelectAll"})),Ii(ea,this,new If(this.hot,{textContent:yM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Pe(Gt,this)}registerHooks(){Pe(ls,this).addLocalHook("keydown",e=>Rc(cd,this,Eme).call(this,e)),Pe(ls,this).addLocalHook("input",e=>Rc(cd,this,Rme).call(this,e)),Pe(Qs,this).addLocalHook("click",e=>Rc(cd,this,Tme).call(this,e)),Pe(ea,this).addLocalHook("click",e=>Rc(cd,this,Mme).call(this,e))}setItems(e){var n;Ii(Fi,this,e),(n=Pe(Gt,this))===null||n===void 0||n.loadData(Pe(Fi,this))}setLocale(e){Ii(xb,this,e)}getLocale(){return Pe(xb,this)}getItems(){return[...Pe(Fi,this)]}getValue(){return Pme(Pe(Fi,this))}getSearchInputElement(){return Pe(ls,this)}getSelectAllElement(){return Pe(Qs,this)}getClearAllElement(){return Pe(ea,this)}isSelectedAllValues(){return Pe(Fi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Gi(this.hot,{className:"htUISelectionControls",children:[Pe(Qs,this),Pe(ea,this)]});this._element.appendChild(Pe(ls,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Pe(Gt,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),Ii(Gt,this,new this.hot.constructor(o,{data:Pe(Fi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Pe(Gt,this).listen()},modifyColWidth:u=>{const c=Pe(Gt,this).container.scrollWidth-Rn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Pe(Gt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Pe(Gt,this).useTheme(u)});const l=Pe(Gt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:u1}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Pe(Gt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:u1})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Pe(Gt,this).listen()}reset(){Pe(ls,this).reset(),Pe(Qs,this).reset(),Pe(ea,this).reset()}update(){this.isBuilt()&&(Pe(Gt,this).loadData(_me(Pe(Fi,this),this.options.value)),super.update())}destroy(){var e;(e=Pe(Gt,this))===null||e===void 0||e.destroy(),Pe(ls,this).destroy(),Pe(ea,this).destroy(),Pe(Qs,this).destroy(),Ii(ls,this,null),Ii(ea,this,null),Ii(Qs,this,null),Ii(Gt,this,null),Ii(Fi,this,null),super.destroy()}}function Rme(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Pe(Fi,this)]:n=Pe(Fi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Pe(Gt,this).loadData(n)}function Eme(t){this.runLocalHooks("keydown",t,this),SE(ah,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ei(t),Pe(Gt,this).listen(),Pe(Gt,this).selectCell(0,0))}function Tme(t){const e=[];t.preventDefault(),Pe(Gt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(QE(n,r)[0])}),Pe(Gt,this).setSourceDataAtCell(e)}function Mme(t){const e=[];t.preventDefault(),Pe(Gt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(QE(n,r)[0])}),Pe(Gt,this).setSourceDataAtCell(e)}function _me(t,e){const n=yg(e);return t.map(r=>(r.checked=n(r.value),r))}function Pme(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function xme(t,e){Ome(t,e),e.add(t)}function Ome(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ime(t,e,n){return(e=Ame(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ame(t){var e=Hme(t,"string");return typeof e=="symbol"?e:e+""}function Hme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hd=new WeakSet;class Nme extends vg{constructor(e,n){super(e,{id:n.id,stateless:!1}),xme(this,hd),Ime(this,"name",""),this.name=n.name,this.elements.push(new Af(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Dm(hd,this,Dme).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Dm(hd,this,kme).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Gl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Pn:Gl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Da(i,h=>h.name===Gl),u={},c=this.hot.getTranslatedPhrase(Cw);if(l){const h=s(r,a),d=Ue(h,C=>C.value),f=new Map(h.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),g=LR(d);o&&(l.args[0]=o);const w=[],y=QI(g,l.args[0],c,C=>{C.checked&&w.push(C.value),Dm(hd,this,c1).call(this,C,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[w],u.command=Yl(Gl),u.itemsSnapshot=y}else u.args=[],u.command=Yl(Pn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Af)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Cw),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=LR(r),s=QI(o,o,e,l=>{Dm(hd,this,c1).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:s_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Dme(t){ah(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ei(t))}function c1(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function kme(t,e){switch(e.type){case"numeric":return gL(t,e);default:return t}}var _F;function $me(t,e){Lme(t,e),e.add(t)}function Lme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fme(t,e,n){return(e=Vme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vme(t){var e=Wme(t,"string");return typeof e=="symbol"?e:e+""}function Wme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var h1=new WeakSet;class Hf extends vg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),$me(this,h1),Fme(this,"name",""),this.name=n.name,this.elements.push(new Na(this.hot,{type:"button",value:CM,className:"htUIButton htUIButtonOK",identifier:Hf.BUTTON_OK})),this.elements.push(new Na(this.hot,{type:"button",value:bM,className:"htUIButton htUIButtonCancel",identifier:Hf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){T(this.elements,e=>{e.addLocalHook("click",(n,r)=>Bme(h1,this,jme).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),T(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}_F=Hf;function jme(t,e){e.options.identifier===_F.BUTTON_OK?this.accept():this.cancel()}function Ob(t,e,n){return(e=Ume(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ume(t){var e=zme(t,"string");return typeof e=="symbol"?e:e+""}function zme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const d1="ConditionCollection.filteringStates";class c_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Ob(this,"hot",void 0),Ob(this,"isMapRegistrable",void 0),Ob(this,"filteringStates",new Fv),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(d1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ha;return e.length?$ge(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ha,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ut`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(It(xf[r]))throw new Error(ut`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Fa(a,s)}]},i):u.push({name:a,args:s,func:Fa(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(d1),this.filteringStates=null,this.clearLocalHooks()}}ft(c_,kn);function f1(t,e,n){return(e=Yme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yme(t){var e=Gme(t,"string");return typeof e=="symbol"?e:e+""}function Gme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];f1(this,"conditionCollection",void 0),f1(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return T(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return T(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return T(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function Kme(t,e){qme(t,e),e.add(t)}function qme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pl(t,e,n){return(e=Xme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xme(t){var e=Jme(t,"string");return typeof e=="symbol"?e:e+""}function Jme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ib(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var km=new WeakSet;class xF{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Kme(this,km),pl(this,"hot",void 0),pl(this,"conditionCollection",void 0),pl(this,"columnDataFactory",void 0),pl(this,"changes",[]),pl(this,"grouping",!1),pl(this,"latestEditedColumnPosition",-1),pl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Ib(km,this,Zme).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Ib(km,this,Qme).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Ib(km,this,epe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,T(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=bk(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new c_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const w=r.columnDataFactory(h);let y;f.isEmpty()?y=w:y=new PF(f,C=>r.columnDataFactory(C)).filter(),y=Ue(y,C=>C.meta.visualRow);const E=yg(y);return f.destroy(),Da(w,C=>E(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),ke(this,(e,n)=>{this[n]=null})}}function Zme(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Qme(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function epe(){T(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ft(xF,kn);function tpe(t){return XL({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Af)return r;if(i.element&&!nu(i.element))return!1;i.focus()}})}const dd="filters";function npe(t,e){let n=-1,r;const i=tpe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(dd),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Gi&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(dd),callback:()=>{h.isSubMenu()&&h.close(),d.listen(dd)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const w=r.getNavigator();w.getCurrentPage()>-1&&(n=w.getCurrentPage()),w.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const w=e[i.getCurrentPage()];w instanceof Of&&(w.openOptions(),g.preventDefault()),w instanceof If&&(w.activate(),g.preventDefault()),w instanceof Gi||g.preventDefault()}}],dd)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(dd)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function rpe(t,e){OF(t,e),e.add(t)}function Ab(t,e,n){OF(t,e),e.set(t,n)}function OF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fd(t,e,n){return(e=ipe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ipe(t){var e=ope(t,"string");return typeof e=="symbol"?e:e+""}function ope(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lp(t,e,n){return t.set(br(t,e),n),n}function ci(t,e){return t.get(br(t,e))}function br(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const VR="filters",spe=250,g1=VR;var fs=new WeakMap,WR=new WeakMap,Bl=new WeakMap,Nr=new WeakSet;class ape extends qe{static get PLUGIN_KEY(){return VR}static get PLUGIN_PRIORITY(){return spe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,rpe(this,Nr),fd(this,"dropdownMenuPlugin",null),fd(this,"conditionCollection",null),fd(this,"conditionUpdateObserver",null),fd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),fd(this,"filtersRowsMap",null),Ab(this,fs,void 0),Ab(this,WR,new WeakSet),Ab(this,Bl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return br(Nr,n,gpe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[VR]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new ug),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>br(Nr,this,m1).call(this,"accept")),a.addLocalHook("cancel",()=>br(Nr,this,m1).call(this,"cancel")),a.addLocalHook("change",l=>br(Nr,this,fpe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(mM)}:`,s=()=>`${this.hot.getTranslatedPhrase(pM)}:`;if(!this.components.get("filter_by_condition")){const a=new FR(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>br(Nr,this,p1).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new wme(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new FR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>br(Nr,this,p1).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Nme(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Hf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new c_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new xF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>br(Nr,this,mpe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return br(Nr,e,dpe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>br(Nr,this,hpe).call(this)),this.addHook("afterDropdownMenuShow",()=>br(Nr,this,upe).call(this)),this.addHook("afterDropdownMenuHide",()=>br(Nr,this,cpe).call(this)),this.addHook("afterChange",a=>br(Nr,this,lpe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!ci(fs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=ci(fs,this).getMenu(),c=u.getNavigator(),h=ci(fs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Lp(fs,this,npe(this.dropdownMenuPlugin.menu,a));const l=u=>{ci(fs,this).listen(),u.preventDefault(),ah(u.keyCode,"TAB")&&(u.shiftKey?ci(fs,this).toPreviousItem():ci(fs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:g1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(g1)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ha;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,ci(Bl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=yg(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),T(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Lp(Bl,this,this.exportConditions())}else s!==!1&&!r?(Lp(Bl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(ci(Bl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return T(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:s_(w)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=LR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Dw&&n.command.key!==Pn&&r.command.key!==Pn&&i.command.key!==Pn?o=l_:i.command.key!==Pn&&(n.command.key===Pn||r.command.key===Pn)&&(o=Ha),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new PF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return T(i,s=>{T(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function lpe(t){t&&T(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function upe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function cpe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function hpe(){const t=this.dropdownMenuPlugin.menu;ci(WR,this).has(t)||ci(fs,this).setMenu(t),ci(WR,this).add(t)}function dpe(t){t.items.push({name:Le}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function m1(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==Pn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==Pn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Pn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function fpe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===FR&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function p1(){this.setListeningDropdownMenu()}function gpe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):pe(e,"htFiltersActive")}function mpe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Lp(Bl,this,ci(Bl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Gl),s=n.filter(a=>a.name!==Gl);if(o.length>=2||s.length>=3)et(ut`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const IF="internal-use-in-handsontable",BR={licenseKey:IF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function AF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[zn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function HF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function ppe(t){var e;const n=t[zn],r=HF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=AF(t);return{...BR,...r,...i}}function wpe(t){var e;const n=t[zn],r=HF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=AF(t);return{...r,...i}}function vpe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function ay(){const t="engine_relationship",e=Qi(zn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function h_(){const t="shared_engine_usage",e=Qi(zn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function ype(t){const e=t.getSettings(),n=e[zn],r=n==null?void 0:n.engine;if(n===!0||It(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Cpe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&It(r.hyperformula)){const o=ay(),s=h_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:IF}),(r.getConfig().leapYear1900!==BR.leapYear1900||Ov(r.getConfig().nullDate,BR.nullDate)===!1)&&et(ut`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Cpe(t,e,n){const r=e[zn],i=ppe(e),o=ay(),s=h_();bpe(t,r.functions),Spe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Rpe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function w1(t){var e;const n=ay(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function v1(t,e){if(t){const n=ay(),r=n.get(t),i=h_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function bpe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){et(s.message)}})}function Spe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){et(r.message)}}}function Rpe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){et(a.message)}}),t.resumeEvaluation())}function Epe(t,e){return(It(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const NF="DD/MM/YYYY";function Tpe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Mpe(t){return Tpe(t)?t.substr(1):t}function _pe(t){return typeof t=="string"&&t.startsWith("=")}function d_(t,e){return typeof t=="string"&&e==="date"}function DF(t,e){return Z(t,e,!0).isValid()}function kF(t,e){return Z(t,e,!0).format(NF)}function Ppe(t,e){return Z(t,NF,!0).format(e)}function $F(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function xpe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Ope(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Ipe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function f_(t,e,n){const r=Ope(t,xpe(t,e,n));return Ipe(r)}function wl(t,e,n){Ape(t,e),e.set(t,n)}function Ape(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(t,e){return t.get(LF(t,e))}function ta(t,e,n){return t.set(LF(t,e),n),n}function LF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gd=new WeakMap,na=new WeakMap,Dr=new WeakMap,$m=new WeakMap,Hb=new WeakMap,Nb=new WeakMap,Lm=new WeakMap;class y1{constructor(e,n,r){wl(this,gd,void 0),wl(this,na,void 0),wl(this,Dr,void 0),wl(this,$m,[]),wl(this,Hb,[]),wl(this,Nb,void 0),wl(this,Lm,[]),ta(gd,this,e),ta(na,this,n),ta(Dr,this,r)}setRemovedHfIndexes(e){return ta(Lm,this,e.map(n=>{const r=xt(na,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),xt(Lm,this)}getRemovedHfIndexes(){return xt(Lm,this)}getHfIndexFromVisualIndex(e){const n=xt(na,this).getIndexesSequence(),r=xt(na,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${qn(xt(gd,this))}s`;xt(Dr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&xt(Dr,this).getEngine()[r](xt(Dr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ta(Hb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),ta(Nb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(xt(Dr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=f_(xt(Hb,this),xt(Nb,this),xt(na,this).getNumberOfIndexes());xt(Dr,this).getSheetId()===null?xt(Dr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${qn(xt(gd,this))}Order`;return n=>{if(xt(Dr,this).isPerformingUndoRedo())return;const r=xt(na,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=xt($m,this).map(l=>r.indexOf(l)),o=xt(Dr,this).getEngine().getSheetDimensions(xt(Dr,this).getSheetId());let s;xt(gd,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);xt(Dr,this).getEngine()[e](xt(Dr,this).getSheetId(),i)}ta($m,this,r)}}init(){ta($m,this,xt(na,this).getIndexesSequence())}}function vl(t,e,n){Hpe(t,e),e.set(t,n)}function Hpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e){return t.get(FF(t,e))}function yl(t,e,n){return t.set(FF(t,e),n),n}function FF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fm=new WeakMap,Vm=new WeakMap,Db=new WeakMap,kb=new WeakMap,$b=new WeakMap,Lb=new WeakMap,Fb=new WeakMap;class Npe{constructor(e,n,r){vl(this,Fm,void 0),vl(this,Vm,void 0),vl(this,Db,void 0),vl(this,kb,!1),vl(this,$b,!1),vl(this,Lb,null),vl(this,Fb,null),yl(Fm,this,new y1("row",e,this)),yl(Vm,this,new y1("column",n,this)),yl(Db,this,r)}getForAxis(e){return e==="row"?us(Fm,this):us(Vm,this)}setPerformUndo(e){yl(kb,this,e)}setPerformRedo(e){yl($b,this,e)}isPerformingUndoRedo(){return us(kb,this)||us($b,this)}getSheetId(){return us(Fb,this)}getEngine(){return us(Lb,this)}getPostponeAction(){return us(Db,this)}setupSyncEndpoint(e,n){yl(Lb,this,e),yl(Fb,this,n),us(Fm,this).init(),us(Vm,this).init()}}function Dpe(t,e){VF(t,e),e.add(t)}function Cl(t,e,n){return(e=kpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kpe(t){var e=$pe(t,"string");return typeof e=="symbol"?e:e+""}function $pe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vb(t,e,n){VF(t,e),e.set(t,n)}function VF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Va(t,e,n){return t.set(Xe(t,e),n),n}function Jl(t,e){return t.get(Xe(t,e))}function Xe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zn="formulas",Lpe=["maxRows","maxColumns","language"],Fpe=260;ie.getSingleton().register("afterNamedExpressionAdded");ie.getSingleton().register("afterNamedExpressionRemoved");ie.getSingleton().register("afterSheetAdded");ie.getSingleton().register("afterSheetRemoved");ie.getSingleton().register("afterSheetRenamed");ie.getSingleton().register("afterFormulasValuesUpdate");const fh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var ks=new WeakMap,ly=new WeakMap,md=new WeakMap,Qe=new WeakSet;class Vpe extends qe{constructor(){var e;super(...arguments),e=this,Dpe(this,Qe),Vb(this,ks,!1),Vb(this,ly,!1),Vb(this,md,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,nwe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,rwe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,iwe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,owe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,swe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,awe).call(e,...r)}]]),Cl(this,"staticRegister",Qi("formulas")),Cl(this,"engine",null),Cl(this,"sheetId",null),Cl(this,"sheetName",null),Cl(this,"indexSyncer",null),Cl(this,"rowAxisSyncer",null),Cl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return zn}static get PLUGIN_PRIORITY(){return Fpe}static get SETTING_KEYS(){return[zn,...Lpe]}isEnabled(){return!!this.hot.getSettings()[zn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=ype(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){et("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Xe(Qe,this,Gd).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,C1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,b1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,C1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,b1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Upe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,zpe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Wpe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Ype).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,S1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,S1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Gpe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Kpe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Jpe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Zpe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,qpe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Xpe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Qpe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,ewe).call(n,...i)}),this.indexSyncer=new Npe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,jpe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,twe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Bpe).call(n,...i)}),Jl(md,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Jl(md,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),v1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=wpe(this.hot.getSettings());vpe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[zn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[zn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Xe(Qe,this,Gd).call(this,o)}}super.updatePlugin(e)}destroy(){Jl(md,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Va(md,this,null),v1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!C$(n))return et("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return et("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return et(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){PE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Xe(Qe,this,Gd).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${qn(zn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),w1(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=w1(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){et(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return d_(r,o.type)&&(DF(r,o.dateFormat)?r=kF(r,o.dateFormat):_pe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Gd(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function Wpe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Un(s)&&(s=$F(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Bpe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:w}=h.start,{row:y,col:E}=h.end,C=y-g+1,A=E-w+1;for(let _=0;_<f.length;_+=1)for(let $=0;$<f[_].length;$+=1){const I=f[_][$],M=g+_%C,G=w+$%A,V=this.hot.getCellMeta(M,G);d_(I,V.type)&&(I.startsWith("'")?f[_][$]=I.slice(1):this.isFormulaCellType(M,G,this.sheetId)===!1&&(f[_][$]=Ppe(I,V.dateFormat)))}return f}function C1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(qn(zn))||Va(ly,this,It(this.hot.getSettings().data))}function jpe(){if(Jl(ly,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;d_(i,s.type)&&(DF(i,a)?t[r][o]=kF(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Va(ks,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Va(ks,this,!1)}function b1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(qn(zn)))return;const r=Epe(this.engine,this.hot.getSettings()[zn].sheetName);if(Xe(Qe,this,Gd).call(this,r),n!=="updateSettings")if(Jl(ly,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Va(ks,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Va(ks,this,!1)}}}function Upe(t,e,n,r){if(r!=="get"||Jl(ks,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=Mpe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Un(a)&&(a=$F(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function zpe(t,e,n,r){if(r!=="get"||Jl(ks,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function S1(t,e){if(fh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Ype(t,e){if(fh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Un(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){et(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Gpe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Kpe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function qpe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Xpe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Jpe(t,e,n){if(fh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Zpe(t,e,n){if(fh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Qpe(t,e,n,r){if(fh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function ewe(t,e,n,r){if(fh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function twe(t,e,n){var r;Va(ks,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Va(ks,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function nwe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function rwe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function iwe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function owe(t){this.hot.runHooks("afterSheetAdded",t)}function swe(t,e){Xe(Qe,this,Gd).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function awe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function lwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(YT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function uwe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(GT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return T(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function cwe(t,e){WF(t,e),e.add(t)}function hwe(t,e,n){WF(t,e),e.set(t,n)}function WF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bl(t,e){return t.get(ha(t,e))}function R1(t,e,n){return t.set(ha(t,e),n),n}function ha(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideColumns");ie.getSingleton().register("afterHideColumns");ie.getSingleton().register("beforeUnhideColumns");ie.getSingleton().register("afterUnhideColumns");const E1="hiddenColumns",dwe=310;var co=new WeakMap,Sl=new WeakSet;class fwe extends qe{constructor(){super(...arguments),cwe(this,Sl),hwe(this,co,null)}static get PLUGIN_KEY(){return E1}static get PLUGIN_PRIORITY(){return dwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[E1]}enablePlugin(){var e=this;this.enabled||(R1(co,this,new Lv),bl(co,this).addLocalHook("init",()=>ha(Sl,this,ywe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,bl(co,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ha(Sl,e,vwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>ha(Sl,this,mwe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>ha(Sl,this,gwe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ha(Sl,e,wwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>ha(Sl,this,pwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=bl(co,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));T(l,u=>{o[u]=!1}),i=vn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&bl(co,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{bl(co,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(bl(co,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return bl(co,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){R1(co,this,null),super.destroy()}}function gwe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function mwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function pwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function wwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function vwe(t){t.items.push({name:Le},lwe(this),uwe(this))}function ywe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Cwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(KT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function bwe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(qT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return T(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Swe(t,e){BF(t,e),e.add(t)}function Rwe(t,e,n){BF(t,e),e.set(t,n)}function BF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rl(t,e){return t.get(da(t,e))}function T1(t,e,n){return t.set(da(t,e),n),n}function da(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideRows");ie.getSingleton().register("afterHideRows");ie.getSingleton().register("beforeUnhideRows");ie.getSingleton().register("afterUnhideRows");const M1="hiddenRows",Ewe=320;var ho=new WeakMap,El=new WeakSet;class Twe extends qe{constructor(){super(...arguments),Swe(this,El),Rwe(this,ho,null)}static get PLUGIN_KEY(){return M1}static get PLUGIN_PRIORITY(){return Ewe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[M1]}enablePlugin(){var e=this;this.enabled||(T1(ho,this,new Lv),Rl(ho,this).addLocalHook("init",()=>da(El,this,Iwe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Rl(ho,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return da(El,e,Owe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>da(El,this,_we).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>da(El,this,Mwe).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return da(El,e,xwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>da(El,this,Pwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Rl(ho,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));T(l,u=>{o[u]=!1}),i=vn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Rl(ho,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{Rl(ho,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(Rl(ho,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Rl(ho,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){T1(ho,this,null),super.destroy()}}function Mwe(t,e){return this.isHidden(e)?0:t}function _we(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Pwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function xwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function Owe(t){t.items.push({name:Le},Cwe(this),bwe(this))}function Iwe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Awe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(ST)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Hwe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(RT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Nwe(t,e){jF(t,e),e.add(t)}function Dwe(t,e,n){jF(t,e),e.set(t,n)}function jF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jR(t,e){return t.get($w(t,e))}function Wb(t,e,n){return t.set($w(t,e),n),n}function $w(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnFreeze");ie.getSingleton().register("afterColumnFreeze");ie.getSingleton().register("beforeColumnUnfreeze");ie.getSingleton().register("afterColumnUnfreeze");const _1="manualColumnFreeze",kwe=110;var Ll=new WeakMap,Bb=new WeakSet;class $we extends qe{constructor(){super(...arguments),Nwe(this,Bb),Dwe(this,Ll,!1)}static get PLUGIN_KEY(){return _1}static get PLUGIN_PRIORITY(){return kwe}isEnabled(){return!!this.hot.getSettings()[_1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>$w(Bb,this,Lwe).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>$w(Bb,this,Fwe).call(this,e,n)),super.enablePlugin())}disablePlugin(){Wb(Ll,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;jR(Ll,this)||Wb(Ll,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;jR(Ll,this)||Wb(Ll,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Lwe(t){t.items.push({name:"---------"},Awe(this),Hwe(this))}function Fwe(t,e){if(jR(Ll,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Wm(t,e,n){return(e=Vwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vwe(t){var e=Wwe(t,"string");return typeof e=="symbol"?e:e+""}function Wwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jb=0,P1=1,x1=2,nc="px";let UF=class{constructor(e){Wm(this,"hot",void 0),Wm(this,"_element",null),Wm(this,"state",jb),Wm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=x1}build(){this.state===jb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=P1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=jb}isAppended(){return this.state===x1}isBuilt(){return this.state>=P1}setPosition(e,n){Un(e)&&(this._element.style.top=e+nc),Un(n)&&(this._element.style[this.inlineProperty]=n+nc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Un(e)&&(this._element.style.width=e+nc),Un(n)&&(this._element.style.height=n+nc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Un(e)&&(this._element.style.marginTop=e+nc),Un(n)&&(this._element.style[`margin${qn(this.inlineProperty)}`]=n+nc)}getOffset(){const e=this._element.style,n=`margin${qn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Bwe="ht__manualColumnMove--backlight";let jwe=class extends UF{build(){super.build(),q(this._element,Bwe)}};const Uwe="ht__manualColumnMove--guideline";let zwe=class extends UF{build(){super.build(),q(this._element,Uwe)}};function Ywe(t,e){zF(t,e),e.add(t)}function Ai(t,e,n){zF(t,e),e.set(t,n)}function zF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pr(t,e,n){return t.set(fa(t,e),n),n}function he(t,e){return t.get(fa(t,e))}function fa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnMove");ie.getSingleton().register("afterColumnMove");const Ub="manualColumnMove",Gwe=120,O1="ht__manualColumnMove",Lw="show-ui",UR="on-moving--columns",zR="after-selection--columns";var or=new WeakMap,pa=new WeakMap,_s=new WeakMap,Fp=new WeakMap,_a=new WeakMap,ir=new WeakMap,Bm=new WeakMap,si=new WeakMap,pc=new WeakMap,Fw=new WeakMap,Kd=new WeakMap,Tl=new WeakSet;class Kwe extends qe{constructor(){super(...arguments),Ywe(this,Tl),Ai(this,or,new jwe(this.hot)),Ai(this,pa,new zwe(this.hot)),Ai(this,_s,[]),Ai(this,Fp,0),Ai(this,_a,!1),Ai(this,ir,{}),Ai(this,Bm,void 0),Ai(this,si,void 0),Ai(this,pc,void 0),Ai(this,Fw,void 0),Ai(this,Kd,void 0)}static get PLUGIN_KEY(){return Ub}static get PLUGIN_PRIORITY(){return Gwe}isEnabled(){return!!this.hot.getSettings()[Ub]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fa(Tl,e,qwe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fa(Tl,e,Jwe).call(e,...r)}),this.addHook("afterScrollVertically",()=>fa(Tl,this,Qwe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fa(Tl,e,eve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,O1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,O1),this.unregisterEvents(),he(or,this).destroy(),he(pa,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(Bm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Pr(Bm,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Pr(Bm,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=vn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Ub];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(si,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(si,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(or,this).getOffset().start,u=he(or,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,w=Xt(this.hot.rootElement),y=g.innerWidth-he(pc,this)-w;h=g.innerWidth-he(ir,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=he(ir,this).eventPageX-(he(pc,this)-(r.scrollX===void 0?i:0));if(he(Fw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(si,this))&&(o+=i),o+=c,he(si,this)<0)he(Kd,this)>0?he(ir,this).col=0:he(ir,this).col=e>0?e-1:e;else if(he(ir,this).TD.offsetWidth/2+o<=h){const g=he(si,this)>=he(Fp,this)?he(Fp,this)-1:he(si,this);he(ir,this).col=g+1,o+=he(ir,this).TD.offsetWidth}else he(ir,this).col=he(si,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(si,this)<he(Kd,this)&&(f-=he(pc,this)<=r.scrollX?he(pc,this):0),he(or,this).setPosition(null,d),he(pa,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>fa(Tl,this,Xwe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>fa(Tl,this,Zwe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(or,this).build(),he(pa,this).build()}destroy(){he(or,this).destroy(),he(pa,this).destroy(),super.destroy()}}function qwe(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=we(t.target,"sortAction");if(!s||!o||he(_a,this)||t.button!==0||a){Pr(_a,this,!1),he(_s,this).length=0,pe(this.hot.rootElement,[UR,Lw]);return}const l=he(pa,this).isBuilt()&&!he(pa,this).isAppended(),u=he(or,this).isBuilt()&&!he(or,this).isAppended();l&&u&&(he(pa,this).appendTo(i.hider),he(or,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Pr(_a,this,!0);const g=n.firstChild?Lk(t,n.firstChild).x:t.offsetX;he(ir,this).eventPageX=t.pageX,Pr(si,this,e.col),he(ir,this).TD=n,he(ir,this).col=e.col,Pr(_s,this,this.prepareColumnsToMoving(d,f)),Pr(Fw,this,!!this.hot.getSettings().rowHeaders),Pr(Fp,this,this.hot.countCols()),Pr(Kd,this,this.hot.getSettings().fixedColumnsStart),Pr(pc,this,Dn(this.hot.rootElement).left);const w=he(Fw,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(Kd,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),A=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),_=this.getColumnsWidth(d,e.col-1)+A,$=this.getColumnsWidth(w,d-1)+(E?C:0)+_;he(or,this).setPosition(y,$),he(or,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),he(or,this).setOffset(null,-_),q(this.hot.rootElement,UR)}else pe(this.hot.rootElement,zR),Pr(_a,this,!1),he(_s,this).length=0}function Xwe(t){he(_a,this)&&(he(ir,this).eventPageX=t.pageX,this.refreshPositions())}function Jwe(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(_a,this)||(he(_s,this).indexOf(e.col)>-1?pe(this.hot.rootElement,Lw):q(this.hot.rootElement,Lw),r.row=!0,r.column=!0,r.cell=!0,Pr(si,this,e.col),he(ir,this).TD=n)}function Zwe(){const t=he(ir,this).col,e=he(_s,this).length;if(Pr(si,this,void 0),Pr(_a,this,!1),pe(this.hot.rootElement,[UR,Lw,zR]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,zR),e<1||t===void 0)return;const n=he(_s,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(_s,this),t);if(he(_s,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Qwe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(or,this).setPosition(r),he(or,this).setSize(null,t.hider.offsetHeight-r)}function eve(){this.moveBySettingsOrLoad()}function tve(t,e){YF(t,e),e.add(t)}function Fn(t,e,n){YF(t,e),e.set(t,n)}function YF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e,n){return t.set(Vi(t,e),n),n}function oe(t,e){return t.get(Vi(t,e))}function Vi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vw="manualColumnResize",nve=130,I1="manualColumnWidths";var vs=new WeakMap,jm=new WeakMap,jr=new WeakMap,Ww=new WeakMap,Ao=new WeakMap,rve=new WeakMap,Dc=new WeakMap,Um=new WeakMap,yr=new WeakMap,gs=new WeakMap,au=new WeakMap,Bw=new WeakMap,qd=new WeakMap,Xd=new WeakMap,zr=new WeakMap,Jd=new WeakMap,fo=new WeakSet;class ive extends qe{static get PLUGIN_KEY(){return Vw}static get PLUGIN_PRIORITY(){return nve}constructor(e){super(e),tve(this,fo),Fn(this,vs,null),Fn(this,jm,null),Fn(this,jr,[]),Fn(this,Ww,null),Fn(this,Ao,null),Fn(this,rve,null),Fn(this,Dc,null),Fn(this,Um,null),Fn(this,yr,this.hot.rootDocument.createElement("DIV")),Fn(this,gs,this.hot.rootDocument.createElement("DIV")),Fn(this,au,null),Fn(this,Bw,!1),Fn(this,qd,0),Fn(this,Xd,null),Fn(this,zr,void 0),Fn(this,Jd,void 0),q(oe(yr,this),"manualColumnResizer"),q(oe(gs,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Vw]}enablePlugin(){var e=this;this.enabled||(qt(zr,this,new ja),oe(zr,this).addLocalHook("init",()=>Vi(fo,this,ove).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,oe(zr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vi(fo,e,hve).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vi(fo,e,dve).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vi(fo,e,fve).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){qt(Jd,this,oe(zr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",I1,oe(zr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",I1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return oe(zr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);oe(zr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;qt(vs,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(oe(vs,this)),i=r.col;if(i<0)return;const o=rn(oe(vs,this)),s=oe(vs,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(vs,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(oe(vs,this),r.row,r.col)),qt(jm,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),qt(jr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();T(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{oe(jr,this).includes(g)||oe(jr,this).push(g)})})}oe(jr,this).includes(oe(jm,this))||qt(jr,this,[oe(jm,this)]),qt(Um,this,l.start-6),qt(Dc,this,parseInt(s.width,10)),oe(yr,this).style.top=`${l.top}px`,oe(yr,this).style[this.inlineDir]=`${oe(Um,this)+oe(Dc,this)}px`,oe(yr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(oe(yr,this))}refreshHandlePosition(){oe(yr,this).style[this.inlineDir]=`${oe(Um,this)+oe(Ww,this)}px`}setupGuidePosition(){const e=parseInt(rn(oe(yr,this)),10),n=parseInt(oe(yr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(oe(yr,this),"active"),q(oe(gs,this),"active"),oe(gs,this).style.top=`${n}px`,this.refreshGuidePosition(),oe(gs,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(oe(gs,this))}refreshGuidePosition(){oe(gs,this).style[this.inlineDir]=oe(yr,this).style[this.inlineDir]}hideHandleAndGuide(){pe(oe(yr,this),"active"),pe(oe(gs,this),"active")}checkIfColumnHeader(e){const n=ka(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",oe(Ao,this),r,!0);o!==void 0&&qt(Ao,this,o),this.setManualSize(r,oe(Ao,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(Ao,this),r,!0),i&&e()};oe(qd,this)>=2&&(oe(jr,this).length>1?(T(oe(jr,this),i=>{n(i)}),e()):T(oe(jr,this),i=>{n(i,!0)})),qt(qd,this,0),qt(Xd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Vi(fo,this,sve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Vi(fo,this,ave).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Vi(fo,this,lve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Vi(fo,this,uve).call(this)),this.eventManager.addEventListener(oe(yr,this),"contextmenu",()=>Vi(fo,this,cve).call(this))}destroy(){super.destroy()}}function ove(){const t=this.hot.getSettings()[Vw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{oe(zr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{oe(zr,this).setValueAtIndex(r,n)})},!0),qt(Jd,this,t)):t===!0&&Array.isArray(oe(Jd,this))&&this.hot.batchExecution(()=>{oe(Jd,this).forEach((n,r)=>{oe(zr,this).setValueAtIndex(r,n)})},!0)}function sve(t){if(!yE(t.target)&&oe(Bw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(oe(au,this)||this.setupHandlePosition(e))}}function ave(t){t.target.parentNode===this.hot.rootElement&&we(t.target,"manualColumnResizer")&&(this.setupHandlePosition(oe(vs,this)),this.setupGuidePosition(),qt(au,this,!0),oe(Xd,this)===null&&(qt(Xd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(Xd,this))),qt(qd,this,oe(qd,this)+1),this.startX=t.pageX,qt(Ao,this,oe(Dc,this)))}function lve(t){if(oe(au,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();qt(Ww,this,oe(Dc,this)+e),T(oe(jr,this),n=>{qt(Ao,this,this.setManualSize(n,oe(Ww,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function uve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",oe(Ao,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(Ao,this),n,!1)};oe(au,this)&&(this.hideHandleAndGuide(),qt(au,this,!1),oe(Ao,this)!==oe(Dc,this)&&(oe(jr,this).length>1?(T(oe(jr,this),r=>{e(r)}),t()):T(oe(jr,this),r=>{e(r,!0)})),this.setupHandlePosition(oe(vs,this)))}function cve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(yr,this)),this.hot.rootElement.removeChild(oe(gs,this)),qt(au,this,!1),qt(Bw,this,!0),this.hot._registerImmediate(()=>{qt(Bw,this,!1)})}function hve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=oe(zr,this).getValueAtIndex(r);this.hot.getSettings()[Vw]&&i&&(n=i)}return n}function dve(t,e){const n=oe(zr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function fve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function zb(t,e,n){return(e=gve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gve(t){var e=mve(t,"string");return typeof e=="symbol"?e:e+""}function mve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Yb=0,A1=1,H1=2,rc="px";let GF=class{constructor(e){zb(this,"hot",void 0),zb(this,"_element",null),zb(this,"state",Yb),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=H1}build(){this.state===Yb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=A1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Yb}isAppended(){return this.state===H1}isBuilt(){return this.state>=A1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+rc),n!==void 0&&(this._element.style.left=n+rc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+rc),n&&(this._element.style.height=n+rc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+rc),n&&(this._element.style.marginLeft=n+rc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const pve="ht__manualRowMove--backlight";class wve extends GF{build(){super.build(),q(this._element,pve)}}const vve="ht__manualRowMove--guideline";class yve extends GF{build(){super.build(),q(this._element,vve)}}function Cve(t,e){KF(t,e),e.add(t)}function ic(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kl(t,e,n){return t.set(ga(t,e),n),n}function _e(t,e){return t.get(ga(t,e))}function ga(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeRowMove");ie.getSingleton().register("afterRowMove");const Gb="manualRowMove",bve=140,N1="ht__manualRowMove",jw="show-ui",YR="on-moving--rows",GR="after-selection--rows";var sr=new WeakMap,wa=new WeakMap,Ps=new WeakMap,Pa=new WeakMap,xr=new WeakMap,zm=new WeakMap,Ml=new WeakSet;class Sve extends qe{constructor(){super(...arguments),Cve(this,Ml),ic(this,sr,new wve(this.hot)),ic(this,wa,new yve(this.hot)),ic(this,Ps,[]),ic(this,Pa,void 0),ic(this,xr,{}),ic(this,zm,void 0)}static get PLUGIN_KEY(){return Gb}static get PLUGIN_PRIORITY(){return bve}isEnabled(){return!!this.hot.getSettings()[Gb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ga(Ml,e,Rve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ga(Ml,e,Tve).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ga(Ml,this,_ve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ga(Ml,e,Pve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,N1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,N1),this.unregisterEvents(),_e(sr,this).destroy(),_e(wa,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=_e(zm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Kl(zm,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Kl(zm,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=vn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Gb];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=_e(xr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=_e(xr,this).TD,a=this.hot.rootElement,l=Dn(a),u=Wc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=_e(xr,this).eventPageY-d+c,g=o.hider.offsetHeight,w=o.TBODY.offsetTop,y=_e(sr,this).getOffset().top,E=_e(sr,this).getSize().height,C=s.offsetHeight/2,A=s.offsetHeight;let _=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const $=f>=_+C;this.isFixedRowTop(e.row)&&(_+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_e(xr,this).row=n>0?n-1:n:$?(_e(xr,this).row=e.row+1,_+=e.row===0?A-1:A):_e(xr,this).row=e.row;let I=f,M=_;f+E+y>=g?I=g-E-y:f+y<w&&(I=w+Math.abs(y)),_>=g-1&&(M=g-1),_e(sr,this).setPosition(I),_e(wa,this).setPosition(M)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ga(Ml,this,Eve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ga(Ml,this,Mve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_e(sr,this).build(),_e(wa,this).build()}destroy(){_e(sr,this).destroy(),_e(wa,this).destroy(),super.destroy()}}function Rve(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||_e(Pa,this)||t.button!==0){Kl(Pa,this,!1),_e(Ps,this).length=0,pe(this.hot.rootElement,[YR,jw]);return}const l=_e(wa,this).isBuilt()&&!_e(wa,this).isAppended(),u=_e(sr,this).isBuilt()&&!_e(sr,this).isAppended();l&&u&&(_e(wa,this).appendTo(i.hider),_e(sr,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,Kl(Pa,this,!0),_e(xr,this).eventPageY=t.pageY,_e(xr,this).coords=e,_e(xr,this).TD=n,Kl(Ps,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);_e(sr,this).setPosition(null,g),_e(sr,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),_e(sr,this).setOffset(-w,null),q(this.hot.rootElement,YR),this.refreshPositions()}else pe(this.hot.rootElement,GR),Kl(Pa,this,!1),_e(Ps,this).length=0}function Eve(t){_e(Pa,this)&&(_e(xr,this).eventPageY=t.pageY,this.refreshPositions())}function Tve(t,e,n,r){!this.hot.getSelectedRangeLast()||!_e(Pa,this)||(_e(Ps,this).indexOf(e.row)>-1?pe(this.hot.rootElement,jw):q(this.hot.rootElement,jw),r.row=!0,r.column=!0,r.cell=!0,_e(xr,this).coords=e,_e(xr,this).TD=n)}function Mve(){const t=_e(xr,this).row,e=_e(Ps,this).length;if(Kl(Pa,this,!1),pe(this.hot.rootElement,[YR,jw,GR]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,GR),e<1||t===void 0)return;const n=_e(Ps,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(_e(Ps,this),t);if(_e(Ps,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function _ve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;_e(sr,this).setPosition(null,r),_e(sr,this).setSize(t.hider.offsetWidth-r)}function Pve(){this.moveBySettingsOrLoad()}function xve(t,e){qF(t,e),e.add(t)}function Vn(t,e,n){qF(t,e),e.set(t,n)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e,n){return t.set(ys(t,e),n),n}function re(t,e){return t.get(ys(t,e))}function ys(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Uw="manualRowResize",Ove=30,D1="manualRowHeights";var Eo=new WeakMap,Ym=new WeakMap,Ur=new WeakMap,Zd=new WeakMap,va=new WeakMap,g_=new WeakMap,kc=new WeakMap,Gm=new WeakMap,nr=new WeakMap,bo=new WeakMap,lu=new WeakMap,zw=new WeakMap,Qd=new WeakMap,ef=new WeakMap,ji=new WeakMap,tf=new WeakMap,ra=new WeakSet;class Ive extends qe{static get PLUGIN_KEY(){return Uw}static get PLUGIN_PRIORITY(){return Ove}constructor(e){super(e),xve(this,ra),Vn(this,Eo,null),Vn(this,Ym,null),Vn(this,Ur,[]),Vn(this,Zd,null),Vn(this,va,null),Vn(this,g_,null),Vn(this,kc,null),Vn(this,Gm,null),Vn(this,nr,this.hot.rootDocument.createElement("DIV")),Vn(this,bo,this.hot.rootDocument.createElement("DIV")),Vn(this,lu,!1),Vn(this,zw,!1),Vn(this,Qd,0),Vn(this,ef,null),Vn(this,ji,void 0),Vn(this,tf,void 0),q(re(nr,this),"manualRowResizer"),q(re(bo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Uw]}enablePlugin(){this.enabled||(Vt(ji,this,new ja),re(ji,this).addLocalHook("init",()=>ys(ra,this,Lve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,re(ji,this)),this.addHook("modifyRowHeight",(e,n)=>ys(ra,this,$ve).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Vt(tf,this,re(ji,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",D1,re(ji,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",D1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return re(ji,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return re(Zd,this)}setupHandlePosition(e){Vt(Eo,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(re(Eo,this)),o=i.row;if(o<0)return;const s=Xt(re(Eo,this)),a=re(Eo,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(Eo,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(re(Eo,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(re(Eo,this),i.row,i.col)),Vt(Ym,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Vt(Ur,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();T(d,f=>{const g=f.getTopStartCorner().row,w=f.getBottomStartCorner().row;fe(g,w,y=>{re(Ur,this).includes(y)||re(Ur,this).push(y)})})}re(Ur,this).includes(re(Ym,this))||Vt(Ur,this,[re(Ym,this)]),Vt(Gm,this,c.top-6),Vt(kc,this,parseInt(a.height,10)),re(nr,this).style.top=`${re(Gm,this)+re(kc,this)}px`,re(nr,this).style[this.inlineDir]=`${c.start}px`,re(nr,this).style.width=`${s}px`,this.hot.rootElement.appendChild(re(nr,this))}refreshHandlePosition(){re(nr,this).style.top=`${re(Gm,this)+re(Zd,this)}px`}setupGuidePosition(){const e=parseInt(Xt(re(nr,this)),10),n=parseInt(re(nr,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(re(nr,this),"active"),q(re(bo,this),"active"),re(bo,this).style.top=re(nr,this).style.top,re(bo,this).style[this.inlineDir]=`${n}px`,re(bo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(re(bo,this))}refreshGuidePosition(){re(bo,this).style.top=re(nr,this).style.top}hideHandleAndGuide(){pe(re(nr,this),"active"),pe(re(bo,this),"active")}checkIfRowHeader(e){const n=ka(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&re(va,this)<n?n:re(va,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Vt(va,this,o),this.setManualSize(r,re(va,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};re(Qd,this)>=2&&(re(Ur,this).length>1?(T(re(Ur,this),i=>{n(i)}),e()):T(re(Ur,this),i=>{n(i,!0)})),Vt(Qd,this,0),Vt(ef,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>ys(ra,this,Ave).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>ys(ra,this,Hve).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>ys(ra,this,Nve).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>ys(ra,this,Dve).call(this)),this.eventManager.addEventListener(re(nr,this),"contextmenu",()=>ys(ra,this,kve).call(this))}destroy(){super.destroy()}}function Ave(t){if(!yE(t.target)&&re(zw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(re(lu,this)||this.setupHandlePosition(e))}}function Hve(t){we(t.target,"manualRowResizer")&&(this.setupHandlePosition(re(Eo,this)),this.setupGuidePosition(),Vt(lu,this,!0),re(ef,this)===null&&(Vt(ef,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(ef,this))),Vt(Qd,this,re(Qd,this)+1),Vt(g_,this,t.pageY),Vt(va,this,re(kc,this)))}function Nve(t){re(lu,this)&&(Vt(Zd,this,re(kc,this)+(t.pageY-re(g_,this))),T(re(Ur,this),e=>{Vt(va,this,this.setManualSize(e,re(Zd,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Dve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};re(lu,this)&&(this.hideHandleAndGuide(),Vt(lu,this,!1),re(va,this)!==re(kc,this)&&(re(Ur,this).length>1?(T(re(Ur,this),r=>{e(r)}),t()):T(re(Ur,this),r=>{e(r,!0)})),this.setupHandlePosition(re(Eo,this)))}function kve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(nr,this)),this.hot.rootElement.removeChild(re(bo,this)),Vt(lu,this,!1),Vt(zw,this,!0),this.hot._registerImmediate(()=>{Vt(zw,this,!1)})}function $ve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=re(ji,this).getValueAtIndex(r);this.hot.getSettings()[Uw]&&i&&(n=i)}return n}function Lve(){const t=this.hot.getSettings()[Uw],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{re(ji,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{re(ji,this).setValueAtIndex(r,n)}),Vt(tf,this,t)):t===!0&&Array.isArray(re(tf,this))&&re(tf,this).forEach((n,r)=>{re(ji,this).setValueAtIndex(r,n)})},!0)}var Fve=Hv;Fve("flatMap");var Vve=mn,k1=wn,Wve=zo,Bve=O0,jve=function(t,e){(!e||typeof t!="string")&&k1(t);var n=Bve(t);return Wve(k1(n!==void 0?Vve(n,t):t))},Uve=yt,KR=mn,zve=Ar,qR=wn,Yve=zo,Gve=jve,Kve=k0,XR=Xr,qve=Ba,Kb=qve("flatMap",TypeError),Xve=Kve(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=qR(KR(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){XR(t,"throw",i)}if(n=qR(KR(this.next,t)),this.done=!!n.done)return;try{this.inner=Gve(e(n.value,this.counter++),!1)}catch(i){XR(t,"throw",i)}}});Uve({target:"Iterator",proto:!0,real:!0,forced:Kb},{flatMap:function(e){qR(this);try{zve(e)}catch(n){XR(this,"throw",n)}return Kb?KR(Kb,this,e):new Xve(Yve(this),{mapper:e,inner:null})}});function Jve(t,e,n){Zve(t,e),e.set(t,n)}function Zve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e,n){return(e=Qve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qve(t){var e=eye(t,"string");return typeof e=="symbol"?e:e+""}function eye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $1(t,e){return t.get(XF(t,e))}function Km(t,e,n){return t.set(XF(t,e),n),n}function XF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pl=new WeakMap;class To{constructor(e,n,r,i,o,s){_l(this,"row",void 0),_l(this,"col",void 0),_l(this,"rowspan",void 0),_l(this,"colspan",void 0),_l(this,"removed",!1),_l(this,"cellCoordsFactory",void 0),_l(this,"cellRangeFactory",void 0),Jve(this,Pl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return ut`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return ut`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return ut`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return ut`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),Km(Pl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,Km(Pl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return Km(Pl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return $1(Pl,this)||Km(Pl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),$1(Pl,this)}}function tye(t,e){nye(t,e),e.add(t)}function nye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qm(t,e,n){return(e=rye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rye(t){var e=iye(t,"string");return typeof e=="symbol"?e:e+""}function iye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ia=new WeakSet;class Yw{constructor(e){tye(this,ia),qm(this,"plugin",void 0),qm(this,"mergedCells",[]),qm(this,"mergedCellsMatrix",new Map),qm(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return ut`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){et(Yw.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new To(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),xl(ia,this,L1).call(this,a),a):(u&&et(Yw.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),xl(ia,this,oye).call(this,r),r):!1}clear(){T(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ye(u,i,i+s-1),d=Ye(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=xl(ia,this,Xm).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=xl(ia,this,Xm).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=xl(ia,this,Xm).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=xl(ia,this,Xm).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{xl(ia,this,L1).call(this,s)})}}function Xm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function L1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function oye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function qb(t,e,n){return(e=sye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sye(t){var e=aye(t,"string");return typeof e=="symbol"?e:e+""}function aye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lye{constructor(e){qb(this,"plugin",void 0),qb(this,"mergedCellsCollection",void 0),qb(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,w=this.getFarthestCollection(e,n,r,i);if(w){if(r==="down"){const y=w.row+w.rowspan-a-g;o[2]+y>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?y:0}else if(r==="right"){const y=w.col+w.colspan-l-g;o[3]+y>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?y:0}else if(r==="up"){const y=u-g-w.row+1;o[0]+y<0?o[0]+=g:o[0]-=g?y:0}else if(r==="left"){const y=c-g-w.col+1;o[1]+y<0?o[1]+=g:o[1]-=g?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),on(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,w=d-g;let y=null,E=null,C=null;switch(r){case"up":y="includesVertically",C=c-w+1;break;case"left":y="includesHorizontally",C=c-w+1;break;case"down":y="includesVertically",C=h+w-1;break;case"right":y="includesHorizontally",C=h+w-1;break}return T(i,A=>{A[y](C)&&A.isFarther(E,r)&&(E=A)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return T(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:w}=g;return w===h.getWidth()}):!f.every(g=>{let{rowspan:w}=g;return w===h.getHeight()})}}function Xb(t,e,n){return(e=uye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uye(t){var e=cye(t,"string");return typeof e=="symbol"?e:e+""}function cye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hye{constructor(e){Xb(this,"plugin",void 0),Xb(this,"hot",void 0),Xb(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function dye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(TT)}return this.getTranslatedPhrase(ET)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?To.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function nf(t,e,n){return(e=fye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fye(t){var e=gye(t,"string");return typeof e=="symbol"?e:e+""}function gye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F1{constructor(e){nf(this,"data",void 0),nf(this,"next",null),nf(this,"prev",null),this.data=e}}class Jm{constructor(){nf(this,"first",null),nf(this,"last",null)}push(e){const n=new F1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new F1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function mye(t,e){JF(t,e),e.add(t)}function Ol(t,e,n){JF(t,e),e.set(t,n)}function JF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function st(t,e){return t.get(Gw(t,e))}function kr(t,e,n){return t.set(Gw(t,e),n),n}function Gw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var go=new WeakMap,mo=new WeakMap,po=new WeakMap,wo=new WeakMap,JR=new WeakMap,Zm=new WeakMap,Qm=new WeakMap,Jb=new WeakSet;class pye{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;mye(this,Jb),Ol(this,go,new Jm),Ol(this,mo,new Jm),Ol(this,po,null),Ol(this,wo,null),Ol(this,JR,null),Ol(this,Zm,null),Ol(this,Qm,null),kr(JR,this,n),kr(Zm,this,r),kr(Qm,this,i)}getCurrentVerticalNode(){return st(wo,this).data}getFirstVerticalNode(){return st(mo,this).first.data}getNextVerticalNode(){return st(wo,this).next.data}getPrevVerticalNode(){return st(wo,this).prev.data}getCurrentHorizontalNode(){return st(po,this).data}getFirstHorizontalNode(){return st(go,this).first.data}getNextHorizontalNode(){return st(po,this).next.data}getPrevHorizontalNode(){return st(po,this).prev.data}setPrevNodeAsActive(){kr(wo,this,st(wo,this).prev),kr(po,this,st(po,this).prev)}setNextNodeAsActive(){kr(wo,this,st(wo,this).next),kr(po,this,st(po,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;kr(go,this,new Jm);for(let s=n.row;s<=r.row;s++)if(!st(Zm,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(st(Qm,this).isHidden(a))continue;const l=Gw(Jb,this,V1).call(this,e,st(go,this),i,s,a);l&&kr(po,this,l)}st(go,this).first&&(st(go,this).first.prev=st(go,this).last,st(go,this).last.next=st(go,this).first);const o=new WeakSet;kr(mo,this,new Jm);for(let s=n.col;s<=r.col;s++)if(!st(Qm,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(st(Zm,this).isHidden(a))continue;const l=Gw(Jb,this,V1).call(this,e,st(mo,this),o,a,s);l&&kr(wo,this,l)}st(mo,this).first&&(st(mo,this).first.prev=st(mo,this).last,st(mo,this).last.next=st(mo,this).first)}setActiveNode(e,n){return st(go,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return kr(po,this,r),!1}),st(mo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return kr(wo,this,r),!1}),this}}function V1(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=st(JR,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function ZF(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function wye(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!De(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),bf()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[w,y]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if(bf()&&d===0&&!e.getSettings().rowHeaders){const W=ZF(e,h,g);i.set(l,W/g)}const C=n.getRenderableFromVisualIndex(l),A=r.getRenderableFromVisualIndex(u),_=w-C+1,$=y-A+1;let I=n.getNearestNotHiddenIndex(h,1),M=r.getNearestNotHiddenIndex(d,1);if(E){const W=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(W)||(I=Math.max(I,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(W)||(M=Math.max(M,e.getFirstRenderedVisibleColumn()))}const G=Math.min(g,_),V=Math.min(f,$);I===l&&M===u?(a.setAttribute("rowspan",G),a.setAttribute("colspan",V)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function vye(t,e){QF(t,e),e.add(t)}function ep(t,e,n){QF(t,e),e.set(t,n)}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zb(t,e,n){return(e=yye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yye(t){var e=Cye(t,"string");return typeof e=="symbol"?e:e+""}function Cye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nf(t,e,n){return t.set(ct(t,e),n),n}function vt(t,e){return t.get(ct(t,e))}function ct(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeMergeCells");ie.getSingleton().register("afterMergeCells");ie.getSingleton().register("beforeUnmergeCells");ie.getSingleton().register("afterUnmergeCells");const ZR="mergeCells",bye=150,W1=ZR;var fi=new WeakMap,gi=new WeakMap,Ho=new WeakMap,B1=new WeakMap,pt=new WeakSet;class Sye extends qe{constructor(){super(...arguments),vye(this,pt),Zb(this,"mergedCellsCollection",null),Zb(this,"autofillCalculations",null),Zb(this,"selectionCalculations",null),ep(this,fi,null),ep(this,gi,{row:0,col:0}),ep(this,Ho,new pye({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),ep(this,B1,wye(this))}static get PLUGIN_KEY(){return ZR}static get PLUGIN_PRIORITY(){return bye}static get DEFAULT_SETTINGS(){return{[yL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[ZR]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Yw(this),this.autofillCalculations=new lye(this),this.selectionCalculations=new hye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Rye).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Tye).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Mye).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,_ye).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Pye).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,U1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,U1).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Oye).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Iye).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Aye).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,j1).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,j1).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Eye).call(e,...r)}),this.addHook("afterRenderer",function(){return vt(B1,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,xye).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Hye).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Nye).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Dye).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,kye).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,$ye).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Lye).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Fye).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Vye).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Wye).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Bye).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,jye).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Uye).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,zye).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ct(pt,e,Yye).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!EE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=vf(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=vf(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?To.containsNegativeValues(e)?(et(To.NEGATIVE_VALUES_WARNING(e)),!1):To.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(et(To.IS_OUT_OF_BOUNDS_WARNING(e)),!1):To.isSingleCell(e)?(et(To.IS_SINGLE_CELL(e)),!1):To.containsZeroSpan(e)?(et(To.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),T(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:W1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(W1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Rye(){this.generateFromSettings(),this.hot.render()}function Eye(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Tye(t){vt(gi,this).row=t.row,vt(gi,this).col=t.col}function Mye(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;vt(fi,this)&&(i.getRenderableFromVisualIndex(vt(fi,this).row)!==null&&(n.row=vt(fi,this).row),r.getRenderableFromVisualIndex(vt(fi,this).col)!==null&&(n.col=vt(fi,this).col),Nf(fi,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function _ye(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Pye(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Nf(fi,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Nf(fi,this,e.clone()),n&&e.assign(n)}function j1(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),w=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ye(g,u,h),Ye(w,c,d),Ye(this.hot.getLastRenderedVisibleRow(),u,h),Ye(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function xye(t){t.items.push({name:"---------"},dye(this))}function U1(){Nf(fi,this,null)}function Oye(){if(vt(fi,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=vt(fi,this).clone().normalize();vt(Ho,this).setActiveNode(r.row,r.col),vt(gi,this).row>0||vt(gi,this).col>0?vt(Ho,this).setPrevNodeAsActive():(n==="E-W"&&vt(gi,this).col<0||e==="S-N"&&vt(gi,this).row<0)&&vt(Ho,this).setNextNodeAsActive()}function Iye(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(vt(gi,this).col<0){const{rowEnd:a,colEnd:l}=vt(Ho,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(vt(gi,this).col>0){const{rowStart:a,colStart:l}=vt(Ho,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(vt(gi,this).row<0){const{rowEnd:a,colEnd:l}=vt(Ho,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(vt(gi,this).row>0){const{rowStart:a,colStart:l}=vt(Ho,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}vt(Ho,this).setActiveNode(t,e),Nf(gi,this,{row:0,col:0})}function Aye(){this.hot.getSelectedRangeLast().isHeader()||vt(Ho,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Hye(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Nye(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Dye(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function kye(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function $ye(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Lye(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Fye(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Vye(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Wye(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Bye(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);T(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function jye(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Uye(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function zye(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function Yye(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,ZF(this.hot,e,g))}),t}function Gye(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:xL(u.type))(l,u,d)(c,h);if(g===Fo){const w=a+1;if(typeof e[w]<"u")return s(w)}return g}(0)}}const eV="sort";function Kye(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${eV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function qye(t){const e=t.className.split(" "),n=new RegExp(`^${eV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Xye(t,e,n){return(e=Jye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jye(t){var e=Zye(t,"string");return typeof e=="symbol"?e:e+""}function Zye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Kw="multiColumnSorting",Qye=170,z1=Kw;PL(Kw,Gye);class eCe extends LL{constructor(){super(...arguments),Xye(this,"pluginKey",Kw)}static get PLUGIN_KEY(){return Kw}static get PLUGIN_PRIORITY(){return Qye}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,xw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Ua,position:"before",group:z1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(z1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),pe(e,qye(e)),this.enabled!==!1&&q(e,Kye(...r))}onAfterOnCellMouseDown(e,n){e_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,xw))):this.sort(this.getColumnNextConfig(n.col)))}}function Y1(t,e,n){return(e=tCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tCe(t){var e=nCe(t,"string");return typeof e=="symbol"?e:e+""}function nCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rCe="multipleSelectionHandles",iCe=160;class oCe extends qe{constructor(){super(...arguments),Y1(this,"dragged",[]),Y1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return rCe}static get PLUGIN_PRIORITY(){return iCe}isEnabled(){return ko()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(we(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(we(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(we(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(we(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function QR(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function tV(){return{label:"",isPlaceholder:!0}}function sCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;T(t,i=>{const o=[];let s=0;n.push(o),T(i,a=>{const l=QR();if(De(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Rt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Rt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(tV());return!u})});const r=Math.max(...Ue(n,i=>i.length));return T(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>QR());i.splice(i.length,0,...o)}}),n}function Qb(t,e,n){aCe(t,e),e.set(t,n)}function aCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hi(t,e){return t.get(nV(t,e))}function pd(t,e,n){return t.set(nV(t,e),n),n}function nV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const G1=["label","collapsible"];var cs=new WeakMap,Il=new WeakMap,eS=new WeakMap;class lCe{constructor(){Qb(this,cs,[]),Qb(this,Il,0),Qb(this,eS,1/0)}setColumnsLimit(e){pd(eS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];pd(cs,this,sCe(e,Hi(eS,this))),pd(Il,this,Hi(cs,this).length)}getData(){return Hi(cs,this)}mergeWith(e){T(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&on(s,o,G1)})}map(e){T(Hi(cs,this),n=>{T(n,r=>{const i=e({...r});De(i)&&on(r,i,G1)})})}getHeaderSettings(e,n){var r;if(e>=Hi(Il,this)||e<0)return null;const i=Hi(cs,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Hi(Il,this)||e<0)return i;const o=Hi(cs,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Hi(Il,this)}getColumnsCount(){return Hi(Il,this)>0?Hi(cs,this)[0].length:0}clear(){pd(cs,this,[]),pd(Il,this,0)}}function tS(t,e,n){return(e=uCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uCe(t){var e=cCe(t,"string");return typeof e=="symbol"?e:e+""}function cCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rV="DF-pre-order";function iV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=iV.call(this.childs[r],t,e)}return n}const hCe="DF-post-order";function oV(t,e){for(let n=0;n<this.childs.length;n++)if(oV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const sV="BF";function dCe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const fCe=sV,K1=new Map([[rV,iV],[hCe,oV],[sV,dCe]]);class qw{constructor(e){tS(this,"data",{}),tS(this,"parent",null),tS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new qw({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fCe;if(!K1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);K1.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function nS(t,e,n){gCe(t,e),e.set(t,n)}function gCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tr(t,e){return t.get(aV(t,e))}function mCe(t,e,n){return t.set(aV(t,e),n),n}function aV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oc=new WeakMap,Al=new WeakMap,sc=new WeakMap;class pCe{constructor(e){nS(this,oc,new Map),nS(this,Al,new Map),nS(this,sc,null),mCe(sc,this,e)}getRoots(){return Array.from(tr(oc,this).values())}getRootByColumn(e){let n;return tr(Al,this).has(e)&&(n=tr(oc,this).get(tr(Al,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-tr(Al,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;tr(Al,this).clear(),T(tr(oc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)tr(Al,this).set(i,e);e+=r})}buildTree(){this.clear();const e=tr(sc,this).getColumnsCount();let n=0;for(;n<e;){const r=tr(sc,this).getHeaderSettings(0,n),i=new qw;tr(oc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=tr(sc,this).getHeadersSettings(r,n,i);r+=1,T(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new qw(a),e.addChild(l)),r<tr(sc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){tr(oc,this).clear(),tr(Al,this).clear()}}function lV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Xw(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Jw(t){return Xw(t,"origColspan")===t.data.origColspan}function m_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Jw(t))return m_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)T(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,lV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Jw(a)&&(l.isCollapsed=Xw(a,"isCollapsed"))}),{rollbackModification:()=>p_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function p_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Jw(t))return p_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)T(o,l=>{lV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Xw(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Jw(l)&&(u.isCollapsed=Xw(l,"isCollapsed"))}),{rollbackModification:()=>m_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function wCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ut`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function vCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ut`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const q1=new Map([["collapse",p_],["expand",m_],["hide-column",wCe],["show-column",vCe]]);function yCe(t,e,n){if(!q1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return q1.get(t)(e,n)}function tp(t){const e=[];return T(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=bCe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(tV());else{const f=CCe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function CCe(t){const{crossHiddenColumns:e,...n}=QR(t);return n}function bCe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function rS(t,e,n){SCe(t,e),e.set(t,n)}function SCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wd(t,e,n){return t.set(uV(t,e),n),n}function $t(t,e){return t.get(uV(t,e))}function uV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vo=new WeakMap,vr=new WeakMap,Hl=new WeakMap;class RCe{constructor(){rS(this,vo,new lCe),rS(this,vr,new pCe($t(vo,this))),rS(this,Hl,[[]])}setState(e){$t(vo,this).setData(e);let n=!1;try{$t(vr,this).buildTree()}catch{$t(vr,this).clear(),$t(vo,this).clear(),n=!0}return wd(Hl,this,tp($t(vr,this).getRoots())),n}setColumnsLimit(e){$t(vo,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});$t(vo,this).mergeWith(n),$t(vr,this).buildTree(),wd(Hl,this,tp($t(vr,this).getRoots()))}mapState(e){$t(vo,this).map(e),$t(vr,this).buildTree(),wd(Hl,this,tp($t(vr,this).getRoots()))}mapNodes(e){return vn($t(vr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=$t(vr,this).getNode(n,r);let o;return i&&(o=yCe(e,i,r),wd(Hl,this,tp($t(vr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=$t(Hl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=$t(vr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=$t(vr,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},rV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return $t(vo,this).getLayersCount()}getColumnsCount(){return $t(vo,this).getColumnsCount()}clear(){wd(Hl,this,[]),$t(vo,this).clear(),$t(vr,this).clear()}}function vd(t,e,n){return(e=ECe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ECe(t){var e=TCe(t,"string");return typeof e=="symbol"?e:e+""}function TCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MCe{constructor(e,n){vd(this,"hot",void 0),vd(this,"nestedHeaderSettingsGetter",void 0),vd(this,"layersCount",0),vd(this,"container",void 0),vd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),bu(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function _Ce(t,e){cV(t,e),e.add(t)}function X1(t,e,n){return(e=PCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PCe(t){var e=xCe(t,"string");return typeof e=="symbol"?e:e+""}function xCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yd(t,e,n){cV(t,e),e.set(t,n)}function cV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xs(t,e,n){return t.set(Lt(t,e),n),n}function je(t,e){return t.get(Lt(t,e))}function Lt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const J1="nestedHeaders",OCe=280;var dt=new WeakMap,oa=new WeakMap,rf=new WeakMap,uy=new WeakMap,Zw=new WeakMap,zt=new WeakSet;class ICe extends qe{constructor(){super(...arguments),_Ce(this,zt),yd(this,dt,new RCe),yd(this,oa,null),yd(this,rf,null),yd(this,uy,!1),yd(this,Zw,null),X1(this,"ghostTable",new MCe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),X1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return J1}static get PLUGIN_PRIORITY(){return OCe}isEnabled(){return!!this.hot.getSettings()[J1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&et(ut`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Lt(zt,this,GCe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,KCe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,DCe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,kCe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,$Ce).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,LCe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,FCe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,VCe).call(e,...i)}),this.addHook("afterSelection",()=>Lt(zt,this,np).call(this)),this.addHook("afterSelectionFocusSet",()=>Lt(zt,this,np).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,ACe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Lt(zt,this,BCe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,UCe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,zCe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,HCe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,NCe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,WCe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,jCe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lt(zt,e,YCe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Lt(zt,this,np).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Lt(zt,this,np).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();je(dt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=je(dt,this).setState(e)),this.detectedOverlappedHeaders&&et(ut`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";je(dt,this).triggerColumnModification(i,r)}),!je(oa,this)&&this.enabled&&xs(oa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";je(dt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),je(dt,this).clear(),je(oa,this).unsubscribe(),xs(oa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return je(dt,this)}getLayersCount(){return je(dt,this).getLayersCount()}getHeaderSettings(e,n){return je(dt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),pe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),pe(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),pe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),pe(o,"hiddenHeader"),pe(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=je(dt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,w,y;const{wtOverlays:E}=l._wt,C=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),A=(w=E.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o);((y=E.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const $=C||A?Math.min(c,r-i):c;$>1&&o.setAttribute("colspan",$)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(pe(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=je(dt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){xs(dt,this,null),je(oa,this)!==null&&(je(oa,this).unsubscribe(),xs(oa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return je(dt,this).getHeaderTreeNodeData(e.row,e.col)}}function np(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=je(dt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function ACe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=je(Zw,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(xs(Zw,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=je(dt,this).findLeftMostColumnIndex(a,l),g=je(dt,this).findRightMostColumnIndex(a,l),w=g-f+1;if(f<c&&g>h)return f;if(s){let y=null;return f>=c&&g>h?w>d?(e.value="start",y=f):(e.value="end",y=g):f<c&&g<=h&&(w>d?(e.value="end",y=g):(e.value="start",y=f)),y}return f<=c?f:g}function HCe(t,e,n){const r=je(dt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=je(dt,this).getHeaderSettings(e,t);if(o===BE){if(!a)return r.columnIndex}else if(o===c$&&(l>s-i||!a))return null;return t}function NCe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,w=d-a;if(w===0)continue;((i=je(dt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][w]="")}}}function DCe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function kCe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;xs(rf,this,e.clone()),xs(uy,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Av(t)||La(t)&&l||$k(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function $Ce(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ye(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function LCe(){xs(uy,this,!1)}function FCe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!je(uy,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=je(dt,this).getHeaderTreeNodeData(je(rf,this).row,je(rf,this).col);if(e.setHighlight(je(rf,this)),o>e.getWidth()||i<n||i+o-1>r){const s=je(dt,this).findTopMostEntireHeaderLevel(Ye(n,i,i+o-1),Ye(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function VCe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=je(dt,this).findLeftMostColumnIndex(n.row,n.col),o=je(dt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function WCe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});xs(Zw,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function BCe(t){if(je(dt,this).getLayersCount()>0){t.length=0;for(let e=0;e<je(dt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function jCe(t){const e=je(dt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=je(dt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Un(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?je(dt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function UCe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function zCe(t,e,n){var r;const{label:i}=(r=je(dt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function YCe(t,e){if(t<0)return this.hot.getCell(t,je(dt,this).findLeftMostColumnIndex(t,e),!0)}function GCe(){this.updatePlugin()}function KCe(t,e){e||this.updatePlugin()}function Cd(t,e,n){return(e=qCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qCe(t){var e=XCe(t,"string");return typeof e=="symbol"?e:e+""}function XCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JCe{constructor(e,n){Cd(this,"hot",void 0),Cd(this,"data",null),Cd(this,"plugin",void 0),Cd(this,"parentReference",new WeakMap),Cd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&T(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&T(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ke(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(T(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];T(r,o=>{i.push(this.getDataObject(o))}),T(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function Z1(t,e,n){return(e=ZCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZCe(t){var e=QCe(t,"string");return typeof e=="symbol"?e:e+""}function QCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w_{constructor(e,n){Z1(this,"hot",void 0),Z1(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Po extends w_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(T(l,c=>{c&&s.removeChild(c)}),q(n,Po.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");q(d,Po.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ce(c,[yu()]),q(n,Po.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${Po.CSS_CLASSES.button} ${Po.CSS_CLASSES.expandButton}`),u&&Ce(n,[mi(!1)])):(q(c,`${Po.CSS_CLASSES.button} ${Po.CSS_CLASSES.collapseButton}`),u&&Ce(n,[mi(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class ebe extends w_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),T(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&T(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&T(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&T(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);we(e.target,Po.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ei(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function tbe(t,e,n){nbe(t,e),e.set(t,n)}function nbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rbe(t,e,n){return(e=ibe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ibe(t){var e=obe(t,"string");return typeof e=="symbol"?e:e+""}function obe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sbe(t,e){return t.get(abe(t,e))}function abe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Q1=new WeakMap;class lbe extends w_{constructor(){super(...arguments),rbe(this,"dataManager",this.plugin.dataManager),tbe(this,Q1,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(UT)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(zT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return T(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=sbe(Q1,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function rp(t,e,n){return(e=ube(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ube(t){var e=cbe(t,"string");return typeof e=="symbol"?e:e+""}function cbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hbe{constructor(e){rp(this,"plugin",void 0),rp(this,"hot",void 0),rp(this,"dataManager",void 0),rp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return It(i)&&(et(ut`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function dbe(t,e){hV(t,e),e.add(t)}function eA(t,e,n){hV(t,e),e.set(t,n)}function hV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iS(t,e,n){return(e=fbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fbe(t){var e=gbe(t,"string");return typeof e=="symbol"?e:e+""}function gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vp(t,e){return t.get(bn(t,e))}function Qw(t,e,n){return t.set(bn(t,e),n),n}function bn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ev="nestedRows",mbe=300,tA=ev,pbe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var cy=new WeakMap,ac=new WeakMap,_n=new WeakSet;class wbe extends qe{constructor(){super(...arguments),dbe(this,_n),iS(this,"dataManager",null),iS(this,"headersUI",null),iS(this,"collapsedRowsMap",null),eA(this,cy,!1),eA(this,ac,!1)}static get PLUGIN_KEY(){return ev}static get PLUGIN_PRIORITY(){return mbe}isEnabled(){return!!this.hot.getSettings()[ev]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new ug),this.dataManager=new JCe(this,this.hot),this.collapsingUI=new ebe(this,this.hot),this.headersUI=new Po(this,this.hot),this.contextMenuUI=new lbe(this,this.hot),this.rowMoveController=new hbe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Ibe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Abe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Cbe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,bbe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Sbe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,ybe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Tbe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Ebe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Mbe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,_be).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Pbe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,xbe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Rbe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,Obe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bn(_n,e,vbe).call(e,...r)}),this.addHook("beforeLoadData",n=>bn(_n,this,nA).call(this,n)),this.addHook("beforeUpdateData",n=>bn(_n,this,nA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:tA,relativeToGroup:Ua,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tA)}disableCoreAPIModifiers(){Qw(ac,this,!0)}enableCoreAPIModifiers(){Qw(ac,this,!1)}onModifyRowData(e){if(!Vp(ac,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Vp(ac,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Vp(ac,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function vbe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function ybe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Cbe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Qw(cy,this,!0),this.dataManager.getData().slice()}function bbe(t){return this.contextMenuUI.appendOptions(t)}function Sbe(t,e){this.headersUI.appendLevelIndicators(t,e)}function Rbe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Ebe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Qw(cy,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Tbe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Mbe(){this.collapsingUI.collapsedRowsStash.stash()}function _be(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Pbe(){this.collapsingUI.collapsedRowsStash.stash()}function xbe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Obe(){this.dataManager.rewriteCache()}function Ibe(){this.headersUI.updateRowHeaderWidth()}function Abe(t,e){Vp(cy,this)&&(e.skipRender=!0)}function nA(t){if(!b$(t)){PE(pbe),this.hot.getSettings()[ev]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function oS(t,e,n){return(e=Hbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hbe(t){var e=Nbe(t,"string");return typeof e=="symbol"?e:e+""}function Nbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dbe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;oS(this,"rootWindow",void 0),oS(this,"prefix",void 0),oS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){T(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function kbe(t,e,n){return(e=$be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $be(t){var e=Lbe(t,"string");return typeof e=="symbol"?e:e+""}function Lbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ie.getSingleton().register("persistentStateSave");ie.getSingleton().register("persistentStateLoad");ie.getSingleton().register("persistentStateReset");const rA="persistentState",Fbe=0;class Vbe extends qe{constructor(){super(...arguments),kbe(this,"storage",void 0)}static get PLUGIN_KEY(){return rA}static get PLUGIN_PRIORITY(){return Fbe}isEnabled(){return!!this.hot.getSettings()[rA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Dbe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Wbe(t,e){Bbe(t,e),e.add(t)}function Bbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sS(t,e,n){return(e=jbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jbe(t){var e=Ube(t,"string");return typeof e=="symbol"?e:e+""}function Ube(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aS="search",zbe=190,Ybe="htSearchResult",Gbe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Kbe=function(t,e,n){return It(t)||t===null||!t.toLocaleLowerCase||t.length===0||It(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var lS=new WeakSet;class qbe extends qe{constructor(){super(...arguments),Wbe(this,lS),sS(this,"callback",Gbe),sS(this,"queryMethod",Kbe),sS(this,"searchResultClass",Ybe)}static get PLUGIN_KEY(){return aS}static get PLUGIN_PRIORITY(){return zbe}isEnabled(){return this.hot.getSettings()[aS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[aS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return iA(lS,e,oA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return iA(lS,e,oA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){De(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function oA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function ip(t,e,n){return(e=Xbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xbe(t){var e=Jbe(t,"string");return typeof e=="symbol"?e:e+""}function Jbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dV{constructor(e){ip(this,"viewportWidth",void 0),ip(this,"overwriteColumnWidthFn",void 0),ip(this,"baseWidths",new Map),ip(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Zbe extends dV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=jc?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=jc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,w=g;o.includes(f)||(w=Math.round(g*l)),this.stretchedWidths.set(f,w),u=f,d<i.length-1&&(c+=w)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function sA(t,e,n){Qbe(t,e),e.set(t,n)}function Qbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uS(t,e){return t.get(fV(t,e))}function op(t,e,n){return t.set(fV(t,e),n),n}function fV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sp=new WeakMap,bd=new WeakMap;class eSe extends dV{constructor(){super(...arguments),sA(this,sp,0),sA(this,bd,-1)}prepare(e){super.prepare(e),op(sp,this,0),op(bd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),op(bd,this,e),op(sp,this,n)}calculate(){if(uS(bd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+uS(sp,this),0);this.stretchedWidths.set(uS(bd,this),n)}}function tSe(t,e){gV(t,e),e.add(t)}function ap(t,e,n){gV(t,e),e.set(t,n)}function gV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(t,e){return t.get(Ec(t,e))}function cS(t,e,n){return t.set(Ec(t,e),n),n}function Ec(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nSe="stretchColumns";var jn=new WeakMap,lc=new WeakMap,hS=new WeakMap,lp=new WeakMap,Sd=new WeakSet;class rSe{constructor(e){tSe(this,Sd),ap(this,jn,void 0),ap(this,lc,void 0),ap(this,hS,new Map([["all",new Zbe(Ec(Sd,this,aA).bind(this))],["last",new eSe(Ec(Sd,this,aA).bind(this))]])),ap(this,lp,"none"),cS(jn,this,e),cS(lc,this,Yt(jn,this).columnIndexMapper.createAndRegisterIndexMap(nSe,"physicalIndexToValue"))}useStrategy(e){cS(lp,this,Yt(hS,this).has(e)?e:"none")}refreshStretching(){if(Yt(lp,this)==="none"){Yt(lc,this).clear();return}Yt(jn,this).batchExecution(()=>{Yt(lc,this).clear();const e=Yt(hS,this).get(Yt(lp,this));let r=Yt(jn,this).view.getViewportWidth();Ec(Sd,this,iSe).call(this)&&(r-=Rn(Yt(jn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Yt(jn,this).countCols();i++)Yt(jn,this).columnIndexMapper.isHidden(Yt(jn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Ec(Sd,this,oSe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Yt(lc,this).setValueAtIndex(Yt(jn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Yt(lc,this).getValueAtIndex(Yt(jn,this).toPhysicalColumn(e))}}function iSe(){const{view:t}=Yt(jn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Yt(jn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=Yt(jn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function oSe(t){var e;return(e=Yt(jn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:jc}function aA(t,e){return Yt(jn,this).runHooks("beforeStretchingColumnWidth",t,e)}function sSe(t,e){mV(t,e),e.add(t)}function dS(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fS(t,e,n){return t.set(tv(t,e),n),n}function ms(t,e){return t.get(tv(t,e))}function tv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aSe="stretchColumns",lSe=155;var wc=new WeakMap,up=new WeakMap,Rd=new WeakMap,gS=new WeakSet;class uSe extends qe{constructor(){super(...arguments),sSe(this,gS),dS(this,wc,new rSe(this.hot)),dS(this,up,null),dS(this,Rd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;ms(up,this)!==null&&ms(up,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),fS(up,this,i.width)})})}))}static get PLUGIN_KEY(){return aSe}static get PLUGIN_PRIORITY(){return lSe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(ms(wc,this).useStrategy(this.hot.getSettings().stretchH),ms(Rd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return tv(gS,e,hSe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return tv(gS,e,cSe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){ms(wc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),ms(Rd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return ms(wc,this).getStretchedWidth(e)}destroy(){ms(Rd,this).disconnect(),fS(Rd,this,null),fS(wc,this,null),super.destroy()}}function cSe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function hSe(t){t&&ms(wc,this).refreshStretching()}function dSe(t,e){fSe(t,e),e.add(t)}function fSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cp(t,e,n){return(e=gSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gSe(t){var e=mSe(t,"string");return typeof e=="symbol"?e:e+""}function mSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pSe="touchScroll",wSe=200;var hp=new WeakSet;class vSe extends qe{constructor(){super(...arguments),dSe(this,hp),cp(this,"scrollbars",[]),cp(this,"clones",[]),cp(this,"lockedCollection",!1),cp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return pSe}static get PLUGIN_PRIORITY(){return wSe}static get SETTING_KEYS(){return!0}isEnabled(){return RE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>mS(hp,this,ySe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>mS(hp,this,CSe).call(this)),this.addHook("afterMomentumScroll",()=>mS(hp,this,bSe).call(this))}}function ySe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function CSe(){this.freezeOverlays=!0,T(this.clones,t=>{q(t,"hide-tween")})}function bSe(){this.freezeOverlays=!1,T(this.clones,t=>{pe(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{T(this.clones,t=>{pe(t,"show-tween")})},400),T(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function SSe(t,e){RSe(t,e),e.add(t)}function RSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ESe(t,e,n){return(e=TSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TSe(t){var e=MSe(t,"string");return typeof e=="symbol"?e:e+""}function MSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _Se(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wp="trimRows",PSe=330;var lA=new WeakSet;class xSe extends qe{constructor(){super(...arguments),SSe(this,lA),ESe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Wp}static get PLUGIN_PRIORITY(){return PSe}isEnabled(){return!!this.hot.getSettings()[Wp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new ug),this.trimmedRowsMap.addLocalHook("init",()=>_Se(lA,this,OSe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Wp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),T(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(T(e,l=>{o[l]=!1}),i=vn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function OSe(){const t=this.hot.getSettings()[Wp];Array.isArray(t)&&this.hot.batchExecution(()=>{T(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function ISe(t,e,n){return(e=ASe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ASe(t){var e=HSe(t,"string");return typeof e=="symbol"?e:e+""}function HSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ti{constructor(e){ISe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function dp(t,e,n){return(e=NSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NSe(t){var e=DSe(t,"string");return typeof e=="symbol"?e:e+""}function DSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v_ extends Ti{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),dp(this,"stateBefore",void 0),dp(this,"range",void 0),dp(this,"type",void 0),dp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new v_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){T(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){la(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function uA(t,e,n){return(e=kSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kSe(t){var e=$Se(t,"string");return typeof e=="symbol"?e:e+""}function $Se(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y_ extends Ti{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),uA(this,"columns",void 0),uA(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new y_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),f_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function cA(t,e,n){return(e=LSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LSe(t){var e=FSe(t,"string");return typeof e=="symbol"?e:e+""}function FSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C_ extends Ti{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),cA(this,"previousSortState",void 0),cA(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new C_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function hA(t,e,n){return(e=VSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VSe(t){var e=WSe(t,"string");return typeof e=="symbol"?e:e+""}function WSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b_ extends Ti{constructor(e){let{index:n,amount:r}=e;super("insert_col"),hA(this,"index",void 0),hA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new b_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function dA(t,e,n){return(e=BSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BSe(t){var e=jSe(t,"string");return typeof e=="symbol"?e:e+""}function jSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S_ extends Ti{constructor(e){let{index:n,amount:r}=e;super("insert_row"),dA(this,"index",void 0),dA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new S_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function fp(t,e,n){return(e=USe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function USe(t){var e=zSe(t,"string");return typeof e=="symbol"?e:e+""}function zSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R_ extends Ti{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),fp(this,"changes",void 0),fp(this,"selected",void 0),fp(this,"countCols",void 0),fp(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new R_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Xn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Xn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function fA(t,e,n){return(e=YSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YSe(t){var e=GSe(t,"string");return typeof e=="symbol"?e:e+""}function GSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E_ extends Ti{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),fA(this,"conditionsStack",void 0),fA(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new E_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function KSe(t,e,n){return(e=qSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qSe(t){var e=XSe(t,"string");return typeof e=="symbol"?e:e+""}function XSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T_ extends Ti{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),KSe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new T_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function pV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function hs(t,e,n){return(e=JSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JSe(t){var e=ZSe(t,"string");return typeof e=="symbol"?e:e+""}function ZSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M_ extends Ti{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),hs(this,"index",void 0),hs(this,"indexes",void 0),hs(this,"data",void 0),hs(this,"amount",void 0),hs(this,"headers",void 0),hs(this,"columnPositions",void 0),hs(this,"rowPositions",void 0),hs(this,"fixedColumnsStart",void 0),hs(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const w=[],y=l[g];fe(u,c,E=>{w.push(y[e.toPhysicalColumn(E)])}),h.push(w)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new M_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:pV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ue(this.data[c],o));const l=Ue(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),T(e.getSourceDataArray(),(c,h)=>{T(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&T(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function uc(t,e,n){return(e=QSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QSe(t){var e=eRe(t,"string");return typeof e=="symbol"?e:e+""}function eRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class __ extends Ti{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),uc(this,"index",void 0),uc(this,"data",void 0),uc(this,"fixedRowsBottom",void 0),uc(this,"fixedRowsTop",void 0),uc(this,"rowIndexesSequence",void 0),uc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Xn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new __({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:pV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function gA(t,e,n){return(e=tRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tRe(t){var e=nRe(t,"string");return typeof e=="symbol"?e:e+""}function nRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P_ extends Ti{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),gA(this,"rows",void 0),gA(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new P_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),f_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function rRe(t,e,n){return(e=iRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iRe(t){var e=oRe(t,"string");return typeof e=="symbol"?e:e+""}function oRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x_ extends Ti{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),rRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new x_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function sRe(t,e){[v_,y_,C_,b_,S_,R_,E_,T_,M_,__,P_,x_].forEach(n=>n.startRegisteringEvents(t,e))}function aRe(t,e){lRe(t,e),e.add(t)}function lRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pS(t,e,n){return(e=uRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uRe(t){var e=cRe(t,"string");return typeof e=="symbol"?e:e+""}function cRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mA="undoRedo",hRe="undoRedo",dRe=1e3;ie.getSingleton().register("beforeUndo");ie.getSingleton().register("afterUndo");ie.getSingleton().register("beforeRedo");ie.getSingleton().register("afterRedo");const pA=new Set;var gp=new WeakSet;class fRe extends qe{static get PLUGIN_KEY(){return hRe}static get PLUGIN_PRIORITY(){return dRe}static get SETTING_KEYS(){return!0}constructor(e){super(e),aRe(this,gp),pS(this,"doneActions",[]),pS(this,"undoneActions",[]),pS(this,"ignoreNewActions",!1),sRe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wS(gp,e,gRe).call(e,...r)}),this.registerShortcuts(),wS(gp,this,mRe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),wS(gp,this,pRe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:mA};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mA)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Xn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Xn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function gRe(t,e){e==="loadData"&&this.clear()}function mRe(){const t=e=>{pA.has(e)||(et(ut`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),pA.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function pRe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function wRe(){Ke(Bd),Ke(Rue),Ke(jd),Ke(ece),Ke(lce),Ke(LL),Ke(rhe),Ke(Whe),Ke(ry),Ke(Xde),Ke(Sfe),Ke(Ofe),Ke(sy),Ke(dge),Ke(ape),Ke(Vpe),Ke(fwe),Ke(Twe),Ke($we),Ke(Kwe),Ke(ive),Ke(Sve),Ke(Ive),Ke(Sye),Ke(eCe),Ke(oCe),Ke(ICe),Ke(wbe),Ke(Vbe),Ke(qbe),Ke(uSe),Ke(vSe),Ke(xSe),Ke(fRe)}function vRe(){Gse(),ple(),Tle(),zle(),wRe()}function yRe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var vS,yS,CS,bS,SS;vRe();yRe(Ee);Ee.__GhostTable=JM;Ee._getListenersCounter=KJ;Ee._getRegisteredMapsCounter=gre;Ee.EventManager=vi;const CRe=[X9,iJ,Gne,vle,tJ,L8,e8,YZ,eJ,n8,aJ,zZ],bRe=[N8,lJ];Ee.helper={};Ee.dom={};T(CRe,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ee.helper[e]=t[e])})});T(bRe,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ee.dom[e]=t[e])})});Ee.cellTypes=(vS=Ee.cellTypes)!==null&&vS!==void 0?vS:{};T(yie(),t=>{Ee.cellTypes[t]=OM(t)});Ee.cellTypes.registerCellType=oi;Ee.cellTypes.getCellType=OM;Ee.editors=(yS=Ee.editors)!==null&&yS!==void 0?yS:{};T(BJ(),t=>{Ee.editors[`${qn(t)}Editor`]=ww(t)});Ee.editors.registerEditor=Rr;Ee.editors.getEditor=ww;Ee.renderers=(CS=Ee.renderers)!==null&&CS!==void 0?CS:{};T(aQ(),t=>{const e=vw(t);t==="base"&&(Ee.renderers.cellDecorator=e),Ee.renderers[`${qn(t)}Renderer`]=e});Ee.renderers.registerRenderer=Fr;Ee.renderers.getRenderer=vw;Ee.validators=(bS=Ee.validators)!==null&&bS!==void 0?bS:{};T(cQ(),t=>{Ee.validators[`${qn(t)}Validator`]=DE(t)});Ee.validators.registerValidator=Wl;Ee.validators.getValidator=DE;Ee.plugins=(SS=Ee.plugins)!==null&&SS!==void 0?SS:{};T(NE(),t=>{Ee.plugins[t]=og(t)});Ee.plugins[`${qn(qe.PLUGIN_KEY)}Plugin`]=qe;Ee.plugins.registerPlugin=Ke;Ee.plugins.getPlugin=og;let Bp=null;function Nl(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function of(){Bp&&(Bp.destroy(),Bp=null)}function SRe(t,e,n){const r=n.tableViewDomElement;of(),r&&(r.innerHTML="");let i=[],o=!0;const s=new Map;let a={row:-1,col:-1,time:0};const l=300,u={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback};if(Array.isArray(t)){const c=t.length>0?t[0]:null;c&&typeof c=="object"&&c!==null&&!Array.isArray(c)?(o=Object.keys(c),t.forEach((h,d)=>{const f=[],g=`${n.dataPathString}`;o.forEach((w,y)=>{const E=h[w],{displayValue:C,cellMeta:A}=Nl(E,`${g}[${d}]`,w,!1,u);f.push(C),s.set(`${d}-${y}`,A)}),i.push(f)})):(o=["Index","Value"],i=t.map((h,d)=>{const f=n.dataPathString,{displayValue:g,cellMeta:w}=Nl(d,f,String(d),!0,u),{displayValue:y,cellMeta:E}=Nl(h,f,String(d),!1,u);return s.set(`${d}-0`,w),s.set(`${d}-1`,E),[g,y]}))}else if(typeof t=="object"&&t!==null)o=["항목 (Key)","값 (Value)"],i=Object.entries(t).map(([c,h],d)=>{const f=n.dataPathString,{displayValue:g,cellMeta:w}=Nl(c,f,c,!0,u),{displayValue:y,cellMeta:E}=Nl(h,f,c,!1,u);return s.set(`${d}-0`,w),s.set(`${d}-1`,E),[g,y]});else{o=["항목","값"];const c=e||"Value",{displayValue:h,cellMeta:d}=Nl(c,n.dataPathString,"",!0,u),{displayValue:f,cellMeta:g}=Nl(t,n.dataPathString,"",!1,u);s.set("0-0",d),s.set("0-1",g),i=[[h,f]]}if(!r){console.error("Handsontable container not found.");return}Bp=new Ee(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입"},col_right:{name:"오른쪽에 열 삽입"},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제"},"---------":Ee.plugins.ContextMenu.SEPARATOR,duplicate_row:{name:"선택 행 복제",hidden:function(){return this.getSelectedRangeLast()?typeof t!="object"&&!Array.isArray(t):!0},callback:async function(c,h,d){const g=h[0].start.row;if(Array.isArray(t)){if(g>=0&&g<t.length){const w=JSON.parse(JSON.stringify(t[g]));t.splice(g+1,0,w),n.refreshTreeViewCallback("row_duplicated_array_hot"),n.displayTableCallback(t,e,n.rootJsonData,n.dataPathString)}}else if(typeof t=="object"&&t!==null){const w=Object.keys(t)[g];if(w===void 0)return;let y=w+"_복제본",E=y,C=1;for(;t.hasOwnProperty(E);)E=`${y}_${C}`,C++;const A=await Qt.fire({title:"새 키 이름 입력 (행 복제)",input:"text",inputValue:E,showCancelButton:!0,confirmButtonText:"복제",inputValidator:_=>!_||_.trim()===""?"키 이름은 비워둘 수 없습니다!":_.trim()!==w&&t.hasOwnProperty(_.trim())?"이미 사용 중인 키 이름입니다.":/^\d+$/.test(_.trim())?"키 이름은 숫자만으로 구성될 수 없습니다.":null});if(A.isConfirmed&&A.value){const _=A.value.trim(),$=JSON.parse(JSON.stringify(t[w])),I={};for(const M of Object.keys(t))I[M]=t[M],M===w&&(I[_]=$);Object.keys(t).forEach(M=>delete t[M]),Object.assign(t,I),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered"),n.displayTableCallback(t,e,n.rootJsonData,n.dataPathString)}}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null||typeof t=="object"&&t!==null&&!Array.isArray(t)):!0},callback:async function(c,h,d){const f=h[0],g=f.start.col,w=f.start.row;if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null){const y=this.getColHeader(),E=Array.isArray(y)?y[g]:null;if(!E||typeof E!="string")return;let C=E+"_복제본",A=C,_=1;if(t.length>0&&typeof t[0]=="object"&&t[0]!==null)for(;t[0].hasOwnProperty(A);)A=`${C}_${_}`,_++;else return;const $=await Qt.fire({title:"새 열 이름(키) 입력 (열 복제)",input:"text",inputValue:A,showCancelButton:!0,confirmButtonText:"복제",inputValidator:I=>!I||I.trim()===""?"키 이름은 비워둘 수 없습니다!":t.length>0&&t[0].hasOwnProperty(I.trim())&&I.trim()!==E?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(I.trim())?"키 이름은 숫자만으로 구성될 수 없습니다.":null});if($.isConfirmed&&$.value){const I=$.value.trim();t.forEach(M=>{if(typeof M=="object"&&M!==null){const G=M.hasOwnProperty(E)?JSON.parse(JSON.stringify(M[E])):null,V={};for(const W of Object.keys(M))V[W]=M[W],W===E&&(V[I]=G);V.hasOwnProperty(I)||(V[I]=G),Object.keys(M).forEach(W=>delete M[W]),Object.assign(M,V)}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered"),n.displayTableCallback(t,e,n.rootJsonData,n.dataPathString)}}else if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const y=Object.keys(t)[w];if(y===void 0)return;let E=y+"_복제본",C=E,A=1;for(;t.hasOwnProperty(C);)C=`${E}_${A}`,A++;const _=await Qt.fire({title:"새 키 이름 입력 (열 복제는 행 복제와 동일)",input:"text",inputValue:C,showCancelButton:!0,confirmButtonText:"복제",inputValidator:$=>!$||$.trim()===""?"키 이름은 비워둘 수 없습니다!":$.trim()!==y&&t.hasOwnProperty($.trim())?"이미 사용 중인 키 이름입니다.":/^\d+$/.test($.trim())?"키 이름은 숫자만으로 구성될 수 없습니다.":null});if(_.isConfirmed&&_.value){const $=_.value.trim(),I=JSON.parse(JSON.stringify(t[y])),M={};for(const G of Object.keys(t))M[G]=t[G],G===y&&(M[$]=I);Object.keys(t).forEach(G=>delete t[G]),Object.assign(t,M),n.refreshTreeViewCallback("col_as_row_duplicated_object_hot"),n.displayTableCallback(t,e,n.rootJsonData,n.dataPathString)}}}},make_array:{name:"값을 빈 배열 [] 로 변경",hidden:function(){const c=this.getSelectedRangeLast();if(!c)return!0;const h=c.from.col;return!(typeof t=="object"&&t!==null&&!Array.isArray(t)&&h===0)},callback:function(c,h,d){const f=h[0].start.row,g=s.get(`${f}-0`);g&&g.originalKey&&typeof t=="object"&&t!==null&&(t[g.originalKey]=[],n.refreshTreeViewCallback("value_to_array_hot"),n.displayTableCallback(t,e,n.rootJsonData,n.dataPathString))}},make_object:{name:"값을 빈 객체 {} 로 변경",hidden:function(){const c=this.getSelectedRangeLast();if(!c)return!0;const h=c.from.col;return!(typeof t=="object"&&t!==null&&!Array.isArray(t)&&h===0)},callback:function(c,h,d){const f=h[0].start.row,g=s.get(`${f}-0`);g&&g.originalKey&&typeof t=="object"&&t!==null&&(t[g.originalKey]={},n.refreshTreeViewCallback("value_to_object_hot"),n.displayTableCallback(t,e,n.rootJsonData,n.dataPathString))}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(c,h,d){const f={},g=s.get(`${c}-${h}`);return g&&(f.readOnly=g.readOnly,g.isDrillable&&(f.renderer=function(w,y,E,C,A,_,$){Ee.renderers.TextRenderer.apply(this,arguments),y.style.color="#007bff",y.style.textDecoration="underline",y.style.cursor="pointer"})),f},afterOnCellMouseDown:function(c,h,d){if(c.button!==0)return;const f=new Date().getTime(),{row:g,col:w}=h,y=s.get(`${g}-${w}`);let E=!1;if(y&&g===a.row&&w===a.col&&f-a.time<l?(E=!0,a={row:-1,col:-1,time:0}):a={row:g,col:w,time:f},E){let C=!1;const A=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(A)&&A[0]==="항목 (Key)"&&w===0&&y&&(C=!0),C){const _=y.originalKey,$=t,I=n.dataPathString;Qt.fire({title:`키 이름 변경: "${_}"`,input:"text",inputValue:_,showCancelButton:!0,confirmButtonText:"저장",cancelButtonText:"취소",customClass:{popup:"custom-swal-popup"},inputValidator:M=>{if(!M||M.trim()==="")return"키 이름은 비워둘 수 없습니다!";const G=M.trim();return/^\d+$/.test(G)?"키 이름은 숫자만으로 구성될 수 없습니다!":$.hasOwnProperty(G)&&G!==_?"이미 사용 중인 키 이름입니다!":null}}).then(M=>{if(M.isConfirmed&&M.value){const G=M.value.trim();G!==_&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(I,_,G,$)}});return}return}y&&y.isDrillable&&y.originalValue!==void 0&&(typeof y.originalValue=="object"&&y.originalValue!==null||Array.isArray(y.originalValue))&&n.displayTableCallback(y.originalValue,y.originalKey,n.rootJsonData,y.drillPath)},afterChange:function(c,h){if(h==="loadData"||!c||!Array.isArray(c)||c.length===0)return;const d=h==="CopyPaste.paste"||h==="Autofill.fill"||c.length>1,f=this.getColHeader();c.forEach(([g,w,y,E])=>{let C=-1;if(typeof w=="number"?C=w:typeof w=="string"&&Array.isArray(f)&&(C=f.indexOf(w)),C===-1)if(typeof w=="number"&&f===!0)C=w;else return;const A={sourceData:t,pathPrefix:n.dataPathString,headers:f,isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null};let _=RRe(g,C,A);_!==null&&n.updateJsonDataCallback(_,String(E),d)}),d&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_table_update_from_handsontable_afterChange")},afterCreateRow:function(c,h,d){if(d==="loadData"||!n.currentJsonDataRef)return;const f=n.currentJsonDataRef();let g=n.dataPathString?n.getObjectByPathCallback(f,n.dataPathString):f;const w=this.getColHeader();if(Array.isArray(g)){for(let y=0;y<h;y++){let E=null;Array.isArray(w)&&w.length>0&&w[0]!=="Index"?(E={},w.forEach(C=>{typeof C=="string"&&(E[C]=null)})):g.length>0&&typeof g[0]=="object"&&g[0]!==null&&!Array.isArray(g[0])&&(E={},Object.keys(g[0]).forEach(C=>E[C]=null)),g.splice(c+y,0,E)}n.refreshTreeViewCallback("row_added_array_hot"),n.displayTableCallback(g,e,f,n.dataPathString)}else typeof g=="object"&&g!==null&&Qt.fire({title:"새 항목 키 입력",input:"text",inputPlaceholder:"새로운 키 이름을 입력하세요",showCancelButton:!0,inputValidator:y=>!y||y.trim()===""?"키 이름은 비워둘 수 없습니다!":g.hasOwnProperty(y.trim())?"이미 사용 중인 키 이름입니다.":/^\d+$/.test(y.trim())?"키 이름은 숫자만으로 구성될 수 없습니다.":null}).then(y=>{if(y.isConfirmed&&y.value){const E=y.value.trim();g[E]=null,n.refreshTreeViewCallback("key_added_object_hot"),n.displayTableCallback(g,e,f,n.dataPathString)}else n.displayTableCallback(g,e,f,n.dataPathString)})},afterCreateCol:function(c,h,d){if(d==="loadData"||!n.currentJsonDataRef)return;const f=n.currentJsonDataRef();let g=n.dataPathString?n.getObjectByPathCallback(f,n.dataPathString):f;if(Array.isArray(g)&&g.length>0&&typeof g[0]=="object"&&g[0]!==null)for(let w=0;w<h;w++)Qt.fire({title:`새 열(속성)의 키 입력 (${w+1}/${h})`,input:"text",inputPlaceholder:"새로운 키 이름을 입력하세요",showCancelButton:!0,inputValidator:y=>!y||y.trim()===""?"키 이름은 비워둘 수 없습니다!":g[0].hasOwnProperty(y.trim())?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(y.trim())?"키 이름은 숫자만으로 구성될 수 없습니다.":null}).then(y=>{if(y.isConfirmed&&y.value){const E=y.value.trim();g.forEach(C=>{C[E]=null}),n.refreshTreeViewCallback("col_added_array_of_obj_hot"),n.displayTableCallback(g,e,f,n.dataPathString)}else w===h-1&&n.displayTableCallback(g,e,f,n.dataPathString)});else typeof g=="object"&&g!==null&&!Array.isArray(g)?(Qt.fire("알림",'이 뷰에서는 "열 추가"가 "새 키-값 쌍 추가"와 동일하게 동작합니다.',"info"),Qt.fire({title:"새 항목 키 입력",input:"text",inputPlaceholder:"새로운 키 이름을 입력하세요",showCancelButton:!0,inputValidator:w=>!w||w.trim()===""?"키 이름은 비워둘 수 없습니다!":g.hasOwnProperty(w.trim())?"이미 사용 중인 키 이름입니다.":/^\d+$/.test(w.trim())?"키 이름은 숫자만으로 구성될 수 없습니다.":null}).then(w=>{if(w.isConfirmed&&w.value){const y=w.value.trim();g[y]=null,n.refreshTreeViewCallback("key_added_object_via_col_add_hot"),n.displayTableCallback(g,e,f,n.dataPathString)}else n.displayTableCallback(g,e,f,n.dataPathString)})):(Qt.fire("오류","현재 데이터 구조에는 열을 추가할 수 없습니다.","error"),n.displayTableCallback(g,e,f,n.dataPathString))},beforeRemoveRow:function(c,h,d,f){if(f==="loadData"||!n.currentJsonDataRef)return;const g=n.currentJsonDataRef();let w=n.dataPathString?n.getObjectByPathCallback(g,n.dataPathString):g;if(d.sort((y,E)=>E-y),Array.isArray(w))d.forEach(y=>{y>=0&&y<w.length&&w.splice(y,1)});else if(typeof w=="object"&&w!==null){const y=Object.keys(w);d.forEach(E=>{E>=0&&E<y.length&&delete w[y[E]]})}else return Qt.fire("오류","현재 데이터에서 행을 삭제할 수 없습니다.","error"),!1},afterRemoveRow:function(c,h,d,f){if(f==="loadData"||!n.currentJsonDataRef)return;const g=n.currentJsonDataRef();let w=n.dataPathString?n.getObjectByPathCallback(g,n.dataPathString):g;n.refreshTreeViewCallback("row_removed_hot"),n.displayTableCallback(w,e,g,n.dataPathString)},beforeRemoveCol:function(c,h,d,f){if(f==="loadData"||!n.currentJsonDataRef)return;const g=n.currentJsonDataRef();let w=n.dataPathString?n.getObjectByPathCallback(g,n.dataPathString):g;d.sort((E,C)=>C-E);const y=this.getColHeader();if(Array.isArray(w)&&w.length>0&&typeof w[0]=="object"&&w[0]!==null){if(!Array.isArray(y))return Qt.fire("오류","열 헤더 정보를 가져올 수 없습니다.","error"),!1;d.forEach(E=>{if(E>=0&&E<y.length){const C=y[E];typeof C=="string"&&w.forEach(A=>{delete A[C]})}})}else return typeof w=="object"&&w!==null&&!Array.isArray(w)?(Qt.fire("알림","이 뷰에서 특정 열만 삭제하는 것은 지원되지 않습니다. 행 전체(키-값 쌍)를 삭제해주세요.","info"),!1):(Qt.fire("오류","현재 데이터 구조에서는 열을 삭제할 수 없습니다.","error"),!1)},afterRemoveCol:function(c,h,d,f){if(f==="loadData"||!n.currentJsonDataRef)return;const g=n.currentJsonDataRef();let w=n.dataPathString?n.getObjectByPathCallback(g,n.dataPathString):g;n.refreshTreeViewCallback("col_removed_hot"),n.displayTableCallback(w,e,g,n.dataPathString)}})}function RRe(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a}=n;let l="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const u=o[e];l=`[${t}].${u}`}else return null;else if(e===1)l=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null)if(e===1){const u=Object.keys(r);if(t<u.length)l=`.${u[t]}`;else return null}else return null;else return t===0&&e===1?i:null;return i?i+l:l.startsWith(".")?l.substring(1):l}let xo=[],No=-1;const ERe=30;let O_=!1;function TRe(){xo=[],No=-1,O_=!1}function MRe(t){O_||(No<xo.length-1&&(xo=xo.slice(0,No+1)),xo.push(t),No=xo.length-1,xo.length>ERe&&(xo.shift(),No--))}function _Re(t){let e=!1,n=No;return t==="back"&&No>0?(n--,e=!0):t==="forward"&&No<xo.length-1&&(n++,e=!0),e?(No=n,xo[No]):null}function wA(t){O_=t}function PRe(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function xRe(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=PRe(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function vA(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}let Ie=null,Zl=null,Ss,sf,Yn;function ORe(){document.getElementById("loadBtn").addEventListener("click",IRe),document.getElementById("saveBtn").addEventListener("click",ARe),document.getElementById("minifyBtn").addEventListener("click",()=>{Nn&&Nn.value?Nn.value=TV(Nn.value):Nn&&(Nn.value="")}),document.getElementById("uglifyBtn").addEventListener("click",()=>{Nn&&Nn.value?Nn.value=MV(Nn.value):Nn&&(Nn.value="")}),document.getElementById("diffBtn").addEventListener("click",()=>{if(!Zl&&!Ie){typeof Swal<"u"&&Swal.fire("알림","먼저 JSON 데이터를 로드해주세요.","info");return}if(!Zl){typeof Swal<"u"&&Swal.fire("알림","로드 시점의 원본 JSON 데이터가 없습니다. 변경사항을 비교할 수 없습니다.","info");return}Z2({title:"JSON 데이터 변경사항",jsonDiffData:{left:Zl,right:Ie===null?{}:Ie},buttons:[{text:"닫기",role:"confirm"}]}).catch(e=>{console.error("showJsonDiffPopup 실행 중 오류:",e),typeof Swal<"u"&&Swal.fire("오류","변경점 확인 중 오류가 발생했습니다.","error")})}),Ss=document.getElementById("searchInput"),sf=document.getElementById("searchTargetSelect"),Yn=document.getElementById("searchResultsDropdown"),Ss&&Ss.addEventListener("input",yA),sf&&sf.addEventListener("change",yA),document.addEventListener("click",t=>{Yn&&Ss&&!Ss.contains(t.target)&&!Yn.contains(t.target)&&(Yn.style.display="none")}),Yn&&Yn.addEventListener("click",t=>{t.stopPropagation()}),window.addEventListener("mousedown",t=>{const e=document.activeElement;e&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)&&!(t.button===3||t.button===4)||(t.button===3?(t.preventDefault(),bA("back")):t.button===4&&(t.preventDefault(),bA("forward")))})}function yA(){if(!Ss||!sf||!Yn)return;const t=Ss.value.trim().toLowerCase(),e=sf.value;if(!t){Yn.innerHTML="",Yn.style.display="none";return}if(Ie==null){vA([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],Yn,t,CA);return}const n=xRe(t,e,Ie);vA(n,Yn,t,CA)}function CA(t){t&&typeof Wa=="function"&&(Wa(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString),Yn&&(Yn.style.display="none"))}function IRe(){HRe(),TRe();try{const t=Nn.value.trim();if(!t){Ie=null,Zl=null,_c(null,af),of();return}Ie=JSON.parse(t),Zl=JSON.parse(JSON.stringify(Ie));const e=wV();if(fn&&(fn.innerHTML=""),typeof Ie=="object"&&Ie!==null)uf(Ie,fn,"",Ie,0,e);else{const r={["value"]:Ie};uf(r,fn,"",r,0,e)}of(),_c(null,af)}catch(t){ba&&(ba.textContent="JSON 파싱 오류: "+t.message),Ie=null,Zl=null,fn&&(fn.innerHTML=""),of(),_c(null,af)}}function ARe(){if(ba&&(ba.textContent=""),Ie!=null)try{const t=JSON.stringify(Ie,null,2);Nn&&(Nn.value=t),ua&&oP(ua,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){ba&&(ba.textContent="JSON 문자열 변환 오류: "+t.message),ua&&(ua.textContent="")}else Nn&&(Nn.value=""),ua&&oP(ua,"저장할 JSON 데이터가 없습니다.",3e3)}function HRe(){ej(),of(),Ie=null,Zl=null,rw(null),Yn&&(Yn.innerHTML="",Yn.style.display="none"),Ss&&(Ss.value=""),fn&&(fn.innerHTML=""),_c(null,af)}function NRe(t,e,n=!1){if(Ie==null){console.error("데이터 업데이트 오류: currentJsonData가 없습니다.");return}const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Ie:s=Vc(Ie,o),o===""&&t===i&&(typeof Ie!="object"||Ie===null)){if(Ie=PS(e,Ie),n)return;nv(t),Wa(Ie,"value",Ie,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){console.error("데이터 업데이트 오류: 부모 객체를 찾을 수 없거나 객체/배열이 아님.",{pathString:t,parentPath:o,parentObject:s}),typeof Swal<"u"&&Swal.fire("오류","데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).","error");return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){console.error("데이터 업데이트 오류: 배열 인덱스 범위 초과.",{targetKeyOrIndex:a,arrayLength:s.length}),typeof Swal<"u"&&Swal.fire("오류","배열 인덱스 범위를 벗어났습니다.","error");return}let l=!0;const u=s[a],c=PS(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&fn){const f=fn.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(AH(g,c),l=!1)}}!n&&l&&nv(t)}}function DRe(t,e,n,r){let i;if(r&&(t===""||Vc(Ie,t)===r)?i=r:i=t===""?Ie:Vc(Ie,t),typeof i!="object"||i===null||Array.isArray(i)){console.error("키 업데이트 오류: 부모가 객체가 아니거나 찾을 수 없습니다.",{parentPathString:t,parentObject:i}),typeof Swal<"u"&&Swal.fire("오류","키를 업데이트할 부모 객체를 찾을 수 없습니다.","error");return}if(!i.hasOwnProperty(e)){typeof Swal<"u"&&Swal.fire("오류",`기존 키 "${e}"를 찾을 수 없습니다.`,"error");return}if(n===e){typeof Swal<"u"&&Swal.fire({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다."});return}if(i.hasOwnProperty(n)){typeof Swal<"u"&&Swal.fire("오류",`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,"error");return}const o={},s=i[e];for(const a in i)i.hasOwnProperty(a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)i.hasOwnProperty(a)&&delete i[a];for(const a in o)o.hasOwnProperty(a)&&(i[a]=o[a]);typeof Swal<"u"&&Swal.fire({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`}),nv(`key_renamed_in_parent:${t}`),Wa(i,n,Ie,t)}function nv(t="N/A"){if(fn&&Ie!=null){const e=rj(),n=ij(fn);fn.innerHTML="";const r=wV();if(typeof Ie=="object")uf(Ie,fn,"",Ie,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Ie};uf(o,fn,"",o,0,r)}if(oj(fn,n),e){const i=fn.querySelector(`.tree-node[data-path="${e}"]`);i&&rw(i)}}else fn&&(fn.innerHTML="")}function wV(){return{displayTableCallback:Wa,getObjectByPathCallback:Vc}}function af(t){const e=Vc(Ie,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}Wa(e,n,Ie,t)}else console.warn(`Data not found for path: ${t}`),typeof Swal<"u"&&Swal.fire("오류",`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,"error")}function Wa(t,e,n,r){MRe({data:t,dataKeyName:e,rootJsonData:n,dataPathString:r}),_c(r,af),SRe(t,e,{tableViewDomElement:IH,updateJsonDataCallback:NRe,updateJsonKeyCallback:DRe,refreshTreeViewCallback:nv,getObjectByPathCallback:Vc,convertToTypedValueCallback:PS,rootJsonData:n,currentJsonDataRef:()=>Ie,dataPathString:r,displayTableCallback:Wa})}function bA(t){const e=_Re(t);if(e){wA(!0);try{Wa(e.data,e.dataKeyName,e.rootJsonData,e.dataPathString)}catch(n){console.error("Error navigating history:",n),typeof Swal<"u"&&Swal.fire("오류","히스토리 복원 중 오류가 발생했습니다.","error")}finally{wA(!1)}}}document.addEventListener("DOMContentLoaded",ORe)});export default kRe();
