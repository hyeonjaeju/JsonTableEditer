var tB=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var A0e=tB((G0e,ow)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function nB(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function rB(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function GA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function iB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dx(t,e){return t.get(GA(t,e))}function oB(t,e,n){iB(t,e),e.set(t,n)}function sB(t,e,n){return t.set(GA(t,e),n),n}const aB=100,Re={},lB=()=>{Re.previousActiveElement instanceof HTMLElement?(Re.previousActiveElement.focus(),Re.previousActiveElement=null):document.body&&document.body.focus()},uB=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Re.restoreFocusTimeout=setTimeout(()=>{lB(),e()},aB),window.scrollTo(n,r)}),KA="swal2-",cB=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],z=cB.reduce((t,e)=>(t[e]=KA+e,t),{}),hB=["success","warning","info","question","error"],sw=hB.reduce((t,e)=>(t[e]=KA+e,t),{}),qA="SweetAlert2:",S0=t=>t.charAt(0).toUpperCase()+t.slice(1),fr=t=>{console.warn(`${qA} ${typeof t=="object"?t.join(" "):t}`)},Cu=t=>{console.error(`${qA} ${t}`)},fx=[],dB=t=>{fx.includes(t)||(fx.push(t),fr(t))},XA=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;dB(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},yv=t=>typeof t=="function"?t():t,R0=t=>t&&typeof t.toPromise=="function",Xf=t=>R0(t)?t.toPromise():Promise.resolve(t),E0=t=>t&&Promise.resolve(t)===t,pr=()=>document.body.querySelector(`.${z.container}`),Jf=t=>{const e=pr();return e?e.querySelector(t):null},ei=t=>Jf(`.${t}`),ot=()=>ei(z.popup),ah=()=>ei(z.icon),fB=()=>ei(z["icon-content"]),JA=()=>ei(z.title),T0=()=>ei(z["html-container"]),ZA=()=>ei(z.image),M0=()=>ei(z["progress-steps"]),Cv=()=>ei(z["validation-message"]),Jo=()=>Jf(`.${z.actions} .${z.confirm}`),lh=()=>Jf(`.${z.actions} .${z.cancel}`),bu=()=>Jf(`.${z.actions} .${z.deny}`),gB=()=>ei(z["input-label"]),uh=()=>Jf(`.${z.loader}`),Zf=()=>ei(z.actions),QA=()=>ei(z.footer),bv=()=>ei(z["timer-progress-bar"]),_0=()=>ei(z.close),mB=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,x0=()=>{const t=ot();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(mB),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>kr(o))},P0=()=>Ws(document.body,z.shown)&&!Ws(document.body,z["toast-shown"])&&!Ws(document.body,z["no-backdrop"]),Sv=()=>{const t=ot();return t?Ws(t,z.toast):!1},pB=()=>{const t=ot();return t?t.hasAttribute("data-loading"):!1},ti=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},Ws=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},wB=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(z).includes(n)&&!Object.values(sw).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Qr=(t,e,n)=>{if(wB(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){fr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}ft(t,r)}},Rv=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${z.popup} > .${z[e]}`);case"checkbox":return t.querySelector(`.${z.popup} > .${z.checkbox} input`);case"radio":return t.querySelector(`.${z.popup} > .${z.radio} input:checked`)||t.querySelector(`.${z.popup} > .${z.radio} input:first-child`);case"range":return t.querySelector(`.${z.popup} > .${z.range} input`);default:return t.querySelector(`.${z.popup} > .${z.input}`)}},eH=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},tH=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},ft=(t,e)=>{tH(t,e,!0)},Ei=(t,e)=>{tH(t,e,!1)},Ia=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&Ws(i,e))return i}},iu=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},$n=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},er=t=>{t&&(t.style.display="none")},I0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{Qf(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},gx=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},Qf=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?$n(t,n):er(t)},kr=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),vB=()=>!kr(Jo())&&!kr(bu())&&!kr(lh()),mx=t=>t.scrollHeight>t.clientHeight,nH=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},O0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=bv();n&&kr(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},yB=()=>{const t=bv();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},CB=()=>typeof window>"u"||typeof document>"u",bB=`
 <div aria-labelledby="${z.title}" aria-describedby="${z["html-container"]}" class="${z.popup}" tabindex="-1">
   <button type="button" class="${z.close}"></button>
   <ul class="${z["progress-steps"]}"></ul>
   <div class="${z.icon}"></div>
   <img class="${z.image}" />
   <h2 class="${z.title}" id="${z.title}"></h2>
   <div class="${z["html-container"]}" id="${z["html-container"]}"></div>
   <input class="${z.input}" id="${z.input}" />
   <input type="file" class="${z.file}" />
   <div class="${z.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${z.select}" id="${z.select}"></select>
   <div class="${z.radio}"></div>
   <label class="${z.checkbox}">
     <input type="checkbox" id="${z.checkbox}" />
     <span class="${z.label}"></span>
   </label>
   <textarea class="${z.textarea}" id="${z.textarea}"></textarea>
   <div class="${z["validation-message"]}" id="${z["validation-message"]}"></div>
   <div class="${z.actions}">
     <div class="${z.loader}"></div>
     <button type="button" class="${z.confirm}"></button>
     <button type="button" class="${z.deny}"></button>
     <button type="button" class="${z.cancel}"></button>
   </div>
   <div class="${z.footer}"></div>
   <div class="${z["timer-progress-bar-container"]}">
     <div class="${z["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),SB=()=>{const t=pr();return t?(t.remove(),Ei([document.documentElement,document.body],[z["no-backdrop"],z["toast-shown"],z["has-column"]]),!0):!1},rl=()=>{Re.currentInstance.resetValidationMessage()},RB=()=>{const t=ot(),e=Ia(t,z.input),n=Ia(t,z.file),r=t.querySelector(`.${z.range} input`),i=t.querySelector(`.${z.range} output`),o=Ia(t,z.select),s=t.querySelector(`.${z.checkbox} input`),a=Ia(t,z.textarea);e.oninput=rl,n.onchange=rl,o.onchange=rl,s.onchange=rl,a.oninput=rl,r.oninput=()=>{rl(),i.value=r.value},r.onchange=()=>{rl(),i.value=r.value}},EB=t=>typeof t=="string"?document.querySelector(t):t,TB=t=>{const e=ot();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},MB=t=>{window.getComputedStyle(t).direction==="rtl"&&ft(pr(),z.rtl)},_B=t=>{const e=SB();if(CB()){Cu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=z.container,e&&ft(n,z["no-transition"]),ti(n,bB),n.dataset.swal2Theme=t.theme;const r=EB(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),TB(t),MB(r),RB()},A0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?xB(t,e):t&&ti(e,t)},xB=(t,e)=>{t.jquery?PB(e,t):ti(e,t.toString())},PB=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},IB=(t,e)=>{const n=Zf(),r=uh();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?er(n):$n(n),Qr(n,e,"actions"),OB(n,r,e),ti(r,e.loaderHtml||""),Qr(r,e,"loader"))};function OB(t,e,n){const r=Jo(),i=bu(),o=lh();!r||!i||!o||(Ay(r,"confirm",n),Ay(i,"deny",n),Ay(o,"cancel",n),AB(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function AB(t,e,n,r){if(!r.buttonsStyling){Ei([t,e,n],z.styled);return}ft([t,e,n],z.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),Oy(t),Oy(e),Oy(n)}function Oy(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function Ay(t,e,n){const r=S0(e);Qf(t,n[`show${r}Button`],"inline-block"),ti(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=z[e],Qr(t,n,`${e}Button`)}const HB=(t,e)=>{const n=_0();n&&(ti(n,e.closeButtonHtml||""),Qr(n,e,"closeButton"),Qf(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},NB=(t,e)=>{const n=pr();n&&(DB(n,e.backdrop),$B(n,e.position),kB(n,e.grow),Qr(n,e,"container"))};function DB(t,e){typeof e=="string"?t.style.background=e:e||ft([document.documentElement,document.body],z["no-backdrop"])}function $B(t,e){e&&(e in z?ft(t,z[e]):(fr('The "position" parameter is not valid, defaulting to "center"'),ft(t,z.center)))}function kB(t,e){e&&ft(t,z[`grow-${e}`])}var Ot={innerParams:new WeakMap,domCache:new WeakMap};const LB=["input","file","range","select","radio","checkbox","textarea"],FB=(t,e)=>{const n=ot();if(!n)return;const r=Ot.innerParams.get(t),i=!r||e.input!==r.input;LB.forEach(o=>{const s=Ia(n,z[o]);s&&(WB(o,e.inputAttributes),s.className=z[o],i&&er(s))}),e.input&&(i&&VB(e),jB(e))},VB=t=>{if(!t.input)return;if(!ln[t.input]){Cu(`Unexpected type of input! Expected ${Object.keys(ln).join(" | ")}, got "${t.input}"`);return}const e=rH(t.input);if(!e)return;const n=ln[t.input](e,t);$n(e),t.inputAutoFocus&&setTimeout(()=>{eH(n)})},BB=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},WB=(t,e)=>{const n=ot();if(!n)return;const r=Rv(n,t);if(r){BB(r);for(const i in e)r.setAttribute(i,e[i])}},jB=t=>{if(!t.input)return;const e=rH(t.input);e&&Qr(e,t,"input")},H0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},eg=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=z["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&ft(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},rH=t=>{const e=ot();if(e)return Ia(e,z[t]||z.input)},aw=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:E0(e)||fr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},ln={};ln.text=ln.email=ln.password=ln.number=ln.tel=ln.url=ln.search=ln.date=ln["datetime-local"]=ln.time=ln.week=ln.month=(t,e)=>(aw(t,e.inputValue),eg(t,t,e),H0(t,e),t.type=e.input,t);ln.file=(t,e)=>(eg(t,t,e),H0(t,e),t);ln.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return aw(n,e.inputValue),n.type=e.input,aw(r,e.inputValue),eg(n,t,e),t};ln.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");ti(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return eg(t,t,e),t};ln.radio=t=>(t.textContent="",t);ln.checkbox=(t,e)=>{const n=Rv(ot(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return ti(r,e.inputPlaceholder||e.inputLabel),n};ln.textarea=(t,e)=>{aw(t,e.inputValue),H0(t,e),eg(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(ot()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?ot().style.width=`${o}px`:iu(ot(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const UB=(t,e)=>{const n=T0();n&&(I0(n),Qr(n,e,"htmlContainer"),e.html?(A0(e.html,n),$n(n,"block")):e.text?(n.textContent=e.text,$n(n,"block")):er(n),FB(t,e))},zB=(t,e)=>{const n=QA();n&&(I0(n),Qf(n,e.footer,"block"),e.footer&&A0(e.footer,n),Qr(n,e,"footer"))},YB=(t,e)=>{const n=Ot.innerParams.get(t),r=ah();if(!r)return;if(n&&e.icon===n.icon){wx(r,e),px(r,e);return}if(!e.icon&&!e.iconHtml){er(r);return}if(e.icon&&Object.keys(sw).indexOf(e.icon)===-1){Cu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),er(r);return}$n(r),wx(r,e),px(r,e),ft(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",iH)},px=(t,e)=>{for(const[n,r]of Object.entries(sw))e.icon!==n&&Ei(t,r);ft(t,e.icon&&sw[e.icon]),qB(t,e),iH(),Qr(t,e,"icon")},iH=()=>{const t=ot();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},GB=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,KB=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,wx=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=vx(e.iconHtml):e.icon==="success"?(r=GB,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=KB:e.icon&&(r=vx({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&ti(t,r)},qB=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])gx(t,n,"background-color",e.iconColor);gx(t,".swal2-success-ring","border-color",e.iconColor)}},vx=t=>`<div class="${z["icon-content"]}">${t}</div>`,XB=(t,e)=>{const n=ZA();if(n){if(!e.imageUrl){er(n);return}$n(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),iu(n,"width",e.imageWidth),iu(n,"height",e.imageHeight),n.className=z.image,Qr(n,e,"image")}};let N0=!1,oH=0,sH=0,aH=0,lH=0;const JB=t=>{t.addEventListener("mousedown",lw),document.body.addEventListener("mousemove",uw),t.addEventListener("mouseup",cw),t.addEventListener("touchstart",lw),document.body.addEventListener("touchmove",uw),t.addEventListener("touchend",cw)},ZB=t=>{t.removeEventListener("mousedown",lw),document.body.removeEventListener("mousemove",uw),t.removeEventListener("mouseup",cw),t.removeEventListener("touchstart",lw),document.body.removeEventListener("touchmove",uw),t.removeEventListener("touchend",cw)},lw=t=>{const e=ot();if(t.target===e||ah().contains(t.target)){N0=!0;const n=uH(t);oH=n.clientX,sH=n.clientY,aH=parseInt(e.style.insetInlineStart)||0,lH=parseInt(e.style.insetBlockStart)||0,ft(e,"swal2-dragging")}},uw=t=>{const e=ot();if(N0){let{clientX:n,clientY:r}=uH(t);e.style.insetInlineStart=`${aH+(n-oH)}px`,e.style.insetBlockStart=`${lH+(r-sH)}px`}},cw=()=>{const t=ot();N0=!1,Ei(t,"swal2-dragging")},uH=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},QB=(t,e)=>{const n=pr(),r=ot();if(!(!n||!r)){if(e.toast){iu(n,"width",e.width),r.style.width="100%";const i=uh();i&&r.insertBefore(i,ah())}else iu(r,"width",e.width);iu(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),er(Cv()),eW(r,e),e.draggable&&!e.toast?(ft(r,z.draggable),JB(r)):(Ei(r,z.draggable),ZB(r))}},eW=(t,e)=>{const n=e.showClass||{};t.className=`${z.popup} ${kr(t)?n.popup:""}`,e.toast?(ft([document.documentElement,document.body],z["toast-shown"]),ft(t,z.toast)):ft(t,z.modal),Qr(t,e,"popup"),typeof e.customClass=="string"&&ft(t,e.customClass),e.icon&&ft(t,z[`icon-${e.icon}`])},tW=(t,e)=>{const n=M0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){er(n);return}$n(n),n.textContent="",i>=r.length&&fr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=nW(o);if(n.appendChild(a),s===i&&ft(a,z["active-progress-step"]),s!==r.length-1){const l=rW(e);n.appendChild(l)}})},nW=t=>{const e=document.createElement("li");return ft(e,z["progress-step"]),ti(e,t),e},rW=t=>{const e=document.createElement("li");return ft(e,z["progress-step-line"]),t.progressStepsDistance&&iu(e,"width",t.progressStepsDistance),e},iW=(t,e)=>{const n=JA();n&&(I0(n),Qf(n,e.title||e.titleText,"block"),e.title&&A0(e.title,n),e.titleText&&(n.innerText=e.titleText),Qr(n,e,"title"))},cH=(t,e)=>{QB(t,e),NB(t,e),tW(t,e),YB(t,e),XB(t,e),iW(t,e),HB(t,e),UB(t,e),IB(t,e),zB(t,e);const n=ot();typeof e.didRender=="function"&&n&&e.didRender(n),Re.eventEmitter.emit("didRender",n)},oW=()=>kr(ot()),hH=()=>{var t;return(t=Jo())===null||t===void 0?void 0:t.click()},sW=()=>{var t;return(t=bu())===null||t===void 0?void 0:t.click()},aW=()=>{var t;return(t=lh())===null||t===void 0?void 0:t.click()},ch=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),dH=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},lW=(t,e,n)=>{dH(t),e.toast||(t.keydownHandler=r=>cW(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:ot(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},jS=(t,e)=>{var n;const r=x0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=ot())===null||n===void 0||n.focus()},fH=["ArrowRight","ArrowDown"],uW=["ArrowLeft","ArrowUp"],cW=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?hW(e,t):e.key==="Tab"?dW(e):[...fH,...uW].includes(e.key)?fW(e.key):e.key==="Escape"&&gW(e,t,n)))},hW=(t,e)=>{if(!yv(e.allowEnterKey))return;const n=Rv(ot(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;hH(),t.preventDefault()}},dW=t=>{const e=t.target,n=x0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?jS(r,-1):jS(r,1),t.stopPropagation(),t.preventDefault()},fW=t=>{const e=Zf(),n=Jo(),r=bu(),i=lh();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=fH.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&kr(a))break}a instanceof HTMLButtonElement&&a.focus()}},gW=(t,e,n)=>{yv(e.allowEscapeKey)&&(t.preventDefault(),n(ch.esc))};var Xc={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const mW=()=>{const t=pr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},gH=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},mH=typeof window<"u"&&!!window.GestureEvent,pW=()=>{if(mH&&!Ws(document.body,z.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,ft(document.body,z.iosfix),wW()}},wW=()=>{const t=pr();if(!t)return;let e;t.ontouchstart=n=>{e=vW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},vW=t=>{const e=t.target,n=pr(),r=T0();return!n||!r||yW(t)||CW(t)?!1:e===n||!mx(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(mx(r)&&r.contains(e))},yW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",CW=t=>t.touches&&t.touches.length>1,bW=()=>{if(Ws(document.body,z.iosfix)){const t=parseInt(document.body.style.top,10);Ei(document.body,z.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},SW=()=>{const t=document.createElement("div");t.className=z["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let Lc=null;const RW=t=>{Lc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(Lc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Lc+SW()}px`)},EW=()=>{Lc!==null&&(document.body.style.paddingRight=`${Lc}px`,Lc=null)};function pH(t,e,n,r){Sv()?yx(t,r):(uB(n).then(()=>yx(t,r)),dH(Re)),mH?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),P0()&&(EW(),bW(),gH()),TW()}function TW(){Ei([document.documentElement,document.body],[z.shown,z["height-auto"],z["no-backdrop"],z["toast-shown"]])}function Oa(t){t=_W(t);const e=Xc.swalPromiseResolve.get(this),n=MW(this);this.isAwaitingPromise?t.isDismissed||(tg(this),e(t)):n&&e(t)}const MW=t=>{const e=ot();if(!e)return!1;const n=Ot.innerParams.get(t);if(!n||Ws(e,n.hideClass.popup))return!1;Ei(e,n.showClass.popup),ft(e,n.hideClass.popup);const r=pr();return Ei(r,n.showClass.backdrop),ft(r,n.hideClass.backdrop),xW(t,e,n),!0};function wH(t){const e=Xc.swalPromiseReject.get(this);tg(this),e&&e(t)}const tg=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Ot.innerParams.get(t)||t._destroy())},_W=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),xW=(t,e,n)=>{var r;const i=pr(),o=nH(e);typeof n.willClose=="function"&&n.willClose(e),(r=Re.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?PW(t,e,i,n.returnFocus,n.didClose):pH(t,i,n.returnFocus,n.didClose)},PW=(t,e,n,r,i)=>{Re.swalCloseEventFinishedCallback=pH.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Re.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Re),delete Re.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},yx=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Re.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Jc=t=>{let e=ot();if(e||new bi,e=ot(),!e)return;const n=uh();Sv()?er(ah()):IW(e,t),$n(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},IW=(t,e)=>{const n=Zf(),r=uh();!n||!r||(!e&&kr(Jo())&&(e=Jo()),$n(n),e&&(er(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),ft([t,n],z.loading))},OW=(t,e)=>{e.input==="select"||e.input==="radio"?$W(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(R0(e.inputValue)||E0(e.inputValue))&&(Jc(Jo()),kW(t,e))},AW=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return HW(n);case"radio":return NW(n);case"file":return DW(n);default:return e.inputAutoTrim?n.value.trim():n.value}},HW=t=>t.checked?1:0,NW=t=>t.checked?t.value:null,DW=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,$W=(t,e)=>{const n=ot();if(!n)return;const r=i=>{e.input==="select"?LW(n,hw(i),e):e.input==="radio"&&FW(n,hw(i),e)};R0(e.inputOptions)||E0(e.inputOptions)?(Jc(Jo()),Xf(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):Cu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},kW=(t,e)=>{const n=t.getInput();n&&(er(n),Xf(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,$n(n),n.focus(),t.hideLoading()}).catch(r=>{Cu(`Error in inputValue promise: ${r}`),n.value="",$n(n),n.focus(),t.hideLoading()}))};function LW(t,e,n){const r=Ia(t,z.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,ti(l,s),l.selected=vH(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function FW(t,e,n){const r=Ia(t,z.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=z.radio,l.value=s,vH(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");ti(c,a),c.className=z.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const hw=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=hw(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=hw(r)),e.push([n,r])}),e},vH=(t,e)=>!!e&&e.toString()===t.toString(),VW=t=>{const e=Ot.innerParams.get(t);t.disableButtons(),e.input?yH(t,"confirm"):$0(t,!0)},BW=t=>{const e=Ot.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?yH(t,"deny"):D0(t,!1)},WW=(t,e)=>{t.disableButtons(),e(ch.cancel)},yH=(t,e)=>{const n=Ot.innerParams.get(t);if(!n.input){Cu(`The "input" parameter is needed to be set when using returnInputValueOn${S0(e)}`);return}const r=t.getInput(),i=AW(t,n);n.inputValidator?jW(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?D0(t,i):$0(t,i)},jW=(t,e,n)=>{const r=Ot.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Xf(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?D0(t,e):$0(t,e)})},D0=(t,e)=>{const n=Ot.innerParams.get(t||void 0);n.showLoaderOnDeny&&Jc(bu()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Xf(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),tg(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>CH(t||void 0,i))):t.close({isDenied:!0,value:e})},Cx=(t,e)=>{t.close({isConfirmed:!0,value:e})},CH=(t,e)=>{t.rejectPromise(e)},$0=(t,e)=>{const n=Ot.innerParams.get(t||void 0);n.showLoaderOnConfirm&&Jc(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Xf(n.preConfirm(e,n.validationMessage))).then(i=>{kr(Cv())||i===!1?(t.hideLoading(),tg(t)):Cx(t,typeof i>"u"?e:i)}).catch(i=>CH(t||void 0,i))):Cx(t,e)};function dw(){const t=Ot.innerParams.get(this);if(!t)return;const e=Ot.domCache.get(this);er(e.loader),Sv()?t.icon&&$n(ah()):UW(e),Ei([e.popup,e.actions],z.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const UW=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?$n(e[0],"inline-block"):vB()&&er(t.actions)};function bH(){const t=Ot.innerParams.get(this),e=Ot.domCache.get(this);return e?Rv(e.popup,t.input):null}function SH(t,e,n){const r=Ot.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function RH(t,e){const n=ot();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${z.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function EH(){SH(this,["confirmButton","denyButton","cancelButton"],!1)}function TH(){SH(this,["confirmButton","denyButton","cancelButton"],!0)}function MH(){RH(this.getInput(),!1)}function _H(){RH(this.getInput(),!0)}function xH(t){const e=Ot.domCache.get(this),n=Ot.innerParams.get(this);ti(e.validationMessage,t),e.validationMessage.className=z["validation-message"],n.customClass&&n.customClass.validationMessage&&ft(e.validationMessage,n.customClass.validationMessage),$n(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",z["validation-message"]),eH(r),ft(r,z.inputerror))}function PH(){const t=Ot.domCache.get(this);t.validationMessage&&er(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Ei(e,z.inputerror))}const Fc={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},zW=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],YW={allowEnterKey:void 0},GW=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],IH=t=>Object.prototype.hasOwnProperty.call(Fc,t),OH=t=>zW.indexOf(t)!==-1,AH=t=>YW[t],KW=t=>{IH(t)||fr(`Unknown parameter "${t}"`)},qW=t=>{GW.includes(t)&&fr(`The parameter "${t}" is incompatible with toasts`)},XW=t=>{const e=AH(t);e&&XA(t,e)},HH=t=>{t.backdrop===!1&&t.allowOutsideClick&&fr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&fr(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)KW(e),t.toast&&qW(e),XW(e)};function NH(t){const e=pr(),n=ot(),r=Ot.innerParams.get(this);if(!n||Ws(n,r.hideClass.popup)){fr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=JW(t),o=Object.assign({},r,i);HH(o),e.dataset.swal2Theme=o.theme,cH(this,o),Ot.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const JW=t=>{const e={};return Object.keys(t).forEach(n=>{OH(n)?e[n]=t[n]:fr(`Invalid parameter to update: ${n}`)}),e};function DH(){const t=Ot.domCache.get(this),e=Ot.innerParams.get(this);if(!e){$H(this);return}t.popup&&Re.swalCloseEventFinishedCallback&&(Re.swalCloseEventFinishedCallback(),delete Re.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Re.eventEmitter.emit("didDestroy"),ZW(this)}const ZW=t=>{$H(t),delete t.params,delete Re.keydownHandler,delete Re.keydownTarget,delete Re.currentInstance},$H=t=>{t.isAwaitingPromise?(Hy(Ot,t),t.isAwaitingPromise=!0):(Hy(Xc,t),Hy(Ot,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},Hy=(t,e)=>{for(const n in t)t[n].delete(e)};var QW=Object.freeze({__proto__:null,_destroy:DH,close:Oa,closeModal:Oa,closePopup:Oa,closeToast:Oa,disableButtons:TH,disableInput:_H,disableLoading:dw,enableButtons:EH,enableInput:MH,getInput:bH,handleAwaitingPromise:tg,hideLoading:dw,rejectPromise:wH,resetValidationMessage:PH,showValidationMessage:xH,update:NH});const e2=(t,e,n)=>{t.toast?t2(t,e,n):(r2(e),i2(e),o2(t,e,n))},t2=(t,e,n)=>{e.popup.onclick=()=>{t&&(n2(t)||t.timer||t.input)||n(ch.close)}},n2=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let fw=!1;const r2=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(fw=!0)}}},i2=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(fw=!0)}}},o2=(t,e,n)=>{e.container.onclick=r=>{if(fw){fw=!1;return}r.target===e.container&&yv(t.allowOutsideClick)&&n(ch.backdrop)}},s2=t=>typeof t=="object"&&t.jquery,bx=t=>t instanceof Element||s2(t),a2=t=>{const e={};return typeof t[0]=="object"&&!bx(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||bx(i)?e[n]=i:i!==void 0&&Cu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function l2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function u2(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const c2=()=>Re.timeout&&Re.timeout.getTimerLeft(),kH=()=>{if(Re.timeout)return yB(),Re.timeout.stop()},LH=()=>{if(Re.timeout){const t=Re.timeout.start();return O0(t),t}},h2=()=>{const t=Re.timeout;return t&&(t.running?kH():LH())},d2=t=>{if(Re.timeout){const e=Re.timeout.increase(t);return O0(e,!0),e}},f2=()=>!!(Re.timeout&&Re.timeout.isRunning());let Sx=!1;const US={};function g2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";US[t]=this,Sx||(document.body.addEventListener("click",m2),Sx=!0)}const m2=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in US){const r=e.getAttribute(n);if(r){US[n].fire({template:r});return}}};class p2{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Re.eventEmitter=new p2;const w2=(t,e)=>{Re.eventEmitter.on(t,e)},v2=(t,e)=>{Re.eventEmitter.once(t,e)},y2=(t,e)=>{if(!t){Re.eventEmitter.reset();return}e?Re.eventEmitter.removeListener(t,e):Re.eventEmitter.removeAllListeners(t)};var C2=Object.freeze({__proto__:null,argsToParams:a2,bindClickHandler:g2,clickCancel:aW,clickConfirm:hH,clickDeny:sW,enableLoading:Jc,fire:l2,getActions:Zf,getCancelButton:lh,getCloseButton:_0,getConfirmButton:Jo,getContainer:pr,getDenyButton:bu,getFocusableElements:x0,getFooter:QA,getHtmlContainer:T0,getIcon:ah,getIconContent:fB,getImage:ZA,getInputLabel:gB,getLoader:uh,getPopup:ot,getProgressSteps:M0,getTimerLeft:c2,getTimerProgressBar:bv,getTitle:JA,getValidationMessage:Cv,increaseTimer:d2,isDeprecatedParameter:AH,isLoading:pB,isTimerRunning:f2,isUpdatableParameter:OH,isValidParameter:IH,isVisible:oW,mixin:u2,off:y2,on:w2,once:v2,resumeTimer:LH,showLoading:Jc,stopTimer:kH,toggleTimer:h2});class b2{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const FH=["swal-title","swal-html","swal-footer"],S2=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return I2(n),Object.assign(R2(n),E2(n),T2(n),M2(n),_2(n),x2(n),P2(n,FH))},R2=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{uu(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof Fc[i]=="boolean"?e[i]=o!=="false":typeof Fc[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},E2=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},T2=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{uu(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${S0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},M2=t=>{const e={},n=t.querySelector("swal-image");return n&&(uu(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},_2=t=>{const e={},n=t.querySelector("swal-icon");return n&&(uu(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},x2=t=>{const e={},n=t.querySelector("swal-input");n&&(uu(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{uu(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},P2=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(uu(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},I2=t=>{const e=FH.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||fr(`Unrecognized element <${r}>`)})},uu=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&fr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},VH=10,O2=t=>{const e=pr(),n=ot();typeof t.willOpen=="function"&&t.willOpen(n),Re.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;N2(e,n,t),setTimeout(()=>{A2(e,n)},VH),P0()&&(H2(e,t.scrollbarPadding,i),mW()),!Sv()&&!Re.previousActiveElement&&(Re.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Re.eventEmitter.emit("didOpen",n),Ei(e,z["no-transition"])},gw=t=>{const e=ot();if(t.target!==e)return;const n=pr();e.removeEventListener("animationend",gw),e.removeEventListener("transitionend",gw),n.style.overflowY="auto"},A2=(t,e)=>{nH(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",gw),e.addEventListener("transitionend",gw)):t.style.overflowY="auto"},H2=(t,e,n)=>{pW(),e&&n!=="hidden"&&RW(n),setTimeout(()=>{t.scrollTop=0})},N2=(t,e,n)=>{ft(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),$n(e,"grid"),setTimeout(()=>{ft(e,n.showClass.popup),e.style.removeProperty("opacity")},VH)):$n(e,"grid"),ft([document.documentElement,document.body],z.shown),n.heightAuto&&n.backdrop&&!n.toast&&ft([document.documentElement,document.body],z["height-auto"])};var Rx={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function D2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=Rx.email),t.input==="url"&&(t.inputValidator=Rx.url))}function $2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(fr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function k2(t){D2(t),t.showLoaderOnConfirm&&!t.preConfirm&&fr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),$2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),_B(t)}let ko;var kg=new WeakMap;class gn{constructor(){if(oB(this,kg,void 0),typeof window>"u")return;ko=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,sB(kg,this,this._main(ko.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(HH(Object.assign({},n,e)),Re.currentInstance){const o=Xc.swalPromiseResolve.get(Re.currentInstance),{isAwaitingPromise:s}=Re.currentInstance;Re.currentInstance._destroy(),s||o({isDismissed:!0}),P0()&&gH()}Re.currentInstance=ko;const r=F2(e,n);k2(r),Object.freeze(r),Re.timeout&&(Re.timeout.stop(),delete Re.timeout),clearTimeout(Re.restoreFocusTimeout);const i=V2(ko);return cH(ko,r),Ot.innerParams.set(ko,r),L2(ko,i,r)}then(e){return dx(kg,this).then(e)}finally(e){return dx(kg,this).finally(e)}}const L2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};Xc.swalPromiseResolve.set(t,r),Xc.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{VW(t)},e.denyButton.onclick=()=>{BW(t)},e.cancelButton.onclick=()=>{WW(t,o)},e.closeButton.onclick=()=>{o(ch.close)},e2(n,e,o),lW(Re,n,o),OW(t,n),O2(n),B2(Re,n,o),W2(e,n),setTimeout(()=>{e.container.scrollTop=0})}),F2=(t,e)=>{const n=S2(t),r=Object.assign({},Fc,e,n,t);return r.showClass=Object.assign({},Fc.showClass,r.showClass),r.hideClass=Object.assign({},Fc.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},V2=t=>{const e={popup:ot(),container:pr(),actions:Zf(),confirmButton:Jo(),denyButton:bu(),cancelButton:lh(),loader:uh(),closeButton:_0(),validationMessage:Cv(),progressSteps:M0()};return Ot.domCache.set(t,e),e},B2=(t,e,n)=>{const r=bv();er(r),e.timer&&(t.timeout=new b2(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&($n(r),Qr(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&O0(e.timer)})))},W2=(t,e)=>{if(!e.toast){if(!yv(e.allowEnterKey)){XA("allowEnterKey"),z2();return}j2(t)||U2(t,e)||jS(-1,1)}},j2=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&kr(n))return n.focus(),!0;return!1},U2=(t,e)=>e.focusDeny&&kr(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&kr(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&kr(t.confirmButton)?(t.confirmButton.focus(),!0):!1,z2=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}gn.prototype.disableButtons=TH;gn.prototype.enableButtons=EH;gn.prototype.getInput=bH;gn.prototype.disableInput=_H;gn.prototype.enableInput=MH;gn.prototype.hideLoading=dw;gn.prototype.disableLoading=dw;gn.prototype.showValidationMessage=xH;gn.prototype.resetValidationMessage=PH;gn.prototype.close=Oa;gn.prototype.closePopup=Oa;gn.prototype.closeModal=Oa;gn.prototype.closeToast=Oa;gn.prototype.rejectPromise=wH;gn.prototype.update=NH;gn.prototype._destroy=DH;Object.assign(gn,C2);Object.keys(QW).forEach(t=>{gn[t]=function(){return ko&&ko[t]?ko[t](...arguments):null}});gn.DismissReason=ch;gn.version="11.21.0";const bi=gn;bi.default=bi;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var qs=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(M){if(M=o.postProcess(M,r),i){setTimeout(function(){i(M)},0);return}else return M},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],p=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&p+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var C=-1/0,E=1/0,y=function(){for(var M=Math.max(C,-c);M<=Math.min(E,c);M+=2){var I=void 0,_=g[M-1],P=g[M+1];_&&(g[M-1]=void 0);var Y=!1;if(P){var V=P.oldPos-M;Y=P&&0<=V&&V<l}var B=_&&_.oldPos+1<u;if(!Y&&!B){g[M]=void 0;continue}if(!B||Y&&_.oldPos<P.oldPos?I=o.addToPath(P,!0,!1,0,r):I=o.addToPath(_,!1,!0,1,r),p=o.extractCommon(I,n,e,M,r),I.oldPos+1>=u&&p+1>=l)return a(o.buildValues(I.lastComponent,n,e))||!0;g[M]=I,I.oldPos+1>=u&&(E=Math.min(E,M-1)),p+1>=l&&(C=Math.max(C,M+1))}c++};if(i)(function M(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);y()||M()},0)})();else for(;c<=h&&Date.now()<=f;){var T=y();if(T)return T}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),Y2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),G2=function(t){Y2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(qs),BH=new G2;function K2(t,e,n){return BH.diff(t,e,n)}function Ex(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function Tx(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function zS(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function YS(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function Ph(t,e){return zS(t,e,"")}function Lg(t,e){return YS(t,e,"")}function Mx(t,e){return e.slice(0,q2(t,e))}function q2(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function X2(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function J2(t){return!t.includes(`\r
`)&&t.includes(`
`)}function Ih(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function na(t){var e=t.match(/^\s*/);return e?e[0]:""}var WH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),mw="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Z2=new RegExp("[".concat(mw,"]+|\\s+|[^").concat(mw,"]"),"ug"),Q2=function(t){WH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(Z2)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&_x(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&_x(i,s,o,null),n},e}(qs),jH=new Q2;function ej(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?zH(t,e,n):jH.diff(t,e,n)}function _x(t,e,n,r){if(e&&n){var i=na(e.value),o=Ih(e.value),s=na(n.value),a=Ih(n.value);if(t){var l=Ex(i,s);t.value=YS(t.value,s,l),e.value=Ph(e.value,l),n.value=Ph(n.value,l)}if(r){var u=Tx(o,a);r.value=zS(r.value,a,u),e.value=Lg(e.value,u),n.value=Lg(n.value,u)}}else if(n){if(t){var c=na(n.value);n.value=n.value.substring(c.length)}if(r){var c=na(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=na(r.value),d=na(e.value),f=Ih(e.value),g=Ex(h,d);e.value=Ph(e.value,g);var p=Tx(Ph(h,g),f);e.value=Lg(e.value,p),r.value=zS(r.value,h,p),t.value=YS(t.value,h,h.slice(0,h.length-p.length))}else if(r){var C=na(r.value),E=Ih(e.value),y=Mx(E,C);e.value=Lg(e.value,y)}else if(t){var T=Ih(t.value),M=na(e.value),y=Mx(T,M);e.value=Ph(e.value,y)}}var tj=function(t){WH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(mw,"]+|[^\\S\\n\\r]+|[^").concat(mw,"]"),"ug");return n.match(r)||[]},e}(qs),UH=new tj;function zH(t,e,n){return UH.diff(t,e,n)}function nj(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var rj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ij=function(t){rj(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=YH,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}(qs),k0=new ij;function Rf(t,e,n){return k0.diff(t,e,n)}function oj(t,e,n){return n=nj(n,{ignoreWhitespace:!0}),k0.diff(t,e,n)}function YH(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var sj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),aj=function(t){sj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}(qs),GH=new aj;function lj(t,e,n){return GH.diff(t,e,n)}var uj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),cj=function(t){uj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}(qs),KH=new cj;function hj(t,e,n){return KH.diff(t,e,n)}var dj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),fj=function(t){dj(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=YH,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(pw(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}(qs),qH=new fj;function gj(t,e,n){return qH.diff(t,e,n)}function pw(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=pw(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=pw(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var mj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),pj=function(t){mj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}(qs),XH=new pj;function wj(t,e,n){return XH.diff(t,e,n)}var Yo=function(){return Yo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Yo.apply(this,arguments)};function JH(t){return Array.isArray(t)?t.map(function(e){return JH(e)}):Yo(Yo({},t),{hunks:t.hunks.map(function(e){return Yo(Yo({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function ZH(t){return Array.isArray(t)?t.map(function(e){return ZH(e)}):Yo(Yo({},t),{hunks:t.hunks.map(function(e){return Yo(Yo({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function vj(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function yj(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function L0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function Cj(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function QH(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=L0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return bj(t,r[0],n)}function bj(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(X2(t)&&vj(e)?e=JH(e):J2(t)&&yj(e)&&(e=ZH(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(Y,V,B,Z){return V===Z},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(Y,V,B,Z,X,Q,se){Z===void 0&&(Z=0),X===void 0&&(X=!0),Q===void 0&&(Q=[]),se===void 0&&(se=0);for(var be=0,bt=!1;Z<Y.length;Z++){var Ee=Y[Z],Ne=Ee.length>0?Ee[0]:" ",lt=Ee.length>0?Ee.substr(1):Ee;if(Ne==="-")if(o(V+1,r[V],Ne,lt))V++,be=0;else return!B||r[V]==null?null:(Q[se]=r[V],f(Y,V+1,B-1,Z,!1,Q,se+1));if(Ne==="+"){if(!X)return null;Q[se]=lt,se++,be=0,bt=!0}if(Ne===" ")if(be++,Q[se]=r[V],o(V+1,r[V],Ne,lt))se++,X=!0,bt=!1,V++;else return bt||!B?null:r[V]&&(f(Y,V+1,B-1,Z+1,!1,Q,se+1)||f(Y,V+1,B-1,Z,!1,Q,se+1))||f(Y,V,B-1,Z+1,!1,Q,se)}return se-=be,V-=be,Q.length=se,{patchedLines:Q,oldLineLastI:V-1}}for(var g=[],p=0,h=0;h<i.length;h++){for(var C=i[h],E=void 0,y=r.length-C.oldLines+s,T=void 0,M=0;M<=s;M++){T=C.oldStart+p-1;for(var I=Cj(T,a,y);T!==void 0&&(E=f(C.lines,T,M),!E);T=I());if(E)break}if(!E)return!1;for(var _=a;_<T;_++)g.push(r[_]);for(var P=0;P<E.patchedLines.length;P++){var d=E.patchedLines[P];g.push(d)}a=E.oldLineLastI+1,p=T+1-C.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function Sj(t,e){var n=typeof t=="string"?L0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=QH(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var ww=function(){return ww=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ww.apply(this,arguments)};function eN(t){return Array.isArray(t)?t.map(function(e){return eN(e)}).reverse():ww(ww({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var Zc=function(){return Zc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Zc.apply(this,arguments)};function GS(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;Rf(n,r,Zc(Zc({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(Rf(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(Ne){return Ne.map(function(lt){return" "+lt})}for(var f=[],g=0,p=0,C=[],E=1,y=1,T=0;T<h.length;T++){var M=h[T],I=M.lines||Ej(M.value);if(M.lines=I,M.added||M.removed){if(!g){var _=h[T-1];g=E,p=y,_&&(C=l>0?d(_.lines.slice(-l)):[],g-=C.length,p-=C.length)}for(var P=0,Y=I;P<Y.length;P++){var V=Y[P];C.push((M.added?"+":"-")+V)}M.added?y+=I.length:E+=I.length}else{if(g)if(I.length<=l*2&&T<h.length-2)for(var B=0,Z=d(I);B<Z.length;B++){var V=Z[B];C.push(V)}else{for(var X=Math.min(I.length,l),Q=0,se=d(I.slice(0,X));Q<se.length;Q++){var V=se[Q];C.push(V)}var be={oldStart:g,oldLines:E-g+X,newStart:p,newLines:y-p+X,lines:C};f.push(be),g=0,p=0,C=[]}E+=I.length,y+=I.length}}for(var bt=0,Ee=f;bt<Ee.length;bt++)for(var be=Ee[bt],T=0;T<be.lines.length;T++)be.lines[T].endsWith(`
`)?be.lines[T]=be.lines[T].slice(0,-1):(be.lines.splice(T+1,0,"\\ No newline at end of file"),T++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function vw(t){if(Array.isArray(t))return t.map(vw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function tN(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;GS(t,e,n,r,i,o,Zc(Zc({},s),{callback:function(u){l(u?vw(u):void 0)}}))}else{var a=GS(t,e,n,r,i,o,s);return a?vw(a):void 0}}function Rj(t,e,n,r,i,o){return tN(t,t,e,n,r,i,o)}function Ej(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function Tj(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function Mj(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(_j(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function _j(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const xj=Object.freeze(Object.defineProperty({__proto__:null,Diff:qs,applyPatch:QH,applyPatches:Sj,arrayDiff:XH,canonicalize:pw,characterDiff:BH,convertChangesToDMP:Tj,convertChangesToXML:Mj,createPatch:Rj,createTwoFilesPatch:tN,cssDiff:KH,diffArrays:wj,diffChars:K2,diffCss:hj,diffJson:gj,diffLines:Rf,diffSentences:lj,diffTrimmedLines:oj,diffWords:ej,diffWordsWithSpace:zH,formatPatch:vw,jsonDiff:qH,lineDiff:k0,parsePatch:L0,reversePatch:eN,sentenceDiff:GH,structuredPatch:GS,wordDiff:jH,wordsWithSpaceDiff:UH},Symbol.toStringTag,{value:"Module"}));function to(t){return typeof t!="string"?"":t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Ev(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u,hotInstance:c}=t;c&&typeof c.deselectCell=="function"&&c.deselectCell();const h={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:{...a,popup:`popup-base ${a.popup||""}`},preConfirm:l,didOpen:u},d=i.find(p=>p.role==="confirm"||!p.role&&i.indexOf(p)===0),f=i.find(p=>p.role==="cancel");return d?(h.showConfirmButton=!0,h.confirmButtonText=d.text||bi.getConfirmButton().innerText,d.color&&(h.confirmButtonColor=d.color)):i.length>0||l?!i.some(p=>p.role!=="cancel")&&!l&&(h.showConfirmButton=!1):h.showConfirmButton=!1,f&&(h.showCancelButton=!0,h.cancelButtonText=f.text||bi.getCancelButton().innerText,f.color&&(h.cancelButtonColor=f.color)),typeof bi>"u"?(console.error("SweetAlert2 (Swal) is not loaded!"),Promise.reject("SweetAlert2 is not imported")):bi.fire(h).then(p=>{let C={...p,formData:{}};return p.isConfirmed&&l&&(C.formData=p.value),p.isConfirmed&&d&&typeof d.action=="function"&&!l?d.action(C):p.isDismissed&&f&&typeof f.action=="function"&&p.dismiss===bi.DismissReason.cancel&&f.action(C),C})}function Pj(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[],hotInstance:i}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();let o="",s="",a=[];const l=(c,h=2)=>{const d=f=>{if(typeof f!="object"||f===null)return f;if(Array.isArray(f))return f.map(d);const g={};return Object.keys(f).forEach(p=>{g[p]=d(f[p])}),g};try{return JSON.stringify(d(c),null,h)}catch{return JSON.stringify(c,null,h)}};if(n&&n.left!==void 0&&n.right!==void 0)if(typeof xj>"u"||typeof Rf!="function")s='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다.</p>',o='<div class="diff-popup-header diff-error">라이브러리 오류</div>';else try{const c=l(n.left),h=l(n.right),d=Rf(c,h);let f=0,g=0;d.forEach(V=>{const B=V.value||"",Z=B.split(`
`);let X=Z.length;Z[Z.length-1]===""&&B.length>0&&X--,B===""&&(X=0),V.added?f+=X:V.removed&&(g+=X)});const p=[];let C=1,E=1;d.forEach((V,B)=>{const Z=V.value||"",X=Z.split(`
`);let Q=X.length;X[X.length-1]===""&&Z.length>0&&Q--,Z===""&&(Q=0),V.removed?(p.push({originalPartIndex:B,part:V,sourceType:"del",lineNumber:C,numLines:Q}),C+=Q):V.added?(p.push({originalPartIndex:B,part:V,sourceType:"ins",lineNumber:E,numLines:Q}),E+=Q):(C+=Q,E+=Q)}),a=[];let y=[...p],T=null;for(y.length>0&&(y.sort((V,B)=>V.lineNumber!==B.lineNumber?V.lineNumber-B.lineNumber:V.sourceType==="del"&&B.sourceType!=="del"?-1:V.sourceType!=="del"&&B.sourceType==="del"?1:V.originalPartIndex-B.originalPartIndex),T=y[0],a.push(T),y=y.filter(V=>V.originalPartIndex!==T.originalPartIndex));y.length>0&&T;){const V=T.lineNumber;let B=null,Z=[];for(const X of y)X.lineNumber>=V&&Z.push({...X,diff:X.lineNumber-V});if(Z.length>0)Z.sort((X,Q)=>X.diff!==Q.diff?X.diff-Q.diff:X.sourceType==="del"&&Q.sourceType!=="del"?-1:X.sourceType!=="del"&&Q.sourceType==="del"?1:X.originalPartIndex-Q.originalPartIndex),B=Z[0];else{let X=[];for(const Q of y)X.push({...Q,absDiff:Math.abs(Q.lineNumber-V)});X.length>0&&(X.sort((Q,se)=>Q.absDiff!==se.absDiff?Q.absDiff-se.absDiff:Q.lineNumber!==se.lineNumber?Q.lineNumber-se.lineNumber:Q.sourceType==="del"&&se.sourceType!=="del"?-1:Q.sourceType!=="del"&&se.sourceType==="del"?1:Q.originalPartIndex-se.originalPartIndex),B=X[0])}if(B)a.push(B),T=B,y=y.filter(X=>X.originalPartIndex!==B.originalPartIndex);else break}let M="",I="",_=1,P=1;const Y=new Map;if(a.forEach((V,B)=>Y.set(V.originalPartIndex,B)),d.forEach((V,B)=>{const Z=V.value||"",X=Z.replace(/\n$/,"").split(`
`);X.length===1&&X[0]===""&&Z===""||X.forEach((Q,se)=>{let be="";(V.added||V.removed)&&se===0&&Y.has(B)&&(be=`id="diff-nav-target-${Y.get(B)}"`),V.added?(M+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,I+=`<div ${be} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${P++}</span><span class="diff-sbs-line-content">${to(Q)}</span></div>
`):V.removed?(M+=`<div ${be} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${_++}</span><span class="diff-sbs-line-content">${to(Q)}</span></div>
`,I+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(M+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${_++}</span><span class="diff-sbs-line-content">${to(Q)}</span></div>
`,I+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${P++}</span><span class="diff-sbs-line-content">${to(Q)}</span></div>
`)})}),s=`<div class="diff-sbs-container"><div class="diff-sbs-pane" id="diff-left-pane">${M}</div><div class="diff-sbs-pane" id="diff-right-pane">${I}</div></div>`,a.length>0||f>0||g>0){let V="";(f>0||g>0)&&(V=`<span class="diff-summary"><strong class="diff-summary-added">+${f}</strong> <strong class="diff-summary-removed">-${g}</strong></span>`),o=`<div class="diff-popup-header">JSON 비교 결과</div><div id="diff-navigation" class="diff-navigation-controls">${V}<button id="prev-change-btn" class="swal2-styled">이전 변경점</button><button id="next-change-btn" class="swal2-styled">다음 변경점</button><span id="current-change-info" class="diff-current-change-info"></span></div>`}else o='<div class="diff-popup-header">JSON 비교 결과</div>',c===h?s='<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':s='<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>'}catch(c){s=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${c.message}</p>`,o='<div class="diff-popup-header diff-error">오류 발생</div>'}else s='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',o='<div class="diff-popup-header diff-error">데이터 오류</div>';const u=`${o}<div id="diff-container" class="diff-main-container">${s}</div>`;return Ev({title:e,html:u,buttons:r,width:"95%",customClass:{popup:`popup-diff-view ${customClass.popup||""}`,htmlContainer:"custom-swal-html-container-text-diff"},didOpen:c=>{const h=[];if(a&&a.length>0)for(let M=0;M<a.length;M++){const I=document.getElementById(`diff-nav-target-${M}`);I&&h.push(I)}let d=-1,f=null;const g=document.getElementById("diff-navigation"),p=document.getElementById("next-change-btn"),C=document.getElementById("prev-change-btn"),E=document.getElementById("current-change-info");function y(){if(!g)return;const M=h.length===0;p&&(p.style.display=M?"none":"inline-block"),C&&(C.style.display=M?"none":"inline-block"),E&&(E.textContent=M?totalAdded>0||totalRemoved>0?"0 / 0":"변경점 없음":`${d+1} / ${h.length}`),p&&(p.disabled=d>=h.length-1),C&&(C.disabled=d<=0)}function T(M){if(M<0||M>=h.length)return;f&&f.classList.remove("diff-navigation-highlight");const I=h[M];if(I){const _=document.getElementById("diff-container");if(_){const P=I.offsetTop;_.scrollTop=P-_.clientHeight/2+I.clientHeight/2}else I.scrollIntoView({block:"center"});I.classList.add("diff-navigation-highlight"),f=I}d=M,y()}h.length>0?T(0):y(),p&&p.addEventListener("click",()=>{d<h.length-1&&T(d+1)}),C&&C.addEventListener("click",()=>{d>0&&T(d-1)}),c.addEventListener("keydown",M=>{h.length===0||!p||!C||(M.key==="ArrowDown"||M.key==="PageDown"?(M.preventDefault(),p.disabled||p.click()):(M.key==="ArrowUp"||M.key==="PageUp")&&(M.preventDefault(),C.disabled||C.click()))}),y()}})}async function Vo(t){const{title:e,inputLabel:n,inputValue:r="",inputPlaceholder:i="",inputValidator:o,confirmButtonText:s="확인",cancelButtonText:a="취소",showCancelButton:l=!0,customClass:u={},html:c,hotInstance:h}=t;h&&typeof h.deselectCell=="function"&&h.deselectCell();let d=c||"";return n&&!c&&(d=`<label class="swal-input-label">${n}</label>${d}`),bi.fire({title:e,html:d,input:"text",inputValue:r,inputPlaceholder:i,inputValidator:o,showCancelButton:l,confirmButtonText:s,cancelButtonText:a,customClass:{...u,popup:`swal-text-input-popup ${u.popup||""}`},didOpen:()=>{const f=bi.getInput();f&&(f.focus(),typeof f.select=="function"&&f.select())}})}async function Ie(t){const{title:e,text:n="",html:r="",icon:i="warning",confirmButtonText:o="확인",cancelButtonText:s="취소",showCancelButton:a=!0,customClass:l={},hotInstance:u}=t;return u&&typeof u.deselectCell=="function"&&u.deselectCell(),bi.fire({title:e,text:n,html:r,icon:i,showCancelButton:a,confirmButtonText:o,cancelButtonText:s,customClass:{...l,popup:`swal-confirmation-popup ${l.popup||""}`}})}async function xx(t){var C;const{title:e="URL 작업",initialInputValue:n="",inputLabel:r="입력:",outputLabel:i="결과:",actionButtonText:o="실행",confirmButtonText:s="결과를 메인 편집기에 복사",cancelButtonText:a="팝업 닫기",onExecuteAction:l,hotInstance:u}=t;u&&typeof u.deselectCell=="function"&&u.deselectCell();const c=Date.now(),h=`popup-url-input-${c}`,d=`popup-url-output-${c}`,f=`popup-execute-action-${c}`,g=`popup-url-validation-${c}`,p=`
        <div class="popup-url-process-container">
            <div class="popup-form-group">
                <label for="${h}" class="popup-label">${r}</label>
                <textarea id="${h}" class="swal2-textarea popup-textarea" placeholder="여기에 문자열을 입력하세요...">${n}</textarea>
            </div>
            <div class="popup-action-button-container">
                <button type="button" id="${f}" class="swal2-styled popup-execute-button">${o}</button>
            </div>
            <div class="popup-form-group">
                <label for="${d}" class="popup-label">${i}</label>
                <textarea id="${d}" class="swal2-textarea popup-textarea" readonly placeholder="결과가 여기에 표시됩니다..."></textarea>
            </div>
            <div id="${g}" class="popup-validation-message"></div>
        </div>`;return Ev({title:e,html:p,width:"50em",padding:"1.5em",customClass:{popup:`popup-url-process popup-basic-white-theme ${((C=t.customClass)==null?void 0:C.popup)||""}`,htmlContainer:"popup-html-container-spacing"},buttons:[{text:s,role:"confirm"},{text:a,role:"cancel"}],didOpen:E=>{const y=E.querySelector(`#${h}`),T=E.querySelector(`#${d}`),M=E.querySelector(`#${f}`),I=E.querySelector(`#${g}`);y&&y.focus(),M&&y&&T&&I&&M.addEventListener("click",()=>{const _=y.value;if(I.textContent="",_.trim()===""){T.value="",I.textContent="입력값이 비어있습니다.";return}if(typeof l=="function")try{const P=l(_);T.value=P,P.startsWith("오류:")&&(I.textContent=P)}catch(P){const Y=`실행 중 예외: ${P.message}`;T.value=Y,I.textContent=Y}else{const P="오류: 실행할 작업(onExecuteAction)이 정의되지 않았습니다.";T.value=P,I.textContent=P}})},preConfirm:()=>{const E=document.getElementById(d),y=document.getElementById(g);return y&&(y.textContent=""),E&&E.value.trim()!==""?E.value.startsWith("오류:")||E.value.startsWith("실행 중 예외:")?(y&&(y.textContent="오류가 있는 결과는 복사할 수 없습니다."),!1):E.value:(y&&(y.textContent="메인 편집기에 복사할 결과가 없습니다."),!1)},hotInstance:u})}async function nN(t){const{title:e="템플릿 선택",templates:n=[],message:r="",confirmButtonText:i="확인",cancelButtonText:o="취소",hotInstance:s,existingUserTemplateNames:a=[]}=t;if(s&&typeof s.deselectCell=="function"&&s.deselectCell(),n.length===0)return await Ie({title:e,text:"선택할 템플릿이 없습니다.",icon:"info",showCancelButton:!1,confirmButtonText:"닫기",hotInstance:s}),{isConfirmed:!1,selectedTemplates:[]};const l=n.map((h,d)=>{const g=!h.isDefault&&a.includes(h.name)?' <span class="popup-template-overwrite-indicator">(덮어씀)</span>':"";return{id:`template_checkbox_${d}_${Date.now()}`,label:`${to(h.name)} <span class="popup-template-type-indicator">(${to(h.type)})</span>${h.isDefault?' <span class="popup-template-default-indicator">[기본]</span>':""}${g}`,initialChecked:!0,originalTemplate:h}});let u='<form id="popup-template-selection-form" class="popup-template-selection-container">';r&&(u+=`<p class="popup-message">${r}</p>`),l.forEach(h=>{u+=`<div class="popup-template-item">
                        <input type="checkbox" id="${h.id}" name="${h.id}" value="true" ${h.initialChecked?"checked":""} class="popup-checkbox">
                        <label for="${h.id}" class="popup-label-checkbox">${h.label}</label>
                     </div>`}),u+="</form>";const c=await Ev({title:e,html:u,buttons:[{text:i,role:"confirm"},{text:o,role:"cancel"}],width:"45em",padding:"1.5em",customClass:{popup:"popup-template-selection popup-basic-white-theme"},preConfirm:()=>{const h=document.getElementById("popup-template-selection-form"),d=[];return h&&l.forEach(f=>{const g=h.querySelector(`#${f.id}`);g&&g.checked&&d.push(f.originalTemplate)}),d},didOpen:h=>{},hotInstance:s});return{isConfirmed:c.isConfirmed,selectedTemplates:c.isConfirmed&&Array.isArray(c.formData)?c.formData:[]}}async function Ij(t){const{templateName:e,templateValue:n,hotInstance:r}=t;r&&typeof r.deselectCell=="function"&&r.deselectCell();let i;try{const o=JSON.stringify(n,null,2);i=`<pre class="popup-template-content-pre">${to(o)}</pre>`}catch(o){i=`<p class="popup-error-message">템플릿 내용을 표시 중 오류: ${to(o.message)}</p>`}return Ie({title:`${to(e)} - 내용`,html:i,icon:null,showCancelButton:!1,confirmButtonText:"닫기",customClass:{popup:"popup-template-content popup-basic-white-theme",htmlContainer:"popup-html-container-spacing"},hotInstance:r})}async function Oj(t){const{title:e="템플릿 관리",userTemplates:n=[],callbacks:r={},hotInstance:i}=t;return i&&typeof i.deselectCell=="function"&&i.deselectCell(),Ev({title:e,html:(s=>{if(s.length===0)return'<p class="popup-empty-message">관리할 사용자 정의 템플릿이 없습니다.</p>';let a=`<div class="popup-template-management-list-container">
                        <ul class="popup-list">`;return s.forEach(l=>{const u=to(l.name),c=to(l.type);a+=`
                <li class="popup-list-item tm-list-item-hoverable">
                    <span class="popup-list-item-name" title="${u} (${c})">
                        ${u} <span class="popup-list-item-type">(${c})</span>
                    </span>
                    <span class="popup-list-item-actions">
                        <button type="button" class="swal2-styled swal2-styled-small tm-view-btn" data-template-name="${u}" title="내용 보기">내용 확인</button>
                        <button type="button" class="swal2-styled swal2-styled-small tm-rename-btn" data-template-name="${u}" title="이름 변경">이름 변경</button>
                        <button type="button" class="swal2-styled swal2-styled-small tm-delete-btn" data-template-name="${u}" title="삭제">삭제</button>
                    </span>
                </li>`}),a+="</ul></div>",a})(n),width:"60em",padding:"1.5em",customClass:{popup:"popup-template-management popup-basic-white-theme",htmlContainer:"popup-html-container-spacing"},buttons:[{text:"닫기",role:"cancel"}],didOpen:s=>{s.addEventListener("click",a=>{const l=a.target.closest("button[data-template-name]");if(!l)return;const u=l.dataset.templateName;u&&(l.classList.contains("tm-view-btn")?r.onViewRequest&&r.onViewRequest(u):l.classList.contains("tm-rename-btn")?r.onRenameRequest&&r.onRenameRequest(u):l.classList.contains("tm-delete-btn")&&r.onDeleteRequest&&r.onDeleteRequest(u))})},hotInstance:i})}const ht=document.getElementById("json-input"),We=document.getElementById("save-message"),je=document.getElementById("json-error"),xt=document.getElementById("tree-view"),KS=document.getElementById("table-view");function Pt(t,e,n){t&&(t.textContent=e,setTimeout(()=>{t.textContent=""},n))}function Vc(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent&&a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(i.appendChild(document.createTextNode(o)),e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));if(t&&t!==""){let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u;for(;(u=l.exec(t))!==null;){const c=u[0];let h=c;if(a===""?a=c:c.startsWith("[")?a+=c:a+="."+c,i.appendChild(document.createTextNode(" > ")),e){const d=document.createElement("a");d.href="#",d.textContent=h,d.style.textDecoration="underline",d.style.cursor="pointer",d.onclick=(f=>g=>{g.preventDefault(),e(f)})(a),i.appendChild(d)}else i.appendChild(document.createTextNode(h))}}i.appendChild(document.createTextNode(s))}function Aj(){xt&&(xt.innerHTML=""),KS&&(KS.innerHTML=""),je&&(je.textContent=""),We&&(We.textContent=""),Vc(null,null)}function cu(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function qS(t,e){if(typeof t=="string"){const n=t.trim();if(n.toLowerCase()==="null")return null;if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1;if(n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,"")))return Number(n);if(n.startsWith("[")&&n.endsWith("]")||n.startsWith("{")&&n.endsWith("}"))try{return JSON.parse(n)}catch{return t}return t}return t}function rN(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let Kl=null;function Qc(t){Kl&&Kl.classList.remove("selected-node"),Kl=t,Kl&&Kl.classList.add("selected-node")}function Hj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),Qc(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),rN(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),Qc(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function Nj(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),Ef(e,o,n,r.rootJsonData,r.depth+1,r),o}function Ef(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=Hj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=Nj(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function Dj(){return Kl?Kl.dataset.path:null}function $j(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function kj(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var Fg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Oh=function(t){return t&&t.Math===Math&&t},bn=Oh(typeof globalThis=="object"&&globalThis)||Oh(typeof window=="object"&&window)||Oh(typeof self=="object"&&self)||Oh(typeof Fg=="object"&&Fg)||Oh(typeof Fg=="object"&&Fg)||function(){return this}()||Function("return this")(),F0={},kn=function(t){try{return!!t()}catch{return!0}},Lj=kn,_i=!Lj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Fj=kn,Tv=!Fj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Vj=Tv,Vg=Function.prototype.call,Sn=Vj?Vg.bind(Vg):function(){return Vg.apply(Vg,arguments)},iN={},oN={}.propertyIsEnumerable,sN=Object.getOwnPropertyDescriptor,Bj=sN&&!oN.call({1:2},1);iN.f=Bj?function(e){var n=sN(this,e);return!!n&&n.enumerable}:oN;var Mv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},aN=Tv,lN=Function.prototype,XS=lN.call,Wj=aN&&lN.bind.bind(XS,XS),mn=aN?Wj:function(t){return function(){return XS.apply(t,arguments)}},uN=mn,jj=uN({}.toString),Uj=uN("".slice),Su=function(t){return Uj(jj(t),8,-1)},zj=mn,Yj=kn,Gj=Su,Ny=Object,Kj=zj("".split),qj=Yj(function(){return!Ny("z").propertyIsEnumerable(0)})?function(t){return Gj(t)==="String"?Kj(t,""):Ny(t)}:Ny,V0=function(t){return t==null},Xj=V0,Jj=TypeError,ng=function(t){if(Xj(t))throw new Jj("Can't call method on "+t);return t},Zj=qj,Qj=ng,rg=function(t){return Zj(Qj(t))},Dy=typeof document=="object"&&document.all,Rn=typeof Dy>"u"&&Dy!==void 0?function(t){return typeof t=="function"||t===Dy}:function(t){return typeof t=="function"},eU=Rn,xi=function(t){return typeof t=="object"?t!==null:eU(t)},$y=bn,tU=Rn,nU=function(t){return tU(t)?t:void 0},hh=function(t,e){return arguments.length<2?nU($y[t]):$y[t]&&$y[t][e]},rU=mn,ig=rU({}.isPrototypeOf),iU=bn,Px=iU.navigator,Ix=Px&&Px.userAgent,_v=Ix?String(Ix):"",cN=bn,ky=_v,Ox=cN.process,Ax=cN.Deno,Hx=Ox&&Ox.versions||Ax&&Ax.version,Nx=Hx&&Hx.v8,Qi,yw;Nx&&(Qi=Nx.split("."),yw=Qi[0]>0&&Qi[0]<4?1:+(Qi[0]+Qi[1]));!yw&&ky&&(Qi=ky.match(/Edge\/(\d+)/),(!Qi||Qi[1]>=74)&&(Qi=ky.match(/Chrome\/(\d+)/),Qi&&(yw=+Qi[1])));var oU=yw,Dx=oU,sU=kn,aU=bn,lU=aU.String,B0=!!Object.getOwnPropertySymbols&&!sU(function(){var t=Symbol("symbol detection");return!lU(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Dx&&Dx<41}),uU=B0,hN=uU&&!Symbol.sham&&typeof Symbol.iterator=="symbol",cU=hh,hU=Rn,dU=ig,fU=hN,gU=Object,W0=fU?function(t){return typeof t=="symbol"}:function(t){var e=cU("Symbol");return hU(e)&&dU(e.prototype,gU(t))},mU=String,xv=function(t){try{return mU(t)}catch{return"Object"}},pU=Rn,wU=xv,vU=TypeError,Lr=function(t){if(pU(t))return t;throw new vU(wU(t)+" is not a function")},yU=Lr,CU=V0,og=function(t,e){var n=t[e];return CU(n)?void 0:yU(n)},Ly=Sn,Fy=Rn,Vy=xi,bU=TypeError,SU=function(t,e){var n,r;if(e==="string"&&Fy(n=t.toString)&&!Vy(r=Ly(n,t))||Fy(n=t.valueOf)&&!Vy(r=Ly(n,t))||e!=="string"&&Fy(n=t.toString)&&!Vy(r=Ly(n,t)))return r;throw new bU("Can't convert object to primitive value")},dN={exports:{}},$x=bn,RU=Object.defineProperty,j0=function(t,e){try{RU($x,t,{value:e,configurable:!0,writable:!0})}catch{$x[t]=e}return e},EU=bn,TU=j0,kx="__core-js_shared__",Lx=dN.exports=EU[kx]||TU(kx,{});(Lx.versions||(Lx.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var U0=dN.exports,Fx=U0,fN=function(t,e){return Fx[t]||(Fx[t]=e||{})},MU=ng,_U=Object,dh=function(t){return _U(MU(t))},xU=mn,PU=dh,IU=xU({}.hasOwnProperty),Pi=Object.hasOwn||function(e,n){return IU(PU(e),n)},OU=mn,AU=0,HU=Math.random(),NU=OU(1 .toString),gN=function(t){return"Symbol("+(t===void 0?"":t)+")_"+NU(++AU+HU,36)},DU=bn,$U=fN,Vx=Pi,kU=gN,LU=B0,FU=hN,Oc=DU.Symbol,By=$U("wks"),VU=FU?Oc.for||Oc:Oc&&Oc.withoutSetter||kU,lo=function(t){return Vx(By,t)||(By[t]=LU&&Vx(Oc,t)?Oc[t]:VU("Symbol."+t)),By[t]},BU=Sn,Bx=xi,Wx=W0,WU=og,jU=SU,UU=lo,zU=TypeError,YU=UU("toPrimitive"),GU=function(t,e){if(!Bx(t)||Wx(t))return t;var n=WU(t,YU),r;if(n){if(e===void 0&&(e="default"),r=BU(n,t,e),!Bx(r)||Wx(r))return r;throw new zU("Can't convert object to primitive value")}return e===void 0&&(e="number"),jU(t,e)},KU=GU,qU=W0,mN=function(t){var e=KU(t,"string");return qU(e)?e:e+""},XU=bn,jx=xi,JS=XU.document,JU=jx(JS)&&jx(JS.createElement),z0=function(t){return JU?JS.createElement(t):{}},ZU=_i,QU=kn,ez=z0,pN=!ZU&&!QU(function(){return Object.defineProperty(ez("div"),"a",{get:function(){return 7}}).a!==7}),tz=_i,nz=Sn,rz=iN,iz=Mv,oz=rg,sz=mN,az=Pi,lz=pN,Ux=Object.getOwnPropertyDescriptor;F0.f=tz?Ux:function(e,n){if(e=oz(e),n=sz(n),lz)try{return Ux(e,n)}catch{}if(az(e,n))return iz(!nz(rz.f,e,n),e[n])};var Xs={},uz=_i,cz=kn,wN=uz&&cz(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),hz=xi,dz=String,fz=TypeError,En=function(t){if(hz(t))return t;throw new fz(dz(t)+" is not an object")},gz=_i,mz=pN,pz=wN,Bg=En,zx=mN,wz=TypeError,Wy=Object.defineProperty,vz=Object.getOwnPropertyDescriptor,jy="enumerable",Uy="configurable",zy="writable";Xs.f=gz?pz?function(e,n,r){if(Bg(e),n=zx(n),Bg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&zy in r&&!r[zy]){var i=vz(e,n);i&&i[zy]&&(e[n]=r.value,r={configurable:Uy in r?r[Uy]:i[Uy],enumerable:jy in r?r[jy]:i[jy],writable:!1})}return Wy(e,n,r)}:Wy:function(e,n,r){if(Bg(e),n=zx(n),Bg(r),mz)try{return Wy(e,n,r)}catch{}if("get"in r||"set"in r)throw new wz("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var yz=_i,Cz=Xs,bz=Mv,fh=yz?function(t,e,n){return Cz.f(t,e,bz(1,n))}:function(t,e,n){return t[e]=n,t},vN={exports:{}},ZS=_i,Sz=Pi,yN=Function.prototype,Rz=ZS&&Object.getOwnPropertyDescriptor,Ez=Sz(yN,"name"),Tz=Ez&&(!ZS||ZS&&Rz(yN,"name").configurable),Mz={CONFIGURABLE:Tz},_z=mn,xz=Rn,QS=U0,Pz=_z(Function.toString);xz(QS.inspectSource)||(QS.inspectSource=function(t){return Pz(t)});var Iz=QS.inspectSource,Oz=bn,Az=Rn,Yx=Oz.WeakMap,Hz=Az(Yx)&&/native code/.test(String(Yx)),Nz=fN,Dz=gN,Gx=Nz("keys"),Y0=function(t){return Gx[t]||(Gx[t]=Dz(t))},G0={},$z=Hz,CN=bn,kz=xi,Lz=fh,Yy=Pi,Gy=U0,Fz=Y0,Vz=G0,Kx="Object already initialized",eR=CN.TypeError,Bz=CN.WeakMap,Cw,Tf,bw,Wz=function(t){return bw(t)?Tf(t):Cw(t,{})},jz=function(t){return function(e){var n;if(!kz(e)||(n=Tf(e)).type!==t)throw new eR("Incompatible receiver, "+t+" required");return n}};if($z||Gy.state){var go=Gy.state||(Gy.state=new Bz);go.get=go.get,go.has=go.has,go.set=go.set,Cw=function(t,e){if(go.has(t))throw new eR(Kx);return e.facade=t,go.set(t,e),e},Tf=function(t){return go.get(t)||{}},bw=function(t){return go.has(t)}}else{var $u=Fz("state");Vz[$u]=!0,Cw=function(t,e){if(Yy(t,$u))throw new eR(Kx);return e.facade=t,Lz(t,$u,e),e},Tf=function(t){return Yy(t,$u)?t[$u]:{}},bw=function(t){return Yy(t,$u)}}var bN={set:Cw,get:Tf,has:bw,enforce:Wz,getterFor:jz},K0=mn,Uz=kn,zz=Rn,Wg=Pi,tR=_i,Yz=Mz.CONFIGURABLE,Gz=Iz,SN=bN,Kz=SN.enforce,qz=SN.get,qx=String,Op=Object.defineProperty,Xz=K0("".slice),Jz=K0("".replace),Zz=K0([].join),Qz=tR&&!Uz(function(){return Op(function(){},"length",{value:8}).length!==8}),eY=String(String).split("String"),tY=vN.exports=function(t,e,n){Xz(qx(e),0,7)==="Symbol("&&(e="["+Jz(qx(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Wg(t,"name")||Yz&&t.name!==e)&&(tR?Op(t,"name",{value:e,configurable:!0}):t.name=e),Qz&&n&&Wg(n,"arity")&&t.length!==n.arity&&Op(t,"length",{value:n.arity});try{n&&Wg(n,"constructor")&&n.constructor?tR&&Op(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=Kz(t);return Wg(r,"source")||(r.source=Zz(eY,typeof e=="string"?e:"")),t};Function.prototype.toString=tY(function(){return zz(this)&&qz(this).source||Gz(this)},"toString");var RN=vN.exports,nY=Rn,rY=Xs,iY=RN,oY=j0,q0=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(nY(n)&&iY(n,o,r),r.global)i?t[e]=n:oY(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:rY.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},EN={},sY=Math.ceil,aY=Math.floor,lY=Math.trunc||function(e){var n=+e;return(n>0?aY:sY)(n)},uY=lY,sg=function(t){var e=+t;return e!==e||e===0?0:uY(e)},cY=sg,hY=Math.max,dY=Math.min,fY=function(t,e){var n=cY(t);return n<0?hY(n+e,0):dY(n,e)},gY=sg,mY=Math.min,pY=function(t){var e=gY(t);return e>0?mY(e,9007199254740991):0},wY=pY,gh=function(t){return wY(t.length)},vY=rg,yY=fY,CY=gh,bY=function(t){return function(e,n,r){var i=vY(e),o=CY(i);if(o===0)return!t&&-1;var s=yY(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},SY={indexOf:bY(!1)},RY=mn,Ky=Pi,EY=rg,TY=SY.indexOf,MY=G0,Xx=RY([].push),TN=function(t,e){var n=EY(t),r=0,i=[],o;for(o in n)!Ky(MY,o)&&Ky(n,o)&&Xx(i,o);for(;e.length>r;)Ky(n,o=e[r++])&&(~TY(i,o)||Xx(i,o));return i},X0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_Y=TN,xY=X0,PY=xY.concat("length","prototype");EN.f=Object.getOwnPropertyNames||function(e){return _Y(e,PY)};var MN={};MN.f=Object.getOwnPropertySymbols;var IY=hh,OY=mn,AY=EN,HY=MN,NY=En,DY=OY([].concat),$Y=IY("Reflect","ownKeys")||function(e){var n=AY.f(NY(e)),r=HY.f;return r?DY(n,r(e)):n},Jx=Pi,kY=$Y,LY=F0,FY=Xs,_N=function(t,e,n){for(var r=kY(e),i=FY.f,o=LY.f,s=0;s<r.length;s++){var a=r[s];!Jx(t,a)&&!(n&&Jx(n,a))&&i(t,a,o(e,a))}},VY=kn,BY=Rn,WY=/#|\.prototype\./,ag=function(t,e){var n=UY[jY(t)];return n===YY?!0:n===zY?!1:BY(e)?VY(e):!!e},jY=ag.normalize=function(t){return String(t).replace(WY,".").toLowerCase()},UY=ag.data={},zY=ag.NATIVE="N",YY=ag.POLYFILL="P",GY=ag,jg=bn,KY=F0.f,qY=fh,XY=q0,JY=j0,ZY=_N,QY=GY,Et=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=jg:i?s=jg[n]||JY(n,{}):s=jg[n]&&jg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=KY(s,a),l=c&&c.value):l=s[a],o=QY(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;ZY(u,l)}(t.sham||l&&l.sham)&&qY(u,"sham",!0),XY(s,a,u,t)}},eG=Tv,xN=Function.prototype,Zx=xN.apply,Qx=xN.call,lg=typeof Reflect=="object"&&Reflect.apply||(eG?Qx.bind(Zx):function(){return Qx.apply(Zx,arguments)}),tG=mn,nG=Lr,PN=function(t,e,n){try{return tG(nG(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},rG=xi,iG=function(t){return rG(t)||t===null},oG=iG,sG=String,aG=TypeError,lG=function(t){if(oG(t))return t;throw new aG("Can't set "+sG(t)+" as a prototype")},uG=PN,cG=xi,hG=ng,dG=lG,IN=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=uG(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return hG(i),dG(o),cG(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),fG=Xs.f,gG=function(t,e,n){n in t||fG(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},mG=Rn,pG=xi,eP=IN,wG=function(t,e,n){var r,i;return eP&&mG(r=e.constructor)&&r!==n&&pG(i=r.prototype)&&i!==n.prototype&&eP(t,i),t},vG=lo,yG=vG("toStringTag"),ON={};ON[yG]="z";var CG=String(ON)==="[object z]",bG=CG,SG=Rn,Ap=Su,RG=lo,EG=RG("toStringTag"),TG=Object,MG=Ap(function(){return arguments}())==="Arguments",_G=function(t,e){try{return t[e]}catch{}},AN=bG?Ap:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=_G(e=TG(t),EG))=="string"?n:MG?Ap(e):(r=Ap(e))==="Object"&&SG(e.callee)?"Arguments":r},xG=AN,PG=String,Pv=function(t){if(xG(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return PG(t)},IG=Pv,OG=function(t,e){return t===void 0?arguments.length<2?"":e:IG(t)},AG=xi,HG=fh,NG=function(t,e){AG(e)&&"cause"in e&&HG(t,"cause",e.cause)},DG=mn,HN=Error,$G=DG("".replace),kG=function(t){return String(new HN(t).stack)}("zxcasd"),NN=/\n\s*at [^:]*:[^\n]*/,LG=NN.test(kG),FG=function(t,e){if(LG&&typeof t=="string"&&!HN.prepareStackTrace)for(;e--;)t=$G(t,NN,"");return t},VG=kn,BG=Mv,WG=!VG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",BG(1,7)),t.stack!==7):!0}),jG=fh,UG=FG,zG=WG,tP=Error.captureStackTrace,YG=function(t,e,n,r){zG&&(tP?tP(t,e):jG(t,"stack",UG(n,r)))},nP=hh,GG=Pi,rP=fh,KG=ig,iP=IN,oP=_N,sP=gG,qG=wG,XG=OG,JG=NG,ZG=YG,QG=_i,eK=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=nP.apply(null,s);if(l){var u=l.prototype;if(GG(u,"cause")&&delete u.cause,!n)return l;var c=nP("Error"),h=e(function(d,f){var g=XG(r?f:d,void 0),p=r?new l(d):new l;return g!==void 0&&rP(p,"message",g),ZG(p,h,p.stack,2),this&&KG(u,this)&&qG(p,this,h),arguments.length>o&&JG(p,arguments[o]),p});h.prototype=u,a!=="Error"?iP?iP(h,c):oP(h,c,{name:!0}):QG&&i in l&&(sP(h,l,i),sP(h,l,"prepareStackTrace")),oP(h,l);try{u.name!==a&&rP(u,"name",a),u.constructor=h}catch{}return h}},DN=Et,tK=bn,es=lg,$N=eK,nR="WebAssembly",aP=tK[nR],Sw=new Error("e",{cause:7}).cause!==7,Ru=function(t,e){var n={};n[t]=$N(t,e,Sw),DN({global:!0,constructor:!0,arity:1,forced:Sw},n)},J0=function(t,e){if(aP&&aP[t]){var n={};n[t]=$N(nR+"."+t,e,Sw),DN({target:nR,stat:!0,constructor:!0,arity:1,forced:Sw},n)}};Ru("Error",function(t){return function(n){return es(t,this,arguments)}});Ru("EvalError",function(t){return function(n){return es(t,this,arguments)}});Ru("RangeError",function(t){return function(n){return es(t,this,arguments)}});Ru("ReferenceError",function(t){return function(n){return es(t,this,arguments)}});Ru("SyntaxError",function(t){return function(n){return es(t,this,arguments)}});Ru("TypeError",function(t){return function(n){return es(t,this,arguments)}});Ru("URIError",function(t){return function(n){return es(t,this,arguments)}});J0("CompileError",function(t){return function(n){return es(t,this,arguments)}});J0("LinkError",function(t){return function(n){return es(t,this,arguments)}});J0("RuntimeError",function(t){return function(n){return es(t,this,arguments)}});var nK=Su,kN=Array.isArray||function(e){return nK(e)==="Array"},rK=_i,iK=kN,oK=TypeError,sK=Object.getOwnPropertyDescriptor,aK=rK&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),LN=aK?function(t,e){if(iK(t)&&!sK(t,"length").writable)throw new oK("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},lK=TypeError,uK=9007199254740991,FN=function(t){if(t>uK)throw lK("Maximum allowed index exceeded");return t},cK=Et,hK=dh,dK=gh,fK=LN,gK=FN,mK=kn,pK=mK(function(){return[].push.call({length:4294967296},1)!==4294967297}),wK=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},vK=pK||!wK();cK({target:"Array",proto:!0,arity:1,forced:vK},{push:function(e){var n=hK(this),r=dK(n),i=arguments.length;gK(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return fK(n,r),r}});var yK=Su,CK=mn,bK=function(t){if(yK(t)==="Function")return CK(t)},lP=bK,SK=Lr,RK=Tv,EK=lP(lP.bind),VN=function(t,e){return SK(t),e===void 0?t:RK?EK(t,e):function(){return t.apply(e,arguments)}},BN={},TK=lo,MK=BN,_K=TK("iterator"),xK=Array.prototype,PK=function(t){return t!==void 0&&(MK.Array===t||xK[_K]===t)},IK=AN,uP=og,OK=V0,AK=BN,HK=lo,NK=HK("iterator"),Z0=function(t){if(!OK(t))return uP(t,NK)||uP(t,"@@iterator")||AK[IK(t)]},DK=Sn,$K=Lr,kK=En,LK=xv,FK=Z0,VK=TypeError,BK=function(t,e){var n=arguments.length<2?FK(t):e;if($K(n))return kK(DK(n,t));throw new VK(LK(t)+" is not iterable")},WK=Sn,cP=En,jK=og,ni=function(t,e,n){var r,i;cP(t);try{if(r=jK(t,"return"),!r){if(e==="throw")throw n;return n}r=WK(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return cP(r),n},UK=VN,zK=Sn,YK=En,GK=xv,KK=PK,qK=gh,hP=ig,XK=BK,JK=Z0,dP=ni,ZK=TypeError,Hp=function(t,e){this.stopped=t,this.result=e},fP=Hp.prototype,mh=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=UK(e,r),u,c,h,d,f,g,p,C=function(y){return u&&dP(u,"normal",y),new Hp(!0,y)},E=function(y){return i?(YK(y),a?l(y[0],y[1],C):l(y[0],y[1])):a?l(y,C):l(y)};if(o)u=t.iterator;else if(s)u=t;else{if(c=JK(t),!c)throw new ZK(GK(t)+" is not iterable");if(KK(c)){for(h=0,d=qK(t);d>h;h++)if(f=E(t[h]),f&&hP(fP,f))return f;return new Hp(!1)}u=XK(t,c)}for(g=o?t.next:u.next;!(p=zK(g,u)).done;){try{f=E(p.value)}catch(y){dP(u,"throw",y)}if(typeof f=="object"&&f&&hP(fP,f))return f}return new Hp(!1)},QK=_i,e3=Xs,t3=Mv,WN=function(t,e,n){QK?e3.f(t,e,t3(0,n)):t[e]=n},n3=Et,r3=mh,i3=WN;n3({target:"Object",stat:!0},{fromEntries:function(e){var n={};return r3(e,function(r,i){i3(n,r,i)},{AS_ENTRIES:!0}),n}});var qy=mn,Ug=Set.prototype,ts={Set,add:qy(Ug.add),has:qy(Ug.has),remove:qy(Ug.delete),proto:Ug},o3=ts.has,Eu=function(t){return o3(t),t},s3=Sn,Tu=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=s3(i,r)).done;)if(s=e(o.value),s!==void 0)return s},jN=mn,a3=Tu,UN=ts,l3=UN.Set,zN=UN.proto,u3=jN(zN.forEach),YN=jN(zN.keys),c3=YN(new l3).next,ug=function(t,e,n){return n?a3({iterator:YN(t),next:c3},e):u3(t,e)},GN=ts,h3=ug,d3=GN.Set,f3=GN.add,Q0=function(t){var e=new d3;return h3(t,function(n){f3(e,n)}),e},g3=PN,m3=ts,cg=g3(m3.proto,"size","get")||function(t){return t.size},ns=function(t){return{iterator:t,next:t.next,done:!1}},gP=Lr,KN=En,mP=Sn,p3=sg,w3=ns,pP="Invalid size",v3=RangeError,y3=TypeError,C3=Math.max,qN=function(t,e){this.set=t,this.size=C3(e,0),this.has=gP(t.has),this.keys=gP(t.keys)};qN.prototype={getIterator:function(){return w3(KN(mP(this.keys,this.set)))},includes:function(t){return mP(this.has,this.set,t)}};var Mu=function(t){KN(t);var e=+t.size;if(e!==e)throw new y3(pP);var n=p3(e);if(n<0)throw new v3(pP);return new qN(t,n)},b3=Eu,XN=ts,S3=Q0,R3=cg,E3=Mu,T3=ug,M3=Tu,_3=XN.has,wP=XN.remove,x3=function(e){var n=b3(this),r=E3(e),i=S3(n);return R3(n)<=r.size?T3(n,function(o){r.includes(o)&&wP(i,o)}):M3(r.getIterator(),function(o){_3(n,o)&&wP(i,o)}),i},P3=hh,vP=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},yP=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},_u=function(t,e){var n=P3("Set");try{new n()[t](vP(0));try{return new n()[t](vP(-1)),!1}catch{if(!e)return!0;try{return new n()[t](yP(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](yP(1/0)))}}}catch{return!1}},I3=Et,O3=x3,A3=_u,H3=!A3("difference",function(t){return t.size===0});I3({target:"Set",proto:!0,real:!0,forced:H3},{difference:O3});var N3=Eu,eE=ts,D3=cg,$3=Mu,k3=ug,L3=Tu,F3=eE.Set,CP=eE.add,V3=eE.has,B3=function(e){var n=N3(this),r=$3(e),i=new F3;return D3(n)>r.size?L3(r.getIterator(),function(o){V3(n,o)&&CP(i,o)}):k3(n,function(o){r.includes(o)&&CP(i,o)}),i},W3=Et,j3=kn,U3=B3,z3=_u,Y3=!z3("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||j3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});W3({target:"Set",proto:!0,real:!0,forced:Y3},{intersection:U3});var G3=Eu,K3=ts.has,q3=cg,X3=Mu,J3=ug,Z3=Tu,Q3=ni,e5=function(e){var n=G3(this),r=X3(e);if(q3(n)<=r.size)return J3(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return Z3(i,function(o){if(K3(n,o))return Q3(i,"normal",!1)})!==!1},t5=Et,n5=e5,r5=_u,i5=!r5("isDisjointFrom",function(t){return!t});t5({target:"Set",proto:!0,real:!0,forced:i5},{isDisjointFrom:n5});var o5=Eu,s5=cg,a5=ug,l5=Mu,u5=function(e){var n=o5(this),r=l5(e);return s5(n)>r.size?!1:a5(n,function(i){if(!r.includes(i))return!1},!0)!==!1},c5=Et,h5=u5,d5=_u,f5=!d5("isSubsetOf",function(t){return t});c5({target:"Set",proto:!0,real:!0,forced:f5},{isSubsetOf:h5});var g5=Eu,m5=ts.has,p5=cg,w5=Mu,v5=Tu,y5=ni,C5=function(e){var n=g5(this),r=w5(e);if(p5(n)<r.size)return!1;var i=r.getIterator();return v5(i,function(o){if(!m5(n,o))return y5(i,"normal",!1)})!==!1},b5=Et,S5=C5,R5=_u,E5=!R5("isSupersetOf",function(t){return!t});b5({target:"Set",proto:!0,real:!0,forced:E5},{isSupersetOf:S5});var T5=Eu,tE=ts,M5=Q0,_5=Mu,x5=Tu,P5=tE.add,I5=tE.has,O5=tE.remove,A5=function(e){var n=T5(this),r=_5(e).getIterator(),i=M5(n);return x5(r,function(o){I5(n,o)?O5(i,o):P5(i,o)}),i},H5=Et,N5=A5,D5=_u;H5({target:"Set",proto:!0,real:!0,forced:!D5("symmetricDifference")},{symmetricDifference:N5});var $5=Eu,k5=ts.add,L5=Q0,F5=Mu,V5=Tu,B5=function(e){var n=$5(this),r=F5(e).getIterator(),i=L5(n);return V5(r,function(o){k5(i,o)}),i},W5=Et,j5=B5,U5=_u;W5({target:"Set",proto:!0,real:!0,forced:!U5("union")},{union:j5});var z5=ig,Y5=TypeError,G5=function(t,e){if(z5(e,t))return t;throw new Y5("Incorrect invocation")},K5=kn,q5=!K5(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),X5=Pi,J5=Rn,Z5=dh,Q5=Y0,eq=q5,bP=Q5("IE_PROTO"),rR=Object,tq=rR.prototype,JN=eq?rR.getPrototypeOf:function(t){var e=Z5(t);if(X5(e,bP))return e[bP];var n=e.constructor;return J5(n)&&e instanceof n?n.prototype:e instanceof rR?tq:null},SP=RN,nq=Xs,rq=function(t,e,n){return n.get&&SP(n.get,e,{getter:!0}),n.set&&SP(n.set,e,{setter:!0}),nq.f(t,e,n)},ZN={},iq=TN,oq=X0,sq=Object.keys||function(e){return iq(e,oq)},aq=_i,lq=wN,uq=Xs,cq=En,hq=rg,dq=sq;ZN.f=aq&&!lq?Object.defineProperties:function(e,n){cq(e);for(var r=hq(n),i=dq(n),o=i.length,s=0,a;o>s;)uq.f(e,a=i[s++],r[a]);return e};var fq=hh,QN=fq("document","documentElement"),gq=En,mq=ZN,RP=X0,pq=G0,wq=QN,vq=z0,yq=Y0,EP=">",TP="<",iR="prototype",oR="script",eD=yq("IE_PROTO"),Xy=function(){},tD=function(t){return TP+oR+EP+t+TP+"/"+oR+EP},MP=function(t){t.write(tD("")),t.close();var e=t.parentWindow.Object;return t=null,e},Cq=function(){var t=vq("iframe"),e="java"+oR+":",n;return t.style.display="none",wq.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(tD("document.F=Object")),n.close(),n.F},zg,Np=function(){try{zg=new ActiveXObject("htmlfile")}catch{}Np=typeof document<"u"?document.domain&&zg?MP(zg):Cq():MP(zg);for(var t=RP.length;t--;)delete Np[iR][RP[t]];return Np()};pq[eD]=!0;var nD=Object.create||function(e,n){var r;return e!==null?(Xy[iR]=gq(e),r=new Xy,Xy[iR]=null,r[eD]=e):r=Np(),n===void 0?r:mq.f(r,n)},bq=kn,Sq=Rn,Rq=xi,_P=JN,Eq=q0,Tq=lo,sR=Tq("iterator"),hu,Jy,Zy;[].keys&&(Zy=[].keys(),"next"in Zy&&(Jy=_P(_P(Zy)),Jy!==Object.prototype&&(hu=Jy)));var Mq=!Rq(hu)||bq(function(){var t={};return hu[sR].call(t)!==t});Mq&&(hu={});Sq(hu[sR])||Eq(hu,sR,function(){return this});var rD={IteratorPrototype:hu},_q=Et,xq=bn,Pq=G5,Iq=En,Oq=Rn,Aq=JN,Hq=rq,Nq=WN,Dq=kn,nE=Pi,$q=lo,Ko=rD.IteratorPrototype,kq=_i,Qy="constructor",iD="Iterator",xP=$q("toStringTag"),oD=TypeError,eC=xq[iD],sD=!Oq(eC)||eC.prototype!==Ko||!Dq(function(){eC({})}),rE=function(){if(Pq(this,Ko),Aq(this)===Ko)throw new oD("Abstract class Iterator not directly constructable")},aD=function(t,e){kq?Hq(Ko,t,{configurable:!0,get:function(){return e},set:function(n){if(Iq(this),this===Ko)throw new oD("You can't redefine this property");nE(this,t)?this[t]=n:Nq(this,t,n)}}):Ko[t]=e};nE(Ko,xP)||aD(xP,iD);(sD||!nE(Ko,Qy)||Ko[Qy]===Object)&&aD(Qy,rE);rE.prototype=Ko;_q({global:!0,constructor:!0,forced:sD},{Iterator:rE});var Lq=q0,Fq=function(t,e,n){for(var r in e)Lq(t,r,e[r],n);return t},Vq=function(t,e){return{value:t,done:e}},Bq=Sn,Wq=nD,jq=fh,Uq=Fq,zq=lo,lD=bN,Yq=og,Gq=rD.IteratorPrototype,Yg=Vq,tC=ni,Kq=zq("toStringTag"),uD="IteratorHelper",cD="WrapForValidIterator",qq=lD.set,hD=function(t){var e=lD.getterFor(t?cD:uD);return Uq(Wq(Gq),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return Yg(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:Yg(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=Yq(r,"return");return i?Bq(i,r):Yg(void 0,!0)}if(n.inner)try{tC(n.inner.iterator,"normal")}catch(o){return tC(r,"throw",o)}return r&&tC(r,"normal"),Yg(void 0,!0)}})},Xq=hD(!0),dD=hD(!1);jq(dD,Kq,"Iterator Helper");var iE=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?cD:uD,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,qq(this,s)};return r.prototype=e?Xq:dD,r},Jq=En,Zq=ni,fD=function(t,e,n,r){try{return r?e(Jq(n)[0],n[1]):e(n)}catch(i){Zq(t,"throw",i)}},Qq=bn,Za=function(t,e){var n=Qq.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},e4=Et,gD=Sn,t4=Lr,mD=En,n4=ns,r4=iE,i4=fD,o4=ni,s4=Za,nC=s4("filter",TypeError),a4=r4(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=mD(gD(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,i4(t,e,[o,this.counter++],!0))return o}});e4({target:"Iterator",proto:!0,real:!0,forced:nC},{filter:function(e){mD(this);try{t4(e)}catch(n){o4(this,"throw",n)}return nC?gD(nC,this,e):new a4(n4(this),{predicate:e})}});var l4=Et,u4=Sn,c4=mh,h4=Lr,d4=En,f4=ns,g4=ni,m4=Za,rC=m4("forEach",TypeError);l4({target:"Iterator",proto:!0,real:!0,forced:rC},{forEach:function(e){d4(this);try{h4(e)}catch(i){g4(this,"throw",i)}if(rC)return u4(rC,this,e);var n=f4(this),r=0;c4(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var p4=Et,pD=Sn,w4=Lr,wD=En,v4=ns,y4=iE,C4=fD,b4=ni,S4=Za,iC=S4("map",TypeError),R4=y4(function(){var t=this.iterator,e=wD(pD(this.next,t)),n=this.done=!!e.done;if(!n)return C4(t,this.mapper,[e.value,this.counter++],!0)});p4({target:"Iterator",proto:!0,real:!0,forced:iC},{map:function(e){wD(this);try{w4(e)}catch(n){b4(this,"throw",n)}return iC?pD(iC,this,e):new R4(v4(this),{mapper:e})}});var E4=mn,oE=E4([].slice),T4=TypeError,vD=function(t,e){if(t<e)throw new T4("Not enough arguments");return t},M4=_v,_4=/(?:ipad|iphone|ipod).*applewebkit/i.test(M4),Ah=bn,x4=_v,P4=Su,Gg=function(t){return x4.slice(0,t.length)===t},yD=function(){return Gg("Bun/")?"BUN":Gg("Cloudflare-Workers")?"CLOUDFLARE":Gg("Deno/")?"DENO":Gg("Node.js/")?"NODE":Ah.Bun&&typeof Bun.version=="string"?"BUN":Ah.Deno&&typeof Deno.version=="object"?"DENO":P4(Ah.process)==="process"?"NODE":Ah.window&&Ah.document?"BROWSER":"REST"}(),I4=yD,O4=I4==="NODE",Zr=bn,A4=lg,H4=VN,PP=Rn,N4=Pi,CD=kn,IP=QN,D4=oE,OP=z0,$4=vD,k4=_4,L4=O4,aR=Zr.setImmediate,lR=Zr.clearImmediate,F4=Zr.process,oC=Zr.Dispatch,V4=Zr.Function,AP=Zr.MessageChannel,B4=Zr.String,sC=0,Yd={},HP="onreadystatechange",Mf,il,aC,lC;CD(function(){Mf=Zr.location});var sE=function(t){if(N4(Yd,t)){var e=Yd[t];delete Yd[t],e()}},uC=function(t){return function(){sE(t)}},NP=function(t){sE(t.data)},DP=function(t){Zr.postMessage(B4(t),Mf.protocol+"//"+Mf.host)};(!aR||!lR)&&(aR=function(e){$4(arguments.length,1);var n=PP(e)?e:V4(e),r=D4(arguments,1);return Yd[++sC]=function(){A4(n,void 0,r)},il(sC),sC},lR=function(e){delete Yd[e]},L4?il=function(t){F4.nextTick(uC(t))}:oC&&oC.now?il=function(t){oC.now(uC(t))}:AP&&!k4?(aC=new AP,lC=aC.port2,aC.port1.onmessage=NP,il=H4(lC.postMessage,lC)):Zr.addEventListener&&PP(Zr.postMessage)&&!Zr.importScripts&&Mf&&Mf.protocol!=="file:"&&!CD(DP)?(il=DP,Zr.addEventListener("message",NP,!1)):HP in OP("script")?il=function(t){IP.appendChild(OP("script"))[HP]=function(){IP.removeChild(this),sE(t)}}:il=function(t){setTimeout(uC(t),0)});var bD={set:aR,clear:lR},W4=Et,j4=bn,$P=bD.clear;W4({global:!0,bind:!0,enumerable:!0,forced:j4.clearImmediate!==$P},{clearImmediate:$P});var SD=bn,U4=lg,z4=Rn,Y4=yD,G4=_v,K4=oE,q4=vD,X4=SD.Function,J4=/MSIE .\./.test(G4)||Y4==="BUN"&&function(){var t=SD.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),Z4=function(t,e){var n=e?2:1;return J4?function(r,i){var o=q4(arguments.length,1)>n,s=z4(r)?r:X4(r),a=o?K4(arguments,n):[],l=o?function(){U4(s,this,a)}:s;return e?t(l,i):t(l)}:t},Q4=Et,RD=bn,kP=bD.set,eX=Z4,LP=RD.setImmediate?eX(kP,!1):kP;Q4({global:!0,bind:!0,enumerable:!0,forced:RD.setImmediate!==LP},{setImmediate:LP});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:ED,setPrototypeOf:FP,isFrozen:tX,getPrototypeOf:nX,getOwnPropertyDescriptor:rX}=Object;let{freeze:gr,seal:Ti,create:TD}=Object,{apply:uR,construct:cR}=typeof Reflect<"u"&&Reflect;gr||(gr=function(e){return e});Ti||(Ti=function(e){return e});uR||(uR=function(e,n,r){return e.apply(n,r)});cR||(cR=function(e,n){return new e(...n)});const Kg=mr(Array.prototype.forEach),iX=mr(Array.prototype.lastIndexOf),VP=mr(Array.prototype.pop),Hh=mr(Array.prototype.push),oX=mr(Array.prototype.splice),Dp=mr(String.prototype.toLowerCase),cC=mr(String.prototype.toString),BP=mr(String.prototype.match),Nh=mr(String.prototype.replace),sX=mr(String.prototype.indexOf),aX=mr(String.prototype.trim),Ui=mr(Object.prototype.hasOwnProperty),ir=mr(RegExp.prototype.test),Dh=lX(TypeError);function mr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return uR(t,e,r)}}function lX(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return cR(t,n)}}function Ye(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Dp;FP&&FP(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(tX(e)||(e[r]=o),i=o)}t[i]=!0}return t}function uX(t){for(let e=0;e<t.length;e++)Ui(t,e)||(t[e]=null);return t}function Ul(t){const e=TD(null);for(const[n,r]of ED(t))Ui(t,n)&&(Array.isArray(r)?e[n]=uX(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Ul(r):e[n]=r);return e}function $h(t,e){for(;t!==null;){const r=rX(t,e);if(r){if(r.get)return mr(r.get);if(typeof r.value=="function")return mr(r.value)}t=nX(t)}function n(){return null}return n}const WP=gr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),hC=gr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),dC=gr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),cX=gr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),fC=gr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),hX=gr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),jP=gr(["#text"]),UP=gr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),gC=gr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),zP=gr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),qg=gr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),dX=Ti(/\{\{[\w\W]*|[\w\W]*\}\}/gm),fX=Ti(/<%[\w\W]*|[\w\W]*%>/gm),gX=Ti(/\$\{[\w\W]*/gm),mX=Ti(/^data-[\-\w.\u00B7-\uFFFF]+$/),pX=Ti(/^aria-[\-\w]+$/),MD=Ti(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wX=Ti(/^(?:\w+script|data):/i),vX=Ti(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_D=Ti(/^html$/i),yX=Ti(/^[a-z][.\w]*(-[.\w]+)+$/i);var YP=Object.freeze({__proto__:null,ARIA_ATTR:pX,ATTR_WHITESPACE:vX,CUSTOM_ELEMENT:yX,DATA_ATTR:mX,DOCTYPE_NAME:_D,ERB_EXPR:fX,IS_ALLOWED_URI:MD,IS_SCRIPT_OR_DATA:wX,MUSTACHE_EXPR:dX,TMPLIT_EXPR:gX});const kh={element:1,text:3,progressingInstruction:7,comment:8,document:9},CX=function(){return typeof window>"u"?null:window},bX=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},GP=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function xD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:CX();const e=ve=>xD(ve);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==kh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,p=$h(g,"cloneNode"),C=$h(g,"remove"),E=$h(g,"nextSibling"),y=$h(g,"childNodes"),T=$h(g,"parentNode");if(typeof s=="function"){const ve=n.createElement("template");ve.content&&ve.content.ownerDocument&&(n=ve.content.ownerDocument)}let M,I="";const{implementation:_,createNodeIterator:P,createDocumentFragment:Y,getElementsByTagName:V}=n,{importNode:B}=r;let Z=GP();e.isSupported=typeof ED=="function"&&typeof T=="function"&&_&&_.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:Q,TMPLIT_EXPR:se,DATA_ATTR:be,ARIA_ATTR:bt,IS_SCRIPT_OR_DATA:Ee,ATTR_WHITESPACE:Ne,CUSTOM_ELEMENT:lt}=YP;let{IS_ALLOWED_URI:On}=YP,ut=null;const m=Ye({},[...WP,...hC,...dC,...fC,...jP]);let v=null;const w=Ye({},[...UP,...gC,...zP,...qg]);let A=Object.seal(TD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,U=null,K=!0,J=!0,b=!1,R=!0,S=!1,k=!0,O=!1,N=!1,j=!1,H=!1,D=!1,W=!1,F=!0,G=!1;const ae="user-content-";let ce=!0,_e=!1,Be={},qe=null;const Me=Ye({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ue=null;const At=Ye({},["audio","video","img","source","image","track"]);let Ni=null;const as=Ye({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ii="http://www.w3.org/1998/Math/MathML",Ht="http://www.w3.org/2000/svg",wn="http://www.w3.org/1999/xhtml";let Tt=wn,Nt=!1,ze=null;const oi=Ye({},[ii,Ht,wn],cC);let tl=Ye({},["mi","mo","mn","ms","mtext"]),nl=Ye({},["annotation-xml"]);const qV=Ye({},["title","style","font","a","script"]);let _h=null;const XV=["application/xhtml+xml","text/html"],JV="text/html";let An=null,Du=null;const ZV=n.createElement("form"),ex=function($){return $ instanceof RegExp||$ instanceof Function},Py=function(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Du&&Du===$)){if((!$||typeof $!="object")&&($={}),$=Ul($),_h=XV.indexOf($.PARSER_MEDIA_TYPE)===-1?JV:$.PARSER_MEDIA_TYPE,An=_h==="application/xhtml+xml"?cC:Dp,ut=Ui($,"ALLOWED_TAGS")?Ye({},$.ALLOWED_TAGS,An):m,v=Ui($,"ALLOWED_ATTR")?Ye({},$.ALLOWED_ATTR,An):w,ze=Ui($,"ALLOWED_NAMESPACES")?Ye({},$.ALLOWED_NAMESPACES,cC):oi,Ni=Ui($,"ADD_URI_SAFE_ATTR")?Ye(Ul(as),$.ADD_URI_SAFE_ATTR,An):as,Ue=Ui($,"ADD_DATA_URI_TAGS")?Ye(Ul(At),$.ADD_DATA_URI_TAGS,An):At,qe=Ui($,"FORBID_CONTENTS")?Ye({},$.FORBID_CONTENTS,An):Me,L=Ui($,"FORBID_TAGS")?Ye({},$.FORBID_TAGS,An):{},U=Ui($,"FORBID_ATTR")?Ye({},$.FORBID_ATTR,An):{},Be=Ui($,"USE_PROFILES")?$.USE_PROFILES:!1,K=$.ALLOW_ARIA_ATTR!==!1,J=$.ALLOW_DATA_ATTR!==!1,b=$.ALLOW_UNKNOWN_PROTOCOLS||!1,R=$.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=$.SAFE_FOR_TEMPLATES||!1,k=$.SAFE_FOR_XML!==!1,O=$.WHOLE_DOCUMENT||!1,H=$.RETURN_DOM||!1,D=$.RETURN_DOM_FRAGMENT||!1,W=$.RETURN_TRUSTED_TYPE||!1,j=$.FORCE_BODY||!1,F=$.SANITIZE_DOM!==!1,G=$.SANITIZE_NAMED_PROPS||!1,ce=$.KEEP_CONTENT!==!1,_e=$.IN_PLACE||!1,On=$.ALLOWED_URI_REGEXP||MD,Tt=$.NAMESPACE||wn,tl=$.MATHML_TEXT_INTEGRATION_POINTS||tl,nl=$.HTML_INTEGRATION_POINTS||nl,A=$.CUSTOM_ELEMENT_HANDLING||{},$.CUSTOM_ELEMENT_HANDLING&&ex($.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(A.tagNameCheck=$.CUSTOM_ELEMENT_HANDLING.tagNameCheck),$.CUSTOM_ELEMENT_HANDLING&&ex($.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(A.attributeNameCheck=$.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),$.CUSTOM_ELEMENT_HANDLING&&typeof $.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(A.allowCustomizedBuiltInElements=$.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(J=!1),D&&(H=!0),Be&&(ut=Ye({},jP),v=[],Be.html===!0&&(Ye(ut,WP),Ye(v,UP)),Be.svg===!0&&(Ye(ut,hC),Ye(v,gC),Ye(v,qg)),Be.svgFilters===!0&&(Ye(ut,dC),Ye(v,gC),Ye(v,qg)),Be.mathMl===!0&&(Ye(ut,fC),Ye(v,zP),Ye(v,qg))),$.ADD_TAGS&&(ut===m&&(ut=Ul(ut)),Ye(ut,$.ADD_TAGS,An)),$.ADD_ATTR&&(v===w&&(v=Ul(v)),Ye(v,$.ADD_ATTR,An)),$.ADD_URI_SAFE_ATTR&&Ye(Ni,$.ADD_URI_SAFE_ATTR,An),$.FORBID_CONTENTS&&(qe===Me&&(qe=Ul(qe)),Ye(qe,$.FORBID_CONTENTS,An)),ce&&(ut["#text"]=!0),O&&Ye(ut,["html","head","body"]),ut.table&&(Ye(ut,["tbody"]),delete L.tbody),$.TRUSTED_TYPES_POLICY){if(typeof $.TRUSTED_TYPES_POLICY.createHTML!="function")throw Dh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof $.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Dh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');M=$.TRUSTED_TYPES_POLICY,I=M.createHTML("")}else M===void 0&&(M=bX(f,i)),M!==null&&typeof I=="string"&&(I=M.createHTML(""));gr&&gr($),Du=$}},tx=Ye({},[...hC,...dC,...cX]),nx=Ye({},[...fC,...hX]),QV=function($){let ne=T($);(!ne||!ne.tagName)&&(ne={namespaceURI:Tt,tagName:"template"});const me=Dp($.tagName),Bt=Dp(ne.tagName);return ze[$.namespaceURI]?$.namespaceURI===Ht?ne.namespaceURI===wn?me==="svg":ne.namespaceURI===ii?me==="svg"&&(Bt==="annotation-xml"||tl[Bt]):!!tx[me]:$.namespaceURI===ii?ne.namespaceURI===wn?me==="math":ne.namespaceURI===Ht?me==="math"&&nl[Bt]:!!nx[me]:$.namespaceURI===wn?ne.namespaceURI===Ht&&!nl[Bt]||ne.namespaceURI===ii&&!tl[Bt]?!1:!nx[me]&&(qV[me]||!tx[me]):!!(_h==="application/xhtml+xml"&&ze[$.namespaceURI]):!1},ho=function($){Hh(e.removed,{element:$});try{T($).removeChild($)}catch{C($)}},$g=function($,ne){try{Hh(e.removed,{attribute:ne.getAttributeNode($),from:ne})}catch{Hh(e.removed,{attribute:null,from:ne})}if(ne.removeAttribute($),$==="is")if(H||D)try{ho(ne)}catch{}else try{ne.setAttribute($,"")}catch{}},rx=function($){let ne=null,me=null;if(j)$="<remove></remove>"+$;else{const Ln=BP($,/^[\r\n\t ]+/);me=Ln&&Ln[0]}_h==="application/xhtml+xml"&&Tt===wn&&($='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+$+"</body></html>");const Bt=M?M.createHTML($):$;if(Tt===wn)try{ne=new d().parseFromString(Bt,_h)}catch{}if(!ne||!ne.documentElement){ne=_.createDocument(Tt,"template",null);try{ne.documentElement.innerHTML=Nt?I:Bt}catch{}}const jn=ne.body||ne.documentElement;return $&&me&&jn.insertBefore(n.createTextNode(me),jn.childNodes[0]||null),Tt===wn?V.call(ne,O?"html":"body")[0]:O?ne.documentElement:jn},ix=function($){return P.call($.ownerDocument||$,$,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Iy=function($){return $ instanceof h&&(typeof $.nodeName!="string"||typeof $.textContent!="string"||typeof $.removeChild!="function"||!($.attributes instanceof c)||typeof $.removeAttribute!="function"||typeof $.setAttribute!="function"||typeof $.namespaceURI!="string"||typeof $.insertBefore!="function"||typeof $.hasChildNodes!="function")},ox=function($){return typeof a=="function"&&$ instanceof a};function ls(ve,$,ne){Kg(ve,me=>{me.call(e,$,ne,Du)})}const sx=function($){let ne=null;if(ls(Z.beforeSanitizeElements,$,null),Iy($))return ho($),!0;const me=An($.nodeName);if(ls(Z.uponSanitizeElement,$,{tagName:me,allowedTags:ut}),$.hasChildNodes()&&!ox($.firstElementChild)&&ir(/<[/\w!]/g,$.innerHTML)&&ir(/<[/\w!]/g,$.textContent)||$.nodeType===kh.progressingInstruction||k&&$.nodeType===kh.comment&&ir(/<[/\w]/g,$.data))return ho($),!0;if(!ut[me]||L[me]){if(!L[me]&&lx(me)&&(A.tagNameCheck instanceof RegExp&&ir(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me)))return!1;if(ce&&!qe[me]){const Bt=T($)||$.parentNode,jn=y($)||$.childNodes;if(jn&&Bt){const Ln=jn.length;for(let vr=Ln-1;vr>=0;--vr){const fo=p(jn[vr],!0);fo.__removalCount=($.__removalCount||0)+1,Bt.insertBefore(fo,E($))}}}return ho($),!0}return $ instanceof l&&!QV($)||(me==="noscript"||me==="noembed"||me==="noframes")&&ir(/<\/no(script|embed|frames)/i,$.innerHTML)?(ho($),!0):(S&&$.nodeType===kh.text&&(ne=$.textContent,Kg([X,Q,se],Bt=>{ne=Nh(ne,Bt," ")}),$.textContent!==ne&&(Hh(e.removed,{element:$.cloneNode()}),$.textContent=ne)),ls(Z.afterSanitizeElements,$,null),!1)},ax=function($,ne,me){if(F&&(ne==="id"||ne==="name")&&(me in n||me in ZV))return!1;if(!(J&&!U[ne]&&ir(be,ne))){if(!(K&&ir(bt,ne))){if(!v[ne]||U[ne]){if(!(lx($)&&(A.tagNameCheck instanceof RegExp&&ir(A.tagNameCheck,$)||A.tagNameCheck instanceof Function&&A.tagNameCheck($))&&(A.attributeNameCheck instanceof RegExp&&ir(A.attributeNameCheck,ne)||A.attributeNameCheck instanceof Function&&A.attributeNameCheck(ne))||ne==="is"&&A.allowCustomizedBuiltInElements&&(A.tagNameCheck instanceof RegExp&&ir(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me))))return!1}else if(!Ni[ne]){if(!ir(On,Nh(me,Ne,""))){if(!((ne==="src"||ne==="xlink:href"||ne==="href")&&$!=="script"&&sX(me,"data:")===0&&Ue[$])){if(!(b&&!ir(Ee,Nh(me,Ne,"")))){if(me)return!1}}}}}}return!0},lx=function($){return $!=="annotation-xml"&&BP($,lt)},ux=function($){ls(Z.beforeSanitizeAttributes,$,null);const{attributes:ne}=$;if(!ne||Iy($))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:v,forceKeepAttr:void 0};let Bt=ne.length;for(;Bt--;){const jn=ne[Bt],{name:Ln,namespaceURI:vr,value:fo}=jn,xh=An(Ln);let rr=Ln==="value"?fo:aX(fo);if(me.attrName=xh,me.attrValue=rr,me.keepAttr=!0,me.forceKeepAttr=void 0,ls(Z.uponSanitizeAttribute,$,me),rr=me.attrValue,G&&(xh==="id"||xh==="name")&&($g(Ln,$),rr=ae+rr),k&&ir(/((--!?|])>)|<\/(style|title)/i,rr)){$g(Ln,$);continue}if(me.forceKeepAttr||($g(Ln,$),!me.keepAttr))continue;if(!R&&ir(/\/>/i,rr)){$g(Ln,$);continue}S&&Kg([X,Q,se],hx=>{rr=Nh(rr,hx," ")});const cx=An($.nodeName);if(ax(cx,xh,rr)){if(M&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!vr)switch(f.getAttributeType(cx,xh)){case"TrustedHTML":{rr=M.createHTML(rr);break}case"TrustedScriptURL":{rr=M.createScriptURL(rr);break}}try{vr?$.setAttributeNS(vr,Ln,rr):$.setAttribute(Ln,rr),Iy($)?ho($):VP(e.removed)}catch{}}}ls(Z.afterSanitizeAttributes,$,null)},eB=function ve($){let ne=null;const me=ix($);for(ls(Z.beforeSanitizeShadowDOM,$,null);ne=me.nextNode();)ls(Z.uponSanitizeShadowNode,ne,null),sx(ne),ux(ne),ne.content instanceof o&&ve(ne.content);ls(Z.afterSanitizeShadowDOM,$,null)};return e.sanitize=function(ve){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ne=null,me=null,Bt=null,jn=null;if(Nt=!ve,Nt&&(ve="<!-->"),typeof ve!="string"&&!ox(ve))if(typeof ve.toString=="function"){if(ve=ve.toString(),typeof ve!="string")throw Dh("dirty is not a string, aborting")}else throw Dh("toString is not a function");if(!e.isSupported)return ve;if(N||Py($),e.removed=[],typeof ve=="string"&&(_e=!1),_e){if(ve.nodeName){const fo=An(ve.nodeName);if(!ut[fo]||L[fo])throw Dh("root node is forbidden and cannot be sanitized in-place")}}else if(ve instanceof a)ne=rx("<!---->"),me=ne.ownerDocument.importNode(ve,!0),me.nodeType===kh.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?ne=me:ne.appendChild(me);else{if(!H&&!S&&!O&&ve.indexOf("<")===-1)return M&&W?M.createHTML(ve):ve;if(ne=rx(ve),!ne)return H?null:W?I:""}ne&&j&&ho(ne.firstChild);const Ln=ix(_e?ve:ne);for(;Bt=Ln.nextNode();)sx(Bt),ux(Bt),Bt.content instanceof o&&eB(Bt.content);if(_e)return ve;if(H){if(D)for(jn=Y.call(ne.ownerDocument);ne.firstChild;)jn.appendChild(ne.firstChild);else jn=ne;return(v.shadowroot||v.shadowrootmode)&&(jn=B.call(r,jn,!0)),jn}let vr=O?ne.outerHTML:ne.innerHTML;return O&&ut["!doctype"]&&ne.ownerDocument&&ne.ownerDocument.doctype&&ne.ownerDocument.doctype.name&&ir(_D,ne.ownerDocument.doctype.name)&&(vr="<!DOCTYPE "+ne.ownerDocument.doctype.name+`>
`+vr),S&&Kg([X,Q,se],fo=>{vr=Nh(vr,fo," ")}),M&&W?M.createHTML(vr):vr},e.setConfig=function(){let ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Py(ve),N=!0},e.clearConfig=function(){Du=null,N=!1},e.isValidAttribute=function(ve,$,ne){Du||Py({});const me=An(ve),Bt=An($);return ax(me,Bt,ne)},e.addHook=function(ve,$){typeof $=="function"&&Hh(Z[ve],$)},e.removeHook=function(ve,$){if($!==void 0){const ne=iX(Z[ve],$);return ne===-1?void 0:oX(Z[ve],ne,1)[0]}return VP(Z[ve])},e.removeHooks=function(ve){Z[ve]=[]},e.removeAllHooks=function(){Z=GP()},e}var SX=xD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var PD;function ee(){return PD.apply(null,arguments)}function RX(t){PD=t}function oo(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ou(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function st(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function aE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(st(t,e))return!1;return!0}function xr(t){return t===void 0}function zs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function hg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function ID(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Aa(t,e){for(var n in e)st(e,n)&&(t[n]=e[n]);return st(e,"toString")&&(t.toString=e.toString),st(e,"valueOf")&&(t.valueOf=e.valueOf),t}function rs(t,e,n,r){return QD(t,e,n,r,!0).utc()}function EX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function $e(t){return t._pf==null&&(t._pf=EX()),t._pf}var hR;Array.prototype.some?hR=Array.prototype.some:hR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function lE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=$e(t),n=hR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Iv(t){var e=rs(NaN);return t!=null?Aa($e(e),t):$e(e).userInvalidated=!0,e}var KP=ee.momentProperties=[],mC=!1;function uE(t,e){var n,r,i,o=KP.length;if(xr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),xr(e._i)||(t._i=e._i),xr(e._f)||(t._f=e._f),xr(e._l)||(t._l=e._l),xr(e._strict)||(t._strict=e._strict),xr(e._tzm)||(t._tzm=e._tzm),xr(e._isUTC)||(t._isUTC=e._isUTC),xr(e._offset)||(t._offset=e._offset),xr(e._pf)||(t._pf=$e(e)),xr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=KP[n],i=e[r],xr(i)||(t[r]=i);return t}function dg(t){uE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),mC===!1&&(mC=!0,ee.updateOffset(this),mC=!1)}function so(t){return t instanceof dg||t!=null&&t._isAMomentObject!=null}function OD(t){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ii(t,e){var n=!0;return Aa(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])st(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}OD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var qP={};function AD(t,e){ee.deprecationHandler!=null&&ee.deprecationHandler(t,e),qP[t]||(OD(e),qP[t]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function is(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function TX(t){var e,n;for(n in t)st(t,n)&&(e=t[n],is(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function dR(t,e){var n=Aa({},t),r;for(r in e)st(e,r)&&(ou(t[r])&&ou(e[r])?(n[r]={},Aa(n[r],t[r]),Aa(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)st(t,r)&&!st(e,r)&&ou(t[r])&&(n[r]=Aa({},n[r]));return n}function cE(t){t!=null&&this.set(t)}var fR;Object.keys?fR=Object.keys:fR=function(t){var e,n=[];for(e in t)st(t,e)&&n.push(e);return n};var MX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function _X(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return is(r)?r.call(e,n):r}function Zo(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var hE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Xg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,pC={},Bc={};function ye(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Bc[t]=i),e&&(Bc[e[0]]=function(){return Zo(i.apply(this,arguments),e[1],e[2])}),n&&(Bc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function xX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function PX(t){var e=t.match(hE),n,r;for(n=0,r=e.length;n<r;n++)Bc[e[n]]?e[n]=Bc[e[n]]:e[n]=xX(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=is(e[s])?e[s].call(i,t):e[s];return o}}function $p(t,e){return t.isValid()?(e=HD(e,t.localeData()),pC[e]=pC[e]||PX(e),pC[e](t)):t.localeData().invalidDate()}function HD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Xg.lastIndex=0;n>=0&&Xg.test(t);)t=t.replace(Xg,r),Xg.lastIndex=0,n-=1;return t}var IX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function OX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(hE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var AX="Invalid date";function HX(){return this._invalidDate}var NX="%d",DX=/\d{1,2}/;function $X(t){return this._ordinal.replace("%d",t)}var kX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function LX(t,e,n,r){var i=this._relativeTime[n];return is(i)?i(t,e,n,r):i.replace(/%d/i,t)}function FX(t,e){var n=this._relativeTime[t>0?"future":"past"];return is(n)?n(e):n.replace(/%s/i,e)}var XP={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Oi(t){return typeof t=="string"?XP[t]||XP[t.toLowerCase()]:void 0}function dE(t){var e={},n,r;for(r in t)st(t,r)&&(n=Oi(r),n&&(e[n]=t[r]));return e}var VX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function BX(t){var e=[],n;for(n in t)st(t,n)&&e.push({unit:n,priority:VX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var ND=/\d/,ri=/\d\d/,DD=/\d{3}/,fE=/\d{4}/,Ov=/[+-]?\d{6}/,Vt=/\d\d?/,$D=/\d\d\d\d?/,kD=/\d\d\d\d\d\d?/,Av=/\d{1,3}/,gE=/\d{1,4}/,Hv=/[+-]?\d{1,6}/,ph=/\d+/,Nv=/[+-]?\d+/,WX=/Z|[+-]\d\d:?\d\d/gi,Dv=/Z|[+-]\d\d(?::?\d\d)?/gi,jX=/[+-]?\d+(\.\d{1,3})?/,fg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,wh=/^[1-9]\d?/,mE=/^([1-9]\d|\d)/,Rw;Rw={};function ue(t,e,n){Rw[t]=is(e)?e:function(r,i){return r&&n?n:e}}function UX(t,e){return st(Rw,t)?Rw[t](e._strict,e._locale):new RegExp(zX(t))}function zX(t){return js(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function js(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function yi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Je(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=yi(e)),n}var gR={};function St(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),zs(e)&&(r=function(o,s){s[e]=Je(o)}),i=t.length,n=0;n<i;n++)gR[t[n]]=r}function gg(t,e){St(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function YX(t,e,n){e!=null&&st(gR,t)&&gR[t](e,n._a,n,t)}function $v(t){return t%4===0&&t%100!==0||t%400===0}var Qn=0,Ds=1,Bo=2,Pn=3,no=4,$s=5,Zl=6,GX=7,KX=8;ye("Y",0,0,function(){var t=this.year();return t<=9999?Zo(t,4):"+"+t});ye(0,["YY",2],0,function(){return this.year()%100});ye(0,["YYYY",4],0,"year");ye(0,["YYYYY",5],0,"year");ye(0,["YYYYYY",6,!0],0,"year");ue("Y",Nv);ue("YY",Vt,ri);ue("YYYY",gE,fE);ue("YYYYY",Hv,Ov);ue("YYYYYY",Hv,Ov);St(["YYYYY","YYYYYY"],Qn);St("YYYY",function(t,e){e[Qn]=t.length===2?ee.parseTwoDigitYear(t):Je(t)});St("YY",function(t,e){e[Qn]=ee.parseTwoDigitYear(t)});St("Y",function(t,e){e[Qn]=parseInt(t,10)});function Gd(t){return $v(t)?366:365}ee.parseTwoDigitYear=function(t){return Je(t)+(Je(t)>68?1900:2e3)};var LD=vh("FullYear",!0);function qX(){return $v(this.year())}function vh(t,e){return function(n){return n!=null?(FD(this,t,n),ee.updateOffset(this,e),this):_f(this,t)}}function _f(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function FD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!$v(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function XX(t){return t=Oi(t),is(this[t])?this[t]():this}function JX(t,e){if(typeof t=="object"){t=dE(t);var n=BX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Oi(t),is(this[t]))return this[t](e);return this}function ZX(t,e){return(t%e+e)%e}var un;Array.prototype.indexOf?un=Array.prototype.indexOf:un=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function pE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=ZX(e,12);return t+=(e-n)/12,n===1?$v(t)?29:28:31-n%7%2}ye("M",["MM",2],"Mo",function(){return this.month()+1});ye("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ye("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Vt,wh);ue("MM",Vt,ri);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});St(["M","MM"],function(t,e){e[Ds]=Je(t)-1});St(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Ds]=i:$e(n).invalidMonth=t});var QX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),VD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),BD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,e6=fg,t6=fg;function n6(t,e){return t?oo(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||BD).test(e)?"format":"standalone"][t.month()]:oo(this._months)?this._months:this._months.standalone}function r6(t,e){return t?oo(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[BD.test(e)?"format":"standalone"][t.month()]:oo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function i6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=rs([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=un.call(this._shortMonthsParse,s),i!==-1?i:null):(i=un.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=un.call(this._shortMonthsParse,s),i!==-1?i:(i=un.call(this._longMonthsParse,s),i!==-1?i:null)):(i=un.call(this._longMonthsParse,s),i!==-1?i:(i=un.call(this._shortMonthsParse,s),i!==-1?i:null))}function o6(t,e,n){var r,i,o;if(this._monthsParseExact)return i6.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=rs([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function WD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Je(e);else if(e=t.localeData().monthsParse(e),!zs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,pE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function jD(t){return t!=null?(WD(this,t),ee.updateOffset(this,!0),this):_f(this,"Month")}function s6(){return pE(this.year(),this.month())}function a6(t){return this._monthsParseExact?(st(this,"_monthsRegex")||UD.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(st(this,"_monthsShortRegex")||(this._monthsShortRegex=e6),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function l6(t){return this._monthsParseExact?(st(this,"_monthsRegex")||UD.call(this),t?this._monthsStrictRegex:this._monthsRegex):(st(this,"_monthsRegex")||(this._monthsRegex=t6),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function UD(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=rs([2e3,i]),s=js(this.monthsShort(o,"")),a=js(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function u6(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function xf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Ew(t,e,n){var r=7+e-n,i=(7+xf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function zD(t,e,n,r,i){var o=(7+n-r)%7,s=Ew(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Gd(l)+a):a>Gd(t)?(l=t+1,u=a-Gd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Pf(t,e,n){var r=Ew(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Us(s,e,n)):i>Us(t.year(),e,n)?(o=i-Us(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Us(t,e,n){var r=Ew(t,e,n),i=Ew(t+1,e,n);return(Gd(t)-r+i)/7}ye("w",["ww",2],"wo","week");ye("W",["WW",2],"Wo","isoWeek");ue("w",Vt,wh);ue("ww",Vt,ri);ue("W",Vt,wh);ue("WW",Vt,ri);gg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Je(t)});function c6(t){return Pf(t,this._week.dow,this._week.doy).week}var h6={dow:0,doy:6};function d6(){return this._week.dow}function f6(){return this._week.doy}function g6(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function m6(t){var e=Pf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}ye("d",0,"do","day");ye("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ye("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ye("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ye("e",0,0,"weekday");ye("E",0,0,"isoWeekday");ue("d",Vt);ue("e",Vt);ue("E",Vt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});gg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:$e(n).invalidWeekday=t});gg(["d","e","E"],function(t,e,n,r){e[r]=Je(t)});function p6(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function w6(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function wE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var v6="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),YD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),y6="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),C6=fg,b6=fg,S6=fg;function R6(t,e){var n=oo(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?wE(n,this._week.dow):t?n[t.day()]:n}function E6(t){return t===!0?wE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function T6(t){return t===!0?wE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function M6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=rs([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=un.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=un.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=un.call(this._weekdaysParse,s),i!==-1||(i=un.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=un.call(this._shortWeekdaysParse,s),i!==-1||(i=un.call(this._weekdaysParse,s),i!==-1)?i:(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=un.call(this._minWeekdaysParse,s),i!==-1||(i=un.call(this._weekdaysParse,s),i!==-1)?i:(i=un.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function _6(t,e,n){var r,i,o;if(this._weekdaysParseExact)return M6.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=rs([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function x6(t){if(!this.isValid())return t!=null?this:NaN;var e=_f(this,"Day");return t!=null?(t=p6(t,this.localeData()),this.add(t-e,"d")):e}function P6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function I6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=w6(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function O6(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||vE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(st(this,"_weekdaysRegex")||(this._weekdaysRegex=C6),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function A6(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||vE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(st(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=b6),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function H6(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||vE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(st(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=S6),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function vE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=rs([2e3,1]).day(o),a=js(this.weekdaysMin(s,"")),l=js(this.weekdaysShort(s,"")),u=js(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function yE(){return this.hours()%12||12}function N6(){return this.hours()||24}ye("H",["HH",2],0,"hour");ye("h",["hh",2],0,yE);ye("k",["kk",2],0,N6);ye("hmm",0,0,function(){return""+yE.apply(this)+Zo(this.minutes(),2)});ye("hmmss",0,0,function(){return""+yE.apply(this)+Zo(this.minutes(),2)+Zo(this.seconds(),2)});ye("Hmm",0,0,function(){return""+this.hours()+Zo(this.minutes(),2)});ye("Hmmss",0,0,function(){return""+this.hours()+Zo(this.minutes(),2)+Zo(this.seconds(),2)});function GD(t,e){ye(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}GD("a",!0);GD("A",!1);function KD(t,e){return e._meridiemParse}ue("a",KD);ue("A",KD);ue("H",Vt,mE);ue("h",Vt,wh);ue("k",Vt,wh);ue("HH",Vt,ri);ue("hh",Vt,ri);ue("kk",Vt,ri);ue("hmm",$D);ue("hmmss",kD);ue("Hmm",$D);ue("Hmmss",kD);St(["H","HH"],Pn);St(["k","kk"],function(t,e,n){var r=Je(t);e[Pn]=r===24?0:r});St(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});St(["h","hh"],function(t,e,n){e[Pn]=Je(t),$e(n).bigHour=!0});St("hmm",function(t,e,n){var r=t.length-2;e[Pn]=Je(t.substr(0,r)),e[no]=Je(t.substr(r)),$e(n).bigHour=!0});St("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Pn]=Je(t.substr(0,r)),e[no]=Je(t.substr(r,2)),e[$s]=Je(t.substr(i)),$e(n).bigHour=!0});St("Hmm",function(t,e,n){var r=t.length-2;e[Pn]=Je(t.substr(0,r)),e[no]=Je(t.substr(r))});St("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Pn]=Je(t.substr(0,r)),e[no]=Je(t.substr(r,2)),e[$s]=Je(t.substr(i))});function D6(t){return(t+"").toLowerCase().charAt(0)==="p"}var $6=/[ap]\.?m?\.?/i,k6=vh("Hours",!0);function L6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var qD={calendar:MX,longDateFormat:IX,invalidDate:AX,ordinal:NX,dayOfMonthOrdinalParse:DX,relativeTime:kX,months:QX,monthsShort:VD,week:h6,weekdays:v6,weekdaysMin:y6,weekdaysShort:YD,meridiemParse:$6},Wt={},Lh={},If;function F6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function JP(t){return t&&t.toLowerCase().replace("_","-")}function V6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=JP(t[e]).split("-"),n=o.length,r=JP(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=kv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&F6(o,r)>=n-1)break;n--}e++}return If}function B6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function kv(t){var e=null,n;if(Wt[t]===void 0&&typeof ow<"u"&&ow&&ow.exports&&B6(t))try{e=If._abbr,n=require,n("./locale/"+t),Fa(e)}catch{Wt[t]=null}return Wt[t]}function Fa(t,e){var n;return t&&(xr(e)?n=Js(t):n=CE(t,e),n?If=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),If._abbr}function CE(t,e){if(e!==null){var n,r=qD;if(e.abbr=t,Wt[t]!=null)AD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Wt[t]._config;else if(e.parentLocale!=null)if(Wt[e.parentLocale]!=null)r=Wt[e.parentLocale]._config;else if(n=kv(e.parentLocale),n!=null)r=n._config;else return Lh[e.parentLocale]||(Lh[e.parentLocale]=[]),Lh[e.parentLocale].push({name:t,config:e}),null;return Wt[t]=new cE(dR(r,e)),Lh[t]&&Lh[t].forEach(function(i){CE(i.name,i.config)}),Fa(t),Wt[t]}else return delete Wt[t],null}function W6(t,e){if(e!=null){var n,r,i=qD;Wt[t]!=null&&Wt[t].parentLocale!=null?Wt[t].set(dR(Wt[t]._config,e)):(r=kv(t),r!=null&&(i=r._config),e=dR(i,e),r==null&&(e.abbr=t),n=new cE(e),n.parentLocale=Wt[t],Wt[t]=n),Fa(t)}else Wt[t]!=null&&(Wt[t].parentLocale!=null?(Wt[t]=Wt[t].parentLocale,t===Fa()&&Fa(t)):Wt[t]!=null&&delete Wt[t]);return Wt[t]}function Js(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return If;if(!oo(t)){if(e=kv(t),e)return e;t=[t]}return V6(t)}function j6(){return fR(Wt)}function bE(t){var e,n=t._a;return n&&$e(t).overflow===-2&&(e=n[Ds]<0||n[Ds]>11?Ds:n[Bo]<1||n[Bo]>pE(n[Qn],n[Ds])?Bo:n[Pn]<0||n[Pn]>24||n[Pn]===24&&(n[no]!==0||n[$s]!==0||n[Zl]!==0)?Pn:n[no]<0||n[no]>59?no:n[$s]<0||n[$s]>59?$s:n[Zl]<0||n[Zl]>999?Zl:-1,$e(t)._overflowDayOfYear&&(e<Qn||e>Bo)&&(e=Bo),$e(t)._overflowWeeks&&e===-1&&(e=GX),$e(t)._overflowWeekday&&e===-1&&(e=KX),$e(t).overflow=e),t}var U6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,z6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Y6=/Z|[+-]\d\d(?::?\d\d)?/,Jg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],wC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],G6=/^\/?Date\((-?\d+)/i,K6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,q6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function XD(t){var e,n,r=t._i,i=U6.exec(r)||z6.exec(r),o,s,a,l,u=Jg.length,c=wC.length;if(i){for($e(t).iso=!0,e=0,n=u;e<n;e++)if(Jg[e][1].exec(i[1])){s=Jg[e][0],o=Jg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(wC[e][1].exec(i[3])){a=(i[2]||" ")+wC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(Y6.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),RE(t)}else t._isValid=!1}function X6(t,e,n,r,i,o){var s=[J6(t),VD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function J6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Z6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Q6(t,e,n){if(t){var r=YD.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return $e(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function e7(t,e,n){if(t)return q6[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function JD(t){var e=K6.exec(Z6(t._i)),n;if(e){if(n=X6(e[4],e[3],e[2],e[5],e[6],e[7]),!Q6(e[1],n,t))return;t._a=n,t._tzm=e7(e[8],e[9],e[10]),t._d=xf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),$e(t).rfc2822=!0}else t._isValid=!1}function t7(t){var e=G6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(XD(t),t._isValid===!1)delete t._isValid;else return;if(JD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:ee.createFromInputFallback(t)}ee.createFromInputFallback=Ii("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function bc(t,e,n){return t??e??n}function n7(t){var e=new Date(ee.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function SE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=n7(t),t._w&&t._a[Bo]==null&&t._a[Ds]==null&&r7(t),t._dayOfYear!=null&&(s=bc(t._a[Qn],i[Qn]),(t._dayOfYear>Gd(s)||t._dayOfYear===0)&&($e(t)._overflowDayOfYear=!0),n=xf(s,0,t._dayOfYear),t._a[Ds]=n.getUTCMonth(),t._a[Bo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Pn]===24&&t._a[no]===0&&t._a[$s]===0&&t._a[Zl]===0&&(t._nextDay=!0,t._a[Pn]=0),t._d=(t._useUTC?xf:u6).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Pn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&($e(t).weekdayMismatch=!0)}}function r7(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=bc(e.GG,t._a[Qn],Pf(Ft(),1,4).year),r=bc(e.W,1),i=bc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Pf(Ft(),o,s),n=bc(e.gg,t._a[Qn],u.year),r=bc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Us(n,o,s)?$e(t)._overflowWeeks=!0:l!=null?$e(t)._overflowWeekday=!0:(a=zD(n,r,i,o,s),t._a[Qn]=a.year,t._dayOfYear=a.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function RE(t){if(t._f===ee.ISO_8601){XD(t);return}if(t._f===ee.RFC_2822){JD(t);return}t._a=[],$e(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=HD(t._f,t._locale).match(hE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(UX(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&$e(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Bc[o]?(r?$e(t).empty=!1:$e(t).unusedTokens.push(o),YX(o,r,t)):t._strict&&!r&&$e(t).unusedTokens.push(o);$e(t).charsLeftOver=a-l,e.length>0&&$e(t).unusedInput.push(e),t._a[Pn]<=12&&$e(t).bigHour===!0&&t._a[Pn]>0&&($e(t).bigHour=void 0),$e(t).parsedDateParts=t._a.slice(0),$e(t).meridiem=t._meridiem,t._a[Pn]=i7(t._locale,t._a[Pn],t._meridiem),u=$e(t).era,u!==null&&(t._a[Qn]=t._locale.erasConvertYear(u,t._a[Qn])),SE(t),bE(t)}function i7(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function o7(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){$e(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=uE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],RE(e),lE(e)&&(s=!0),o+=$e(e).charsLeftOver,o+=$e(e).unusedTokens.length*10,$e(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Aa(t,n||e)}function s7(t){if(!t._d){var e=dE(t._i),n=e.day===void 0?e.date:e.day;t._a=ID([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),SE(t)}}function a7(t){var e=new dg(bE(ZD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function ZD(t){var e=t._i,n=t._f;return t._locale=t._locale||Js(t._l),e===null||n===void 0&&e===""?Iv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),so(e)?new dg(bE(e)):(hg(e)?t._d=e:oo(n)?o7(t):n?RE(t):l7(t),lE(t)||(t._d=null),t))}function l7(t){var e=t._i;xr(e)?t._d=new Date(ee.now()):hg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?t7(t):oo(e)?(t._a=ID(e.slice(0),function(n){return parseInt(n,10)}),SE(t)):ou(e)?s7(t):zs(e)?t._d=new Date(e):ee.createFromInputFallback(t)}function QD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ou(t)&&aE(t)||oo(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,a7(o)}function Ft(t,e,n,r){return QD(t,e,n,r,!1)}var u7=Ii("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ft.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Iv()}),c7=Ii("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ft.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Iv()});function e$(t,e){var n,r;if(e.length===1&&oo(e[0])&&(e=e[0]),!e.length)return Ft();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function h7(){var t=[].slice.call(arguments,0);return e$("isBefore",t)}function d7(){var t=[].slice.call(arguments,0);return e$("isAfter",t)}var f7=function(){return Date.now?Date.now():+new Date},Fh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function g7(t){var e,n=!1,r,i=Fh.length;for(e in t)if(st(t,e)&&!(un.call(Fh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Fh[r]]){if(n)return!1;parseFloat(t[Fh[r]])!==Je(t[Fh[r]])&&(n=!0)}return!0}function m7(){return this._isValid}function p7(){return uo(NaN)}function Lv(t){var e=dE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=g7(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Js(),this._bubble()}function kp(t){return t instanceof Lv}function mR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function w7(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Je(t[s])!==Je(e[s])&&o++;return o+i}function t$(t,e){ye(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Zo(~~(n/60),2)+e+Zo(~~n%60,2)})}t$("Z",":");t$("ZZ","");ue("Z",Dv);ue("ZZ",Dv);St(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=EE(Dv,t)});var v7=/([\+\-]|\d\d)/gi;function EE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(v7)||["-",0,0],o=+(i[1]*60)+Je(i[2]),o===0?0:i[0]==="+"?o:-o)}function TE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(so(t)||hg(t)?t.valueOf():Ft(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),ee.updateOffset(n,!1),n):Ft(t).local()}function pR(t){return-Math.round(t._d.getTimezoneOffset())}ee.updateOffset=function(){};function y7(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=EE(Dv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=pR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?i$(this,uo(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:pR(this)}function C7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function b7(t){return this.utcOffset(0,t)}function S7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(pR(this),"m")),this}function R7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=EE(WX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function E7(t){return this.isValid()?(t=t?Ft(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function T7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function M7(){if(!xr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return uE(t,this),t=ZD(t),t._a?(e=t._isUTC?rs(t._a):Ft(t._a),this._isDSTShifted=this.isValid()&&w7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function _7(){return this.isValid()?!this._isUTC:!1}function x7(){return this.isValid()?this._isUTC:!1}function n$(){return this.isValid()?this._isUTC&&this._offset===0:!1}var P7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,I7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function uo(t,e){var n=t,r=null,i,o,s;return kp(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:zs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=P7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Je(r[Bo])*i,h:Je(r[Pn])*i,m:Je(r[no])*i,s:Je(r[$s])*i,ms:Je(mR(r[Zl]*1e3))*i}):(r=I7.exec(t))?(i=r[1]==="-"?-1:1,n={y:ol(r[2],i),M:ol(r[3],i),w:ol(r[4],i),d:ol(r[5],i),h:ol(r[6],i),m:ol(r[7],i),s:ol(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=O7(Ft(n.from),Ft(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Lv(n),kp(t)&&st(t,"_locale")&&(o._locale=t._locale),kp(t)&&st(t,"_isValid")&&(o._isValid=t._isValid),o}uo.fn=Lv.prototype;uo.invalid=p7;function ol(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function ZP(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function O7(t,e){var n;return t.isValid()&&e.isValid()?(e=TE(e,t),t.isBefore(e)?n=ZP(t,e):(n=ZP(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function r$(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(AD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=uo(n,r),i$(this,i,t),this}}function i$(t,e,n,r){var i=e._milliseconds,o=mR(e._days),s=mR(e._months);t.isValid()&&(r=r??!0,s&&WD(t,_f(t,"Month")+s*n),o&&FD(t,"Date",_f(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&ee.updateOffset(t,o||s))}var A7=r$(1,"add"),H7=r$(-1,"subtract");function o$(t){return typeof t=="string"||t instanceof String}function N7(t){return so(t)||hg(t)||o$(t)||zs(t)||$7(t)||D7(t)||t===null||t===void 0}function D7(t){var e=ou(t)&&!aE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||st(t,o);return e&&n}function $7(t){var e=oo(t),n=!1;return e&&(n=t.filter(function(r){return!zs(r)&&o$(t)}).length===0),e&&n}function k7(t){var e=ou(t)&&!aE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||st(t,o);return e&&n}function L7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function F7(t,e){arguments.length===1&&(arguments[0]?N7(arguments[0])?(t=arguments[0],e=void 0):k7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Ft(),r=TE(n,this).startOf("day"),i=ee.calendarFormat(this,r)||"sameElse",o=e&&(is(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Ft(n)))}function V7(){return new dg(this)}function B7(t,e){var n=so(t)?t:Ft(t);return this.isValid()&&n.isValid()?(e=Oi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function W7(t,e){var n=so(t)?t:Ft(t);return this.isValid()&&n.isValid()?(e=Oi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function j7(t,e,n,r){var i=so(t)?t:Ft(t),o=so(e)?e:Ft(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function U7(t,e){var n=so(t)?t:Ft(t),r;return this.isValid()&&n.isValid()?(e=Oi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function z7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function Y7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function G7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=TE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Oi(e),e){case"year":o=Lp(this,r)/12;break;case"month":o=Lp(this,r);break;case"quarter":o=Lp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:yi(o)}function Lp(t,e){if(t.date()<e.date())return-Lp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function K7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function q7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?$p(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):is(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",$p(n,"Z")):$p(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function X7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function J7(t){t||(t=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var e=$p(this,t);return this.localeData().postformat(e)}function Z7(t,e){return this.isValid()&&(so(t)&&t.isValid()||Ft(t).isValid())?uo({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Q7(t){return this.from(Ft(),t)}function e9(t,e){return this.isValid()&&(so(t)&&t.isValid()||Ft(t).isValid())?uo({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function t9(t){return this.to(Ft(),t)}function s$(t){var e;return t===void 0?this._locale._abbr:(e=Js(t),e!=null&&(this._locale=e),this)}var a$=Ii("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function l$(){return this._locale}var Tw=1e3,Wc=60*Tw,Mw=60*Wc,u$=(365*400+97)*24*Mw;function jc(t,e){return(t%e+e)%e}function c$(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-u$:new Date(t,e,n).valueOf()}function h$(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-u$:Date.UTC(t,e,n)}function n9(t){var e,n;if(t=Oi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?h$:c$,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=jc(e+(this._isUTC?0:this.utcOffset()*Wc),Mw);break;case"minute":e=this._d.valueOf(),e-=jc(e,Wc);break;case"second":e=this._d.valueOf(),e-=jc(e,Tw);break}return this._d.setTime(e),ee.updateOffset(this,!0),this}function r9(t){var e,n;if(t=Oi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?h$:c$,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Mw-jc(e+(this._isUTC?0:this.utcOffset()*Wc),Mw)-1;break;case"minute":e=this._d.valueOf(),e+=Wc-jc(e,Wc)-1;break;case"second":e=this._d.valueOf(),e+=Tw-jc(e,Tw)-1;break}return this._d.setTime(e),ee.updateOffset(this,!0),this}function i9(){return this._d.valueOf()-(this._offset||0)*6e4}function o9(){return Math.floor(this.valueOf()/1e3)}function s9(){return new Date(this.valueOf())}function a9(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function l9(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function u9(){return this.isValid()?this.toISOString():null}function c9(){return lE(this)}function h9(){return Aa({},$e(this))}function d9(){return $e(this).overflow}function f9(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ye("N",0,0,"eraAbbr");ye("NN",0,0,"eraAbbr");ye("NNN",0,0,"eraAbbr");ye("NNNN",0,0,"eraName");ye("NNNNN",0,0,"eraNarrow");ye("y",["y",1],"yo","eraYear");ye("y",["yy",2],0,"eraYear");ye("y",["yyy",3],0,"eraYear");ye("y",["yyyy",4],0,"eraYear");ue("N",ME);ue("NN",ME);ue("NNN",ME);ue("NNNN",E9);ue("NNNNN",T9);St(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?$e(n).era=i:$e(n).invalidEra=t});ue("y",ph);ue("yy",ph);ue("yyy",ph);ue("yyyy",ph);ue("yo",M9);St(["y","yy","yyy","yyyy"],Qn);St(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Qn]=n._locale.eraYearOrdinalParse(t,i):e[Qn]=parseInt(t,10)});function g9(t,e){var n,r,i,o=this._eras||Js("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=ee(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=ee(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function m9(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function p9(t,e){var n=t.since<=t.until?1:-1;return e===void 0?ee(t.since).year():ee(t.since).year()+(e-t.offset)*n}function w9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function v9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function y9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function C9(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-ee(i[t].since).year())*n+i[t].offset;return this.year()}function b9(t){return st(this,"_erasNameRegex")||_E.call(this),t?this._erasNameRegex:this._erasRegex}function S9(t){return st(this,"_erasAbbrRegex")||_E.call(this),t?this._erasAbbrRegex:this._erasRegex}function R9(t){return st(this,"_erasNarrowRegex")||_E.call(this),t?this._erasNarrowRegex:this._erasRegex}function ME(t,e){return e.erasAbbrRegex(t)}function E9(t,e){return e.erasNameRegex(t)}function T9(t,e){return e.erasNarrowRegex(t)}function M9(t,e){return e._eraYearOrdinalRegex||ph}function _E(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=js(u[i].name),a=js(u[i].abbr),l=js(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}ye(0,["gg",2],0,function(){return this.weekYear()%100});ye(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Fv(t,e){ye(0,[t,t.length],0,e)}Fv("gggg","weekYear");Fv("ggggg","weekYear");Fv("GGGG","isoWeekYear");Fv("GGGGG","isoWeekYear");ue("G",Nv);ue("g",Nv);ue("GG",Vt,ri);ue("gg",Vt,ri);ue("GGGG",gE,fE);ue("gggg",gE,fE);ue("GGGGG",Hv,Ov);ue("ggggg",Hv,Ov);gg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Je(t)});gg(["gg","GG"],function(t,e,n,r){e[r]=ee.parseTwoDigitYear(t)});function _9(t){return d$.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function x9(t){return d$.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function P9(){return Us(this.year(),1,4)}function I9(){return Us(this.isoWeekYear(),1,4)}function O9(){var t=this.localeData()._week;return Us(this.year(),t.dow,t.doy)}function A9(){var t=this.localeData()._week;return Us(this.weekYear(),t.dow,t.doy)}function d$(t,e,n,r,i){var o;return t==null?Pf(this,r,i).year:(o=Us(t,r,i),e>o&&(e=o),H9.call(this,t,e,n,r,i))}function H9(t,e,n,r,i){var o=zD(t,e,n,r,i),s=xf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}ye("Q",0,"Qo","quarter");ue("Q",ND);St("Q",function(t,e){e[Ds]=(Je(t)-1)*3});function N9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ye("D",["DD",2],"Do","date");ue("D",Vt,wh);ue("DD",Vt,ri);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});St(["D","DD"],Bo);St("Do",function(t,e){e[Bo]=Je(t.match(Vt)[0])});var f$=vh("Date",!0);ye("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Av);ue("DDDD",DD);St(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Je(t)});function D9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}ye("m",["mm",2],0,"minute");ue("m",Vt,mE);ue("mm",Vt,ri);St(["m","mm"],no);var $9=vh("Minutes",!1);ye("s",["ss",2],0,"second");ue("s",Vt,mE);ue("ss",Vt,ri);St(["s","ss"],$s);var k9=vh("Seconds",!1);ye("S",0,0,function(){return~~(this.millisecond()/100)});ye(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ye(0,["SSS",3],0,"millisecond");ye(0,["SSSS",4],0,function(){return this.millisecond()*10});ye(0,["SSSSS",5],0,function(){return this.millisecond()*100});ye(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ye(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ye(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ye(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Av,ND);ue("SS",Av,ri);ue("SSS",Av,DD);var Ha,g$;for(Ha="SSSS";Ha.length<=9;Ha+="S")ue(Ha,ph);function L9(t,e){e[Zl]=Je(("0."+t)*1e3)}for(Ha="S";Ha.length<=9;Ha+="S")St(Ha,L9);g$=vh("Milliseconds",!1);ye("z",0,0,"zoneAbbr");ye("zz",0,0,"zoneName");function F9(){return this._isUTC?"UTC":""}function V9(){return this._isUTC?"Coordinated Universal Time":""}var te=dg.prototype;te.add=A7;te.calendar=F7;te.clone=V7;te.diff=G7;te.endOf=r9;te.format=J7;te.from=Z7;te.fromNow=Q7;te.to=e9;te.toNow=t9;te.get=XX;te.invalidAt=d9;te.isAfter=B7;te.isBefore=W7;te.isBetween=j7;te.isSame=U7;te.isSameOrAfter=z7;te.isSameOrBefore=Y7;te.isValid=c9;te.lang=a$;te.locale=s$;te.localeData=l$;te.max=c7;te.min=u7;te.parsingFlags=h9;te.set=JX;te.startOf=n9;te.subtract=H7;te.toArray=a9;te.toObject=l9;te.toDate=s9;te.toISOString=q7;te.inspect=X7;typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});te.toJSON=u9;te.toString=K7;te.unix=o9;te.valueOf=i9;te.creationData=f9;te.eraName=w9;te.eraNarrow=v9;te.eraAbbr=y9;te.eraYear=C9;te.year=LD;te.isLeapYear=qX;te.weekYear=_9;te.isoWeekYear=x9;te.quarter=te.quarters=N9;te.month=jD;te.daysInMonth=s6;te.week=te.weeks=g6;te.isoWeek=te.isoWeeks=m6;te.weeksInYear=O9;te.weeksInWeekYear=A9;te.isoWeeksInYear=P9;te.isoWeeksInISOWeekYear=I9;te.date=f$;te.day=te.days=x6;te.weekday=P6;te.isoWeekday=I6;te.dayOfYear=D9;te.hour=te.hours=k6;te.minute=te.minutes=$9;te.second=te.seconds=k9;te.millisecond=te.milliseconds=g$;te.utcOffset=y7;te.utc=b7;te.local=S7;te.parseZone=R7;te.hasAlignedHourOffset=E7;te.isDST=T7;te.isLocal=_7;te.isUtcOffset=x7;te.isUtc=n$;te.isUTC=n$;te.zoneAbbr=F9;te.zoneName=V9;te.dates=Ii("dates accessor is deprecated. Use date instead.",f$);te.months=Ii("months accessor is deprecated. Use month instead",jD);te.years=Ii("years accessor is deprecated. Use year instead",LD);te.zone=Ii("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",C7);te.isDSTShifted=Ii("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",M7);function B9(t){return Ft(t*1e3)}function W9(){return Ft.apply(null,arguments).parseZone()}function m$(t){return t}var at=cE.prototype;at.calendar=_X;at.longDateFormat=OX;at.invalidDate=HX;at.ordinal=$X;at.preparse=m$;at.postformat=m$;at.relativeTime=LX;at.pastFuture=FX;at.set=TX;at.eras=g9;at.erasParse=m9;at.erasConvertYear=p9;at.erasAbbrRegex=S9;at.erasNameRegex=b9;at.erasNarrowRegex=R9;at.months=n6;at.monthsShort=r6;at.monthsParse=o6;at.monthsRegex=l6;at.monthsShortRegex=a6;at.week=c6;at.firstDayOfYear=f6;at.firstDayOfWeek=d6;at.weekdays=R6;at.weekdaysMin=T6;at.weekdaysShort=E6;at.weekdaysParse=_6;at.weekdaysRegex=O6;at.weekdaysShortRegex=A6;at.weekdaysMinRegex=H6;at.isPM=D6;at.meridiem=L6;function _w(t,e,n,r){var i=Js(),o=rs().set(r,e);return i[n](o,t)}function p$(t,e,n){if(zs(t)&&(e=t,t=void 0),t=t||"",e!=null)return _w(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=_w(t,r,n,"month");return i}function xE(t,e,n,r){typeof t=="boolean"?(zs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,zs(e)&&(n=e,e=void 0),e=e||"");var i=Js(),o=t?i._week.dow:0,s,a=[];if(n!=null)return _w(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=_w(e,(s+o)%7,r,"day");return a}function j9(t,e){return p$(t,e,"months")}function U9(t,e){return p$(t,e,"monthsShort")}function z9(t,e,n){return xE(t,e,n,"weekdays")}function Y9(t,e,n){return xE(t,e,n,"weekdaysShort")}function G9(t,e,n){return xE(t,e,n,"weekdaysMin")}Fa("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Je(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});ee.lang=Ii("moment.lang is deprecated. Use moment.locale instead.",Fa);ee.langData=Ii("moment.langData is deprecated. Use moment.localeData instead.",Js);var us=Math.abs;function K9(){var t=this._data;return this._milliseconds=us(this._milliseconds),this._days=us(this._days),this._months=us(this._months),t.milliseconds=us(t.milliseconds),t.seconds=us(t.seconds),t.minutes=us(t.minutes),t.hours=us(t.hours),t.months=us(t.months),t.years=us(t.years),this}function w$(t,e,n,r){var i=uo(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function q9(t,e){return w$(this,t,e,1)}function X9(t,e){return w$(this,t,e,-1)}function QP(t){return t<0?Math.floor(t):Math.ceil(t)}function J9(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=QP(wR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=yi(t/1e3),r.seconds=i%60,o=yi(i/60),r.minutes=o%60,s=yi(o/60),r.hours=s%24,e+=yi(s/24),l=yi(v$(e)),n+=l,e-=QP(wR(l)),a=yi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function v$(t){return t*4800/146097}function wR(t){return t*146097/4800}function Z9(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Oi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+v$(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(wR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Zs(t){return function(){return this.as(t)}}var y$=Zs("ms"),Q9=Zs("s"),e8=Zs("m"),t8=Zs("h"),n8=Zs("d"),r8=Zs("w"),i8=Zs("M"),o8=Zs("Q"),s8=Zs("y"),a8=y$;function l8(){return uo(this)}function u8(t){return t=Oi(t),this.isValid()?this[t+"s"]():NaN}function xu(t){return function(){return this.isValid()?this._data[t]:NaN}}var c8=xu("milliseconds"),h8=xu("seconds"),d8=xu("minutes"),f8=xu("hours"),g8=xu("days"),m8=xu("months"),p8=xu("years");function w8(){return yi(this.days()/7)}var xs=Math.round,Ac={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function v8(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function y8(t,e,n,r){var i=uo(t).abs(),o=xs(i.as("s")),s=xs(i.as("m")),a=xs(i.as("h")),l=xs(i.as("d")),u=xs(i.as("M")),c=xs(i.as("w")),h=xs(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,v8.apply(null,d)}function C8(t){return t===void 0?xs:typeof t=="function"?(xs=t,!0):!1}function b8(t,e){return Ac[t]===void 0?!1:e===void 0?Ac[t]:(Ac[t]=e,t==="s"&&(Ac.ss=e-1),!0)}function S8(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Ac,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Ac,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=y8(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var vC=Math.abs;function ku(t){return(t>0)-(t<0)||+t}function Vv(){if(!this.isValid())return this.localeData().invalidDate();var t=vC(this._milliseconds)/1e3,e=vC(this._days),n=vC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=yi(t/60),i=yi(r/60),t%=60,r%=60,o=yi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ku(this._months)!==ku(a)?"-":"",c=ku(this._days)!==ku(a)?"-":"",h=ku(this._milliseconds)!==ku(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var nt=Lv.prototype;nt.isValid=m7;nt.abs=K9;nt.add=q9;nt.subtract=X9;nt.as=Z9;nt.asMilliseconds=y$;nt.asSeconds=Q9;nt.asMinutes=e8;nt.asHours=t8;nt.asDays=n8;nt.asWeeks=r8;nt.asMonths=i8;nt.asQuarters=o8;nt.asYears=s8;nt.valueOf=a8;nt._bubble=J9;nt.clone=l8;nt.get=u8;nt.milliseconds=c8;nt.seconds=h8;nt.minutes=d8;nt.hours=f8;nt.days=g8;nt.weeks=w8;nt.months=m8;nt.years=p8;nt.humanize=S8;nt.toISOString=Vv;nt.toString=Vv;nt.toJSON=Vv;nt.locale=s$;nt.localeData=l$;nt.toIsoString=Ii("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Vv);nt.lang=a$;ye("X",0,0,"unix");ye("x",0,0,"valueOf");ue("x",Nv);ue("X",jX);St("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});St("x",function(t,e,n){n._d=new Date(Je(t))});//! moment.js
ee.version="2.30.1";RX(Ft);ee.fn=te;ee.min=h7;ee.max=d7;ee.now=f7;ee.utc=rs;ee.unix=B9;ee.months=j9;ee.isDate=hg;ee.locale=Fa;ee.invalid=Iv;ee.duration=uo;ee.isMoment=so;ee.weekdays=z9;ee.parseZone=W9;ee.localeData=Js;ee.isDuration=kp;ee.monthsShort=U9;ee.weekdaysMin=G9;ee.defineLocale=CE;ee.updateLocale=W6;ee.locales=j6;ee.weekdaysShort=Y9;ee.normalizeUnits=Oi;ee.relativeTimeRounding=C8;ee.relativeTimeThreshold=b8;ee.calendarFormat=L7;ee.prototype=te;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function C$(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function vR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Kd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Tn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function za(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ke(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function x(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function b$(t){return Tn(t,(e,n)=>e+n,0)}function R8(t){return Tn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function E8(t){return Tn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function T8(t){return t.length?b$(t)/t.length:0}function S$(t){return Tn(t,(e,n)=>e.concat(Array.isArray(n)?S$(n):n),[])}function R$(t){const e=[];return x(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function yR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return x(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function M8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return x(i,s=>{o=o.filter(a=>s.includes(a))}),o}function _8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return x(i,s=>{x(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function CR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const x8=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:T8,arrayEach:x,arrayFilter:za,arrayFlatten:S$,arrayMap:Ke,arrayMax:R8,arrayMin:E8,arrayReduce:Tn,arraySum:b$,arrayUnique:R$,extendArray:vR,getDifferenceOfArrays:yR,getIntersectionOfArrays:M8,getUnionOfArrays:_8,pivot:Kd,stringToArray:CR,to2dArray:C$},Symbol.toStringTag,{value:"Module"}));function gt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Tn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function It(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Lt(t){return typeof t>"u"}function Xt(t){return t===null||t===""||Lt(t)}function E$(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Ld="length",qd=t=>parseInt(t,16),eI=t=>parseInt(t,10),xw=(t,e,n)=>t.substr(e,n),Xd=t=>t.codePointAt(0)-65,bR=t=>`${t}`.replace(/\-/g,""),P8=t=>qd(xw(bR(t),qd("12"),Xd("F")))/(qd(xw(bR(t),Xd("B"),~~![][Ld]))||9),I8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let tI=!1;const nI={invalid:()=>gt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return gt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>gt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},rI={invalid:()=>gt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return gt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>gt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function T$(t,e){const n=!Xt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=bR(t||"");const l=O8(t);if(n||r||l)if(l){const u=ee("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=P8(t);o=ee((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(I8()&&(s="valid",a="valid"),!tI&&s!=="valid"&&(nI[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](nI[s]({keyValidityDate:o,hotVersion:i})),tI=!0),a!=="valid"&&e.parentNode&&rI[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=rI[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function O8(t){let e=[][Ld],n=e;if(t[Ld]!==Xd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Xd(i.shift());o;o=Xd(i.shift()||"A"))--o<""[Ld]?n=n|(eI(`${eI(qd(r)+(qd(xw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=xw(t,o,o?i[Ld]===1?9:8:6);return n===e}const A8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:T$,isDefined:le,isEmpty:Xt,isRegExp:E$,isUndefined:Lt,stringify:It},Symbol.toStringTag,{value:"Module"}));function tr(t){return t[0].toUpperCase()+t.substr(1)}function H8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=It(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function PE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function IE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function OE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function SR(t){return Bv(`${t}`,{ALLOWED_TAGS:[]})}function Bv(t,e){return SX.sanitize(t,e)}const N8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:H8,isPercentValue:IE,randomString:PE,sanitize:Bv,stripTags:SR,substitute:OE,toUpperCaseFirst:tr},Symbol.toStringTag,{value:"Module"})),Pu=t=>["tabindex",t],D8=()=>["role","treegrid"],ks=()=>["role","presentation"],$8=()=>["role","gridcell"],k8=()=>["role","rowheader"],M$=()=>["role","rowgroup"],L8=()=>["role","columnheader"],RR=()=>["role","row"],F8=()=>["role","menu"],V8=()=>["role","menuitem"],B8=()=>["role","menuitemcheckbox"],W8=()=>["role","combobox"],_$=()=>["role","listbox"],j8=()=>["role","option"],U8=()=>["role","checkbox"],z8=()=>["scope","col"],Y8=()=>["scope","row"],G8=()=>["type","text"],Of=t=>["aria-label",t],Iu=()=>["aria-hidden","true"],K8=()=>["aria-disabled","true"],q8=()=>["aria-multiselectable","true"],x$=t=>["aria-haspopup",t],P$=t=>["aria-rowcount",t],Wv=t=>["aria-colcount",t],I$=t=>["aria-rowindex",t],AE=t=>["aria-colindex",t],Ri=t=>["aria-expanded",t],X8=t=>["aria-sort",t],iI=()=>["aria-readonly","true"],oI=()=>["aria-invalid","true"],O$=t=>["aria-checked",t],HE=()=>["aria-selected","true"],J8=()=>["aria-autocomplete","list"],Z8=t=>["aria-controls",t],Q8=t=>["aria-activedescendant",t],eJ=t=>["aria-live",t],tJ=t=>["aria-relevant",t],nJ=t=>["aria-setsize",t],rJ=t=>["aria-posinset",t];function A$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Jd(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function H$(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function du(t){return H$(t)&&t.parent}function iJ(t){return!!Object.getPrototypeOf(t.parent)}function Ya(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Fd(t,e,n){const r=[];let i=t;for(;i&&(i=Ya(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function N$(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Va(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function D$(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function va(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function $$(t){return!t||!t.length?[]:t.filter(e=>!!e)}function k$(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function we(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=$$(e),e.length>0&&t.classList.add(...e)}function pe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=k$(e,!0);n=$$(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Ou(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=k$(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function NE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)NE(e[n])}}function Qo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const L$=/(<(.*)>|&(.*);)/;function Au(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;L$.test(e)?t.innerHTML=n?Bv(e):e:Ga(t,e)}function Ga(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Qo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function fu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return fu(r.host.impl);if(r.host)return fu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function F$(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Bn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function DE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function jv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Uv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?DE(e):t.scrollTop}function $E(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?jv(e):t.scrollLeft}function Af(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function V$(t){return t.scrollHeight-t.clientHeight}function B$(t){return t.scrollWidth-t.clientWidth}function eh(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Hf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function oJ(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function rn(t){return t.offsetWidth}function dn(t){return t.offsetHeight}function Uc(t){return t.clientHeight||t.innerHeight}function kE(t){return t.clientWidth||t.innerWidth}function sJ(t,e,n){t.addEventListener(e,n,!1)}function aJ(t,e,n){t.removeEventListener(e,n,!1)}function LE(t){return t.selectionStart?t.selectionStart:0}function W$(t){return t.selectionEnd?t.selectionEnd:0}function lJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function ER(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function mg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let yC;function uJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function In(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return yC===void 0&&(yC=uJ(t)),yC}function FE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function VE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function zv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function cJ(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function pg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Zd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Yv(t){return Zd(t)&&t.hasAttribute("data-hot-input")===!1}function hJ(t){const e=t.ownerDocument.activeElement;Yv(e)||t.select()}function BE(t){return!t.parentNode}function j$(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function WE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ce(t,"contenteditable",!0),n&&Ce(t,...Iu()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function jE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&pe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function U$(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;WE(t,n),e(),jE(t,n)}function qo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const dJ=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:L$,addClass:q,addEvent:sJ,clearTextSelection:ER,closest:Ya,closestDown:Fd,empty:Qo,fastInnerHTML:Au,fastInnerText:Ga,findFirstParentWithClass:N$,getCaretPosition:LE,getCssTransform:cJ,getFrameElement:H$,getMaximumScrollLeft:B$,getMaximumScrollTop:V$,getParent:A$,getParentWindow:du,getScrollLeft:$E,getScrollTop:Uv,getScrollableElement:Af,getScrollbarWidth:In,getSelectionEndPosition:W$,getSelectionText:lJ,getStyle:Hf,getTrimmingContainer:eh,getWindowScrollLeft:jv,getWindowScrollTop:DE,hasAccessToParentWindow:iJ,hasClass:we,hasHorizontalScrollbar:VE,hasVerticalScrollbar:FE,hasZeroHeight:F$,index:D$,innerHeight:Uc,innerWidth:kE,isChildOf:Va,isDetached:BE,isHTMLElement:qo,isInput:Zd,isInternalElement:Jd,isOutsideInput:Yv,isVisible:fu,makeElementContentEditableAndSelectItsContent:WE,matchesCSSRules:oJ,observeVisibilityChangeOnce:j$,offset:Bn,outerHeight:dn,outerWidth:rn,overlayContainsElement:va,removeAttribute:Ou,removeClass:pe,removeContentEditableFromElementAndDeselect:jE,removeEvent:aJ,removeTextNodes:NE,resetCssTransform:pg,runWithSelectedContendEditableElement:U$,selectElementIfAllowed:hJ,setAttribute:Ce,setCaretPosition:mg,setOverlayPosition:zv},Symbol.toStringTag,{value:"Module"}));function dt(t){return typeof t=="function"}function z$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function fJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=z$(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function wg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function gJ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Tn(i,(u,c)=>c(u),r.apply(this,a))}}function UE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function Y$(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function mJ(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Pw(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const pJ=Object.freeze(Object.defineProperty({__proto__:null,curry:Y$,curryRight:mJ,debounce:wg,fastCall:Pw,isFunction:dt,partial:UE,pipe:gJ,throttle:z$,throttleAfterHits:fJ},Symbol.toStringTag,{value:"Module"}));var wJ=mn,sI=kN,vJ=Rn,aI=Su,yJ=Pv,lI=wJ([].push),CJ=function(t){if(vJ(t))return t;if(sI(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?lI(n,i):(typeof i=="number"||aI(i)==="Number"||aI(i)==="String")&&lI(n,yJ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(sI(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},bJ=Et,G$=hh,K$=lg,SJ=Sn,vg=mn,q$=kn,uI=Rn,cI=W0,X$=oE,RJ=CJ,EJ=B0,TJ=String,Ba=G$("JSON","stringify"),Zg=vg(/./.exec),hI=vg("".charAt),MJ=vg("".charCodeAt),_J=vg("".replace),xJ=vg(1 .toString),PJ=/[\uD800-\uDFFF]/g,dI=/^[\uD800-\uDBFF]$/,fI=/^[\uDC00-\uDFFF]$/,gI=!EJ||q$(function(){var t=G$("Symbol")("stringify detection");return Ba([t])!=="[null]"||Ba({a:t})!=="{}"||Ba(Object(t))!=="{}"}),mI=q$(function(){return Ba("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ba("\uDEAD")!=='"\\udead"'}),IJ=function(t,e){var n=X$(arguments),r=RJ(e);if(!(!uI(r)&&(t===void 0||cI(t))))return n[1]=function(i,o){if(uI(r)&&(o=SJ(r,this,TJ(i),o)),!cI(o))return o},K$(Ba,null,n)},OJ=function(t,e,n){var r=hI(n,e-1),i=hI(n,e+1);return Zg(dI,t)&&!Zg(fI,i)||Zg(fI,t)&&!Zg(dI,r)?"\\u"+xJ(MJ(t,0),16):t};Ba&&bJ({target:"JSON",stat:!0,arity:3,forced:gI||mI},{stringify:function(e,n,r){var i=X$(arguments),o=K$(gI?IJ:Ba,null,i);return mI&&typeof o=="string"?_J(o,PJ,OJ):o}});function th(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Le(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=th(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[th(n[0])]:e[r]=[]:e[r]=null)})),e}function J$(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function fn(t,e,n){const r=Array.isArray(n);return Le(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function yg(t,e){Le(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),yg(t[r],e[r])):t[r]=e[r]})}function nr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function ao(t){const e={};return Le(t,(n,r)=>{e[r]=n}),e}function vt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return x(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Le(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let p=g;return(Array.isArray(p)||ke(p))&&(p=nr(p)),p};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Gv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ke(t){return Object.prototype.toString.call(t)==="[object Object]"}function os(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Le(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Z$(t,e){const n=e.split(".");let r=t;return Le(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Fp(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(cn(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function Kv(t){if(!ke(t))return 0;const e=function(n){let r=0;return ke(n)?Le(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function $r(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function cn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const AJ=Object.freeze(Object.defineProperty({__proto__:null,clone:ao,createObjectPropListener:$r,deepClone:nr,deepExtend:yg,deepObjectSize:Kv,defineGetter:os,duckSchema:th,extend:fn,getProperty:Z$,hasOwnProperty:cn,inherit:J$,isObject:ke,isObjectEqual:Gv,mixin:vt,objectEach:Le,setProperty:Fp},Symbol.toStringTag,{value:"Module"}));function Nf(t){return window.requestAnimationFrame(t)}function Df(t){window.cancelAnimationFrame(t)}function zE(){return"ontouchstart"in window}function Q$(){return typeof window<"u"}let Lu;function ek(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Lu||(typeof Intl=="object"?Lu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Lu=(n,r)=>`${n}`.localeCompare(r):Lu=(n,r)=>n===r?0:n>r?-1:1,Lu)}const HJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Df,getComparisonFunction:ek,isCSR:Q$,isTouchSupported:zE,requestAnimationFrame:Nf},Symbol.toStringTag,{value:"Module"})),gi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Qs={chrome:gi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:gi(t=>/CriOS/.test(t)),edge:gi(t=>/Edge/.test(t)),edgeWebKit:gi(t=>/EdgiOS/.test(t)),firefox:gi(t=>/Firefox/.test(t)),firefoxWebKit:gi(t=>/FxiOS/.test(t)),mobile:gi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:gi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},yh={mac:gi(t=>/^Mac/.test(t)),win:gi(t=>/^Win/.test(t)),linux:gi(t=>/^Linux/.test(t)),ios:gi(t=>/iPhone|iPad|iPod/i.test(t))};function tk(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le(Qs,n=>{let{test:r}=n;return void r(t,e)})}function nk(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le(yh,e=>{let{test:n}=e;return void n(t)})}Q$()&&(tk(),nk());function YE(){return Qs.chrome.value}function rk(){return Qs.chromeWebKit.value}function Vp(){return Qs.firefox.value}function ik(){return Qs.firefoxWebKit.value}function $f(){return Qs.safari.value}function ok(){return Qs.edge.value}function NJ(){return Qs.edgeWebKit.value}function Go(){return Qs.mobile.value}function GE(){return yh.ios.value}function KE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&yh.mac.value}function TR(){return yh.win.value}function Iw(){return yh.mac.value}function DJ(){return yh.linux.value}const $J=Object.freeze(Object.defineProperty({__proto__:null,isChrome:YE,isChromeWebKit:rk,isEdge:ok,isEdgeWebKit:NJ,isFirefox:Vp,isFirefoxWebKit:ik,isIOS:GE,isIpadOS:KE,isLinuxOS:DJ,isMacOS:Iw,isMobileBrowser:Go,isSafari:$f,isWindowsOS:TR,setBrowserMeta:tk,setPlatformMeta:nk},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Vp()?182:174,AUDIO_MUTE:Vp()?181:173,AUDIO_UP:Vp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},kJ=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function sk(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function qE(t){return kJ.includes(t)}function LJ(t){const e=[];return Iw()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function ak(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function Ch(t,e){const n=e.split("|");let r=!1;return x(n,i=>{if(t===de[i])return r=!0,!1}),r}const FJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:LJ,isCtrlMetaKey:ak,isFunctionKey:qE,isKey:Ch,isPrintableChar:sk},Symbol.toStringTag,{value:"Module"}));function Ai(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ma(t){return t.isImmediatePropagationEnabled===!1}function Ka(t){return t.button===2}function qv(t){return t.button===0}function lk(t){return t instanceof TouchEvent}function uk(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!qo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const VJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ma,isLeftClick:qv,isRightClick:Ka,isTouchEvent:lk,offsetRelativeTo:uk,stopImmediatePropagation:Ai},Symbol.toStringTag,{value:"Module"}));function it(){le(console)&&console.warn(...arguments)}function XE(){le(console)&&console.error(...arguments)}const ql=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],CC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),bC=new Map([[]]);var BJ=gh,WJ=function(t,e,n){for(var r=0,i=arguments.length>2?n:BJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},jJ=bn,UJ=function(t,e){var n=jJ[t],r=n&&n.prototype;return r&&r[e]},zJ=lo,YJ=nD,GJ=Xs.f,MR=zJ("unscopables"),_R=Array.prototype;_R[MR]===void 0&&GJ(_R,MR,{configurable:!0,value:YJ(null)});var Xv=function(t){_R[MR][t]=!0},KJ=Et,qJ=mn,XJ=Lr,JJ=rg,ZJ=WJ,QJ=UJ,eZ=Xv,tZ=Array,nZ=qJ(QJ("Array","sort"));KJ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&XJ(e);var n=JJ(this),r=ZJ(tZ,n);return nZ(r,e)}});eZ("toSorted");var rZ=Et,iZ=Sn,oZ=mh,sZ=Lr,aZ=En,lZ=ns,uZ=ni,cZ=Za,SC=cZ("find",TypeError);rZ({target:"Iterator",proto:!0,real:!0,forced:SC},{find:function(e){aZ(this);try{sZ(e)}catch(i){uZ(this,"throw",i)}if(SC)return iZ(SC,this,e);var n=lZ(this),r=0;return oZ(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function hZ(t,e){ck(t,e),e.add(t)}function RC(t,e,n){ck(t,e),e.set(t,n)}function ck(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pI(t,e,n){return t.set(Ow(t,e),n),n}function Vn(t,e){return t.get(Ow(t,e))}function Ow(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dZ=100;var jr=new WeakMap,Sc=new WeakMap,EC=new WeakMap,TC=new WeakSet;class wI{constructor(){hZ(this,TC),RC(this,jr,new Map),RC(this,Sc,new Map),RC(this,EC,new Set),ql.forEach(e=>Ow(TC,this,vI).call(this,e))}getHooks(e){var n;return(n=Vn(jr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Vn(jr,this).has(e)||(Ow(TC,this,vI).call(this,e),ql.push(e));const i=Vn(jr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Vn(EC,this).has(e);!u&&o!==0&&(u=!0,Vn(EC,this).add(e)),u&&i.length>1&&Vn(jr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Vn(jr,this).has(e)&&Vn(jr,this).get(e).length>0}remove(e,n){if(!Vn(jr,this).has(e))return!1;const r=Vn(jr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Vn(Sc,this).get(e);return i.skip=!0,o+=1,o>dZ&&(Vn(jr,this).set(e,r.filter(s=>!s.skip)),o=0),Vn(Sc,this).set(e,o),!0}return!1}destroy(){Vn(jr,this).clear(),Vn(Sc,this).clear(),pI(jr,this,null),pI(Sc,this,null)}}function vI(t){Vn(jr,this).set(t,[]),Vn(Sc,this).set(t,0)}function fZ(t,e,n){return(e=gZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gZ(t){var e=mZ(t,"string");return typeof e=="symbol"?e:e+""}function mZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pZ=gt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ie{constructor(){fZ(this,"globalBucket",new wI)}static getSingleton(){return vZ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new wI),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?x(n,o=>this.add(e,o,r)):(CC.has(e)&&it(OE(pZ,{hookName:e,removedInVersion:CC.get(e)})),bC.has(e)&&it(bC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?x(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?x(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Pw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Pw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||ql.push(e)}deregister(e){this.isRegistered(e)&&ql.splice(ql.indexOf(e),1)}isDeprecated(e){return bC.has(e)||CC.has(e)}isRegistered(e){return ql.indexOf(e)>=0}getRegistered(){return ql}}const wZ=new ie;function vZ(){return wZ}const MC=new Map;function co(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";MC.has(t)||MC.set(t,new Map);const e=MC.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const xR=new WeakMap,{register:yZ,getItem:hk,hasItem:dk,getNames:CZ,getValues:N0e}=co("editors");function bZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ie.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function fk(t,e){let n;if(typeof t=="function")xR.get(t)||Pr(null,t),n=xR.get(t);else if(typeof t=="string")n=hk(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Aw(t){if(typeof t=="function")return t;if(!dk(t))throw Error(`No registered editor found under "${t}" name`);return hk(t).getConstructor()}function Pr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new bZ(e);typeof t=="string"&&yZ(t,n),xR.set(e,n)}function SZ(t,e,n){return(e=RZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RZ(t){var e=EZ(t,"string");return typeof e=="symbol"?e:e+""}function EZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Bp=0;class Mi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;SZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,TZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Bp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Bp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Bp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function TZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ai(this)},t}function MZ(){return Bp}function _Z(t,e){xZ(t,e),e.add(t)}function xZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sl(t,e,n){return(e=PZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PZ(t){var e=IZ(t,"string");return typeof e=="symbol"?e:e+""}function IZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _C(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qg=new WeakSet;class PR{constructor(e,n,r){_Z(this,Qg),sl(this,"hot",void 0),sl(this,"tableMeta",void 0),sl(this,"selection",void 0),sl(this,"eventManager",void 0),sl(this,"destroyed",!1),sl(this,"activeEditor",void 0),sl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Mi(e),this.hot.addHook("afterDocumentKeyDown",i=>_C(Qg,this,yI).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>_C(Qg,this,yI).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>_C(Qg,this,OZ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=fk(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function yI(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ma(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!qE(n)&&!ak(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function OZ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const CI=new WeakMap;PR.getInstance=function(t,e,n){let r=CI.get(t);return r||(r=new PR(t,e,n),CI.set(t,r)),r};function AZ(t,e){gk(t,e),e.add(t)}function Vh(t,e,n){gk(t,e),e.set(t,n)}function gk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(As(t,e))}function Bh(t,e,n){return t.set(As(t,e),n),n}function As(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zc=Object.freeze({CELL:"cell",MIXED:"mixed"});var Cn=new WeakMap,em=new WeakMap,tm=new WeakMap,nm=new WeakMap,rm=new WeakMap,ba=new WeakSet;class HZ{constructor(e){var n=this;AZ(this,ba),Vh(this,Cn,void 0),Vh(this,em,void 0),Vh(this,tm,1),Vh(this,nm,null),Vh(this,rm,new Map);const r=e.getSettings();Bh(Cn,this,e),Bh(em,this,r.imeFastEdit?zc.MIXED:zc.CELL),Mt(Cn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return As(ba,n,DZ).call(n,...o)}),Mt(Cn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return As(ba,n,bI).call(n,...o)}),Mt(Cn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return As(ba,n,bI).call(n,...o)}),Mt(Cn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return As(ba,n,NZ).call(n,...o)})}getFocusMode(){return Mt(em,this)}setFocusMode(e){Object.values(zc).includes(e)?Bh(em,this,e):it(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Mt(tm,this)}setRefocusDelay(e){Bh(tm,this,e)}setRefocusElementGetter(e){Bh(nm,this,e)}getRefocusElement(){var e;return typeof Mt(nm,this)=="function"?Mt(nm,this).call(this):(e=Mt(Cn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Mt(Cn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Mt(Cn,this).runHooks("modifyFocusedElement",s.row,s.col,r);qo(a)||(a=r),a&&!((o=Mt(Cn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):As(ba,this,JE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mt(tm,this);if(Mt(Cn,this).getSettings().imeFastEdit&&!((e=Mt(Cn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=Mt(Cn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),Mt(rm,this).has(n)||Mt(rm,this).set(n,wg(()=>{if(!Mt(Cn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),Mt(rm,this).get(n)()}}}function JE(t){var e;const n=(e=Mt(Cn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Mt(Cn,this).selection.isCellVisible(n)){t(null);return}const r=Mt(Cn,this).getCell(n.row,n.col,!0);r===null?Mt(Cn,this).addHookOnce("afterScroll",()=>{t(Mt(Cn,this).getCell(n.row,n.col,!0))}):t(r)}function bI(){As(ba,this,JE).call(this,t=>{const{activeElement:e}=Mt(Cn,this).rootDocument;e&&Yv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function NZ(){As(ba,this,JE).call(this,t=>{this.getFocusMode()===zc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function DZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?zc.MIXED:zc.CELL)}var $Z=xi,kZ=Su,LZ=lo,FZ=LZ("match"),VZ=function(t){var e;return $Z(t)&&((e=t[FZ])!==void 0?!!e:kZ(t)==="RegExp")},BZ=En,WZ=function(){var t=BZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},jZ=Sn,UZ=Pi,zZ=ig,YZ=WZ,SI=RegExp.prototype,GZ=function(t){var e=t.flags;return e===void 0&&!("flags"in SI)&&!UZ(t,"flags")&&zZ(SI,t)?jZ(YZ,t):e},ZE=mn,KZ=dh,qZ=Math.floor,xC=ZE("".charAt),XZ=ZE("".replace),PC=ZE("".slice),JZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,ZZ=/\$([$&'`]|\d{1,2})/g,QZ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=ZZ;return i!==void 0&&(i=KZ(i),l=JZ),XZ(o,l,function(u,c){var h;switch(xC(c,0)){case"$":return"$";case"&":return t;case"`":return PC(e,0,n);case"'":return PC(e,s);case"<":h=i[PC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=qZ(d/10);return f===0?u:f<=a?r[f-1]===void 0?xC(c,1):r[f-1]+xC(c,1):u}h=r[d-1]}return h===void 0?"":h})},eQ=Et,tQ=Sn,QE=mn,RI=ng,nQ=Rn,rQ=xi,iQ=VZ,Wh=Pv,oQ=og,sQ=GZ,aQ=QZ,lQ=lo,uQ=lQ("replace"),cQ=TypeError,IC=QE("".indexOf);QE("".replace);var EI=QE("".slice),hQ=Math.max;eQ({target:"String",proto:!0},{replaceAll:function(e,n){var r=RI(this),i,o,s,a,l,u,c,h,d,f,g=0,p="";if(rQ(e)){if(i=iQ(e),i&&(o=Wh(RI(sQ(e))),!~IC(o,"g")))throw new cQ("`.replaceAll` does not allow non-global regexes");if(s=oQ(e,uQ),s)return tQ(s,e,r,n)}for(a=Wh(r),l=Wh(e),u=nQ(n),u||(n=Wh(n)),c=l.length,h=hQ(1,c),d=IC(a,l);d!==-1;)f=u?Wh(n(l,d,a)):aQ(l,a,d,[],void 0,n),p+=EI(a,g,d)+f,g=d+c,d=d+h>a.length?-1:IC(a,l,d+h);return g<a.length&&(p+=EI(a,g)),p}});var dQ=Et,fQ=mh,gQ=Lr,mQ=En,pQ=ns,wQ=ni,vQ=Za,yQ=lg,CQ=kn,mk=TypeError,pk=CQ(function(){[].keys().reduce(function(){},void 0)}),OC=!pk&&vQ("reduce",mk);dQ({target:"Iterator",proto:!0,real:!0,forced:pk||OC},{reduce:function(e){mQ(this);try{gQ(e)}catch(s){wQ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(OC)return yQ(OC,this,n?[e]:[e,r]);var i=pQ(this),o=0;if(fQ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new mk("Reduce of empty iterator with no initial value");return r}});const wk={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},bQ=new RegExp(Object.keys(wk).map(t=>`(${t})`).join("|"),"gi");function SQ(t){return(t&&t.nodeName||"")==="TABLE"}function IR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let C=0;C<s;C+=1){const E=!f&&n&&C===0;let y="";if(f)y=`<th>${t.getColHeader(C-c)}</th>`;else if(E)y=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][C],{hidden:M,rowspan:I,colspan:_}=t.getCellMeta(d-h,C-c);if(!M){const P=[];if(I&&P.push(`rowspan="${I}"`),_&&P.push(`colspan="${_}"`),Xt(T))y=`<td ${P.join(" ")}></td>`;else{const Y=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y=`<td ${P.join(" ")}>${Y}</td>`}}}g.push(y)}const p=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function OR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Xt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function vk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,M=>{const I=M.match(/<td\b[^>]*?>/g)[0],_=/<p.*?>/g,P=M.substring(I.length,M.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(_,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${I}${P}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!SQ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,M)=>T+M.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(M=>{const I=M.querySelector("td")!==null;return I&&h.push(M),!I});f=T.length,d=f>0,f>1?n.nestedHeaders=Array.from(T).reduce((M,I)=>{const _=Array.from(I.cells).reduce((P,Y,V)=>{if(a&&V===0)return P;const{colSpan:B,innerHTML:Z}=Y,X=B>1?{label:Z,colspan:B}:Z;return P.push(X),P},[]);return M.push(_),M},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((M,I,_)=>(a&&_===0||M.push(I.innerHTML),M),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const p=[...h,...Array.from(o.tBodies).reduce((T,M)=>(T.push(...Array.from(M.rows)),T),[]),...c];g=p.length;const C=new Array(g);for(let T=0;T<g;T++)C[T]=new Array(u);const E=[],y=[];for(let T=0;T<g;T++){const M=p[T],I=Array.from(M.cells),_=I.length;for(let P=0;P<_;P++){const Y=I[P],{nodeName:V,innerHTML:B,rowSpan:Z,colSpan:X}=Y,Q=C[T].findIndex(se=>se===void 0);if(V==="TD"){if(Z>1||X>1){for(let Ee=T;Ee<T+Z;Ee++)if(Ee<g)for(let Ne=Q;Ne<Q+X;Ne++)C[Ee][Ne]=null;const be=Y.getAttribute("style");be&&be.includes("mso-ignore:colspan")||E.push({col:Q,row:T,rowspan:Z,colspan:X})}let se="";s&&/excel/gi.test(s.content)?se=B.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):se=B.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[T][Q]=se.replace(bQ,be=>wk[be])}else y.push(B)}}return E.length&&(n.mergeCells=E),y.length&&(n.rowHeaders=y),C.length&&(n.data=C),n}const RQ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:OR,htmlToGridSettings:vk,instanceToHTML:IR},Symbol.toStringTag,{value:"Module"}));function Xn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function yk(t){return Xn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function AR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function eT(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Xe(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const EQ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Xe,isNumeric:Xn,isNumericLike:yk,rangeEach:fe,rangeEachReverse:AR,valueAccordingPercent:eT},Symbol.toStringTag,{value:"Module"})),HR="asc",TQ="desc",TI=new Map([[HR,[-1,1]],[TQ,[1,-1]]]),MQ=t=>`The priority '${t}' is already declared in a map.`,_Q=t=>`The priority '${t}' is not a number.`;function xQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=dt(t)?t:MQ,e=dt(e)?e:_Q;function r(o,s){if(!Xn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:HR;const[s,a]=TI.get(o)||TI.get(HR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const PQ=t=>`The id '${t}' is already declared in a map.`;function Jv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=dt(t)?t:PQ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const IQ=t=>`'${t}' value is already declared in a unique set.`;function OQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=dt(t)?t:IQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const tT=t=>`There is already registered "${t}" plugin.`,AQ=t=>`There is already registered plugin on priority "${t}".`,HQ=t=>`The priority "${t}" is not a number.`,Ck=xQ({errorPriorityExists:AQ,errorPriorityNaN:HQ}),bk=OQ({errorItemExists:tT}),NR=Jv({errorIdExists:tT});function nT(){return[...Ck.getItems(),...bk.getItems()]}function Cg(t){const e=tr(t);return NR.getItem(e)}function NQ(t){return!!Cg(t)}function Ze(t,e,n){[t,e,n]=$Q(t,e,n),Cg(t)===void 0&&DQ(t,e,n)}function DQ(t,e,n){const r=tr(t);if(NR.hasItem(r))throw new Error(tT(r));n===void 0?bk.addItem(r):Ck.addItem(n,r),NR.addItem(r,e)}function $Q(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:kQ,getItem:LQ,hasItem:Sk,getNames:FQ,getValues:D0e}=co("renderers");function Hw(t){if(typeof t=="function")return t;if(!Sk(t))throw Error(`No registered renderer found under "${t}" name`);return LQ(t)}function zr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),kQ(t,e)}const{register:VQ,getItem:BQ,hasItem:Rk,getNames:WQ,getValues:$0e}=co("validators");function rT(t){if(typeof t=="function")return t;if(!Rk(t))throw Error(`No registered validator found under "${t}" name`);return BQ(t)}function Xl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),VQ(t,e)}var jQ=Et,UQ=dh,zQ=gh,YQ=sg,GQ=Xv;jQ({target:"Array",proto:!0},{at:function(e){var n=UQ(this),r=zQ(n),i=YQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});GQ("at");var KQ=Et,qQ=mn,XQ=ng,JQ=sg,ZQ=Pv,QQ=kn,eee=qQ("".charAt),tee=QQ(function(){return"𠮷".at(-2)!=="\uD842"});KQ({target:"String",proto:!0,forced:tee},{at:function(e){var n=ZQ(XQ(this)),r=n.length,i=JQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:eee(n,o)}});function jh(t,e,n){return(e=nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=ree(t,"string");return typeof e=="symbol"?e:e+""}function ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iee{constructor(){jh(this,"count",0),jh(this,"startColumn",null),jh(this,"endColumn",null),jh(this,"startPosition",null),jh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Uh(t,e,n){return(e=oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=see(t,"string");return typeof e=="symbol"?e:e+""}function see(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aee{constructor(){Uh(this,"count",0),Uh(this,"startRow",null),Uh(this,"endRow",null),Uh(this,"startPosition",null),Uh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function zh(t,e,n){return(e=lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lee(t){var e=uee(t,"string");return typeof e=="symbol"?e:e+""}function uee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ek{constructor(){zh(this,"count",0),zh(this,"startColumn",null),zh(this,"endColumn",null),zh(this,"startPosition",null),zh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Yh(t,e,n){return(e=cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cee(t){var e=hee(t,"string");return typeof e=="symbol"?e:e+""}function hee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tk{constructor(){Yh(this,"count",0),Yh(this,"startRow",null),Yh(this,"endRow",null),Yh(this,"startPosition",null),Yh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Gh(t,e,n){return(e=dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dee(t){var e=fee(t,"string");return typeof e=="symbol"?e:e+""}function fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gee{constructor(){Gh(this,"count",0),Gh(this,"startColumn",0),Gh(this,"endColumn",0),Gh(this,"startPosition",0),Gh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Kh(t,e,n){return(e=mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mee(t){var e=pee(t,"string");return typeof e=="symbol"?e:e+""}function pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wee{constructor(){Kh(this,"count",0),Kh(this,"startRow",0),Kh(this,"endRow",0),Kh(this,"startPosition",0),Kh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function MI(t,e,n){return(e=vee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vee(t){var e=yee(t,"string");return typeof e=="symbol"?e:e+""}function yee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cee extends Ek{constructor(){super(...arguments),MI(this,"columnStartOffset",0),MI(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _I(t,e,n){return(e=bee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bee(t){var e=See(t,"string");return typeof e=="symbol"?e:e+""}function See(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ree extends Tk{constructor(){super(...arguments),_I(this,"rowStartOffset",0),_I(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function xI(t,e,n){return(e=Eee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eee(t){var e=Tee(t,"string");return typeof e=="symbol"?e:e+""}function Tee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mk{constructor(e){xI(this,"calculationTypes",[]),xI(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Di(t,e,n){return(e=Mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mee(t){var e=_ee(t,"string");return typeof e=="symbol"?e:e+""}function _ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nh=50;class xee extends Mk{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Di(this,"viewportWidth",0),Di(this,"scrollOffset",0),Di(this,"zeroBasedScrollOffset",0),Di(this,"totalColumns",0),Di(this,"columnWidthFn",null),Di(this,"columnWidth",0),Di(this,"overrideFn",null),Di(this,"inlineStartOffset",0),Di(this,"totalCalculatedWidth",0),Di(this,"startPositions",[]),Di(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?nh:n}}function si(t,e,n){return(e=Pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=Iee(t,"string");return typeof e=="symbol"?e:e+""}function Iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oee extends Mk{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),si(this,"viewportHeight",0),si(this,"scrollOffset",0),si(this,"zeroBasedScrollOffset",0),si(this,"totalRows",0),si(this,"rowHeightFn",null),si(this,"rowHeight",0),si(this,"overrideFn",null),si(this,"horizontalScrollbarHeight",0),si(this,"innerViewportHeight",0),si(this,"totalCalculatedHeight",0),si(this,"startPositions",[]),si(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function Aee(t,e,n){Hee(t,e),e.set(t,n)}function Hee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PI(t,e,n){return(e=Nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nee(t){var e=Dee(t,"string");return typeof e=="symbol"?e:e+""}function Dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fu(t,e){return t.get(_k(t,e))}function II(t,e,n){return t.set(_k(t,e),n),n}function _k(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cs=new WeakMap;class gu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;PI(this,"row",null),PI(this,"col",null),Aee(this,cs,!1),II(cs,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Fu(cs,this)}isSouthEastOf(e){return this.row>=e.row&&(Fu(cs,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Fu(cs,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Fu(cs,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Fu(cs,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof gu&&II(cs,this,e.isRtl()),this}clone(){return new gu(this.row,this.col,Fu(cs,this))}toObject(){return{row:this.row,col:this.col}}}function $ee(t,e,n){kee(t,e),e.set(t,n)}function kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AC(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=Fee(t,"string");return typeof e=="symbol"?e:e+""}function Fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ai(t,e){return t.get(xk(t,e))}function Vee(t,e,n){return t.set(xk(t,e),n),n}function xk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yr=new WeakMap;class bg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;AC(this,"highlight",null),AC(this,"from",null),AC(this,"to",null),$ee(this,yr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Vee(yr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ai(yr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ai(yr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ai(yr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ai(yr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ai(yr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ai(yr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ai(yr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ai(yr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof gu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(ai(yr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(ai(yr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new bg(this.highlight,this.from,this.to,ai(yr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new gu(e,n,ai(yr,this))}}function mo(t,e,n){Bee(t,e),e.set(t,n)}function Bee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(Pk(t,e))}function ra(t,e,n){return t.set(Pk(t,e),n),n}function Pk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var li=new WeakMap,HC=new WeakMap,Hn=new WeakMap,Vu=new WeakMap,im=new WeakMap,$i=new WeakMap,NC=new WeakMap,qh=new WeakMap,al=new WeakMap,po=new WeakMap;let Ik=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;mo(this,li,void 0),mo(this,HC,void 0),mo(this,Hn,void 0),mo(this,Vu,void 0),mo(this,im,void 0),mo(this,$i,void 0),mo(this,NC,void 0),mo(this,qh,void 0),mo(this,al,[null,null]),mo(this,po,[null,null]),ra(li,this,r),ra(HC,this,n),ra(Hn,this,o),ra(Vu,this,s),ra(im,this,a),ra($i,this,i),ra(NC,this,e),this.registerEvents()}registerEvents(){ge($i,this).addEventListener(ge(Hn,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge($i,this).addEventListener(ge(Hn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge($i,this).addEventListener(ge(Hn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge($i,this).addEventListener(ge(Hn,this).holder,"touchstart",r=>this.onTouchStart(r)),ge($i,this).addEventListener(ge(Hn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge($i,this).addEventListener(ge(Hn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(li,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(li,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge($i,this).addEventListener(ge(Hn,this).holder,"mouseup",r=>this.onMouseUp(r)),ge($i,this).addEventListener(ge(Hn,this).holder,"mousedown",r=>this.onMouseDown(r))};Go()?e():(zE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(qh,this)&&r){const[i,o]=[r.row,ge(qh,this).from.row],[s,a]=[r.col,ge(qh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(Hn,this).TABLE,i=Fd(e,["TD","TH"],r);return i?(n.coords=ge(Hn,this).getCoords(i),n.TD=i):we(e,"wtBorder")&&we(e,"current")?(n.coords=ge(Vu,this).getFocusSelection().cellRange.highlight,n.TD=ge(Hn,this).getCell(n.coords)):we(e,"wtBorder")&&we(e,"area")&&ge(Vu,this).getAreaSelection().cellRange&&(n.coords=ge(Vu,this).getAreaSelection().cellRange.to,n.TD=ge(Hn,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(HC,this).rootDocument.activeElement,r=UE(A$,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);we(i,"corner")?ge(li,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(li,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(po,this)[0]=o.TD,clearTimeout(ge(al,this)[0]),ge(al,this)[0]=setTimeout(()=>{ge(po,this)[0]=null},1e3))}onContextMenu(e){if(ge(li,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(li,this).has("onCellMouseOver"))return;const n=ge(Hn,this).TABLE,r=Fd(e.target,["TD","TH"],n),i=ge(im,this)||this;r&&r!==i.lastMouseOver&&Va(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(Hn,this).getCoords(r),r))}onMouseOut(e){if(!ge(li,this).has("onCellMouseOut"))return;const n=ge(Hn,this).TABLE,r=Fd(e.target,["TD","TH"],n),i=Fd(e.relatedTarget,["TD","TH"],n),o=ge(im,this)||this;r&&r!==i&&Va(r,n)&&(this.callListener("onCellMouseOut",e,ge(Hn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(li,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(po,this)[0]&&n.TD===ge(po,this)[1]?(we(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(po,this)[0]=null,ge(po,this)[1]=null):n.TD===ge(po,this)[0]&&(ge(po,this)[1]=n.TD,clearTimeout(ge(al,this)[1]),ge(al,this)[1]=setTimeout(()=>{ge(po,this)[1]=null},500)))}onTouchStart(e){ra(qh,this,ge(Vu,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(li,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];GE()&&(rk()||ik())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(li,this).getSettingPure(e);o&&o(n,r,i,ge(NC,this).call(this))}destroy(){clearTimeout(ge(al,this)[0]),clearTimeout(ge(al,this)[1]),ge($i,this).destroy()}};function DC(t,e,n){return(e=Wee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wee(t){var e=jee(t,"string");return typeof e=="symbol"?e:e+""}function jee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uee{constructor(e,n,r){DC(this,"offset",void 0),DC(this,"total",void 0),DC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function $C(t,e,n){return(e=zee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zee(t){var e=Yee(t,"string");return typeof e=="symbol"?e:e+""}function Yee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gee{constructor(e,n,r){$C(this,"offset",void 0),$C(this,"total",void 0),$C(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function om(t,e,n){return(e=Kee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kee(t){var e=qee(t,"string");return typeof e=="symbol"?e:e+""}function qee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xee{constructor(){om(this,"currentSize",0),om(this,"nextSize",0),om(this,"currentOffset",0),om(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Jee=0,OI=1,DR=2;function kC(t,e,n){return(e=Zee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zee(t){var e=Qee(t,"string");return typeof e=="symbol"?e:e+""}function Qee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ete{constructor(){kC(this,"size",new Xee),kC(this,"workingSpace",Jee),kC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=OI,e.workingSpace=DR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=DR,e.workingSpace=OI,this.sharedSize=e.getViewSize()}}var AI=xv,tte=TypeError,nte=function(t,e){if(!delete t[e])throw new tte("Cannot delete property "+AI(e)+" of "+AI(t))},rte=Et,ite=dh,ote=gh,ste=LN,ate=nte,lte=FN,ute=[].unshift(0)!==1,cte=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},hte=ute||!cte();rte({target:"Array",proto:!0,arity:1,forced:hte},{unshift:function(e){var n=ite(this),r=ote(n),i=arguments.length;if(i){lte(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:ate(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return ste(n,r+i)}});function dte(t,e,n){return(e=fte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fte(t){var e=gte(t,"string");return typeof e=="symbol"?e:e+""}function gte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HI{constructor(e,n){dte(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function mte(t,e,n){return(e=pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pte(t){var e=wte(t,"string");return typeof e=="symbol"?e:e+""}function wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vte{constructor(e){mte(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new HI(o,n),l=new HI(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(DR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Bu(t,e,n){return(e=yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yte(t){var e=Cte(t,"string");return typeof e=="symbol"?e:e+""}function Cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ok{constructor(e,n){Bu(this,"rootNode",void 0),Bu(this,"nodesPool",void 0),Bu(this,"sizeSet",new ete),Bu(this,"collectedNodes",[]),Bu(this,"viewDiffer",new vte(this.sizeSet)),Bu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class Ak extends Ok{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function NI(t,e,n){return(e=bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bte(t){var e=Ste(t,"string");return typeof e=="symbol"?e:e+""}function Ste(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rte{constructor(e){NI(this,"nodeType",void 0),NI(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Xh(t,e,n){return(e=Ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ete(t){var e=Tte(t,"string");return typeof e=="symbol"?e:e+""}function Tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sg{constructor(e,n){Xh(this,"nodesPool",null),Xh(this,"nodeType",void 0),Xh(this,"rootNode",void 0),Xh(this,"table",null),Xh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Rte(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function DI(t,e,n){return(e=Mte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mte(t){var e=_te(t,"string");return typeof e=="symbol"?e:e+""}function _te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xte extends Sg{constructor(){super("TH"),DI(this,"orderViews",new WeakMap),DI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new Ak(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Ou(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(d,[k8(),Y8(),AE(h+1),Pu(-1)]),n[h](a,d,h)}u.end()}}}class Pte extends Sg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Qo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ce(this.rootNode,[M$()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ce(s,[RR(),I$(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Ou(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(u,[AE(a+1+this.table.rowHeadersCount),Pu(-1),L8(),...a>=0?[z8()]:[RR()]]),r[n](l,u,n)}}}}let $I=!1;class Ite extends Sg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!$I&&e>1e3&&($I=!0,it(gt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function Ote(t,e,n){return(e=Ate(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ate(t){var e=Hte(t,"string");return typeof e=="symbol"?e:e+""}function Hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Wu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let kI=!1;class Nte extends Sg{constructor(e){super("TR",e),Ote(this,"orderView",void 0),this.orderView=new Ok(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!kI&&e>1e3&&(kI=!0,it(gt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ce(this.rootNode,[M$()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ce(o,[RR(),I$(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?we(o,Wu.rowEven)||(pe(o,Wu.rowOdd),q(o,Wu.rowEven)):we(o,Wu.rowOdd)||(pe(o,Wu.rowEven),q(o,Wu.rowOdd))}this.orderView.end()}}function LI(t,e,n){return(e=Dte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dte(t){var e=$te(t,"string");return typeof e=="symbol"?e:e+""}function $te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kte extends Sg{constructor(){super("TD"),LI(this,"orderViews",new WeakMap),LI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new Ak(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(we(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Ou(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;Ce(g,[...g.hasAttribute("role")?[]:[$8()],Pu(-1),AE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function vn(t,e,n){return(e=Lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lte(t){var e=Fte(t,"string");return typeof e=="symbol"?e:e+""}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vte{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};vn(this,"rootNode",void 0),vn(this,"rootDocument",void 0),vn(this,"rowHeaders",null),vn(this,"columnHeaders",null),vn(this,"colGroup",null),vn(this,"rows",null),vn(this,"cells",null),vn(this,"rowFilter",null),vn(this,"columnFilter",null),vn(this,"rowUtils",null),vn(this,"columnUtils",null),vn(this,"rowsToRender",0),vn(this,"columnsToRender",0),vn(this,"rowHeaderFunctions",[]),vn(this,"rowHeadersCount",0),vn(this,"columnHeaderFunctions",[]),vn(this,"columnHeadersCount",0),vn(this,"cellRenderer",void 0),vn(this,"activeOverlayName",void 0),vn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class Bte{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Vte(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new xte,columnHeaders:new Pte(n),colGroup:new Ite(r),rows:new Nte(i),cells:new kte}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function LC(t,e,n){return(e=Wte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wte(t){var e=jte(t,"string");return typeof e=="symbol"?e:e+""}function jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ute{constructor(e,n){LC(this,"dataAccessObject",void 0),LC(this,"wtSettings",void 0),LC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function FI(t,e,n){return(e=zte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zte(t){var e=Yte(t,"string");return typeof e=="symbol"?e:e+""}function Yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gte{constructor(e,n){FI(this,"dataAccessObject",void 0),FI(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function wo(t,e,n){return(e=Kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kte(t){var e=qte(t,"string");return typeof e=="symbol"?e:e+""}function qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bh{constructor(e,n,r,i,o){wo(this,"wtSettings",null),wo(this,"domBindings",void 0),wo(this,"TBODY",null),wo(this,"THEAD",null),wo(this,"COLGROUP",null),wo(this,"hasTableHeight",!0),wo(this,"hasTableWidth",!0),wo(this,"isTableVisible",!1),wo(this,"tableOffset",0),wo(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,NE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Gte(this.dataAccessObject,this.wtSettings),this.columnUtils=new Ute(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Bte({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ce(r,[ks()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[ks()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",Ce(r,[Pu(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ce(r.parentNode,[ks()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[ks()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Bn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Bn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Gee(f,o,c),this.columnFilter=new Uee(g,s,l);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),p=C.skipRender!==!0}p&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Wo)||this.is(Wa))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Wo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Wo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Uc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Wo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ya(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=D$(r),s=n.cellIndex;va(wu,n,this.wtRootElement)||va(mu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):va(Wa,n,this.wtRootElement)||va(Wo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),va(wu,n,this.wtRootElement)||va(pu,n,this.wtRootElement)||va(Wa,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=Uc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?dn:Uc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return rn(this.TABLE)}getHeight(){return dn(this.TABLE)}getTotalWidth(){const e=rn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=dn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return fu(this.TABLE)}_modifyRowHeaderWidth(e){let n=dt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Xte="stickyRowsBottom",iT={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};os(iT,"MIXIN_NAME",Xte,{writable:!1,enumerable:!1});const Jte="stickyColumnsStart",Zv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};os(Zv,"MIXIN_NAME",Jte,{writable:!1,enumerable:!1});class oT extends bh{constructor(e,n,r,i){super(e,n,r,i,Wa)}}vt(oT,iT);vt(oT,Zv);const mu="top",Wo="bottom",pu="inline_start",wu="top_inline_start_corner",Wa="bottom_inline_start_corner",Hk=[mu,Wo,pu,wu,Wa],Zte=new Map([[mu,`ht_clone_${mu}`],[Wo,`ht_clone_${Wo}`],[pu,`ht_clone_${pu} ht_clone_left`],[wu,`ht_clone_${wu} ht_clone_top_left_corner`],[Wa,`ht_clone_${Wa} ht_clone_bottom_left_corner`]]);function Qte(t,e){ene(t,e),e.add(t)}function ene(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tne(t,e,n){return(e=nne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nne(t){var e=rne(t,"string");return typeof e=="symbol"?e:e+""}function rne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jh=new WeakSet;class ine{constructor(e){Qte(this,Jh),tne(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=$r(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=$r(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return sm(Jh,this,BI).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return sm(Jh,this,BI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return sm(Jh,this,VI).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return sm(Jh,this,VI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function VI(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Bn(r.wtRootElement).left;const u=Math.abs($E(s,s));if(l>u){const c=kE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function BI(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Bn(n.wtRootElement),a=Uv(o,o);if(s.top>a){const l=Uc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function ui(t,e,n){return(e=one(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function one(t){var e=sne(t,"string");return typeof e=="symbol"?e:e+""}function sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sT{get eventManager(){return new Mi(this)}constructor(e,n){ui(this,"wtTable",void 0),ui(this,"wtScroll",void 0),ui(this,"wtViewport",void 0),ui(this,"wtOverlays",void 0),ui(this,"selectionManager",void 0),ui(this,"wtEvent",void 0),ui(this,"guid",`wt_${PE()}`),ui(this,"drawInterrupted",!1),ui(this,"drawn",!1),ui(this,"activeOverlayName","master"),ui(this,"domBindings",void 0),ui(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new ine(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Ga(r,e[n])}])}}createCellCoords(e,n){return new gu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new bg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||F$(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function WI(t,e,n){return(e=ane(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ane(t){var e=lne(t,"string");return typeof e=="symbol"?e:e+""}function lne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class une extends sT{constructor(e,n,r){super(e,n),WI(this,"cloneSource",void 0),WI(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new Ik(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function cne(t,e,n){return(e=hne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hne(t){var e=dne(t,"string");return typeof e=="symbol"?e:e+""}function dne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rg{constructor(e,n,r,i,o){cne(this,"wtSettings",null),os(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=eh(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=eh(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Af(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){it(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+In())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(Hk.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Zte.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ce(o,[ks()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===mu||u==="vertical"&&this.type===pu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Af(e.TABLE),new une(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class fne extends Rg{constructor(e,n,r,i,o,s){super(e,n,Wa,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new oT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else pg(n),this.repositionOverlay();let r=dn(this.clone.wtTable.TABLE);const i=rn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=In(r)),i.style.bottom=`${o}px`}}const gne="calculatedColumns",Qv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};os(Qv,"MIXIN_NAME",gne,{writable:!1,enumerable:!1});class aT extends bh{constructor(e,n,r,i){super(e,n,r,i,Wo)}}vt(aT,iT);vt(aT,Qv);function mne(t,e,n){return(e=pne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pne(t){var e=wne(t,"string");return typeof e=="symbol"?e:e+""}function wne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vne extends Rg{constructor(e,n,r,i){super(e,n,Wo,r,i),mne(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new aT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=In(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(jv(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=In(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=dn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=In(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Uv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=we(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(pe(s,"innerBorderBottom"),o=a)}return o}}const yne="calculatedRows",lT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};os(lT,"MIXIN_NAME",yne,{writable:!1,enumerable:!1});class uT extends bh{constructor(e,n,r,i){super(e,n,r,i,pu)}}vt(uT,lT);vt(uT,Zv);const Cne="localHooks",Wn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Pw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};os(Wn,"MIXIN_NAME",Cne,{writable:!1,enumerable:!1});let Nk=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};vt(Nk,Wn);const Dk="active-header",cT="header",hT="area",Qd="focus",bne="fill",Sne="row",Rne="column",Ene="custom-selection",dT=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var Tne=Xv;Tne("flat");function Mne(t,e){$k(t,e),e.add(t)}function jI(t,e,n){$k(t,e),e.set(t,n)}function $k(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(t,e){return t.get(ef(t,e))}function UI(t,e,n){return t.set(ef(t,e),n),n}function ef(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wi=new WeakMap,Gn=new WeakMap,am=new WeakSet;class _ne{constructor(){Mne(this,am),jI(this,Wi,void 0),jI(this,Gn,void 0)}setActiveOverlay(e){return UI(Gn,this,e),this}setActiveSelection(e){return UI(Wi,this,e),this}scan(){const e=Yt(Wi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Yt(Wi,this).getCorners(),{wtTable:s}=Yt(Gn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const p=Yt(Gn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Yt(Wi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});p!==null&&(p!==h&&(g=s.getColumnHeader(p,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Yt(Wi,this).getCorners(),{wtTable:s}=Yt(Gn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const p=Yt(Gn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Yt(Wi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});p!==null&&(p!==h&&(g=s.getRowHeader(p,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Yt(Gn,this);ef(am,this,xne).call(this,(r,i)=>{const o=n.getCell(Yt(Gn,this).createCellCoords(r,i)),s=Yt(Gn,this).getSetting("onAfterDrawSelection",r,i,Yt(Wi,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Yt(Wi,this).getCorners(),{wtTable:i}=Yt(Gn,this);ef(am,this,zI).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Yt(Gn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Yt(Wi,this).getCorners(),{wtTable:i}=Yt(Gn,this);ef(am,this,zI).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Yt(Gn,this).createCellCoords(o,s));e(a)}})}}function xne(t){let[e,n,r,i]=Yt(Wi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Yt(Gn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Yt(Gn,this).createCellCoords(e,n));if(!qo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function zI(t){const{wtTable:e}=Yt(Gn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class YI{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=dT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ai(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Go()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Le(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};Le(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),p=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-p/4*3,10)}px`,c[l]=`${parseInt(i-p/4*3,10)}px`;const y=Math.min(parseInt(i+o,10),C-g-f*2),T=Math.min(parseInt(i+o-p/4,10),C-p-f*2);h[l]=`${y}px`,d[l]=`${T}px`;const M=Math.min(parseInt(r+s,10),E-g-f*2),I=Math.min(parseInt(r+s-p/4,10),E-p-f*2);h.top=`${M}px`,d.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!qo(g)){this.disappear();return}const p=u?s.getCell(this.wot.createCellCoords(i,o)):g,C=Bn(g),E=u?Bn(p):C,y=Bn(s.TABLE),T=C.top,M=C.left,I=this.wot.wtSettings.getSetting("rtlMode");let _=0,P=0;if(I){const Ee=rn(s.TABLE),Ne=rn(g),lt=l.innerWidth-y.left-Ee;P=M+Ne-E.left,_=l.innerWidth-M-Ne-lt-1}else P=E.left+rn(p)-M,_=M-y.left-1;if(this.isEntireColumnSelected(n,i)){const Ee=n,Ne=this.getDimensionsFromHeader("columns",r,o,Ee,y);let lt=null;Ne&&([lt,_,P]=Ne),lt&&(g=lt)}let Y=T-y.top-1,V=E.top+dn(p)-T;if(this.isEntireRowSelected(r,o)){const Ee=r,Ne=this.getDimensionsFromHeader("rows",n,i,Ee,y);let lt=null;Ne&&([lt,Y,V]=Ne),lt&&(g=lt)}const B=l.getComputedStyle(g);parseInt(B.borderTopWidth,10)>0&&(Y+=1,V=V>0?V-1:0),parseInt(B[I?"borderRightWidth":"borderLeftWidth"],10)>0&&(_+=1,P=P>0?P-1:0);const Z=I?"right":"left";this.topStyle.top=`${Y}px`,this.topStyle[Z]=`${_}px`,this.topStyle.width=`${P}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[Z]=`${_}px`,this.startStyle.height=`${V}px`,this.startStyle.display="block";const X=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Y+V-X}px`,this.bottomStyle[Z]=`${_}px`,this.bottomStyle.width=`${P}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[Z]=`${_+P-X}px`,this.endStyle.height=`${V+1}px`,this.endStyle.display="block";let Q=this.settings.border.cornerVisible;Q=typeof Q=="function"?Q(this.settings.layerLevel):Q;const se=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[be,bt]=[i,o];if(se&&Array.isArray(se)&&([,,be,bt]=se),Go()||!Q||this.isPartRange(be,bt))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+V+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Z]=`${_+P+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ee=eh(s.TABLE);const Ne=Ee===l;Ne&&(Ee=a.documentElement);const lt=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,On=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),ut=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ne?p.getBoundingClientRect().left:p.offsetLeft;let v=!1,w=0;I?(w=m-parseInt(this.cornerDefaultStyle.width,10)/2,v=w<0):(w=m+rn(p)+parseInt(this.cornerDefaultStyle.width,10)/2,v=w>=kE(Ee)),v&&(this.cornerStyle[Z]=`${Math.floor(_+P+this.cornerCenterPointOffset-On-lt)}px`,this.cornerStyle[I?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const w=(Ne?p.getBoundingClientRect().top:p.offsetTop)+dn(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=Uc(Ee),A=this.wot.stylesHandler.isClassicTheme();if(w){const L=Math.floor(Y+V+this.cornerCenterPointOffset-ut-lt);A?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}Go()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,Y,_,P,V)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,p=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return dn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return rn(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(g=l(n,C-i),p=l(r,C-i),!g||!p)return!1;const E=Bn(g),y=Bn(p);return g&&p&&(h=E[f]-o[f]-1,d=y[f]+u(p)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(we(this[e],"hidden")&&pe(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):pe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Go()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Pne(t,e){kk(t,e),e.add(t)}function ju(t,e,n){kk(t,e),e.set(t,n)}function kk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(t,e){return t.get(fT(t,e))}function GI(t,e,n){return t.set(fT(t,e),n),n}function fT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Kn=new WeakMap,Ir=new WeakMap,FC=new WeakMap,Vd=new WeakMap,VC=new WeakMap,ll=new WeakMap,KI=new WeakSet;class Ine{constructor(e){Pne(this,KI),ju(this,Kn,void 0),ju(this,Ir,void 0),ju(this,FC,new _ne),ju(this,Vd,new WeakMap),ju(this,VC,new WeakSet),ju(this,ll,new Map),GI(Ir,this,e)}setActiveOverlay(e){return GI(Kn,this,e),Fe(FC,this).setActiveOverlay(Fe(Kn,this)),Fe(Vd,this).has(Fe(Kn,this))||Fe(Vd,this).set(Fe(Kn,this),new Set),this}getFocusSelection(){return Fe(Ir,this)!==null?Fe(Ir,this).getFocus():null}getAreaSelection(){return Fe(Ir,this)!==null?Fe(Ir,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Fe(ll,this).has(e)){const r=Fe(ll,this).get(e);if(r.has(Fe(Kn,this)))return r.get(Fe(Kn,this));const i=new YI(Fe(Kn,this),e.settings);return r.set(Fe(Kn,this),i),i}const n=new YI(Fe(Kn,this),e.settings);return Fe(ll,this).set(e,new Map([[Fe(Kn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Fe(ll,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Fe(ll,this).get(e).forEach(n=>n.destroy()),Fe(ll,this).delete(e)}render(e){if(Fe(Ir,this)===null)return;e&&fT(KI,this,One).call(this);const n=Array.from(Fe(Ir,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Fe(VC,this).has(s)||(Fe(VC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Fe(FC,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const p=r.get(g);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();Fe(Kn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Fe(Vd,this).get(Fe(Kn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=Fe(Ir,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ce(s,Fe(Ir,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ce(o,[...i.get(o)])})}}function One(){const t=Fe(Vd,this).get(Fe(Kn,this)),e=Fe(Kn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Fe(Kn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Fe(Ir,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Fe(Ir,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Fe(Ir,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Fe(Ir,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)pe(o[a],n),Ou(o[a],s)}),t.clear()}class Ane extends Rg{constructor(e,n,r,i){super(e,n,pu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new uT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),zv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),pg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,DE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=In(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=rn(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=dT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!we(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=In(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,B$(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs($E(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?pe(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=we(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(pe(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const Hne="stickyRowsTop",gT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};os(gT,"MIXIN_NAME",Hne,{writable:!1,enumerable:!1});class mT extends bh{constructor(e,n,r,i){super(e,n,r,i,wu)}}vt(mT,gT);vt(mT,Zv);function qI(t,e,n){return(e=Nne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nne(t){var e=Dne(t,"string");return typeof e=="symbol"?e:e+""}function Dne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ne extends Rg{constructor(e,n,r,i,o,s){super(e,n,wu,r,i),qI(this,"topOverlay",void 0),qI(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new mT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();zv(e,`${i}px`,`${o}px`)}else pg(e);let n=dn(this.clone.wtTable.TABLE);const r=rn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class pT extends bh{constructor(e,n,r,i){super(e,n,r,i,mu)}}vt(pT,gT);vt(pT,Qv);function kne(t,e,n){return(e=Lne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lne(t){var e=Fne(t,"string");return typeof e=="symbol"?e:e+""}function Fne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vne extends Rg{constructor(e,n,r,i){super(e,n,mu,r,i),kne(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new pT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),zv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),pg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(jv(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=In(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=dn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=dT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!we(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=In(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,V$(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Uv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?pe(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=we(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(pe(i,"innerBorderTop"),a=h)}}return a}}function lm(t,e,n){Bne(t,e),e.set(t,n)}function Bne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(t,e,n){return(e=Wne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wne(t){var e=jne(t,"string");return typeof e=="symbol"?e:e+""}function jne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ul(t,e,n){return t.set(Lk(t,e),n),n}function ds(t,e){return t.get(Lk(t,e))}function Lk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uu=new WeakMap,um=new WeakMap,zu=new WeakMap,cm=new WeakMap;class Une{constructor(e,n,r,i,o,s){hs(this,"wot",null),lm(this,Uu,[]),hs(this,"topOverlay",null),hs(this,"bottomOverlay",null),hs(this,"inlineStartOverlay",null),hs(this,"topInlineStartCornerOverlay",null),hs(this,"bottomInlineStartCornerOverlay",null),hs(this,"browserLineHeight",void 0),hs(this,"wtSettings",null),lm(this,um,!1),lm(this,zu,0),lm(this,cm,null),hs(this,"resizeObserver",new ResizeObserver(c=>{Nf(()=>{!Array.isArray(c)||!c.length||(ul(zu,this,ds(zu,this)+1),ds(zu,this)===100&&(it("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ds(cm,this)!==null&&clearTimeout(ds(cm,this)),ul(cm,this,setTimeout(()=>{ul(zu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=In(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Af(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...ds(Uu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Vne(...e),this.bottomOverlay=new vne(...e),this.inlineStartOverlay=new Ane(...e),this.topInlineStartCornerOverlay=new $ne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new fne(...e,this.bottomOverlay,this.inlineStartOverlay),ul(Uu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ul(um,this,ds(Uu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),ds(Uu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ds(Uu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!YE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Nf(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ul(zu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Ch(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!ds(um,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),ul(um,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Af(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),p=f()?1:0,C=g()?1:0;d.width=`${c+C}px`,d.height=`${u+p}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return x(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];x(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function XI(t,e,n){return(e=zne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zne(t){var e=Yne(t,"string");return typeof e=="symbol"?e:e+""}function Yne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gne{constructor(e){XI(this,"settings",{}),XI(this,"defaults",Object.freeze(this.getDefaults())),Le(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Ga(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Le(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class wT extends bh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=eh(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Hf(e,"height",n),o=Hf(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=fu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}vt(wT,lT);vt(wT,Qv);class Kne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new wee:new Ree],["fullyVisible",()=>new aee],["partiallyVisible",()=>new Tk]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new gee:new Cee],["fullyVisible",()=>new iee],["partiallyVisible",()=>new Ek]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=dn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Bn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=dn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=rn(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=In(this.domBindings.rootDocument),new Oee({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=In(this.domBindings.rootDocument)),new xee({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){Le(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function qne(t,e){Fk(t,e),e.add(t)}function cl(t,e,n){Fk(t,e),e.set(t,n)}function Fk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(Ji(t,e))}function Xi(t,e,n){return t.set(Ji(t,e),n),n}function Ji(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JI=23;var Io=new WeakMap,Hs=new WeakMap,vT=new WeakMap,$R=new WeakMap,ya=new WeakMap,Bd=new WeakMap,kf=new WeakMap,Ho=new WeakSet;class Xne{constructor(e){qne(this,Ho),cl(this,Io,void 0),cl(this,Hs,void 0),cl(this,vT,void 0),cl(this,$R,void 0),cl(this,ya,!0),cl(this,Bd,{}),cl(this,kf,{}),Xi(Hs,this,e.rootTable.parentElement.parentElement),Xi($R,this,e.rootDocument)}isClassicTheme(){return kt(ya,this)}getCSSVariableValue(e){var n;if(kt(ya,this))return null;if(kt(Bd,this)[`--ht-${e}`])return kt(Bd,this)[`--ht-${e}`];const r=(n=Ji(Ho,this,ere).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Ji(Ho,this,Vk).call(this,`--ht-${e}`);if(r!==null)return kt(Bd,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=kt(kf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(kt(ya,this))return JI;const e=Ji(Ho,this,Jne).call(this);return!e&&we(kt(Hs,this),"ht-wrapper")?(it(`The "${kt(Io,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Xi(ya,this,!0),this.useTheme(),JI):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Ji(Ho,this,ZI).call(this),Xi(ya,this,!0),Xi(Io,this,e||void 0);return}e&&e!==kt(Io,this)&&(kt(Io,this)&&Ji(Ho,this,tre).call(this),Xi(Io,this,e),Xi(ya,this,!1),Ji(Ho,this,Zne).call(this),Ji(Ho,this,ZI).call(this))}getThemeName(){return kt(Io,this)}removeClassNames(){we(kt(Hs,this),kt(Io,this))&&pe(kt(Hs,this),kt(Io,this))}}function Jne(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Zne(){pe(kt(Hs,this),/ht-theme-.*/g),q(kt(Hs,this),kt(Io,this))}function ZI(){this.isClassicTheme()||Xi(vT,this,getComputedStyle(kt(Hs,this)));const t=Ji(Ho,this,Qne).call(this,["box-sizing","border-bottom-width"]);kt(kf,this).td={...kt(kf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Qne(t){const e=kt($R,this),n=kt(Hs,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function ere(t){const e=Math.ceil(parseFloat(Ji(Ho,this,Vk).call(this,t)));return Number.isNaN(e)?null:e}function Vk(t){const e=kt(vT,this).getPropertyValue(t);return e===""?null:e}function tre(){Xi(kf,this,{}),Xi(Bd,this,{}),Xi(ya,this,!0)}class nre extends sT{constructor(e,n){super(e,new Gne(n)),this.stylesHandler=new Xne(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new wT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Kne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Ine(this.wtSettings.getSetting("selections")),this.wtEvent=new Ik(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Une(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Le(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),pe(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!Hk.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class yT{constructor(e){e instanceof sT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new yT(n);return()=>r},this._wot=new nre(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function QI(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function rre(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const ire=new Map([["mousedown",QI],["mouseover",rre],["touchstart",QI]]);function eO(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;ire.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:qv(t)||t.type==="touchstart",isRightClick:Ka(t)})}const Bk=new WeakMap,CT=Symbol("rootInstance");function ore(t){Bk.set(t,!0)}function sre(t){return t===CT}function Wp(t){return Bk.has(t)}function are(t,e){Wk(t,e),e.add(t)}function ia(t,e,n){Wk(t,e),e.set(t,n)}function Wk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oa(t,e,n){return(e=lre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lre(t){var e=ure(t,"string");return typeof e=="symbol"?e:e+""}function ure(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sn(t,e){return t.get(Yc(t,e))}function Cr(t,e,n){return t.set(Yc(t,e),n),n}function Yc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var BC=new WeakMap,hm=new WeakMap,dm=new WeakMap,fs=new WeakMap,ki=new WeakMap,WC=new WeakMap,jC=new WeakMap,Yu=new WeakMap,Wd=new WeakSet;class cre{constructor(e){are(this,Wd),oa(this,"hot",void 0),oa(this,"eventManager",void 0),oa(this,"settings",void 0),oa(this,"THEAD",void 0),oa(this,"TBODY",void 0),oa(this,"_wt",void 0),oa(this,"activeWt",void 0),ia(this,BC,0),ia(this,hm,0),oa(this,"postponedAdjustElementsSize",!1),ia(this,dm,!1),ia(this,fs,void 0),ia(this,ki,void 0),ia(this,WC,0),ia(this,jC,0),ia(this,Yu,null),this.hot=e,this.eventManager=new Mi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Yc(Wd,this,dre).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),Cr(ki,this,n.createElement("TABLE")),q(sn(ki,this),"htCore"),this.hot.getSettings().tableClassName&&q(sn(ki,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ce(sn(ki,this),[ks()]),Ce(e,[D8(),P$(-1),Wv(this.hot.countCols()),q8()])),this.THEAD=n.createElement("THEAD"),sn(ki,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),sn(ki,this).appendChild(this.TBODY),this.hot.table=sn(ki,this),this.hot.container.insertBefore(sn(ki,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Cr(dm,this,!0),this.isTextSelectionAllowed(a.target)||(ER(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Cr(dm,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{sn(dm,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&ER(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&qv(a)&&r.finish(),Cr(fs,this,!1);const l=Yv(n.activeElement);Zd(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Ka(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&Ka(a)&&(r.finish(),Cr(fs,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),Cr(fs,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(sn(fs,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=In(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=du(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=du(s);this.eventManager.addEventListener(sn(ki,this),"selectstart",a=>{this.settings.fragmentSelection||Zd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&pe(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:sn(ki,this),isDataViewInstance:()=>Wp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Cr(hm,this,o.length),this.hot.getSettings().ariaTags&&Yc(Wd,this,jk).call(this)===this.hot.countCols()&&Yc(Wd,this,hre).call(this,sn(hm,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Cr(BC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let p=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,p,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,p,f),this.hot.runHooks("afterRenderer",a,l,u,g,p,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&fu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Cr(fs,this,!0),Cr(Yu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ma(o)&&(eO(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Cr(fs,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ma(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ma(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ma(o)&&(sn(fs,this)&&(!sn(Yu,this)||sn(Yu,this).x!==o.clientX||sn(Yu,this).y!==o.clientY)&&eO(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Cr(Yu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ma(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,p,C,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,1)):p,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new yT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Zd(e))return!0;const n=Va(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return sn(fs,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!we(r,"relative")){Qo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;we(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(Qo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ce(a,...ks()),Ce(l,...ks())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(we(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):we(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Au(e,r(n,i)):(Ga(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Cr(WC,this,e),Cr(jC,this,n)}getLastSize(){return{width:sn(WC,this),height:sn(jC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return sn(BC,this)}getRowHeadersCount(){return sn(hm,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function jk(){return parseInt(this.hot.rootElement.getAttribute(Wv()[0]),10)}function hre(t){const e=Yc(Wd,this,jk).call(this)+t;Ce(this.hot.rootElement,...Wv(e))}function dre(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):pe(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):pe(t,"htHasScrollX")}var fre=Et,gre=Sn,mre=mh,pre=Lr,wre=En,vre=ns,yre=ni,Cre=Za,UC=Cre("every",TypeError);fre({target:"Iterator",proto:!0,real:!0,forced:UC},{every:function(e){wre(this);try{pre(e)}catch(i){yre(this,"throw",i)}if(UC)return gre(UC,this,e);var n=vre(this),r=0;return!mre(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const Uk="ABCDEFGHIJKLMNOPQRSTUVWXYZ",kR=Uk.length;function ey(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%kR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/kR,10);return n}function bre(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=kR**r*(Uk.indexOf(t[n])+1);return e-=1,e}function Sre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(ey(i)+(r+1));n.push(o)}return n}function Rre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=ey(i)+(r+1);n.push(o)}return n}function Ere(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function bT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function ST(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ke(t[0])&&(e=Kv(t[0]))),e}function zk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Yk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const Tre=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:ST,createEmptySpreadsheetData:Ere,createSpreadsheetData:Sre,createSpreadsheetObjectData:Rre,dataRowToChangesArray:bT,isArrayOfArrays:zk,isArrayOfObjects:Yk,spreadsheetColumnIndex:bre,spreadsheetColumnLabel:ey},Symbol.toStringTag,{value:"Module"}));function Zh(t,e,n){return(e=Mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mre(t){var e=_re(t,"string");return typeof e=="symbol"?e:e+""}function _re(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Zh(this,"hot",void 0),Zh(this,"data",void 0),Zh(this,"dataType","array"),Zh(this,"colToProp",()=>{}),Zh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return x(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(ke(a)||dt(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Fp(l,d,f):l[d]=f}})}else Le(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Fp(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=$r(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Fp(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Z$(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=$r(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return ST(this.data)}destroy(){this.data=null,this.hot=null}}var Pre=Et,Ire=Sn,Ore=mh,Are=Lr,Hre=En,Nre=ns,Dre=ni,$re=Za,zC=$re("some",TypeError);Pre({target:"Iterator",proto:!0,real:!0,forced:zC},{some:function(e){Hre(this);try{Are(e)}catch(i){Dre(this,"throw",i)}if(zC)return Ire(zC,this,e);var n=Nre(this),r=0;return Ore(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function tO(t,e,n){return(e=kre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kre(t){var e=Lre(t,"string");return typeof e=="symbol"?e:e+""}function Lre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;tO(this,"indexedValues",[]),tO(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,dt(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}vt(Hu,Wn);function RT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>dt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function ET(t,e){return za(t,(n,r)=>e.includes(r)===!1)}class Qa extends Hu{insert(e,n){this.indexedValues=RT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=ET(this.indexedValues,e),super.remove(e)}}class ty extends Qa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Tn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function TT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Lf(t,e){return za(t,n=>e.includes(n)===!1)}function MT(t,e){return Ke(t,n=>n-e.filter(r=>r<n).length)}function _T(t,e){const n=e[0],r=e.length;return Ke(t,i=>i>=n?i+r:i)}function Fre(t,e,n){return(e=Vre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vre(t){var e=Bre(t,"string");return typeof e=="symbol"?e:e+""}function Bre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ny extends Hu{constructor(){super(...arguments),Fre(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Lf(this.orderOfIndexes,[e]),dt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=RT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=_T(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=ET(this.indexedValues,e),this.orderOfIndexes=Lf(this.orderOfIndexes,e),this.orderOfIndexes=MT(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Eg extends Qa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Tn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const nO=new Map([["indexesSequence",{getListWithInsertedItems:TT,getListWithRemovedItems:Lf}],["physicallyIndexed",{getListWithInsertedItems:RT,getListWithRemovedItems:ET}]]),Gk=t=>{if(nO.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return nO.get(t)};class Kk extends Hu{constructor(){super(e=>e)}insert(e,n){const r=_T(this.indexedValues,n);this.indexedValues=TT(r,e,n),super.insert(e,n)}remove(e){const n=Lf(this.indexedValues,e);this.indexedValues=MT(n,e),super.remove(e)}}const rO=new Map([["hiding",ty],["index",Hu],["linkedPhysicalIndexToValue",ny],["physicalIndexToValue",Qa],["trimming",Eg]]);function Wre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!rO.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(rO.get(t))(e)}function jre(t,e,n){return(e=Ure(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ure(t){var e=zre(t,"string");return typeof e=="symbol"?e:e+""}function zre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let LR=0;class xT{constructor(){jre(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),LR+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),LR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Lt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}vt(xT,Wn);function Yre(){return LR}function YC(t,e,n){return(e=Gre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gre(t){var e=Kre(t,"string");return typeof e=="symbol"?e:e+""}function Kre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iO extends xT{constructor(e,n){super(),YC(this,"mergedValuesCache",[]),YC(this,"aggregationFunction",void 0),YC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ke(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ke(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function qre(t,e,n){Xre(t,e),e.set(t,n)}function Xre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jre(t,e,n){return t.set(qk(t,e),n),n}function Zre(t,e){return t.get(qk(t,e))}function qk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var GC=new WeakMap;class Xk{constructor(){qre(this,GC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Zre(GC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Jre(GC,this,e)}}vt(Xk,Wn);function oO(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Qh(t,e,n){Qre(t,e),e.set(t,n)}function Qre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ci(t,e){return t.get(Jk(t,e))}function fm(t,e,n){return t.set(Jk(t,e),n),n}function Jk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gm=new WeakMap,ed=new WeakMap,mm=new WeakMap,pm=new WeakMap,wm=new WeakMap;class eie{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Qh(this,gm,new Set),Qh(this,ed,[]),Qh(this,mm,[]),Qh(this,pm,!1),Qh(this,wm,!1),fm(wm,this,e??!1)}createObserver(){const e=new Xk;return ci(gm,this).add(e),e.addLocalHook("unsubscribe",()=>{ci(gm,this).delete(e)}),e._writeInitialChanges(oO(ci(ed,this),ci(mm,this))),e}emit(e){let n=ci(mm,this);(!ci(pm,this)||ci(ed,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(ci(wm,this)):fm(ed,this,new Array(e.length).fill(ci(wm,this))),ci(pm,this)||(fm(pm,this,!0),n=ci(ed,this)));const r=oO(n,e);ci(gm,this).forEach(i=>i._write(r)),fm(mm,this,e)}}function or(t,e,n){return(e=tie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tie(t){var e=nie(t,"string");return typeof e=="symbol"?e:e+""}function nie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FR{constructor(){or(this,"indexesSequence",new Kk),or(this,"trimmingMapsCollection",new iO(e=>e.some(n=>n===!0),!1)),or(this,"hidingMapsCollection",new iO(e=>e.some(n=>n===!0),!1)),or(this,"variousMapsCollection",new xT),or(this,"hidingChangesObservable",new eie({initialIndexValue:!1})),or(this,"notTrimmedIndexesCache",[]),or(this,"notHiddenIndexesCache",[]),or(this,"isBatched",!1),or(this,"indexesSequenceChanged",!1),or(this,"indexesChangeSource",void 0),or(this,"trimmedIndexesChanged",!1),or(this,"hiddenIndexesChanged",!1),or(this,"renderablePhysicalIndexesCache",[]),or(this,"fromPhysicalToVisualIndexesCache",new Map),or(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,Wre(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Eg?this.trimmingMapsCollection.register(e,n):n instanceof ty?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ke(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Lf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(TT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ke(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}vt(FR,Wn);function rie(t,e){return Le(e,(n,r)=>{Lt(t[r])&&(t[r]=n)}),t}function Zk(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Qk(t){le(t)&&XE(gt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function iie(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:oie,getValues:sie}=co("phraseFormatters");function aie(t,e){oie(t,e)}function lie(){return sie()}aie("pluralize",iie);const eL="ContextMenu:items",Oe=eL,PT=`${Oe}.noItems`,IT=`${Oe}.insertRowAbove`,OT=`${Oe}.insertRowBelow`,AT=`${Oe}.insertColumnOnTheLeft`,HT=`${Oe}.insertColumnOnTheRight`,NT=`${Oe}.removeRow`,DT=`${Oe}.removeColumn`,$T=`${Oe}.undo`,kT=`${Oe}.redo`,Nw=`${Oe}.readOnly`,LT=`${Oe}.clearColumn`,FT=`${Oe}.copy`,VT=`${Oe}.copyWithHeaders`,BT=`${Oe}.copyWithGroupHeaders`,WT=`${Oe}.copyHeadersOnly`,jT=`${Oe}.cut`,UT=`${Oe}.freezeColumn`,zT=`${Oe}.unfreezeColumn`,YT=`${Oe}.mergeCells`,GT=`${Oe}.unmergeCells`,KT=`${Oe}.addComment`,qT=`${Oe}.editComment`,XT=`${Oe}.removeComment`,JT=`${Oe}.readOnlyComment`,ZT=`${Oe}.align`,QT=`${Oe}.align.left`,eM=`${Oe}.align.center`,tM=`${Oe}.align.right`,nM=`${Oe}.align.justify`,rM=`${Oe}.align.top`,iM=`${Oe}.align.middle`,oM=`${Oe}.align.bottom`,sM=`${Oe}.borders`,aM=`${Oe}.borders.top`,lM=`${Oe}.borders.right`,uM=`${Oe}.borders.bottom`,cM=`${Oe}.borders.left`,hM=`${Oe}.borders.remove`,dM=`${Oe}.nestedHeaders.insertChildRow`,fM=`${Oe}.nestedHeaders.detachFromParent`,gM=`${Oe}.hideColumn`,mM=`${Oe}.showColumn`,pM=`${Oe}.hideRow`,wM=`${Oe}.showRow`,wr="Filters:",Jt=`${wr}conditions`,ry=`${Jt}.none`,vM=`${Jt}.isEmpty`,yM=`${Jt}.isNotEmpty`,CM=`${Jt}.isEqualTo`,bM=`${Jt}.isNotEqualTo`,SM=`${Jt}.beginsWith`,RM=`${Jt}.endsWith`,EM=`${Jt}.contains`,TM=`${Jt}.doesNotContain`,uie=`${Jt}.byValue`,MM=`${Jt}.greaterThan`,_M=`${Jt}.greaterThanOrEqualTo`,xM=`${Jt}.lessThan`,PM=`${Jt}.lessThanOrEqualTo`,IM=`${Jt}.isBetween`,OM=`${Jt}.isNotBetween`,AM=`${Jt}.after`,HM=`${Jt}.before`,NM=`${Jt}.today`,DM=`${Jt}.tomorrow`,$M=`${Jt}.yesterday`,kM=`${wr}labels.filterByCondition`,LM=`${wr}labels.filterByValue`,FM=`${wr}labels.conjunction`,iy=`${wr}labels.disjunction`,Dw=`${wr}values.blankCells`,VM=`${wr}buttons.selectAll`,BM=`${wr}buttons.clear`,WM=`${wr}buttons.ok`,jM=`${wr}buttons.cancel`,UM=`${wr}buttons.placeholder.search`,zM=`${wr}buttons.placeholder.value`,YM=`${wr}buttons.placeholder.secondValue`,GM="CheckboxRenderer:",KM=`${GM}checked`,qM=`${GM}unchecked`,cie=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:KM,CHECKBOX_RENDERER_NAMESPACE:GM,CHECKBOX_UNCHECKED:qM,CONTEXTMENU_ITEMS_ADD_COMMENT:KT,CONTEXTMENU_ITEMS_ALIGNMENT:ZT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:oM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:eM,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:nM,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:QT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:iM,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:tM,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:rM,CONTEXTMENU_ITEMS_BORDERS:sM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:uM,CONTEXTMENU_ITEMS_BORDERS_LEFT:cM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:lM,CONTEXTMENU_ITEMS_BORDERS_TOP:aM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:LT,CONTEXTMENU_ITEMS_COPY:FT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:WT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:BT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:VT,CONTEXTMENU_ITEMS_CUT:jT,CONTEXTMENU_ITEMS_EDIT_COMMENT:qT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:UT,CONTEXTMENU_ITEMS_HIDE_COLUMN:gM,CONTEXTMENU_ITEMS_HIDE_ROW:pM,CONTEXTMENU_ITEMS_INSERT_LEFT:AT,CONTEXTMENU_ITEMS_INSERT_RIGHT:HT,CONTEXTMENU_ITEMS_MERGE_CELLS:YT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:fM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:dM,CONTEXTMENU_ITEMS_NO_ITEMS:PT,CONTEXTMENU_ITEMS_READ_ONLY:Nw,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:JT,CONTEXTMENU_ITEMS_REDO:kT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:hM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:DT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:XT,CONTEXTMENU_ITEMS_REMOVE_ROW:NT,CONTEXTMENU_ITEMS_ROW_ABOVE:IT,CONTEXTMENU_ITEMS_ROW_BELOW:OT,CONTEXTMENU_ITEMS_SHOW_COLUMN:mM,CONTEXTMENU_ITEMS_SHOW_ROW:wM,CONTEXTMENU_ITEMS_UNDO:$T,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:zT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:GT,CONTEXT_MENU_ITEMS_NAMESPACE:eL,FILTERS_BUTTONS_CANCEL:jM,FILTERS_BUTTONS_CLEAR:BM,FILTERS_BUTTONS_OK:WM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:UM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:YM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:zM,FILTERS_BUTTONS_SELECT_ALL:VM,FILTERS_CONDITIONS_AFTER:AM,FILTERS_CONDITIONS_BEFORE:HM,FILTERS_CONDITIONS_BEGINS_WITH:SM,FILTERS_CONDITIONS_BETWEEN:IM,FILTERS_CONDITIONS_BY_VALUE:uie,FILTERS_CONDITIONS_CONTAINS:EM,FILTERS_CONDITIONS_EMPTY:vM,FILTERS_CONDITIONS_ENDS_WITH:RM,FILTERS_CONDITIONS_EQUAL:CM,FILTERS_CONDITIONS_GREATER_THAN:MM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:_M,FILTERS_CONDITIONS_LESS_THAN:xM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:PM,FILTERS_CONDITIONS_NAMESPACE:Jt,FILTERS_CONDITIONS_NONE:ry,FILTERS_CONDITIONS_NOT_BETWEEN:OM,FILTERS_CONDITIONS_NOT_CONTAIN:TM,FILTERS_CONDITIONS_NOT_EMPTY:yM,FILTERS_CONDITIONS_NOT_EQUAL:bM,FILTERS_CONDITIONS_TODAY:NM,FILTERS_CONDITIONS_TOMORROW:DM,FILTERS_CONDITIONS_YESTERDAY:$M,FILTERS_DIVS_FILTER_BY_CONDITION:kM,FILTERS_DIVS_FILTER_BY_VALUE:LM,FILTERS_LABELS_CONJUNCTION:FM,FILTERS_LABELS_DISJUNCTION:iy,FILTERS_NAMESPACE:wr,FILTERS_VALUES_BLANK_CELLS:Dw},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const tL={languageCode:"en-US",[PT]:"No available options",[IT]:"Insert row above",[OT]:"Insert row below",[AT]:"Insert column left",[HT]:"Insert column right",[NT]:["Remove row","Remove rows"],[DT]:["Remove column","Remove columns"],[$T]:"Undo",[kT]:"Redo",[Nw]:"Read only",[LT]:"Clear column",[ZT]:"Alignment",[QT]:"Left",[eM]:"Center",[tM]:"Right",[nM]:"Justify",[rM]:"Top",[iM]:"Middle",[oM]:"Bottom",[UT]:"Freeze column",[zT]:"Unfreeze column",[sM]:"Borders",[aM]:"Top",[lM]:"Right",[uM]:"Bottom",[cM]:"Left",[hM]:"Remove border(s)",[KT]:"Add comment",[qT]:"Edit comment",[XT]:"Delete comment",[JT]:"Read-only comment",[YT]:"Merge cells",[GT]:"Unmerge cells",[FT]:"Copy",[VT]:["Copy with header","Copy with headers"],[BT]:["Copy with group header","Copy with group headers"],[WT]:["Copy header only","Copy headers only"],[jT]:"Cut",[dM]:"Insert child row",[fM]:"Detach from parent",[gM]:["Hide column","Hide columns"],[mM]:["Show column","Show columns"],[pM]:["Hide row","Hide rows"],[wM]:["Show row","Show rows"],[ry]:"None",[vM]:"Is empty",[yM]:"Is not empty",[CM]:"Is equal to",[bM]:"Is not equal to",[SM]:"Begins with",[RM]:"Ends with",[EM]:"Contains",[TM]:"Does not contain",[MM]:"Greater than",[_M]:"Greater than or equal to",[xM]:"Less than",[PM]:"Less than or equal to",[IM]:"Is between",[OM]:"Is not between",[AM]:"After",[HM]:"Before",[NM]:"Today",[DM]:"Tomorrow",[$M]:"Yesterday",[Dw]:"Blank cells",[kM]:"Filter by condition",[LM]:"Filter by value",[FM]:"And",[iy]:"Or",[VM]:"Select all",[BM]:"Clear",[WM]:"OK",[jM]:"Cancel",[UM]:"Search",[zM]:"Value",[YM]:"Second value",[KM]:"Checked",[qM]:"Unchecked"},hie=cie,VR=tL.languageCode,{register:die,getItem:nL,hasItem:fie,getValues:gie}=co("languagesDictionaries");rL(tL);function rL(t,e){let n=t,r=e;return ke(t)&&(r=t,n=r.languageCode),mie(n,r),die(n,nr(r)),nr(r)}function mie(t,e){t!==VR&&rie(e,nL(VR))}function iL(t){return XM(t)?nr(nL(t)):null}function XM(t){return fie(t)}function pie(){return gie()}function oL(t,e,n){const r=iL(t);if(r===null)return null;const i=r[e];if(Lt(i))return null;const o=wie(i,n);return Array.isArray(o)?o[0]:o}function wie(t,e){let n=t;return x(lie(),r=>{n=r(t,e)}),n}function vie(t){let e=Zk(t);return XM(e)||(e=VR,Qk(t)),e}function yie(t,e,n){return(e=Cie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cie(t){var e=bie(t,"string");return typeof e=="symbol"?e:e+""}function bie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ea extends Nk{constructor(e,n){super(e,null),yie(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function KC(t){let{activeHeaderClassName:e,...n}=t;return new ea({className:e,...n,selectionType:Dk})}function Sie(t){let{areaCornerVisible:e,...n}=t;return new ea({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:hT})}function Rie(t){let{...e}=t;return new ea({className:"highlight",...e,selectionType:hT})}function Eie(t){let{columnClassName:e,...n}=t;return new ea({className:e,...n,selectionType:Rne})}function Tie(t){let{cellCornerVisible:e,...n}=t;return new ea({className:"current",headerAttributes:[HE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Qd})}function Mie(t){let{border:e,visualCellRange:n,...r}=t;return new ea({...e,...r,selectionType:Ene},n)}function _ie(t){let{...e}=t;return new ea({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:bne})}function sO(t){let{headerClassName:e,...n}=t;return new ea({className:e,...n,selectionType:cT})}function xie(t){let{rowClassName:e,...n}=t;return new ea({className:e,...n,selectionType:Sne})}function Pie(t,e){Iie(t,e),e.add(t)}function Iie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function br(t,e,n){return(e=Oie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oie(t){var e=Aie(t,"string");return typeof e=="symbol"?e:e+""}function Aie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vo=new WeakSet;class Hie{constructor(e){Pie(this,vo),br(this,"options",void 0),br(this,"layerLevel",0),br(this,"focus",void 0),br(this,"fill",void 0),br(this,"layeredAreas",new Map),br(this,"areas",new Map),br(this,"rowHeaders",new Map),br(this,"columnHeaders",new Map),br(this,"activeRowHeaders",new Map),br(this,"activeColumnHeaders",new Map),br(this,"activeCornerHeaders",new Map),br(this,"rowHighlights",new Map),br(this,"columnHighlights",new Map),br(this,"customSelections",[]),this.options=e,this.focus=Tie(e),this.fill=_ie(e)}isEnabledFor(e,n){let r=e;e===Qd&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return gs(vo,this,ms).call(this,this.layeredAreas,Sie)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return gs(vo,this,ms).call(this,this.areas,Rie)}getAreas(){return[...this.areas.values()]}createRowHeader(){return gs(vo,this,ms).call(this,this.rowHeaders,sO)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return gs(vo,this,ms).call(this,this.columnHeaders,sO)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return gs(vo,this,ms).call(this,this.activeRowHeaders,KC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return gs(vo,this,ms).call(this,this.activeColumnHeaders,KC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return gs(vo,this,ms).call(this,this.activeCornerHeaders,KC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return gs(vo,this,ms).call(this,this.rowHighlights,xie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return gs(vo,this,ms).call(this,this.columnHighlights,Eie)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Mie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),x(this.areas.values(),e=>void e.clear()),x(this.layeredAreas.values(),e=>void e.clear()),x(this.rowHeaders.values(),e=>void e.clear()),x(this.columnHeaders.values(),e=>void e.clear()),x(this.activeRowHeaders.values(),e=>void e.clear()),x(this.activeColumnHeaders.values(),e=>void e.clear()),x(this.activeCornerHeaders.values(),e=>void e.clear()),x(this.rowHighlights.values(),e=>void e.clear()),x(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ms(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function aO(t,e,n){return(e=Nie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nie(t){var e=Die(t,"string");return typeof e=="symbol"?e:e+""}function Die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ie{constructor(e){aO(this,"ranges",[]),aO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function kie(t,e){sL(t,e),e.add(t)}function qC(t,e,n){sL(t,e),e.set(t,n)}function sL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tt(t,e){return t.get(yn(t,e))}function vm(t,e,n){return t.set(yn(t,e),n),n}function yn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ym=new WeakMap,_t=new WeakMap,ro=new WeakMap,_n=new WeakSet;class BR{constructor(e,n){kie(this,_n),qC(this,ym,void 0),qC(this,_t,void 0),qC(this,ro,{x:0,y:0}),vm(ym,this,e),vm(_t,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=tt(_t,this).createCellCoords(e,n);let o=tt(ym,this).current().highlight;const s=tt(_t,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=yn(_n,this,aL).call(this),{row:h,col:d}=yn(_n,this,uO).call(this,o),f=tt(_t,this).fixedRowsBottom(),g=tt(_t,this).minSpareRows(),p=tt(_t,this).minSpareCols(),C=tt(_t,this).autoWrapRow(),E=tt(_t,this).autoWrapCol(),y=tt(_t,this).createCellCoords(h+i.row,d+i.col);if(y.row>=c){const I=$r(r&&g>0&&f===0),_=y.col+1,P=tt(_t,this).createCellCoords(y.row-c,_>=u?_-u:_);this.runLocalHooks("beforeColumnWrap",I,yn(_n,this,Gu).call(this,P),_>=u),I.value?this.runLocalHooks("insertRowRequire",tt(_t,this).countRenderableRows()):E&&y.assign(P)}else if(y.row<0){const I=$r(E),_=y.col-1,P=tt(_t,this).createCellCoords(c+y.row,_<0?u+_:_);this.runLocalHooks("beforeColumnWrap",I,yn(_n,this,Gu).call(this,P),_<0),E&&y.assign(P)}if(y.col>=u){const I=$r(r&&p>0),_=y.row+1,P=tt(_t,this).createCellCoords(_>=c?_-c:_,y.col-u);this.runLocalHooks("beforeRowWrap",I,yn(_n,this,Gu).call(this,P),_>=c),I.value?this.runLocalHooks("insertColRequire",tt(_t,this).countRenderableColumns()):C&&y.assign(P)}else if(y.col<0){const I=$r(C),_=y.row-1,P=tt(_t,this).createCellCoords(_<0?c+_:_,u+y.col);this.runLocalHooks("beforeRowWrap",I,yn(_n,this,Gu).call(this,P),_<0),C&&y.assign(P)}const{rowDir:T,colDir:M}=yn(_n,this,lO).call(this,y);a=T,l=M,o=yn(_n,this,Gu).call(this,y)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=tt(_t,this).createCellCoords(e,n),i=tt(ym,this).current(),o=tt(_t,this).visualToRenderableCoords(i.highlight),s=yn(_n,this,XC).call(this,i.to.row,i.from.row),a=yn(_n,this,JC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=yn(_n,this,uO).call(this,i.highlight),f=tt(_t,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),p=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const M=f.col-d;f.col=yn(_n,this,JC).call(this,g.col,p.col)+M}else if(r.col>0&&a<=d&&f.col>d){const M=yn(_n,this,JC).call(this,p.col,g.col),I=Math.max(f.col-M,1);f.col=M+I}if(r.row<0&&s>=h&&f.row<h){const M=f.row-h;f.row=yn(_n,this,XC).call(this,g.row,C.row)+M}else if(r.row>0&&s<=h&&f.row>h){const M=yn(_n,this,XC).call(this,C.row,g.row),I=Math.max(f.row-M,1);f.row=M+I}const{rowDir:E,colDir:y}=yn(_n,this,lO).call(this,f);u=E,c=y;const T=yn(_n,this,Gu).call(this,f);r.row===0&&r.col!==0?l.col=T.col:r.row!==0&&r.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;vm(ro,this,{x:n,y:r})}resetOffsetSize(){vm(ro,this,{x:0,y:0})}}function lO(t){const{width:e,height:n}=yn(_n,this,aL).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function aL(){return{width:tt(ro,this).x+tt(_t,this).countRenderableColumns(),height:tt(ro,this).y+tt(_t,this).countRenderableRows()}}function XC(t,e){const n=tt(_t,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:tt(ro,this).y+n}function JC(t,e){const n=tt(_t,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:tt(ro,this).x+n}function uO(t){const{row:e,col:n}=tt(_t,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return tt(_t,this).createCellCoords(tt(ro,this).y+e,tt(ro,this).x+n)}function Gu(t){const e=t.clone();return e.col=t.col-tt(ro,this).x,e.row=t.row-tt(ro,this).y,tt(_t,this).renderableToVisualCoords(e)}vt(BR,Wn);const oy=0,sy=1,lL=2,JM=3,Lie=[JM,lL],Fie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],ZC=Symbol("root"),cO=Symbol("child");function rh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ZC;if(e!==ZC&&e!==cO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===ZC;let i=oy;if(n){const o=t[0];t.length===0?i=sy:r&&o instanceof bg?i=JM:r&&Array.isArray(o)?i=rh(o,cO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Fie[l].includes(typeof a))&&(i=lL)}return i}function Ff(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Lie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===JM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Lt(u)&&(u=a),Lt(c)&&(c=l),!r){const f=a,g=l,p=u,C=c;a=Math.min(f,p),l=Math.min(g,C),u=Math.max(f,p),c=Math.max(g,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Vie(t){const e=rh(t.getSelected());if(e===oy||e===sy)return[];const n=Ff(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;x(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;x(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Tn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Bie(t){const e=rh(t.getSelected());if(e===oy||e===sy)return[];const n=Ff(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;x(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;x(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Tn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Ku(t,e,n){Wie(t,e),e.set(t,n)}function Wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hl(t,e,n){return(e=jie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jie(t){var e=Uie(t,"string");return typeof e=="symbol"?e:e+""}function Uie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dt(t,e){return t.get(uL(t,e))}function yo(t,e,n){return t.set(uL(t,e),n),n}function uL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Un=new WeakMap,dl=new WeakMap,Cm=new WeakMap,td=new WeakMap,bm=new WeakMap,nd=new WeakMap;class cL{constructor(e,n){var r=this;hl(this,"settings",void 0),hl(this,"tableProps",void 0),hl(this,"inProgress",!1),hl(this,"selectedRange",new $ie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),hl(this,"highlight",void 0),Ku(this,Un,void 0),Ku(this,dl,void 0),hl(this,"selectedByRowHeader",new Set),hl(this,"selectedByColumnHeader",new Set),Ku(this,Cm,!1),Ku(this,td,!1),Ku(this,bm,"unknown"),Ku(this,nd,-1),this.settings=e,this.tableProps=n,this.highlight=new Hie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[HE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),yo(Un,this,new BR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),yo(dl,this,new BR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Dt(Un,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Dt(Un,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Dt(Un,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Dt(Un,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Dt(Un,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Dt(Un,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Dt(Un,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Dt(Un,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Dt(dl,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Dt(dl,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){yo(bm,this,e)}markEndSource(){yo(bm,this,"unknown")}getSelectionSource(){return Dt(bm,this)}setExpectedLayers(e){yo(nd,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,yo(nd,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Lt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();yo(Cm,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Lt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Dt(nd,this)===-1||this.selectedRange.size()===Dt(nd,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(x(this.highlight.getAreas(),g=>void g.clear()),x(this.highlight.getLayeredAreas(),g=>void g.clear()),x(this.highlight.getRowHeaders(),g=>void g.clear()),x(this.highlight.getColumnHeaders(),g=>void g.clear()),x(this.highlight.getActiveRowHeaders(),g=>void g.clear()),x(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),x(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),x(this.highlight.getRowHighlights(),g=>void g.clear()),x(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(hT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(cT,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),y=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(y).commit(),d.add(C).commit(),f.add(y).commit()):(a.add(C).add(E).commit(),l.add(y).add(T).commit(),d.add(C).add(E).commit(),f.add(y).add(T).commit())}const g=!Dt(td,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),p=!Dt(td,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&p&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Qd,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(yo(Cm,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Dt(Un,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Dt(Un,this).resetOffsetSize(),this.setRangeStart(Dt(Un,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?Dt(Un,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Dt(Un,this).resetOffsetSize(),this.setRangeEnd(Dt(Un,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?Dt(dl,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Dt(dl,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Dt(dl,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Xe(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Xe(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Xe(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Xe(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Xe(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Xe(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=$r(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Dt(Cm,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;yo(td,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Xe(d.row,u,o-1),Xe(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),p=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.finish(),yo(td,this,!1)}selectCells(e){var n=this;const r=rh(e);if(r===sy)return!1;if(r===oy)throw new Error(gt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Ff(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),x(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Xe(r.row,u,s-1),g=Xe(r.col,Math.min(i,o),Math.max(i,o))):(f=Xe(r,u,s-1),g=i);const p=this.tableProps.createCellCoords(f,g),C=l===0?0:Xe(p.row,u,-1),E=s-1,y=this.tableProps.createCellCoords(C,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",y,T,p),y.row=C,T.row=E,this.setRangeStartOnly(y,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",y,T,p),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Xe(r.row,Math.min(e,n),Math.max(e,n)),d=Xe(r.col,a,o-1)):(h=e,d=Xe(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Xe(f.col,a,-1),p=o-1,C=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,p);this.runLocalHooks("beforeSelectRows",C,E,f),C.col=g,E.col=p,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",C,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Xe(s.row,-1/0,e-1),col:Xe(s.col,-1/0,n-1)}),i.assign({row:Xe(i.row,-1/0,e-1),col:Xe(i.col,-1/0,n-1)}),o.assign({row:Xe(o.row,0,e-1),col:Xe(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(Qd,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Qd,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}vt(cL,Wn);const hO=/^(\r\n|\n\r|\r|\n)/,zie=/^[^\t\r\n]+/,dO=/^\t/;function Yie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(dO))t=t.replace(dO,""),n+=1,e[r][n]="";else if(t.match(hO))t=t.replace(hO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(zie);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function tf(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function fl(t,e,n){return(e=Gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=Kie(t,"string");return typeof e=="symbol"?e:e+""}function Kie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){fl(this,"hot",void 0),fl(this,"metaManager",void 0),fl(this,"tableMeta",void 0),fl(this,"dataSource",void 0),fl(this,"duckSchema",void 0),fl(this,"colToPropCache",void 0),fl(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Kv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(ke(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return ST(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Le(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?th(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=nr(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},yg(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const p=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(p,n));const C=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",C,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:p}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];vR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return C$(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];vR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&cn(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=$r(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=$r(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&cn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Hc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Hc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return tf(this.getRange(e,n,Hc.DESTINATION_RENDERER))}getCopyableText(e,n){return tf(this.getRange(e,n,Hc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:qie,getItem:Xie,hasItem:hL,getNames:Jie,getValues:F0e}=co("cellTypes");function ZM(t){if(!hL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Xie(t)}function di(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Pr(t,n),r&&zr(t,r),i&&Xl(t,i),qie(t,e)}function Zie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!cn(e,t)}function ay(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?ZM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Le(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!ke(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Le(r,(o,s)=>{if(Zie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),fn(t,i)}function Qie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}J$(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function jp(t){return Number.isInteger(t)&&t>=0}function Up(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Sm(t){return t==null}const dL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Xt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Xt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Gv(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function fO(t,e,n){return(e=eoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eoe(t){var e=toe(t,"string");return typeof e=="symbol"?e:e+""}function toe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function noe(){return class{}}class roe{constructor(e){fO(this,"metaCtor",noe()),fO(this,"meta",void 0),this.meta=this.metaCtor.prototype,fn(this.meta,dL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;fn(this.meta,e),ay(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function ioe(t,e,n){return(e=ooe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ooe(t){var e=soe(t,"string");return typeof e=="symbol"?e:e+""}function soe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aoe{constructor(e){ioe(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){fn(this.meta,e),ay(this.meta,e,e)}}function Rm(t,e,n){return(e=loe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function loe(t){var e=uoe(t,"string");return typeof e=="symbol"?e:e+""}function uoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $w{constructor(e){Rm(this,"valueFactory",void 0),Rm(this,"data",[]),Rm(this,"index",[]),Rm(this,"holes",new Set),this.valueFactory=e}obtain(e){Up(()=>jp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Up(()=>jp(e)||Sm(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Sm(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Up(()=>jp(e)||Sm(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Sm(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function gO(t,e,n){return(e=coe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function coe(t){var e=hoe(t,"string");return typeof e=="symbol"?e:e+""}function hoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const doe=["data","width"];class foe{constructor(e){gO(this,"globalMeta",void 0),gO(this,"metas",new $w(()=>this._createMeta())),this.globalMeta=e,this.metas=new $w(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);fn(r,n),ay(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Qie(this.globalMeta.getMetaConstructor(),doe).prototype}}function mO(t,e,n){return(e=goe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function goe(t){var e=moe(t,"string");return typeof e=="symbol"?e:e+""}function moe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class poe{constructor(e){mO(this,"columnMeta",void 0),mO(this,"metas",new $w(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);fn(i,r),ay(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Up(()=>jp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new $w(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class fL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new roe(e),this.tableMeta=new aoe(this.globalMeta),this.columnMeta=new foe(this.globalMeta),this.cellMeta=new poe(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}vt(fL,Wn);function pO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=tr(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":dt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Hc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let p,C=0,E=0;for(C=0,E=d.startRows;C<E;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)p=nr(g),t.push(p);else if(i.dataType==="array")p=nr(g[0]),t.push(p);else{p=[];for(let y=0,T=d.startCols;y<T;y++)p.push(null);t.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ce(i.rootElement,[P$(-1),Wv(i.countCols()+(i.view?i.countRowHeaders():0))])}function wO(t,e,n){return(e=woe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function woe(t){var e=voe(t,"string");return typeof e=="symbol"?e:e+""}function voe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yoe{constructor(e){var n=this;wO(this,"metaManager",void 0),wO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ie.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=cn(e,"type")?e.type:null;let c=dt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Coe(t,e,n){boe(t,e),e.set(t,n)}function boe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QC(t,e,n){return(e=Soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Soe(t){var e=Roe(t,"string");return typeof e=="symbol"?e:e+""}function Roe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eoe(t,e){return t.get(Toe(t,e))}function Toe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vO=new WeakMap;class Moe{constructor(e){QC(this,"metaManager",void 0),QC(this,"usageTracker",new Set),QC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Coe(this,vO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,Eoe(vO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const gL="gridDefault",el="editorManager.handlingEditor",_oe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},xoe="hooksRefRegisterer",mL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){x(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Le(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};os(mL,"MIXIN_NAME",xoe,{writable:!1,enumerable:!1});function Li(t,e,n){return(e=Poe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Poe(t){var e=Ioe(t,"string");return typeof e=="symbol"?e:e+""}function Ioe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ooe="base",tn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Sh{static get EDITOR_TYPE(){return Ooe}constructor(e){Li(this,"hot",void 0),Li(this,"state",tn.VIRGIN),Li(this,"_opened",!1),Li(this,"_fullEditMode",!1),Li(this,"_closeCallback",null),Li(this,"TD",null),Li(this,"row",null),Li(this,"col",null),Li(this,"prop",null),Li(this,"originalValue",null),Li(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:tn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==tn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=tn.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:It(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===tn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===tn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=tn.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=tn.FINISHED,this.discardEditor(s)}):(this.state=tn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=tn.FINISHED,this.discardEditor()}discardEditor(e){this.state===tn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=tn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=tn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===tn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Bn(n),a=rn(n),l=Bn(this.hot.rootElement),u=rn(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:p}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=p.name,E=["master","inline_start"].includes(C)?d:0,y=["master","top","bottom"].includes(C)?f:0,T=s.top===l.top?0:1;let M=s.top-l.top-T-E,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-g-1+y:I=s.left-l.left-1-y,["top","top_inline_start_corner"].includes(C)&&(M+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const _=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),B=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(_&&P<=0||P===B)&&(M+=1),Y<=0&&(I+=1);const Z=i.rowsRenderCalculator.startPosition,X=i.columnsRenderCalculator.startPosition,Q=Math.abs(r.inlineStartOverlay.getScrollPosition()),se=r.topOverlay.getScrollPosition(),be=In(this.hot.rootDocument);let bt=n.offsetTop;if(["inline_start","master"].includes(C)&&(bt+=Z-se),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:K,wtTable:J}=r.bottomOverlay.clone;bt+=K.getWorkspaceHeight()-J.getHeight()-be}let Ee=n.offsetLeft;this.hot.isRtl()?(Ee>=0?Ee=p.getWidth()-n.offsetLeft:Ee=Math.abs(Ee),Ee+=X-Q-a):["top","master","bottom"].includes(C)&&(Ee+=X-Q);const Ne=o.getComputedStyle(this.TD),lt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",On=parseInt(Ne[lt],10)>0?0:1,ut=parseInt(Ne.borderTopWidth,10)>0?0:1,m=rn(n)+On,v=dn(n)+ut,w=FE(c)?be:0,A=VE(h)?be:0,L=this.hot.view.maximumVisibleElementWidth(Ee)-w+On,U=Math.max(this.hot.view.maximumVisibleElementHeight(bt)-A+ut,this.hot.view.getDefaultRowHeight());return{top:M,start:I,height:v,maxHeight:U,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}vt(Sh,mL);const Aoe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===tn.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},Hoe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},Noe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Doe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},$oe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Ai(e))}};function koe(){return[_oe,Aoe,Hoe,Noe,Doe,$oe]}const Loe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},Foe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},Voe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},Boe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},Woe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},joe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Uoe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},zoe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Yoe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Goe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Koe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},qoe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},Xoe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},Joe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Zoe(){return[Loe,Foe,Voe,Boe,Woe,joe,Uoe,zoe,Yoe,Goe,Koe,qoe,Xoe,Joe]}const Qoe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},ese={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},tse={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},nse={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},rse={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},ise={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},ose={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},sse={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},ase={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},lse={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},use={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},cse={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},hse={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},dse={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},fse={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},gse={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function mse(){return[Qoe,ese,tse,nse,rse,ise,ose,sse,ase,lse,use,cse,hse,dse,fse,gse]}const pse={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},wse={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},vse={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},yse={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Cse={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},bse=[...koe(),...Zoe(),...mse(),pse,wse,vse,yse,Cse];function pL(t){const e={};return bse.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Sse(t){const e=t.getShortcutManager().addContext("editor"),n=pL(t),r={group:el};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function Rse(t){const e=t.getShortcutManager().addContext("grid"),n=pL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:gL};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:el,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function Ese(t){[Rse,Sse].forEach(e=>e(t))}function Tse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=yO(t),i=yO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function yO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ce(n,[Of("Focus catcher")]),n}function Mse(t){const e=_se(t);let n;const{activate:r,deactivate:i}=Tse(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:WR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:jR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,p)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,p.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:gL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?WR(t):jR(t)),u(),!1;h.preventDefault()},position:"after"}])}function WR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function jR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function _se(t){return e=>{if(!e)return null;const n=WR(t),r=jR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Rh(t){qo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function ly(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,p=f<=h,C=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:p&&C?r.highlight.row:p?f:C?g:E.row}}}function xse(t){return e=>{const n=ly(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Rh(t.getCell(r?-1:0,n,!0))})}}function Pse(){return()=>{}}function Ise(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Rh(t.getCell(n,r,!0))})}}function Ose(t){return e=>{const n=ly(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Rh(t.getCell(i,o,!0))})}}function Ase(t){return e=>{const n=ly(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Rh(t.getCell(i,o,!0))})}}function Hse(t){return e=>{const n=ly(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Rh(t.getCell(n,r?-1:0,!0))})}}function Nse(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Rh(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function Dse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=Ise(t):e.isSelectedByCorner()?s=Pse():e.isSelectedByRowHeader()?s=Hse(t):e.isSelectedByColumnHeader()?s=xse(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=Ose(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=Nse(t):e.getSelectedRange().size()>1&&(s=Ase(t)),(o=s)===null||o===void 0||o(i)}}}const CO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Em=t=>t.map(e=>{const n=e.toLowerCase();return CO.has(n)?CO.get(n):n}).sort().join("+"),$se=t=>t.split("+"),bO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),eb=t=>{let{which:e,key:n}=t;if(bO.has(e))return bO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},wL=Symbol("shortcut-context");function vL(t){return ke(t)&&t.__kindOf===wL}const kse=t=>{const e=Jv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:p,position:C,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Lt(c))throw new Error("You need to define the shortcut's group.");if(dt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(gt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const y={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(p)&&(y.relativeToGroup=p,y.position=C),vL(E)&&(y.forwardToContext=E),l.forEach(T=>{const M=Em(T);if(e.hasItem(M)){const _=e.getItem(M);let P=_.findIndex(Y=>Y.group===p);P!==-1?C==="before"?P-=1:P+=1:P=_.length,_.splice(P,0,y)}else e.addItem(M,[y])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Le(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Em(l);e.removeItem(u)};return{__kindOf:wL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Em(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=Em(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i($se(h)):(d.length=0,d.push(...f))})}}};function Lse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Fse=["meta","alt","shift","control"],rd=Lse(),id=[];let Tm=0;function Vse(t,e,n,r,i){const o=f=>Fse.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),g&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Ma(f))return;const p=eb(f);let C=[];o(p)||(C=s(f));const E=[p].concat(C);!i(f,E)&&(Iw()&&C.includes("meta")||!Iw()&&C.includes("control"))&&i(f,[p].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=eb(f);o(g)&&rd.press(g)}},u=f=>{if(typeof f.key=="string"){const g=eb(f);o(g)&&rd.release(g)}},c=()=>{rd.releaseAll()};return{mount:()=>{let f=t;for(Tm+=1;f;)Tm===1&&(f.document.documentElement.addEventListener("keydown",l),id.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),id.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=du(f)},unmount:()=>{let f=t;for(Tm-=1;f;){if(Tm===0){for(let g=0;g<id.length;g++){const{event:p,listener:C}=id[g];f.document.documentElement.removeEventListener(p,C)}id.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=du(f)}},isPressed:f=>rd.isPressed(f),releasePressedKeys:()=>rd.releaseAll()}}const Bse=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Jv({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const p=kse(g);return o.addItem(g,p),p},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(gt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,p){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=vL(C)?C:u(C);let y=!1;if(!E.hasShortcut(p))return y;const T=E.getShortcuts(p);for(let M=0;M<T.length;M++){const{callback:I,runOnlyIf:_,preventDefault:P,stopPropagation:Y,captureCtrl:V,forwardToContext:B}=T[M];if(_(g)===!0){if(h=V,y=I(g,p)===!1,h=!1,P&&g.preventDefault(),Y&&(Ai(g),g.stopPropagation()),y)break;B&&d(g,p,B)}}return y},f=Vse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function SO(t){const{classNames:e}=N$(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let tb=null;const nb=new Map;function yL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Mi(o);let a,l,u,c,h,d,f=!0;sre(i)&&ore(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",p=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=vie(e.language);const C=Object.fromEntries(Object.entries(e).filter(m=>{let[v]=m;return!(ie.getSingleton().isRegistered(v)||ie.getSingleton().isDeprecated(v))})),E=new fL(o,C,[yoe,Moe]),y=E.getTableMeta(),T=E.getGlobalMeta(),M=Jv();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),Wp(this)&&(T$(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${PE()}`,nb.set(this.guid,this),this.columnIndexMapper=new FR,this.rowIndexMapper=new FR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new xre(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const I=m=>{const{row:v,col:w}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getRenderableFromVisualIndex(v):v,w>=0?o.columnIndexMapper.getRenderableFromVisualIndex(w):w)},_=m=>{const{row:v,col:w}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getVisualFromRenderableIndex(v):v,w>=0?o.columnIndexMapper.getVisualFromRenderableIndex(w):w)},P=(m,v)=>{const w=v>m?1:-1,A=Math.min(m,v),L=Math.max(m,v),U=o.rowIndexMapper.getNearestNotHiddenIndex(m,w);return U===null||w===1&&U>L||w===-1&&U<A?null:U>=0?o.rowIndexMapper.getRenderableFromVisualIndex(U):U},Y=(m,v)=>{const w=v>m?1:-1,A=Math.min(m,v),L=Math.max(m,v),U=o.columnIndexMapper.getNearestNotHiddenIndex(m,w);return U===null||w===1&&U>L||w===-1&&U<A?null:U>=0?o.columnIndexMapper.getRenderableFromVisualIndex(U):U};let V=new cL(y,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,v)=>o._createCellCoords(m,v),createCellRange:(m,v,w)=>o._createCellRange(m,v,w),visualToRenderableCoords:I,renderableToVisualCoords:_,findFirstNonHiddenRenderableRow:P,findFirstNonHiddenRenderableColumn:Y,isDisabledCellSelection:(m,v)=>m<0||v<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,v).disableVisualSelection});this.selection=V;const B=m=>{let{hiddenIndexesChanged:v}=m;this.forceFullRender=!0,v&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",B),this.rowIndexMapper.addLocalHook("cacheUpdated",B),this.selection.addLocalHook("afterSetRangeEnd",(m,v)=>{const w=$r(!1),A=this.selection.getSelectedRange(),{from:L,to:U}=A.current(),K=A.size()-1;this.runHooks("afterSelection",L.row,L.col,U.row,U.col,w,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),U.row,o.colToProp(U.col),w,K),v&&(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m);const J=V.isSelectedByRowHeader(),b=V.isSelectedByColumnHeader();J&&b?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(pe(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):b?(pe(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),V.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const v=$r(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,v),(!v.isTouched()||v.isTouched()&&!v.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const v=m.length-1,{from:w,to:A}=m[v];this.runHooks("afterSelectionEnd",w.row,w.col,A.row,A.col,v),this.runHooks("afterSelectionEndByProp",w.row,o.colToProp(w.col),A.row,o.colToProp(A.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const v=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=v)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...v)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...v)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...v)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSelectColumns",...v)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterSelectColumns",...v)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSelectRows",...v)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterSelectRows",...v)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformStart",...v)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...v)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformFocus",...v)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformFocus",...v)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformEnd",...v)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...v)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeRowWrap",...v)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeColumnWrap",...v)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const U=K=>{if(K.length===0)return[];const J=[...K];return J.sort((R,S)=>{let[k]=R,[O]=S;return k===O?0:k>O?1:-1}),Tn(J,(R,S)=>{let[k,O]=S;const N=R[R.length-1],[j,H]=N,D=j+H;if(k<=D){const W=Math.max(O-(D-k),0);N[1]+=W}else R.push([k,O]);return R},[J[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(y.maxRows===K)return;const J=m==="insert_row_below"?"below":"above";v=v??(J==="below"?K:0);const{delta:b,startPhysicalIndex:R}=a.createRow(v,w,{source:A,mode:J});V.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";v=v??(S==="end"?o.countSourceCols():0);const{delta:k,startPhysicalIndex:O}=a.createCol(v,w,{source:A,mode:S});if(k){if(Array.isArray(y.colHeaders)){const H=[o.toVisualColumn(O),0];H.length+=k,Array.prototype.splice.apply(y.colHeaders,H)}V.shiftColumns(o.toVisualColumn(O),k)}break;case"remove_row":const N=H=>{let D=0;x(H,W=>{let[F,G]=W;const ae=Xt(F)?o.countRows()-1:Math.max(F-D,0);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeRow(F,G,A))return;if(V.isSelected()){const{row:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+G-1&&c.closeEditor(!0)}const _e=o.countRows(),Be=y.fixedRowsTop;Be>=ae+1&&(y.fixedRowsTop-=Math.min(G,Be-ae));const qe=y.fixedRowsBottom;qe&&ae>=_e-qe&&(y.fixedRowsBottom-=Math.min(G,qe)),_e===0?V.deselect():A==="ContextMenu.removeRow"?V.refresh():V.shiftRows(F,-G),D+=G})};Array.isArray(v)?N(U(v)):N([[v,w]]);break;case"remove_col":const j=H=>{let D=0;x(H,W=>{let[F,G]=W;const ae=Xt(F)?o.countCols()-1:Math.max(F-D,0);let ce=o.toPhysicalColumn(ae);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeCol(F,G,A))return;if(V.isSelected()){const{col:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+G-1&&c.closeEditor(!0)}o.countCols()===0?V.deselect():A==="ContextMenu.removeColumn"?V.refresh():V.shiftColumns(F,-G);const qe=y.fixedColumnsStart;qe>=ae+1&&(y.fixedColumnsStart-=Math.min(G,qe-ae)),Array.isArray(y.colHeaders)&&(typeof ce>"u"&&(ce=-1),y.colHeaders.splice(ce,G)),D+=G})};Array.isArray(v)?j(U(v)):j([[v,w]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=y.minRows,v=y.minSpareRows,w=y.minCols,A=y.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(v){const L=o.countEmptyRows(!0);if(L<v){const U=v-L,K=Math.min(U,y.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(w||A)&&(L=o.countEmptyCols(!0));let U=o.countCols();if(w&&!y.columns&&U<w){const K=w-U;L+=K,a.createCol(U,K,{source:"auto"})}if(A&&!y.columns&&o.dataType==="array"&&L<A){U=o.countCols();const K=A-L,J=Math.min(K,y.maxCols-U);a.createCol(U,J,{source:"auto"})}}},populateFromArray(m,v,w,A,L){let U,K,J,b;const R=[],S={},k=[],O=m.row,N=m.col;if(K=v.length,K===0)return!1;let j=0,H=0;switch(ke(w)&&(j=w.col-N+1,H=w.row-O+1),L){case"shift_down":const D=Kd(v),W=D.length,F=Math.max(W,j),G=o.getData().slice(O),ae=Kd(G).slice(N,N+F);for(J=0;J<F;J+=1)if(J<W){for(U=0,K=D[J].length;U<H-K;U+=1)D[J].push(D[J][U%K]);J<ae.length?k.push(D[J].concat(ae[J])):k.push(D[J].concat(new Array(G.length).fill(null)))}else k.push(D[J%W].concat(ae[J]));o.populateFromArray(O,N,Kd(k));break;case"shift_right":const ce=v.length,_e=Math.max(ce,H),Be=o.getData().slice(O).map(Ht=>Ht.slice(N));for(U=0;U<_e;U+=1)if(U<ce){for(J=0,b=v[U].length;J<j-b;J+=1)v[U].push(v[U][J%b]);if(U<Be.length)for(let Ht=0;Ht<Be[U].length;Ht+=1)v[U].push(Be[U][Ht]);else v[U].push(...new Array(Be[0].length).fill(null))}else v.push(v[U%K].slice(0,_e).concat(Be[U]));o.populateFromArray(O,N,v);break;case"overwrite":default:S.row=m.row,S.col=m.col;let qe=0,Me=0,Ue=!0,At;const Ni=function(wn){let Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Nt=v[wn%v.length];return Tt!==null?Nt[Tt%Nt.length]:Nt},as=v.length,ii=w?w.row-m.row+1:0;for(w?K=ii:K=Math.max(as,ii),U=0;U<K&&!(w&&S.row>w.row&&ii>as||!y.allowInsertRow&&S.row>o.countRows()-1||S.row>=y.maxRows);U++){const Ht=U-qe,wn=Ni(Ht).length,Tt=w?w.col-m.col+1:0;if(w?b=Tt:b=Math.max(wn,Tt),S.col=m.col,At=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&At.skipRowOnPaste){qe+=1,S.row+=1,K+=1;continue}for(Me=0,J=0;J<b&&!(w&&S.col>w.col&&Tt>wn||!y.allowInsertColumn&&S.col>o.countCols()-1||S.col>=y.maxCols);J++){if(At=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&At.skipColumnOnPaste){Me+=1,S.col+=1,b+=1;continue}if(At.readOnly&&A!=="UndoRedo.undo"){S.col+=1;continue}const Nt=J-Me;let ze=Ni(Ht,Nt),oi=o.getDataAtCell(S.row,S.col);if(ze!==null&&typeof ze=="object")if(Array.isArray(ze)&&oi===null&&(oi=[]),oi===null||typeof oi!="object")Ue=!1;else{const tl=th(Array.isArray(oi)?oi:oi[0]||oi),nl=th(Array.isArray(ze)?ze:ze[0]||ze);Gv(tl,nl)||Array.isArray(tl)&&Array.isArray(nl)?ze=nr(ze):Ue=!1}else oi!==null&&typeof oi=="object"&&(Ue=!1);Ue&&R.push([S.row,S.col,ze]),Ue=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,A||"populateFromArray");break}}};function Z(m){const v=Zk(m);XM(v)?(o.runHooks("beforeLanguageChange",v),T.language=v,o.runHooks("afterLanguageChange",v)):Qk(m)}function X(m,v){const w=m==="className"?o.rootElement:o.table;if(f)q(w,v);else{let A=[],L=[];T[m]&&(A=Array.isArray(T[m])?T[m]:CR(T[m])),v&&(L=Array.isArray(v)?v:CR(v));const U=yR(A,L),K=yR(L,A);U.length&&pe(w,U),K.length&&q(w,K)}T[m]=v}this.init=function(){l.setData(y.data),o.runHooks("beforeInit"),(Go()||KE())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new cre(this);const m=y.themeName||SO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=PR.getInstance(o,y,V),d=Dse(o),h=new HZ(o),Wp(this)&&Mse(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&j$(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function Q(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function se(m){const v=m.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):m}function be(m,v,w){if(!m.length){w();return}const A=o.getActiveEditor(),L=new Q;let U=!0;L.onQueueEmpty=()=>{A&&U&&A.cancelChanges(),w()};for(let K=m.length-1;K>=0;K--){const[J,b]=m[K],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(J,R):S={...Object.getPrototypeOf(y),...y},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function(k,O){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&O.allowInvalid===!1&&(U=!1,m.splice(k,1),O.valid=!0),L.removeValidatorFormQueue()}}(K,S),v))}L.checkIfQueueIsEmpty()}function bt(m,v){for(let A=m.length-1;A>=0;A--){let L=!1;if(m[A]===null){m.splice(A,1);continue}if(!((m[A][2]===null||m[A][2]===void 0)&&(m[A][3]===null||m[A][3]===void 0))){if(y.allowInsertRow)for(;m[A][0]>o.countRows()-1;){const{delta:U}=a.createRow(void 0,void 0,{source:"auto"});if(U===0){L=!0;break}}if(o.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(m[A][1])>o.countCols()-1;){const{delta:U}=a.createCol(void 0,void 0,{source:"auto"});if(U===0){L=!0;break}}L||a.set(m[A][0],m[A][1],m[A][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,v),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,v||"edit");const A=o.getActiveEditor();A&&le(A.refreshValue)&&A.refreshValue()}else o.render()}this._createCellCoords=function(m,v){return o.view._wt.createCellCoords(m,v)},this._createCellRange=function(m,v,w){return o.view._wt.createCellRange(m,v,w)},this.validateCell=function(m,v,w,A){let L=o.getCellValidator(v);function U(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||v.hidden===!0){w(K);return}const b=v.visualCol,R=v.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const k=o.rowIndexMapper.getRenderableFromVisualIndex(R),O=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",k,O,S)}w(K)}E$(L)&&(L=function(K){return function(J,b){b(K.test(J))}}(L)),dt(L)?(m=o.runHooks("beforeValidate",m,v.visualRow,v.prop,A),o._registerImmediate(()=>{L.call(v,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,v.visualRow,v.prop,A),v.valid=K,U(K),o.runHooks("postAfterValidate",K,m,v.visualRow,v.prop,A))})})):o._registerImmediate(()=>{v.valid=!0,U(v.valid,!1)})};function Ee(m,v,w){return Array.isArray(m)?m:[[m,v,w]]}function Ne(m,v){const w=o.runHooks("beforeChange",m,v||"edit"),A=m.filter(U=>U!==null);if(w===!1||A.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let U=A.length-1;U>=0;U--){const[K,J,,b]=A[U],R=a.propToCol(J);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(y),...y};const{type:k,checkedTemplate:O,uncheckedTemplate:N}=S;if(k==="numeric"&&typeof b=="string"&&yk(b)&&(A[U][3]=se(b)),k==="checkbox"){const j=It(b),H=j===It(O),D=j===It(N);(H||D)&&(A[U][3]=H?O:N)}}return A}this.setDataAtCell=function(m,v,w,A){const L=Ee(m,v,w),U=[];let K=A,J,b,R;for(J=0,b=L.length;J<b;J++){if(typeof L[J]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[J][1]>=this.countCols()?R=L[J][1]:R=a.colToProp(L[J][1]),U.push([L[J][0],R,l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]])}!K&&typeof m=="object"&&(K=v);const S=Ne(U,K);o.runHooks("afterSetDataAtCell",S,K),be(S,K,()=>{bt(S,K)})},this.setDataAtRowProp=function(m,v,w,A){const L=Ee(m,v,w),U=[];let K=A,J,b;for(J=0,b=L.length;J<b;J++)U.push([L[J][0],L[J][1],l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]]);!K&&typeof m=="object"&&(K=v);const R=Ne(U,A);o.runHooks("afterSetDataAtRowProp",R,K),be(R,K,()=>{bt(R,K)})},this.listen=function(){o&&!o.isListening()&&(nb.forEach(m=>{o!==m&&m.unlisten()}),tb=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(tb=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return tb===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),v&&V.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,v,w,A,L,U,K){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const J=typeof A=="number"?o._createCellCoords(A,L):null;return u.populateFromArray(o._createCellCoords(m,v),w,J,U,K)},this.spliceCol=function(m,v,w){for(var A=arguments.length,L=new Array(A>3?A-3:0),U=3;U<A;U++)L[U-3]=arguments[U];return a.spliceCol(m,v,w,...L)},this.spliceRow=function(m,v,w){for(var A=arguments.length,L=new Array(A>3?A-3:0),U=3;U<A;U++)L[U-3]=arguments[U];return a.spliceRow(m,v,w,...L)},this.getSelected=function(){if(V.isSelected())return Ke(V.getSelectedRange(),m=>{let{from:v,to:w}=m;return[v.row,v.col,w.row,w.col]})},this.getSelectedLast=function(){const m=this.getSelected();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.getSelectedRange=function(){if(V.isSelected())return Array.from(V.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.emptySelectedCells=function(m){if(!V.isSelected()||this.countRows()===0||this.countCols()===0)return;const v=[];x(V.getSelectedRange(),w=>{if(w.isSingleHeader())return;const A=w.getTopStartCorner(),L=w.getBottomEndCorner();fe(A.row,L.row,U=>{fe(A.col,L.col,K=>{this.getCellMeta(U,K).readOnly||v.push([U,K,null])})})}),v.length>0&&this.setDataAtCell(v,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const v=m();return this.resumeRender(),v},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(v,0),(!this.isExecutionSuspended()&&v===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=m();return this.resumeExecution(v),w},this.batch=function(m){this.suspendRender(),this.suspendExecution();const v=m();return this.resumeExecution(),this.resumeRender(),v},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:v,height:w}=m.getLastSize(),{width:A,height:L}=o.rootElement.getBoundingClientRect(),U=A!==v||L!==w;o.runHooks("beforeRefreshDimensions",{width:v,height:w},{width:A,height:L},U)!==!1&&((U||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(A,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:v,height:w},{width:A,height:L},U))},this.updateData=function(m,v){pO(m,w=>{a=w},w=>{a=w,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),V.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:v,metaManager:E,firstRun:f})},this.loadData=function(m,v){pO(m,w=>{a=w},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),V.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:v,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=y.columns;let v=0;if(Array.isArray(m))v=m.length;else if(dt(m))if(o.dataType==="array"){const w=this.countSourceCols();for(let A=0;A<w;A+=1)m(A)&&(v+=1)}else(o.dataType==="object"||o.dataType==="function")&&(v=a.colToPropCache.length);else if(le(y.dataSchema)){const w=a.getSchema();v=Array.isArray(w)?w.length:Kv(w)}else v=this.countSourceCols();return v},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,v,w,A){return Lt(m)?a.getAll():a.getRange(o._createCellCoords(m,v),o._createCellCoords(w,A),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,v,w,A){return a.getCopyableText(o._createCellCoords(m,v),o._createCellCoords(w,A))},this.getCopyableData=function(m,v){return a.getCopyable(m,a.colToProp(v))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(f?o.loadData:o.updateData).bind(this);let A=!1,L,U;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&Z(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")X("className",m.className);else if(L==="tableClassName"&&o.table)X("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ie.getSingleton().isRegistered(L)||ie.getSingleton().isDeprecated(L)){const S=m[L];dt(S)?(ie.getSingleton().addAsFixed(L,S,o),y[L]=S):Array.isArray(S)&&(ie.getSingleton().add(L,S,o),y[L]=S)}else!v&&cn(m,L)&&(T[L]=m[L]);m.data===void 0&&y.data===void 0?w(null,"updateSettings"):m.data!==void 0?w(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),J=y.columns;if(J&&dt(J)&&(A=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),K>0)for(L=0,U=0;L<K;L++){if(J){const S=A?J(L):J[U];S&&E.updateColumnMeta(U,S)}U+=1}le(m.cell)&&Le(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(dt(R)&&(R=R()),v&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;dt(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!v){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),k=cn(m,"themeName");S&&k&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const O=k&&m.themeName||SO(o.rootElement);o.useTheme(O),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!v&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(y.getValue){if(dt(y.getValue))return y.getValue.call(o);if(m)return o.getData()[m[0][0]][y.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,v,w,A,L){u.alter(m,v,w,A,L)},this.getCell=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=v,L=m;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||A===null||L===void 0||A===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,A),w)},this.getCoords=function(m){const v=this.view._wt.wtTable.getCoords(m);if(v===null)return null;const{row:w,col:A}=v;let L=w,U=A;return w>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(w)),A>=0&&(U=this.columnIndexMapper.getVisualFromRenderableIndex(A)),o._createCellCoords(L,U)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,v){return a.get(m,a.colToProp(v))},this.getDataAtRowProp=function(m,v){return a.get(m,v)},this.getDataAtCol=function(m){const v=[],w=a.getRange(o._createCellCoords(0,m),o._createCellCoords(y.data.length-1,m),a.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let L=0;L<w[A].length;L+=1)v.push(w[A][L]);return v},this.getDataAtProp=function(m){const v=[],w=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(y.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let L=0;L<w[A].length;L+=1)v.push(w[A][L]);return v},this.getSourceData=function(m,v,w,A){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(w,A)),L},this.getSourceDataArray=function(m,v,w,A){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(w,A),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,v,w,A){const L=Ee(m,v,w),U=this.hasHook("afterSetSourceDataAtCell"),K=[];U&&x(L,b=>{let[R,S,k]=b;K.push([R,S,l.getAtCell(R,S),k])}),x(L,b=>{let[R,S,k]=b;l.setAtCell(R,S,k)}),U&&this.runHooks("afterSetSourceDataAtCell",K,A),this.render();const J=o.getActiveEditor();J&&le(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,v){return l.getAtCell(m,v)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,v,w,A){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,v,w,A],[U,K]=L;let[,,J,b]=L,R=null,S=null;J===void 0&&(J=U),b===void 0&&(b=K);let k="mixed";return fe(Math.max(Math.min(U,J),0),Math.max(U,J),O=>{let N=!0;return fe(Math.max(Math.min(K,b),0),Math.max(K,b),j=>(S=this.getCellMeta(O,j).type,R?N=R===S:R=S,N)),k=N?S:"mixed",N}),k},this.removeCellMeta=function(m,v,w){const[A,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(v)];let U=E.getCellMetaKeyValue(A,L,w);o.runHooks("beforeRemoveCellMeta",m,v,w,U)!==!1&&(E.removeCellMeta(A,L,w),o.runHooks("afterRemoveCellMeta",m,v,w,U)),U=null},this.spliceCellsMeta=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,A=new Array(w>2?w-2:0),L=2;L<w;L++)A[L-2]=arguments[L];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&E.removeRow(this.toPhysicalRow(m),v),A.length>0&&x(A.reverse(),U=>{E.createRow(this.toPhysicalRow(m)),x(U,(K,J)=>this.setCellMetaObject(m,J,K))}),o.render()},this.setCellMetaObject=function(m,v,w){typeof w=="object"&&Le(w,(A,L)=>{this.setCellMeta(m,v,L,A)})},this.setCellMeta=function(m,v,w,A){if(o.runHooks("beforeSetCellMeta",m,v,w,A)===!1)return;let U=m,K=v;m<this.countRows()&&(U=this.toPhysicalRow(m)),v<this.countCols()&&(K=this.toPhysicalColumn(v)),E.setCellMeta(U,K,w,A),o.runHooks("afterSetCellMeta",m,v,w,A)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},A=this.toPhysicalRow(m),L=this.toPhysicalColumn(v);return A===null&&(A=m),L===null&&(L=v),E.getCellMeta(A,L,{visualRow:m,visualColumn:v,...w})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||y.columns)},this.getCellRenderer=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).renderer:m.renderer;return typeof w=="string"?Hw(w):Lt(w)?Hw("text"):w},this.getCellEditor=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).editor:m.editor;return typeof w=="string"?Aw(w):Lt(w)?Aw("text"):w},this.getCellValidator=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).validator:m.validator;return typeof w=="string"?rT(w):w},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,v){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,m)},this.validateColumns=function(m,v){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,m)},this._validateCells=function(m,v,w){const A=new Q;m&&(A.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(v!==void 0&&v.indexOf(L)===-1){L-=1;continue}let U=o.countCols()-1;for(;U>=0;){if(w!==void 0&&w.indexOf(U)===-1){U-=1;continue}A.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,U),o.getCellMeta(L,U),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),U-=1}L-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let v=y.rowHeaders,w=m;return w!==void 0&&(w=o.runHooks("modifyRowHeader",w)),w===void 0?(v=[],fe(o.countRows()-1,A=>{v.push(o.getRowHeader(A))})):Array.isArray(v)&&v[w]!==void 0?v=v[w]:dt(v)?v=v(w):v&&typeof v!="string"&&typeof v!="number"&&(v=w+1),v},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let m=0,v=o.countCols();m<v;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=o.runHooks("modifyColHeader",m);if(w===void 0){const J=[],b=o.countCols();for(let R=0;R<b;R++)J.push(o.getColHeader(R));return J}let A=y.colHeaders;const L=function(J){const b=[],R=o.countCols();let S=0;for(;S<R;S++)dt(y.columns)&&y.columns(S)&&b.push(S);return b[J]},U=o.toPhysicalColumn(w),K=L(U);return y.colHeaders===!1?A=null:y.columns&&dt(y.columns)&&y.columns(K)&&y.columns(K).title?A=y.columns(K).title:y.columns&&y.columns[U]&&y.columns[U].title?A=y.columns[U].title:Array.isArray(y.colHeaders)&&y.colHeaders[U]!==void 0?A=y.colHeaders[U]:dt(y.colHeaders)?A=y.colHeaders(U):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(A=ey(w)),A=o.runHooks("modifyColumnHeaderValue",A,m,v),A},this._getColWidthFromSettings=function(m){let v;if(m>=0&&(v=o.getCellMeta(0,m).width),(v===void 0||v===y.width)&&(v=y.colWidths),v!=null){switch(typeof v){case"object":v=v[m];break;case"function":v=v(m);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(m,v){let w=o._getColWidthFromSettings(m);return w=o.runHooks("modifyColWidth",w,m,v),w===void 0&&(w=nh),w},this._getRowHeightFromSettings=function(m){const v=this.view.getDefaultRowHeight();let w=y.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w!=null&&w<v?v:w},this.getRowHeight=function(m,v){let w=o._getRowHeightFromSettings(m);return w=o.runHooks("modifyRowHeight",w,m,v),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=y.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,v)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return AR(o.countRows()-1,w=>{if(o.isEmptyRow(w))v+=1;else if(m===!0)return!1}),v},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return AR(o.countCols()-1,w=>{if(o.isEmptyCol(w))v+=1;else if(m===!0)return!1}),v},this.isEmptyRow=function(m){return y.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return y.isEmptyCol.call(o,m)},this.selectCell=function(m,v,w,A){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,U=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Lt(m)||Lt(v)?!1:this.selectCells([[m,v,w,A]],L,U)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;v===!1&&d.suspend();const A=V.selectCells(m);return A&&w&&o.listen(),d.resume(),A},this.selectColumns=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;return V.selectColumns(m,v,w)},this.selectRows=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;return V.selectRows(m,v,w)},this.deselectCell=function(){V.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),V.selectAll(m,v,w)};const lt=(m,v)=>m.getNearestNotHiddenIndex(v,1,!0);this.scrollViewportTo=function(m,v){if(typeof m=="number"){var w;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:A,col:L,considerHiddenIndexes:U}=m??{};let K=A,J=L;if(dt(v)&&this.addHookOnce("afterScroll",v),U===void 0||U){const k=Number.isInteger(A)&&A>=0,O=Number.isInteger(L)&&L>=0,N=k?lt(this.rowIndexMapper,A):void 0,j=O?lt(this.columnIndexMapper,L):void 0;if(N===null||j===null)return!1;K=k?o.rowIndexMapper.getRenderableFromVisualIndex(N):A,J=O?o.columnIndexMapper.getRenderableFromVisualIndex(j):L}const b=Number.isInteger(K),R=Number.isInteger(J);let S=!1;return b&&K>=0&&R&&J>=0?S=o.view.scrollViewport(o._createCellCoords(K,J),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(R&&J<0||!R)?S=o.view.scrollViewportVertically(K,m.verticalSnap):R&&J>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(J,m.horizontalSnap)),dt(v)&&(S?this.view.render():(this.removeHook("afterScroll",v),this._registerMicrotask(()=>v()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;dt(m)&&this.addHookOnce("afterScroll",m);const{highlight:v}=this.getSelectedRangeLast(),w=this.scrollViewportTo(v.toObject());return w?this.view.render():dt(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),w},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),nb.delete(this.guid),Wp(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}Qo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),M.getItems().forEach(m=>{let[,v]=m;v.destroy()}),M.clear(),o.runHooks("afterDestroy")},!0),ie.getSingleton().destroy(o),Le(o,(m,v,w)=>{dt(m)?w[v]=On(v):v!=="guid"&&(w[v]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,V=null,c=null,o=null};function On(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return M.getItem(tr(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:M.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,v,w){ie.getSingleton().add(m,v,o,w)},this.hasHook=function(m){return ie.getSingleton().has(m,o)||ie.getSingleton().has(m)},this.addHookOnce=function(m,v,w){ie.getSingleton().once(m,v,o,w)},this.removeHook=function(m,v){ie.getSingleton().remove(m,v,o)},this.runHooks=function(m,v,w,A,L,U,K){return ie.getSingleton().run(o,m,v,w,A,L,U,K)},this.getTranslatedPhrase=function(m,v){return oL(y.language,m,v)},this.toHTML=()=>IR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",IR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=m;typeof w=="function"&&(w=setTimeout(w,v)),this.timeouts.push(w)},this._clearTimeouts=function(){x(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){x(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const ut=Bse({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&ut.releasePressedKeys()}),this.getShortcutManager=function(){return ut},this.getFocusManager=function(){return h},nT().forEach(m=>{const v=Cg(m);M.addItem(m,new v(this))}),Ese(o),ut.setActiveContextName("grid"),ie.getSingleton().run(o,"construct")}function RO(t,e,n){t.addEventListener(e,n,!1)}function EO(t,e,n){t.removeEventListener(e,n,!1)}function Mm(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function CL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Mm(s).fontSize,o.style.fontFamily=Mm(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Mm(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=Mm(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),p=o.clientWidth+f+g+1;r.removeChild(o);const C=s.style;C.height=`${n.minHeight}px`,n.minWidth>p?C.width=`${n.minWidth}px`:p>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${p}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?C.height=`${n.minHeight}px`:n.maxHeight<E?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(RO(s,"input",a),RO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){EO(s,"input",a),EO(s,"keydown",l)}}}function TO(t,e){const n=LE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}mg(e,i)}function gl(t,e,n){return(e=Wse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wse(t){var e=jse(t,"string");return typeof e=="symbol"?e:e+""}function jse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Use="ht_editor_visible",_m="ht_editor_hidden",MO="textEditor",zse="text";class Nu extends Sh{static get EDITOR_TYPE(){return zse}constructor(e){super(e),gl(this,"eventManager",new Mi(this)),gl(this,"autoResize",CL(this.hot.rootDocument)),gl(this,"TEXTAREA",void 0),gl(this,"textareaStyle",void 0),gl(this,"TEXTAREA_PARENT",void 0),gl(this,"textareaParentStyle",void 0),gl(this,"layerClass",void 0),this.eventManager=new Mi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Jd(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==tn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===tn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),mg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ce(this.TEXTAREA,[["data-hot-input",""],Pu(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),we(this.TEXTAREA_PARENT,this.layerClass)&&pe(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,_m),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){ok()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",pe(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,_m)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(we(i,"handsontableEditor"))return n=!0,!1}),we(this.TEXTAREA_PARENT,_m)&&pe(this.TEXTAREA_PARENT,_m),n?(this.layerClass=Use,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==tn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){GE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===tn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===tn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:MO},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;TO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;TO(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(MO)}}const Yse="base";function Tg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(iI())):a&&c.push(iI()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(oI())):(u.push(s.invalidCellClassName),a&&c.push(oI()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),pe(e,u),q(e,l),Ou(e,c),Ce(e,h)}Tg.RENDERER_TYPE=Yse;const Gse="text";function ta(t,e,n,r,i,o,s){Tg.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=It(a),s.trimWhitespace&&(a=a.trim()),Ga(e,a)}ta.RENDERER_TYPE=Gse;const Kse="text",bL={CELL_TYPE:Kse,editor:Nu,renderer:ta};di(bL);Te.editors={BaseEditor:Sh};function Te(t,e){const n=new yL(t,e||{},CT);return n.init(),n}Te.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new yL(t,e,CT)};Te.DefaultSettings=dL();Te.hooks=ie.getSingleton();Te.CellCoords=gu;Te.CellRange=bg;Te.packageName="handsontable";Te.buildDate="24/04/2025 10:59:00";Te.version="15.3.0";Te.languages={dictionaryKeys:hie,getLanguageDictionary:iL,getLanguagesDictionaries:pie,registerLanguageDictionary:rL,getTranslatedPhrase:oL};const _O="handsontableEditor",qse="handsontable";class QM extends Nu{static get EDITOR_TYPE(){return qse}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),mg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&fn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:_O,relativeToGroup:el,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ai(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_O)}}function Xse(t,e){SL(t,e),e.add(t)}function xO(t,e,n){SL(t,e),e.set(t,n)}function SL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xm(t,e,n){return(e=Jse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jse(t){var e=Zse(t,"string");return typeof e=="symbol"?e:e+""}function Zse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rb(t,e){return t.get(UR(t,e))}function UR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qse="autocomplete";var ib=new WeakMap,PO=new WeakMap,ob=new WeakSet;class e_ extends QM{constructor(){super(...arguments),Xse(this,ob),xm(this,"query",null),xm(this,"strippedChoices",[]),xm(this,"rawChoices",[]),xO(this,ib,this.hot.guid.slice(0,9)),xO(this,PO,wg(()=>{this.focus()},100)),xm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=SR(It(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return Qse}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[G8(),W8(),x$("listbox"),J8()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[Ri("false"),Z8(`${rb(ib,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",rb(PO,this)),this.htEditor.updateSettings({colWidths:e?[rn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{ta(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:p,locale:C}=this.cellProperties,E=this.query;let y=It(d),T,M;y&&!p&&(T=g===!0?y.indexOf(E):y.toLocaleLowerCase(C).indexOf(E.toLocaleLowerCase(C)),T!==-1&&(M=y.substr(T,E.length),y=y.replace(M,`<strong>${M}</strong>`))),n&&Ce(l,[j8(),...r?[nJ(i)]:[],...r?[rJ(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=y},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{Ce(h,[HE()]),Ce(this.TEXTAREA,...Q8(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(Ce(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...ks()),Ce(this.htEditor.rootElement,[_$(),eJ("polite"),tJ("text"),["id",`${rb(ib,this)}-listbox-${o}-${s}`]]),Ce(this.TEXTAREA,...Ri("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[Ri("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=LE(this.TEXTAREA),r=W$(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Kd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),mg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),UR(ob,this,IO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),UR(ob,this,IO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ke(e,o=>It(o));return Ke(r,o=>n?o:SR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(sk(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function IO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+In(this.hot.rootDocument)})}const eae="checkbox";class RL extends Sh{static get EDITOR_TYPE(){return eae}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');we(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Na=()=>window,vi=()=>window.document,zR=(t,e)=>window.setTimeout(t,e),Oo=function(t,e,n,r){t.addEventListener(e,n,!!r)},ps=function(t,e,n,r){t.removeEventListener(e,n,!!r)},tae=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ur=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},sb=function(t,e){Ur(t,e)||(t.className=t.className===""?e:t.className+" "+e)},ab=function(t,e){t.className=tae((" "+t.className+" ").replace(" "+e+" "," "))},t_=function(t){return/Array/.test(Object.prototype.toString.call(t))},Kr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},nae=function(t){let e=t.getDay();return e===0||e===6},rae=function(t){return t%4===0&&t%100!==0||t%400===0},OO=function(t,e){return[31,rae(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Pm=function(t){Kr(t)&&t.setHours(0,0,0,0)},Im=function(t,e){return t.getTime()===e.getTime()},kw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Kr(e[r])?n&&(t[r]=new Date(e[r].getTime())):t_(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=kw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},AO=function(t,e,n){let r=vi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=kw(r,n),t.dispatchEvent(r)},HO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Co={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},NO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},iae=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},oae=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},sae=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():oae(o,i))+"</td>"},aae=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},lae=function(t){return"<tbody>"+t.join("")+"</tbody>"},uae=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+NO(t,e)+'">'+NO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},cae=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,p=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",t_(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(p=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},hae=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+uae(t)+lae(e)+"</table>"};function YR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Na().event;let o=i.target||i.srcElement;if(o)if(Ur(o,"is-disabled")||(Ur(o,"pika-button")&&!Ur(o,"is-empty")&&!Ur(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&zR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Ur(o,"pika-prev")?e.prevMonth():Ur(o,"pika-next")&&e.nextMonth()),Ur(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Na().event;let o=i.target||i.srcElement;o&&(Ur(o,"pika-select-month")?e.gotoMonth(o.value):Ur(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Na().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Kr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=vi().activeElement;do if(Ur(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=zR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Na().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Ur(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Oo(o,"change",e._onChange)));do if(Ur(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=vi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Oo(e.el,"mousedown",e._onMouseDown,!0),Oo(e.el,"touchend",e._onMouseDown,!0),Oo(e.el,"change",e._onChange),n.keyboardInput&&Oo(vi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?vi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Oo(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Kr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Oo(n.trigger,"click",e._onInputClick),Oo(n.trigger,"focus",e._onInputFocus),Oo(n.trigger,"blur",e._onInputBlur)):this.show()}YR.prototype={config:function(t){this._o||(this._o=kw({},Co,!0));let e=kw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Kr(e.minDate)||(e.minDate=!1),Kr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),t_(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Co.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Kr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Kr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",AO(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Kr(t))return;let n=this._o.minDate,r=this._o.maxDate;Kr(n)&&t<n?t=n:Kr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Pm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),AO(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Kr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=HO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=HO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Pm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Co.minDate,this._o.minYear=Co.minYear,this._o.minMonth=Co.minMonth,this._o.startRange=Co.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Pm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Co.maxDate,this._o.maxYear=Co.maxYear,this._o.maxMonth=Co.maxMonth,this._o.endRange=Co.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+cae(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&zR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Na().innerWidth||vi().documentElement.clientWidth,i=Na().innerHeight||vi().documentElement.clientHeight,o=vi().body.scrollTop||vi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Na().pageXOffset,a=l.bottom+Na().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",sb(this.el,u?"left-aligned":"right-aligned"),sb(this.el,c?"bottom-aligned":"top-aligned"),ab(this.el,u?"right-aligned":"left-aligned"),ab(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=OO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Pm(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=OO(h,u),g=o+s,p=g;for(;p>7;)p-=7;g+=7-p;let C=!1;for(let E=0,y=0;E<g;E++){let T=new Date(t,e,1+(E-s)),M=Kr(this._d)?Im(T,this._d):!1,I=Im(T,i),_=r.events.indexOf(T.toDateString())!==-1,P=E<s||E>=o+s,Y=1+(E-s),V=e,B=t,Z=r.startRange&&Im(r.startRange,T),X=r.endRange&&Im(r.endRange,T),Q=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,se=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&nae(T)||r.disableDayFn&&r.disableDayFn(T);P&&(E<s?(Y=f+Y,V=u,B=h):(Y=Y-o,V=c,B=d));let be={day:Y,month:V,year:B,hasEvent:_,isSelected:M,isToday:I,isDisabled:se,isEmpty:P,isStartRange:Z,isEndRange:X,isInRange:Q,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&M&&(C=!0),l.push(iae(be)),++y===7&&(r.showWeekNumber&&l.unshift(sae(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(aae(l,r.isRTL,r.pickWholeWeek,C)),l=[],y=0,C=!1)}return hae(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),ab(this.el,"is-hidden"),this._o.bound&&(Oo(vi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&ps(vi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),sb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),ps(this.el,"mousedown",this._onMouseDown,!0),ps(this.el,"touchend",this._onMouseDown,!0),ps(this.el,"change",this._onChange),t.keyboardInput&&ps(vi(),"keydown",this._onKeyChange),t.field&&(ps(t.field,"change",this._onInputChange),t.bound&&(ps(t.trigger,"click",this._onInputClick),ps(t.trigger,"focus",this._onInputFocus),ps(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function dae(t,e){fae(t,e),e.add(t)}function fae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DO(t,e,n){return(e=gae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gae(t){var e=mae(t,"string");return typeof e=="symbol"?e:e+""}function mae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const EL="date",$O="dateEditor",pae="DD/MM/YYYY";var Om=new WeakSet;class TL extends Nu{constructor(){super(...arguments),dae(this,Om),DO(this,"parentDestroyed",!1),DO(this,"$datePicker",null)}static get EDITOR_TYPE(){return EL}init(){if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof YR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(pe(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();pe(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{we(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:$O})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup($O),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=lb(Om,this,ub).call(this),r=this.hot.view.isMouseDown(),i=e?qE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new YR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(ee),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,ee(o,n,!0).isValid()&&this.$datePicker.setMoment(ee(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,ee(o,n,!0).isValid()&&this.$datePicker.setMoment(ee(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&yg(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:lb(Om,this,ub).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=ee(a).format(lb(Om,this,ub).call(this))),this.setValue(a),i&&i(),Go()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==tn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+dn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-rn(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function ub(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:pae}const wae="dropdown";class ML extends e_{static get EDITOR_TYPE(){return wae}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const vae="numeric";class _L extends Nu{static get EDITOR_TYPE(){return vae}}function yae(t,e,n){return(e=Cae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cae(t){var e=bae(t,"string");return typeof e=="symbol"?e:e+""}function bae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Sae="password";class xL extends Nu{constructor(){super(...arguments),yae(this,"autoResize",CL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Sae}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Qo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const cb="ht_editor_visible",kO="selectEditor",Rae="select";class PL extends Sh{static get EDITOR_TYPE(){return Rae}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Iu()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",we(this.selectWrapper,cb)&&pe(this.selectWrapper,cb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Qo(this.select),Le(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Au(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==tn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,cb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:kO};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kO)}}const Eae="time";class IL extends Nu{static get EDITOR_TYPE(){return Eae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function Tae(){Pr(Sh),Pr(e_),Pr(RL),Pr(TL),Pr(ML),Pr(QM),Pr(_L),Pr(xL),Pr(PL),Pr(Nu),Pr(IL)}const Mae="html";function n_(t,e,n,r,i,o,s){Tg.apply(this,[t,e,n,r,i,o,s]),Au(e,o??"",!1)}n_.RENDERER_TYPE=Mae;const _ae="autocomplete";function Eh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?n_:ta,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Iu()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new Mi(t);t.acArrowListener=function(d){we(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Eh.RENDERER_TYPE=_ae;const xae="dropdown";function r_(t,e,n,r,i,o,s){Eh.apply(this,[t,e,n,r,i,o,s])}r_.RENDERER_TYPE=xae;const LO=new WeakMap,FO=new WeakMap,Pae="htBadValue",ih="data-row",oh="data-col",Iae="checkboxRenderer",OL="checkbox";ie.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===OL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function i_(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Tg.apply(this,[t,e,n,r,i,o,s]),Oae(t);let u=Aae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Qo(e),o===s.checkedTemplate||It(o).toLocaleLowerCase(s.locale)===It(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||It(o).toLocaleLowerCase(s.locale)===It(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Xt(o)?q(u,"noValue"):(u.style.display="none",q(u,Pae),h=!0),Ce(u,[[ih,n],[oh,r]]),l&&Ce(u,[Of(u.checked?t.getTranslatedPhrase(KM):t.getTranslatedPhrase(qM)),O$(u.checked),U8()]),!h&&c){let p="";if(c.value)p=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);p=E!==null?E:""}const C=Hae(a,p,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),LO.has(t)||(LO.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),E={group:Iae,relativeToGroup:el,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const y=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(y==null?void 0:y.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}}],E)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),E=[],y=new Map;let T=[],M=0;if(C){for(let I=0;I<C.length;I++){const{row:_,col:P}=C[I].getTopStartCorner(),{row:Y,col:V}=C[I].getBottomEndCorner();for(let B=_;B<=Y;B+=1)for(let Z=P;Z<=V;Z+=1){const X=t.getCellMeta(B,Z);if(X.hidden)continue;const Q={checkedTemplate:X.checkedTemplate,uncheckedTemplate:X.uncheckedTemplate};if(X.type!=="checkbox"){p===!0&&!X.readOnly&&(y.has(E.length)?y.set(E.length,[...y.get(E.length),[B,Z,null]]):y.set(E.length,[[B,Z,null]]));continue}if(X.readOnly===!0)continue;typeof X.checkedTemplate>"u"&&(X.checkedTemplate=!0),typeof X.uncheckedTemplate>"u"&&(X.uncheckedTemplate=!1);const se=t.getDataAtCell(B,Z);p===!1?[X.checkedTemplate,X.checkedTemplate.toString()].includes(se)?T.push([B,Z,X.uncheckedTemplate,Q]):[X.uncheckedTemplate,X.uncheckedTemplate.toString(),null,void 0].includes(se)&&T.push([B,Z,X.checkedTemplate,Q]):T.push([B,Z,X.uncheckedTemplate,Q]),M+=1}E.push(M),M=0}T.every(I=>{let[,,_]=I;return _===T[0][2]})?T=T.map(I=>{let[_,P,Y]=I;return[_,P,Y]}):T=T.map(I=>{let[_,P,,Y]=I;return[_,P,Y.checkedTemplate]}),T.length>0&&E.forEach((I,_)=>{let P=T.splice(0,I);y.size&&y.has(_)&&(P=[...P,...y.get(_)]),t.setDataAtCell(P)})}}function g(){const p=t.getSelectedRange();if(p){for(let C=0;C<p.length;C++){const E=p[C].getTopStartCorner(),y=p[C].getBottomEndCorner();for(let T=E.row;T<=y.row;T++)for(let M=E.col;M<=y.col;M++){if(t.getCellMeta(T,M).readOnly)continue;const _=t.getCell(T,M);if(qo(_)&&_.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}i_.RENDERER_TYPE=OL;function Oae(t){let e=FO.get(t);if(!e){const{rootElement:n}=t;e=new Mi(t),e.addEventListener(n,"click",r=>Dae(r,t)),e.addEventListener(n,"mouseup",r=>Nae(r,t)),e.addEventListener(n,"change",r=>$ae(r,t)),FO.set(t,e)}return e}function Aae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Hae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function Nae(t,e){const{target:n}=t;o_(n)&&(!n.hasAttribute(ih)||!n.hasAttribute(oh)||setTimeout(e.listen,10))}function Dae(t,e){const{target:n}=t;if(!o_(n)||!n.hasAttribute(ih)||!n.hasAttribute(oh))return;const r=parseInt(n.getAttribute(ih),10),i=parseInt(n.getAttribute(oh),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function $ae(t,e){const{target:n}=t;if(!o_(n)||!n.hasAttribute(ih)||!n.hasAttribute(oh))return;const r=parseInt(n.getAttribute(ih),10),i=parseInt(n.getAttribute(oh),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function o_(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const kae="handsontable";function s_(t,e,n,r,i,o,s){Eh.apply(this,[t,e,n,r,i,o,s])}s_.RENDERER_TYPE=kae;var Lae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var hb,VO;function Vae(){return VO||(VO=1,hb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),hb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var db,BO;function AL(){if(BO)return db;BO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let p="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let _=0;_<t.length;_++){let P=t[_];if(p=l.replace(RegExp(`([0-9 ])(${P.key})$`),"$1"),p!==l)return n(p,u,c,h,d,f)*P.factor}if(p=l.replace("%",""),p!==l)return n(p,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let y=h(E);if(y&&y!=="."&&(p=l.replace(new RegExp(`${e(y)}$`),""),p!==l))return n(p,u,c,h,d,f);let T={};Object.keys(f).forEach(_=>{T[f[_]]=_});let M=Object.keys(T).sort().reverse(),I=M.length;for(let _=0;_<I;_++){let P=M[_],Y=T[P];if(p=l.replace(P,""),p!==l){let V;switch(Y){case"thousand":V=Math.pow(10,3);break;case"million":V=Math.pow(10,6);break;case"billion":V=Math.pow(10,9);break;case"trillion":V=Math.pow(10,12);break}return n(p,u,c,h,d,f)*V}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let p=r(l,u,c);return n(p,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=u_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),p=c.currentAbbreviations(),C;if(typeof l=="string")o(l,h)?C=s(l):C=i(l,h,d,f,g,p);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return db={unformat:a},db}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var fb,WO;function a_(){if(WO)return fb;WO=1;let t=AL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,E){let y=d(C),T=g(E);return y&&T}function d(C){return t.unformat(C)!==void 0}function f(C,E,y,T=!1){let M=Object.keys(C).map(I=>{if(!E[I])return console.error(`${y} Invalid key: ${I}`),!1;let _=C[I],P=E[I];if(typeof P=="string"&&(P={type:P}),P.type==="format"){if(!f(_,u,`[Validate ${I}]`,!0))return!1}else if(typeof _!==P.type)return console.error(`${y} ${I} type mismatched: "${P.type}" expected, "${typeof _}" provided`),!1;if(P.restrictions&&P.restrictions.length){let Y=P.restrictions.length;for(let V=0;V<Y;V++){let{restriction:B,message:Z}=P.restrictions[V];if(!B(_,C))return console.error(`${y} ${I} invalid value: ${Z}`),!1}}return P.restriction&&!P.restriction(_,C)?(console.error(`${y} ${I} invalid value: ${P.message}`),!1):P.validValues&&P.validValues.indexOf(_)===-1?(console.error(`${y} ${I} invalid value: must be among ${JSON.stringify(P.validValues)}, "${_}" provided`),!1):!(P.children&&!f(_,P.children,`[Validate ${I}]`))});return T||M.push(...Object.keys(E).map(I=>{let _=E[I];if(typeof _=="string"&&(_={type:_}),_.mandatory){let P=_.mandatory;if(typeof P=="function"&&(P=P(C)),P&&C[I]===void 0)return console.error(`${y} Missing mandatory key "${I}"`),!1}return!0})),M.reduce((I,_)=>I&&_,!0)}function g(C){return f(C,u,"[Validate format]")}function p(C){return f(C,c,"[Validate language]")}return fb={validate:h,validateFormat:g,validateInput:d,validateLanguage:p},fb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Bae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function Wae(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function jae(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function Uae(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function zae(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function Yae(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function Gae(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function Kae(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function qae(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function Xae(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Jae(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Zae(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function Qae(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function ele(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function tle(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function nle(t,e={}){return typeof t!="string"?t:(t=Bae(t,e),t=Wae(t,e),jae(t,e),Yae(t,e),Gae(t,e),Qae(t,e),Xae(t,e),Jae(t,e),Kae(t,e),Zae(t,e),qae(t,e),Uae(t,e),zae(t,e),ele(t,e),tle(t,e),e)}var l_={parseFormat:nle};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var gb,jO;function u_(){if(jO)return gb;jO=1;const t=Vae(),e=a_(),n=l_;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,gb=r,gb}function rle(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function ile(t,e){t.forEach(n=>{let r;try{r=rle(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var ole=t=>({loadLanguagesInNode:e=>ile(e,t)}),HL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(_){var P,Y,V,B=w.prototype={constructor:w,toString:null,valueOf:null},Z=new w(1),X=20,Q=4,se=-7,be=21,bt=-1e7,Ee=1e7,Ne=!1,lt=1,On=0,ut={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",v=!0;function w(b,R){var S,k,O,N,j,H,D,W,F=this;if(!(F instanceof w))return new w(b,R);if(R==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>Ee?F.c=F.e=null:b.e<bt?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((H=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(N=0,j=b;j>=10;j/=10,N++);N>Ee?F.c=F.e=null:(F.e=N,F.c=[b]);return}W=String(b)}else{if(!r.test(W=String(b)))return V(F,W,H);F.s=W.charCodeAt(0)==45?(W=W.slice(1),-1):1}(N=W.indexOf("."))>-1&&(W=W.replace(".","")),(j=W.search(/e/i))>0?(N<0&&(N=j),N+=+W.slice(j+1),W=W.substring(0,j)):N<0&&(N=W.length)}else{if(y(R,2,m.length,"Base"),R==10&&v)return F=new w(b),K(F,X+F.e+1,Q);if(W=String(b),H=typeof b=="number"){if(b*0!=0)return V(F,W,H,R);if(F.s=1/b<0?(W=W.slice(1),-1):1,w.DEBUG&&W.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=W.charCodeAt(0)===45?(W=W.slice(1),-1):1;for(S=m.slice(0,R),N=j=0,D=W.length;j<D;j++)if(S.indexOf(k=W.charAt(j))<0){if(k=="."){if(j>N){N=D;continue}}else if(!O&&(W==W.toUpperCase()&&(W=W.toLowerCase())||W==W.toLowerCase()&&(W=W.toUpperCase()))){O=!0,j=-1,N=0;continue}return V(F,String(b),H,R)}H=!1,W=Y(W,R,10,F.s),(N=W.indexOf("."))>-1?W=W.replace(".",""):N=W.length}for(j=0;W.charCodeAt(j)===48;j++);for(D=W.length;W.charCodeAt(--D)===48;);if(W=W.slice(j,++D)){if(D-=j,H&&w.DEBUG&&D>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((N=N-j-1)>Ee)F.c=F.e=null;else if(N<bt)F.c=[F.e=0];else{if(F.e=N,F.c=[],j=(N+1)%u,N<0&&(j+=u),j<D){for(j&&F.c.push(+W.slice(0,j)),D-=u;j<D;)F.c.push(+W.slice(j,j+=u));j=u-(W=W.slice(j)).length}else j-=D;for(;j--;W+="0");F.c.push(+W)}}else F.c=[F.e=0]}w.clone=g,w.ROUND_UP=0,w.ROUND_DOWN=1,w.ROUND_CEIL=2,w.ROUND_FLOOR=3,w.ROUND_HALF_UP=4,w.ROUND_HALF_DOWN=5,w.ROUND_HALF_EVEN=6,w.ROUND_HALF_CEIL=7,w.ROUND_HALF_FLOOR=8,w.EUCLID=9,w.config=w.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],y(S,0,f,R),X=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],y(S,0,8,R),Q=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(y(S[0],-1e9,0,R),y(S[1],0,f,R),se=S[0],be=S[1]):(y(S,-1e9,f,R),se=-(be=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)y(S[0],-1e9,-1,R),y(S[1],1,f,R),bt=S[0],Ee=S[1];else if(y(S,-1e9,f,R),S)bt=-(Ee=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ne=S;else throw Ne=!S,Error(s+"crypto unavailable");else Ne=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],y(S,0,9,R),lt=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],y(S,0,f,R),On=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")ut=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))v=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:X,ROUNDING_MODE:Q,EXPONENTIAL_AT:[se,be],RANGE:[bt,Ee],CRYPTO:Ne,MODULO_MODE:lt,POW_PRECISION:On,FORMAT:ut,ALPHABET:m}},w.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!w.DEBUG)return!0;var R,S,k=b.c,O=b.e,N=b.s;e:if({}.toString.call(k)=="[object Array]"){if((N===1||N===-1)&&O>=-1e9&&O<=f&&O===o(O)){if(k[0]===0){if(O===0&&k.length===1)return!0;break e}if(R=(O+1)%u,R<1&&(R+=u),String(k[0]).length==R){for(R=0;R<k.length;R++)if(S=k[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if(k===null&&O===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},w.maximum=w.max=function(){return L(arguments,-1)},w.minimum=w.min=function(){return L(arguments,1)},w.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var k,O,N,j,H,D=0,W=[],F=new w(Z);if(S==null?S=X:y(S,0,f),j=i(S/u),Ne)if(crypto.getRandomValues){for(k=crypto.getRandomValues(new Uint32Array(j*=2));D<j;)H=k[D]*131072+(k[D+1]>>>11),H>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),k[D]=O[0],k[D+1]=O[1]):(W.push(H%1e14),D+=2);D=j/2}else if(crypto.randomBytes){for(k=crypto.randomBytes(j*=7);D<j;)H=(k[D]&31)*281474976710656+k[D+1]*1099511627776+k[D+2]*4294967296+k[D+3]*16777216+(k[D+4]<<16)+(k[D+5]<<8)+k[D+6],H>=9e15?crypto.randomBytes(7).copy(k,D):(W.push(H%1e14),D+=7);D=j/7}else throw Ne=!1,Error(s+"crypto unavailable");if(!Ne)for(;D<j;)H=R(),H<9e15&&(W[D++]=H%1e14);for(j=W[--D],S%=u,j&&S&&(H=h[u-S],W[D]=o(j/H)*H);W[D]===0;W.pop(),D--);if(D<0)W=[N=0];else{for(N=-1;W[0]===0;W.splice(0,1),N-=u);for(D=1,H=W[0];H>=10;H/=10,D++);D<u&&(N-=u-D)}return F.e=N,F.c=W,F}}(),w.sum=function(){for(var b=1,R=arguments,S=new w(R[0]);b<R.length;)S=S.plus(R[b++]);return S},Y=function(){var b="0123456789";function R(S,k,O,N){for(var j,H=[0],D,W=0,F=S.length;W<F;){for(D=H.length;D--;H[D]*=k);for(H[0]+=N.indexOf(S.charAt(W++)),j=0;j<H.length;j++)H[j]>O-1&&(H[j+1]==null&&(H[j+1]=0),H[j+1]+=H[j]/O|0,H[j]%=O)}return H.reverse()}return function(S,k,O,N,j){var H,D,W,F,G,ae,ce,_e,Be=S.indexOf("."),qe=X,Me=Q;for(Be>=0&&(F=On,On=0,S=S.replace(".",""),_e=new w(k),ae=_e.pow(S.length-Be),On=F,_e.c=R(I(C(ae.c),ae.e,"0"),10,O,b),_e.e=_e.c.length),ce=R(S,k,O,j?(H=m,b):(H=b,m)),W=F=ce.length;ce[--F]==0;ce.pop());if(!ce[0])return H.charAt(0);if(Be<0?--W:(ae.c=ce,ae.e=W,ae.s=N,ae=P(ae,_e,qe,Me,O),ce=ae.c,G=ae.r,W=ae.e),D=W+qe+1,Be=ce[D],F=O/2,G=G||D<0||ce[D+1]!=null,G=Me<4?(Be!=null||G)&&(Me==0||Me==(ae.s<0?3:2)):Be>F||Be==F&&(Me==4||G||Me==6&&ce[D-1]&1||Me==(ae.s<0?8:7)),D<1||!ce[0])S=G?I(H.charAt(1),-qe,H.charAt(0)):H.charAt(0);else{if(ce.length=D,G)for(--O;++ce[--D]>O;)ce[D]=0,D||(++W,ce=[1].concat(ce));for(F=ce.length;!ce[--F];);for(Be=0,S="";Be<=F;S+=H.charAt(ce[Be++]));S=I(S,W,H.charAt(0))}return S}}(),P=function(){function b(k,O,N){var j,H,D,W,F=0,G=k.length,ae=O%d,ce=O/d|0;for(k=k.slice();G--;)D=k[G]%d,W=k[G]/d|0,j=ce*D+W*ae,H=ae*D+j%d*d+F,F=(H/N|0)+(j/d|0)+ce*W,k[G]=H%N;return F&&(k=[F].concat(k)),k}function R(k,O,N,j){var H,D;if(N!=j)D=N>j?1:-1;else for(H=D=0;H<N;H++)if(k[H]!=O[H]){D=k[H]>O[H]?1:-1;break}return D}function S(k,O,N,j){for(var H=0;N--;)k[N]-=H,H=k[N]<O[N]?1:0,k[N]=H*j+k[N]-O[N];for(;!k[0]&&k.length>1;k.splice(0,1));}return function(k,O,N,j,H){var D,W,F,G,ae,ce,_e,Be,qe,Me,Ue,At,Ni,as,ii,Ht,wn,Tt=k.s==O.s?1:-1,Nt=k.c,ze=O.c;if(!Nt||!Nt[0]||!ze||!ze[0])return new w(!k.s||!O.s||(Nt?ze&&Nt[0]==ze[0]:!ze)?NaN:Nt&&Nt[0]==0||!ze?Tt*0:Tt/0);for(Be=new w(Tt),qe=Be.c=[],W=k.e-O.e,Tt=N+W+1,H||(H=l,W=p(k.e/u)-p(O.e/u),Tt=Tt/u|0),F=0;ze[F]==(Nt[F]||0);F++);if(ze[F]>(Nt[F]||0)&&W--,Tt<0)qe.push(1),G=!0;else{for(as=Nt.length,Ht=ze.length,F=0,Tt+=2,ae=o(H/(ze[0]+1)),ae>1&&(ze=b(ze,ae,H),Nt=b(Nt,ae,H),Ht=ze.length,as=Nt.length),Ni=Ht,Me=Nt.slice(0,Ht),Ue=Me.length;Ue<Ht;Me[Ue++]=0);wn=ze.slice(),wn=[0].concat(wn),ii=ze[0],ze[1]>=H/2&&ii++;do{if(ae=0,D=R(ze,Me,Ht,Ue),D<0){if(At=Me[0],Ht!=Ue&&(At=At*H+(Me[1]||0)),ae=o(At/ii),ae>1)for(ae>=H&&(ae=H-1),ce=b(ze,ae,H),_e=ce.length,Ue=Me.length;R(ce,Me,_e,Ue)==1;)ae--,S(ce,Ht<_e?wn:ze,_e,H),_e=ce.length,D=1;else ae==0&&(D=ae=1),ce=ze.slice(),_e=ce.length;if(_e<Ue&&(ce=[0].concat(ce)),S(Me,ce,Ue,H),Ue=Me.length,D==-1)for(;R(ze,Me,Ht,Ue)<1;)ae++,S(Me,Ht<Ue?wn:ze,Ue,H),Ue=Me.length}else D===0&&(ae++,Me=[0]);qe[F++]=ae,Me[0]?Me[Ue++]=Nt[Ni]||0:(Me=[Nt[Ni]],Ue=1)}while((Ni++<as||Me[0]!=null)&&Tt--);G=Me[0]!=null,qe[0]||qe.splice(0,1)}if(H==l){for(F=1,Tt=qe[0];Tt>=10;Tt/=10,F++);K(Be,N+(Be.e=F+W*u-1)+1,j,G)}else Be.e=W,Be.r=+G;return Be}}();function A(b,R,S,k){var O,N,j,H,D;if(S==null?S=Q:y(S,0,8),!b.c)return b.toString();if(O=b.c[0],j=b.e,R==null)D=C(b.c),D=k==1||k==2&&(j<=se||j>=be)?M(D,j):I(D,j,"0");else if(b=K(new w(b),R,S),N=b.e,D=C(b.c),H=D.length,k==1||k==2&&(R<=N||N<=se)){for(;H<R;D+="0",H++);D=M(D,N)}else if(R-=j,D=I(D,N,"0"),N+1>H){if(--R>0)for(D+=".";R--;D+="0");}else if(R+=N-H,R>0)for(N+1==H&&(D+=".");R--;D+="0");return b.s<0&&O?"-"+D:D}function L(b,R){for(var S,k,O=1,N=new w(b[0]);O<b.length;O++)k=new w(b[O]),(!k.s||(S=E(N,k))===R||S===0&&N.s===R)&&(N=k);return N}function U(b,R,S){for(var k=1,O=R.length;!R[--O];R.pop());for(O=R[0];O>=10;O/=10,k++);return(S=k+S*u-1)>Ee?b.c=b.e=null:S<bt?b.c=[b.e=0]:(b.e=S,b.c=R),b}V=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,j,H,D){var W,F=H?j:j.replace(O,"");if(k.test(F))N.s=isNaN(F)?null:F<0?-1:1;else{if(!H&&(F=F.replace(b,function(G,ae,ce){return W=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!D||D==W?ae:G}),D&&(W=D,F=F.replace(R,"$1").replace(S,"0.$1")),j!=F))return new w(F,W);if(w.DEBUG)throw Error(s+"Not a"+(D?" base "+D:"")+" number: "+j);N.s=null}N.c=N.e=null}}();function K(b,R,S,k){var O,N,j,H,D,W,F,G=b.c,ae=h;if(G){e:{for(O=1,H=G[0];H>=10;H/=10,O++);if(N=R-O,N<0)N+=u,j=R,D=G[W=0],F=o(D/ae[O-j-1]%10);else if(W=i((N+1)/u),W>=G.length)if(k){for(;G.length<=W;G.push(0));D=F=0,O=1,N%=u,j=N-u+1}else break e;else{for(D=H=G[W],O=1;H>=10;H/=10,O++);N%=u,j=N-u+O,F=j<0?0:o(D/ae[O-j-1]%10)}if(k=k||R<0||G[W+1]!=null||(j<0?D:D%ae[O-j-1]),k=S<4?(F||k)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||k||S==6&&(N>0?j>0?D/ae[O-j]:0:G[W-1])%10&1||S==(b.s<0?8:7)),R<1||!G[0])return G.length=0,k?(R-=b.e+1,G[0]=ae[(u-R%u)%u],b.e=-R||0):G[0]=b.e=0,b;if(N==0?(G.length=W,H=1,W--):(G.length=W+1,H=ae[u-N],G[W]=j>0?o(D/ae[O-j]%ae[j])*H:0),k)for(;;)if(W==0){for(N=1,j=G[0];j>=10;j/=10,N++);for(j=G[0]+=H,H=1;j>=10;j/=10,H++);N!=H&&(b.e++,G[0]==l&&(G[0]=1));break}else{if(G[W]+=H,G[W]!=l)break;G[W--]=0,H=1}for(N=G.length;G[--N]===0;G.pop());}b.e>Ee?b.c=b.e=null:b.e<bt&&(b.c=[b.e=0])}return b}function J(b){var R,S=b.e;return S===null?b.toString():(R=C(b.c),R=S<=se||S>=be?M(R,S):I(R,S,"0"),b.s<0?"-"+R:R)}return B.absoluteValue=B.abs=function(){var b=new w(this);return b.s<0&&(b.s=1),b},B.comparedTo=function(b,R){return E(this,new w(b,R))},B.decimalPlaces=B.dp=function(b,R){var S,k,O,N=this;if(b!=null)return y(b,0,f),R==null?R=Q:y(R,0,8),K(new w(N),b+N.e+1,R);if(!(S=N.c))return null;if(k=((O=S.length-1)-p(this.e/u))*u,O=S[O])for(;O%10==0;O/=10,k--);return k<0&&(k=0),k},B.dividedBy=B.div=function(b,R){return P(this,new w(b,R),X,Q)},B.dividedToIntegerBy=B.idiv=function(b,R){return P(this,new w(b,R),0,1)},B.exponentiatedBy=B.pow=function(b,R){var S,k,O,N,j,H,D,W,F,G=this;if(b=new w(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+J(b));if(R!=null&&(R=new w(R)),H=b.e>14,!G.c||!G.c[0]||G.c[0]==1&&!G.e&&G.c.length==1||!b.c||!b.c[0])return F=new w(Math.pow(+J(G),H?b.s*(2-T(b)):+J(b))),R?F.mod(R):F;if(D=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new w(NaN);k=!D&&G.isInteger()&&R.isInteger(),k&&(G=G.mod(R))}else{if(b.e>9&&(G.e>0||G.e<-1||(G.e==0?G.c[0]>1||H&&G.c[1]>=24e7:G.c[0]<8e13||H&&G.c[0]<=9999975e7)))return N=G.s<0&&T(b)?-0:0,G.e>-1&&(N=1/N),new w(D?1/N:N);On&&(N=i(On/u+2))}for(H?(S=new w(.5),D&&(b.s=1),W=T(b)):(O=Math.abs(+J(b)),W=O%2),F=new w(Z);;){if(W){if(F=F.times(G),!F.c)break;N?F.c.length>N&&(F.c.length=N):k&&(F=F.mod(R))}if(O){if(O=o(O/2),O===0)break;W=O%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)W=T(b);else{if(O=+J(b),O===0)break;W=O%2}G=G.times(G),N?G.c&&G.c.length>N&&(G.c.length=N):k&&(G=G.mod(R))}return k?F:(D&&(F=Z.div(F)),R?F.mod(R):N?K(F,On,Q,j):F)},B.integerValue=function(b){var R=new w(this);return b==null?b=Q:y(b,0,8),K(R,R.e+1,b)},B.isEqualTo=B.eq=function(b,R){return E(this,new w(b,R))===0},B.isFinite=function(){return!!this.c},B.isGreaterThan=B.gt=function(b,R){return E(this,new w(b,R))>0},B.isGreaterThanOrEqualTo=B.gte=function(b,R){return(R=E(this,new w(b,R)))===1||R===0},B.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},B.isLessThan=B.lt=function(b,R){return E(this,new w(b,R))<0},B.isLessThanOrEqualTo=B.lte=function(b,R){return(R=E(this,new w(b,R)))===-1||R===0},B.isNaN=function(){return!this.s},B.isNegative=function(){return this.s<0},B.isPositive=function(){return this.s>0},B.isZero=function(){return!!this.c&&this.c[0]==0},B.minus=function(b,R){var S,k,O,N,j=this,H=j.s;if(b=new w(b,R),R=b.s,!H||!R)return new w(NaN);if(H!=R)return b.s=-R,j.plus(b);var D=j.e/u,W=b.e/u,F=j.c,G=b.c;if(!D||!W){if(!F||!G)return F?(b.s=-R,b):new w(G?j:NaN);if(!F[0]||!G[0])return G[0]?(b.s=-R,b):new w(F[0]?j:Q==3?-0:0)}if(D=p(D),W=p(W),F=F.slice(),H=D-W){for((N=H<0)?(H=-H,O=F):(W=D,O=G),O.reverse(),R=H;R--;O.push(0));O.reverse()}else for(k=(N=(H=F.length)<(R=G.length))?H:R,H=R=0;R<k;R++)if(F[R]!=G[R]){N=F[R]<G[R];break}if(N&&(O=F,F=G,G=O,b.s=-b.s),R=(k=G.length)-(S=F.length),R>0)for(;R--;F[S++]=0);for(R=l-1;k>H;){if(F[--k]<G[k]){for(S=k;S&&!F[--S];F[S]=R);--F[S],F[k]+=l}F[k]-=G[k]}for(;F[0]==0;F.splice(0,1),--W);return F[0]?U(b,F,W):(b.s=Q==3?-1:1,b.c=[b.e=0],b)},B.modulo=B.mod=function(b,R){var S,k,O=this;return b=new w(b,R),!O.c||!b.s||b.c&&!b.c[0]?new w(NaN):!b.c||O.c&&!O.c[0]?new w(O):(lt==9?(k=b.s,b.s=1,S=P(O,b,0,3),b.s=k,S.s*=k):S=P(O,b,0,lt),b=O.minus(S.times(b)),!b.c[0]&&lt==1&&(b.s=O.s),b)},B.multipliedBy=B.times=function(b,R){var S,k,O,N,j,H,D,W,F,G,ae,ce,_e,Be,qe,Me=this,Ue=Me.c,At=(b=new w(b,R)).c;if(!Ue||!At||!Ue[0]||!At[0])return!Me.s||!b.s||Ue&&!Ue[0]&&!At||At&&!At[0]&&!Ue?b.c=b.e=b.s=null:(b.s*=Me.s,!Ue||!At?b.c=b.e=null:(b.c=[0],b.e=0)),b;for(k=p(Me.e/u)+p(b.e/u),b.s*=Me.s,D=Ue.length,G=At.length,D<G&&(_e=Ue,Ue=At,At=_e,O=D,D=G,G=O),O=D+G,_e=[];O--;_e.push(0));for(Be=l,qe=d,O=G;--O>=0;){for(S=0,ae=At[O]%qe,ce=At[O]/qe|0,j=D,N=O+j;N>O;)W=Ue[--j]%qe,F=Ue[j]/qe|0,H=ce*W+F*ae,W=ae*W+H%qe*qe+_e[N]+S,S=(W/Be|0)+(H/qe|0)+ce*F,_e[N--]=W%Be;_e[N]=S}return S?++k:_e.splice(0,1),U(b,_e,k)},B.negated=function(){var b=new w(this);return b.s=-b.s||null,b},B.plus=function(b,R){var S,k=this,O=k.s;if(b=new w(b,R),R=b.s,!O||!R)return new w(NaN);if(O!=R)return b.s=-R,k.minus(b);var N=k.e/u,j=b.e/u,H=k.c,D=b.c;if(!N||!j){if(!H||!D)return new w(O/0);if(!H[0]||!D[0])return D[0]?b:new w(H[0]?k:O*0)}if(N=p(N),j=p(j),H=H.slice(),O=N-j){for(O>0?(j=N,S=D):(O=-O,S=H),S.reverse();O--;S.push(0));S.reverse()}for(O=H.length,R=D.length,O-R<0&&(S=D,D=H,H=S,R=O),O=0;R;)O=(H[--R]=H[R]+D[R]+O)/l|0,H[R]=l===H[R]?0:H[R]%l;return O&&(H=[O].concat(H),++j),U(b,H,j)},B.precision=B.sd=function(b,R){var S,k,O,N=this;if(b!=null&&b!==!!b)return y(b,1,f),R==null?R=Q:y(R,0,8),K(new w(N),b,R);if(!(S=N.c))return null;if(O=S.length-1,k=O*u+1,O=S[O]){for(;O%10==0;O/=10,k--);for(O=S[0];O>=10;O/=10,k++);}return b&&N.e+1>k&&(k=N.e+1),k},B.shiftedBy=function(b){return y(b,-9007199254740991,c),this.times("1e"+b)},B.squareRoot=B.sqrt=function(){var b,R,S,k,O,N=this,j=N.c,H=N.s,D=N.e,W=X+4,F=new w("0.5");if(H!==1||!j||!j[0])return new w(!H||H<0&&(!j||j[0])?NaN:j?N:1/0);if(H=Math.sqrt(+J(N)),H==0||H==1/0?(R=C(j),(R.length+D)%2==0&&(R+="0"),H=Math.sqrt(+R),D=p((D+1)/2)-(D<0||D%2),H==1/0?R="5e"+D:(R=H.toExponential(),R=R.slice(0,R.indexOf("e")+1)+D),S=new w(R)):S=new w(H+""),S.c[0]){for(D=S.e,H=D+W,H<3&&(H=0);;)if(O=S,S=F.times(O.plus(P(N,O,W,1))),C(O.c).slice(0,H)===(R=C(S.c)).slice(0,H))if(S.e<D&&--H,R=R.slice(H-3,H+1),R=="9999"||!k&&R=="4999"){if(!k&&(K(O,O.e+X+2,0),O.times(O).eq(N))){S=O;break}W+=4,H+=4,k=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(K(S,S.e+X+2,1),b=!S.times(S).eq(N));break}}return K(S,S.e+X+1,Q,b)},B.toExponential=function(b,R){return b!=null&&(y(b,0,f),b++),A(this,b,R,1)},B.toFixed=function(b,R){return b!=null&&(y(b,0,f),b=b+this.e+1),A(this,b,R)},B.toFormat=function(b,R,S){var k,O=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=ut;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if(k=O.toFixed(b,R),O.c){var N,j=k.split("."),H=+S.groupSize,D=+S.secondaryGroupSize,W=S.groupSeparator||"",F=j[0],G=j[1],ae=O.s<0,ce=ae?F.slice(1):F,_e=ce.length;if(D&&(N=H,H=D,D=N,_e-=N),H>0&&_e>0){for(N=_e%H||H,F=ce.substr(0,N);N<_e;N+=H)F+=W+ce.substr(N,H);D>0&&(F+=W+ce.slice(N)),ae&&(F="-"+F)}k=G?F+(S.decimalSeparator||"")+((D=+S.fractionGroupSize)?G.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):G):F}return(S.prefix||"")+k+(S.suffix||"")},B.toFraction=function(b){var R,S,k,O,N,j,H,D,W,F,G,ae,ce=this,_e=ce.c;if(b!=null&&(H=new w(b),!H.isInteger()&&(H.c||H.s!==1)||H.lt(Z)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+J(H));if(!_e)return new w(ce);for(R=new w(Z),W=S=new w(Z),k=D=new w(Z),ae=C(_e),N=R.e=ae.length-ce.e-1,R.c[0]=h[(j=N%u)<0?u+j:j],b=!b||H.comparedTo(R)>0?N>0?R:W:H,j=Ee,Ee=1/0,H=new w(ae),D.c[0]=0;F=P(H,R,0,1),O=S.plus(F.times(k)),O.comparedTo(b)!=1;)S=k,k=O,W=D.plus(F.times(O=W)),D=O,R=H.minus(F.times(O=R)),H=O;return O=P(b.minus(S),k,0,1),D=D.plus(O.times(W)),S=S.plus(O.times(k)),D.s=W.s=ce.s,N=N*2,G=P(W,k,N,Q).minus(ce).abs().comparedTo(P(D,S,N,Q).minus(ce).abs())<1?[W,k]:[D,S],Ee=j,G},B.toNumber=function(){return+J(this)},B.toPrecision=function(b,R){return b!=null&&y(b,1,f),A(this,b,R,2)},B.toString=function(b){var R,S=this,k=S.s,O=S.e;return O===null?k?(R="Infinity",k<0&&(R="-"+R)):R="NaN":(b==null?R=O<=se||O>=be?M(C(S.c),O):I(C(S.c),O,"0"):b===10&&v?(S=K(new w(S),X+O+1,Q),R=I(C(S.c),S.e,"0")):(y(b,2,m.length,"Base"),R=Y(I(C(S.c),O,"0"),10,b,k,!0)),k<0&&S.c[0]&&(R="-"+R)),R},B.valueOf=B.toJSON=function(){return J(this)},B._isBigNumber=!0,_!=null&&w.set(_),w}function p(_){var P=_|0;return _>0||_===P?P:P-1}function C(_){for(var P,Y,V=1,B=_.length,Z=_[0]+"";V<B;){for(P=_[V++]+"",Y=u-P.length;Y--;P="0"+P);Z+=P}for(B=Z.length;Z.charCodeAt(--B)===48;);return Z.slice(0,B+1||1)}function E(_,P){var Y,V,B=_.c,Z=P.c,X=_.s,Q=P.s,se=_.e,be=P.e;if(!X||!Q)return null;if(Y=B&&!B[0],V=Z&&!Z[0],Y||V)return Y?V?0:-Q:X;if(X!=Q)return X;if(Y=X<0,V=se==be,!B||!Z)return V?0:!B^Y?1:-1;if(!V)return se>be^Y?1:-1;for(Q=(se=B.length)<(be=Z.length)?se:be,X=0;X<Q;X++)if(B[X]!=Z[X])return B[X]>Z[X]^Y?1:-1;return se==be?0:se>be^Y?1:-1}function y(_,P,Y,V){if(_<P||_>Y||_!==o(_))throw Error(s+(V||"Argument")+(typeof _=="number"?_<P||_>Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(_))}function T(_){var P=_.c.length-1;return p(_.e/u)==P&&_.c[P]%2!=0}function M(_,P){return(_.length>1?_.charAt(0)+"."+_.slice(1):_)+(P<0?"e":"e+")+P}function I(_,P,Y){var V,B;if(P<0){for(B=Y+".";++P;B+=Y);_=B+_}else if(V=_.length,++P>V){for(B=Y,P-=V;--P;B+=Y);_+=B}else P<V&&(_=_.slice(0,P)+"."+_.slice(P));return _}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Lae)})(HL);var NL=HL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const zi=u_(),sle=a_(),ale=l_,lle=NL,Fn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Mg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:DL,decimalSuffixes:Lw}=zi.currentBytes(),c_={general:{scale:1024,suffixes:Lw},binary:{scale:1024,suffixes:DL},decimal:{scale:1e3,suffixes:Lw}};function ule(t,e={},n){if(typeof e=="string"&&(e=ale.parseFormat(e)),!sle.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=cle(t,e,n);return s=Ple(s,i),s=Ile(s,o),s}function cle(t,e,n){switch(e.output){case"currency":return e=Rc(e,zi.currentCurrencyDefaultFormat()),vle(t,e,zi);case"percent":return e=Rc(e,zi.currentPercentageDefaultFormat()),wle(t,e,zi,n);case"byte":return e=Rc(e,zi.currentByteDefaultFormat()),gle(t,e,zi,n);case"time":return e=Rc(e,zi.currentTimeDefaultFormat()),ple(t);case"ordinal":return e=Rc(e,zi.currentOrdinalDefaultFormat()),mle(t,e,zi);case"number":default:return _g({instance:t,providedFormat:e})}}function hle(t){let e=c_.decimal;return uy(t._value,e.suffixes,e.scale).suffix}function dle(t){let e=c_.binary;return uy(t._value,e.suffixes,e.scale).suffix}function fle(t){let e=c_.general;return uy(t._value,e.suffixes,e.scale).suffix}function uy(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function gle(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Mg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Lw,marker:"bd"},binary:{scale:1024,suffixes:s||DL,marker:"b"},decimal:{scale:1e3,suffixes:a||Lw,marker:"d"}}[i],{value:c,suffix:h}=uy(t._value,u.suffixes,u.scale);return`${_g({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function mle(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Mg,e),o=_g({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function ple(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function wle(t,e,n,r){let i=e.prefixSymbol,o=_g({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Mg,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function vle(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Mg,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=_g({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function yle({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Fn[e]?(a=r[e],t=t/Fn[e]):l>=Fn.trillion||n&&s(l/Fn.trillion)===1?(a=r.trillion,t=t/Fn.trillion):l<Fn.trillion&&l>=Fn.billion||n&&s(l/Fn.billion)===1?(a=r.billion,t=t/Fn.billion):l<Fn.billion&&l>=Fn.million||n&&s(l/Fn.million)===1?(a=r.million,t=t/Fn.million):(l<Fn.million&&l>=Fn.thousand||n&&s(l/Fn.thousand)===1)&&(a=r.thousand,t=t/Fn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function Cle({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Am(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function ble(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Am(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Am(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Am(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Am(e)}`),n}function Sle(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?ble(t,e):new lle(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function Rle(t,e,n,r,i,o){if(r===-1)return t;let s=Sle(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function Ele(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function Tle(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function Mle(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),Tle(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function _le(t,e){return t+e}function xle(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function Ple(t,e){return e+t}function Ile(t,e){return t+e}function _g({instance:t,providedFormat:e,state:n=zi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Mg,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,p=s.trimMantissa,C=s.thousandSeparated,E=s.spaceSeparated,y=s.negative,T=s.forceSign,M=s.exponential,I=s.roundingFunction,_="";if(d){let Y=yle({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:I,totalLength:a});o=Y.value,_+=Y.abbreviation,a&&(f=Y.mantissaPrecision)}if(M){let Y=Cle({value:o,characteristicPrecision:l});o=Y.value,_=Y.abbreviation+_}let P=Rle(o.toString(),o,g,f,p,I);return P=Ele(P,o,u,l),P=Mle(P,o,C,n,r),(d||M)&&(P=_le(P,_)),(T||o<0)&&(P=xle(P,o,y)),P}function Rc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var Ole=t=>({format:(...e)=>ule(...e,t),getByteUnit:(...e)=>fle(...e,t),getBinaryByteUnit:(...e)=>dle(...e,t),getDecimalByteUnit:(...e)=>hle(...e,t),formatOrDefault:Rc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ys=NL;function Ale(t,e,n){let r=new Ys(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ys(i),t._value=r.plus(i).toNumber(),t}function $L(t,e,n){let r=new Ys(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ys(i),t._value=r.minus(i).toNumber(),t}function Hle(t,e,n){let r=new Ys(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ys(i),t._value=r.times(i).toNumber(),t}function Nle(t,e,n){let r=new Ys(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ys(i),t._value=r.dividedBy(i).toNumber(),t}function Dle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function $le(t,e,n){let r=n(t._value);return $L(r,e,n),Math.abs(r._value)}var kle=t=>({add:(e,n)=>Ale(e,n,t),subtract:(e,n)=>$L(e,n,t),multiply:(e,n)=>Hle(e,n,t),divide:(e,n)=>Nle(e,n,t),set:(e,n)=>Dle(e,n,t),difference:(e,n)=>$le(e,n,t),BigNumber:Ys});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Lle="2.5.0",ss=u_(),Fle=a_(),Vle=ole(on),Ble=AL();let ml=Ole(on),zl=kle(on);const Wle=l_;class kL{constructor(e){this._value=e}clone(){return on(this._value)}format(e={}){return ml.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Wle.parseFormat(e)),e=ml.formatOrDefault(e,ss.currentCurrencyDefaultFormat()),e.output="currency",ml.format(this,e)}formatTime(e={}){return e.output="time",ml.format(this,e)}binaryByteUnits(){return ml.getBinaryByteUnit(this)}decimalByteUnits(){return ml.getDecimalByteUnit(this)}byteUnits(){return ml.getByteUnit(this)}difference(e){return zl.difference(this,e)}add(e){return zl.add(this,e)}subtract(e){return zl.subtract(this,e)}multiply(e){return zl.multiply(this,e)}divide(e){return zl.divide(this,e)}set(e){return zl.set(this,LL(e))}value(){return this._value}valueOf(){return this._value}}function LL(t){let e=t;return on.isNumbro(t)?e=t._value:typeof t=="string"?e=on.unformat(t):isNaN(t)&&(e=NaN),e}function on(t){return new kL(LL(t))}on.version=Lle;on.isNumbro=function(t){return t instanceof kL};on.language=ss.currentLanguage;on.registerLanguage=ss.registerLanguage;on.setLanguage=ss.setLanguage;on.languages=ss.languages;on.languageData=ss.languageData;on.zeroFormat=ss.setZeroFormat;on.defaultFormat=ss.currentDefaults;on.setDefaults=ss.setDefaults;on.defaultCurrencyFormat=ss.currentCurrencyDefaultFormat;on.validate=Fle.validate;on.loadLanguagesInNode=Vle.loadLanguagesInNode;on.unformat=Ble.unformat;on.BigNumber=zl.BigNumber;var jle=on,pl=Fae(jle);const Ule="numeric";function FL(t,e){if(Xn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!pl.languages()[r]){const o=r.replace("-",""),s=pl.allLanguages?pl.allLanguages[r]:pl[o];s&&pl.registerLanguage(s)}pl.setLanguage(r),t=pl(t).format(i||"0")}return t}function h_(t,e,n,r,i,o,s){let a=o;if(Xn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=FL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}ta(t,e,n,r,i,a,s)}h_.RENDERER_TYPE=Ule;const zle="password";function d_(t,e,n,r,i,o,s){ta.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),Au(e,u)}d_.RENDERER_TYPE=zle;const Yle="select";function f_(t,e,n,r,i,o,s){ta.apply(this,[t,e,n,r,i,o,s])}f_.RENDERER_TYPE=Yle;const Gle="time";function g_(t,e,n,r,i,o,s){ta.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}g_.RENDERER_TYPE=Gle;function Kle(){zr(Eh),zr(Tg),zr(i_),zr(r_),zr(s_),zr(n_),zr(h_),zr(d_),zr(f_),zr(ta),zr(g_)}const qle="autocomplete";function cy(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,UO(n,e)):UO(n,e)(this.source):e(!0)}cy.VALIDATOR_TYPE=qle;function UO(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function VL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Xle=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:VL},Symbol.toStringTag,{value:"Module"})),Jle="date";function m_(t,e){const n=fk(EL,this.instance);let r=t,i=!0;r==null&&(r="");let o=ee(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=ee(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=Zle(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}m_.VALIDATOR_TYPE=Jle;function Zle(t,e){const n=ee(VL(t)),r=ee(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const Qle="dropdown";function p_(t,e){cy.apply(this,[t,e])}p_.VALIDATOR_TYPE=Qle;const eue="numeric";function w_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Xn(t))}w_.VALIDATOR_TYPE=eue;const tue=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],nue="time";function v_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=ee(i,tue,!0).isValid()?ee(i):ee(i,n);let a=s.isValid(),l=ee(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}v_.VALIDATOR_TYPE=nue;function rue(){Xl(cy),Xl(p_),Xl(m_),Xl(w_),Xl(v_)}const iue="autocomplete",oue={CELL_TYPE:iue,editor:e_,renderer:Eh,validator:cy},sue="checkbox",aue={CELL_TYPE:sue,editor:RL,renderer:i_},lue="date";function BL(t,e,n,r,i,o,s){Eh.apply(this,[t,e,n,r,i,o,s])}BL.RENDERER_TYPE=lue;const uue="date",cue={CELL_TYPE:uue,editor:TL,renderer:BL,validator:m_},hue="dropdown",due={CELL_TYPE:hue,editor:ML,renderer:r_,validator:p_,filter:!1,strict:!0},fue="handsontable",gue={CELL_TYPE:fue,editor:QM,renderer:s_},mue="numeric",pue={CELL_TYPE:mue,editor:_L,renderer:h_,validator:w_,dataType:"number"},wue="password",vue={CELL_TYPE:wue,editor:xL,renderer:d_,copyable:!1},yue="select",Cue={CELL_TYPE:yue,editor:PL,renderer:f_},bue="time",Sue={CELL_TYPE:bue,editor:IL,renderer:g_,validator:v_};function Rue(){di(oue),di(aue),di(cue),di(due),di(gue),di(pue),di(vue),di(Cue),di(bL),di(Sue)}function Eue(t,e){WL(t,e),e.add(t)}function Tue(t,e,n){WL(t,e),e.set(t,n)}function WL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qu(t,e,n){return(e=Mue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mue(t){var e=_ue(t,"string");return typeof e=="symbol"?e:e+""}function _ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xu(t,e){return t.get(jL(t,e))}function jL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zO=new Map([["plugin",NQ],["cell-type",hL],["editor",dk],["renderer",Sk],["validator",Rk]]),UL=Symbol("mainSetting"),xue="base",Hm=[];let wl=null;var vl=new WeakMap,YO=new WeakSet;class Qe{static get PLUGIN_KEY(){return xue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){Eue(this,YO),qu(this,"eventManager",new Mi(this)),qu(this,"pluginName",null),qu(this,"pluginsInitializedCallbacks",[]),qu(this,"isPluginsReady",!1),qu(this,"enabled",!1),qu(this,"initialized",!1),Tue(this,vl,{}),os(this,"hot",e,{writable:!1}),wl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!zO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);zO.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Hm.push(o)}}if(wl||(wl=nT()),wl.indexOf(this.pluginName)>=0&&wl.splice(wl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),wl.length===0){if(Hm.length>0){const i=[`${Hm.join(`
`)}
`,"You have to import and register them manually."].join("");throw Hm.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||ke(n))&&r[UL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(ke(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){Xu(vl,this)[e]=Xu(vl,this)[e]||[];const i=Xu(vl,this)[e];this.hot.addHook(e,n,r),i.push(n),Xu(vl,this)[e]=i}removeHooks(e){x(Xu(vl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Xu(vl,this);Le(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){x(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=jL(YO,this,Pue).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Le(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function Pue(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function yl(t,e,n){return(e=Iue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iue(t){var e=Oue(t,"string");return typeof e=="symbol"?e:e+""}function Oue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let y_=class{constructor(e){yl(this,"hot",null),yl(this,"container",null),yl(this,"injected",!1),yl(this,"rows",[]),yl(this,"columns",[]),yl(this,"samples",null),yl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),x(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),x(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{x(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{x(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{x(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),x(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{x(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Nm(t,e,n){return(e=Aue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aue(t){var e=Hue(t,"string");return typeof e=="symbol"?e:e+""}function Hue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hy{static get SAMPLE_COUNT(){return 3}constructor(e){Nm(this,"samples",null),Nm(this,"dataFactory",null),Nm(this,"customSampleCount",null),Nm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:hy.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:ke(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${It(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function Nue(t,e){zL(t,e),e.add(t)}function mb(t,e,n){zL(t,e),e.set(t,n)}function zL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function od(t,e,n){return(e=Due(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Due(t){var e=$ue(t,"string");return typeof e=="symbol"?e:e+""}function $ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Da(t,e){return t.get(Ar(t,e))}function Fw(t,e,n){return t.set(Ar(t,e),n),n}function Ar(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutoColumnSizeSeed");const pb="autoColumnSize",kue=10,Lue="autoColumnSize";var C_=new WeakMap,Ec=new WeakMap,sh=new WeakMap,Yr=new WeakSet;class nf extends Qe{static get PLUGIN_KEY(){return pb}static get PLUGIN_PRIORITY(){return kue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Nue(this,Yr),od(this,"ghostTable",new y_(this.hot)),od(this,"samplesGenerator",new hy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),od(this,"inProgress",!1),od(this,"measuredColumns",0),od(this,"columnWidthsMap",new Qa),mb(this,C_,!1),mb(this,Ec,[]),mb(this,sh,[]),this.hot.columnIndexMapper.registerMap(Lue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Ar(Yr,this,GO).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[pb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ar(Yr,e,Bue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ar(Yr,e,Wue).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ar(Yr,e,Uue).call(e,...i)}),this.addHook("beforeRender",()=>Ar(Yr,this,Vue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Ar(Yr,this,jue).call(this)),super.enablePlugin()}updatePlugin(){Fw(sh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Ar(Yr,this,GO).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Ar(Yr,this,YL).call(this,s,o)}),this.ghostTable.columns.length&&(Ar(Yr,this,GL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Df(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+nf.CALCULATION_STEP,i)},e,n),r=r+nf.CALCULATION_STEP+1,r<i?o=Nf(s):(Df(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[pb];let n=nf.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return ke(e)&&(n=e.syncLimit,IE(n)?n=eT(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,nh))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Da(Ec,this).length;return(s-1<o||Da(Ec,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Da(Ec,this).push(i):Da(Ec,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Fue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||Ar(Yr,this,YL).call(this,n,e))}),this.ghostTable.columns.length&&(Ar(Yr,this,GL).call(this),this.ghostTable.clean())}function YL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function GL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function Vue(){this.calculateVisibleColumnsWidth(),this.inProgress||(Ar(Yr,this,Fue).call(this,Da(sh,this)),Fw(sh,this,[]))}function Bue(t,e){e||this.recalculateAllColumnsWidth()}function Wue(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Da(sh,this).push(...e)}function GO(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function jue(){Fw(Ec,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Fw(C_,this,!0)}function Uue(t){if(!Da(C_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Da(sh,this).push(...e)}const Ql={horizontal:"horizontal",vertical:"vertical"};function zue(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function Yue(t){const e={};return t===!0?(e.directions=Object.keys(Ql),e.autoInsertRow=!0):ke(t)?(le(t.autoInsertRow)?t.direction===Ql.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ql)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Gue(t,e){Kue(t,e),e.add(t)}function Kue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ju(t,e,n){return(e=que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function que(t){var e=Xue(t,"string");return typeof e=="symbol"?e:e+""}function Xue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutofillRange");ie.getSingleton().register("beforeAutofill");ie.getSingleton().register("afterAutofill");const KO="autofill",Jue=20,Zue=["fillHandle"],Que="insert_row_below",ece=200;var Zu=new WeakSet;class tce extends Qe{constructor(){super(...arguments),Gue(this,Zu),Ju(this,"addingStarted",!1),Ju(this,"mouseDownOnCellCorner",!1),Ju(this,"mouseDragOutside",!1),Ju(this,"handleDraggedCells",0),Ju(this,"directions",[]),Ju(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return KO}static get PLUGIN_PRIORITY(){return Jue}static get SETTING_KEYS(){return[KO,...Zue]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>sd(Zu,this,rce).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>sd(Zu,this,nce).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>sd(Zu,this,ice).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return x(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),x(a,c=>{const h=[];x(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=zue(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),p=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,g,p,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=C;const y=C;if(["up","left"].indexOf(c)>-1&&!(y.length===1&&y[0].length===0))if(E=[],c==="up"){const T=d.row-h.row+1,M=T%y.length;for(let I=0;I<T;I++)E.push(y[(I+(y.length-M))%y.length])}else{const T=d.col-h.col+1,M=T%y[0].length;for(let I=0;I<y.length;I++){E.push([]);for(let _=0;_<T;_++)E[I].push(y[I][(_+(y[I].length-M))%y[I].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,p,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Ql.vertical)&&this.directions.includes(Ql.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Ql.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Ql.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Que,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},ece)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Xt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Xt(s)||!Xt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ke(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Bn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+dn(this.hot.table),i=Bn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+rn(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>sd(Zu,this,oce).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>sd(Zu,this,sce).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Yue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function nce(){this.selectAdjacent()&&this.fillIn()}function rce(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function ice(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function oce(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function sce(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function ace(t,e){KL(t,e),e.add(t)}function qO(t,e,n){KL(t,e),e.set(t,n)}function KL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qu(t,e,n){return(e=lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lce(t){var e=uce(t,"string");return typeof e=="symbol"?e:e+""}function uce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qL(t,e,n){return t.set(Lo(t,e),n),n}function Vw(t,e){return t.get(Lo(t,e))}function Lo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wb="autoRowSize",cce=40,hce="autoRowSize";var Vf=new WeakMap,b_=new WeakMap,Es=new WeakSet;class rf extends Qe{static get PLUGIN_KEY(){return wb}static get PLUGIN_PRIORITY(){return cce}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),ace(this,Es),Qu(this,"headerHeight",null),Qu(this,"ghostTable",new y_(this.hot)),Qu(this,"samplesGenerator",new hy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Qu(this,"inProgress",!1),Qu(this,"measuredRows",0),Qu(this,"rowHeightsMap",new Qa),qO(this,Vf,[]),qO(this,b_,!1),this.hot.rowIndexMapper.registerMap(hce,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Lo(Es,this,XO).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[wb];return e===!0||ke(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lo(Es,e,gce).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lo(Es,e,mce).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lo(Es,e,wce).call(e,...i)}),this.addHook("beforeRender",()=>Lo(Es,this,fce).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>Lo(Es,this,pce).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Lo(Es,this,XO).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Df(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+rf.CALCULATION_STEP,i)},e,n),r=r+rf.CALCULATION_STEP+1,r<i?o=Nf(s):(Df(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[wb];let n=rf.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return ke(e)&&(n=e.syncLimit,IE(n)?n=eT(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function dce(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function fce(){this.calculateVisibleRowsHeight(),this.inProgress||(Lo(Es,this,dce).call(this,Vw(Vf,this)),qL(Vf,this,[]))}function XO(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function gce(t,e){e||this.recalculateAllRowsHeight()}function mce(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Vw(Vf,this).push(...e)}function pce(){this.recalculateAllRowsHeight(),qL(b_,this,!0)}function wce(t){if(!Vw(b_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Vw(Vf,this).push(...e)}const{getListWithInsertedItems:vce,getListWithRemovedItems:yce}=Gk("physicallyIndexed");class Cce extends Hu{constructor(){super(e=>e)}insert(e,n){const r=_T(this.indexedValues,n);this.indexedValues=vce(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=yce(this.indexedValues,e);this.indexedValues=MT(n,e),super.remove(e)}}const{getListWithInsertedItems:bce,getListWithRemovedItems:Sce}=Gk("physicallyIndexed");class Rce extends Hu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=bce(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=Sce(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Ece(t,e){Tce(t,e),e.add(t)}function Tce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mce(t,e,n){return(e=_ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ce(t){var e=xce(t,"string");return typeof e=="symbol"?e:e+""}function xce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JO="bindRowsWithHeaders",Ice=210,Oce="loose",ZO=new Map([["loose",Cce],["strict",Rce]]);var QO=new WeakSet;class Ace extends Qe{constructor(){super(...arguments),Ece(this,QO),Mce(this,"headerIndexes",null)}static get PLUGIN_KEY(){return JO}static get PLUGIN_PRIORITY(){return Ice}isEnabled(){return!!this.hot.getSettings()[JO]}enablePlugin(){var e;if(this.enabled)return;const n=(e=ZO.get(this.getSetting()))!==null&&e!==void 0?e:ZO.get(Oce);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>Pce(QO,this,Hce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Hce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Nce(t,e){XL(t,e),e.add(t)}function Dce(t,e,n){XL(t,e),e.set(t,n)}function XL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e1(t,e,n){return(e=$ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ce(t){var e=kce(t,"string");return typeof e=="symbol"?e:e+""}function kce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t1(t,e){return t.get(Nc(t,e))}function vb(t,e,n){return t.set(Nc(t,e),n),n}function Nc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zp="collapsibleColumns",Lce=290,Fce=["nestedHeaders"],Gc="collapsibleIndicator",n1=zp,r1=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var ec=new WeakMap,ad=new WeakSet;class Vce extends Qe{constructor(){super(...arguments),Nce(this,ad),e1(this,"nestedHeadersPlugin",null),e1(this,"headerStateManager",null),Dce(this,ec,null)}static get PLUGIN_KEY(){return zp}static get PLUGIN_PRIORITY(){return Lce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[zp,...Fce]}isEnabled(){return!!this.hot.getSettings()[zp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||it("You need to configure the Nested Headers plugin in order to use collapsible headers."),vb(ec,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Nc(ad,this,jce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Nc(ad,e,Uce).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Nc(ad,e,Bce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Nc(ad,this,Wce).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),vb(ec,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:n1,relativeToGroup:el,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(n1)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Gc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Gc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Gc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!r1.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=za(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;x(r,f=>{var g;let{row:p,col:C}=f;const{collapsible:E,isCollapsed:y}=(g=this.headerStateManager.getHeaderSettings(p,C))!==null&&g!==void 0?g:{};if(!E||y&&n==="collapse"||!y&&n==="expand")return i=!1,!1});const o=[],s=[];i&&x(r,f=>{let{row:g,col:p}=f;const{colspanCompensation:C,affectedColumns:E,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,g,p);C>0&&(s.push(...E),o.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=R$([...a,...s]):n==="expand"&&(l=za(a,f=>!s.includes(f)));const u=r1.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){x(o,f=>{f()});return}this.hot.batchExecution(()=>{x(s,f=>{t1(ec,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;C!==null&&E!==null&&this.hot.selectCell(C,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return t1(ec,this).getHiddenIndexes()}destroy(){vb(ec,this,null),super.destroy()}}function Bce(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Gc}`);if(Ou(e,[Ri("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,Gc),e.querySelector("div:first-child").appendChild(u)),pe(u,["collapsed","expanded"]),s?(q(u,"collapsed"),Ga(u,"+"),l&&Ce(e,...Ri(!1))):(q(u,"expanded"),Ga(u,"-"),l&&Ce(e,...Ri(!0))),l&&Ce(u,...Iu());else{var c;(c=u)===null||c===void 0||c.remove()}}function Wce(t,e){we(t.target,Gc)&&(we(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):we(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ai(t))}function jce(){this.updatePlugin()}function Uce(t,e){e||this.updatePlugin()}function Cl(t,e,n){return(e=zce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zce(t){var e=Yce(t,"string");return typeof e=="symbol"?e:e+""}function Yce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gce=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Kce=!1,qce=!0,Xce=!0;class Jce{constructor(e,n){Cl(this,"hot",void 0),Cl(this,"sortingStates",new ny),Cl(this,"sortEmptyCells",Kce),Cl(this,"indicator",qce),Cl(this,"headerAction",Xce),Cl(this,"compareFunctionFactory",void 0),Cl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){ke(e)&&Le(e,(n,r)=>{Gce.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return ke(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function JL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Xo:Xt(i)?Xt(o)?Xo:s&&t==="asc"?Kt:qt:Xt(o)?s&&t==="asc"?qt:Kt:isNaN(i)&&!isNaN(o)?t==="asc"?qt:Kt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Kt:qt:i>o?t==="asc"?qt:Kt:Xo}}const ZL="default";function Zce(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Xo;if(a){if(Xt(r))return t==="asc"?Kt:qt;if(Xt(i))return t==="asc"?qt:Kt}return isNaN(o)?qt:isNaN(s)?Kt:o<s?t==="asc"?Kt:qt:o>s?t==="asc"?qt:Kt:Xo}}const Qce="numeric";function ehe(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Xt(s),u=Xt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return qt;if(l===!1&&u)return Kt}return d===!1&&f?t==="asc"?Kt:qt:d&&f===!1?t==="asc"?qt:Kt:d===!1&&f===!1?JL(t,e,n)(s,a):c===i&&h===r?t==="asc"?Kt:qt:c===r&&h===i?t==="asc"?qt:Kt:Xo}}const the="checkbox";function nhe(t,e,n){return iF(t,e.dateFormat,n)}const rhe="date";function ihe(t,e,n){return iF(t,e.timeFormat,n)}const ohe="time",{register:xg,getItem:i1,hasItem:she}=co("sorting.compareFunctionFactory"),{register:QL,getItem:ahe}=co("sorting.mainSortComparator");function eF(t){return she(t)?i1(t):i1(ZL)}xg(the,ehe);xg(rhe,nhe);xg(ZL,JL);xg(Qce,Zce);xg(ohe,ihe);const Xo=0,Kt=-1,qt=1;function lhe(t,e){const n=ahe(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Bw="asc",Ww="desc",tF="colHeader";function uhe(t){if(ke(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Bw,Ww].includes(n)}function che(t){if(t.some(n=>uhe(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function o1(t){if(t!==Ww)return t===Bw?Ww:Bw}function nF(t){return t.querySelector(`.${tF}`)}function rF(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function S_(t,e,n){return t===-1&&e>=0&&Ka(n)===!1}function iF(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Xo;if(Xt(r))return Xt(i)?Xo:o&&t==="asc"?Kt:qt;if(Xt(i))return o&&t==="asc"?qt:Kt;const s=ee(r,e),a=ee(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Kt:qt:a.isBefore(s)?t==="asc"?qt:Kt:Xo:Kt:qt}}function hhe(t,e){it(gt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const dhe="ascending",fhe="descending",oF="indicatorDisabled",sF="columnSorting",aF="sortAction",lF=new Map([[Bw,dhe],[Ww,fhe]]);function ghe(t,e,n,r){const i=[sF];if(r&&i.push(aF),n===!1)return i.push(oF),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(lF.get(o)),i}function mhe(){return Array.from(lF.values()).concat(aF,oF,sF)}function phe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:eF(u.type))(l,u,d)(c,h)}(0)}}function whe(t,e){vhe(t,e),e.add(t)}function vhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dm(t,e,n){return(e=yhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yhe(t){var e=Che(t,"string");return typeof e=="symbol"?e:e+""}function Che(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jw="columnSorting",bhe=50,Uw="append",She="replace",s1=jw;QL(jw,phe);ie.getSingleton().register("beforeColumnSort");ie.getSingleton().register("afterColumnSort");const ld=new WeakMap;var Yl=new WeakSet;class uF extends Qe{constructor(){super(...arguments),whe(this,Yl),Dm(this,"columnStatesManager",null),Dm(this,"columnMetaCache",null),Dm(this,"pluginKey",jw),Dm(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return jw}static get PLUGIN_PRIORITY(){return bhe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(ld.has(this.hot)&&ld.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),hhe(ld.get(this.hot),this.pluginKey);return}this.enabled||(ld.set(this.hot,this.pluginKey),this.columnStatesManager=new Jce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Qa(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Tc(Yl,this,Rhe).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tc(Yl,e,The).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Tc(Yl,this,GR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tc(Yl,e,Ehe).call(e,...r)}),this.hot.view&&Tc(Yl,this,GR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=nF(r);rF(n,r)===!1||i===null||this.updateHeaderClasses(i)};ld.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:el,position:"before",group:s1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(s1)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Kk),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return che(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ke(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ke(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=o1(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:o1()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Uw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Lt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Uw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===She)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(ke(e)){const n=e[this.pluginKey];if(ke(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):dt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Ke(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ke(n,u=>u[0]);lhe(n,this.pluginKey,Ke(e,u=>u.sortOrder),Ke(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ke(n,u=>u[0]),a=new Map(Ke(o,(u,c)=>[u,s[c]])),l=Ke(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(ke(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||ke(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(pe(e,mhe()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,ghe(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&we(e.target,tF)}onAfterOnCellMouseDown(e,n){if(S_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function GR(){const t=this.getAllSavedSortSettings();if(ke(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Rhe(t,e){const n=nF(e);if(rF(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ce(e,...X8(s?`${s}ending`:"none"))}}function Ehe(t){t===!0&&this.hot.view&&Tc(Yl,this,GR).call(this)}function The(t,e,n,r){S_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function bl(t,e,n){return(e=Mhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mhe(t){var e=_he(t,"string");return typeof e=="symbol"?e:e+""}function _he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xhe{constructor(e,n){bl(this,"plugin",void 0),bl(this,"hot",void 0),bl(this,"endpoints",[]),bl(this,"settings",void 0),bl(this,"settingsType","array"),bl(this,"currentEndpoint",null),bl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),x(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();x(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;x(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?x(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):x(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){x(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];x(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),x(i,o=>{let s=[];x(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,x(e.ranges,r=>{x(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],x(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],x(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],x(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&x(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),x(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){it("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function yb(t){return t==null||isNaN(t)}function Phe(t,e){Ihe(t,e),e.add(t)}function Ihe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ohe(t,e,n){return(e=Ahe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ahe(t){var e=Hhe(t,"string");return typeof e=="symbol"?e:e+""}function Hhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $m(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Cb="columnSummary",Nhe=220;var ud=new WeakSet;class Dhe extends Qe{constructor(){super(...arguments),Phe(this,ud),Ohe(this,"endpoints",null)}static get PLUGIN_KEY(){return Cb}static get PLUGIN_PRIORITY(){return Nhe}isEnabled(){return!!this.hot.getSettings()[Cb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Cb],this.endpoints=new xhe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $m(ud,e,$he).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $m(ud,e,Lhe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $m(ud,e,khe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $m(ud,e,Fhe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Le(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=yb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Le(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=yb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=yb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Le(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(gt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function $he(){this.endpoints.initEndpoints()}function khe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Lhe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Fhe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Vhe(t,e){cF(t,e),e.add(t)}function bb(t,e,n){cF(t,e),e.set(t,n)}function cF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mc(t,e){return t.get(R_(t,e))}function KR(t,e,n){return t.set(R_(t,e),n),n}function R_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zw=new WeakMap,km=new WeakMap,Lm=new WeakMap,a1=new WeakSet;class hF{constructor(){Vhe(this,a1),bb(this,zw,!0),bb(this,km,null),bb(this,Lm,new ResizeObserver(e=>R_(a1,this,Bhe).call(this,e)))}setObservedElement(e){KR(km,this,e)}unobserve(){Mc(Lm,this).unobserve(Mc(km,this))}observe(){KR(zw,this,!0),Mc(Lm,this).observe(Mc(km,this))}destroy(){Mc(Lm,this).disconnect()}}function Bhe(t){if(Mc(zw,this)||!Array.isArray(t)||!t.length){KR(zw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}vt(hF,Wn);function Sl(t,e,n){Whe(t,e),e.set(t,n)}function Whe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yt(t,e){return t.get(dF(t,e))}function ws(t,e,n){return t.set(dF(t,e),n),n}function dF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rl=new WeakMap,Sb=new WeakMap,vs=new WeakMap,sa=new WeakMap,aa=new WeakMap,Fm=new WeakMap,tc=new WeakMap;class eu{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;Sl(this,Rl,void 0),Sl(this,Sb,!1),Sl(this,vs,null),Sl(this,sa,void 0),Sl(this,aa,void 0),Sl(this,Fm,!0),Sl(this,tc,new hF),ws(Rl,this,e),ws(Sb,this,n),ws(sa,this,this.createEditor()),ws(aa,this,yt(sa,this).style),yt(tc,this).setObservedElement(this.getInputElement()),yt(tc,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){yt(aa,this).left=`${e}px`,yt(aa,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:rn(this.getInputElement()),height:dn(this.getInputElement())}}observeSize(){yt(tc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){yt(aa,this).display="block",ws(Fm,this,!1)}hide(){yt(tc,this).unobserve(),yt(Fm,this)||(yt(aa,this).display="none"),ws(Fm,this,!0)}isVisible(){return yt(aa,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return yt(Rl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=yt(Rl,this).createElement("div"),n=yt(Rl,this).createElement("textarea");return e.style.display="none",ws(vs,this,yt(Rl,this).createElement("div")),yt(vs,this).setAttribute("dir",yt(Sb,this)?"rtl":"ltr"),q(yt(vs,this),eu.CLASS_EDITOR_CONTAINER),yt(Rl,this).body.appendChild(yt(vs,this)),q(e,eu.CLASS_EDITOR),q(n,eu.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),yt(vs,this).appendChild(e),e}getInputElement(){return yt(sa,this).querySelector(`.${eu.CLASS_INPUT}`)}getEditorElement(){return yt(sa,this)}destroy(){const e=yt(vs,this)?yt(vs,this).parentNode:null;yt(sa,this).parentNode.removeChild(yt(sa,this)),ws(sa,this,null),ws(aa,this,null),yt(tc,this).destroy(),e&&e.removeChild(yt(vs,this))}}vt(eu,Wn);function Rb(t,e,n){return(e=jhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jhe(t){var e=Uhe(t,"string");return typeof e=="symbol"?e:e+""}function Uhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zhe=250,Yhe=250;class fF{constructor(e){Rb(this,"wasLastActionShow",!0),Rb(this,"showDebounced",null),Rb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Yhe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zhe;this.showDebounced=wg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}vt(fF,Wn);function Ghe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Khe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function El(t,e){const n={};return x(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Ca(t,e,n,r,i){x(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&qhe(s,a,e,n,r,i)})})}function qhe(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Ghe(s.className,r):a=Khe(s.className,r)),o(t,e,"className",a)}function gF(t){return`<span class="selected">✓</span>${t}`}function Yp(t,e){let n=!1;return Array.isArray(t)&&x(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function dy(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Ve="---------";function Xhe(){return{name:Ve}}const mi="alignment";function Jhe(){return{key:mi,name(){return this.getTranslatedPhrase(ZT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${mi}:left`,name(){return this.getTranslatedPhrase(QT)},callback(){const t=this.getSelectedRange(),e=El(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:center`,name(){return this.getTranslatedPhrase(eM)},callback(){const t=this.getSelectedRange(),e=El(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:right`,name(){return this.getTranslatedPhrase(tM)},callback(){const t=this.getSelectedRange(),e=El(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:justify`,name(){return this.getTranslatedPhrase(nM)},callback(){const t=this.getSelectedRange(),e=El(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Ve},{key:`${mi}:top`,name(){return this.getTranslatedPhrase(rM)},callback(){const t=this.getSelectedRange(),e=El(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:middle`,name(){return this.getTranslatedPhrase(iM)},callback(){const t=this.getSelectedRange(),e=El(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:bottom`,name(){return this.getTranslatedPhrase(oM)},callback(){const t=this.getSelectedRange(),e=El(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const fy="clear_column";function Zhe(){return{key:fy,name(){return this.getTranslatedPhrase(LT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Pg="col_left";function Qhe(){return{key:Pg,name(){return this.getTranslatedPhrase(AT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Ig="col_right";function ede(){return{key:Ig,name(){return this.getTranslatedPhrase(HT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Og="make_read_only";function tde(){return{key:Og,checkable:!0,ariaChecked(){return Yp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Nw)},name(){let t=this.getTranslatedPhrase(Nw);return Yp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=gF(t)),t},callback(){const t=this.getSelectedRange(),e=Yp(t,(n,r)=>this.getCellMeta(n,r).readOnly);x(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const gy="redo";function nde(){return{key:gy,name(){return this.getTranslatedPhrase(kT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Ag="remove_col";function rde(){return{key:Ag,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(DT,e)},callback(){this.alter("remove_col",Vie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const my="remove_row";function ide(){return{key:my,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(NT,e)},callback(){this.alter("remove_row",Bie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const py="row_above";function ode(){return{key:py,name(){return this.getTranslatedPhrase(IT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const wy="row_below";function sde(){return{key:wy,name(){return this.getTranslatedPhrase(OT)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Bf="no_items";function ade(){return{key:Bf,name(){return this.getTranslatedPhrase(PT)},disabled:!0,isCommand:!1}}const vy="undo";function lde(){return{key:vy,name(){return this.getTranslatedPhrase($T)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const ude=[py,wy,Pg,Ig,fy,my,Ag,vy,gy,Og,mi,Ve,Bf],cde={[Ve]:Xhe,[Bf]:ade,[py]:ode,[wy]:sde,[Pg]:Qhe,[Ig]:ede,[fy]:Zhe,[my]:ide,[Ag]:rde,[vy]:lde,[gy]:nde,[Og]:tde,[mi]:Jhe};function mF(){const t={};return Le(cde,(e,n)=>{t[n]=e()}),t}function hde(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(qT):this.getTranslatedPhrase(KT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function dde(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(XT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function fde(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(JT);return Yp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Gp))?gF(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Gp);t.updateCommentMeta(n,r,{[Gp]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function gde(t,e){pF(t,e),e.add(t)}function nc(t,e,n){pF(t,e),e.set(t,n)}function pF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mde(t,e,n){return(e=pde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pde(t){var e=wde(t,"string");return typeof e=="symbol"?e:e+""}function wde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $a(t,e,n){return t.set(Mr(t,e),n),n}function De(t,e){return t.get(Mr(t,e))}function Mr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yw="comments",vde=60,Ps="comment",jd="value",wF="style",Gp="readOnly",cd=Yw,qR=`plugin:${Yw}`;var pt=new WeakMap,No=new WeakMap,yy=new WeakMap,Kp=new WeakMap,XR=new WeakMap,Gw=new WeakMap,Fr=new WeakSet;class yde extends Qe{constructor(){super(...arguments),gde(this,Fr),mde(this,"range",{}),nc(this,pt,null),nc(this,No,null),nc(this,yy,!1),nc(this,Kp,!1),nc(this,XR,null),nc(this,Gw,"")}static get PLUGIN_KEY(){return Yw}static get PLUGIN_PRIORITY(){return vde}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Yw]}enablePlugin(){var e=this;this.enabled||(De(pt,this)||($a(pt,this,new eu(this.hot.rootDocument,this.hot.isRtl())),De(pt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Mr(Fr,e,_de).call(e,...r)})),De(No,this)||$a(No,this,new fF(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Mr(Fr,this,Ede).call(this,n,a)),this.addHook("afterScroll",()=>Mr(Fr,this,xde).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Mr(Fr,this,l1).call(this,n)),this.addHook("beforeCompositionStart",n=>Mr(Fr,this,l1).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Mr(Fr,e,Pde).call(e,...r)}),De(No,this).addLocalHook("hide",()=>this.hide()),De(No,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){De(No,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(qR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();$a(Kp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(qR),this.hot._registerTimeout(()=>{$a(Kp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:cd}),r.addShortcut({keys:[["Escape"]],callback:()=>{De(pt,this).setValue(De(Gw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>De(pt,this).isVisible()&&De(pt,this).isFocused(),group:cd}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>De(pt,this).isVisible()&&De(pt,this).isFocused(),group:cd}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{De(pt,this).setValue(De(pt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:cd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cd)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Mr(Fr,this,Sde).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Mr(Fr,this,Cde).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Mr(Fr,this,Rde).call(this)),this.eventManager.addEventListener(n,"focus",()=>Mr(Fr,this,Mde).call(this)),this.eventManager.addEventListener(n,"blur",()=>Mr(Fr,this,Tde).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Mr(Fr,this,bde).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Ya(e.target,"TD","TBODY");return!!(n&&we(n,"htCommentCell")&&Ya(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=De(pt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[jd]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ps),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,jd)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,jd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return De(No,this).cancelHiding(),De(pt,this).setValue((e=i[Ps]?i[Ps][jd]:null)!==null&&e!==void 0?e:""),De(pt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){De(pt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!De(pt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;De(pt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),p=this.getCommentMeta(i,o,wF);p?De(pt,this).setSize(p.width,p.height):De(pt,this).resetSize();const C=c?0:f.getColumnWidth(a),E=l&&!u?dn(g):0,{left:y,top:T,width:M,height:I}=g.getBoundingClientRect(),{width:_,height:P}=De(pt,this).getSize(),{innerWidth:Y,innerHeight:V}=this.hot.rootWindow,B=this.hot.rootDocument.documentElement,Z=In(this.hot.rootDocument),X=FE(this.hot.rootWindow)?Z:0,Q=VE(this.hot.rootWindow)?Z:0;let se=y+h.scrollX+C,be=T+h.scrollY+E;this.hot.isRtl()&&(se-=_+C),this.hot.isLtr()&&y+M+_>Y-X?se=y+h.scrollX-_-1:this.hot.isRtl()&&se<-(B.scrollWidth-B.clientWidth)&&(se=y+h.scrollX+C+1),T+P>V-Q&&(be-=P-I+1),De(pt,this).setPosition(se,be),De(pt,this).setReadOnlyState(this.getCommentMeta(i,o,Gp)),De(pt,this).observeSize()}focusEditor(){De(pt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Ps];let o;i?(o=nr(i),yg(o,r)):o=r,this.hot.setCellMeta(e,n,Ps,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Ps])return i[Ps][r]}addToContextMenu(e){e.items.push({name:Ve},hde(this),dde(this),fde(this))}getEditorInputElement(){return De(pt,this).getInputElement()}destroy(){var e,n;(e=De(pt,this))===null||e===void 0||e.destroy(),(n=De(No,this))===null||n===void 0||n.destroy(),super.destroy()}}function Cde(t){if(!(!this.hot.view||!this.hot.view._wt)&&!De(yy,this)&&!this.targetIsCommentTextArea(t)){const e=Ya(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function bde(t){t.stopPropagation()}function Sde(t){const{rootDocument:e}=this.hot;if(!(De(yy,this)||De(pt,this).isFocused()||we(t.target,"wtBorder")||De(XR,this)===t.target||!De(pt,this)))if($a(XR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));De(No,this).show(n)}else Va(t.target,e)&&!this.targetIsCommentTextArea(t)&&De(No,this).hide()}function Rde(){$a(yy,this,!1)}function Ede(t,e){e[Ps]&&e[Ps][jd]&&q(t,e.commentedCellClassName)}function Tde(){$a(Gw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Mde(){$a(Gw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(qR)}function _de(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[wF]:{width:t,height:e}})}function l1(t){De(pt,this).isFocused()&&Ai(t)}function xde(){De(Kp,this)||this.hide()}function Pde(){const t=De(pt,this).getEditorElement();pe(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function Eb(t,e,n){return(e=Ide(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ide(t){var e=Ode(t,"string");return typeof e=="symbol"?e:e+""}function Ode(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vF{constructor(e){Eb(this,"hot",void 0),Eb(this,"commands",{}),Eb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Ade(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||cn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),x(u,c=>c.apply(this.hot,r))}}function Ade(t,e){let n;return x(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Tb(t,e,n){return(e=Hde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hde(t){var e=Nde(t,"string");return typeof e=="symbol"?e:e+""}function Nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Tb(this,"hot",void 0),Tb(this,"predefinedItems",mF()),Tb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Le(e,(r,i)=>{let o="";r.name===Ve?(n[Ve]=r,o=Ve):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Dde(e,this.defaultOrderPattern,this.predefinedItems)}}function Dde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),ke(i)?Le(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),ke(o)?fn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):x(i,(o,s)=>{let a=n[o];!a&&ude.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),ke(o)&&fn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function la(t,e,n){return(e=$de(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $de(t){var e=kde(t,"string");return typeof e=="symbol"?e:e+""}function kde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lde{constructor(e,n){la(this,"top",void 0),la(this,"topRelative",void 0),la(this,"left",void 0),la(this,"leftRelative",void 0),la(this,"scrollTop",void 0),la(this,"scrollLeft",void 0),la(this,"cellHeight",void 0),la(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function hd(t,e,n){Fde(t,e),e.set(t,n)}function Fde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ae(t,e){return t.get(CF(t,e))}function Vm(t,e,n){return t.set(CF(t,e),n),n}function CF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sr=new WeakMap,Sr=new WeakMap,Rr=new WeakMap,Mb=new WeakMap,rc=new WeakMap;class Vde{constructor(e){hd(this,sr,void 0),hd(this,Sr,void 0),hd(this,Rr,void 0),hd(this,Mb,!1),hd(this,rc,{above:0,below:0,left:0,right:0}),Vm(Mb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ae(rc,this)[e]=n,this}setElement(e){return Vm(sr,this,e),this}setParentElement(e){return Vm(Sr,this,e),this}updatePosition(e){Vm(Rr,this,new Lde(e,Ae(sr,this).ownerDocument.defaultView)),Ae(Mb,this)?(Ae(Rr,this).fitsBelow(Ae(sr,this))?this.setPositionBelowCursor():Ae(Rr,this).fitsAbove(Ae(sr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ae(sr,this).dir==="rtl"?Ae(Rr,this).fitsOnLeft(Ae(sr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ae(Rr,this).fitsOnRight(Ae(sr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ae(rc,this).above+Ae(Rr,this).top-Ae(sr,this).offsetHeight;if(Ae(Sr,this)){const r=Ae(Sr,this).ownerDocument.defaultView.getComputedStyle(Ae(Sr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ae(Rr,this).top+Ae(Rr,this).cellHeight-Ae(sr,this).scrollHeight+i+o}Ae(sr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Ae(rc,this).below+Ae(Rr,this).top+1;if(Ae(Sr,this)){const r=Ae(Sr,this).ownerDocument.defaultView.getComputedStyle(Ae(Sr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ae(Rr,this).top-i-o-1}Ae(sr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ae(Rr,this).left;if(Ae(Sr,this)){const n=Ae(Sr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ae(Sr,this).querySelector(".htCore")).borderRightWidth,10);e+=Ae(Rr,this).cellWidth+r}else e+=Ae(rc,this).right;Ae(sr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ae(rc,this).left+Ae(Rr,this).left-Ae(sr,this).offsetWidth;if(Ae(Sr,this)){const n=Ae(Sr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ae(Sr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Ae(sr,this).style.left=`${e}px`}}function bF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Xe(e,-1,g()-1);function a(C,E){const y=g()-1;return C<0&&(C=y),C>y&&(C=0),o.has(C)?-1:(o.add(C),r(C,!1)===!1&&(C=a(E===1?++C:--C,E)),C)}function l(C){C>-1&&C<g()&&r(C,!0)!==!1&&(s=C)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function p(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:p}}function Bde(t){return Ke(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function JR(t){return cn(t,"submenu")}function ZR(t){return new RegExp(Ve,"i").test(t.name)}function qp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function u1(t){return cn(t,"disableSelection")}function Wde(t){return we(t,"htSeparator")}function jde(t){return we(t,"htSubmenu")}function Ude(t){return we(t,"htDisabled")}function zde(t){return we(t,"htSelectionDisabled")}function Yde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function SF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Gde(t,e){let n=t.slice(0);return n.reverse(),n=SF(n,e),n.reverse(),n}function Kde(t){const e=[];return x(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function qde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ve,n=t.slice(0);return n=SF(n,e),n=Gde(n,e),n=Kde(n),n}function Xde(t){return t.checkable===!0}function Jde(t){return bF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Wde(r)||Ude(r)||zde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Zde(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const RF="menu",c1=RF;function Qde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Zde(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:RF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${c1}:${u}`:c1}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function efe(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Qo(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!qp(a,t)&&!u1(a)&&!ZR(a);Ce(n,[...Xde(a)?[B8(),Of(c),O$(h)]:[V8(),Of(u)],...d?[Pu(-1)]:[],...qp(a,t)?[K8()]:[],...JR(a)?[Ri(!1)]:[]])}n.className="",n.appendChild(l),ZR(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Au(l,u),qp(a,t)?q(n,"htDisabled"):u1(a)?q(n,"htSelectionDisabled"):JR(a)&&q(n,"htSubmenu")}}function _b(t,e,n){tfe(t,e),e.set(t,n)}function tfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bo(t,e,n){return(e=nfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nfe(t){var e=rfe(t,"string");return typeof e=="symbol"?e:e+""}function rfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xb(t,e,n){return t.set(EF(t,e),n),n}function Tl(t,e){return t.get(EF(t,e))}function EF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const h1=215;var dd=new WeakMap,Bm=new WeakMap,Wm=new WeakMap;class Th{get tableBorderWidth(){return Tl(Wm,this)===void 0&&this.hotMenu&&xb(Wm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Tl(Wm,this)}constructor(e,n){var r=this;bo(this,"hot",void 0),bo(this,"options",void 0),bo(this,"eventManager",new Mi(this)),bo(this,"container",void 0),bo(this,"positioner",void 0),bo(this,"hotMenu",null),bo(this,"hotSubMenus",{}),bo(this,"parentMenu",void 0),bo(this,"menuItems",null),bo(this,"origOutsideClickDeselects",null),_b(this,dd,void 0),_b(this,Bm,void 0),_b(this,Wm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:h1,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Vde(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=du(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Tl(dd,this)}getKeyboardShortcutsCtrl(){return Tl(Bm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=wg(a=>this.openSubMenu(a),300),n=this.options.minWidth||h1;let r=!1,i=za(this.menuItems,a=>(a.key===Bf&&(r=!0),Yde(a,this.hot)));if(i.length<1&&!r)i.push(mF()[Bf]);else if(i.length===0)return;i=qde(i,Ve);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:efe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Tl(dd,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),TR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!TR()||!Ka(a))&&o&&this.hasSelectedItem()&&(Go()||KE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),xb(dd,this,Jde(this.hotMenu)),xb(Bm,this,Qde(this)),Tl(Bm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Tl(dd,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ce(r,[Ri(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!jde(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Th(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ce(n,[Ri(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ce(i,[Ri(!1)])}}closeAllSubMenus(){x(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Bde(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||ZR(e)||qp(e,this.hot)||JR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=Tn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?dn(this.hotMenu.getCell(c,0)):0;return l+(u.name===Ve?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(dt(r)&&(r=r.call(this.hot),r===null||Lt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ce(this.hotMenu.rootElement,[F8(),Pu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Va(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Va(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&we(e.target,"htCore")&&Va(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}vt(Th,Wn);function ife(t,e){ofe(t,e),e.add(t)}function ofe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e,n){return(e=sfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sfe(t){var e=afe(t,"string");return typeof e=="symbol"?e:e+""}function afe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ud="contextMenu",lfe=70,d1=Ud;ie.getSingleton().register("afterContextMenuDefaultOptions");ie.getSingleton().register("beforeContextMenuShow");ie.getSingleton().register("afterContextMenuShow");ie.getSingleton().register("afterContextMenuHide");ie.getSingleton().register("afterContextMenuExecute");var fd=new WeakSet;class Cy extends Qe{constructor(){super(...arguments),ife(this,fd),Pb(this,"commandExecutor",new vF(this.hot)),Pb(this,"itemsFactory",null),Pb(this,"menu",null)}static get PLUGIN_KEY(){return Ud}static get PLUGIN_PRIORITY(){return lfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[py,wy,Ve,Pg,Ig,Ve,my,Ag,Ve,vy,gy,Ve,Og,Ve,mi]}isEnabled(){return!!this.hot.getSettings()[Ud]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Ud];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Th(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>jm(fd,this,cfe).call(this)),this.menu.addLocalHook("afterOpen",()=>jm(fd,this,hfe).call(this)),this.menu.addLocalHook("afterClose",()=>jm(fd,this,dfe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>jm(fd,this,ufe).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=dy(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:d1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(d1)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Le(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new yF(this.hot,Cy.DEFAULT_ITEMS);const e=this.hot.getSettings()[Ud],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),x(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function ufe(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),we(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(we(o,"current")&&we(o,"wtBorder"))))return;const s=dy(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function cfe(){this.hot.runHooks("beforeContextMenuShow",this)}function hfe(){this.hot.runHooks("afterContextMenuShow",this)}function dfe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Cy.SEPARATOR={name:Ve};function ffe(t){return{key:"copy",name(){return this.getTranslatedPhrase(FT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function gfe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Xe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(WT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function mfe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Xe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(BT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function pfe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Xe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(VT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function wfe(t){return{key:"cut",name(){return this.getTranslatedPhrase(jT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class vfe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class yfe{constructor(){this.clipboardData=new vfe}preventDefault(){}composedPath(){return[]}}function Cfe(t,e){TF(t,e),e.add(t)}function ic(t,e,n){TF(t,e),e.set(t,n)}function TF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ur(t,e){return t.get(Dc(t,e))}function oc(t,e,n){return t.set(Dc(t,e),n),n}function Dc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ua=new WeakMap,Ib=new WeakMap,gd=new WeakMap,QR=new WeakMap,e0=new WeakMap,md=new WeakMap,pd=new WeakSet;class bfe{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Cfe(this,pd),ic(this,ua,void 0),ic(this,Ib,void 0),ic(this,gd,void 0),ic(this,QR,void 0),ic(this,e0,void 0),ic(this,md,void 0),oc(Ib,this,n),oc(gd,this,r),oc(QR,this,i),oc(e0,this,o),oc(md,this,s)}setSelectedRange(e){oc(ua,this,e)}getCellsRange(){if(ur(Ib,this).call(this)===0||ur(gd,this).call(this)===0)return null;const{row:e,col:n}=ur(ua,this).getTopStartCorner(),{row:r,col:i}=ur(ua,this).getBottomEndCorner(),o=Dc(pd,this,Sfe).call(this,e,r),s=Dc(pd,this,Ob).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(ur(gd,this).call(this)===0||ur(md,this).call(this)===0)return null;const{col:e}=ur(ua,this).getTopStartCorner(),{col:n}=ur(ua,this).getBottomEndCorner(),r=Dc(pd,this,Ob).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(ur(gd,this).call(this)===0||ur(md,this).call(this)===0)return null;const{col:e}=ur(ua,this).getTopStartCorner(),{col:n}=ur(ua,this).getBottomEndCorner(),r=Dc(pd,this,Ob).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-ur(md,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Ob(t,e){return Math.min(e,Math.max(t+ur(e0,this).call(this)-1,t))}function Sfe(t,e){return Math.min(e,Math.max(t+ur(QR,this).call(this)-1,t))}function MF(t){const e=[],n=[];return x(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Rfe(t,e){_F(t,e),e.add(t)}function ca(t,e,n){_F(t,e),e.set(t,n)}function _F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wd(t,e,n){return(e=Efe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Efe(t){var e=Tfe(t,"string");return typeof e=="symbol"?e:e+""}function Tfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Or(t,e){return t.get(Hr(t,e))}function ji(t,e,n){return t.set(Hr(t,e),n),n}function Hr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterCopyLimit");ie.getSingleton().register("modifyCopyableRange");ie.getSingleton().register("beforeCut");ie.getSingleton().register("afterCut");ie.getSingleton().register("beforePaste");ie.getSingleton().register("afterPaste");ie.getSingleton().register("beforeCopy");ie.getSingleton().register("afterCopy");const Ab="copyPaste",Mfe=80,_fe=["fragmentSelection"],f1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var t0=new WeakMap,n0=new WeakMap,r0=new WeakMap,sc=new WeakMap,Um=new WeakMap,zm=new WeakMap,ac=new WeakMap,Kw=new WeakMap,Gr=new WeakSet;class xfe extends Qe{constructor(){super(...arguments),Rfe(this,Gr),wd(this,"columnsLimit",1/0),wd(this,"rowsLimit",1/0),wd(this,"pasteMode","overwrite"),wd(this,"uiContainer",this.hot.rootDocument.body),ca(this,t0,!1),ca(this,n0,!1),ca(this,r0,!1),ca(this,sc,"cells-only"),ca(this,Um,!1),ca(this,zm,!1),ca(this,ac,new bfe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),ca(this,Kw,!1),wd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Ab}static get SETTING_KEYS(){return[Ab,..._fe]}static get PLUGIN_PRIORITY(){return Mfe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Ab]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),ji(t0,this,this.getSetting("copyColumnHeaders")),ji(n0,this,this.getSetting("copyColumnGroupHeaders")),ji(r0,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Hr(Gr,this,Ofe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Hr(Gr,r,Afe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Hr(Gr,this,Hfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),$f()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Hr(Gr,r,Nfe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Hr(Gr,r,Dfe).call(r,...o)}),this.addHook("afterSelection",()=>Hr(Gr,this,$fe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ji(sc,this,e),ji(Um,this,!0),Hr(Gr,this,g1).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ji(zm,this,!0),Hr(Gr,this,g1).call(this,"cut")}getRangedCopyableData(e){return tf(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=MF(e);return x(r,o=>{const s=[];x(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new yfe;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Or(ac,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Or(sc,this)==="column-headers-only"?n.set("headers",Or(ac,this).getMostBottomColumnHeadersRange()):(Or(sc,this)==="with-column-headers"?n.set("headers",Or(ac,this).getMostBottomColumnHeadersRange()):Or(sc,this)==="with-column-group-headers"&&n.set("headers",Or(ac,this).getAllColumnHeadersRange()),n.set("cells",Or(ac,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:p}=this.hot.getCellMeta(c,a);if(c=p+1,g===!0)continue;d=p,h=a;const C=[],E=o.length%r;for(;C.length<i||h<=u;){const{skipColumnOnPaste:y,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,y===!0)continue;f=T;const M=C.length%i;C.push(e[E][M])}o.push(C)}return ji(Kw,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Or(Um,this)||this.isEditorOpened()||qo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Jd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ji(Um,this,!1);const o=this.getRangedData(this.copyableRanges),s=Hr(Gr,this,Pfe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=tf(o);if(e&&e.clipboardData){const u=OR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[f1,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}ji(sc,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Or(zm,this)||this.isEditorOpened()||qo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Jd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ji(zm,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=tf(o);if(e&&e.clipboardData){const l=OR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[f1,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||qo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Jd(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Bv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=vk(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Yie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function g1(t){if($f()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&U$(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Pfe(t){const{rows:e}=MF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Ife(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&WE(r)}}}function xF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&jE(r)}}}function Ofe(t){t.items.push({name:"---------"},ffe(this)),Or(t0,this)&&t.items.push(pfe(this)),Or(n0,this)&&t.items.push(mfe(this)),Or(r0,this)&&t.items.push(gfe(this)),t.items.push(wfe(this))}function Afe(t,e,n,r,i){Or(Kw,this)&&(i.value=!0),ji(Kw,this,!1)}function Hfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Nfe(){Hr(Gr,this,xF).call(this)}function Dfe(){Hr(Gr,this,Ife).call(this)}function $fe(){Hr(Gr,this,xF).call(this)}function PF(t,e){return`border_row${t}col${e}`}function zd(){return{width:1,color:"#000"}}function Ls(){return{hide:!0}}function kfe(){return{width:1,color:"#000",cornerVisible:!1}}function Hb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function vd(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Nb(t,e){return{id:PF(t,e),border:kfe(),row:t,col:e,top:Ls(),bottom:Ls(),start:Ls(),end:Ls()}}function Lfe(t,e){return cn(e,"border")&&e.border&&(t.border=e.border),cn(e,"top")&&le(e.top)&&(e.top?(ke(e.top)||(e.top=zd()),t.top=e.top):(e.top=Ls(),t.top=e.top)),cn(e,"bottom")&&le(e.bottom)&&(e.bottom?(ke(e.bottom)||(e.bottom=zd()),t.bottom=e.bottom):(e.bottom=Ls(),t.bottom=e.bottom)),cn(e,"start")&&le(e.start)&&(e.start?(ke(e.start)||(e.start=zd()),t.start=e.start):(e.start=Ls(),t.start=e.start)),cn(e,"end")&&le(e.end)&&(e.end?(ke(e.end)||(e.end=zd()),t.end=e.end):(e.end=Ls(),t.end=e.end)),t}function Gs(t,e){let n=!1;return x(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!cn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function by(t){return`<span class="selected">✓</span>${t}`}function Ffe(t){return t.some(e=>le(e.left)||le(e.right))}function Vfe(t){return t.some(e=>le(e.start)||le(e.end))}const Bfe=new Map([["left","start"],["right","end"]]);function Wfe(t){var e;return(e=Bfe.get(t))!==null&&e!==void 0?e:t}function jfe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(uM);return Gs(this,"bottom")&&(e=by(e)),e},callback(e,n){const r=Gs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function Ufe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(cM);return Gs(this,e)&&(n=by(n)),n},callback(n,r){const i=Gs(this,e);t.prepareBorder(r,e,i)}}}function zfe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(hM)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Gs(this)}}}function Yfe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(lM);return Gs(this,e)&&(n=by(n)),n},callback(n,r){const i=Gs(this,e);t.prepareBorder(r,e,i)}}}function Gfe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(aM);return Gs(this,"top")&&(e=by(e)),e},callback(e,n){const r=Gs(this,"top");t.prepareBorder(n,"top",r)}}}function Kfe(t,e){qfe(t,e),e.add(t)}function qfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xfe(t,e,n){return(e=Jfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jfe(t){var e=Zfe(t,"string");return typeof e=="symbol"?e:e+""}function Zfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xp="customBorders",Qfe=90;var Db=new WeakSet;class ege extends Qe{constructor(){super(...arguments),Kfe(this,Db),Xfe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Xp}static get PLUGIN_PRIORITY(){return Qfe}isEnabled(){return!!this.hot.getSettings()[Xp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>m1(Db,this,tge).call(this,e)),this.addHook("init",()=>m1(Db,this,nge).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Hb(n));const o=rh(e),s=Ff(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});x(e,a=>{s(a).forAll((l,u)=>{x(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Wfe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=rh(e),r=Ff(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return x(e,o=>{r(o).forAll((s,a)=>{x(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(vd(l))})})}),i}clearBorders(e){e?this.setBorders(e):(x(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Nb(e,n);r&&(a=Lfe(a,r),x(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",vd(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=Nb(o,s);let l=0;o===e.from.row&&cn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&cn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&cn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&cn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",vd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=PF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Nb(e,n):o=Hb(o),i?(o[r]=Ls(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",vd(o)))):(o[r]=zd(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",vd(o)))}prepareBorder(e,n,r){x(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){x(e,n=>{const r=Hb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Tn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ke(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){x(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){x(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ke(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):x(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return x(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return x(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):x(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);x(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Xp];if(Array.isArray(e)){const n=nr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Ffe(e),r=Vfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function tge(t){this.hot.getSettings()[Xp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(sM)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Gfe(this),Yfe(this),jfe(this),Ufe(this),zfe(this)]}})}function nge(){this.changeBorderSettings()}function rge(t,e){ige(t,e),e.add(t)}function ige(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $b(t,e,n){return(e=oge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oge(t){var e=sge(t,"string");return typeof e=="symbol"?e:e+""}function sge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function p1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const w1="dragToScroll",age=100;var kb=new WeakSet;class lge extends Qe{constructor(){super(...arguments),rge(this,kb),$b(this,"boundaries",null),$b(this,"callback",null),$b(this,"listening",!1)}static get PLUGIN_KEY(){return w1}static get PLUGIN_PRIORITY(){return age}isEnabled(){return!!this.hot.getSettings()[w1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>p1(kb,this,v1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>p1(kb,this,v1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=du(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function v1(t){if(Ka(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function uge(t,e){IF(t,e),e.add(t)}function cge(t,e,n){IF(t,e),e.set(t,n)}function IF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lb(t,e,n){return(e=hge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hge(t){var e=dge(t,"string");return typeof e=="symbol"?e:e+""}function dge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fge(t,e){return t.get(pi(t,e))}function OF(t,e,n){return t.set(pi(t,e),n),n}function pi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterDropdownMenuDefaultOptions");ie.getSingleton().register("beforeDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuHide");ie.getSingleton().register("afterDropdownMenuExecute");const Jp="dropdownMenu",gge=230,Wf="changeType",Fb=Jp;var Sy=new WeakMap,Yi=new WeakSet;class Ry extends Qe{static get PLUGIN_KEY(){return Jp}static get PLUGIN_PRIORITY(){return gge}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Pg,Ig,Ve,Ag,Ve,fy,Ve,Og,Ve,mi]}constructor(e){super(e),uge(this,Yi),Lb(this,"commandExecutor",new vF(this.hot)),Lb(this,"itemsFactory",null),Lb(this,"menu",null),cge(this,Sy,!1),this.hot.addHook("afterGetColHeader",(n,r)=>pi(Yi,this,pge).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Jp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new yF(this.hot,Ry.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pi(Yi,e,Sge).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return pi(Yi,e,bge).call(e,...o)});const n=this.hot.getSettings()[Jp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Th(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>pi(Yi,this,wge).call(this)),this.menu.addLocalHook("afterOpen",()=>pi(Yi,this,vge).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>pi(Yi,this,yge).call(this,o)),this.menu.addLocalHook("afterClose",()=>pi(Yi,this,Cge).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),x(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=dy(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Wf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Fb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Fb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Fb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>pi(Yi,this,mge).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Le(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function AF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function mge(t){if(we(t.target,Wf)){const e=dy(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),OF(Sy,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function pge(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Wf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Wf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ce(s,[Iu(),Of(" ")]),Ce(e,[x$("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function wge(){this.hot.runHooks("beforeDropdownMenuShow",this)}function vge(){this.hot.runHooks("afterDropdownMenuShow",this),pi(Yi,this,AF).call(this,this.menu)}function yge(t){pi(Yi,this,AF).call(this,t)}function Cge(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function bge(t){return fge(Sy,this)?null:t}function Sge(t){we(t.target,Wf)&&OF(Sy,this,!0)}Ry.SEPARATOR={name:Ve};function y1(t,e,n){return(e=Rge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rge(t){var e=Ege(t,"string");return typeof e=="symbol"?e:e+""}function Ege(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tge{constructor(e){y1(this,"hot",void 0),y1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function C1(t,e,n){return(e=Mge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mge(t){var e=_ge(t,"string");return typeof e=="symbol"?e:e+""}function _ge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){C1(this,"dataProvider",void 0),C1(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=ao(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=fn(ao(E_.DEFAULT_OPTIONS),n),n=fn(n,e),n.filename=OE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function xge(t,e){Pge(t,e),e.add(t)}function Pge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const HF="\r",Ige='"',Oge=`
`,Age="=",Hge="+",Nge="-",Dge="@",$ge="	";var Vb=new WeakSet;class kge extends E_{constructor(){super(...arguments),xge(this,Vb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Ke(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),x(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=It(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=b1(Vb,this,Fge).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=b1(Vb,this,Lge).call(this,i)),(n||i.indexOf(HF)>=0||i.indexOf(Ige)>=0||i.indexOf(Oge)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Lge(t){return t.startsWith(Age)||t.startsWith(Hge)||t.startsWith(Nge)||t.startsWith(Dge)||t.startsWith($ge)||t.startsWith(HF)?`'${t}`:t}function Fge(t,e){return e.test(t)?`'${t}`:t}const Vge="csv",i0={[Vge]:kge};function Bge(t,e,n){return typeof i0[t]=="function"?new i0[t](e,n):null}const Wge="exportFile",jge=240;class Uge extends Qe{static get PLUGIN_KEY(){return Wge}static get PLUGIN_PRIORITY(){return jge}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!i0[e])throw new Error(`Export format type "${e}" is not supported.`);return Bge(e,new Tge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function lc(t,e,n){return(e=zge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zge(t){var e=Yge(t,"string");return typeof e=="symbol"?e:e+""}function Yge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hg{constructor(e,n){let{id:r,stateless:i=!0}=n;lc(this,"hot",void 0),lc(this,"id",void 0),lc(this,"elements",[]),lc(this,"hidden",!1),lc(this,"stateId",""),lc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new ny)}getElements(){return this.elements}reset(){x(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),x(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}vt(Hg,Wn);const jf={};function qa(t,e){if(!jf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=jf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function tu(t){if(!jf[t])throw Error(`Filter condition "${t}" does not exist.`);return jf[t].descriptor}function pn(t,e,n){n.key=t,jf[t]={condition:e,descriptor:n}}const Dn="none";function Gge(){return!0}pn(Dn,Gge,{name:ry,inputsCount:0,showOperators:!1});const of="empty";function Kge(t){return Xt(t.value)}pn(of,Kge,{name:vM,inputsCount:0,showOperators:!0});const Zp="not_empty";function qge(t,e){return!qa(of,e)(t)}pn(Zp,qge,{name:yM,inputsCount:0,showOperators:!0});const sf="eq";function Xge(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale)===It(n)}pn(sf,Xge,{name:CM,inputsCount:1,showOperators:!0});const Qp="neq";function Jge(t,e){return!qa(sf,e)(t)}pn(Qp,Jge,{name:bM,inputsCount:1,showOperators:!0});const NF="gt";function Zge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}pn(NF,Zge,{name:MM,inputsCount:1,showOperators:!0});const DF="gte";function Qge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}pn(DF,Qge,{name:_M,inputsCount:1,showOperators:!0});const $F="lt";function eme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}pn($F,eme,{name:xM,inputsCount:1,showOperators:!0});const kF="lte";function tme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}pn(kF,tme,{name:PM,inputsCount:1,showOperators:!0});const T_="date_after";function nme(t,e){let[n]=e;const r=ee(t.value,t.meta.dateFormat),i=ee(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}pn(T_,nme,{name:AM,inputsCount:1,showOperators:!0});const M_="date_before";function rme(t,e){let[n]=e;const r=ee(t.value,t.meta.dateFormat),i=ee(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}pn(M_,rme,{name:HM,inputsCount:1,showOperators:!0});const qw="between";function ime(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=qa(M_,[o]),a=qa(T_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}pn(qw,ime,{name:IM,inputsCount:2,showOperators:!0});const LF="not_between";function ome(t,e){return!qa(qw,e)(t)}pn(LF,ome,{name:OM,inputsCount:2,showOperators:!0});const FF="begins_with";function sme(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).startsWith(It(n))}pn(FF,sme,{name:SM,inputsCount:1,showOperators:!0});const VF="ends_with";function ame(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).endsWith(It(n))}pn(VF,ame,{name:RM,inputsCount:1,showOperators:!0});const __="contains";function lme(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).indexOf(It(n))>=0}pn(__,lme,{name:EM,inputsCount:1,showOperators:!0});const BF="not_contains";function ume(t,e){return!qa(__,e)(t)}pn(BF,ume,{name:TM,inputsCount:1,showOperators:!0});const WF="date_tomorrow";function cme(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}pn(WF,cme,{name:DM,inputsCount:0});const jF="date_today";function hme(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().startOf("day"),"d"):!1}pn(jF,hme,{name:NM,inputsCount:0});const UF="date_yesterday";function dme(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}pn(UF,dme,{name:$M,inputsCount:0});ek();function fme(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Ng(t){const e=new Set(t);return function(n){return e.has(n)}}function x_(t){return t??""}function o0(t){return Array.from(new Set(t)).map(e=>x_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function S1(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Ng(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:fme(a,n)};r&&r(u),i.push(u)}),i}const nu="by_value";function gme(t,e){let[n]=e;return n(t.value)}pn(nu,gme,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Ng(e)]},showOperators:!1});const Uf={};function mme(t){if(!Uf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Uf[t].func;return function(n,r){return e(n,r)}}function pme(t){return Uf[t].name}function P_(t,e,n){Uf[t]={name:e,func:n}}const ja="conjunction",wme=FM;function vme(t,e){return t.every(n=>n.func(e))}P_(ja,wme,vme);const Xw="disjunction",yme=iy;function Cme(t,e){return t.some(n=>n.func(e))}P_(Xw,yme,Cme);const I_="disjunctionWithExtraCondition",bme=iy;function Sme(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}P_(I_,bme,Sme);const Rme="numeric",zF="text",Eme="date",R1={[Rme]:[Dn,Ve,of,Zp,Ve,sf,Qp,Ve,NF,DF,$F,kF,qw,LF],[zF]:[Dn,Ve,of,Zp,Ve,sf,Qp,Ve,FF,VF,Ve,__,BF],[Eme]:[Dn,Ve,of,Zp,Ve,sf,Qp,Ve,M_,T_,qw,Ve,WF,jF,UF]};function Tme(t){const e=[];let n=t;return R1[n]||(n=zF),x(R1[n],r=>{let i;r===Ve?i={name:Ve}:i=ao(tu(r)),e.push(i)}),e}function yd(t,e,n){return(e=Mme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mme(t){var e=_me(t,"string");return typeof e=="symbol"?e:e+""}function _me(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Bb="built",Wb="building",E1=["click","input","keydown","keypress","keyup","focus","blur","change"];let io=class YF{static get DEFAULTS(){return ao({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){yd(this,"hot",void 0),yd(this,"eventManager",new Mi(this)),yd(this,"options",void 0),yd(this,"_element",void 0),yd(this,"buildState",void 0),this.hot=e,this.options=fn(YF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Wb?this._element:this.buildState===Bb?(this.update(),this._element):(this.buildState=Wb,this.build(),this.buildState=Bb,this._element)}isBuilt(){return this.buildState===Bb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(wr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Wb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)x(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Le(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),x(E1,r=>e(n,r))}else x(E1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};vt(io,Wn);function xme(t,e){GF(t,e),e.add(t)}function Pme(t,e,n){GF(t,e),e.set(t,n)}function GF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ym(t,e){return t.get(O_(t,e))}function Ime(t,e,n){return t.set(O_(t,e),n),n}function O_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uc=new WeakMap,T1=new WeakSet;class Ua extends io{static get DEFAULTS(){return ao({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,fn(Ua.DEFAULTS,n)),xme(this,T1),Pme(this,uc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>O_(T1,this,Ome).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Ime(uc,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ym(uc,this).type=this.options.type,Ym(uc,this).placeholder=this.translateIfPossible(this.options.placeholder),Ym(uc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Ym(uc,this).focus()}}function Ome(t){this.options.value=t.target.value}function Ame(t,e){KF(t,e),e.add(t)}function Cd(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cc(t,e,n){return t.set(af(t,e),n),n}function jt(t,e){return t.get(af(t,e))}function af(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mn=new WeakMap,Gm=new WeakMap,Km=new WeakMap,jb=new WeakMap,qm=new WeakMap,Xm=new WeakSet;class zf extends io{static get DEFAULTS(){return ao({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,fn(zf.DEFAULTS,n)),Ame(this,Xm),Cd(this,Mn,null),Cd(this,Gm,[]),Cd(this,Km,void 0),Cd(this,jb,void 0),Cd(this,qm,void 0),this.registerHooks()}getMenu(){return jt(Mn,this)}registerHooks(){this.addLocalHook("click",()=>af(Xm,this,Dme).call(this))}setItems(e){cc(Gm,this,this.translateNames(e)),jt(Mn,this)&&jt(Mn,this).setMenuItems(jt(Gm,this))}translateNames(e){return x(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),cc(Mn,this,new Th(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),jt(Mn,this).setMenuItems(jt(Gm,this));const e=new io(this.hot,{className:"htUISelectCaption"}),n=new io(this.hot,{className:"htUISelectDropdown"});cc(Km,this,e),cc(jb,this,e.element),cc(qm,this,n),this.hot.getSettings().ariaTags&&(Ce(n.element,[Iu()]),Ce(this._element,[_$()])),x([e,n],r=>this._element.appendChild(r.element)),jt(Mn,this).addLocalHook("select",r=>af(Xm,this,Hme).call(this,r)),jt(Mn,this).addLocalHook("afterClose",()=>af(Xm,this,Nme).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=jt(Mn,this).hot.getTranslatedPhrase(ry),jt(jb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();jt(Mn,this)&&(jt(Mn,this).open(),jt(Mn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),jt(Mn,this).getNavigator().toFirstItem(),jt(Mn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){jt(Mn,this)&&jt(Mn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){jt(Mn,this)&&(jt(Mn,this).destroy(),cc(Mn,this,null)),jt(Km,this)&&jt(Km,this).destroy(),jt(qm,this)&&jt(qm,this).destroy(),super.destroy()}}function Hme(t){t.name!==Ve&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Nme(){this.runLocalHooks("afterClose")}function Dme(){this.openOptions()}function $me(t,e){kme(t,e),e.add(t)}function kme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M1(t,e,n){return(e=Lme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lme(t){var e=Fme(t,"string");return typeof e=="symbol"?e:e+""}function Fme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ub=new WeakSet;class s0 extends Hg{constructor(e,n){super(e,{id:n.id,stateless:!1}),$me(this,Ub),M1(this,"name",""),M1(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new zf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Ua(this.hot,{placeholder:zM})),this.elements.push(new Ua(this.hot,{placeholder:YM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>_1(Ub,this,Vme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),x(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>_1(Ub,this,Bme).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=ao(e.command);n.name.startsWith(Jt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),x(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||tu(Dn),n=[];return x(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=tu(e?e.name:Dn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||x(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof zf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ua)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||x(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[tu(Dn)];if(e!==null){const{visualIndex:r}=e;n=Tme(this.hot.getDataType(0,r,this.hot.countRows(),r))}x(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Vme(t){x(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Bme(t){Ch(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ai(t))}function x1(t,e,n){Wme(t,e),e.set(t,n)}function Wme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bd(t,e){return t.get(qF(t,e))}function P1(t,e,n){return t.set(qF(t,e),n),n}function qF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hc=new WeakMap,zb=new WeakMap;class Jw extends io{static get DEFAULTS(){return ao({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,fn(Jw.DEFAULTS,n)),x1(this,hc,void 0),x1(this,zb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),P1(zb,this,e),P1(hc,this,this._element.firstChild),bd(hc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(bd(zb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?bd(hc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(bd(hc,this).checked=e)}focus(){this.isBuilt()&&bd(hc,this).focus()}}function jme(t,e){Ume(t,e),e.add(t)}function Ume(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zme(t,e,n){return(e=Yme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yme(t){var e=Gme(t,"string");return typeof e=="symbol"?e:e+""}function Gme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const I1=0;var O1=new WeakSet;class qme extends Hg{constructor(e,n){super(e,{id:n.id,stateless:!1}),jme(this,O1),zme(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),x(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ja,Xw];x(e,n=>{const r=new Jw(this.hot,{name:"operator",label:{htmlFor:n,textContent:pme(n)},value:n,checked:n===e[I1],id:n});r.addLocalHook("change",i=>Kme(O1,this,Xme).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(gt`Radio button with index ${e} doesn't exist.`);x(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Jw&&n.isChecked());return e?e.getValue():ja}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&x(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ja,n=arguments.length>1?arguments[1]:void 0,r=e;r===I_&&(r=Xw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(I1)}}function Xme(t){this.setState(t.target.value)}function Jme(t,e,n){Zme(t,e),e.set(t,n)}function Zme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yb(t,e){return t.get(XF(t,e))}function Qme(t,e,n){return t.set(XF(t,e),n),n}function XF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sd=new WeakMap;class Yf extends io{static get DEFAULTS(){return ao({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,fn(Yf.DEFAULTS,n)),Jme(this,Sd,void 0)}build(){super.build(),Qme(Sd,this,this._element.firstChild)}update(){this.isBuilt()&&(Yb(Sd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Yb(Sd,this).focus()}activate(){Yb(Sd,this).click()}}function epe(t,e){JF(t,e),e.add(t)}function dc(t,e,n){JF(t,e),e.set(t,n)}function JF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get($c(t,e))}function Fi(t,e,n){return t.set($c(t,e),n),n}function $c(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const A1="multipleSelect.itemBox";var Gi=new WeakMap,en=new WeakMap,Gb=new WeakMap,ys=new WeakMap,ha=new WeakMap,da=new WeakMap,Rd=new WeakSet;class Gf extends io{static get DEFAULTS(){return ao({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,fn(Gf.DEFAULTS,n)),epe(this,Rd),dc(this,Gi,[]),dc(this,en,void 0),dc(this,Gb,void 0),dc(this,ys,void 0),dc(this,ha,void 0),dc(this,da,void 0),Fi(ys,this,new Ua(this.hot,{placeholder:UM,className:"htUIMultipleSelectSearch"})),Fi(ha,this,new Yf(this.hot,{textContent:VM,className:"htUISelectAll"})),Fi(da,this,new Yf(this.hot,{textContent:BM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Pe(en,this)}registerHooks(){Pe(ys,this).addLocalHook("keydown",e=>$c(Rd,this,npe).call(this,e)),Pe(ys,this).addLocalHook("input",e=>$c(Rd,this,tpe).call(this,e)),Pe(ha,this).addLocalHook("click",e=>$c(Rd,this,rpe).call(this,e)),Pe(da,this).addLocalHook("click",e=>$c(Rd,this,ipe).call(this,e))}setItems(e){var n;Fi(Gi,this,e),(n=Pe(en,this))===null||n===void 0||n.loadData(Pe(Gi,this))}setLocale(e){Fi(Gb,this,e)}getLocale(){return Pe(Gb,this)}getItems(){return[...Pe(Gi,this)]}getValue(){return spe(Pe(Gi,this))}getSearchInputElement(){return Pe(ys,this)}getSelectAllElement(){return Pe(ha,this)}getClearAllElement(){return Pe(da,this)}isSelectedAllValues(){return Pe(Gi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new io(this.hot,{className:"htUISelectionControls",children:[Pe(ha,this),Pe(da,this)]});this._element.appendChild(Pe(ys,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Pe(en,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),Fi(en,this,new this.hot.constructor(o,{data:Pe(Gi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Pe(en,this).listen()},modifyColWidth:u=>{const c=Pe(en,this).container.scrollWidth-In(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Pe(en,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Pe(en,this).useTheme(u)});const l=Pe(en,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:A1}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Pe(en,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:A1})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Pe(en,this).listen()}reset(){Pe(ys,this).reset(),Pe(ha,this).reset(),Pe(da,this).reset()}update(){this.isBuilt()&&(Pe(en,this).loadData(ope(Pe(Gi,this),this.options.value)),super.update())}destroy(){var e;(e=Pe(en,this))===null||e===void 0||e.destroy(),Pe(ys,this).destroy(),Pe(da,this).destroy(),Pe(ha,this).destroy(),Fi(ys,this,null),Fi(da,this,null),Fi(ha,this,null),Fi(en,this,null),Fi(Gi,this,null),super.destroy()}}function tpe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Pe(Gi,this)]:n=Pe(Gi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Pe(en,this).loadData(n)}function npe(t){this.runLocalHooks("keydown",t,this),UE(Ch,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ai(t),Pe(en,this).listen(),Pe(en,this).selectCell(0,0))}function rpe(t){const e=[];t.preventDefault(),Pe(en,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(bT(n,r)[0])}),Pe(en,this).setSourceDataAtCell(e)}function ipe(t){const e=[];t.preventDefault(),Pe(en,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(bT(n,r)[0])}),Pe(en,this).setSourceDataAtCell(e)}function ope(t,e){const n=Ng(e);return t.map(r=>(r.checked=n(r.value),r))}function spe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function ape(t,e){lpe(t,e),e.add(t)}function lpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function upe(t,e,n){return(e=cpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cpe(t){var e=hpe(t,"string");return typeof e=="symbol"?e:e+""}function hpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ed=new WeakSet;class dpe extends Hg{constructor(e,n){super(e,{id:n.id,stateless:!1}),ape(this,Ed),upe(this,"name",""),this.name=n.name,this.elements.push(new Gf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Jm(Ed,this,fpe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Jm(Ed,this,gpe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===nu){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Dn:nu},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=za(i,h=>h.name===nu),u={},c=this.hot.getTranslatedPhrase(Dw);if(l){const h=s(r,a),d=Ke(h,y=>y.value),f=new Map(h.map(y=>[y.value,this.hot.getCellMeta(y.meta.visualRow,y.meta.visualCol)])),g=o0(d);o&&(l.args[0]=o);const p=[],C=S1(g,l.args[0],c,y=>{y.checked&&p.push(y.value),Jm(Ed,this,H1).call(this,y,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[p],u.command=tu(nu),u.itemsSnapshot=C}else u.args=[],u.command=tu(Dn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Gf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||x(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Dw),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=o0(r),s=S1(o,o,e,l=>{Jm(Ed,this,H1).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ke(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:x_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function fpe(t){Ch(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ai(t))}function H1(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function gpe(t,e){switch(e.type){case"numeric":return FL(t,e);default:return t}}var ZF;function mpe(t,e){ppe(t,e),e.add(t)}function ppe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wpe(t,e,n){return(e=vpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vpe(t){var e=ype(t,"string");return typeof e=="symbol"?e:e+""}function ype(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cpe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var N1=new WeakSet;class Kf extends Hg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),mpe(this,N1),wpe(this,"name",""),this.name=n.name,this.elements.push(new Ua(this.hot,{type:"button",value:WM,className:"htUIButton htUIButtonOK",identifier:Kf.BUTTON_OK})),this.elements.push(new Ua(this.hot,{type:"button",value:jM,className:"htUIButton htUIButtonCancel",identifier:Kf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){x(this.elements,e=>{e.addLocalHook("click",(n,r)=>Cpe(N1,this,bpe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),x(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}ZF=Kf;function bpe(t,e){e.options.identifier===ZF.BUTTON_OK?this.accept():this.cancel()}function Kb(t,e,n){return(e=Spe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Spe(t){var e=Rpe(t,"string");return typeof e=="symbol"?e:e+""}function Rpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const D1="ConditionCollection.filteringStates";class A_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Kb(this,"hot",void 0),Kb(this,"isMapRegistrable",void 0),Kb(this,"filteringStates",new ny),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(D1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ja;return e.length?mme(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ja,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(gt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Lt(Uf[r]))throw new Error(gt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:qa(a,s)}]},i):u.push({name:a,args:s,func:qa(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(D1),this.filteringStates=null,this.clearLocalHooks()}}vt(A_,Wn);function $1(t,e,n){return(e=Epe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Epe(t){var e=Tpe(t,"string");return typeof e=="symbol"?e:e+""}function Tpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];$1(this,"conditionCollection",void 0),$1(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return x(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return x(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return x(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function Mpe(t,e){_pe(t,e),e.add(t)}function _pe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e,n){return(e=xpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xpe(t){var e=Ppe(t,"string");return typeof e=="symbol"?e:e+""}function Ppe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zm=new WeakSet;class eV{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Mpe(this,Zm),Ml(this,"hot",void 0),Ml(this,"conditionCollection",void 0),Ml(this,"columnDataFactory",void 0),Ml(this,"changes",[]),Ml(this,"grouping",!1),Ml(this,"latestEditedColumnPosition",-1),Ml(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>qb(Zm,this,Ipe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>qb(Zm,this,Ope).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>qb(Zm,this,Ape).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,x(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=Y$(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new A_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const p=r.columnDataFactory(h);let C;f.isEmpty()?C=p:C=new QF(f,y=>r.columnDataFactory(y)).filter(),C=Ke(C,y=>y.meta.visualRow);const E=Ng(C);return f.destroy(),za(p,y=>E(y.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Le(this,(e,n)=>{this[n]=null})}}function Ipe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Ope(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Ape(){x(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}vt(eV,Wn);function Hpe(t){return bF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Gf)return r;if(i.element&&!fu(i.element))return!1;i.focus()}})}const Td="filters";function Npe(t,e){let n=-1,r;const i=Hpe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Td),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof io&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Td),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Td)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const p=r.getNavigator();p.getCurrentPage()>-1&&(n=p.getCurrentPage()),p.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const p=e[i.getCurrentPage()];p instanceof zf&&(p.openOptions(),g.preventDefault()),p instanceof Yf&&(p.activate(),g.preventDefault()),p instanceof io||g.preventDefault()}}],Td)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Td)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Dpe(t,e){tV(t,e),e.add(t)}function Xb(t,e,n){tV(t,e),e.set(t,n)}function tV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Md(t,e,n){return(e=$pe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $pe(t){var e=kpe(t,"string");return typeof e=="symbol"?e:e+""}function kpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ew(t,e,n){return t.set(_r(t,e),n),n}function wi(t,e){return t.get(_r(t,e))}function _r(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const a0="filters",Lpe=250,k1=a0;var Ts=new WeakMap,l0=new WeakMap,Jl=new WeakMap,Vr=new WeakSet;class Fpe extends Qe{static get PLUGIN_KEY(){return a0}static get PLUGIN_PRIORITY(){return Lpe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Dpe(this,Vr),Md(this,"dropdownMenuPlugin",null),Md(this,"conditionCollection",null),Md(this,"conditionUpdateObserver",null),Md(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Md(this,"filtersRowsMap",null),Xb(this,Ts,void 0),Xb(this,l0,new WeakSet),Xb(this,Jl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _r(Vr,n,Ype).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[a0]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Eg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>_r(Vr,this,L1).call(this,"accept")),a.addLocalHook("cancel",()=>_r(Vr,this,L1).call(this,"cancel")),a.addLocalHook("change",l=>_r(Vr,this,zpe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(kM)}:`,s=()=>`${this.hot.getTranslatedPhrase(LM)}:`;if(!this.components.get("filter_by_condition")){const a=new s0(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>_r(Vr,this,F1).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new qme(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new s0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>_r(Vr,this,F1).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new dpe(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Kf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new A_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new eV(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>_r(Vr,this,Gpe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return _r(Vr,e,Upe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>_r(Vr,this,jpe).call(this)),this.addHook("afterDropdownMenuShow",()=>_r(Vr,this,Bpe).call(this)),this.addHook("afterDropdownMenuHide",()=>_r(Vr,this,Wpe).call(this)),this.addHook("afterChange",a=>_r(Vr,this,Vpe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!wi(Ts,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=wi(Ts,this).getMenu(),c=u.getNavigator(),h=wi(Ts,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];ew(Ts,this,Npe(this.dropdownMenuPlugin.menu,a));const l=u=>{wi(Ts,this).listen(),u.preventDefault(),Ch(u.keyCode,"TAB")&&(u.shiftKey?wi(Ts,this).toPreviousItem():wi(Ts,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:k1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(k1)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ja;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,wi(Jl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ke(n.filter(),u=>u.meta.visualRow);const l=Ng(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),x(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),ew(Jl,this,this.exportConditions())}else s!==!1&&!r?(ew(Jl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(wi(Jl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return x(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),p=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:x_(p)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=o0(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Xw&&n.command.key!==Dn&&r.command.key!==Dn&&i.command.key!==Dn?o=I_:i.command.key!==Dn&&(n.command.key===Dn||r.command.key===Dn)&&(o=ja),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new QF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return x(i,s=>{x(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Vpe(t){t&&x(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Bpe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Wpe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function jpe(){const t=this.dropdownMenuPlugin.menu;wi(l0,this).has(t)||wi(Ts,this).setMenu(t),wi(l0,this).add(t)}function Upe(t){t.items.push({name:Ve}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function L1(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==Dn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==Dn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Dn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function zpe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===s0&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function F1(){this.setListeningDropdownMenu()}function Ype(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):pe(e,"htFiltersActive")}function Gpe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&ew(Jl,this,wi(Jl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===nu),s=n.filter(a=>a.name!==nu);if(o.length>=2||s.length>=3)it(gt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const nV="internal-use-in-handsontable",u0={licenseKey:nV,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function rV(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Jn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function iV(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Kpe(t){var e;const n=t[Jn],r=iV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=rV(t);return{...u0,...r,...i}}function qpe(t){var e;const n=t[Jn],r=iV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=rV(t);return{...r,...i}}function Xpe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Ey(){const t="engine_relationship",e=co(Jn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function H_(){const t="shared_engine_usage",e=co(Jn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Jpe(t){const e=t.getSettings(),n=e[Jn],r=n==null?void 0:n.engine;if(n===!0||Lt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Zpe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Lt(r.hyperformula)){const o=Ey(),s=H_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:nV}),(r.getConfig().leapYear1900!==u0.leapYear1900||Gv(r.getConfig().nullDate,u0.nullDate)===!1)&&it(gt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Zpe(t,e,n){const r=e[Jn],i=Kpe(e),o=Ey(),s=H_();Qpe(t,r.functions),ewe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),twe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function V1(t){var e;const n=Ey(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function B1(t,e){if(t){const n=Ey(),r=n.get(t),i=H_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Qpe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){it(s.message)}})}function ewe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){it(r.message)}}}function twe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){it(a.message)}}),t.resumeEvaluation())}function nwe(t,e){return(Lt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const oV="DD/MM/YYYY";function rwe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function iwe(t){return rwe(t)?t.substr(1):t}function owe(t){return typeof t=="string"&&t.startsWith("=")}function N_(t,e){return typeof t=="string"&&e==="date"}function sV(t,e){return ee(t,e,!0).isValid()}function aV(t,e){return ee(t,e,!0).format(oV)}function swe(t,e){return ee(t,oV,!0).format(e)}function lV(t,e){const r=new Date(Date.UTC(0,0,t+-1));return ee(r).format(e)}function awe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function lwe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function uwe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function D_(t,e,n){const r=lwe(t,awe(t,e,n));return uwe(r)}function _l(t,e,n){cwe(t,e),e.set(t,n)}function cwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(uV(t,e))}function fa(t,e,n){return t.set(uV(t,e),n),n}function uV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _d=new WeakMap,ga=new WeakMap,Br=new WeakMap,Qm=new WeakMap,Jb=new WeakMap,Zb=new WeakMap,ep=new WeakMap;class W1{constructor(e,n,r){_l(this,_d,void 0),_l(this,ga,void 0),_l(this,Br,void 0),_l(this,Qm,[]),_l(this,Jb,[]),_l(this,Zb,void 0),_l(this,ep,[]),fa(_d,this,e),fa(ga,this,n),fa(Br,this,r)}setRemovedHfIndexes(e){return fa(ep,this,e.map(n=>{const r=$t(ga,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),$t(ep,this)}getRemovedHfIndexes(){return $t(ep,this)}getHfIndexFromVisualIndex(e){const n=$t(ga,this).getIndexesSequence(),r=$t(ga,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${tr($t(_d,this))}s`;$t(Br,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&$t(Br,this).getEngine()[r]($t(Br,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(fa(Jb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),fa(Zb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if($t(Br,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=D_($t(Jb,this),$t(Zb,this),$t(ga,this).getNumberOfIndexes());$t(Br,this).getSheetId()===null?$t(Br,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${tr($t(_d,this))}Order`;return n=>{if($t(Br,this).isPerformingUndoRedo())return;const r=$t(ga,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=$t(Qm,this).map(l=>r.indexOf(l)),o=$t(Br,this).getEngine().getSheetDimensions($t(Br,this).getSheetId());let s;$t(_d,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);$t(Br,this).getEngine()[e]($t(Br,this).getSheetId(),i)}fa(Qm,this,r)}}init(){fa(Qm,this,$t(ga,this).getIndexesSequence())}}function xl(t,e,n){hwe(t,e),e.set(t,n)}function hwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cs(t,e){return t.get(cV(t,e))}function Pl(t,e,n){return t.set(cV(t,e),n),n}function cV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tp=new WeakMap,np=new WeakMap,Qb=new WeakMap,eS=new WeakMap,tS=new WeakMap,nS=new WeakMap,rS=new WeakMap;class dwe{constructor(e,n,r){xl(this,tp,void 0),xl(this,np,void 0),xl(this,Qb,void 0),xl(this,eS,!1),xl(this,tS,!1),xl(this,nS,null),xl(this,rS,null),Pl(tp,this,new W1("row",e,this)),Pl(np,this,new W1("column",n,this)),Pl(Qb,this,r)}getForAxis(e){return e==="row"?Cs(tp,this):Cs(np,this)}setPerformUndo(e){Pl(eS,this,e)}setPerformRedo(e){Pl(tS,this,e)}isPerformingUndoRedo(){return Cs(eS,this)||Cs(tS,this)}getSheetId(){return Cs(rS,this)}getEngine(){return Cs(nS,this)}getPostponeAction(){return Cs(Qb,this)}setupSyncEndpoint(e,n){Pl(nS,this,e),Pl(rS,this,n),Cs(tp,this).init(),Cs(np,this).init()}}function fwe(t,e){hV(t,e),e.add(t)}function Il(t,e,n){return(e=gwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gwe(t){var e=mwe(t,"string");return typeof e=="symbol"?e:e+""}function mwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iS(t,e,n){hV(t,e),e.set(t,n)}function hV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){return t.set(et(t,e),n),n}function su(t,e){return t.get(et(t,e))}function et(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jn="formulas",pwe=["maxRows","maxColumns","language"],wwe=260;ie.getSingleton().register("afterNamedExpressionAdded");ie.getSingleton().register("afterNamedExpressionRemoved");ie.getSingleton().register("afterSheetAdded");ie.getSingleton().register("afterSheetRemoved");ie.getSingleton().register("afterSheetRenamed");ie.getSingleton().register("afterFormulasValuesUpdate");const Mh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Ks=new WeakMap,Ty=new WeakMap,xd=new WeakMap,rt=new WeakSet;class vwe extends Qe{constructor(){var e;super(...arguments),e=this,fwe(this,rt),iS(this,Ks,!1),iS(this,Ty,!1),iS(this,xd,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Nwe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Dwe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,$we).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,kwe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Lwe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Fwe).call(e,...r)}]]),Il(this,"staticRegister",co("formulas")),Il(this,"engine",null),Il(this,"sheetId",null),Il(this,"sheetName",null),Il(this,"indexSyncer",null),Il(this,"rowAxisSyncer",null),Il(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Jn}static get PLUGIN_PRIORITY(){return wwe}static get SETTING_KEYS(){return[Jn,...pwe]}isEnabled(){return!!this.hot.getSettings()[Jn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Jpe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){it("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&et(rt,this,lf).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,j1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,U1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,j1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,U1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Swe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Rwe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,ywe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Ewe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,z1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,z1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Twe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Mwe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Pwe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Iwe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,_we).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,xwe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Owe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Awe).call(n,...i)}),this.indexSyncer=new dwe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,bwe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Hwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return et(rt,n,Cwe).call(n,...i)}),su(xd,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){su(xd,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),B1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=qpe(this.hot.getSettings());Xpe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Jn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Jn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());et(rt,this,lf).call(this,o)}}super.updatePlugin(e)}destroy(){su(xd,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Xa(xd,this,null),B1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!zk(n))return it("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return it("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return it(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){XE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}et(rt,this,lf).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${tr(Jn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),V1(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=V1(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){it(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return N_(r,o.type)&&(sV(r,o.dateFormat)?r=aV(r,o.dateFormat):owe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function lf(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function ywe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Xn(s)&&(s=lV(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Cwe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:p}=h.start,{row:C,col:E}=h.end,y=C-g+1,T=E-p+1;for(let M=0;M<f.length;M+=1)for(let I=0;I<f[M].length;I+=1){const _=f[M][I],P=g+M%y,Y=p+I%T,V=this.hot.getCellMeta(P,Y);N_(_,V.type)&&(_.startsWith("'")?f[M][I]=_.slice(1):this.isFormulaCellType(P,Y,this.sheetId)===!1&&(f[M][I]=swe(_,V.dateFormat)))}return f}function j1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(tr(Jn))||Xa(Ty,this,Lt(this.hot.getSettings().data))}function bwe(){if(su(Ty,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;N_(i,s.type)&&(sV(i,a)?t[r][o]=aV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Xa(Ks,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Xa(Ks,this,!1)}function U1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(tr(Jn)))return;const r=nwe(this.engine,this.hot.getSettings()[Jn].sheetName);if(et(rt,this,lf).call(this,r),n!=="updateSettings")if(su(Ty,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Xa(Ks,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Xa(Ks,this,!1)}}}function Swe(t,e,n,r){if(r!=="get"||su(Ks,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=iwe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Xn(a)&&(a=lV(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function Rwe(t,e,n,r){if(r!=="get"||su(Ks,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function z1(t,e){if(Mh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Ewe(t,e){if(Mh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Xn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){it(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Twe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Mwe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function _we(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function xwe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Pwe(t,e,n){if(Mh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Iwe(t,e,n){if(Mh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Owe(t,e,n,r){if(Mh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Awe(t,e,n,r){if(Mh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Hwe(t,e,n){var r;Xa(Ks,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Xa(Ks,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Nwe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Dwe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function $we(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function kwe(t){this.hot.runHooks("afterSheetAdded",t)}function Lwe(t,e){et(rt,this,lf).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Fwe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Vwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(gM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Bwe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(mM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ke(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return x(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Wwe(t,e){dV(t,e),e.add(t)}function jwe(t,e,n){dV(t,e),e.set(t,n)}function dV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ol(t,e){return t.get(Sa(t,e))}function Y1(t,e,n){return t.set(Sa(t,e),n),n}function Sa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideColumns");ie.getSingleton().register("afterHideColumns");ie.getSingleton().register("beforeUnhideColumns");ie.getSingleton().register("afterUnhideColumns");const G1="hiddenColumns",Uwe=310;var So=new WeakMap,Al=new WeakSet;class zwe extends Qe{constructor(){super(...arguments),Wwe(this,Al),jwe(this,So,null)}static get PLUGIN_KEY(){return G1}static get PLUGIN_PRIORITY(){return Uwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[G1]}enablePlugin(){var e=this;this.enabled||(Y1(So,this,new ty),Ol(So,this).addLocalHook("init",()=>Sa(Al,this,Jwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ol(So,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(Al,e,Xwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Sa(Al,this,Gwe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Sa(Al,this,Ywe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(Al,e,qwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Sa(Al,this,Kwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Ol(So,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));x(l,u=>{o[u]=!1}),i=Tn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Ol(So,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{Ol(So,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ke(Ol(So,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ol(So,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){x(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){Y1(So,this,null),super.destroy()}}function Ywe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Gwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Kwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return x(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function qwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function Xwe(t){t.items.push({name:Ve},Vwe(this),Bwe(this))}function Jwe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Zwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(pM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Qwe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(wM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ke(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return x(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function eve(t,e){fV(t,e),e.add(t)}function tve(t,e,n){fV(t,e),e.set(t,n)}function fV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hl(t,e){return t.get(Ra(t,e))}function K1(t,e,n){return t.set(Ra(t,e),n),n}function Ra(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideRows");ie.getSingleton().register("afterHideRows");ie.getSingleton().register("beforeUnhideRows");ie.getSingleton().register("afterUnhideRows");const q1="hiddenRows",nve=320;var Ro=new WeakMap,Nl=new WeakSet;class rve extends Qe{constructor(){super(...arguments),eve(this,Nl),tve(this,Ro,null)}static get PLUGIN_KEY(){return q1}static get PLUGIN_PRIORITY(){return nve}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[q1]}enablePlugin(){var e=this;this.enabled||(K1(Ro,this,new ty),Hl(Ro,this).addLocalHook("init",()=>Ra(Nl,this,uve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Hl(Ro,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Nl,e,lve).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Ra(Nl,this,ove).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Ra(Nl,this,ive).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Nl,e,ave).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Ra(Nl,this,sve).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Hl(Ro,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));x(l,u=>{o[u]=!1}),i=Tn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Hl(Ro,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{Hl(Ro,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ke(Hl(Ro,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Hl(Ro,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){x(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){K1(Ro,this,null),super.destroy()}}function ive(t,e){return this.isHidden(e)?0:t}function ove(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function sve(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return x(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function ave(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function lve(t){t.items.push({name:Ve},Zwe(this),Qwe(this))}function uve(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function cve(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(UT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function hve(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(zT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function dve(t,e){gV(t,e),e.add(t)}function fve(t,e,n){gV(t,e),e.set(t,n)}function gV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c0(t,e){return t.get(Zw(t,e))}function oS(t,e,n){return t.set(Zw(t,e),n),n}function Zw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnFreeze");ie.getSingleton().register("afterColumnFreeze");ie.getSingleton().register("beforeColumnUnfreeze");ie.getSingleton().register("afterColumnUnfreeze");const X1="manualColumnFreeze",gve=110;var Gl=new WeakMap,sS=new WeakSet;class mve extends Qe{constructor(){super(...arguments),dve(this,sS),fve(this,Gl,!1)}static get PLUGIN_KEY(){return X1}static get PLUGIN_PRIORITY(){return gve}isEnabled(){return!!this.hot.getSettings()[X1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Zw(sS,this,pve).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Zw(sS,this,wve).call(this,e,n)),super.enablePlugin())}disablePlugin(){oS(Gl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;c0(Gl,this)||oS(Gl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;c0(Gl,this)||oS(Gl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function pve(t){t.items.push({name:"---------"},cve(this),hve(this))}function wve(t,e){if(c0(Gl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function rp(t,e,n){return(e=vve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vve(t){var e=yve(t,"string");return typeof e=="symbol"?e:e+""}function yve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aS=0,J1=1,Z1=2,fc="px";let mV=class{constructor(e){rp(this,"hot",void 0),rp(this,"_element",null),rp(this,"state",aS),rp(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=Z1}build(){this.state===aS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=J1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=aS}isAppended(){return this.state===Z1}isBuilt(){return this.state>=J1}setPosition(e,n){Xn(e)&&(this._element.style.top=e+fc),Xn(n)&&(this._element.style[this.inlineProperty]=n+fc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Xn(e)&&(this._element.style.width=e+fc),Xn(n)&&(this._element.style.height=n+fc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Xn(e)&&(this._element.style.marginTop=e+fc),Xn(n)&&(this._element.style[`margin${tr(this.inlineProperty)}`]=n+fc)}getOffset(){const e=this._element.style,n=`margin${tr(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Cve="ht__manualColumnMove--backlight";let bve=class extends mV{build(){super.build(),q(this._element,Cve)}};const Sve="ht__manualColumnMove--guideline";let Rve=class extends mV{build(){super.build(),q(this._element,Sve)}};function Eve(t,e){pV(t,e),e.add(t)}function Vi(t,e,n){pV(t,e),e.set(t,n)}function pV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nr(t,e,n){return t.set(Ea(t,e),n),n}function he(t,e){return t.get(Ea(t,e))}function Ea(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnMove");ie.getSingleton().register("afterColumnMove");const lS="manualColumnMove",Tve=120,Q1="ht__manualColumnMove",Qw="show-ui",h0="on-moving--columns",d0="after-selection--columns";var hr=new WeakMap,_a=new WeakMap,Fs=new WeakMap,tw=new WeakMap,ka=new WeakMap,cr=new WeakMap,ip=new WeakMap,fi=new WeakMap,_c=new WeakMap,ev=new WeakMap,uf=new WeakMap,Dl=new WeakSet;class Mve extends Qe{constructor(){super(...arguments),Eve(this,Dl),Vi(this,hr,new bve(this.hot)),Vi(this,_a,new Rve(this.hot)),Vi(this,Fs,[]),Vi(this,tw,0),Vi(this,ka,!1),Vi(this,cr,{}),Vi(this,ip,void 0),Vi(this,fi,void 0),Vi(this,_c,void 0),Vi(this,ev,void 0),Vi(this,uf,void 0)}static get PLUGIN_KEY(){return lS}static get PLUGIN_PRIORITY(){return Tve}isEnabled(){return!!this.hot.getSettings()[lS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ea(Dl,e,_ve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ea(Dl,e,Pve).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ea(Dl,this,Ove).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ea(Dl,e,Ave).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,Q1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,Q1),this.unregisterEvents(),he(hr,this).destroy(),he(_a,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(ip,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Nr(ip,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Nr(ip,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Tn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[lS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(fi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(fi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(hr,this).getOffset().start,u=he(hr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,p=rn(this.hot.rootElement),C=g.innerWidth-he(_c,this)-p;h=g.innerWidth-he(cr,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=he(cr,this).eventPageX-(he(_c,this)-(r.scrollX===void 0?i:0));if(he(ev,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(fi,this))&&(o+=i),o+=c,he(fi,this)<0)he(uf,this)>0?he(cr,this).col=0:he(cr,this).col=e>0?e-1:e;else if(he(cr,this).TD.offsetWidth/2+o<=h){const g=he(fi,this)>=he(tw,this)?he(tw,this)-1:he(fi,this);he(cr,this).col=g+1,o+=he(cr,this).TD.offsetWidth}else he(cr,this).col=he(fi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(fi,this)<he(uf,this)&&(f-=he(_c,this)<=r.scrollX?he(_c,this):0),he(hr,this).setPosition(null,d),he(_a,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ea(Dl,this,xve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ea(Dl,this,Ive).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(hr,this).build(),he(_a,this).build()}destroy(){he(hr,this).destroy(),he(_a,this).destroy(),super.destroy()}}function _ve(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=we(t.target,"sortAction");if(!s||!o||he(ka,this)||t.button!==0||a){Nr(ka,this,!1),he(Fs,this).length=0,pe(this.hot.rootElement,[h0,Qw]);return}const l=he(_a,this).isBuilt()&&!he(_a,this).isAppended(),u=he(hr,this).isBuilt()&&!he(hr,this).isAppended();l&&u&&(he(_a,this).appendTo(i.hider),he(hr,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Nr(ka,this,!0);const g=n.firstChild?uk(t,n.firstChild).x:t.offsetX;he(cr,this).eventPageX=t.pageX,Nr(fi,this,e.col),he(cr,this).TD=n,he(cr,this).col=e.col,Nr(Fs,this,this.prepareColumnsToMoving(d,f)),Nr(ev,this,!!this.hot.getSettings().rowHeaders),Nr(tw,this,this.hot.countCols()),Nr(uf,this,this.hot.getSettings().fixedColumnsStart),Nr(_c,this,Bn(this.hot.rootElement).left);const p=he(ev,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(uf,this),y=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),M=this.getColumnsWidth(d,e.col-1)+T,I=this.getColumnsWidth(p,d-1)+(E?y:0)+M;he(hr,this).setPosition(C,I),he(hr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),he(hr,this).setOffset(null,-M),q(this.hot.rootElement,h0)}else pe(this.hot.rootElement,d0),Nr(ka,this,!1),he(Fs,this).length=0}function xve(t){he(ka,this)&&(he(cr,this).eventPageX=t.pageX,this.refreshPositions())}function Pve(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(ka,this)||(he(Fs,this).indexOf(e.col)>-1?pe(this.hot.rootElement,Qw):q(this.hot.rootElement,Qw),r.row=!0,r.column=!0,r.cell=!0,Nr(fi,this,e.col),he(cr,this).TD=n)}function Ive(){const t=he(cr,this).col,e=he(Fs,this).length;if(Nr(fi,this,void 0),Nr(ka,this,!1),pe(this.hot.rootElement,[h0,Qw,d0]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,d0),e<1||t===void 0)return;const n=he(Fs,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(Fs,this),t);if(he(Fs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Ove(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(hr,this).setPosition(r),he(hr,this).setSize(null,t.hider.offsetHeight-r)}function Ave(){this.moveBySettingsOrLoad()}function Hve(t,e){wV(t,e),e.add(t)}function zn(t,e,n){wV(t,e),e.set(t,n)}function wV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nn(t,e,n){return t.set(Ki(t,e),n),n}function oe(t,e){return t.get(Ki(t,e))}function Ki(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tv="manualColumnResize",Nve=130,eA="manualColumnWidths";var Is=new WeakMap,op=new WeakMap,qr=new WeakMap,nv=new WeakMap,jo=new WeakMap,Dve=new WeakMap,Kc=new WeakMap,sp=new WeakMap,Tr=new WeakMap,Ms=new WeakMap,vu=new WeakMap,rv=new WeakMap,cf=new WeakMap,hf=new WeakMap,Jr=new WeakMap,df=new WeakMap,Eo=new WeakSet;class $ve extends Qe{static get PLUGIN_KEY(){return tv}static get PLUGIN_PRIORITY(){return Nve}constructor(e){super(e),Hve(this,Eo),zn(this,Is,null),zn(this,op,null),zn(this,qr,[]),zn(this,nv,null),zn(this,jo,null),zn(this,Dve,null),zn(this,Kc,null),zn(this,sp,null),zn(this,Tr,this.hot.rootDocument.createElement("DIV")),zn(this,Ms,this.hot.rootDocument.createElement("DIV")),zn(this,vu,null),zn(this,rv,!1),zn(this,cf,0),zn(this,hf,null),zn(this,Jr,void 0),zn(this,df,void 0),q(oe(Tr,this),"manualColumnResizer"),q(oe(Ms,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[tv]}enablePlugin(){var e=this;this.enabled||(nn(Jr,this,new Qa),oe(Jr,this).addLocalHook("init",()=>Ki(Eo,this,kve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,oe(Jr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ki(Eo,e,jve).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ki(Eo,e,Uve).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ki(Eo,e,zve).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){nn(df,this,oe(Jr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",eA,oe(Jr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",eA,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return oe(Jr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);oe(Jr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;nn(Is,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(oe(Is,this)),i=r.col;if(i<0)return;const o=dn(oe(Is,this)),s=oe(Is,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(Is,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(oe(Is,this),r.row,r.col)),nn(op,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),nn(qr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();x(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{oe(qr,this).includes(g)||oe(qr,this).push(g)})})}oe(qr,this).includes(oe(op,this))||nn(qr,this,[oe(op,this)]),nn(sp,this,l.start-6),nn(Kc,this,parseInt(s.width,10)),oe(Tr,this).style.top=`${l.top}px`,oe(Tr,this).style[this.inlineDir]=`${oe(sp,this)+oe(Kc,this)}px`,oe(Tr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(oe(Tr,this))}refreshHandlePosition(){oe(Tr,this).style[this.inlineDir]=`${oe(sp,this)+oe(nv,this)}px`}setupGuidePosition(){const e=parseInt(dn(oe(Tr,this)),10),n=parseInt(oe(Tr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(oe(Tr,this),"active"),q(oe(Ms,this),"active"),oe(Ms,this).style.top=`${n}px`,this.refreshGuidePosition(),oe(Ms,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(oe(Ms,this))}refreshGuidePosition(){oe(Ms,this).style[this.inlineDir]=oe(Tr,this).style[this.inlineDir]}hideHandleAndGuide(){pe(oe(Tr,this),"active"),pe(oe(Ms,this),"active")}checkIfColumnHeader(e){const n=Ya(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",oe(jo,this),r,!0);o!==void 0&&nn(jo,this,o),this.setManualSize(r,oe(jo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(jo,this),r,!0),i&&e()};oe(cf,this)>=2&&(oe(qr,this).length>1?(x(oe(qr,this),i=>{n(i)}),e()):x(oe(qr,this),i=>{n(i,!0)})),nn(cf,this,0),nn(hf,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Ki(Eo,this,Lve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Ki(Eo,this,Fve).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Ki(Eo,this,Vve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ki(Eo,this,Bve).call(this)),this.eventManager.addEventListener(oe(Tr,this),"contextmenu",()=>Ki(Eo,this,Wve).call(this))}destroy(){super.destroy()}}function kve(){const t=this.hot.getSettings()[tv],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{oe(Jr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{oe(Jr,this).setValueAtIndex(r,n)})},!0),nn(df,this,t)):t===!0&&Array.isArray(oe(df,this))&&this.hot.batchExecution(()=>{oe(df,this).forEach((n,r)=>{oe(Jr,this).setValueAtIndex(r,n)})},!0)}function Lve(t){if(!BE(t.target)&&oe(rv,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(oe(vu,this)||this.setupHandlePosition(e))}}function Fve(t){t.target.parentNode===this.hot.rootElement&&we(t.target,"manualColumnResizer")&&(this.setupHandlePosition(oe(Is,this)),this.setupGuidePosition(),nn(vu,this,!0),oe(hf,this)===null&&(nn(hf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(hf,this))),nn(cf,this,oe(cf,this)+1),this.startX=t.pageX,nn(jo,this,oe(Kc,this)))}function Vve(t){if(oe(vu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();nn(nv,this,oe(Kc,this)+e),x(oe(qr,this),n=>{nn(jo,this,this.setManualSize(n,oe(nv,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Bve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",oe(jo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(jo,this),n,!1)};oe(vu,this)&&(this.hideHandleAndGuide(),nn(vu,this,!1),oe(jo,this)!==oe(Kc,this)&&(oe(qr,this).length>1?(x(oe(qr,this),r=>{e(r)}),t()):x(oe(qr,this),r=>{e(r,!0)})),this.setupHandlePosition(oe(Is,this)))}function Wve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(Tr,this)),this.hot.rootElement.removeChild(oe(Ms,this)),nn(vu,this,!1),nn(rv,this,!0),this.hot._registerImmediate(()=>{nn(rv,this,!1)})}function jve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=oe(Jr,this).getValueAtIndex(r);this.hot.getSettings()[tv]&&i&&(n=i)}return n}function Uve(t,e){const n=oe(Jr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function zve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function uS(t,e,n){return(e=Yve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yve(t){var e=Gve(t,"string");return typeof e=="symbol"?e:e+""}function Gve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cS=0,tA=1,nA=2,gc="px";let vV=class{constructor(e){uS(this,"hot",void 0),uS(this,"_element",null),uS(this,"state",cS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=nA}build(){this.state===cS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=tA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=cS}isAppended(){return this.state===nA}isBuilt(){return this.state>=tA}setPosition(e,n){e!==void 0&&(this._element.style.top=e+gc),n!==void 0&&(this._element.style.left=n+gc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+gc),n&&(this._element.style.height=n+gc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+gc),n&&(this._element.style.marginLeft=n+gc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Kve="ht__manualRowMove--backlight";class qve extends vV{build(){super.build(),q(this._element,Kve)}}const Xve="ht__manualRowMove--guideline";class Jve extends vV{build(){super.build(),q(this._element,Xve)}}function Zve(t,e){yV(t,e),e.add(t)}function mc(t,e,n){yV(t,e),e.set(t,n)}function yV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ru(t,e,n){return t.set(Ta(t,e),n),n}function xe(t,e){return t.get(Ta(t,e))}function Ta(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeRowMove");ie.getSingleton().register("afterRowMove");const hS="manualRowMove",Qve=140,rA="ht__manualRowMove",iv="show-ui",f0="on-moving--rows",g0="after-selection--rows";var dr=new WeakMap,xa=new WeakMap,Vs=new WeakMap,La=new WeakMap,Dr=new WeakMap,ap=new WeakMap,$l=new WeakSet;class eye extends Qe{constructor(){super(...arguments),Zve(this,$l),mc(this,dr,new qve(this.hot)),mc(this,xa,new Jve(this.hot)),mc(this,Vs,[]),mc(this,La,void 0),mc(this,Dr,{}),mc(this,ap,void 0)}static get PLUGIN_KEY(){return hS}static get PLUGIN_PRIORITY(){return Qve}isEnabled(){return!!this.hot.getSettings()[hS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ta($l,e,tye).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ta($l,e,rye).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ta($l,this,oye).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ta($l,e,sye).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,rA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,rA),this.unregisterEvents(),xe(dr,this).destroy(),xe(xa,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=xe(ap,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(ru(ap,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return ru(ap,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Tn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[hS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=xe(Dr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=xe(Dr,this).TD,a=this.hot.rootElement,l=Bn(a),u=eh(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=xe(Dr,this).eventPageY-d+c,g=o.hider.offsetHeight,p=o.TBODY.offsetTop,C=xe(dr,this).getOffset().top,E=xe(dr,this).getSize().height,y=s.offsetHeight/2,T=s.offsetHeight;let M=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=f>=M+y;this.isFixedRowTop(e.row)&&(M+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?xe(Dr,this).row=n>0?n-1:n:I?(xe(Dr,this).row=e.row+1,M+=e.row===0?T-1:T):xe(Dr,this).row=e.row;let _=f,P=M;f+E+C>=g?_=g-E-C:f+C<p&&(_=p+Math.abs(C)),M>=g-1&&(P=g-1),xe(dr,this).setPosition(_),xe(xa,this).setPosition(P)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ta($l,this,nye).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ta($l,this,iye).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){xe(dr,this).build(),xe(xa,this).build()}destroy(){xe(dr,this).destroy(),xe(xa,this).destroy(),super.destroy()}}function tye(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||xe(La,this)||t.button!==0){ru(La,this,!1),xe(Vs,this).length=0,pe(this.hot.rootElement,[f0,iv]);return}const l=xe(xa,this).isBuilt()&&!xe(xa,this).isAppended(),u=xe(dr,this).isBuilt()&&!xe(dr,this).isAppended();l&&u&&(xe(xa,this).appendTo(i.hider),xe(dr,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,ru(La,this,!0),xe(Dr,this).eventPageY=t.pageY,xe(Dr,this).coords=e,xe(Dr,this).TD=n,ru(Vs,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),p=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);xe(dr,this).setPosition(null,g),xe(dr,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),xe(dr,this).setOffset(-p,null),q(this.hot.rootElement,f0),this.refreshPositions()}else pe(this.hot.rootElement,g0),ru(La,this,!1),xe(Vs,this).length=0}function nye(t){xe(La,this)&&(xe(Dr,this).eventPageY=t.pageY,this.refreshPositions())}function rye(t,e,n,r){!this.hot.getSelectedRangeLast()||!xe(La,this)||(xe(Vs,this).indexOf(e.row)>-1?pe(this.hot.rootElement,iv):q(this.hot.rootElement,iv),r.row=!0,r.column=!0,r.cell=!0,xe(Dr,this).coords=e,xe(Dr,this).TD=n)}function iye(){const t=xe(Dr,this).row,e=xe(Vs,this).length;if(ru(La,this,!1),pe(this.hot.rootElement,[f0,iv,g0]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,g0),e<1||t===void 0)return;const n=xe(Vs,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(xe(Vs,this),t);if(xe(Vs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function oye(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;xe(dr,this).setPosition(null,r),xe(dr,this).setSize(t.hider.offsetWidth-r)}function sye(){this.moveBySettingsOrLoad()}function aye(t,e){CV(t,e),e.add(t)}function Yn(t,e,n){CV(t,e),e.set(t,n)}function CV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gt(t,e,n){return t.set(Os(t,e),n),n}function re(t,e){return t.get(Os(t,e))}function Os(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ov="manualRowResize",lye=30,iA="manualRowHeights";var Do=new WeakMap,lp=new WeakMap,Xr=new WeakMap,ff=new WeakMap,Pa=new WeakMap,$_=new WeakMap,qc=new WeakMap,up=new WeakMap,lr=new WeakMap,Ao=new WeakMap,yu=new WeakMap,sv=new WeakMap,gf=new WeakMap,mf=new WeakMap,Zi=new WeakMap,pf=new WeakMap,ma=new WeakSet;class uye extends Qe{static get PLUGIN_KEY(){return ov}static get PLUGIN_PRIORITY(){return lye}constructor(e){super(e),aye(this,ma),Yn(this,Do,null),Yn(this,lp,null),Yn(this,Xr,[]),Yn(this,ff,null),Yn(this,Pa,null),Yn(this,$_,null),Yn(this,qc,null),Yn(this,up,null),Yn(this,lr,this.hot.rootDocument.createElement("DIV")),Yn(this,Ao,this.hot.rootDocument.createElement("DIV")),Yn(this,yu,!1),Yn(this,sv,!1),Yn(this,gf,0),Yn(this,mf,null),Yn(this,Zi,void 0),Yn(this,pf,void 0),q(re(lr,this),"manualRowResizer"),q(re(Ao,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ov]}enablePlugin(){this.enabled||(Gt(Zi,this,new Qa),re(Zi,this).addLocalHook("init",()=>Os(ma,this,pye).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,re(Zi,this)),this.addHook("modifyRowHeight",(e,n)=>Os(ma,this,mye).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Gt(pf,this,re(Zi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",iA,re(Zi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",iA,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return re(Zi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return re(ff,this)}setupHandlePosition(e){Gt(Do,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(re(Do,this)),o=i.row;if(o<0)return;const s=rn(re(Do,this)),a=re(Do,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(Do,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(re(Do,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(re(Do,this),i.row,i.col)),Gt(lp,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Gt(Xr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();x(d,f=>{const g=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;fe(g,p,C=>{re(Xr,this).includes(C)||re(Xr,this).push(C)})})}re(Xr,this).includes(re(lp,this))||Gt(Xr,this,[re(lp,this)]),Gt(up,this,c.top-6),Gt(qc,this,parseInt(a.height,10)),re(lr,this).style.top=`${re(up,this)+re(qc,this)}px`,re(lr,this).style[this.inlineDir]=`${c.start}px`,re(lr,this).style.width=`${s}px`,this.hot.rootElement.appendChild(re(lr,this))}refreshHandlePosition(){re(lr,this).style.top=`${re(up,this)+re(ff,this)}px`}setupGuidePosition(){const e=parseInt(rn(re(lr,this)),10),n=parseInt(re(lr,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(re(lr,this),"active"),q(re(Ao,this),"active"),re(Ao,this).style.top=re(lr,this).style.top,re(Ao,this).style[this.inlineDir]=`${n}px`,re(Ao,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(re(Ao,this))}refreshGuidePosition(){re(Ao,this).style.top=re(lr,this).style.top}hideHandleAndGuide(){pe(re(lr,this),"active"),pe(re(Ao,this),"active")}checkIfRowHeader(e){const n=Ya(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&re(Pa,this)<n?n:re(Pa,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Gt(Pa,this,o),this.setManualSize(r,re(Pa,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};re(gf,this)>=2&&(re(Xr,this).length>1?(x(re(Xr,this),i=>{n(i)}),e()):x(re(Xr,this),i=>{n(i,!0)})),Gt(gf,this,0),Gt(mf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Os(ma,this,cye).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Os(ma,this,hye).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Os(ma,this,dye).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Os(ma,this,fye).call(this)),this.eventManager.addEventListener(re(lr,this),"contextmenu",()=>Os(ma,this,gye).call(this))}destroy(){super.destroy()}}function cye(t){if(!BE(t.target)&&re(sv,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(re(yu,this)||this.setupHandlePosition(e))}}function hye(t){we(t.target,"manualRowResizer")&&(this.setupHandlePosition(re(Do,this)),this.setupGuidePosition(),Gt(yu,this,!0),re(mf,this)===null&&(Gt(mf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(mf,this))),Gt(gf,this,re(gf,this)+1),Gt($_,this,t.pageY),Gt(Pa,this,re(qc,this)))}function dye(t){re(yu,this)&&(Gt(ff,this,re(qc,this)+(t.pageY-re($_,this))),x(re(Xr,this),e=>{Gt(Pa,this,this.setManualSize(e,re(ff,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function fye(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};re(yu,this)&&(this.hideHandleAndGuide(),Gt(yu,this,!1),re(Pa,this)!==re(qc,this)&&(re(Xr,this).length>1?(x(re(Xr,this),r=>{e(r)}),t()):x(re(Xr,this),r=>{e(r,!0)})),this.setupHandlePosition(re(Do,this)))}function gye(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(lr,this)),this.hot.rootElement.removeChild(re(Ao,this)),Gt(yu,this,!1),Gt(sv,this,!0),this.hot._registerImmediate(()=>{Gt(sv,this,!1)})}function mye(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=re(Zi,this).getValueAtIndex(r);this.hot.getSettings()[ov]&&i&&(n=i)}return n}function pye(){const t=this.hot.getSettings()[ov],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{re(Zi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{re(Zi,this).setValueAtIndex(r,n)}),Gt(pf,this,t)):t===!0&&Array.isArray(re(pf,this))&&re(pf,this).forEach((n,r)=>{re(Zi,this).setValueAtIndex(r,n)})},!0)}var wye=Xv;wye("flatMap");var vye=Sn,oA=En,yye=ns,Cye=Z0,bye=function(t,e){(!e||typeof t!="string")&&oA(t);var n=Cye(t);return yye(oA(n!==void 0?vye(n,t):t))},Sye=Et,m0=Sn,Rye=Lr,p0=En,Eye=ns,Tye=bye,Mye=iE,w0=ni,_ye=Za,dS=_ye("flatMap",TypeError),xye=Mye(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=p0(m0(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){w0(t,"throw",i)}if(n=p0(m0(this.next,t)),this.done=!!n.done)return;try{this.inner=Tye(e(n.value,this.counter++),!1)}catch(i){w0(t,"throw",i)}}});Sye({target:"Iterator",proto:!0,real:!0,forced:dS},{flatMap:function(e){p0(this);try{Rye(e)}catch(n){w0(this,"throw",n)}return dS?m0(dS,this,e):new xye(Eye(this),{mapper:e,inner:null})}});function Pye(t,e,n){Iye(t,e),e.set(t,n)}function Iye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kl(t,e,n){return(e=Oye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oye(t){var e=Aye(t,"string");return typeof e=="symbol"?e:e+""}function Aye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sA(t,e){return t.get(bV(t,e))}function cp(t,e,n){return t.set(bV(t,e),n),n}function bV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ll=new WeakMap;class $o{constructor(e,n,r,i,o,s){kl(this,"row",void 0),kl(this,"col",void 0),kl(this,"rowspan",void 0),kl(this,"colspan",void 0),kl(this,"removed",!1),kl(this,"cellCoordsFactory",void 0),kl(this,"cellRangeFactory",void 0),Pye(this,Ll,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return gt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return gt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return gt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return gt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),cp(Ll,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,cp(Ll,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return cp(Ll,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return sA(Ll,this)||cp(Ll,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),sA(Ll,this)}}function Hye(t,e){Nye(t,e),e.add(t)}function Nye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hp(t,e,n){return(e=Dye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dye(t){var e=$ye(t,"string");return typeof e=="symbol"?e:e+""}function $ye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pa=new WeakSet;class av{constructor(e){Hye(this,pa),hp(this,"plugin",void 0),hp(this,"mergedCells",[]),hp(this,"mergedCellsMatrix",new Map),hp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return gt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){it(av.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new $o(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Fl(pa,this,aA).call(this,a),a):(u&&it(av.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Fl(pa,this,kye).call(this,r),r):!1}clear(){x(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Xe(u,i,i+s-1),d=Xe(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Fl(pa,this,dp).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Fl(pa,this,dp).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Fl(pa,this,dp).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Fl(pa,this,dp).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Fl(pa,this,aA).call(this,s)})}}function dp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function aA(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function kye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function fS(t,e,n){return(e=Lye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lye(t){var e=Fye(t,"string");return typeof e=="symbol"?e:e+""}function Fye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vye{constructor(e){fS(this,"plugin",void 0),fS(this,"mergedCellsCollection",void 0),fS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,p=this.getFarthestCollection(e,n,r,i);if(p){if(r==="down"){const C=p.row+p.rowspan-a-g;o[2]+C>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?C:0}else if(r==="right"){const C=p.col+p.colspan-l-g;o[3]+C>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?C:0}else if(r==="up"){const C=u-g-p.row+1;o[0]+C<0?o[0]+=g:o[0]-=g?C:0}else if(r==="left"){const C=c-g-p.col+1;o[1]+C<0?o[1]+=g:o[1]-=g?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),fn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,p=d-g;let C=null,E=null,y=null;switch(r){case"up":C="includesVertically",y=c-p+1;break;case"left":C="includesHorizontally",y=c-p+1;break;case"down":C="includesVertically",y=h+p-1;break;case"right":C="includesHorizontally",y=h+p-1;break}return x(i,T=>{T[C](y)&&T.isFarther(E,r)&&(E=T)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return x(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:p}=g;return p===h.getWidth()}):!f.every(g=>{let{rowspan:p}=g;return p===h.getHeight()})}}function gS(t,e,n){return(e=Bye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bye(t){var e=Wye(t,"string");return typeof e=="symbol"?e:e+""}function Wye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jye{constructor(e){gS(this,"plugin",void 0),gS(this,"hot",void 0),gS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Uye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(GT)}return this.getTranslatedPhrase(YT)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?$o.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function wf(t,e,n){return(e=zye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zye(t){var e=Yye(t,"string");return typeof e=="symbol"?e:e+""}function Yye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lA{constructor(e){wf(this,"data",void 0),wf(this,"next",null),wf(this,"prev",null),this.data=e}}class fp{constructor(){wf(this,"first",null),wf(this,"last",null)}push(e){const n=new lA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new lA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Gye(t,e){SV(t,e),e.add(t)}function Vl(t,e,n){SV(t,e),e.set(t,n)}function SV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ct(t,e){return t.get(lv(t,e))}function Wr(t,e,n){return t.set(lv(t,e),n),n}function lv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var To=new WeakMap,Mo=new WeakMap,_o=new WeakMap,xo=new WeakMap,v0=new WeakMap,gp=new WeakMap,mp=new WeakMap,mS=new WeakSet;class Kye{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Gye(this,mS),Vl(this,To,new fp),Vl(this,Mo,new fp),Vl(this,_o,null),Vl(this,xo,null),Vl(this,v0,null),Vl(this,gp,null),Vl(this,mp,null),Wr(v0,this,n),Wr(gp,this,r),Wr(mp,this,i)}getCurrentVerticalNode(){return ct(xo,this).data}getFirstVerticalNode(){return ct(Mo,this).first.data}getNextVerticalNode(){return ct(xo,this).next.data}getPrevVerticalNode(){return ct(xo,this).prev.data}getCurrentHorizontalNode(){return ct(_o,this).data}getFirstHorizontalNode(){return ct(To,this).first.data}getNextHorizontalNode(){return ct(_o,this).next.data}getPrevHorizontalNode(){return ct(_o,this).prev.data}setPrevNodeAsActive(){Wr(xo,this,ct(xo,this).prev),Wr(_o,this,ct(_o,this).prev)}setNextNodeAsActive(){Wr(xo,this,ct(xo,this).next),Wr(_o,this,ct(_o,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Wr(To,this,new fp);for(let s=n.row;s<=r.row;s++)if(!ct(gp,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(ct(mp,this).isHidden(a))continue;const l=lv(mS,this,uA).call(this,e,ct(To,this),i,s,a);l&&Wr(_o,this,l)}ct(To,this).first&&(ct(To,this).first.prev=ct(To,this).last,ct(To,this).last.next=ct(To,this).first);const o=new WeakSet;Wr(Mo,this,new fp);for(let s=n.col;s<=r.col;s++)if(!ct(mp,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(ct(gp,this).isHidden(a))continue;const l=lv(mS,this,uA).call(this,e,ct(Mo,this),o,a,s);l&&Wr(xo,this,l)}ct(Mo,this).first&&(ct(Mo,this).first.prev=ct(Mo,this).last,ct(Mo,this).last.next=ct(Mo,this).first)}setActiveNode(e,n){return ct(To,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Wr(_o,this,r),!1}),ct(Mo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Wr(xo,this,r),!1}),this}}function uA(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=ct(v0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function RV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function qye(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!ke(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),$f()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[p,C]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if($f()&&d===0&&!e.getSettings().rowHeaders){const B=RV(e,h,g);i.set(l,B/g)}const y=n.getRenderableFromVisualIndex(l),T=r.getRenderableFromVisualIndex(u),M=p-y+1,I=C-T+1;let _=n.getNearestNotHiddenIndex(h,1),P=r.getNearestNotHiddenIndex(d,1);if(E){const B=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(B)||(_=Math.max(_,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(B)||(P=Math.max(P,e.getFirstRenderedVisibleColumn()))}const Y=Math.min(g,M),V=Math.min(f,I);_===l&&P===u?(a.setAttribute("rowspan",Y),a.setAttribute("colspan",V)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function Xye(t,e){EV(t,e),e.add(t)}function pp(t,e,n){EV(t,e),e.set(t,n)}function EV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pS(t,e,n){return(e=Jye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jye(t){var e=Zye(t,"string");return typeof e=="symbol"?e:e+""}function Zye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qf(t,e,n){return t.set(mt(t,e),n),n}function Rt(t,e){return t.get(mt(t,e))}function mt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeMergeCells");ie.getSingleton().register("afterMergeCells");ie.getSingleton().register("beforeUnmergeCells");ie.getSingleton().register("afterUnmergeCells");const y0="mergeCells",Qye=150,cA=y0;var Ci=new WeakMap,Si=new WeakMap,Uo=new WeakMap,hA=new WeakMap,Ct=new WeakSet;class eCe extends Qe{constructor(){super(...arguments),Xye(this,Ct),pS(this,"mergedCellsCollection",null),pS(this,"autofillCalculations",null),pS(this,"selectionCalculations",null),pp(this,Ci,null),pp(this,Si,{row:0,col:0}),pp(this,Uo,new Kye({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),pp(this,hA,qye(this))}static get PLUGIN_KEY(){return y0}static get PLUGIN_PRIORITY(){return Qye}static get DEFAULT_SETTINGS(){return{[UL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[y0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new av(this),this.autofillCalculations=new Vye(this),this.selectionCalculations=new jye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,tCe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,rCe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,iCe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,oCe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,sCe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,fA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,fA).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,lCe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,uCe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,cCe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,dA).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,dA).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,nCe).call(e,...r)}),this.addHook("afterRenderer",function(){return Rt(hA,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,aCe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,hCe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,dCe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,fCe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,gCe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,mCe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,pCe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,wCe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,vCe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,yCe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,CCe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,bCe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,SCe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,RCe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mt(Ct,e,ECe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!YE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Hf(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Hf(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?$o.containsNegativeValues(e)?(it($o.NEGATIVE_VALUES_WARNING(e)),!1):$o.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(it($o.IS_OUT_OF_BOUNDS_WARNING(e)),!1):$o.isSingleCell(e)?(it($o.IS_SINGLE_CELL(e)),!1):$o.containsZeroSpan(e)?(it($o.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),x(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:cA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(ke(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(ke(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(ke(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(ke(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function tCe(){this.generateFromSettings(),this.hot.render()}function nCe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function rCe(t){Rt(Si,this).row=t.row,Rt(Si,this).col=t.col}function iCe(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;Rt(Ci,this)&&(i.getRenderableFromVisualIndex(Rt(Ci,this).row)!==null&&(n.row=Rt(Ci,this).row),r.getRenderableFromVisualIndex(Rt(Ci,this).col)!==null&&(n.col=Rt(Ci,this).col),qf(Ci,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function oCe(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function sCe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){qf(Ci,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);qf(Ci,this,e.clone()),n&&e.assign(n)}function dA(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),p=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Xe(g,u,h),Xe(p,c,d),Xe(this.hot.getLastRenderedVisibleRow(),u,h),Xe(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function aCe(t){t.items.push({name:"---------"},Uye(this))}function fA(){qf(Ci,this,null)}function lCe(){if(Rt(Ci,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=Rt(Ci,this).clone().normalize();Rt(Uo,this).setActiveNode(r.row,r.col),Rt(Si,this).row>0||Rt(Si,this).col>0?Rt(Uo,this).setPrevNodeAsActive():(n==="E-W"&&Rt(Si,this).col<0||e==="S-N"&&Rt(Si,this).row<0)&&Rt(Uo,this).setNextNodeAsActive()}function uCe(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(Rt(Si,this).col<0){const{rowEnd:a,colEnd:l}=Rt(Uo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(Rt(Si,this).col>0){const{rowStart:a,colStart:l}=Rt(Uo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(Rt(Si,this).row<0){const{rowEnd:a,colEnd:l}=Rt(Uo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(Rt(Si,this).row>0){const{rowStart:a,colStart:l}=Rt(Uo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}Rt(Uo,this).setActiveNode(t,e),qf(Si,this,{row:0,col:0})}function cCe(){this.hot.getSelectedRangeLast().isHeader()||Rt(Uo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function hCe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function dCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function fCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function gCe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function mCe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function pCe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function wCe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function vCe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function yCe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function CCe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);x(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function bCe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function SCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function RCe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function ECe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,RV(this.hot,e,g))}),t}function TCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:eF(u.type))(l,u,d)(c,h);if(g===Xo){const p=a+1;if(typeof e[p]<"u")return s(p)}return g}(0)}}const TV="sort";function MCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${TV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function _Ce(t){const e=t.className.split(" "),n=new RegExp(`^${TV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function xCe(t,e,n){return(e=PCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PCe(t){var e=ICe(t,"string");return typeof e=="symbol"?e:e+""}function ICe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uv="multiColumnSorting",OCe=170,gA=uv;QL(uv,TCe);class ACe extends uF{constructor(){super(...arguments),xCe(this,"pluginKey",uv)}static get PLUGIN_KEY(){return uv}static get PLUGIN_PRIORITY(){return OCe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Uw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:el,position:"before",group:gA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),pe(e,_Ce(e)),this.enabled!==!1&&q(e,MCe(...r))}onAfterOnCellMouseDown(e,n){S_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Uw))):this.sort(this.getColumnNextConfig(n.col)))}}function mA(t,e,n){return(e=HCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HCe(t){var e=NCe(t,"string");return typeof e=="symbol"?e:e+""}function NCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DCe="multipleSelectionHandles",$Ce=160;class kCe extends Qe{constructor(){super(...arguments),mA(this,"dragged",[]),mA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return DCe}static get PLUGIN_PRIORITY(){return $Ce}isEnabled(){return Go()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(we(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(we(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(we(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(we(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function C0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function MV(){return{label:"",isPlaceholder:!0}}function LCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;x(t,i=>{const o=[];let s=0;n.push(o),x(i,a=>{const l=C0();if(ke(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=It(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=It(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(MV());return!u})});const r=Math.max(...Ke(n,i=>i.length));return x(n,i=>{if(i.length<r){const o=Ke(new Array(r-i.length),()=>C0());i.splice(i.length,0,...o)}}),n}function wS(t,e,n){FCe(t,e),e.set(t,n)}function FCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bi(t,e){return t.get(_V(t,e))}function Pd(t,e,n){return t.set(_V(t,e),n),n}function _V(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pA=["label","collapsible"];var bs=new WeakMap,Bl=new WeakMap,vS=new WeakMap;class VCe{constructor(){wS(this,bs,[]),wS(this,Bl,0),wS(this,vS,1/0)}setColumnsLimit(e){Pd(vS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Pd(bs,this,LCe(e,Bi(vS,this))),Pd(Bl,this,Bi(bs,this).length)}getData(){return Bi(bs,this)}mergeWith(e){x(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&fn(s,o,pA)})}map(e){x(Bi(bs,this),n=>{x(n,r=>{const i=e({...r});ke(i)&&fn(r,i,pA)})})}getHeaderSettings(e,n){var r;if(e>=Bi(Bl,this)||e<0)return null;const i=Bi(bs,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Bi(Bl,this)||e<0)return i;const o=Bi(bs,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Bi(Bl,this)}getColumnsCount(){return Bi(Bl,this)>0?Bi(bs,this)[0].length:0}clear(){Pd(bs,this,[]),Pd(Bl,this,0)}}function yS(t,e,n){return(e=BCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BCe(t){var e=WCe(t,"string");return typeof e=="symbol"?e:e+""}function WCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xV="DF-pre-order";function PV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=PV.call(this.childs[r],t,e)}return n}const jCe="DF-post-order";function IV(t,e){for(let n=0;n<this.childs.length;n++)if(IV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const OV="BF";function UCe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const zCe=OV,wA=new Map([[xV,PV],[jCe,IV],[OV,UCe]]);class cv{constructor(e){yS(this,"data",{}),yS(this,"parent",null),yS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new cv({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zCe;if(!wA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);wA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function CS(t,e,n){YCe(t,e),e.set(t,n)}function YCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ar(t,e){return t.get(AV(t,e))}function GCe(t,e,n){return t.set(AV(t,e),n),n}function AV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pc=new WeakMap,Wl=new WeakMap,wc=new WeakMap;class KCe{constructor(e){CS(this,pc,new Map),CS(this,Wl,new Map),CS(this,wc,null),GCe(wc,this,e)}getRoots(){return Array.from(ar(pc,this).values())}getRootByColumn(e){let n;return ar(Wl,this).has(e)&&(n=ar(pc,this).get(ar(Wl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-ar(Wl,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;ar(Wl,this).clear(),x(ar(pc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)ar(Wl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=ar(wc,this).getColumnsCount();let n=0;for(;n<e;){const r=ar(wc,this).getHeaderSettings(0,n),i=new cv;ar(pc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=ar(wc,this).getHeadersSettings(r,n,i);r+=1,x(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new cv(a),e.addChild(l)),r<ar(wc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){ar(pc,this).clear(),ar(Wl,this).clear()}}function HV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function hv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function dv(t){return hv(t,"origColspan")===t.data.origColspan}function k_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(dv(t))return k_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)x(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,HV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):dv(a)&&(l.isCollapsed=hv(a,"isCollapsed"))}),{rollbackModification:()=>L_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function L_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(dv(t))return L_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)x(o,l=>{HV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=hv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):dv(l)&&(u.isCollapsed=hv(l,"isCollapsed"))}),{rollbackModification:()=>k_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function qCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(gt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function XCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(gt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const vA=new Map([["collapse",L_],["expand",k_],["hide-column",qCe],["show-column",XCe]]);function JCe(t,e,n){if(!vA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return vA.get(t)(e,n)}function wp(t){const e=[];return x(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=QCe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(MV());else{const f=ZCe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function ZCe(t){const{crossHiddenColumns:e,...n}=C0(t);return n}function QCe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function bS(t,e,n){ebe(t,e),e.set(t,n)}function ebe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Id(t,e,n){return t.set(NV(t,e),n),n}function Ut(t,e){return t.get(NV(t,e))}function NV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Po=new WeakMap,Er=new WeakMap,jl=new WeakMap;class tbe{constructor(){bS(this,Po,new VCe),bS(this,Er,new KCe(Ut(Po,this))),bS(this,jl,[[]])}setState(e){Ut(Po,this).setData(e);let n=!1;try{Ut(Er,this).buildTree()}catch{Ut(Er,this).clear(),Ut(Po,this).clear(),n=!0}return Id(jl,this,wp(Ut(Er,this).getRoots())),n}setColumnsLimit(e){Ut(Po,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ke(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Ut(Po,this).mergeWith(n),Ut(Er,this).buildTree(),Id(jl,this,wp(Ut(Er,this).getRoots()))}mapState(e){Ut(Po,this).map(e),Ut(Er,this).buildTree(),Id(jl,this,wp(Ut(Er,this).getRoots()))}mapNodes(e){return Tn(Ut(Er,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Ut(Er,this).getNode(n,r);let o;return i&&(o=JCe(e,i,r),Id(jl,this,wp(Ut(Er,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Ut(jl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Ut(Er,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Ut(Er,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},xV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Ut(Po,this).getLayersCount()}getColumnsCount(){return Ut(Po,this).getColumnsCount()}clear(){Id(jl,this,[]),Ut(Po,this).clear(),Ut(Er,this).clear()}}function Od(t,e,n){return(e=nbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nbe(t){var e=rbe(t,"string");return typeof e=="symbol"?e:e+""}function rbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ibe{constructor(e,n){Od(this,"hot",void 0),Od(this,"nestedHeaderSettingsGetter",void 0),Od(this,"layersCount",0),Od(this,"container",void 0),Od(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),Au(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function obe(t,e){DV(t,e),e.add(t)}function yA(t,e,n){return(e=sbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sbe(t){var e=abe(t,"string");return typeof e=="symbol"?e:e+""}function abe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ad(t,e,n){DV(t,e),e.set(t,n)}function DV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bs(t,e,n){return t.set(zt(t,e),n),n}function Ge(t,e){return t.get(zt(t,e))}function zt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const CA="nestedHeaders",lbe=280;var wt=new WeakMap,wa=new WeakMap,vf=new WeakMap,My=new WeakMap,fv=new WeakMap,Zt=new WeakSet;class ube extends Qe{constructor(){super(...arguments),obe(this,Zt),Ad(this,wt,new tbe),Ad(this,wa,null),Ad(this,vf,null),Ad(this,My,!1),Ad(this,fv,null),yA(this,"ghostTable",new ibe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),yA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return CA}static get PLUGIN_PRIORITY(){return lbe}isEnabled(){return!!this.hot.getSettings()[CA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&it(gt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>zt(Zt,this,Tbe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,Mbe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,fbe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,gbe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,mbe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,pbe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,wbe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,vbe).call(e,...i)}),this.addHook("afterSelection",()=>zt(Zt,this,vp).call(this)),this.addHook("afterSelectionFocusSet",()=>zt(Zt,this,vp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,cbe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>zt(Zt,this,Cbe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,Sbe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,Rbe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,hbe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,dbe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,ybe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,bbe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return zt(Zt,e,Ebe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>zt(Zt,this,vp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>zt(Zt,this,vp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ge(wt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ge(wt,this).setState(e)),this.detectedOverlappedHeaders&&it(gt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Ge(wt,this).triggerColumnModification(i,r)}),!Ge(wa,this)&&this.enabled&&Bs(wa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";Ge(wt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ge(wt,this).clear(),Ge(wa,this).unsubscribe(),Bs(wa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ge(wt,this)}getLayersCount(){return Ge(wt,this).getLayersCount()}getHeaderSettings(e,n){return Ge(wt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),pe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),pe(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),pe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),pe(o,"hiddenHeader"),pe(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Ge(wt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,p,C;const{wtOverlays:E}=l._wt,y=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),T=(p=E.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o);((C=E.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const I=y||T?Math.min(c,r-i):c;I>1&&o.setAttribute("colspan",I)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(pe(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=Ge(wt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Bs(wt,this,null),Ge(wa,this)!==null&&(Ge(wa,this).unsubscribe(),Bs(wa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ge(wt,this).getHeaderTreeNodeData(e.row,e.col)}}function vp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=Ge(wt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function cbe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=Ge(fv,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(Bs(fv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Ge(wt,this).findLeftMostColumnIndex(a,l),g=Ge(wt,this).findRightMostColumnIndex(a,l),p=g-f+1;if(f<c&&g>h)return f;if(s){let C=null;return f>=c&&g>h?p>d?(e.value="start",C=f):(e.value="end",C=g):f<c&&g<=h&&(p>d?(e.value="end",C=g):(e.value="start",C=f)),C}return f<=c?f:g}function hbe(t,e,n){const r=Ge(wt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Ge(wt,this).getHeaderSettings(e,t);if(o===cT){if(!a)return r.columnIndex}else if(o===Dk&&(l>s-i||!a))return null;return t}function dbe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,p=d-a;if(p===0)continue;((i=Ge(wt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][p]="")}}}function fbe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function gbe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Bs(vf,this,e.clone()),Bs(My,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(qv(t)||Ka(t)&&l||lk(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function mbe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Xe(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function pbe(){Bs(My,this,!1)}function wbe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ge(My,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=Ge(wt,this).getHeaderTreeNodeData(Ge(vf,this).row,Ge(vf,this).col);if(e.setHighlight(Ge(vf,this)),o>e.getWidth()||i<n||i+o-1>r){const s=Ge(wt,this).findTopMostEntireHeaderLevel(Xe(n,i,i+o-1),Xe(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function vbe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Ge(wt,this).findLeftMostColumnIndex(n.row,n.col),o=Ge(wt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function ybe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Bs(fv,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function Cbe(t){if(Ge(wt,this).getLayersCount()>0){t.length=0;for(let e=0;e<Ge(wt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function bbe(t){const e=Ge(wt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=Ge(wt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Xn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?Ge(wt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Sbe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Rbe(t,e,n){var r;const{label:i}=(r=Ge(wt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Ebe(t,e){if(t<0)return this.hot.getCell(t,Ge(wt,this).findLeftMostColumnIndex(t,e),!0)}function Tbe(){this.updatePlugin()}function Mbe(t,e){e||this.updatePlugin()}function Hd(t,e,n){return(e=_be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _be(t){var e=xbe(t,"string");return typeof e=="symbol"?e:e+""}function xbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pbe{constructor(e,n){Hd(this,"hot",void 0),Hd(this,"data",null),Hd(this,"plugin",void 0),Hd(this,"parentReference",new WeakMap),Hd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&x(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&x(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Le(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(x(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];x(r,o=>{i.push(this.getDataObject(o))}),x(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function bA(t,e,n){return(e=Ibe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ibe(t){var e=Obe(t,"string");return typeof e=="symbol"?e:e+""}function Obe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F_{constructor(e,n){bA(this,"hot",void 0),bA(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Fo extends F_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(x(l,c=>{c&&s.removeChild(c)}),q(n,Fo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");q(d,Fo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ce(c,[Iu()]),q(n,Fo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${Fo.CSS_CLASSES.button} ${Fo.CSS_CLASSES.expandButton}`),u&&Ce(n,[Ri(!1)])):(q(c,`${Fo.CSS_CLASSES.button} ${Fo.CSS_CLASSES.collapseButton}`),u&&Ce(n,[Ri(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class Abe extends F_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),x(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&x(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];x(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return x(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);x(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return x(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);x(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&x(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];x(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];x(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];x(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{x(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{x(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&x(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);we(e.target,Fo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ai(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Hbe(t,e,n){Nbe(t,e),e.set(t,n)}function Nbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dbe(t,e,n){return(e=$be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $be(t){var e=kbe(t,"string");return typeof e=="symbol"?e:e+""}function kbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lbe(t,e){return t.get(Fbe(t,e))}function Fbe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var SA=new WeakMap;class Vbe extends F_{constructor(){super(...arguments),Dbe(this,"dataManager",this.plugin.dataManager),Hbe(this,SA,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(dM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(fM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return x(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=Lbe(SA,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function yp(t,e,n){return(e=Bbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bbe(t){var e=Wbe(t,"string");return typeof e=="symbol"?e:e+""}function Wbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jbe{constructor(e){yp(this,"plugin",void 0),yp(this,"hot",void 0),yp(this,"dataManager",void 0),yp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(p,a),p}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Lt(i)&&(it(gt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Ube(t,e){$V(t,e),e.add(t)}function RA(t,e,n){$V(t,e),e.set(t,n)}function $V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SS(t,e,n){return(e=zbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zbe(t){var e=Ybe(t,"string");return typeof e=="symbol"?e:e+""}function Ybe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nw(t,e){return t.get(xn(t,e))}function gv(t,e,n){return t.set(xn(t,e),n),n}function xn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mv="nestedRows",Gbe=300,EA=mv,Kbe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var _y=new WeakMap,vc=new WeakMap,Nn=new WeakSet;class qbe extends Qe{constructor(){super(...arguments),Ube(this,Nn),SS(this,"dataManager",null),SS(this,"headersUI",null),SS(this,"collapsedRowsMap",null),RA(this,_y,!1),RA(this,vc,!1)}static get PLUGIN_KEY(){return mv}static get PLUGIN_PRIORITY(){return Gbe}isEnabled(){return!!this.hot.getSettings()[mv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Eg),this.dataManager=new Pbe(this,this.hot),this.collapsingUI=new Abe(this,this.hot),this.headersUI=new Fo(this,this.hot),this.contextMenuUI=new Vbe(this,this.hot),this.rowMoveController=new jbe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,uSe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,cSe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,Zbe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,Qbe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,eSe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,Jbe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,rSe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,nSe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,iSe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,oSe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,sSe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,aSe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,tSe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,lSe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xn(Nn,e,Xbe).call(e,...r)}),this.addHook("beforeLoadData",n=>xn(Nn,this,TA).call(this,n)),this.addHook("beforeUpdateData",n=>xn(Nn,this,TA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:EA,relativeToGroup:el,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(EA)}disableCoreAPIModifiers(){gv(vc,this,!0)}enableCoreAPIModifiers(){gv(vc,this,!1)}onModifyRowData(e){if(!nw(vc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!nw(vc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return nw(vc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Xbe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Jbe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Zbe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),gv(_y,this,!0),this.dataManager.getData().slice()}function Qbe(t){return this.contextMenuUI.appendOptions(t)}function eSe(t,e){this.headersUI.appendLevelIndicators(t,e)}function tSe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function nSe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{gv(_y,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function rSe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function iSe(){this.collapsingUI.collapsedRowsStash.stash()}function oSe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function sSe(){this.collapsingUI.collapsedRowsStash.stash()}function aSe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function lSe(){this.dataManager.rewriteCache()}function uSe(){this.headersUI.updateRowHeaderWidth()}function cSe(t,e){nw(_y,this)&&(e.skipRender=!0)}function TA(t){if(!Yk(t)){XE(Kbe),this.hot.getSettings()[mv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function RS(t,e,n){return(e=hSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hSe(t){var e=dSe(t,"string");return typeof e=="symbol"?e:e+""}function dSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fSe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;RS(this,"rootWindow",void 0),RS(this,"prefix",void 0),RS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){x(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function gSe(t,e,n){return(e=mSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mSe(t){var e=pSe(t,"string");return typeof e=="symbol"?e:e+""}function pSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ie.getSingleton().register("persistentStateSave");ie.getSingleton().register("persistentStateLoad");ie.getSingleton().register("persistentStateReset");const MA="persistentState",wSe=0;class vSe extends Qe{constructor(){super(...arguments),gSe(this,"storage",void 0)}static get PLUGIN_KEY(){return MA}static get PLUGIN_PRIORITY(){return wSe}isEnabled(){return!!this.hot.getSettings()[MA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new fSe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function ySe(t,e){CSe(t,e),e.add(t)}function CSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ES(t,e,n){return(e=bSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bSe(t){var e=SSe(t,"string");return typeof e=="symbol"?e:e+""}function SSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _A(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TS="search",RSe=190,ESe="htSearchResult",TSe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},MSe=function(t,e,n){return Lt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Lt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var MS=new WeakSet;class _Se extends Qe{constructor(){super(...arguments),ySe(this,MS),ES(this,"callback",TSe),ES(this,"queryMethod",MSe),ES(this,"searchResultClass",ESe)}static get PLUGIN_KEY(){return TS}static get PLUGIN_PRIORITY(){return RSe}isEnabled(){return this.hot.getSettings()[TS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[TS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _A(MS,e,xA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _A(MS,e,xA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const p={row:l,col:u,data:c};s.push(p)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){ke(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function xA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Cp(t,e,n){return(e=xSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xSe(t){var e=PSe(t,"string");return typeof e=="symbol"?e:e+""}function PSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kV{constructor(e){Cp(this,"viewportWidth",void 0),Cp(this,"overwriteColumnWidthFn",void 0),Cp(this,"baseWidths",new Map),Cp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class ISe extends kV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=nh?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=nh){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,p=g;o.includes(f)||(p=Math.round(g*l)),this.stretchedWidths.set(f,p),u=f,d<i.length-1&&(c+=p)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function PA(t,e,n){OSe(t,e),e.set(t,n)}function OSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _S(t,e){return t.get(LV(t,e))}function bp(t,e,n){return t.set(LV(t,e),n),n}function LV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sp=new WeakMap,Nd=new WeakMap;class ASe extends kV{constructor(){super(...arguments),PA(this,Sp,0),PA(this,Nd,-1)}prepare(e){super.prepare(e),bp(Sp,this,0),bp(Nd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),bp(Nd,this,e),bp(Sp,this,n)}calculate(){if(_S(Nd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+_S(Sp,this),0);this.stretchedWidths.set(_S(Nd,this),n)}}function HSe(t,e){FV(t,e),e.add(t)}function Rp(t,e,n){FV(t,e),e.set(t,n)}function FV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qt(t,e){return t.get(kc(t,e))}function xS(t,e,n){return t.set(kc(t,e),n),n}function kc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const NSe="stretchColumns";var qn=new WeakMap,yc=new WeakMap,PS=new WeakMap,Ep=new WeakMap,Dd=new WeakSet;class DSe{constructor(e){HSe(this,Dd),Rp(this,qn,void 0),Rp(this,yc,void 0),Rp(this,PS,new Map([["all",new ISe(kc(Dd,this,IA).bind(this))],["last",new ASe(kc(Dd,this,IA).bind(this))]])),Rp(this,Ep,"none"),xS(qn,this,e),xS(yc,this,Qt(qn,this).columnIndexMapper.createAndRegisterIndexMap(NSe,"physicalIndexToValue"))}useStrategy(e){xS(Ep,this,Qt(PS,this).has(e)?e:"none")}refreshStretching(){if(Qt(Ep,this)==="none"){Qt(yc,this).clear();return}Qt(qn,this).batchExecution(()=>{Qt(yc,this).clear();const e=Qt(PS,this).get(Qt(Ep,this));let r=Qt(qn,this).view.getViewportWidth();kc(Dd,this,$Se).call(this)&&(r-=In(Qt(qn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Qt(qn,this).countCols();i++)Qt(qn,this).columnIndexMapper.isHidden(Qt(qn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,kc(Dd,this,kSe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Qt(yc,this).setValueAtIndex(Qt(qn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Qt(yc,this).getValueAtIndex(Qt(qn,this).toPhysicalColumn(e))}}function $Se(){const{view:t}=Qt(qn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Qt(qn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=Qt(qn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function kSe(t){var e;return(e=Qt(qn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:nh}function IA(t,e){return Qt(qn,this).runHooks("beforeStretchingColumnWidth",t,e)}function LSe(t,e){VV(t,e),e.add(t)}function IS(t,e,n){VV(t,e),e.set(t,n)}function VV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OS(t,e,n){return t.set(pv(t,e),n),n}function _s(t,e){return t.get(pv(t,e))}function pv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const FSe="stretchColumns",VSe=155;var xc=new WeakMap,Tp=new WeakMap,$d=new WeakMap,AS=new WeakSet;class BSe extends Qe{constructor(){super(...arguments),LSe(this,AS),IS(this,xc,new DSe(this.hot)),IS(this,Tp,null),IS(this,$d,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;_s(Tp,this)!==null&&_s(Tp,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),OS(Tp,this,i.width)})})}))}static get PLUGIN_KEY(){return FSe}static get PLUGIN_PRIORITY(){return VSe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(_s(xc,this).useStrategy(this.hot.getSettings().stretchH),_s($d,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pv(AS,e,jSe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pv(AS,e,WSe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){_s(xc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),_s($d,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return _s(xc,this).getStretchedWidth(e)}destroy(){_s($d,this).disconnect(),OS($d,this,null),OS(xc,this,null),super.destroy()}}function WSe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function jSe(t){t&&_s(xc,this).refreshStretching()}function USe(t,e){zSe(t,e),e.add(t)}function zSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mp(t,e,n){return(e=YSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YSe(t){var e=GSe(t,"string");return typeof e=="symbol"?e:e+""}function GSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const KSe="touchScroll",qSe=200;var _p=new WeakSet;class XSe extends Qe{constructor(){super(...arguments),USe(this,_p),Mp(this,"scrollbars",[]),Mp(this,"clones",[]),Mp(this,"lockedCollection",!1),Mp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return KSe}static get PLUGIN_PRIORITY(){return qSe}static get SETTING_KEYS(){return!0}isEnabled(){return zE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>HS(_p,this,JSe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>HS(_p,this,ZSe).call(this)),this.addHook("afterMomentumScroll",()=>HS(_p,this,QSe).call(this))}}function JSe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function ZSe(){this.freezeOverlays=!0,x(this.clones,t=>{q(t,"hide-tween")})}function QSe(){this.freezeOverlays=!1,x(this.clones,t=>{pe(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{x(this.clones,t=>{pe(t,"show-tween")})},400),x(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function eRe(t,e){tRe(t,e),e.add(t)}function tRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nRe(t,e,n){return(e=rRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rRe(t){var e=iRe(t,"string");return typeof e=="symbol"?e:e+""}function iRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oRe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rw="trimRows",sRe=330;var OA=new WeakSet;class aRe extends Qe{constructor(){super(...arguments),eRe(this,OA),nRe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return rw}static get PLUGIN_PRIORITY(){return sRe}isEnabled(){return!!this.hot.getSettings()[rw]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Eg),this.trimmedRowsMap.addLocalHook("init",()=>oRe(OA,this,lRe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[rw];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),x(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(x(e,l=>{o[l]=!1}),i=Tn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function lRe(){const t=this.hot.getSettings()[rw];Array.isArray(t)&&this.hot.batchExecution(()=>{x(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function uRe(t,e,n){return(e=cRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cRe(t){var e=hRe(t,"string");return typeof e=="symbol"?e:e+""}function hRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hi{constructor(e){uRe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function xp(t,e,n){return(e=dRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dRe(t){var e=fRe(t,"string");return typeof e=="symbol"?e:e+""}function fRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V_ extends Hi{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),xp(this,"stateBefore",void 0),xp(this,"range",void 0),xp(this,"type",void 0),xp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new V_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){x(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Ca(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function AA(t,e,n){return(e=gRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gRe(t){var e=mRe(t,"string");return typeof e=="symbol"?e:e+""}function mRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B_ extends Hi{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),AA(this,"columns",void 0),AA(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new B_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),D_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function HA(t,e,n){return(e=pRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pRe(t){var e=wRe(t,"string");return typeof e=="symbol"?e:e+""}function wRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W_ extends Hi{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),HA(this,"previousSortState",void 0),HA(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new W_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function NA(t,e,n){return(e=vRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vRe(t){var e=yRe(t,"string");return typeof e=="symbol"?e:e+""}function yRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j_ extends Hi{constructor(e){let{index:n,amount:r}=e;super("insert_col"),NA(this,"index",void 0),NA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new j_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function DA(t,e,n){return(e=CRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CRe(t){var e=bRe(t,"string");return typeof e=="symbol"?e:e+""}function bRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U_ extends Hi{constructor(e){let{index:n,amount:r}=e;super("insert_row"),DA(this,"index",void 0),DA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new U_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Pp(t,e,n){return(e=SRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SRe(t){var e=RRe(t,"string");return typeof e=="symbol"?e:e+""}function RRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z_ extends Hi{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Pp(this,"changes",void 0),Pp(this,"selected",void 0),Pp(this,"countCols",void 0),Pp(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new z_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=nr(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=nr(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function $A(t,e,n){return(e=ERe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ERe(t){var e=TRe(t,"string");return typeof e=="symbol"?e:e+""}function TRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y_ extends Hi{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),$A(this,"conditionsStack",void 0),$A(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new Y_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function MRe(t,e,n){return(e=_Re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Re(t){var e=xRe(t,"string");return typeof e=="symbol"?e:e+""}function xRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G_ extends Hi{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),MRe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new G_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function BV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Ss(t,e,n){return(e=PRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PRe(t){var e=IRe(t,"string");return typeof e=="symbol"?e:e+""}function IRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K_ extends Hi{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Ss(this,"index",void 0),Ss(this,"indexes",void 0),Ss(this,"data",void 0),Ss(this,"amount",void 0),Ss(this,"headers",void 0),Ss(this,"columnPositions",void 0),Ss(this,"rowPositions",void 0),Ss(this,"fixedColumnsStart",void 0),Ss(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const p=[],C=l[g];fe(u,c,E=>{p.push(C[e.toPhysicalColumn(E)])}),h.push(p)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new K_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:BV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ke(this.data[c],o));const l=Ke(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),x(e.getSourceDataArray(),(c,h)=>{x(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&x(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Cc(t,e,n){return(e=ORe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ORe(t){var e=ARe(t,"string");return typeof e=="symbol"?e:e+""}function ARe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q_ extends Hi{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Cc(this,"index",void 0),Cc(this,"data",void 0),Cc(this,"fixedRowsBottom",void 0),Cc(this,"fixedRowsTop",void 0),Cc(this,"rowIndexesSequence",void 0),Cc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=nr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new q_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:BV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function kA(t,e,n){return(e=HRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HRe(t){var e=NRe(t,"string");return typeof e=="symbol"?e:e+""}function NRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X_ extends Hi{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),kA(this,"rows",void 0),kA(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new X_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),D_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function DRe(t,e,n){return(e=$Re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Re(t){var e=kRe(t,"string");return typeof e=="symbol"?e:e+""}function kRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J_ extends Hi{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),DRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new J_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function LRe(t,e){[V_,B_,W_,j_,U_,z_,Y_,G_,K_,q_,X_,J_].forEach(n=>n.startRegisteringEvents(t,e))}function FRe(t,e){VRe(t,e),e.add(t)}function VRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NS(t,e,n){return(e=BRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BRe(t){var e=WRe(t,"string");return typeof e=="symbol"?e:e+""}function WRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const LA="undoRedo",jRe="undoRedo",URe=1e3;ie.getSingleton().register("beforeUndo");ie.getSingleton().register("afterUndo");ie.getSingleton().register("beforeRedo");ie.getSingleton().register("afterRedo");const FA=new Set;var Ip=new WeakSet;class zRe extends Qe{static get PLUGIN_KEY(){return jRe}static get PLUGIN_PRIORITY(){return URe}static get SETTING_KEYS(){return!0}constructor(e){super(e),FRe(this,Ip),NS(this,"doneActions",[]),NS(this,"undoneActions",[]),NS(this,"ignoreNewActions",!1),LRe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return DS(Ip,e,YRe).call(e,...r)}),this.registerShortcuts(),DS(Ip,this,GRe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),DS(Ip,this,KRe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:LA};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(LA)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=nr(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=nr(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function YRe(t,e){e==="loadData"&&this.clear()}function GRe(){const t=e=>{FA.has(e)||(it(gt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),FA.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function KRe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function qRe(){Ze(nf),Ze(tce),Ze(rf),Ze(Ace),Ze(Vce),Ze(uF),Ze(Dhe),Ze(yde),Ze(Cy),Ze(xfe),Ze(ege),Ze(lge),Ze(Ry),Ze(Uge),Ze(Fpe),Ze(vwe),Ze(zwe),Ze(rve),Ze(mve),Ze(Mve),Ze($ve),Ze(eye),Ze(uye),Ze(eCe),Ze(ACe),Ze(kCe),Ze(ube),Ze(qbe),Ze(vSe),Ze(_Se),Ze(BSe),Ze(XSe),Ze(aRe),Ze(zRe)}function XRe(){Tae(),Kle(),rue(),Rue(),qRe()}function JRe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var $S,kS,LS,FS,VS;XRe();JRe(Te);Te.__GhostTable=y_;Te._getListenersCounter=MZ;Te._getRegisteredMapsCounter=Yre;Te.EventManager=Mi;const ZRe=[x8,$J,Tre,Xle,HJ,pJ,A8,EQ,AJ,N8,FJ,RQ],QRe=[dJ,VJ];Te.helper={};Te.dom={};x(ZRe,t=>{x(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.helper[e]=t[e])})});x(QRe,t=>{x(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.dom[e]=t[e])})});Te.cellTypes=($S=Te.cellTypes)!==null&&$S!==void 0?$S:{};x(Jie(),t=>{Te.cellTypes[t]=ZM(t)});Te.cellTypes.registerCellType=di;Te.cellTypes.getCellType=ZM;Te.editors=(kS=Te.editors)!==null&&kS!==void 0?kS:{};x(CZ(),t=>{Te.editors[`${tr(t)}Editor`]=Aw(t)});Te.editors.registerEditor=Pr;Te.editors.getEditor=Aw;Te.renderers=(LS=Te.renderers)!==null&&LS!==void 0?LS:{};x(FQ(),t=>{const e=Hw(t);t==="base"&&(Te.renderers.cellDecorator=e),Te.renderers[`${tr(t)}Renderer`]=e});Te.renderers.registerRenderer=zr;Te.renderers.getRenderer=Hw;Te.validators=(FS=Te.validators)!==null&&FS!==void 0?FS:{};x(WQ(),t=>{Te.validators[`${tr(t)}Validator`]=rT(t)});Te.validators.registerValidator=Xl;Te.validators.getValidator=rT;Te.plugins=(VS=Te.plugins)!==null&&VS!==void 0?VS:{};x(nT(),t=>{Te.plugins[t]=Cg(t)});Te.plugins[`${tr(Qe.PLUGIN_KEY)}Plugin`]=Qe;Te.plugins.registerPlugin=Ze;Te.plugins.getPlugin=Cg;let yf=null,an=new Map,Pc={row:-1,col:-1,time:0};function Rs(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return t===void 0?(o="undefined",s.readOnly=!1):typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function hi(t,e,n){let r=[],i=!0,o=new Map;const s={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback},a=n.dataPathString||"";if(Array.isArray(t)){const l=t.length>0?t[0]:null;if(l&&typeof l=="object"&&l!==null&&!Array.isArray(l)){let u=Object.keys(l);if(u.length===0){for(let c=1;c<t.length;c++)if(t[c]&&typeof t[c]=="object"&&Object.keys(t[c]).length>0){u=Object.keys(t[c]);break}}i=u.length>0?u:t.length>0?["(내용 없음)"]:["새 열"],t.forEach((c,h)=>{const d=[],f=typeof c=="object"&&c!==null?c:{};i.forEach((g,p)=>{const C=f[g],E=`${a}[${h}]`,{displayValue:y,cellMeta:T}=Rs(C,E,g,!1,s);d.push(y),o.set(`${h}-${p}`,T)}),r.push(d)}),t.length===0&&Array.isArray(i)&&i.length===1&&(i[0]==="새 열"||i[0]==="(내용 없음)"||i[0])}else i=["Index","Value"],r=t.map((u,c)=>{const h=a,{displayValue:d,cellMeta:f}=Rs(c,h,String(c),!0,s),{displayValue:g,cellMeta:p}=Rs(u,h,String(c),!1,s);return o.set(`${c}-0`,f),o.set(`${c}-1`,p),[d,g]})}else if(typeof t=="object"&&t!==null){const l=Object.keys(t);if(l.length>0&&l.every(c=>Array.isArray(t[c]))){let c=0;l.forEach(d=>{c=Math.max(c,t[d].length)});const h=["항목 (Key)"];for(let d=0;d<c;d++)h.push(String(d));i=h,r=l.map((d,f)=>{const g=t[d],p=[],C=a,{displayValue:E,cellMeta:y}=Rs(d,C,d,!0,s);p.push(E),o.set(`${f}-0`,y);for(let T=0;T<c;T++)if(T<g.length){const M=g[T],I=`${a?a+".":""}${d}`,{displayValue:_,cellMeta:P}=Rs(M,I,String(T),!1,s);p.push(_),o.set(`${f}-${1+T}`,P)}else p.push(""),o.set(`${f}-${1+T}`,{readOnly:!0,originalValue:null,isPadding:!0});return p})}else i=["항목 (Key)","값 (Value)"],r=l.map((c,h)=>{const d=t[c],f=a,{displayValue:g,cellMeta:p}=Rs(c,f,c,!0,s),{displayValue:C,cellMeta:E}=Rs(d,f,c,!1,s);return o.set(`${h}-0`,p),o.set(`${h}-1`,E),[g,C]})}else{i=["항목","값"];const l=e||(t==null?String(t):"Value"),u=a,{displayValue:c,cellMeta:h}=Rs(l,u,"",!0,s),{displayValue:d,cellMeta:f}=Rs(t,u,"",!1,s);o.set("0-0",h),o.set("0-1",f),r=[[c,d]]}return{preparedHotData:r,preparedColHeaders:i,preparedCellMetaMap:o}}function WV(){return yf&&(yf.destroy(),yf=null),an.clear(),Pc={row:-1,col:-1,time:0},null}function e0e(t,e,n){const r=n.tableViewDomElement;WV(),r&&(r.innerHTML="");const{preparedHotData:i,preparedColHeaders:o,preparedCellMetaMap:s}=hi(t,e,n);return an=s,r?(yf=new Te(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{view_key_content:{name:"내용 보기 (View Content)",hidden:function(){const l=this.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row;if(u.col!==0||typeof t!="object"||t===null||Array.isArray(t))return!0;const d=Object.keys(t);if(c>=d.length)return!0;const f=d[c],g=t[f];return typeof g!="object"||g===null},callback:function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start){console.error("View Content callback: 유효하지 않은 selection 객체입니다.",l);return}const h=l[0].start.row,d=Object.keys(t);if(h>=d.length){console.error("View Content callback: 행 인덱스가 범위를 벗어났습니다.",h,d);return}const f=d[h],g=t[f];if(typeof g!="object"||g===null){console.error("View Content callback: 대상 값이 객체나 배열이 아닙니다.",g),Ie({title:"오류",text:"내용을 볼 수 있는 대상(객체/배열)이 아닙니다.",icon:"error",showCancelButton:!1,hotInstance:u});return}const p=n.dataPathString||"",C=p?`${p}.${f}`:f;n.displayTableCallback(g,f,n.rootJsonData,C)}},row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입"},col_right:{name:"오른쪽에 열 삽입"},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제"},"---------":Te.plugins.ContextMenu.SEPARATOR,duplicate_row:{name:"선택 행 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)||typeof t=="object"&&t!==null&&!Array.isArray(t)):!0},callback:async function(a,l){const u=this,c=l[0].start.row;if(Array.isArray(t)){if(c>=0&&c<t.length){const h=JSON.parse(JSON.stringify(t[c]));t.splice(c+1,0,h),n.refreshTreeViewCallback("row_duplicated_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=hi(t,e,n);an=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}else if(typeof t=="object"&&t!==null){const h=Object.keys(t);if(c<0||c>=h.length)return;const d=h[c];let f=d+"_복제본",g=f,p=1;for(;t.hasOwnProperty(g);)g=`${f}_${p++}`;Vo({title:"새 키 입력 (행 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:C=>{const E=C.trim();return E?E!==d&&t.hasOwnProperty(E)?"이미 사용 중인 키입니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(C=>{if(C.isConfirmed&&C.value!==void 0){const E=C.value.trim(),y=JSON.parse(JSON.stringify(t[d])),T={};for(const P of Object.keys(t))T[P]=t[P],P===d&&(T[E]=y);Object.keys(t).forEach(P=>delete t[P]),Object.assign(t,T),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered");const{preparedHotData:M,preparedColHeaders:I,preparedCellMetaMap:_}=hi(t,e,n);an=_,u.updateSettings({colHeaders:I}),u.loadData(M)}})}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])):!0},callback:async function(a,l){const u=this,c=l[0].start.col,h=u.getColHeader();if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])&&Array.isArray(h)&&c>=0&&c<h.length){const d=h[c];if(typeof d!="string")return;let f=d+"_복제본",g=f,p=1;for(;t[0].hasOwnProperty(g);)g=`${f}_${p++}`;Vo({title:"새 열 키 입력 (열 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:C=>{const E=C.trim();return E?t.length>0&&t[0].hasOwnProperty(E)&&E!==d?"첫 번째 객체에 이미 해당 키가 존재합니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(C=>{if(C.isConfirmed&&C.value!==void 0){const E=C.value.trim();t.forEach(I=>{if(typeof I=="object"&&I!==null){const _=I.hasOwnProperty(d)?JSON.parse(JSON.stringify(I[d])):null,P={};let Y=!1;for(const V in I)I.hasOwnProperty(V)&&(P[V]=I[V],V===d&&(P[E]=_,Y=!0));Y||(P[E]=_),Object.keys(I).forEach(V=>delete I[V]),Object.assign(I,P)}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered");const{preparedHotData:y,preparedColHeaders:T,preparedCellMetaMap:M}=hi(t,e,n);an=M,u.updateSettings({colHeaders:T}),u.loadData(y)}})}}},set_template:{name:"템플릿으로 채우기",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=an.get(`${c}-${h}`);if(d&&d.isPadding)return!0;const f=a.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:an};return kd(c,h,g)===null},callback:async function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col;u&&typeof u.deselectCell=="function"&&u.deselectCell();const f=n.getTemplates();if(!f||f.length===0){Ie({title:"알림",text:"사용 가능한 템플릿이 없습니다. 먼저 템플릿을 추가해주세요.",icon:"info",showCancelButton:!1,hotInstance:u});return}const g={};f.forEach((C,E)=>{g[`tpl_idx_${E}`]=C.name});const{value:p}=await bi.fire({title:"템플릿 선택 (Select Template)",input:"select",inputOptions:g,inputPlaceholder:"적용할 템플릿을 선택하세요",showCancelButton:!0,confirmButtonText:"적용 (Apply)",cancelButtonText:"취소 (Cancel)",customClass:{popup:"custom-swal-popup"}});if(p){const C=parseInt(p.replace("tpl_idx_",""),10),E=f[C].value,y=JSON.stringify(E),T=u.getColHeader(),M={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(T)?T:T===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:an},I=kd(h,d,M);if(I!==null){n.updateJsonDataCallback(I,y,!1);let _=t;const P=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;n.dataPathString?_=n.getObjectByPathCallback(P,n.dataPathString):_=P,_===void 0&&(_=I.includes("[")||I.includes(".")?{}:null);const{preparedHotData:Y,preparedColHeaders:V,preparedCellMetaMap:B}=hi(_,e,n);an=B,u.updateSettings({colHeaders:V}),u.loadData(Y)}else Ie({title:"오류",text:"템플릿을 적용할 수 없는 셀입니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},add_as_template:{name:"템플릿에 추가",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=a.getColHeader(),f={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(d)?d:d===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:an},g=kd(c,h,f);if(g===null)return!0;const p=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,C=n.getObjectByPathCallback(p,g);return!(typeof C=="object"&&C!==null)},callback:async function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col,f=u.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:an},p=kd(h,d,g);if(p===null)return;const C=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,E=n.getObjectByPathCallback(C,p);if(!(typeof E=="object"&&E!==null)){Ie({title:"알림",text:"객체 또는 배열 형식의 값만 템플릿으로 추가할 수 있습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}u&&typeof u.deselectCell=="function"&&u.deselectCell();const{value:y}=await Vo({title:"새 템플릿 이름 입력",inputLabel:"저장할 템플릿의 이름을 입력하세요:",inputValue:"",confirmButtonText:"추가",inputValidator:T=>{const M=T.trim();return M?n.getTemplates().some(_=>_.name===M)?"이미 사용중인 템플릿 이름입니다.":null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:u});if(y&&y.trim()){const T=Array.isArray(E)?"array":"object",M=n.addTemplate(y.trim(),T,E);Ie(M===!0?{title:"성공",text:`템플릿 "${y.trim()}"이(가) 추가되었습니다.`,icon:"success",showCancelButton:!1,hotInstance:u}:M==="duplicate_name"?{title:"오류",text:`템플릿 이름 "${y.trim()}"이(가) 이미 존재합니다. 다른 이름을 사용해주세요.`,icon:"error",showCancelButton:!1,hotInstance:u}:{title:"오류",text:"템플릿 추가에 실패했습니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(a,l,u){const c={},h=an.get(`${a}-${l}`);return h&&(c.readOnly=h.readOnly,h.isDrillable&&(c.renderer=function(d,f,g,p,C,E){Te.renderers.TextRenderer.apply(this,arguments),f.style.color="#007bff",f.style.textDecoration="underline",f.style.cursor="pointer"})),c},afterOnCellMouseDown:function(a,l,u){if(a.button!==0)return;const c=new Date().getTime(),{row:h,col:d}=l,f=an.get(`${h}-${d}`),g=300;let p=!1;if(f&&h===Pc.row&&d===Pc.col&&c-Pc.time<g?(p=!0,Pc={row:-1,col:-1,time:0}):Pc={row:h,col:d,time:c},p){let C=!1;const E=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(E)&&E.length>0&&E[0]==="항목 (Key)"&&d===0&&f&&(C=!0),C){const y=f.originalKey,T=t,M=n.dataPathString;Vo({title:`키 이름 변경: "${y}"`,inputValue:y,customClass:{popup:"custom-swal-popup"},confirmButtonText:"저장",inputValidator:I=>{const _=I.trim();return _?T.hasOwnProperty(_)&&_!==y?"이미 사용 중인 키입니다!":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:this}).then(I=>{if(I.isConfirmed&&I.value!==void 0){const _=I.value.trim();_!==y&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(M,y,_,T)}});return}}if(f&&f.isDrillable&&f.originalValue!==void 0){const C=typeof t=="object"&&t!==null&&!Array.isArray(t)&&d===0&&f&&f.isDrillable;(!p||p&&!C&&f.drillPath)&&typeof f.originalValue=="object"&&f.originalValue!==null&&n.displayTableCallback(f.originalValue,f.originalKey,n.rootJsonData,f.drillPath)}},afterChange:function(a,l){if(l==="loadData"||!a||!Array.isArray(a)||a.length===0)return;const u=l==="CopyPaste.paste"||l==="Autofill.fill"||a.length>1,c=this.getColHeader();a.forEach(([h,d,f,g])=>{let p=-1;if(typeof d=="number"?p=d:typeof d=="string"&&Array.isArray(c)&&(p=c.indexOf(d)),p===-1)if(typeof d=="number"&&c===!0)p=d;else{console.warn("afterChange: 컬럼 인덱스 결정 불가:",h,d,c);return}const C={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(c)?c:c===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:an};let E=kd(h,p,C);E!==null&&(n.updateJsonDataCallback(E,String(g),u,f),n.convertToTypedValueCallback(String(g),f))}),u&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_update_handsontable_afterChange")},afterCreateRow:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)){const f=c.getColHeader();for(let g=0;g<l;g++){let p=null;Array.isArray(f)&&f.length>0&&(f.length!==2||f[0]!=="Index"||f[1]!=="Value")&&(p={},f.forEach(C=>{typeof C=="string"&&(p[C]=null)})),h.splice(a+g,0,p)}d=!0,d&&n.refreshTreeViewCallback("row_added_array_hot")}else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){(async()=>{let f={...h},g=0;for(let y=0;y<l;y++){const T=a+y,M=await Vo({title:`새 항목 키 입력 (${y+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:I=>{const _=I.trim();return _?f.hasOwnProperty(_)?"이미 사용 중인 키입니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(M.isConfirmed&&M.value!==void 0){const I=M.value.trim(),_=null,P=Object.keys(f),Y={};let V=!1;for(let B=0;B<P.length;B++)B===T&&!V&&(Y[I]=_,V=!0),Y[P[B]]=f[P[B]];V||(Y[I]=_),f=Y,g++}else break}g>0&&(Object.keys(h).forEach(y=>delete h[y]),Object.assign(h,f),d=!0,n.refreshTreeViewCallback("key_added_object_hot_ordered"));const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=hi(h,e,n);an=E,c.updateSettings({colHeaders:C}),c.loadData(p)})();return}if(d||u!=="loadData"){const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=hi(h,e,n);an=p,c.updateSettings({colHeaders:g}),c.loadData(f)}},afterCreateCol:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){(async()=>{for(let C=0;C<l;C++){const E=a+C,y=await Vo({title:`새 열(속성)의 키 입력 (${C+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:T=>{const M=T.trim();return M?h[0].hasOwnProperty(M)?"첫 번째 객체에 이미 해당 키가 존재합니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(y.isConfirmed&&y.value!==void 0){const T=y.value.trim();h.forEach(M=>{if(typeof M=="object"&&M!==null){const I=Object.keys(M),_={};let P=!1;if(E>=I.length)M[T]=null;else{for(let Y=0;Y<I.length;Y++)Y===E&&!P&&(_[T]=null,P=!0),_[I[Y]]=M[I[Y]];P||(_[T]=null),Object.keys(M).forEach(Y=>delete M[Y]),Object.assign(M,_)}}}),d=!0}else break}d&&n.refreshTreeViewCallback("col_added_array_of_obj_hot_ordered");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=hi(h,e,n);an=p,c.updateSettings({colHeaders:g}),c.loadData(f)})();return}else if(typeof h=="object"&&h!==null&&!Array.isArray(h))Ie({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c}).then(()=>{const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=hi(h,e,n);an=p,c.updateSettings({colHeaders:g}),c.loadData(f)});else{Ie({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c});const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=hi(h,e,n);an=p,c.updateSettings({colHeaders:g}),c.loadData(f)}},beforeRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;if(u.sort((d,f)=>f-d),Array.isArray(h))u.forEach(d=>{d>=0&&d<h.length&&h.splice(d,1)});else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=Object.keys(h),f=u.map(g=>d[g]).filter(g=>g!==void 0);f.length>0&&f.forEach(g=>{delete h[g]})}else return!1;return!0},afterRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef||c==="ContextMenu.remove_row_custom")return;const h=this;let d=t;n.refreshTreeViewCallback("row_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=hi(d,e,n);an=p,h.updateSettings({colHeaders:g}),h.loadData(f)},beforeRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;const d=this.getColHeader();if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){if(!Array.isArray(d))return Ie({title:"오류",text:"열 헤더 정보를 가져올 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1;u.sort((f,g)=>g-f),u.forEach(f=>{if(f>=0&&f<d.length){const g=d[f];typeof g=="string"&&h.forEach(p=>{typeof p=="object"&&p!==null&&delete p[g]})}})}else return typeof h=="object"&&h!==null&&!Array.isArray(h)?(Ie({title:"오류",text:"이 뷰에서 특정 열 부분 삭제는 지원되지 않습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1):(Ie({title:"오류",text:"현재 데이터 구조에서는 열을 삭제할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1);return!0},afterRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return;const h=this;let d=t;n.refreshTreeViewCallback("col_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=hi(d,e,n);an=p,h.updateSettings({colHeaders:g}),h.loadData(f)}}),yf):(console.error("Handsontable 컨테이너를 찾을 수 없습니다."),null)}function kd(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a,cellMetaMap:l}=n;let u="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const c=o[e];u=`[${t}].${c}`}else return null;else if(e===1)u=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){const c=l.get(`${t}-0`);if(!c||c.originalKey===void 0)return null;const h=c.originalKey;if(e===0)return null;const d=Array.isArray(o)&&o.length>1&&o[0]==="항목 (Key)"&&!isNaN(parseInt(o[1],10)),f=Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)";if(d)if(e>0&&e<o.length){const g=o[e],p=r[h];if(Array.isArray(p)){const C=l.get(`${t}-${e}`);if(C&&C.isPadding)return null;u=`.${h}[${g}]`}else return null}else return null;else if(f)if(e===1)u=`.${h}`;else return null;else return Object.keys(r).length===0&&Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)",null}else return t===0&&e===1?i||"":null;return i?u.startsWith(".")||u.startsWith("[")?i+u:u?i+"."+u:i:u.startsWith(".")?u.substring(1):u}let qi=[],eo=-1;const t0e=30;let Z_=!1;function n0e(){qi=[],eo=-1,Z_=!1}function r0e(t){if(Z_)return;const{dataPathString:e,dataKeyName:n}=t,r=qi[eo];r&&r.dataPathString===e&&r.dataKeyName===n||(eo<qi.length-1&&(qi=qi.slice(0,eo+1)),qi.push({dataPathString:e,dataKeyName:n}),eo=qi.length-1,qi.length>t0e&&(qi.shift(),eo--))}function i0e(t){let e=!1,n=eo;return t==="back"&&eo>0?(n--,e=!0):t==="forward"&&eo<qi.length-1&&(n++,e=!0),e?(eo=n,qi[eo]):null}function VA(t){Z_=t}function o0e(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function s0e(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=o0e(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function BA(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}const jV="userJsonEditorTemplates_v1";let hn=[];const zo=[{name:"빈 객체 (Empty Object)",type:"object",value:{},isDefault:!0},{name:"빈 배열 (Empty Array)",type:"array",value:[],isDefault:!0}];function Q_(){try{const t=localStorage.getItem(jV);if(t){const e=JSON.parse(t);if(Array.isArray(e)){const n=e.filter(s=>!s.isDefault),r=new Set(zo.map(s=>s.name)),i=[],o=new Set;n.forEach(s=>{!r.has(s.name)&&!o.has(s.name)&&(i.push({...s,isDefault:!1}),o.add(s.name))}),hn=[...zo,...i]}else hn=[...zo]}else hn=[...zo]}catch(t){console.error("Error loading templates from localStorage:",t),hn=[...zo]}return Dg(),hn}function UV(){return hn.length===0&&Q_(),[...hn]}function a0e(t,e,n){if(!t||!e||n===void 0)return!1;const r=t.trim();if(hn.some(o=>o.name===r))return"duplicate_name";if(zo.some(o=>o.name===r))return"default_conflict";const i={name:r,type:e,value:JSON.parse(JSON.stringify(n)),isDefault:!1};return hn.push(i),Dg(),!0}function Dg(){try{const t=hn.map(e=>({...e,isDefault:zo.some(n=>n.name===e.name&&n.isDefault)}));localStorage.setItem(jV,JSON.stringify(t))}catch(t){console.error("Error saving templates to localStorage:",t)}}function l0e(t){if(!Array.isArray(t))return 0;const n=t.map(s=>{const a=s.type==="object"||s.type==="array"?s.type:"object";return{name:String(s.name||`템플릿_${Date.now()}`).trim(),type:a,value:JSON.parse(JSON.stringify(s.value||(a==="array"?[]:{}))),isDefault:!1}}).filter(s=>s.name).filter(s=>!zo.some(a=>a.name===s.name)),r=hn.filter(s=>!s.isDefault),i=new Map;r.forEach(s=>i.set(s.name,s)),n.forEach(s=>i.set(s.name,{...s,isDefault:!1}));const o=Array.from(i.values());return hn=[...zo,...o],Dg(),n.length}function Cf(){return hn.length===0&&Q_(),hn.filter(t=>!t.isDefault)}function u0e(t,e){const n=t.trim(),r=e.trim();if(!r)return"empty_name";const i=hn.findIndex(o=>o.name===n&&!o.isDefault);return i===-1?"not_found":hn.some((o,s)=>o.name===r&&s!==i)?"duplicate_name":zo.some(o=>o.name===r)?"default_conflict":(hn[i].name=r,Dg(),!0)}function c0e(t){const e=t.trim(),n=hn.filter(i=>!i.isDefault).length;return hn=hn.filter(i=>!(!i.isDefault&&i.name===e)),hn.filter(i=>!i.isDefault).length<n?(Dg(),!0):!1}Q_();const zV="selected_theme_json_editor",wv=[{buttonId:"theme-btn-1",themeClass:"theme-soft-dark",name:"Soft Dark"},{buttonId:"theme-btn-2",themeClass:"theme-classic-purple",name:"Classic Purple Light"},{buttonId:"theme-btn-3",themeClass:"theme-soft-mint",name:"Soft Mint"}],YV="theme-classic-purple";let BS=null,au=null,Ic=null;function b0(t){Ic||(Ic=document.body),wv.forEach(n=>{Ic.classList.contains(n.themeClass)&&Ic.classList.remove(n.themeClass)});let e=YV;t&&wv.some(n=>n.themeClass===t)&&(e=t),Ic.classList.add(e),localStorage.setItem(zV,e),h0e(e)}function h0e(t){au&&au.forEach(e=>{const n=wv.find(r=>r.buttonId===e.id);n&&n.themeClass===t?e.classList.add("active-theme"):e.classList.remove("active-theme")})}function d0e(){au&&au.forEach(t=>{t.addEventListener("click",()=>{const e=wv.find(n=>n.buttonId===t.id);e&&b0(e.themeClass)})})}function f0e(){if(Ic=document.body,BS=document.querySelector(".theme-switcher"),!BS){console.warn("Theme switcher element not found by theme-switcher.js during initialization.");return}if(au=BS.querySelectorAll(".theme-button"),!au||au.length===0){console.warn("Theme buttons not found by theme-switcher.js during initialization.");return}d0e();const t=localStorage.getItem(zV);b0(t!==null?t:YV),console.log("Theme switcher initialized.")}let Se=null,lu=null,Ns,bf,Zn,He=null;function g0e(t){if(typeof t!="string")throw new TypeError("입력값은 문자열이어야 합니다.");try{return encodeURIComponent(t)}catch(e){throw console.error("URL 인코딩 중 오류 발생:",e),e}}function m0e(t){if(typeof t!="string")throw new TypeError("입력값은 문자열이어야 합니다.");try{return decodeURIComponent(t)}catch(e){throw console.error("URL 디코딩 중 오류 발생:",e),e}}async function GV(){const t=async(n="",r="success")=>{n&&We&&Pt(We,n,2500),await new Promise(i=>setTimeout(i,50)),GV()},e=Cf();await Oj({userTemplates:e,callbacks:{onViewRequest:async n=>{const r=Cf().find(i=>i.name===n);r&&await Ij({templateName:r.name,templateValue:r.value,hotInstance:He}),await t("템플릿 내용을 확인했습니다.","info")},onRenameRequest:async n=>{if(!Cf().find(o=>o.name===n)){await t("변경할 템플릿을 찾지 못했습니다.","error");return}const i=await Vo({title:`'${n}' 템플릿 이름 변경`,inputLabel:"새로운 템플릿 이름을 입력하세요:",inputValue:n,confirmButtonText:"변경 저장",inputValidator:o=>{const s=o.trim();return s?s===n?null:UV().some(a=>a.name===s)?`'${s}' 이름은 이미 사용 중입니다.`:null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:He});if(i.isConfirmed&&typeof i.value=="string"){const o=i.value.trim();if(o===n){await t("이름이 변경되지 않았습니다.","info");return}const s=u0e(n,o);if(s===!0)await t(`템플릿 '${n}'이(가) '${o}'(으)로 변경되었습니다.`);else{let a="알 수 없는 오류로 이름 변경에 실패했습니다.";s==="empty_name"?a="새 템플릿 이름은 비워둘 수 없습니다.":s==="not_found"?a=`템플릿 '${n}'을(를) 찾을 수 없습니다.`:s==="duplicate_name"?a=`새 이름 '${o}'은(는) 이미 사용 중입니다.`:s==="default_conflict"&&(a=`새 이름 '${o}'은(는) 기본 템플릿 이름과 충돌합니다.`),await Ie({title:"이름 변경 오류",text:a,icon:"error",showCancelButton:!1,hotInstance:He}),await t("이름 변경 중 문제가 발생했습니다.","error")}}else await t("이름 변경이 취소되었습니다.","info")},onDeleteRequest:async n=>{(await Ie({title:`'${n}' 템플릿 삭제`,text:`정말로 '${n}' 템플릿을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`,icon:"warning",showCancelButton:!0,confirmButtonText:"삭제",cancelButtonText:"취소",hotInstance:He})).isConfirmed?c0e(n)?await t(`템플릿 '${n}'이(가) 삭제되었습니다.`):(await Ie({title:"삭제 오류",text:`템플릿 '${n}' 삭제에 실패했습니다.`,icon:"error",showCancelButton:!1,hotInstance:He}),await t("삭제 중 문제가 발생했습니다.","error")):await t("삭제가 취소되었습니다.","info")}},hotInstance:He})}function p0e(){const t=document.getElementById("loadBtn");t&&t.addEventListener("click",xy);const e=document.getElementById("saveBtn");e&&e.addEventListener("click",x0e);const n=document.getElementById("minifyBtn");n&&n.addEventListener("click",()=>{if(ht&&ht.value)try{ht.value=nB(ht.value)}catch(y){je&&(je.textContent="Minify 오류: "+y.message)}else ht&&(ht.value="")});const r=document.getElementById("uglifyBtn");r&&r.addEventListener("click",()=>{if(ht&&ht.value)try{ht.value=rB(ht.value)}catch(y){je&&(je.textContent="Uglify(포맷팅) 오류: "+y.message)}else ht&&(ht.value="")});const i=document.getElementById("diffBtn");i&&i.addEventListener("click",()=>{if(!lu&&!Se){Ie({title:"알림",text:"먼저 JSON 데이터를 로드해주세요.",icon:"info",showCancelButton:!1,hotInstance:He});return}if(!lu){Ie({title:"알림",text:"로드 시점의 원본 JSON 데이터가 없습니다.",icon:"info",showCancelButton:!1,hotInstance:He});return}Pj({title:"JSON 데이터 변경사항",jsonDiffData:{left:lu,right:Se===null?{}:Se},buttons:[{text:"닫기",role:"confirm"}],hotInstance:He}).catch(T=>{Ie({title:"오류",text:"변경점 확인 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:He})})});const o=document.getElementById("loadFromFileBtn");o&&o.addEventListener("click",E0e);const s=document.getElementById("saveToFileBtn");s&&s.addEventListener("click",T0e);const a=document.getElementById("saveToCSV");a&&a.addEventListener("click",R0e);const l=document.getElementById("loadFromCSV");l&&l.addEventListener("click",b0e);const u=document.getElementById("loadTemplatesFromFileBtn");u&&u.addEventListener("click",M0e);const c=document.getElementById("saveTemplatesToFileBtn");c&&c.addEventListener("click",_0e);const h=document.getElementById("manageTemplatesBtn");h&&h.addEventListener("click",GV);const d=document.getElementById("encodeUrlBtn");d&&d.addEventListener("click",async()=>{const y=ht?ht.value:"";try{const T=await xx({title:"URL 인코딩",initialInputValue:y,inputLabel:"인코딩할 원본 문자열:",outputLabel:"인코딩된 결과:",actionButtonText:"인코딩 실행",onExecuteAction:M=>{try{return g0e(M)}catch(I){return`오류: ${I.message}`}},confirmButtonText:"결과를 메인 편집기에 복사",cancelButtonText:"팝업 닫기",hotInstance:He});T.isConfirmed&&T.formData&&T.formData!==!1?ht&&(ht.value=T.formData,We&&Pt(We,"결과가 메인 편집기에 복사되었습니다.",2e3)):T.isDismissed&&T.dismiss==="cancel"&&We&&Pt(We,"URL 인코딩 작업창을 닫았습니다.",1500,"info")}catch(T){je&&(je.textContent="URL 인코딩 팝업 오류: "+T.message),We&&Pt(We,"URL 인코딩 팝업 처리 중 문제가 발생했습니다.",3e3)}});const f=document.getElementById("decodeUrlBtn");f&&f.addEventListener("click",async()=>{const y=ht?ht.value:"";try{const T=await xx({title:"URL 디코딩",initialInputValue:y,inputLabel:"디코딩할 URL 인코딩된 문자열:",outputLabel:"디코딩된 결과:",actionButtonText:"디코딩 실행",onExecuteAction:M=>{try{return m0e(M)}catch(I){return`오류: ${I.message}`}},confirmButtonText:"결과를 메인 편집기에 복사",cancelButtonText:"팝업 닫기",hotInstance:He});T.isConfirmed&&T.formData&&T.formData!==!1?ht&&(ht.value=T.formData,We&&Pt(We,"결과가 메인 편집기에 복사되었습니다.",2e3)):T.isDismissed&&T.dismiss==="cancel"&&We&&Pt(We,"URL 디코딩 작업창을 닫았습니다.",1500,"info")}catch(T){je&&(je.textContent="URL 디코딩 팝업 오류: "+T.message),We&&Pt(We,"URL 디코딩 팝업 처리 중 문제가 발생했습니다.",3e3)}}),Ns=document.getElementById("searchInput"),bf=document.getElementById("searchTargetSelect"),Zn=document.getElementById("searchResultsDropdown"),Ns&&Ns.addEventListener("input",jA),bf&&bf.addEventListener("change",jA),document.addEventListener("click",y=>{Zn&&Ns&&!Ns.contains(y.target)&&!Zn.contains(y.target)&&(Zn.style.display="none")}),Zn&&Zn.addEventListener("click",y=>y.stopPropagation()),window.addEventListener("mouseup",y=>{(y.button===3||y.button===4)&&(y.preventDefault(),y.button===3?YA("back"):y.button===4&&YA("forward"))}),window.addEventListener("contextmenu",y=>{y.preventDefault()});const g=document.querySelector(".json-control-panel");g?(g.addEventListener("dragover",w0e),g.addEventListener("dragleave",v0e),g.addEventListener("drop",y0e)):console.warn(".json-control-panel 요소를 찾을 수 없어 드래그앤드롭 기능을 활성화할 수 없습니다.");const p=document.querySelector(".main-layout-triple-panel"),C=[document.querySelector(".json-control-panel"),document.querySelector(".tree-view-panel"),document.querySelector(".table-view-panel")],E=[document.getElementById("resizer-1"),document.getElementById("resizer-2")];p&&C.every(y=>y)&&E.every(y=>y)?(WA(p,C,E),window.addEventListener("resize",()=>WA(p,C,E)),E.forEach((y,T)=>{let M=!1,I=0,_=[];y.addEventListener("mousedown",V=>{V.preventDefault(),M=!0,I=V.clientX,_=[C[T].offsetWidth,C[T+1].offsetWidth],document.addEventListener("mousemove",P),document.addEventListener("mouseup",Y)});function P(V){if(!M)return;const B=V.clientX-I,Z=50;let X=_[0]+B,Q=_[1]-B;X<Z&&(X=Z,Q=_[0]+_[1]-X),Q<Z&&(Q=Z,X=_[0]+_[1]-Q),C[T].style.flexBasis=`${X}px`,C[T+1].style.flexBasis=`${Q}px`}function Y(){M&&(M=!1,document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",Y))}})):console.warn("3-패널 레이아웃에 필요한 요소를 모두 찾을 수 없습니다. 리사이저가 동작하지 않을 수 있습니다."),f0e()}function w0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.add("dragover-active"),t.dataTransfer.dropEffect="copy"}function v0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active")}function y0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active");const e=t.dataTransfer.files;if(e.length>0){const n=e[0];if(n.type==="application/json"||n.name.toLowerCase().endsWith(".json")){const r=new FileReader;r.onload=i=>{try{const o=i.target.result;ht?(ht.value=o,xy(),Pt(We,`${n.name} 파일이 드롭되어 로드되었습니다.`,3e3)):Ie({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:He})}catch(o){je&&(je.textContent=`파일 오류 (드롭): ${o.message}`),Ie({title:"파일 로드 오류 (드롭)",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:He})}},r.onerror=()=>{je&&(je.textContent="파일을 읽는 중 오류가 발생했습니다 (드롭)."),Ie({title:"파일 읽기 오류 (드롭)",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:He})},r.readAsText(n)}else Ie({title:"잘못된 파일 타입",text:"JSON 파일(.json)만 드롭해주세요.",icon:"warning",showCancelButton:!1,hotInstance:He})}}function WA(t,e,n){const r=t.offsetWidth,i=n.reduce((l,u)=>l+u.offsetWidth,0),o=r-i,s=[.15,.15,.7],a=50;if(o>0){let l=Math.max(a,Math.floor(o*s[0])),u=Math.max(a,Math.floor(o*s[1])),c=Math.max(a,o-l-u);if(l+u+c>o&&(c=o-l-u,c<a)){c=a;const h=o-c;l=Math.floor(h*(s[0]/(s[0]+s[1]))),u=h-l,l<a&&(l=a,u=h-l),u<a&&(u=a,l=h-u)}e[0].style.flexBasis=`${l}px`,e[1].style.flexBasis=`${u}px`,e[2].style.flexBasis=`${c}px`}}function jA(){if(!Ns||!bf||!Zn)return;const t=Ns.value.trim().toLowerCase(),e=bf.value;if(!t){Zn.innerHTML="",Zn.style.display="none";return}if(Se==null){BA([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],Zn,t,UA);return}const n=s0e(t,e,Se);BA(n,Zn,t,UA)}function UA(t){t&&typeof Ja=="function"&&t.data!==void 0&&(Ja(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString||""),Zn&&(Zn.style.display="none"))}function WS(t){const e=[];let n="",r=!1;for(let i=0;i<t.length;i++){const o=t[i];o==='"'?r&&i+1<t.length&&t[i+1]==='"'?(n+='"',i++):r=!r:o===","&&!r?(e.push(n),n=""):n+=o}return e.push(n),e}function zA(t){if(typeof t!="string")return t;const e=t.trim();if(e.toLowerCase()==="null")return null;if(e.toLowerCase()==="true")return!0;if(e.toLowerCase()==="false")return!1;if(e==="")return null;if(e!==""&&!isNaN(Number(e))&&(e.includes(".")||/^-?\d+$/.test(e)||String(Number(e))===e.replace(/^0+(?=\d)/,"")))return Number(e);if(e.startsWith("[")&&e.endsWith("]")||e.startsWith("{")&&e.endsWith("}"))try{return JSON.parse(e)}catch{return e}return e}function C0e(t){const e=t.trim().split(/\r\n|\n|\r/);if(e.length===0)return[];let n=-1;for(let l=0;l<e.length;l++)if(e[l].trim()!==""){n=l;break}if(n===-1)return[];let r=WS(e[n]).map((l,u)=>{const c=l.trim();return c===""?`column_${u+1}`:c});const i=r.map(l=>l.toLowerCase()),o=["key","property","name","field","item"];if(r.length===2&&o.includes(i[0])&&i[1]==="value"){const l={};for(let u=n+1;u<e.length;u++){const c=e[u];if(c.trim()==="")continue;const h=WS(c);if(!h.every(d=>d.trim()==="")&&h.length>=2){const d=h[0].trim();if(d==="")continue;const f=h[1];l[d]=zA(f)}}return l}else{const l=[];for(let u=n+1;u<e.length;u++){const c=e[u];if(c.trim()==="")continue;const h=WS(c);if(h.every(p=>p.trim()===""))continue;const d={};let f=!1;const g=Math.max(r.length,h.length);for(let p=0;p<g;p++){const C=p<r.length&&r[p]?r[p]:`column_${p+1}`,E=h[p]!==void 0?h[p]:"",y=zA(E);d[C]=y,y!==null&&String(y).trim()!==""&&(f=!0)}f&&l.push(d)}return l}}async function b0e(){const t=document.createElement("input");t.type="file",t.accept=".csv,text/csv",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=i=>{try{const o=i.target.result,s=C0e(o);let a,l=`${n.name} CSV 로드 완료.`;Array.isArray(s)?s.length>0?(a=s[0],s.length>1&&(l=`${n.name} CSV 로드됨 (주의: 여러 레코드 중 첫 번째만 표시).`)):a=[]:typeof s=="object"&&s!==null?(a=s,l=`${n.name} Key-Value CSV가 단일 JSON 객체로 로드되었습니다.`):(a={},l=`${n.name} CSV 변환 중 예상치 못한 결과.`);const u=JSON.stringify(a,null,2);ht?(ht.value=u,xy(),Pt(We,l,5e3)):Ie({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:He})}catch(o){je&&(je.textContent=`CSV 파일 파싱 오류: ${o.message}`),Ie({title:"CSV 파일 파싱 오류",text:`CSV 파일을 JSON으로 변환 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:He})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{je&&(je.textContent="CSV 파일을 읽는 중 오류."),Ie({title:"CSV 파일 읽기 오류",text:"CSV 파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:He}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}function S0e(t){if(t==null)throw new Error("데이터가 없어 CSV로 변환할 수 없습니다.");let e="";const n=r=>{if(r==null)return"";let i;return typeof r=="object"?i=JSON.stringify(r):i=String(r),(i.includes(",")||i.includes(`
`)||i.includes("\r")||i.includes('"'))&&(i='"'+i.replace(/"/g,'""')+'"'),i};if(Array.isArray(t)){if(t.length===0)return"";if(typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])){const r=[];if(t.forEach(i=>{typeof i=="object"&&i!==null&&Object.keys(i).forEach(o=>{r.includes(o)||r.push(o)})}),r.length>0)e+=r.map(n).join(",")+`\r
`;else if(t.every(i=>typeof i!="object"||i===null))return e+=`value\r
`,t.forEach(i=>{e+=n(i)+`\r
`}),e;t.forEach(i=>{if(typeof i=="object"&&i!==null){const o=r.map(s=>n(i[s]));e+=o.join(",")+`\r
`}else{const o=r.map(()=>n(null));e+=o.join(",")+`\r
`}})}else e+=`value\r
`,t.forEach(r=>{e+=n(r)+`\r
`})}else typeof t=="object"&&t!==null?(e+=`key,value\r
`,Object.keys(t).forEach(r=>{e+=n(r)+","+n(t[r])+`\r
`})):(e+=`value\r
`,e+=n(t)+`\r
`);return e}async function R0e(){if(Se==null){Pt(We,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await Vo({title:"CSV 파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.csv 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:He});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".csv")||(e+=".csv");const n=S0e(Se),r="\uFEFF",i=new Blob([r+n],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(i),s=document.createElement("a");s.href=o,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o),Pt(We,`${e} 파일이 성공적으로 CSV로 저장되었습니다!`,3e3)}else Pt(We,"CSV 파일 저장이 취소되었습니다.",3e3)}catch(t){je&&(je.textContent="CSV 파일 저장/변환 오류: "+t.message),Ie({title:"CSV 저장/변환 오류",text:`JSON 데이터를 CSV로 저장/변환 중 오류: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:He})}}function E0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=i=>{try{const o=i.target.result;ht?(ht.value=o,xy(),Pt(We,`${n.name} 파일이 로드되었습니다.`,3e3)):Ie({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:He})}catch(o){je&&(je.textContent=`파일 오류: ${o.message}`),Ie({title:"파일 로드 오류",text:`파일을 로드하거나 파싱하는 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:He})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{je&&(je.textContent="파일을 읽는 중 오류."),Ie({title:"파일 읽기 오류",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:He}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}async function T0e(){if(Se==null){Pt(We,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await Vo({title:"파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:He});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".json")||(e+=".json");const n=JSON.stringify(Se,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),Pt(We,`${e} 파일이 성공적으로 저장되었습니다!`,3e3)}else Pt(We,"파일 저장이 취소되었습니다.",3e3)}catch(t){je&&(je.textContent="JSON 파일 저장 오류: "+t.message),Ie({title:"파일 저장 오류",text:`JSON 데이터를 파일로 저장 중 오류: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:He})}}async function M0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",async e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=async i=>{try{const o=i.target.result,s=JSON.parse(o);if(!Array.isArray(s))throw new Error("템플릿 파일은 배열 형태여야 합니다.");const a=Cf().map(u=>u.name),l=await nN({title:`'${n.name}' 파일에서 템플릿 불러오기`,templates:s,message:'아래 목록에서 불러올 템플릿을 선택하세요. <span style="color: var(--color-warning, orange); font-weight:bold;">(덮어씀)</span> 표시는 이름이 같은 기존 사용자 템플릿을 이 파일의 내용으로 변경함을 의미합니다.',confirmButtonText:"선택한 템플릿 불러오기",cancelButtonText:"취소",hotInstance:He,existingUserTemplateNames:a});if(l.isConfirmed)if(l.selectedTemplates.length>0){const u=l0e(l.selectedTemplates);Pt(We,`선택된 ${u}개의 사용자 템플릿을 '${n.name}'에서 로드 및 병합했습니다.`,3e3)}else Pt(We,"선택된 템플릿이 없어 아무것도 로드하지 않았습니다.",3e3,"info");else Pt(We,"템플릿 파일 로드가 취소되었습니다.",3e3,"info")}catch(o){je&&(je.textContent=`템플릿 파일 처리 오류: ${o.message}`),Ie({title:"템플릿 파일 처리 오류",text:`템플릿 파일을 처리하는 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:He})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{je&&(je.textContent="템플릿 파일을 읽는 중 오류."),Ie({title:"파일 읽기 오류",text:"템플릿 파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:He}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}async function _0e(){const t=Cf();if(!t||t.length===0){Pt(We,"저장할 사용자 정의 템플릿이 없습니다.",3e3);return}try{const e=await nN({title:"파일로 저장할 템플릿 선택",templates:t,message:"파일로 저장할 사용자 정의 템플릿을 선택하세요.",confirmButtonText:"선택한 템플릿 저장하기",cancelButtonText:"취소",hotInstance:He});if(e.isConfirmed&&e.selectedTemplates.length>0){const n=e.selectedTemplates.map(({name:i,type:o,value:s})=>({name:i,type:o,value:s})),r=await Vo({title:"템플릿 파일 이름 입력",inputLabel:"저장할 템플릿 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"user_templates",confirmButtonText:"저장",inputValidator:i=>!i||i.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:He});if(r.isConfirmed&&r.value){let i=r.value.trim();i.toLowerCase().endsWith(".json")||(i+=".json");const o=JSON.stringify(n,null,2),s=new Blob([o],{type:"application/json"}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a),Pt(We,`선택된 사용자 템플릿이 ${i} 파일로 성공적으로 저장되었습니다!`,3e3)}else Pt(We,"템플릿 파일 이름 입력이 취소되어 저장이 중단되었습니다.",3e3,"info")}else e.isConfirmed&&e.selectedTemplates.length===0?Pt(We,"선택된 템플릿이 없어 아무것도 저장하지 않았습니다.",3e3,"info"):e.isDismissed&&Pt(We,"템플릿 파일 저장이 취소되었습니다.",3e3,"info")}catch(e){je&&(je.textContent="템플릿 파일 저장 오류: "+e.message),Ie({title:"템플릿 파일 저장 오류",text:`템플릿을 파일로 저장하는 중 오류: ${e.message}`,icon:"error",showCancelButton:!1,hotInstance:He})}}function xy(){P0e(),n0e();try{const t=ht.value.trim();if(!t){Se=null,lu=null,Vc(null,Sf),iw();return}Se=JSON.parse(t),lu=JSON.parse(JSON.stringify(Se));const e=KV();if(xt&&(xt.innerHTML=""),typeof Se=="object"&&Se!==null)Ef(Se,xt,"",Se,0,e);else{const r={["value"]:Se};Ef(r,xt,"",r,0,e)}iw(),Vc(null,Sf)}catch(t){je&&(je.textContent="JSON 파싱 오류: "+t.message),Se=null,lu=null,xt&&(xt.innerHTML=""),iw(),Vc(null,Sf)}}function x0e(){if(je&&(je.textContent=""),Se!=null)try{const t=JSON.stringify(Se,null,2);ht&&(ht.value=t),We&&Pt(We,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){je&&(je.textContent="JSON 문자열 변환 오류: "+t.message),We&&(We.textContent="")}else ht&&(ht.value=""),We&&Pt(We,"저장할 JSON 데이터가 없습니다.",3e3)}function P0e(){Aj(),iw(),Se=null,lu=null,Qc(null),Zn&&(Zn.innerHTML="",Zn.style.display="none"),Ns&&(Ns.value=""),xt&&(xt.innerHTML=""),Vc(null,Sf)}function iw(){He=WV()}function I0e(t,e,n=!1){if(Se==null)return;const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Se:s=cu(Se,o),o===""&&t===i&&(typeof Se!="object"||Se===null)){if(Se=qS(e,Se),n)return;vv(t),Ja(Se,"value",Se,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){Ie({title:"오류",text:"데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).",icon:"error",showCancelButton:!1,hotInstance:He});return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){Ie({title:"오류",text:"배열 인덱스 범위를 벗어났습니다.",icon:"error",showCancelButton:!1,hotInstance:He});return}let l=!0;const u=s[a],c=qS(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&xt){const f=xt.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(rN(g,c),l=!1)}}!n&&l&&vv(t)}}function O0e(t,e,n,r){let i;if(r&&(t===""||cu(Se,t)===r)?i=r:i=t===""?Se:cu(Se,t),typeof i!="object"||i===null||Array.isArray(i)){Ie({title:"오류",text:"키를 업데이트할 부모 객체를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:He});return}if(!Object.prototype.hasOwnProperty.call(i,e)){Ie({title:"오류",text:`기존 키 "${e}"를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:He});return}if(n===e){Ie({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다.",showCancelButton:!1,hotInstance:He});return}if(Object.prototype.hasOwnProperty.call(i,n)){Ie({title:"오류",text:`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:He});return}const o={},s=i[e];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&delete i[a];for(const a in o)Object.prototype.hasOwnProperty.call(o,a)&&(i[a]=o[a]);Ie({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`,showCancelButton:!1,hotInstance:He}),vv(`key_renamed_in_parent:${t}`),Ja(i,n,Se,t)}function vv(t="N/A"){if(xt&&Se!=null){const e=Dj(),n=$j(xt);xt.innerHTML="";const r=KV();if(typeof Se=="object"&&Se!==null)Ef(Se,xt,"",Se,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Se};Ef(o,xt,"",o,0,r)}if(kj(xt,n),e){const i=xt.querySelector(`.tree-node[data-path="${e}"]`);i&&Qc(i)}}else xt&&(xt.innerHTML="")}function KV(){return{displayTableCallback:Ja,getObjectByPathCallback:cu,rootJsonData:Se}}function Sf(t){const e=cu(Se,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}Ja(e,n,Se,t,{syncTreeView:!0})}else Ie({title:"오류",text:`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:He})}function Ja(t,e,n,r,i={syncTreeView:!0}){if(r0e({dataPathString:r,dataKeyName:e}),Vc(r,Sf),He=e0e(t,e,{tableViewDomElement:KS,updateJsonDataCallback:I0e,updateJsonKeyCallback:O0e,refreshTreeViewCallback:vv,getObjectByPathCallback:cu,convertToTypedValueCallback:qS,rootJsonData:n,currentJsonDataRef:()=>Se,dataPathString:r,displayTableCallback:Ja,getTemplates:UV,addTemplate:a0e}),i.syncTreeView&&xt&&r!==void 0&&r!==null){const s=xt.querySelector(`.tree-node[data-path="${r}"]`);s?(Qc(s),setTimeout(()=>{const a=xt.querySelector(`.tree-node[data-path="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},50)):r===""&&(Qc(null),xt.firstChild&&(xt.scrollTop=0))}}function YA(t){const e=i0e(t);if(e){VA(!0);try{const n=cu(Se,e.dataPathString);Ja(n,e.dataKeyName,Se,e.dataPathString,{syncTreeView:!1})}catch{Ie({title:"오류",text:"히스토리 복원 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:He})}finally{VA(!1)}}}document.addEventListener("DOMContentLoaded",p0e)});export default A0e();
