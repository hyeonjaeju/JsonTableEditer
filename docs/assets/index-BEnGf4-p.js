var HV=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var qRe=HV((c0e,Jp)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function NV(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function DV(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function IA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function kV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J_(t,e){return t.get(IA(t,e))}function $V(t,e,n){kV(t,e),e.set(t,n)}function LV(t,e,n){return t.set(IA(t,e),n),n}const FV=100,Se={},VV=()=>{Se.previousActiveElement instanceof HTMLElement?(Se.previousActiveElement.focus(),Se.previousActiveElement=null):document.body&&document.body.focus()},WV=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Se.restoreFocusTimeout=setTimeout(()=>{VV(),e()},FV),window.scrollTo(n,r)}),OA="swal2-",BV=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],z=BV.reduce((t,e)=>(t[e]=OA+e,t),{}),jV=["success","warning","info","question","error"],Zp=jV.reduce((t,e)=>(t[e]=OA+e,t),{}),AA="SweetAlert2:",a0=t=>t.charAt(0).toUpperCase()+t.slice(1),cr=t=>{console.warn(`${AA} ${typeof t=="object"?t.join(" "):t}`)},mu=t=>{console.error(`${AA} ${t}`)},Z_=[],UV=t=>{Z_.includes(t)||(Z_.push(t),cr(t))},HA=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;UV(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},cv=t=>typeof t=="function"?t():t,l0=t=>t&&typeof t.toPromise=="function",jf=t=>l0(t)?t.toPromise():Promise.resolve(t),u0=t=>t&&Promise.resolve(t)===t,fr=()=>document.body.querySelector(`.${z.container}`),Uf=t=>{const e=fr();return e?e.querySelector(t):null},Qr=t=>Uf(`.${t}`),nt=()=>Qr(z.popup),nh=()=>Qr(z.icon),zV=()=>Qr(z["icon-content"]),NA=()=>Qr(z.title),c0=()=>Qr(z["html-container"]),DA=()=>Qr(z.image),h0=()=>Qr(z["progress-steps"]),hv=()=>Qr(z["validation-message"]),Yo=()=>Uf(`.${z.actions} .${z.confirm}`),rh=()=>Uf(`.${z.actions} .${z.cancel}`),pu=()=>Uf(`.${z.actions} .${z.deny}`),YV=()=>Qr(z["input-label"]),ih=()=>Uf(`.${z.loader}`),zf=()=>Qr(z.actions),kA=()=>Qr(z.footer),dv=()=>Qr(z["timer-progress-bar"]),d0=()=>Qr(z.close),GV=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,f0=()=>{const t=nt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(GV),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>Nr(o))},g0=()=>$s(document.body,z.shown)&&!$s(document.body,z["toast-shown"])&&!$s(document.body,z["no-backdrop"]),fv=()=>{const t=nt();return t?$s(t,z.toast):!1},KV=()=>{const t=nt();return t?t.hasAttribute("data-loading"):!1},ei=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},$s=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},qV=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(z).includes(n)&&!Object.values(Zp).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Zr=(t,e,n)=>{if(qV(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){cr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}ut(t,r)}},gv=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${z.popup} > .${z[e]}`);case"checkbox":return t.querySelector(`.${z.popup} > .${z.checkbox} input`);case"radio":return t.querySelector(`.${z.popup} > .${z.radio} input:checked`)||t.querySelector(`.${z.popup} > .${z.radio} input:first-child`);case"range":return t.querySelector(`.${z.popup} > .${z.range} input`);default:return t.querySelector(`.${z.popup} > .${z.input}`)}},$A=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},LA=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},ut=(t,e)=>{LA(t,e,!0)},bi=(t,e)=>{LA(t,e,!1)},Ta=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&$s(i,e))return i}},Ql=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},Hn=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},Jn=t=>{t&&(t.style.display="none")},m0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{Yf(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},Q_=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},Yf=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?Hn(t,n):Jn(t)},Nr=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),XV=()=>!Nr(Yo())&&!Nr(pu())&&!Nr(rh()),eP=t=>t.scrollHeight>t.clientHeight,FA=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},p0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=dv();n&&Nr(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},JV=()=>{const t=dv();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},ZV=()=>typeof window>"u"||typeof document>"u",QV=`
 <div aria-labelledby="${z.title}" aria-describedby="${z["html-container"]}" class="${z.popup}" tabindex="-1">
   <button type="button" class="${z.close}"></button>
   <ul class="${z["progress-steps"]}"></ul>
   <div class="${z.icon}"></div>
   <img class="${z.image}" />
   <h2 class="${z.title}" id="${z.title}"></h2>
   <div class="${z["html-container"]}" id="${z["html-container"]}"></div>
   <input class="${z.input}" id="${z.input}" />
   <input type="file" class="${z.file}" />
   <div class="${z.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${z.select}" id="${z.select}"></select>
   <div class="${z.radio}"></div>
   <label class="${z.checkbox}">
     <input type="checkbox" id="${z.checkbox}" />
     <span class="${z.label}"></span>
   </label>
   <textarea class="${z.textarea}" id="${z.textarea}"></textarea>
   <div class="${z["validation-message"]}" id="${z["validation-message"]}"></div>
   <div class="${z.actions}">
     <div class="${z.loader}"></div>
     <button type="button" class="${z.confirm}"></button>
     <button type="button" class="${z.deny}"></button>
     <button type="button" class="${z.cancel}"></button>
   </div>
   <div class="${z.footer}"></div>
   <div class="${z["timer-progress-bar-container"]}">
     <div class="${z["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),eW=()=>{const t=fr();return t?(t.remove(),bi([document.documentElement,document.body],[z["no-backdrop"],z["toast-shown"],z["has-column"]]),!0):!1},Za=()=>{Se.currentInstance.resetValidationMessage()},tW=()=>{const t=nt(),e=Ta(t,z.input),n=Ta(t,z.file),r=t.querySelector(`.${z.range} input`),i=t.querySelector(`.${z.range} output`),o=Ta(t,z.select),s=t.querySelector(`.${z.checkbox} input`),a=Ta(t,z.textarea);e.oninput=Za,n.onchange=Za,o.onchange=Za,s.onchange=Za,a.oninput=Za,r.oninput=()=>{Za(),i.value=r.value},r.onchange=()=>{Za(),i.value=r.value}},nW=t=>typeof t=="string"?document.querySelector(t):t,rW=t=>{const e=nt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},iW=t=>{window.getComputedStyle(t).direction==="rtl"&&ut(fr(),z.rtl)},oW=t=>{const e=eW();if(ZV()){mu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=z.container,e&&ut(n,z["no-transition"]),ei(n,QV),n.dataset.swal2Theme=t.theme;const r=nW(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),rW(t),iW(r),tW()},w0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?sW(t,e):t&&ei(e,t)},sW=(t,e)=>{t.jquery?aW(e,t):ei(e,t.toString())},aW=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},lW=(t,e)=>{const n=zf(),r=ih();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?Jn(n):Hn(n),Zr(n,e,"actions"),uW(n,r,e),ei(r,e.loaderHtml||""),Zr(r,e,"loader"))};function uW(t,e,n){const r=Yo(),i=pu(),o=rh();!r||!i||!o||(by(r,"confirm",n),by(i,"deny",n),by(o,"cancel",n),cW(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function cW(t,e,n,r){if(!r.buttonsStyling){bi([t,e,n],z.styled);return}ut([t,e,n],z.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),Cy(t),Cy(e),Cy(n)}function Cy(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function by(t,e,n){const r=a0(e);Yf(t,n[`show${r}Button`],"inline-block"),ei(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=z[e],Zr(t,n,`${e}Button`)}const hW=(t,e)=>{const n=d0();n&&(ei(n,e.closeButtonHtml||""),Zr(n,e,"closeButton"),Yf(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},dW=(t,e)=>{const n=fr();n&&(fW(n,e.backdrop),gW(n,e.position),mW(n,e.grow),Zr(n,e,"container"))};function fW(t,e){typeof e=="string"?t.style.background=e:e||ut([document.documentElement,document.body],z["no-backdrop"])}function gW(t,e){e&&(e in z?ut(t,z[e]):(cr('The "position" parameter is not valid, defaulting to "center"'),ut(t,z.center)))}function mW(t,e){e&&ut(t,z[`grow-${e}`])}var Et={innerParams:new WeakMap,domCache:new WeakMap};const pW=["input","file","range","select","radio","checkbox","textarea"],wW=(t,e)=>{const n=nt();if(!n)return;const r=Et.innerParams.get(t),i=!r||e.input!==r.input;pW.forEach(o=>{const s=Ta(n,z[o]);s&&(CW(o,e.inputAttributes),s.className=z[o],i&&Jn(s))}),e.input&&(i&&vW(e),bW(e))},vW=t=>{if(!t.input)return;if(!rn[t.input]){mu(`Unexpected type of input! Expected ${Object.keys(rn).join(" | ")}, got "${t.input}"`);return}const e=VA(t.input);if(!e)return;const n=rn[t.input](e,t);Hn(e),t.inputAutoFocus&&setTimeout(()=>{$A(n)})},yW=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},CW=(t,e)=>{const n=nt();if(!n)return;const r=gv(n,t);if(r){yW(r);for(const i in e)r.setAttribute(i,e[i])}},bW=t=>{if(!t.input)return;const e=VA(t.input);e&&Zr(e,t,"input")},v0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},Gf=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=z["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&ut(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},VA=t=>{const e=nt();if(e)return Ta(e,z[t]||z.input)},Qp=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:u0(e)||cr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},rn={};rn.text=rn.email=rn.password=rn.number=rn.tel=rn.url=rn.search=rn.date=rn["datetime-local"]=rn.time=rn.week=rn.month=(t,e)=>(Qp(t,e.inputValue),Gf(t,t,e),v0(t,e),t.type=e.input,t);rn.file=(t,e)=>(Gf(t,t,e),v0(t,e),t);rn.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return Qp(n,e.inputValue),n.type=e.input,Qp(r,e.inputValue),Gf(n,t,e),t};rn.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");ei(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return Gf(t,t,e),t};rn.radio=t=>(t.textContent="",t);rn.checkbox=(t,e)=>{const n=gv(nt(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return ei(r,e.inputPlaceholder||e.inputLabel),n};rn.textarea=(t,e)=>{Qp(t,e.inputValue),v0(t,e),Gf(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(nt()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?nt().style.width=`${o}px`:Ql(nt(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const SW=(t,e)=>{const n=c0();n&&(m0(n),Zr(n,e,"htmlContainer"),e.html?(w0(e.html,n),Hn(n,"block")):e.text?(n.textContent=e.text,Hn(n,"block")):Jn(n),wW(t,e))},RW=(t,e)=>{const n=kA();n&&(m0(n),Yf(n,e.footer,"block"),e.footer&&w0(e.footer,n),Zr(n,e,"footer"))},EW=(t,e)=>{const n=Et.innerParams.get(t),r=nh();if(!r)return;if(n&&e.icon===n.icon){nP(r,e),tP(r,e);return}if(!e.icon&&!e.iconHtml){Jn(r);return}if(e.icon&&Object.keys(Zp).indexOf(e.icon)===-1){mu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),Jn(r);return}Hn(r),nP(r,e),tP(r,e),ut(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",WA)},tP=(t,e)=>{for(const[n,r]of Object.entries(Zp))e.icon!==n&&bi(t,r);ut(t,e.icon&&Zp[e.icon]),_W(t,e),WA(),Zr(t,e,"icon")},WA=()=>{const t=nt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},TW=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,MW=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,nP=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=rP(e.iconHtml):e.icon==="success"?(r=TW,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=MW:e.icon&&(r=rP({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&ei(t,r)},_W=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Q_(t,n,"background-color",e.iconColor);Q_(t,".swal2-success-ring","border-color",e.iconColor)}},rP=t=>`<div class="${z["icon-content"]}">${t}</div>`,PW=(t,e)=>{const n=DA();if(n){if(!e.imageUrl){Jn(n);return}Hn(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),Ql(n,"width",e.imageWidth),Ql(n,"height",e.imageHeight),n.className=z.image,Zr(n,e,"image")}};let y0=!1,BA=0,jA=0,UA=0,zA=0;const xW=t=>{t.addEventListener("mousedown",ew),document.body.addEventListener("mousemove",tw),t.addEventListener("mouseup",nw),t.addEventListener("touchstart",ew),document.body.addEventListener("touchmove",tw),t.addEventListener("touchend",nw)},IW=t=>{t.removeEventListener("mousedown",ew),document.body.removeEventListener("mousemove",tw),t.removeEventListener("mouseup",nw),t.removeEventListener("touchstart",ew),document.body.removeEventListener("touchmove",tw),t.removeEventListener("touchend",nw)},ew=t=>{const e=nt();if(t.target===e||nh().contains(t.target)){y0=!0;const n=YA(t);BA=n.clientX,jA=n.clientY,UA=parseInt(e.style.insetInlineStart)||0,zA=parseInt(e.style.insetBlockStart)||0,ut(e,"swal2-dragging")}},tw=t=>{const e=nt();if(y0){let{clientX:n,clientY:r}=YA(t);e.style.insetInlineStart=`${UA+(n-BA)}px`,e.style.insetBlockStart=`${zA+(r-jA)}px`}},nw=()=>{const t=nt();y0=!1,bi(t,"swal2-dragging")},YA=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},OW=(t,e)=>{const n=fr(),r=nt();if(!(!n||!r)){if(e.toast){Ql(n,"width",e.width),r.style.width="100%";const i=ih();i&&r.insertBefore(i,nh())}else Ql(r,"width",e.width);Ql(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),Jn(hv()),AW(r,e),e.draggable&&!e.toast?(ut(r,z.draggable),xW(r)):(bi(r,z.draggable),IW(r))}},AW=(t,e)=>{const n=e.showClass||{};t.className=`${z.popup} ${Nr(t)?n.popup:""}`,e.toast?(ut([document.documentElement,document.body],z["toast-shown"]),ut(t,z.toast)):ut(t,z.modal),Zr(t,e,"popup"),typeof e.customClass=="string"&&ut(t,e.customClass),e.icon&&ut(t,z[`icon-${e.icon}`])},HW=(t,e)=>{const n=h0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){Jn(n);return}Hn(n),n.textContent="",i>=r.length&&cr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=NW(o);if(n.appendChild(a),s===i&&ut(a,z["active-progress-step"]),s!==r.length-1){const l=DW(e);n.appendChild(l)}})},NW=t=>{const e=document.createElement("li");return ut(e,z["progress-step"]),ei(e,t),e},DW=t=>{const e=document.createElement("li");return ut(e,z["progress-step-line"]),t.progressStepsDistance&&Ql(e,"width",t.progressStepsDistance),e},kW=(t,e)=>{const n=NA();n&&(m0(n),Yf(n,e.title||e.titleText,"block"),e.title&&w0(e.title,n),e.titleText&&(n.innerText=e.titleText),Zr(n,e,"title"))},GA=(t,e)=>{OW(t,e),dW(t,e),HW(t,e),EW(t,e),PW(t,e),kW(t,e),hW(t,e),SW(t,e),lW(t,e),RW(t,e);const n=nt();typeof e.didRender=="function"&&n&&e.didRender(n),Se.eventEmitter.emit("didRender",n)},$W=()=>Nr(nt()),KA=()=>{var t;return(t=Yo())===null||t===void 0?void 0:t.click()},LW=()=>{var t;return(t=pu())===null||t===void 0?void 0:t.click()},FW=()=>{var t;return(t=rh())===null||t===void 0?void 0:t.click()},oh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),qA=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},VW=(t,e,n)=>{qA(t),e.toast||(t.keydownHandler=r=>BW(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:nt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},IS=(t,e)=>{var n;const r=f0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=nt())===null||n===void 0||n.focus()},XA=["ArrowRight","ArrowDown"],WW=["ArrowLeft","ArrowUp"],BW=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?jW(e,t):e.key==="Tab"?UW(e):[...XA,...WW].includes(e.key)?zW(e.key):e.key==="Escape"&&YW(e,t,n)))},jW=(t,e)=>{if(!cv(e.allowEnterKey))return;const n=gv(nt(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;KA(),t.preventDefault()}},UW=t=>{const e=t.target,n=f0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?IS(r,-1):IS(r,1),t.stopPropagation(),t.preventDefault()},zW=t=>{const e=zf(),n=Yo(),r=pu(),i=rh();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=XA.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Nr(a))break}a instanceof HTMLButtonElement&&a.focus()}},YW=(t,e,n)=>{cv(e.allowEscapeKey)&&(t.preventDefault(),n(oh.esc))};var zc={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const GW=()=>{const t=fr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},JA=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},ZA=typeof window<"u"&&!!window.GestureEvent,KW=()=>{if(ZA&&!$s(document.body,z.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,ut(document.body,z.iosfix),qW()}},qW=()=>{const t=fr();if(!t)return;let e;t.ontouchstart=n=>{e=XW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},XW=t=>{const e=t.target,n=fr(),r=c0();return!n||!r||JW(t)||ZW(t)?!1:e===n||!eP(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(eP(r)&&r.contains(e))},JW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",ZW=t=>t.touches&&t.touches.length>1,QW=()=>{if($s(document.body,z.iosfix)){const t=parseInt(document.body.style.top,10);bi(document.body,z.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},eB=()=>{const t=document.createElement("div");t.className=z["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let Hc=null;const tB=t=>{Hc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(Hc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Hc+eB()}px`)},nB=()=>{Hc!==null&&(document.body.style.paddingRight=`${Hc}px`,Hc=null)};function QA(t,e,n,r){fv()?iP(t,r):(WV(n).then(()=>iP(t,r)),qA(Se)),ZA?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),g0()&&(nB(),QW(),JA()),rB()}function rB(){bi([document.documentElement,document.body],[z.shown,z["height-auto"],z["no-backdrop"],z["toast-shown"]])}function Ma(t){t=oB(t);const e=zc.swalPromiseResolve.get(this),n=iB(this);this.isAwaitingPromise?t.isDismissed||(Kf(this),e(t)):n&&e(t)}const iB=t=>{const e=nt();if(!e)return!1;const n=Et.innerParams.get(t);if(!n||$s(e,n.hideClass.popup))return!1;bi(e,n.showClass.popup),ut(e,n.hideClass.popup);const r=fr();return bi(r,n.showClass.backdrop),ut(r,n.hideClass.backdrop),sB(t,e,n),!0};function eH(t){const e=zc.swalPromiseReject.get(this);Kf(this),e&&e(t)}const Kf=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Et.innerParams.get(t)||t._destroy())},oB=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),sB=(t,e,n)=>{var r;const i=fr(),o=FA(e);typeof n.willClose=="function"&&n.willClose(e),(r=Se.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?aB(t,e,i,n.returnFocus,n.didClose):QA(t,i,n.returnFocus,n.didClose)},aB=(t,e,n,r,i)=>{Se.swalCloseEventFinishedCallback=QA.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Se.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Se),delete Se.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},iP=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Se.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Yc=t=>{let e=nt();if(e||new Ji,e=nt(),!e)return;const n=ih();fv()?Jn(nh()):lB(e,t),Hn(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},lB=(t,e)=>{const n=zf(),r=ih();!n||!r||(!e&&Nr(Yo())&&(e=Yo()),Hn(n),e&&(Jn(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),ut([t,n],z.loading))},uB=(t,e)=>{e.input==="select"||e.input==="radio"?gB(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(l0(e.inputValue)||u0(e.inputValue))&&(Yc(Yo()),mB(t,e))},cB=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return hB(n);case"radio":return dB(n);case"file":return fB(n);default:return e.inputAutoTrim?n.value.trim():n.value}},hB=t=>t.checked?1:0,dB=t=>t.checked?t.value:null,fB=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,gB=(t,e)=>{const n=nt();if(!n)return;const r=i=>{e.input==="select"?pB(n,rw(i),e):e.input==="radio"&&wB(n,rw(i),e)};l0(e.inputOptions)||u0(e.inputOptions)?(Yc(Yo()),jf(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):mu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},mB=(t,e)=>{const n=t.getInput();n&&(Jn(n),jf(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,Hn(n),n.focus(),t.hideLoading()}).catch(r=>{mu(`Error in inputValue promise: ${r}`),n.value="",Hn(n),n.focus(),t.hideLoading()}))};function pB(t,e,n){const r=Ta(t,z.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,ei(l,s),l.selected=tH(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function wB(t,e,n){const r=Ta(t,z.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=z.radio,l.value=s,tH(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");ei(c,a),c.className=z.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const rw=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=rw(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=rw(r)),e.push([n,r])}),e},tH=(t,e)=>!!e&&e.toString()===t.toString(),vB=t=>{const e=Et.innerParams.get(t);t.disableButtons(),e.input?nH(t,"confirm"):b0(t,!0)},yB=t=>{const e=Et.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?nH(t,"deny"):C0(t,!1)},CB=(t,e)=>{t.disableButtons(),e(oh.cancel)},nH=(t,e)=>{const n=Et.innerParams.get(t);if(!n.input){mu(`The "input" parameter is needed to be set when using returnInputValueOn${a0(e)}`);return}const r=t.getInput(),i=cB(t,n);n.inputValidator?bB(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?C0(t,i):b0(t,i)},bB=(t,e,n)=>{const r=Et.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>jf(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?C0(t,e):b0(t,e)})},C0=(t,e)=>{const n=Et.innerParams.get(t||void 0);n.showLoaderOnDeny&&Yc(pu()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>jf(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),Kf(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>rH(t||void 0,i))):t.close({isDenied:!0,value:e})},oP=(t,e)=>{t.close({isConfirmed:!0,value:e})},rH=(t,e)=>{t.rejectPromise(e)},b0=(t,e)=>{const n=Et.innerParams.get(t||void 0);n.showLoaderOnConfirm&&Yc(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>jf(n.preConfirm(e,n.validationMessage))).then(i=>{Nr(hv())||i===!1?(t.hideLoading(),Kf(t)):oP(t,typeof i>"u"?e:i)}).catch(i=>rH(t||void 0,i))):oP(t,e)};function iw(){const t=Et.innerParams.get(this);if(!t)return;const e=Et.domCache.get(this);Jn(e.loader),fv()?t.icon&&Hn(nh()):SB(e),bi([e.popup,e.actions],z.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const SB=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?Hn(e[0],"inline-block"):XV()&&Jn(t.actions)};function iH(){const t=Et.innerParams.get(this),e=Et.domCache.get(this);return e?gv(e.popup,t.input):null}function oH(t,e,n){const r=Et.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function sH(t,e){const n=nt();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${z.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function aH(){oH(this,["confirmButton","denyButton","cancelButton"],!1)}function lH(){oH(this,["confirmButton","denyButton","cancelButton"],!0)}function uH(){sH(this.getInput(),!1)}function cH(){sH(this.getInput(),!0)}function hH(t){const e=Et.domCache.get(this),n=Et.innerParams.get(this);ei(e.validationMessage,t),e.validationMessage.className=z["validation-message"],n.customClass&&n.customClass.validationMessage&&ut(e.validationMessage,n.customClass.validationMessage),Hn(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",z["validation-message"]),$A(r),ut(r,z.inputerror))}function dH(){const t=Et.domCache.get(this);t.validationMessage&&Jn(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),bi(e,z.inputerror))}const Nc={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},RB=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],EB={allowEnterKey:void 0},TB=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],fH=t=>Object.prototype.hasOwnProperty.call(Nc,t),gH=t=>RB.indexOf(t)!==-1,mH=t=>EB[t],MB=t=>{fH(t)||cr(`Unknown parameter "${t}"`)},_B=t=>{TB.includes(t)&&cr(`The parameter "${t}" is incompatible with toasts`)},PB=t=>{const e=mH(t);e&&HA(t,e)},pH=t=>{t.backdrop===!1&&t.allowOutsideClick&&cr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&cr(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)MB(e),t.toast&&_B(e),PB(e)};function wH(t){const e=fr(),n=nt(),r=Et.innerParams.get(this);if(!n||$s(n,r.hideClass.popup)){cr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=xB(t),o=Object.assign({},r,i);pH(o),e.dataset.swal2Theme=o.theme,GA(this,o),Et.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const xB=t=>{const e={};return Object.keys(t).forEach(n=>{gH(n)?e[n]=t[n]:cr(`Invalid parameter to update: ${n}`)}),e};function vH(){const t=Et.domCache.get(this),e=Et.innerParams.get(this);if(!e){yH(this);return}t.popup&&Se.swalCloseEventFinishedCallback&&(Se.swalCloseEventFinishedCallback(),delete Se.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Se.eventEmitter.emit("didDestroy"),IB(this)}const IB=t=>{yH(t),delete t.params,delete Se.keydownHandler,delete Se.keydownTarget,delete Se.currentInstance},yH=t=>{t.isAwaitingPromise?(Sy(Et,t),t.isAwaitingPromise=!0):(Sy(zc,t),Sy(Et,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},Sy=(t,e)=>{for(const n in t)t[n].delete(e)};var OB=Object.freeze({__proto__:null,_destroy:vH,close:Ma,closeModal:Ma,closePopup:Ma,closeToast:Ma,disableButtons:lH,disableInput:cH,disableLoading:iw,enableButtons:aH,enableInput:uH,getInput:iH,handleAwaitingPromise:Kf,hideLoading:iw,rejectPromise:eH,resetValidationMessage:dH,showValidationMessage:hH,update:wH});const AB=(t,e,n)=>{t.toast?HB(t,e,n):(DB(e),kB(e),$B(t,e,n))},HB=(t,e,n)=>{e.popup.onclick=()=>{t&&(NB(t)||t.timer||t.input)||n(oh.close)}},NB=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let ow=!1;const DB=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(ow=!0)}}},kB=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(ow=!0)}}},$B=(t,e,n)=>{e.container.onclick=r=>{if(ow){ow=!1;return}r.target===e.container&&cv(t.allowOutsideClick)&&n(oh.backdrop)}},LB=t=>typeof t=="object"&&t.jquery,sP=t=>t instanceof Element||LB(t),FB=t=>{const e={};return typeof t[0]=="object"&&!sP(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||sP(i)?e[n]=i:i!==void 0&&mu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function VB(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function WB(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const BB=()=>Se.timeout&&Se.timeout.getTimerLeft(),CH=()=>{if(Se.timeout)return JV(),Se.timeout.stop()},bH=()=>{if(Se.timeout){const t=Se.timeout.start();return p0(t),t}},jB=()=>{const t=Se.timeout;return t&&(t.running?CH():bH())},UB=t=>{if(Se.timeout){const e=Se.timeout.increase(t);return p0(e,!0),e}},zB=()=>!!(Se.timeout&&Se.timeout.isRunning());let aP=!1;const OS={};function YB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";OS[t]=this,aP||(document.body.addEventListener("click",GB),aP=!0)}const GB=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in OS){const r=e.getAttribute(n);if(r){OS[n].fire({template:r});return}}};class KB{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Se.eventEmitter=new KB;const qB=(t,e)=>{Se.eventEmitter.on(t,e)},XB=(t,e)=>{Se.eventEmitter.once(t,e)},JB=(t,e)=>{if(!t){Se.eventEmitter.reset();return}e?Se.eventEmitter.removeListener(t,e):Se.eventEmitter.removeAllListeners(t)};var ZB=Object.freeze({__proto__:null,argsToParams:FB,bindClickHandler:YB,clickCancel:FW,clickConfirm:KA,clickDeny:LW,enableLoading:Yc,fire:VB,getActions:zf,getCancelButton:rh,getCloseButton:d0,getConfirmButton:Yo,getContainer:fr,getDenyButton:pu,getFocusableElements:f0,getFooter:kA,getHtmlContainer:c0,getIcon:nh,getIconContent:zV,getImage:DA,getInputLabel:YV,getLoader:ih,getPopup:nt,getProgressSteps:h0,getTimerLeft:BB,getTimerProgressBar:dv,getTitle:NA,getValidationMessage:hv,increaseTimer:UB,isDeprecatedParameter:mH,isLoading:KV,isTimerRunning:zB,isUpdatableParameter:gH,isValidParameter:fH,isVisible:$W,mixin:WB,off:JB,on:qB,once:XB,resumeTimer:bH,showLoading:Yc,stopTimer:CH,toggleTimer:jB});class QB{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const SH=["swal-title","swal-html","swal-footer"],e2=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return l2(n),Object.assign(t2(n),n2(n),r2(n),i2(n),o2(n),s2(n),a2(n,SH))},t2=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{iu(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof Nc[i]=="boolean"?e[i]=o!=="false":typeof Nc[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},n2=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},r2=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{iu(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${a0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},i2=t=>{const e={},n=t.querySelector("swal-image");return n&&(iu(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},o2=t=>{const e={},n=t.querySelector("swal-icon");return n&&(iu(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},s2=t=>{const e={},n=t.querySelector("swal-input");n&&(iu(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{iu(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},a2=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(iu(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},l2=t=>{const e=SH.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||cr(`Unrecognized element <${r}>`)})},iu=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&cr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},RH=10,u2=t=>{const e=fr(),n=nt();typeof t.willOpen=="function"&&t.willOpen(n),Se.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;d2(e,n,t),setTimeout(()=>{c2(e,n)},RH),g0()&&(h2(e,t.scrollbarPadding,i),GW()),!fv()&&!Se.previousActiveElement&&(Se.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Se.eventEmitter.emit("didOpen",n),bi(e,z["no-transition"])},sw=t=>{const e=nt();if(t.target!==e)return;const n=fr();e.removeEventListener("animationend",sw),e.removeEventListener("transitionend",sw),n.style.overflowY="auto"},c2=(t,e)=>{FA(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",sw),e.addEventListener("transitionend",sw)):t.style.overflowY="auto"},h2=(t,e,n)=>{KW(),e&&n!=="hidden"&&tB(n),setTimeout(()=>{t.scrollTop=0})},d2=(t,e,n)=>{ut(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),Hn(e,"grid"),setTimeout(()=>{ut(e,n.showClass.popup),e.style.removeProperty("opacity")},RH)):Hn(e,"grid"),ut([document.documentElement,document.body],z.shown),n.heightAuto&&n.backdrop&&!n.toast&&ut([document.documentElement,document.body],z["height-auto"])};var lP={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function f2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=lP.email),t.input==="url"&&(t.inputValidator=lP.url))}function g2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(cr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function m2(t){f2(t),t.showLoaderOnConfirm&&!t.preConfirm&&cr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),g2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),oW(t)}let No;var xg=new WeakMap;class cn{constructor(){if($V(this,xg,void 0),typeof window>"u")return;No=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,LV(xg,this,this._main(No.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(pH(Object.assign({},n,e)),Se.currentInstance){const o=zc.swalPromiseResolve.get(Se.currentInstance),{isAwaitingPromise:s}=Se.currentInstance;Se.currentInstance._destroy(),s||o({isDismissed:!0}),g0()&&JA()}Se.currentInstance=No;const r=w2(e,n);m2(r),Object.freeze(r),Se.timeout&&(Se.timeout.stop(),delete Se.timeout),clearTimeout(Se.restoreFocusTimeout);const i=v2(No);return GA(No,r),Et.innerParams.set(No,r),p2(No,i,r)}then(e){return J_(xg,this).then(e)}finally(e){return J_(xg,this).finally(e)}}const p2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};zc.swalPromiseResolve.set(t,r),zc.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{vB(t)},e.denyButton.onclick=()=>{yB(t)},e.cancelButton.onclick=()=>{CB(t,o)},e.closeButton.onclick=()=>{o(oh.close)},AB(n,e,o),VW(Se,n,o),uB(t,n),u2(n),y2(Se,n,o),C2(e,n),setTimeout(()=>{e.container.scrollTop=0})}),w2=(t,e)=>{const n=e2(t),r=Object.assign({},Nc,e,n,t);return r.showClass=Object.assign({},Nc.showClass,r.showClass),r.hideClass=Object.assign({},Nc.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},v2=t=>{const e={popup:nt(),container:fr(),actions:zf(),confirmButton:Yo(),denyButton:pu(),cancelButton:rh(),loader:ih(),closeButton:d0(),validationMessage:hv(),progressSteps:h0()};return Et.domCache.set(t,e),e},y2=(t,e,n)=>{const r=dv();Jn(r),e.timer&&(t.timeout=new QB(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(Hn(r),Zr(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&p0(e.timer)})))},C2=(t,e)=>{if(!e.toast){if(!cv(e.allowEnterKey)){HA("allowEnterKey"),R2();return}b2(t)||S2(t,e)||IS(-1,1)}},b2=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&Nr(n))return n.focus(),!0;return!1},S2=(t,e)=>e.focusDeny&&Nr(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Nr(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&Nr(t.confirmButton)?(t.confirmButton.focus(),!0):!1,R2=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}cn.prototype.disableButtons=lH;cn.prototype.enableButtons=aH;cn.prototype.getInput=iH;cn.prototype.disableInput=cH;cn.prototype.enableInput=uH;cn.prototype.hideLoading=iw;cn.prototype.disableLoading=iw;cn.prototype.showValidationMessage=hH;cn.prototype.resetValidationMessage=dH;cn.prototype.close=Ma;cn.prototype.closePopup=Ma;cn.prototype.closeModal=Ma;cn.prototype.closeToast=Ma;cn.prototype.rejectPromise=eH;cn.prototype.update=wH;cn.prototype._destroy=vH;Object.assign(cn,ZB);Object.keys(OB).forEach(t=>{cn[t]=function(){return No&&No[t]?No[t](...arguments):null}});cn.DismissReason=oh;cn.version="11.21.0";const Ji=cn;Ji.default=Ji;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var Us=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(A){if(A=o.postProcess(A,r),i){setTimeout(function(){i(A)},0);return}else return A},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],v=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&v+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var y=-1/0,E=1/0,C=function(){for(var A=Math.max(y,-c);A<=Math.min(E,c);A+=2){var _=void 0,T=g[A-1],H=g[A+1];T&&(g[A-1]=void 0);var G=!1;if(H){var U=H.oldPos-A;G=H&&0<=U&&U<l}var V=T&&T.oldPos+1<u;if(!G&&!V){g[A]=void 0;continue}if(!V||G&&T.oldPos<H.oldPos?_=o.addToPath(H,!0,!1,0,r):_=o.addToPath(T,!1,!0,1,r),v=o.extractCommon(_,n,e,A,r),_.oldPos+1>=u&&v+1>=l)return a(o.buildValues(_.lastComponent,n,e))||!0;g[A]=_,_.oldPos+1>=u&&(E=Math.min(E,A-1)),v+1>=l&&(y=Math.max(y,A+1))}c++};if(i)(function A(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);C()||A()},0)})();else for(;c<=h&&Date.now()<=f;){var P=C();if(P)return P}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),E2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),T2=function(t){E2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Us),EH=new T2;function M2(t,e,n){return EH.diff(t,e,n)}function uP(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function cP(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function AS(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function HS(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function Eh(t,e){return AS(t,e,"")}function Ig(t,e){return HS(t,e,"")}function hP(t,e){return e.slice(0,_2(t,e))}function _2(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function P2(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function x2(t){return!t.includes(`\r
`)&&t.includes(`
`)}function Th(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function Js(t){var e=t.match(/^\s*/);return e?e[0]:""}var TH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),aw="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",I2=new RegExp("[".concat(aw,"]+|\\s+|[^").concat(aw,"]"),"ug"),O2=function(t){TH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(I2)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&dP(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&dP(i,s,o,null),n},e}(Us),MH=new O2;function A2(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?PH(t,e,n):MH.diff(t,e,n)}function dP(t,e,n,r){if(e&&n){var i=Js(e.value),o=Th(e.value),s=Js(n.value),a=Th(n.value);if(t){var l=uP(i,s);t.value=HS(t.value,s,l),e.value=Eh(e.value,l),n.value=Eh(n.value,l)}if(r){var u=cP(o,a);r.value=AS(r.value,a,u),e.value=Ig(e.value,u),n.value=Ig(n.value,u)}}else if(n){if(t){var c=Js(n.value);n.value=n.value.substring(c.length)}if(r){var c=Js(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=Js(r.value),d=Js(e.value),f=Th(e.value),g=uP(h,d);e.value=Eh(e.value,g);var v=cP(Eh(h,g),f);e.value=Ig(e.value,v),r.value=AS(r.value,h,v),t.value=HS(t.value,h,h.slice(0,h.length-v.length))}else if(r){var y=Js(r.value),E=Th(e.value),C=hP(E,y);e.value=Ig(e.value,C)}else if(t){var P=Th(t.value),A=Js(e.value),C=hP(P,A);e.value=Eh(e.value,C)}}var H2=function(t){TH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(aw,"]+|[^\\S\\n\\r]+|[^").concat(aw,"]"),"ug");return n.match(r)||[]},e}(Us),_H=new H2;function PH(t,e,n){return _H.diff(t,e,n)}function N2(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var D2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),k2=function(t){D2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=xH,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}(Us),S0=new k2;function pf(t,e,n){return S0.diff(t,e,n)}function $2(t,e,n){return n=N2(n,{ignoreWhitespace:!0}),S0.diff(t,e,n)}function xH(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var L2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),F2=function(t){L2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}(Us),IH=new F2;function V2(t,e,n){return IH.diff(t,e,n)}var W2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),B2=function(t){W2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}(Us),OH=new B2;function j2(t,e,n){return OH.diff(t,e,n)}var U2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),z2=function(t){U2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=xH,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(lw(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}(Us),AH=new z2;function Y2(t,e,n){return AH.diff(t,e,n)}function lw(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=lw(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=lw(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var G2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),K2=function(t){G2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}(Us),HH=new K2;function q2(t,e,n){return HH.diff(t,e,n)}var Wo=function(){return Wo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Wo.apply(this,arguments)};function NH(t){return Array.isArray(t)?t.map(function(e){return NH(e)}):Wo(Wo({},t),{hunks:t.hunks.map(function(e){return Wo(Wo({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function DH(t){return Array.isArray(t)?t.map(function(e){return DH(e)}):Wo(Wo({},t),{hunks:t.hunks.map(function(e){return Wo(Wo({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function X2(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function J2(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function R0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function Z2(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function kH(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=R0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return Q2(t,r[0],n)}function Q2(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(P2(t)&&X2(e)?e=NH(e):x2(t)&&J2(e)&&(e=DH(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(G,U,V,X){return U===X},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(G,U,V,X,ne,Q,te){X===void 0&&(X=0),ne===void 0&&(ne=!0),Q===void 0&&(Q=[]),te===void 0&&(te=0);for(var pe=0,et=!1;X<G.length;X++){var Re=G[X],Ae=Re.length>0?Re[0]:" ",ot=Re.length>0?Re.substr(1):Re;if(Ae==="-")if(o(U+1,r[U],Ae,ot))U++,pe=0;else return!V||r[U]==null?null:(Q[te]=r[U],f(G,U+1,V-1,X,!1,Q,te+1));if(Ae==="+"){if(!ne)return null;Q[te]=ot,te++,pe=0,et=!0}if(Ae===" ")if(pe++,Q[te]=r[U],o(U+1,r[U],Ae,ot))te++,ne=!0,et=!1,U++;else return et||!V?null:r[U]&&(f(G,U+1,V-1,X+1,!1,Q,te+1)||f(G,U+1,V-1,X,!1,Q,te+1))||f(G,U,V-1,X+1,!1,Q,te)}return te-=pe,U-=pe,Q.length=te,{patchedLines:Q,oldLineLastI:U-1}}for(var g=[],v=0,h=0;h<i.length;h++){for(var y=i[h],E=void 0,C=r.length-y.oldLines+s,P=void 0,A=0;A<=s;A++){P=y.oldStart+v-1;for(var _=Z2(P,a,C);P!==void 0&&(E=f(y.lines,P,A),!E);P=_());if(E)break}if(!E)return!1;for(var T=a;T<P;T++)g.push(r[T]);for(var H=0;H<E.patchedLines.length;H++){var d=E.patchedLines[H];g.push(d)}a=E.oldLineLastI+1,v=P+1-y.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function ej(t,e){var n=typeof t=="string"?R0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=kH(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var uw=function(){return uw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},uw.apply(this,arguments)};function $H(t){return Array.isArray(t)?t.map(function(e){return $H(e)}).reverse():uw(uw({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var Gc=function(){return Gc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Gc.apply(this,arguments)};function NS(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;pf(n,r,Gc(Gc({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(pf(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(Ae){return Ae.map(function(ot){return" "+ot})}for(var f=[],g=0,v=0,y=[],E=1,C=1,P=0;P<h.length;P++){var A=h[P],_=A.lines||nj(A.value);if(A.lines=_,A.added||A.removed){if(!g){var T=h[P-1];g=E,v=C,T&&(y=l>0?d(T.lines.slice(-l)):[],g-=y.length,v-=y.length)}for(var H=0,G=_;H<G.length;H++){var U=G[H];y.push((A.added?"+":"-")+U)}A.added?C+=_.length:E+=_.length}else{if(g)if(_.length<=l*2&&P<h.length-2)for(var V=0,X=d(_);V<X.length;V++){var U=X[V];y.push(U)}else{for(var ne=Math.min(_.length,l),Q=0,te=d(_.slice(0,ne));Q<te.length;Q++){var U=te[Q];y.push(U)}var pe={oldStart:g,oldLines:E-g+ne,newStart:v,newLines:C-v+ne,lines:y};f.push(pe),g=0,v=0,y=[]}E+=_.length,C+=_.length}}for(var et=0,Re=f;et<Re.length;et++)for(var pe=Re[et],P=0;P<pe.lines.length;P++)pe.lines[P].endsWith(`
`)?pe.lines[P]=pe.lines[P].slice(0,-1):(pe.lines.splice(P+1,0,"\\ No newline at end of file"),P++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function cw(t){if(Array.isArray(t))return t.map(cw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function LH(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;NS(t,e,n,r,i,o,Gc(Gc({},s),{callback:function(u){l(u?cw(u):void 0)}}))}else{var a=NS(t,e,n,r,i,o,s);return a?cw(a):void 0}}function tj(t,e,n,r,i,o){return LH(t,t,e,n,r,i,o)}function nj(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function rj(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function ij(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(oj(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function oj(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const sj=Object.freeze(Object.defineProperty({__proto__:null,Diff:Us,applyPatch:kH,applyPatches:ej,arrayDiff:HH,canonicalize:lw,characterDiff:EH,convertChangesToDMP:rj,convertChangesToXML:ij,createPatch:tj,createTwoFilesPatch:LH,cssDiff:OH,diffArrays:q2,diffChars:M2,diffCss:j2,diffJson:Y2,diffLines:pf,diffSentences:V2,diffTrimmedLines:$2,diffWords:A2,diffWordsWithSpace:PH,formatPatch:cw,jsonDiff:AH,lineDiff:S0,parsePatch:R0,reversePatch:$H,sentenceDiff:IH,structuredPatch:NS,wordDiff:MH,wordsWithSpaceDiff:_H},Symbol.toStringTag,{value:"Module"}));function aj(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[],hotInstance:i}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();let o="",s="",a=[];const l=(h,d=2)=>{const f=g=>{if(typeof g!="object"||g===null)return g;if(Array.isArray(g))return g.map(f);const v={};return Object.keys(g).forEach(y=>{v[y]=f(g[y])}),v};try{return JSON.stringify(f(h),null,d)}catch(g){return console.error("Error stringifying object while preserving key order:",g),JSON.stringify(h,null,d)}};function u(h){return h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}if(n&&n.left!==void 0&&n.right!==void 0)if(typeof sj>"u"||typeof pf!="function")s='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다. (Diff is not defined)</p>',o='<div class="diff-popup-header error">라이브러리 오류</div>';else try{const h=l(n.left),d=l(n.right),f=pf(h,d);let g=0,v=0;f.forEach(V=>{const X=V.value||"",ne=X.split(`
`);let Q=ne.length;ne[ne.length-1]===""&&X.length>0&&Q--,X===""&&(Q=0),V.added?g+=Q:V.removed&&(v+=Q)});const y=[];let E=1,C=1;f.forEach((V,X)=>{const ne=V.value||"",Q=ne.split(`
`);let te=Q.length;Q[Q.length-1]===""&&ne.length>0&&te--,ne===""&&(te=0),V.removed?(y.push({originalPartIndex:X,part:V,sourceType:"del",lineNumber:E,numLines:te}),E+=te):V.added?(y.push({originalPartIndex:X,part:V,sourceType:"ins",lineNumber:C,numLines:te}),C+=te):(E+=te,C+=te)}),a=[];let P=[...y],A=null;for(P.length>0&&(P.sort((V,X)=>V.lineNumber!==X.lineNumber?V.lineNumber-X.lineNumber:V.sourceType==="del"&&X.sourceType!=="del"?-1:V.sourceType!=="del"&&X.sourceType==="del"?1:V.originalPartIndex-X.originalPartIndex),A=P[0],a.push(A),P=P.filter(V=>V.originalPartIndex!==A.originalPartIndex));P.length>0&&A;){const V=A.lineNumber;let X=null,ne=[];for(const Q of P)Q.lineNumber>=V&&ne.push({...Q,diff:Q.lineNumber-V});if(ne.length>0)ne.sort((Q,te)=>Q.diff!==te.diff?Q.diff-te.diff:Q.sourceType==="del"&&te.sourceType!=="del"?-1:Q.sourceType!=="del"&&te.sourceType==="del"?1:Q.originalPartIndex-te.originalPartIndex),X=ne[0];else{let Q=[];for(const te of P)Q.push({...te,absDiff:Math.abs(te.lineNumber-V)});Q.length>0&&(Q.sort((te,pe)=>te.absDiff!==pe.absDiff?te.absDiff-pe.absDiff:te.lineNumber!==pe.lineNumber?te.lineNumber-pe.lineNumber:te.sourceType==="del"&&pe.sourceType!=="del"?-1:te.sourceType!=="del"&&pe.sourceType==="del"?1:te.originalPartIndex-pe.originalPartIndex),X=Q[0])}if(X)a.push(X),A=X,P=P.filter(Q=>Q.originalPartIndex!==X.originalPartIndex);else break}let _="",T="",H=1,G=1;const U=new Map;if(a.forEach((V,X)=>U.set(V.originalPartIndex,X)),f.forEach((V,X)=>{const ne=V.value||"",Q=ne.replace(/\n$/,"").split(`
`);Q.length===1&&Q[0]===""&&ne===""||Q.forEach((te,pe)=>{let et="";(V.added||V.removed)&&pe===0&&U.has(X)&&(et=`id="diff-nav-target-${U.get(X)}"`),V.added?(_+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,T+=`<div ${et} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${G++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`):V.removed?(_+=`<div ${et} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${H++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`,T+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(_+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${H++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`,T+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${G++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`)})}),s=`<div class="diff-sbs-container"><div class="diff-sbs-pane" id="diff-left-pane">${_}</div><div class="diff-sbs-pane" id="diff-right-pane">${T}</div></div>`,a.length>0||g>0||v>0){let V="";(g>0||v>0)&&(V=`<span class="diff-summary"><strong class="diff-summary-added">+${g}</strong> <strong class="diff-summary-removed">-${v}</strong></span>`),o=`<div class="diff-popup-header">JSON 비교 결과 (텍스트 기반 Side-by-Side)</div><div id="diff-navigation">${V}<button id="prev-change-btn" class="swal2-styled">이전 변경점</button><button id="next-change-btn" class="swal2-styled">다음 변경점</button><span id="current-change-info"></span></div>`}else o='<div class="diff-popup-header">JSON 비교 결과</div>',h===d?s='<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':s='<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>'}catch(h){s=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${h.message}</p>`,o='<div class="diff-popup-header error">오류 발생</div>'}else s='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',o='<div class="diff-popup-header error">데이터 오류</div>';const c=`${o}<div id="diff-container">${s}</div>`;return lj({title:e,html:c,buttons:r,width:"95%",customClass:{popup:"custom-swal-popup-wider-text-diff",htmlContainer:"custom-swal-html-container-text-diff"},didOpen:h=>{const d=[];if(a&&a.length>0)for(let _=0;_<a.length;_++){const T=document.getElementById(`diff-nav-target-${_}`);T&&d.push(T)}let f=-1,g=null;const v=document.getElementById("diff-navigation"),y=document.getElementById("next-change-btn"),E=document.getElementById("prev-change-btn"),C=document.getElementById("current-change-info");function P(){if(!v)return;const _=d.length===0;y&&(y.style.display=_?"none":"inline-block"),E&&(E.style.display=_?"none":"inline-block"),C&&(C.textContent=_?totalAdded>0||totalRemoved>0?"0 / 0":"변경점 없음":`${f+1} / ${d.length}`),y&&(y.disabled=f>=d.length-1),E&&(E.disabled=f<=0)}function A(_){if(_<0||_>=d.length)return;g&&g.classList.remove("diff-navigation-highlight");const T=d[_];if(T){const H=document.getElementById("diff-container");if(H){const G=T.offsetTop;H.scrollTop=G-H.clientHeight/2+T.clientHeight/2}else T.scrollIntoView({block:"center"});T.classList.add("diff-navigation-highlight"),g=T}f=_,P()}d.length>0?A(0):P(),y&&y.addEventListener("click",()=>{f<d.length-1&&A(f+1)}),E&&E.addEventListener("click",()=>{f>0&&A(f-1)}),h.addEventListener("keydown",_=>{d.length===0||!y||!E||(_.key==="ArrowDown"||_.key==="PageDown"?(_.preventDefault(),y.disabled||y.click()):(_.key==="ArrowUp"||_.key==="PageUp")&&(_.preventDefault(),E.disabled||E.click()))}),P()}})}async function wc(t){const{title:e,inputLabel:n,inputValue:r="",inputPlaceholder:i="",inputValidator:o,confirmButtonText:s="확인",cancelButtonText:a="취소",showCancelButton:l=!0,customClass:u={},html:c,hotInstance:h}=t;h&&typeof h.deselectCell=="function"&&h.deselectCell();let d=c||"";return n&&!c&&(d=`<label style="display: block; text-align: left; margin-bottom: .5em; font-weight: normal;">${n}</label>`),Ji.fire({title:e,html:d,input:"text",inputValue:r,inputPlaceholder:i,inputValidator:o,showCancelButton:l,confirmButtonText:s,cancelButtonText:a,customClass:u,didOpen:()=>{const f=Ji.getInput();f&&(f.focus(),typeof f.select=="function"&&f.select())}})}async function At(t){const{title:e,text:n="",html:r="",icon:i="warning",confirmButtonText:o="확인",cancelButtonText:s="취소",showCancelButton:a=!0,customClass:l={},hotInstance:u}=t;return u&&typeof u.deselectCell=="function"&&u.deselectCell(),Ji.fire({title:e,text:n,html:r,icon:i,showCancelButton:a,confirmButtonText:o,cancelButtonText:s,customClass:l})}function lj(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u}=t,c={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:a,preConfirm:l,didOpen:u},h=i.find(g=>g.role==="confirm"||!g.role&&i.indexOf(g)===0),d=i.find(g=>g.role==="cancel");return h?(c.showConfirmButton=!0,c.confirmButtonText=h.text||Ji.getConfirmButton().innerText,h.color&&(c.confirmButtonColor=h.color)):i.length>0||l?!i.some(g=>g.role!=="cancel")&&!l&&(c.showConfirmButton=!1):c.showConfirmButton=!1,d&&(c.showCancelButton=!0,c.cancelButtonText=d.text||Ji.getCancelButton().innerText,d.color&&(c.cancelButtonColor=d.color)),typeof Ji>"u"?Promise.reject("SweetAlert2 is not imported"):Ji.fire(c).then(g=>{let v={...g,formData:{}};return g.isConfirmed&&l&&(v.formData=g.value||{}),g.isConfirmed&&h&&typeof h.action=="function"&&!l?h.action():g.isDismissed&&d&&typeof d.action=="function"&&g.dismiss===Ji.DismissReason.cancel&&d.action(),v})}const on=document.getElementById("json-input"),Xr=document.getElementById("save-message"),en=document.getElementById("json-error"),Ot=document.getElementById("tree-view"),FH=document.getElementById("table-view");function eu(t,e,n){t.textContent=e,setTimeout(()=>{t.textContent=""},n)}function Dc(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(t!=null){if(i.appendChild(document.createTextNode(o)),t==="")if(e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));else{let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u,c=!0;for(;(u=l.exec(t))!==null;){const h=u[0];let d=h,f;if(c?(a=h,c=!1):h.startsWith("[")?a+=h:(a+="."+h,i.appendChild(document.createTextNode(" > "))),f=a,h.startsWith("[")&&h.endsWith("]")&&(d=h),e){const g=document.createElement("a");g.href="#",g.textContent=d,g.style.textDecoration="underline",g.style.cursor="pointer",g.onclick=v=>{v.preventDefault(),e(f)},i.appendChild(g)}else i.appendChild(document.createTextNode(d))}}i.appendChild(document.createTextNode(s))}}function uj(){Ot.innerHTML="",FH.innerHTML="",en&&(en.textContent=""),Xr&&(Xr.textContent=""),Dc(null)}function ou(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function DS(t,e){if(typeof t=="string"){const n=t.trim();return n.toLowerCase()==="null"?null:n.toLowerCase()==="true"?!0:n.toLowerCase()==="false"?!1:n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,""))?Number(n):t}return t}function VH(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let jl=null;function Kc(t){jl&&jl.classList.remove("selected-node"),jl=t,jl&&jl.classList.add("selected-node")}function cj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),Kc(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),VH(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),Kc(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function hj(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),wf(e,o,n,r.rootJsonData,r.depth+1,r),o}function wf(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=cj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=hj(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function dj(){return jl?jl.dataset.path:null}function fj(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function gj(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var Og=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Mh=function(t){return t&&t.Math===Math&&t},wn=Mh(typeof globalThis=="object"&&globalThis)||Mh(typeof window=="object"&&window)||Mh(typeof self=="object"&&self)||Mh(typeof Og=="object"&&Og)||Mh(typeof Og=="object"&&Og)||function(){return this}()||Function("return this")(),E0={},Nn=function(t){try{return!!t()}catch{return!0}},mj=Nn,Ei=!mj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),pj=Nn,mv=!pj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),wj=mv,Ag=Function.prototype.call,vn=wj?Ag.bind(Ag):function(){return Ag.apply(Ag,arguments)},WH={},BH={}.propertyIsEnumerable,jH=Object.getOwnPropertyDescriptor,vj=jH&&!BH.call({1:2},1);WH.f=vj?function(e){var n=jH(this,e);return!!n&&n.enumerable}:BH;var pv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},UH=mv,zH=Function.prototype,kS=zH.call,yj=UH&&zH.bind.bind(kS,kS),hn=UH?yj:function(t){return function(){return kS.apply(t,arguments)}},YH=hn,Cj=YH({}.toString),bj=YH("".slice),wu=function(t){return bj(Cj(t),8,-1)},Sj=hn,Rj=Nn,Ej=wu,Ry=Object,Tj=Sj("".split),Mj=Rj(function(){return!Ry("z").propertyIsEnumerable(0)})?function(t){return Ej(t)==="String"?Tj(t,""):Ry(t)}:Ry,T0=function(t){return t==null},_j=T0,Pj=TypeError,qf=function(t){if(_j(t))throw new Pj("Can't call method on "+t);return t},xj=Mj,Ij=qf,Xf=function(t){return xj(Ij(t))},Ey=typeof document=="object"&&document.all,yn=typeof Ey>"u"&&Ey!==void 0?function(t){return typeof t=="function"||t===Ey}:function(t){return typeof t=="function"},Oj=yn,Ti=function(t){return typeof t=="object"?t!==null:Oj(t)},Ty=wn,Aj=yn,Hj=function(t){return Aj(t)?t:void 0},sh=function(t,e){return arguments.length<2?Hj(Ty[t]):Ty[t]&&Ty[t][e]},Nj=hn,Jf=Nj({}.isPrototypeOf),Dj=wn,fP=Dj.navigator,gP=fP&&fP.userAgent,wv=gP?String(gP):"",GH=wn,My=wv,mP=GH.process,pP=GH.Deno,wP=mP&&mP.versions||pP&&pP.version,vP=wP&&wP.v8,Xi,hw;vP&&(Xi=vP.split("."),hw=Xi[0]>0&&Xi[0]<4?1:+(Xi[0]+Xi[1]));!hw&&My&&(Xi=My.match(/Edge\/(\d+)/),(!Xi||Xi[1]>=74)&&(Xi=My.match(/Chrome\/(\d+)/),Xi&&(hw=+Xi[1])));var kj=hw,yP=kj,$j=Nn,Lj=wn,Fj=Lj.String,M0=!!Object.getOwnPropertySymbols&&!$j(function(){var t=Symbol("symbol detection");return!Fj(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&yP&&yP<41}),Vj=M0,KH=Vj&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Wj=sh,Bj=yn,jj=Jf,Uj=KH,zj=Object,_0=Uj?function(t){return typeof t=="symbol"}:function(t){var e=Wj("Symbol");return Bj(e)&&jj(e.prototype,zj(t))},Yj=String,vv=function(t){try{return Yj(t)}catch{return"Object"}},Gj=yn,Kj=vv,qj=TypeError,Dr=function(t){if(Gj(t))return t;throw new qj(Kj(t)+" is not a function")},Xj=Dr,Jj=T0,Zf=function(t,e){var n=t[e];return Jj(n)?void 0:Xj(n)},_y=vn,Py=yn,xy=Ti,Zj=TypeError,Qj=function(t,e){var n,r;if(e==="string"&&Py(n=t.toString)&&!xy(r=_y(n,t))||Py(n=t.valueOf)&&!xy(r=_y(n,t))||e!=="string"&&Py(n=t.toString)&&!xy(r=_y(n,t)))return r;throw new Zj("Can't convert object to primitive value")},qH={exports:{}},CP=wn,eU=Object.defineProperty,P0=function(t,e){try{eU(CP,t,{value:e,configurable:!0,writable:!0})}catch{CP[t]=e}return e},tU=wn,nU=P0,bP="__core-js_shared__",SP=qH.exports=tU[bP]||nU(bP,{});(SP.versions||(SP.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var x0=qH.exports,RP=x0,XH=function(t,e){return RP[t]||(RP[t]=e||{})},rU=qf,iU=Object,ah=function(t){return iU(rU(t))},oU=hn,sU=ah,aU=oU({}.hasOwnProperty),Mi=Object.hasOwn||function(e,n){return aU(sU(e),n)},lU=hn,uU=0,cU=Math.random(),hU=lU(1 .toString),JH=function(t){return"Symbol("+(t===void 0?"":t)+")_"+hU(++uU+cU,36)},dU=wn,fU=XH,EP=Mi,gU=JH,mU=M0,pU=KH,Mc=dU.Symbol,Iy=fU("wks"),wU=pU?Mc.for||Mc:Mc&&Mc.withoutSetter||gU,oo=function(t){return EP(Iy,t)||(Iy[t]=mU&&EP(Mc,t)?Mc[t]:wU("Symbol."+t)),Iy[t]},vU=vn,TP=Ti,MP=_0,yU=Zf,CU=Qj,bU=oo,SU=TypeError,RU=bU("toPrimitive"),EU=function(t,e){if(!TP(t)||MP(t))return t;var n=yU(t,RU),r;if(n){if(e===void 0&&(e="default"),r=vU(n,t,e),!TP(r)||MP(r))return r;throw new SU("Can't convert object to primitive value")}return e===void 0&&(e="number"),CU(t,e)},TU=EU,MU=_0,ZH=function(t){var e=TU(t,"string");return MU(e)?e:e+""},_U=wn,_P=Ti,$S=_U.document,PU=_P($S)&&_P($S.createElement),I0=function(t){return PU?$S.createElement(t):{}},xU=Ei,IU=Nn,OU=I0,QH=!xU&&!IU(function(){return Object.defineProperty(OU("div"),"a",{get:function(){return 7}}).a!==7}),AU=Ei,HU=vn,NU=WH,DU=pv,kU=Xf,$U=ZH,LU=Mi,FU=QH,PP=Object.getOwnPropertyDescriptor;E0.f=AU?PP:function(e,n){if(e=kU(e),n=$U(n),FU)try{return PP(e,n)}catch{}if(LU(e,n))return DU(!HU(NU.f,e,n),e[n])};var zs={},VU=Ei,WU=Nn,eN=VU&&WU(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),BU=Ti,jU=String,UU=TypeError,Cn=function(t){if(BU(t))return t;throw new UU(jU(t)+" is not an object")},zU=Ei,YU=QH,GU=eN,Hg=Cn,xP=ZH,KU=TypeError,Oy=Object.defineProperty,qU=Object.getOwnPropertyDescriptor,Ay="enumerable",Hy="configurable",Ny="writable";zs.f=zU?GU?function(e,n,r){if(Hg(e),n=xP(n),Hg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Ny in r&&!r[Ny]){var i=qU(e,n);i&&i[Ny]&&(e[n]=r.value,r={configurable:Hy in r?r[Hy]:i[Hy],enumerable:Ay in r?r[Ay]:i[Ay],writable:!1})}return Oy(e,n,r)}:Oy:function(e,n,r){if(Hg(e),n=xP(n),Hg(r),YU)try{return Oy(e,n,r)}catch{}if("get"in r||"set"in r)throw new KU("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var XU=Ei,JU=zs,ZU=pv,lh=XU?function(t,e,n){return JU.f(t,e,ZU(1,n))}:function(t,e,n){return t[e]=n,t},tN={exports:{}},LS=Ei,QU=Mi,nN=Function.prototype,ez=LS&&Object.getOwnPropertyDescriptor,tz=QU(nN,"name"),nz=tz&&(!LS||LS&&ez(nN,"name").configurable),rz={CONFIGURABLE:nz},iz=hn,oz=yn,FS=x0,sz=iz(Function.toString);oz(FS.inspectSource)||(FS.inspectSource=function(t){return sz(t)});var az=FS.inspectSource,lz=wn,uz=yn,IP=lz.WeakMap,cz=uz(IP)&&/native code/.test(String(IP)),hz=XH,dz=JH,OP=hz("keys"),O0=function(t){return OP[t]||(OP[t]=dz(t))},A0={},fz=cz,rN=wn,gz=Ti,mz=lh,Dy=Mi,ky=x0,pz=O0,wz=A0,AP="Object already initialized",VS=rN.TypeError,vz=rN.WeakMap,dw,vf,fw,yz=function(t){return fw(t)?vf(t):dw(t,{})},Cz=function(t){return function(e){var n;if(!gz(e)||(n=vf(e)).type!==t)throw new VS("Incompatible receiver, "+t+" required");return n}};if(fz||ky.state){var co=ky.state||(ky.state=new vz);co.get=co.get,co.has=co.has,co.set=co.set,dw=function(t,e){if(co.has(t))throw new VS(AP);return e.facade=t,co.set(t,e),e},vf=function(t){return co.get(t)||{}},fw=function(t){return co.has(t)}}else{var Ou=pz("state");wz[Ou]=!0,dw=function(t,e){if(Dy(t,Ou))throw new VS(AP);return e.facade=t,mz(t,Ou,e),e},vf=function(t){return Dy(t,Ou)?t[Ou]:{}},fw=function(t){return Dy(t,Ou)}}var iN={set:dw,get:vf,has:fw,enforce:yz,getterFor:Cz},H0=hn,bz=Nn,Sz=yn,Ng=Mi,WS=Ei,Rz=rz.CONFIGURABLE,Ez=az,oN=iN,Tz=oN.enforce,Mz=oN.get,HP=String,Rp=Object.defineProperty,_z=H0("".slice),Pz=H0("".replace),xz=H0([].join),Iz=WS&&!bz(function(){return Rp(function(){},"length",{value:8}).length!==8}),Oz=String(String).split("String"),Az=tN.exports=function(t,e,n){_z(HP(e),0,7)==="Symbol("&&(e="["+Pz(HP(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Ng(t,"name")||Rz&&t.name!==e)&&(WS?Rp(t,"name",{value:e,configurable:!0}):t.name=e),Iz&&n&&Ng(n,"arity")&&t.length!==n.arity&&Rp(t,"length",{value:n.arity});try{n&&Ng(n,"constructor")&&n.constructor?WS&&Rp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=Tz(t);return Ng(r,"source")||(r.source=xz(Oz,typeof e=="string"?e:"")),t};Function.prototype.toString=Az(function(){return Sz(this)&&Mz(this).source||Ez(this)},"toString");var sN=tN.exports,Hz=yn,Nz=zs,Dz=sN,kz=P0,N0=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Hz(n)&&Dz(n,o,r),r.global)i?t[e]=n:kz(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:Nz.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},aN={},$z=Math.ceil,Lz=Math.floor,Fz=Math.trunc||function(e){var n=+e;return(n>0?Lz:$z)(n)},Vz=Fz,Qf=function(t){var e=+t;return e!==e||e===0?0:Vz(e)},Wz=Qf,Bz=Math.max,jz=Math.min,Uz=function(t,e){var n=Wz(t);return n<0?Bz(n+e,0):jz(n,e)},zz=Qf,Yz=Math.min,Gz=function(t){var e=zz(t);return e>0?Yz(e,9007199254740991):0},Kz=Gz,uh=function(t){return Kz(t.length)},qz=Xf,Xz=Uz,Jz=uh,Zz=function(t){return function(e,n,r){var i=qz(e),o=Jz(i);if(o===0)return!t&&-1;var s=Xz(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Qz={indexOf:Zz(!1)},eY=hn,$y=Mi,tY=Xf,nY=Qz.indexOf,rY=A0,NP=eY([].push),lN=function(t,e){var n=tY(t),r=0,i=[],o;for(o in n)!$y(rY,o)&&$y(n,o)&&NP(i,o);for(;e.length>r;)$y(n,o=e[r++])&&(~nY(i,o)||NP(i,o));return i},D0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],iY=lN,oY=D0,sY=oY.concat("length","prototype");aN.f=Object.getOwnPropertyNames||function(e){return iY(e,sY)};var uN={};uN.f=Object.getOwnPropertySymbols;var aY=sh,lY=hn,uY=aN,cY=uN,hY=Cn,dY=lY([].concat),fY=aY("Reflect","ownKeys")||function(e){var n=uY.f(hY(e)),r=cY.f;return r?dY(n,r(e)):n},DP=Mi,gY=fY,mY=E0,pY=zs,cN=function(t,e,n){for(var r=gY(e),i=pY.f,o=mY.f,s=0;s<r.length;s++){var a=r[s];!DP(t,a)&&!(n&&DP(n,a))&&i(t,a,o(e,a))}},wY=Nn,vY=yn,yY=/#|\.prototype\./,eg=function(t,e){var n=bY[CY(t)];return n===RY?!0:n===SY?!1:vY(e)?wY(e):!!e},CY=eg.normalize=function(t){return String(t).replace(yY,".").toLowerCase()},bY=eg.data={},SY=eg.NATIVE="N",RY=eg.POLYFILL="P",EY=eg,Dg=wn,TY=E0.f,MY=lh,_Y=N0,PY=P0,xY=cN,IY=EY,yt=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Dg:i?s=Dg[n]||PY(n,{}):s=Dg[n]&&Dg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=TY(s,a),l=c&&c.value):l=s[a],o=IY(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;xY(u,l)}(t.sham||l&&l.sham)&&MY(u,"sham",!0),_Y(s,a,u,t)}},OY=mv,hN=Function.prototype,kP=hN.apply,$P=hN.call,tg=typeof Reflect=="object"&&Reflect.apply||(OY?$P.bind(kP):function(){return $P.apply(kP,arguments)}),AY=hn,HY=Dr,dN=function(t,e,n){try{return AY(HY(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},NY=Ti,DY=function(t){return NY(t)||t===null},kY=DY,$Y=String,LY=TypeError,FY=function(t){if(kY(t))return t;throw new LY("Can't set "+$Y(t)+" as a prototype")},VY=dN,WY=Ti,BY=qf,jY=FY,fN=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=VY(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return BY(i),jY(o),WY(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),UY=zs.f,zY=function(t,e,n){n in t||UY(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},YY=yn,GY=Ti,LP=fN,KY=function(t,e,n){var r,i;return LP&&YY(r=e.constructor)&&r!==n&&GY(i=r.prototype)&&i!==n.prototype&&LP(t,i),t},qY=oo,XY=qY("toStringTag"),gN={};gN[XY]="z";var JY=String(gN)==="[object z]",ZY=JY,QY=yn,Ep=wu,eG=oo,tG=eG("toStringTag"),nG=Object,rG=Ep(function(){return arguments}())==="Arguments",iG=function(t,e){try{return t[e]}catch{}},mN=ZY?Ep:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=iG(e=nG(t),tG))=="string"?n:rG?Ep(e):(r=Ep(e))==="Object"&&QY(e.callee)?"Arguments":r},oG=mN,sG=String,yv=function(t){if(oG(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return sG(t)},aG=yv,lG=function(t,e){return t===void 0?arguments.length<2?"":e:aG(t)},uG=Ti,cG=lh,hG=function(t,e){uG(e)&&"cause"in e&&cG(t,"cause",e.cause)},dG=hn,pN=Error,fG=dG("".replace),gG=function(t){return String(new pN(t).stack)}("zxcasd"),wN=/\n\s*at [^:]*:[^\n]*/,mG=wN.test(gG),pG=function(t,e){if(mG&&typeof t=="string"&&!pN.prepareStackTrace)for(;e--;)t=fG(t,wN,"");return t},wG=Nn,vG=pv,yG=!wG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",vG(1,7)),t.stack!==7):!0}),CG=lh,bG=pG,SG=yG,FP=Error.captureStackTrace,RG=function(t,e,n,r){SG&&(FP?FP(t,e):CG(t,"stack",bG(n,r)))},VP=sh,EG=Mi,WP=lh,TG=Jf,BP=fN,jP=cN,UP=zY,MG=KY,_G=lG,PG=hG,xG=RG,IG=Ei,OG=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=VP.apply(null,s);if(l){var u=l.prototype;if(EG(u,"cause")&&delete u.cause,!n)return l;var c=VP("Error"),h=e(function(d,f){var g=_G(r?f:d,void 0),v=r?new l(d):new l;return g!==void 0&&WP(v,"message",g),xG(v,h,v.stack,2),this&&TG(u,this)&&MG(v,this,h),arguments.length>o&&PG(v,arguments[o]),v});h.prototype=u,a!=="Error"?BP?BP(h,c):jP(h,c,{name:!0}):IG&&i in l&&(UP(h,l,i),UP(h,l,"prepareStackTrace")),jP(h,l);try{u.name!==a&&WP(u,"name",a),u.constructor=h}catch{}return h}},vN=yt,AG=wn,qo=tg,yN=OG,BS="WebAssembly",zP=AG[BS],gw=new Error("e",{cause:7}).cause!==7,vu=function(t,e){var n={};n[t]=yN(t,e,gw),vN({global:!0,constructor:!0,arity:1,forced:gw},n)},k0=function(t,e){if(zP&&zP[t]){var n={};n[t]=yN(BS+"."+t,e,gw),vN({target:BS,stat:!0,constructor:!0,arity:1,forced:gw},n)}};vu("Error",function(t){return function(n){return qo(t,this,arguments)}});vu("EvalError",function(t){return function(n){return qo(t,this,arguments)}});vu("RangeError",function(t){return function(n){return qo(t,this,arguments)}});vu("ReferenceError",function(t){return function(n){return qo(t,this,arguments)}});vu("SyntaxError",function(t){return function(n){return qo(t,this,arguments)}});vu("TypeError",function(t){return function(n){return qo(t,this,arguments)}});vu("URIError",function(t){return function(n){return qo(t,this,arguments)}});k0("CompileError",function(t){return function(n){return qo(t,this,arguments)}});k0("LinkError",function(t){return function(n){return qo(t,this,arguments)}});k0("RuntimeError",function(t){return function(n){return qo(t,this,arguments)}});var HG=wu,CN=Array.isArray||function(e){return HG(e)==="Array"},NG=Ei,DG=CN,kG=TypeError,$G=Object.getOwnPropertyDescriptor,LG=NG&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),bN=LG?function(t,e){if(DG(t)&&!$G(t,"length").writable)throw new kG("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},FG=TypeError,VG=9007199254740991,SN=function(t){if(t>VG)throw FG("Maximum allowed index exceeded");return t},WG=yt,BG=ah,jG=uh,UG=bN,zG=SN,YG=Nn,GG=YG(function(){return[].push.call({length:4294967296},1)!==4294967297}),KG=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},qG=GG||!KG();WG({target:"Array",proto:!0,arity:1,forced:qG},{push:function(e){var n=BG(this),r=jG(n),i=arguments.length;zG(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return UG(n,r),r}});var XG=wu,JG=hn,ZG=function(t){if(XG(t)==="Function")return JG(t)},YP=ZG,QG=Dr,eK=mv,tK=YP(YP.bind),RN=function(t,e){return QG(t),e===void 0?t:eK?tK(t,e):function(){return t.apply(e,arguments)}},EN={},nK=oo,rK=EN,iK=nK("iterator"),oK=Array.prototype,sK=function(t){return t!==void 0&&(rK.Array===t||oK[iK]===t)},aK=mN,GP=Zf,lK=T0,uK=EN,cK=oo,hK=cK("iterator"),$0=function(t){if(!lK(t))return GP(t,hK)||GP(t,"@@iterator")||uK[aK(t)]},dK=vn,fK=Dr,gK=Cn,mK=vv,pK=$0,wK=TypeError,vK=function(t,e){var n=arguments.length<2?pK(t):e;if(fK(n))return gK(dK(n,t));throw new wK(mK(t)+" is not iterable")},yK=vn,KP=Cn,CK=Zf,ti=function(t,e,n){var r,i;KP(t);try{if(r=CK(t,"return"),!r){if(e==="throw")throw n;return n}r=yK(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return KP(r),n},bK=RN,SK=vn,RK=Cn,EK=vv,TK=sK,MK=uh,qP=Jf,_K=vK,PK=$0,XP=ti,xK=TypeError,Tp=function(t,e){this.stopped=t,this.result=e},JP=Tp.prototype,ch=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=bK(e,r),u,c,h,d,f,g,v,y=function(C){return u&&XP(u,"normal",C),new Tp(!0,C)},E=function(C){return i?(RK(C),a?l(C[0],C[1],y):l(C[0],C[1])):a?l(C,y):l(C)};if(o)u=t.iterator;else if(s)u=t;else{if(c=PK(t),!c)throw new xK(EK(t)+" is not iterable");if(TK(c)){for(h=0,d=MK(t);d>h;h++)if(f=E(t[h]),f&&qP(JP,f))return f;return new Tp(!1)}u=_K(t,c)}for(g=o?t.next:u.next;!(v=SK(g,u)).done;){try{f=E(v.value)}catch(C){XP(u,"throw",C)}if(typeof f=="object"&&f&&qP(JP,f))return f}return new Tp(!1)},IK=Ei,OK=zs,AK=pv,TN=function(t,e,n){IK?OK.f(t,e,AK(0,n)):t[e]=n},HK=yt,NK=ch,DK=TN;HK({target:"Object",stat:!0},{fromEntries:function(e){var n={};return NK(e,function(r,i){DK(n,r,i)},{AS_ENTRIES:!0}),n}});var Ly=hn,kg=Set.prototype,Xo={Set,add:Ly(kg.add),has:Ly(kg.has),remove:Ly(kg.delete),proto:kg},kK=Xo.has,yu=function(t){return kK(t),t},$K=vn,Cu=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=$K(i,r)).done;)if(s=e(o.value),s!==void 0)return s},MN=hn,LK=Cu,_N=Xo,FK=_N.Set,PN=_N.proto,VK=MN(PN.forEach),xN=MN(PN.keys),WK=xN(new FK).next,ng=function(t,e,n){return n?LK({iterator:xN(t),next:WK},e):VK(t,e)},IN=Xo,BK=ng,jK=IN.Set,UK=IN.add,L0=function(t){var e=new jK;return BK(t,function(n){UK(e,n)}),e},zK=dN,YK=Xo,rg=zK(YK.proto,"size","get")||function(t){return t.size},Jo=function(t){return{iterator:t,next:t.next,done:!1}},ZP=Dr,ON=Cn,QP=vn,GK=Qf,KK=Jo,ex="Invalid size",qK=RangeError,XK=TypeError,JK=Math.max,AN=function(t,e){this.set=t,this.size=JK(e,0),this.has=ZP(t.has),this.keys=ZP(t.keys)};AN.prototype={getIterator:function(){return KK(ON(QP(this.keys,this.set)))},includes:function(t){return QP(this.has,this.set,t)}};var bu=function(t){ON(t);var e=+t.size;if(e!==e)throw new XK(ex);var n=GK(e);if(n<0)throw new qK(ex);return new AN(t,n)},ZK=yu,HN=Xo,QK=L0,e3=rg,t3=bu,n3=ng,r3=Cu,i3=HN.has,tx=HN.remove,o3=function(e){var n=ZK(this),r=t3(e),i=QK(n);return e3(n)<=r.size?n3(n,function(o){r.includes(o)&&tx(i,o)}):r3(r.getIterator(),function(o){i3(n,o)&&tx(i,o)}),i},s3=sh,nx=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},rx=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},Su=function(t,e){var n=s3("Set");try{new n()[t](nx(0));try{return new n()[t](nx(-1)),!1}catch{if(!e)return!0;try{return new n()[t](rx(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](rx(1/0)))}}}catch{return!1}},a3=yt,l3=o3,u3=Su,c3=!u3("difference",function(t){return t.size===0});a3({target:"Set",proto:!0,real:!0,forced:c3},{difference:l3});var h3=yu,F0=Xo,d3=rg,f3=bu,g3=ng,m3=Cu,p3=F0.Set,ix=F0.add,w3=F0.has,v3=function(e){var n=h3(this),r=f3(e),i=new p3;return d3(n)>r.size?m3(r.getIterator(),function(o){w3(n,o)&&ix(i,o)}):g3(n,function(o){r.includes(o)&&ix(i,o)}),i},y3=yt,C3=Nn,b3=v3,S3=Su,R3=!S3("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||C3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});y3({target:"Set",proto:!0,real:!0,forced:R3},{intersection:b3});var E3=yu,T3=Xo.has,M3=rg,_3=bu,P3=ng,x3=Cu,I3=ti,O3=function(e){var n=E3(this),r=_3(e);if(M3(n)<=r.size)return P3(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return x3(i,function(o){if(T3(n,o))return I3(i,"normal",!1)})!==!1},A3=yt,H3=O3,N3=Su,D3=!N3("isDisjointFrom",function(t){return!t});A3({target:"Set",proto:!0,real:!0,forced:D3},{isDisjointFrom:H3});var k3=yu,$3=rg,L3=ng,F3=bu,V3=function(e){var n=k3(this),r=F3(e);return $3(n)>r.size?!1:L3(n,function(i){if(!r.includes(i))return!1},!0)!==!1},W3=yt,B3=V3,j3=Su,U3=!j3("isSubsetOf",function(t){return t});W3({target:"Set",proto:!0,real:!0,forced:U3},{isSubsetOf:B3});var z3=yu,Y3=Xo.has,G3=rg,K3=bu,q3=Cu,X3=ti,J3=function(e){var n=z3(this),r=K3(e);if(G3(n)<r.size)return!1;var i=r.getIterator();return q3(i,function(o){if(!Y3(n,o))return X3(i,"normal",!1)})!==!1},Z3=yt,Q3=J3,e5=Su,t5=!e5("isSupersetOf",function(t){return!t});Z3({target:"Set",proto:!0,real:!0,forced:t5},{isSupersetOf:Q3});var n5=yu,V0=Xo,r5=L0,i5=bu,o5=Cu,s5=V0.add,a5=V0.has,l5=V0.remove,u5=function(e){var n=n5(this),r=i5(e).getIterator(),i=r5(n);return o5(r,function(o){a5(n,o)?l5(i,o):s5(i,o)}),i},c5=yt,h5=u5,d5=Su;c5({target:"Set",proto:!0,real:!0,forced:!d5("symmetricDifference")},{symmetricDifference:h5});var f5=yu,g5=Xo.add,m5=L0,p5=bu,w5=Cu,v5=function(e){var n=f5(this),r=p5(e).getIterator(),i=m5(n);return w5(r,function(o){g5(i,o)}),i},y5=yt,C5=v5,b5=Su;y5({target:"Set",proto:!0,real:!0,forced:!b5("union")},{union:C5});var S5=Jf,R5=TypeError,E5=function(t,e){if(S5(e,t))return t;throw new R5("Incorrect invocation")},T5=Nn,M5=!T5(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),_5=Mi,P5=yn,x5=ah,I5=O0,O5=M5,ox=I5("IE_PROTO"),jS=Object,A5=jS.prototype,NN=O5?jS.getPrototypeOf:function(t){var e=x5(t);if(_5(e,ox))return e[ox];var n=e.constructor;return P5(n)&&e instanceof n?n.prototype:e instanceof jS?A5:null},sx=sN,H5=zs,N5=function(t,e,n){return n.get&&sx(n.get,e,{getter:!0}),n.set&&sx(n.set,e,{setter:!0}),H5.f(t,e,n)},DN={},D5=lN,k5=D0,$5=Object.keys||function(e){return D5(e,k5)},L5=Ei,F5=eN,V5=zs,W5=Cn,B5=Xf,j5=$5;DN.f=L5&&!F5?Object.defineProperties:function(e,n){W5(e);for(var r=B5(n),i=j5(n),o=i.length,s=0,a;o>s;)V5.f(e,a=i[s++],r[a]);return e};var U5=sh,kN=U5("document","documentElement"),z5=Cn,Y5=DN,ax=D0,G5=A0,K5=kN,q5=I0,X5=O0,lx=">",ux="<",US="prototype",zS="script",$N=X5("IE_PROTO"),Fy=function(){},LN=function(t){return ux+zS+lx+t+ux+"/"+zS+lx},cx=function(t){t.write(LN("")),t.close();var e=t.parentWindow.Object;return t=null,e},J5=function(){var t=q5("iframe"),e="java"+zS+":",n;return t.style.display="none",K5.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(LN("document.F=Object")),n.close(),n.F},$g,Mp=function(){try{$g=new ActiveXObject("htmlfile")}catch{}Mp=typeof document<"u"?document.domain&&$g?cx($g):J5():cx($g);for(var t=ax.length;t--;)delete Mp[US][ax[t]];return Mp()};G5[$N]=!0;var FN=Object.create||function(e,n){var r;return e!==null?(Fy[US]=z5(e),r=new Fy,Fy[US]=null,r[$N]=e):r=Mp(),n===void 0?r:Y5.f(r,n)},Z5=Nn,Q5=yn,eq=Ti,hx=NN,tq=N0,nq=oo,YS=nq("iterator"),su,Vy,Wy;[].keys&&(Wy=[].keys(),"next"in Wy&&(Vy=hx(hx(Wy)),Vy!==Object.prototype&&(su=Vy)));var rq=!eq(su)||Z5(function(){var t={};return su[YS].call(t)!==t});rq&&(su={});Q5(su[YS])||tq(su,YS,function(){return this});var VN={IteratorPrototype:su},iq=yt,oq=wn,sq=E5,aq=Cn,lq=yn,uq=NN,cq=N5,hq=TN,dq=Nn,W0=Mi,fq=oo,jo=VN.IteratorPrototype,gq=Ei,By="constructor",WN="Iterator",dx=fq("toStringTag"),BN=TypeError,jy=oq[WN],jN=!lq(jy)||jy.prototype!==jo||!dq(function(){jy({})}),B0=function(){if(sq(this,jo),uq(this)===jo)throw new BN("Abstract class Iterator not directly constructable")},UN=function(t,e){gq?cq(jo,t,{configurable:!0,get:function(){return e},set:function(n){if(aq(this),this===jo)throw new BN("You can't redefine this property");W0(this,t)?this[t]=n:hq(this,t,n)}}):jo[t]=e};W0(jo,dx)||UN(dx,WN);(jN||!W0(jo,By)||jo[By]===Object)&&UN(By,B0);B0.prototype=jo;iq({global:!0,constructor:!0,forced:jN},{Iterator:B0});var mq=N0,pq=function(t,e,n){for(var r in e)mq(t,r,e[r],n);return t},wq=function(t,e){return{value:t,done:e}},vq=vn,yq=FN,Cq=lh,bq=pq,Sq=oo,zN=iN,Rq=Zf,Eq=VN.IteratorPrototype,Lg=wq,Uy=ti,Tq=Sq("toStringTag"),YN="IteratorHelper",GN="WrapForValidIterator",Mq=zN.set,KN=function(t){var e=zN.getterFor(t?GN:YN);return bq(yq(Eq),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return Lg(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:Lg(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=Rq(r,"return");return i?vq(i,r):Lg(void 0,!0)}if(n.inner)try{Uy(n.inner.iterator,"normal")}catch(o){return Uy(r,"throw",o)}return r&&Uy(r,"normal"),Lg(void 0,!0)}})},_q=KN(!0),qN=KN(!1);Cq(qN,Tq,"Iterator Helper");var j0=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?GN:YN,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,Mq(this,s)};return r.prototype=e?_q:qN,r},Pq=Cn,xq=ti,XN=function(t,e,n,r){try{return r?e(Pq(n)[0],n[1]):e(n)}catch(i){xq(t,"throw",i)}},Iq=wn,Ga=function(t,e){var n=Iq.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},Oq=yt,JN=vn,Aq=Dr,ZN=Cn,Hq=Jo,Nq=j0,Dq=XN,kq=ti,$q=Ga,zy=$q("filter",TypeError),Lq=Nq(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=ZN(JN(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,Dq(t,e,[o,this.counter++],!0))return o}});Oq({target:"Iterator",proto:!0,real:!0,forced:zy},{filter:function(e){ZN(this);try{Aq(e)}catch(n){kq(this,"throw",n)}return zy?JN(zy,this,e):new Lq(Hq(this),{predicate:e})}});var Fq=yt,Vq=vn,Wq=ch,Bq=Dr,jq=Cn,Uq=Jo,zq=ti,Yq=Ga,Yy=Yq("forEach",TypeError);Fq({target:"Iterator",proto:!0,real:!0,forced:Yy},{forEach:function(e){jq(this);try{Bq(e)}catch(i){zq(this,"throw",i)}if(Yy)return Vq(Yy,this,e);var n=Uq(this),r=0;Wq(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var Gq=yt,QN=vn,Kq=Dr,eD=Cn,qq=Jo,Xq=j0,Jq=XN,Zq=ti,Qq=Ga,Gy=Qq("map",TypeError),e4=Xq(function(){var t=this.iterator,e=eD(QN(this.next,t)),n=this.done=!!e.done;if(!n)return Jq(t,this.mapper,[e.value,this.counter++],!0)});Gq({target:"Iterator",proto:!0,real:!0,forced:Gy},{map:function(e){eD(this);try{Kq(e)}catch(n){Zq(this,"throw",n)}return Gy?QN(Gy,this,e):new e4(qq(this),{mapper:e})}});var t4=hn,U0=t4([].slice),n4=TypeError,tD=function(t,e){if(t<e)throw new n4("Not enough arguments");return t},r4=wv,i4=/(?:ipad|iphone|ipod).*applewebkit/i.test(r4),_h=wn,o4=wv,s4=wu,Fg=function(t){return o4.slice(0,t.length)===t},nD=function(){return Fg("Bun/")?"BUN":Fg("Cloudflare-Workers")?"CLOUDFLARE":Fg("Deno/")?"DENO":Fg("Node.js/")?"NODE":_h.Bun&&typeof Bun.version=="string"?"BUN":_h.Deno&&typeof Deno.version=="object"?"DENO":s4(_h.process)==="process"?"NODE":_h.window&&_h.document?"BROWSER":"REST"}(),a4=nD,l4=a4==="NODE",Jr=wn,u4=tg,c4=RN,fx=yn,h4=Mi,rD=Nn,gx=kN,d4=U0,mx=I0,f4=tD,g4=i4,m4=l4,GS=Jr.setImmediate,KS=Jr.clearImmediate,p4=Jr.process,Ky=Jr.Dispatch,w4=Jr.Function,px=Jr.MessageChannel,v4=Jr.String,qy=0,Vd={},wx="onreadystatechange",yf,Qa,Xy,Jy;rD(function(){yf=Jr.location});var z0=function(t){if(h4(Vd,t)){var e=Vd[t];delete Vd[t],e()}},Zy=function(t){return function(){z0(t)}},vx=function(t){z0(t.data)},yx=function(t){Jr.postMessage(v4(t),yf.protocol+"//"+yf.host)};(!GS||!KS)&&(GS=function(e){f4(arguments.length,1);var n=fx(e)?e:w4(e),r=d4(arguments,1);return Vd[++qy]=function(){u4(n,void 0,r)},Qa(qy),qy},KS=function(e){delete Vd[e]},m4?Qa=function(t){p4.nextTick(Zy(t))}:Ky&&Ky.now?Qa=function(t){Ky.now(Zy(t))}:px&&!g4?(Xy=new px,Jy=Xy.port2,Xy.port1.onmessage=vx,Qa=c4(Jy.postMessage,Jy)):Jr.addEventListener&&fx(Jr.postMessage)&&!Jr.importScripts&&yf&&yf.protocol!=="file:"&&!rD(yx)?(Qa=yx,Jr.addEventListener("message",vx,!1)):wx in mx("script")?Qa=function(t){gx.appendChild(mx("script"))[wx]=function(){gx.removeChild(this),z0(t)}}:Qa=function(t){setTimeout(Zy(t),0)});var iD={set:GS,clear:KS},y4=yt,C4=wn,Cx=iD.clear;y4({global:!0,bind:!0,enumerable:!0,forced:C4.clearImmediate!==Cx},{clearImmediate:Cx});var oD=wn,b4=tg,S4=yn,R4=nD,E4=wv,T4=U0,M4=tD,_4=oD.Function,P4=/MSIE .\./.test(E4)||R4==="BUN"&&function(){var t=oD.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),x4=function(t,e){var n=e?2:1;return P4?function(r,i){var o=M4(arguments.length,1)>n,s=S4(r)?r:_4(r),a=o?T4(arguments,n):[],l=o?function(){b4(s,this,a)}:s;return e?t(l,i):t(l)}:t},I4=yt,sD=wn,bx=iD.set,O4=x4,Sx=sD.setImmediate?O4(bx,!1):bx;I4({global:!0,bind:!0,enumerable:!0,forced:sD.setImmediate!==Sx},{setImmediate:Sx});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:aD,setPrototypeOf:Rx,isFrozen:A4,getPrototypeOf:H4,getOwnPropertyDescriptor:N4}=Object;let{freeze:hr,seal:Si,create:lD}=Object,{apply:qS,construct:XS}=typeof Reflect<"u"&&Reflect;hr||(hr=function(e){return e});Si||(Si=function(e){return e});qS||(qS=function(e,n,r){return e.apply(n,r)});XS||(XS=function(e,n){return new e(...n)});const Vg=dr(Array.prototype.forEach),D4=dr(Array.prototype.lastIndexOf),Ex=dr(Array.prototype.pop),Ph=dr(Array.prototype.push),k4=dr(Array.prototype.splice),_p=dr(String.prototype.toLowerCase),Qy=dr(String.prototype.toString),Tx=dr(String.prototype.match),xh=dr(String.prototype.replace),$4=dr(String.prototype.indexOf),L4=dr(String.prototype.trim),Wi=dr(Object.prototype.hasOwnProperty),tr=dr(RegExp.prototype.test),Ih=F4(TypeError);function dr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return qS(t,e,r)}}function F4(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return XS(t,n)}}function Be(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_p;Rx&&Rx(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(A4(e)||(e[r]=o),i=o)}t[i]=!0}return t}function V4(t){for(let e=0;e<t.length;e++)Wi(t,e)||(t[e]=null);return t}function Fl(t){const e=lD(null);for(const[n,r]of aD(t))Wi(t,n)&&(Array.isArray(r)?e[n]=V4(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Fl(r):e[n]=r);return e}function Oh(t,e){for(;t!==null;){const r=N4(t,e);if(r){if(r.get)return dr(r.get);if(typeof r.value=="function")return dr(r.value)}t=H4(t)}function n(){return null}return n}const Mx=hr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),eC=hr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),tC=hr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),W4=hr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),nC=hr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),B4=hr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_x=hr(["#text"]),Px=hr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),rC=hr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),xx=hr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Wg=hr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),j4=Si(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U4=Si(/<%[\w\W]*|[\w\W]*%>/gm),z4=Si(/\$\{[\w\W]*/gm),Y4=Si(/^data-[\-\w.\u00B7-\uFFFF]+$/),G4=Si(/^aria-[\-\w]+$/),uD=Si(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),K4=Si(/^(?:\w+script|data):/i),q4=Si(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),cD=Si(/^html$/i),X4=Si(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ix=Object.freeze({__proto__:null,ARIA_ATTR:G4,ATTR_WHITESPACE:q4,CUSTOM_ELEMENT:X4,DATA_ATTR:Y4,DOCTYPE_NAME:cD,ERB_EXPR:U4,IS_ALLOWED_URI:uD,IS_SCRIPT_OR_DATA:K4,MUSTACHE_EXPR:j4,TMPLIT_EXPR:z4});const Ah={element:1,text:3,progressingInstruction:7,comment:8,document:9},J4=function(){return typeof window>"u"?null:window},Z4=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Ox=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function hD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J4();const e=ye=>hD(ye);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==Ah.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,v=Oh(g,"cloneNode"),y=Oh(g,"remove"),E=Oh(g,"nextSibling"),C=Oh(g,"childNodes"),P=Oh(g,"parentNode");if(typeof s=="function"){const ye=n.createElement("template");ye.content&&ye.content.ownerDocument&&(n=ye.content.ownerDocument)}let A,_="";const{implementation:T,createNodeIterator:H,createDocumentFragment:G,getElementsByTagName:U}=n,{importNode:V}=r;let X=Ox();e.isSupported=typeof aD=="function"&&typeof P=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:Q,TMPLIT_EXPR:te,DATA_ATTR:pe,ARIA_ATTR:et,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Ae,CUSTOM_ELEMENT:ot}=Ix;let{IS_ALLOWED_URI:_n}=Ix,st=null;const m=Be({},[...Mx,...eC,...tC,...nC,..._x]);let w=null;const p=Be({},[...Px,...rC,...xx,...Wg]);let I=Object.seal(lD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,j=null,K=!0,J=!0,b=!1,R=!0,S=!1,$=!0,x=!1,N=!1,B=!1,O=!1,D=!1,W=!1,F=!0,Y=!1;const ae="user-content-";let ce=!0,_e=!1,Fe={},ze=null;const Me=Be({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ve=null;const Tt=Be({},["audio","video","img","source","image","track"]);let Oi=null;const ns=Be({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ri="http://www.w3.org/1998/Math/MathML",Mt="http://www.w3.org/2000/svg",fn="http://www.w3.org/1999/xhtml";let Ct=fn,_t=!1,We=null;const ii=Be({},[ri,Mt,fn],Qy);let Xa=Be({},["mi","mo","mn","ms","mtext"]),Ja=Be({},["annotation-xml"]);const _V=Be({},["title","style","font","a","script"]);let Sh=null;const PV=["application/xhtml+xml","text/html"],xV="text/html";let Pn=null,Iu=null;const IV=n.createElement("form"),F_=function(k){return k instanceof RegExp||k instanceof Function},vy=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Iu&&Iu===k)){if((!k||typeof k!="object")&&(k={}),k=Fl(k),Sh=PV.indexOf(k.PARSER_MEDIA_TYPE)===-1?xV:k.PARSER_MEDIA_TYPE,Pn=Sh==="application/xhtml+xml"?Qy:_p,st=Wi(k,"ALLOWED_TAGS")?Be({},k.ALLOWED_TAGS,Pn):m,w=Wi(k,"ALLOWED_ATTR")?Be({},k.ALLOWED_ATTR,Pn):p,We=Wi(k,"ALLOWED_NAMESPACES")?Be({},k.ALLOWED_NAMESPACES,Qy):ii,Oi=Wi(k,"ADD_URI_SAFE_ATTR")?Be(Fl(ns),k.ADD_URI_SAFE_ATTR,Pn):ns,Ve=Wi(k,"ADD_DATA_URI_TAGS")?Be(Fl(Tt),k.ADD_DATA_URI_TAGS,Pn):Tt,ze=Wi(k,"FORBID_CONTENTS")?Be({},k.FORBID_CONTENTS,Pn):Me,L=Wi(k,"FORBID_TAGS")?Be({},k.FORBID_TAGS,Pn):{},j=Wi(k,"FORBID_ATTR")?Be({},k.FORBID_ATTR,Pn):{},Fe=Wi(k,"USE_PROFILES")?k.USE_PROFILES:!1,K=k.ALLOW_ARIA_ATTR!==!1,J=k.ALLOW_DATA_ATTR!==!1,b=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=k.SAFE_FOR_TEMPLATES||!1,$=k.SAFE_FOR_XML!==!1,x=k.WHOLE_DOCUMENT||!1,O=k.RETURN_DOM||!1,D=k.RETURN_DOM_FRAGMENT||!1,W=k.RETURN_TRUSTED_TYPE||!1,B=k.FORCE_BODY||!1,F=k.SANITIZE_DOM!==!1,Y=k.SANITIZE_NAMED_PROPS||!1,ce=k.KEEP_CONTENT!==!1,_e=k.IN_PLACE||!1,_n=k.ALLOWED_URI_REGEXP||uD,Ct=k.NAMESPACE||fn,Xa=k.MATHML_TEXT_INTEGRATION_POINTS||Xa,Ja=k.HTML_INTEGRATION_POINTS||Ja,I=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&F_(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(I.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&F_(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(I.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(I.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(J=!1),D&&(O=!0),Fe&&(st=Be({},_x),w=[],Fe.html===!0&&(Be(st,Mx),Be(w,Px)),Fe.svg===!0&&(Be(st,eC),Be(w,rC),Be(w,Wg)),Fe.svgFilters===!0&&(Be(st,tC),Be(w,rC),Be(w,Wg)),Fe.mathMl===!0&&(Be(st,nC),Be(w,xx),Be(w,Wg))),k.ADD_TAGS&&(st===m&&(st=Fl(st)),Be(st,k.ADD_TAGS,Pn)),k.ADD_ATTR&&(w===p&&(w=Fl(w)),Be(w,k.ADD_ATTR,Pn)),k.ADD_URI_SAFE_ATTR&&Be(Oi,k.ADD_URI_SAFE_ATTR,Pn),k.FORBID_CONTENTS&&(ze===Me&&(ze=Fl(ze)),Be(ze,k.FORBID_CONTENTS,Pn)),ce&&(st["#text"]=!0),x&&Be(st,["html","head","body"]),st.table&&(Be(st,["tbody"]),delete L.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ih('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ih('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=k.TRUSTED_TYPES_POLICY,_=A.createHTML("")}else A===void 0&&(A=Z4(f,i)),A!==null&&typeof _=="string"&&(_=A.createHTML(""));hr&&hr(k),Iu=k}},V_=Be({},[...eC,...tC,...W4]),W_=Be({},[...nC,...B4]),OV=function(k){let re=P(k);(!re||!re.tagName)&&(re={namespaceURI:Ct,tagName:"template"});const me=_p(k.tagName),kt=_p(re.tagName);return We[k.namespaceURI]?k.namespaceURI===Mt?re.namespaceURI===fn?me==="svg":re.namespaceURI===ri?me==="svg"&&(kt==="annotation-xml"||Xa[kt]):!!V_[me]:k.namespaceURI===ri?re.namespaceURI===fn?me==="math":re.namespaceURI===Mt?me==="math"&&Ja[kt]:!!W_[me]:k.namespaceURI===fn?re.namespaceURI===Mt&&!Ja[kt]||re.namespaceURI===ri&&!Xa[kt]?!1:!W_[me]&&(_V[me]||!V_[me]):!!(Sh==="application/xhtml+xml"&&We[k.namespaceURI]):!1},lo=function(k){Ph(e.removed,{element:k});try{P(k).removeChild(k)}catch{y(k)}},Pg=function(k,re){try{Ph(e.removed,{attribute:re.getAttributeNode(k),from:re})}catch{Ph(e.removed,{attribute:null,from:re})}if(re.removeAttribute(k),k==="is")if(O||D)try{lo(re)}catch{}else try{re.setAttribute(k,"")}catch{}},B_=function(k){let re=null,me=null;if(B)k="<remove></remove>"+k;else{const Dn=Tx(k,/^[\r\n\t ]+/);me=Dn&&Dn[0]}Sh==="application/xhtml+xml"&&Ct===fn&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const kt=A?A.createHTML(k):k;if(Ct===fn)try{re=new d().parseFromString(kt,Sh)}catch{}if(!re||!re.documentElement){re=T.createDocument(Ct,"template",null);try{re.documentElement.innerHTML=_t?_:kt}catch{}}const Vn=re.body||re.documentElement;return k&&me&&Vn.insertBefore(n.createTextNode(me),Vn.childNodes[0]||null),Ct===fn?U.call(re,x?"html":"body")[0]:x?re.documentElement:Vn},j_=function(k){return H.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},yy=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},U_=function(k){return typeof a=="function"&&k instanceof a};function rs(ye,k,re){Vg(ye,me=>{me.call(e,k,re,Iu)})}const z_=function(k){let re=null;if(rs(X.beforeSanitizeElements,k,null),yy(k))return lo(k),!0;const me=Pn(k.nodeName);if(rs(X.uponSanitizeElement,k,{tagName:me,allowedTags:st}),k.hasChildNodes()&&!U_(k.firstElementChild)&&tr(/<[/\w!]/g,k.innerHTML)&&tr(/<[/\w!]/g,k.textContent)||k.nodeType===Ah.progressingInstruction||$&&k.nodeType===Ah.comment&&tr(/<[/\w]/g,k.data))return lo(k),!0;if(!st[me]||L[me]){if(!L[me]&&G_(me)&&(I.tagNameCheck instanceof RegExp&&tr(I.tagNameCheck,me)||I.tagNameCheck instanceof Function&&I.tagNameCheck(me)))return!1;if(ce&&!ze[me]){const kt=P(k)||k.parentNode,Vn=C(k)||k.childNodes;if(Vn&&kt){const Dn=Vn.length;for(let mr=Dn-1;mr>=0;--mr){const uo=v(Vn[mr],!0);uo.__removalCount=(k.__removalCount||0)+1,kt.insertBefore(uo,E(k))}}}return lo(k),!0}return k instanceof l&&!OV(k)||(me==="noscript"||me==="noembed"||me==="noframes")&&tr(/<\/no(script|embed|frames)/i,k.innerHTML)?(lo(k),!0):(S&&k.nodeType===Ah.text&&(re=k.textContent,Vg([ne,Q,te],kt=>{re=xh(re,kt," ")}),k.textContent!==re&&(Ph(e.removed,{element:k.cloneNode()}),k.textContent=re)),rs(X.afterSanitizeElements,k,null),!1)},Y_=function(k,re,me){if(F&&(re==="id"||re==="name")&&(me in n||me in IV))return!1;if(!(J&&!j[re]&&tr(pe,re))){if(!(K&&tr(et,re))){if(!w[re]||j[re]){if(!(G_(k)&&(I.tagNameCheck instanceof RegExp&&tr(I.tagNameCheck,k)||I.tagNameCheck instanceof Function&&I.tagNameCheck(k))&&(I.attributeNameCheck instanceof RegExp&&tr(I.attributeNameCheck,re)||I.attributeNameCheck instanceof Function&&I.attributeNameCheck(re))||re==="is"&&I.allowCustomizedBuiltInElements&&(I.tagNameCheck instanceof RegExp&&tr(I.tagNameCheck,me)||I.tagNameCheck instanceof Function&&I.tagNameCheck(me))))return!1}else if(!Oi[re]){if(!tr(_n,xh(me,Ae,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&k!=="script"&&$4(me,"data:")===0&&Ve[k])){if(!(b&&!tr(Re,xh(me,Ae,"")))){if(me)return!1}}}}}}return!0},G_=function(k){return k!=="annotation-xml"&&Tx(k,ot)},K_=function(k){rs(X.beforeSanitizeAttributes,k,null);const{attributes:re}=k;if(!re||yy(k))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w,forceKeepAttr:void 0};let kt=re.length;for(;kt--;){const Vn=re[kt],{name:Dn,namespaceURI:mr,value:uo}=Vn,Rh=Pn(Dn);let er=Dn==="value"?uo:L4(uo);if(me.attrName=Rh,me.attrValue=er,me.keepAttr=!0,me.forceKeepAttr=void 0,rs(X.uponSanitizeAttribute,k,me),er=me.attrValue,Y&&(Rh==="id"||Rh==="name")&&(Pg(Dn,k),er=ae+er),$&&tr(/((--!?|])>)|<\/(style|title)/i,er)){Pg(Dn,k);continue}if(me.forceKeepAttr||(Pg(Dn,k),!me.keepAttr))continue;if(!R&&tr(/\/>/i,er)){Pg(Dn,k);continue}S&&Vg([ne,Q,te],X_=>{er=xh(er,X_," ")});const q_=Pn(k.nodeName);if(Y_(q_,Rh,er)){if(A&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!mr)switch(f.getAttributeType(q_,Rh)){case"TrustedHTML":{er=A.createHTML(er);break}case"TrustedScriptURL":{er=A.createScriptURL(er);break}}try{mr?k.setAttributeNS(mr,Dn,er):k.setAttribute(Dn,er),yy(k)?lo(k):Ex(e.removed)}catch{}}}rs(X.afterSanitizeAttributes,k,null)},AV=function ye(k){let re=null;const me=j_(k);for(rs(X.beforeSanitizeShadowDOM,k,null);re=me.nextNode();)rs(X.uponSanitizeShadowNode,re,null),z_(re),K_(re),re.content instanceof o&&ye(re.content);rs(X.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(ye){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,me=null,kt=null,Vn=null;if(_t=!ye,_t&&(ye="<!-->"),typeof ye!="string"&&!U_(ye))if(typeof ye.toString=="function"){if(ye=ye.toString(),typeof ye!="string")throw Ih("dirty is not a string, aborting")}else throw Ih("toString is not a function");if(!e.isSupported)return ye;if(N||vy(k),e.removed=[],typeof ye=="string"&&(_e=!1),_e){if(ye.nodeName){const uo=Pn(ye.nodeName);if(!st[uo]||L[uo])throw Ih("root node is forbidden and cannot be sanitized in-place")}}else if(ye instanceof a)re=B_("<!---->"),me=re.ownerDocument.importNode(ye,!0),me.nodeType===Ah.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?re=me:re.appendChild(me);else{if(!O&&!S&&!x&&ye.indexOf("<")===-1)return A&&W?A.createHTML(ye):ye;if(re=B_(ye),!re)return O?null:W?_:""}re&&B&&lo(re.firstChild);const Dn=j_(_e?ye:re);for(;kt=Dn.nextNode();)z_(kt),K_(kt),kt.content instanceof o&&AV(kt.content);if(_e)return ye;if(O){if(D)for(Vn=G.call(re.ownerDocument);re.firstChild;)Vn.appendChild(re.firstChild);else Vn=re;return(w.shadowroot||w.shadowrootmode)&&(Vn=V.call(r,Vn,!0)),Vn}let mr=x?re.outerHTML:re.innerHTML;return x&&st["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&tr(cD,re.ownerDocument.doctype.name)&&(mr="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+mr),S&&Vg([ne,Q,te],uo=>{mr=xh(mr,uo," ")}),A&&W?A.createHTML(mr):mr},e.setConfig=function(){let ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vy(ye),N=!0},e.clearConfig=function(){Iu=null,N=!1},e.isValidAttribute=function(ye,k,re){Iu||vy({});const me=Pn(ye),kt=Pn(k);return Y_(me,kt,re)},e.addHook=function(ye,k){typeof k=="function"&&Ph(X[ye],k)},e.removeHook=function(ye,k){if(k!==void 0){const re=D4(X[ye],k);return re===-1?void 0:k4(X[ye],re,1)[0]}return Ex(X[ye])},e.removeHooks=function(ye){X[ye]=[]},e.removeAllHooks=function(){X=Ox()},e}var Q4=hD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var dD;function Z(){return dD.apply(null,arguments)}function eX(t){dD=t}function no(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function tu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function rt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Y0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(rt(t,e))return!1;return!0}function Tr(t){return t===void 0}function Vs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function ig(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function fD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function _a(t,e){for(var n in e)rt(e,n)&&(t[n]=e[n]);return rt(e,"toString")&&(t.toString=e.toString),rt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Zo(t,e,n,r){return kD(t,e,n,r,!0).utc()}function tX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ne(t){return t._pf==null&&(t._pf=tX()),t._pf}var JS;Array.prototype.some?JS=Array.prototype.some:JS=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function G0(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ne(t),n=JS.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Cv(t){var e=Zo(NaN);return t!=null?_a(Ne(e),t):Ne(e).userInvalidated=!0,e}var Ax=Z.momentProperties=[],iC=!1;function K0(t,e){var n,r,i,o=Ax.length;if(Tr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Tr(e._i)||(t._i=e._i),Tr(e._f)||(t._f=e._f),Tr(e._l)||(t._l=e._l),Tr(e._strict)||(t._strict=e._strict),Tr(e._tzm)||(t._tzm=e._tzm),Tr(e._isUTC)||(t._isUTC=e._isUTC),Tr(e._offset)||(t._offset=e._offset),Tr(e._pf)||(t._pf=Ne(e)),Tr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=Ax[n],i=e[r],Tr(i)||(t[r]=i);return t}function og(t){K0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),iC===!1&&(iC=!0,Z.updateOffset(this),iC=!1)}function ro(t){return t instanceof og||t!=null&&t._isAMomentObject!=null}function gD(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function _i(t,e){var n=!0;return _a(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])rt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}gD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Hx={};function mD(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),Hx[t]||(gD(e),Hx[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function Qo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function nX(t){var e,n;for(n in t)rt(t,n)&&(e=t[n],Qo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ZS(t,e){var n=_a({},t),r;for(r in e)rt(e,r)&&(tu(t[r])&&tu(e[r])?(n[r]={},_a(n[r],t[r]),_a(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)rt(t,r)&&!rt(e,r)&&tu(t[r])&&(n[r]=_a({},n[r]));return n}function q0(t){t!=null&&this.set(t)}var QS;Object.keys?QS=Object.keys:QS=function(t){var e,n=[];for(e in t)rt(t,e)&&n.push(e);return n};var rX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function iX(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Qo(r)?r.call(e,n):r}function Go(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var X0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Bg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,oC={},kc={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(kc[t]=i),e&&(kc[e[0]]=function(){return Go(i.apply(this,arguments),e[1],e[2])}),n&&(kc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function oX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function sX(t){var e=t.match(X0),n,r;for(n=0,r=e.length;n<r;n++)kc[e[n]]?e[n]=kc[e[n]]:e[n]=oX(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Qo(e[s])?e[s].call(i,t):e[s];return o}}function Pp(t,e){return t.isValid()?(e=pD(e,t.localeData()),oC[e]=oC[e]||sX(e),oC[e](t)):t.localeData().invalidDate()}function pD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Bg.lastIndex=0;n>=0&&Bg.test(t);)t=t.replace(Bg,r),Bg.lastIndex=0,n-=1;return t}var aX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function lX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(X0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var uX="Invalid date";function cX(){return this._invalidDate}var hX="%d",dX=/\d{1,2}/;function fX(t){return this._ordinal.replace("%d",t)}var gX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function mX(t,e,n,r){var i=this._relativeTime[n];return Qo(i)?i(t,e,n,r):i.replace(/%d/i,t)}function pX(t,e){var n=this._relativeTime[t>0?"future":"past"];return Qo(n)?n(e):n.replace(/%s/i,e)}var Nx={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Pi(t){return typeof t=="string"?Nx[t]||Nx[t.toLowerCase()]:void 0}function J0(t){var e={},n,r;for(r in t)rt(t,r)&&(n=Pi(r),n&&(e[n]=t[r]));return e}var wX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function vX(t){var e=[],n;for(n in t)rt(t,n)&&e.push({unit:n,priority:wX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var wD=/\d/,ni=/\d\d/,vD=/\d{3}/,Z0=/\d{4}/,bv=/[+-]?\d{6}/,Dt=/\d\d?/,yD=/\d\d\d\d?/,CD=/\d\d\d\d\d\d?/,Sv=/\d{1,3}/,Q0=/\d{1,4}/,Rv=/[+-]?\d{1,6}/,hh=/\d+/,Ev=/[+-]?\d+/,yX=/Z|[+-]\d\d:?\d\d/gi,Tv=/Z|[+-]\d\d(?::?\d\d)?/gi,CX=/[+-]?\d+(\.\d{1,3})?/,sg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,dh=/^[1-9]\d?/,eE=/^([1-9]\d|\d)/,mw;mw={};function ue(t,e,n){mw[t]=Qo(e)?e:function(r,i){return r&&n?n:e}}function bX(t,e){return rt(mw,t)?mw[t](e._strict,e._locale):new RegExp(SX(t))}function SX(t){return Ls(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Ls(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function wi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ge(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=wi(e)),n}var eR={};function wt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Vs(e)&&(r=function(o,s){s[e]=Ge(o)}),i=t.length,n=0;n<i;n++)eR[t[n]]=r}function ag(t,e){wt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function RX(t,e,n){e!=null&&rt(eR,t)&&eR[t](e,n._a,n,t)}function Mv(t){return t%4===0&&t%100!==0||t%400===0}var Xn=0,Is=1,$o=2,Tn=3,Qi=4,Os=5,Gl=6,EX=7,TX=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?Go(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ue("Y",Ev);ue("YY",Dt,ni);ue("YYYY",Q0,Z0);ue("YYYYY",Rv,bv);ue("YYYYYY",Rv,bv);wt(["YYYYY","YYYYYY"],Xn);wt("YYYY",function(t,e){e[Xn]=t.length===2?Z.parseTwoDigitYear(t):Ge(t)});wt("YY",function(t,e){e[Xn]=Z.parseTwoDigitYear(t)});wt("Y",function(t,e){e[Xn]=parseInt(t,10)});function Wd(t){return Mv(t)?366:365}Z.parseTwoDigitYear=function(t){return Ge(t)+(Ge(t)>68?1900:2e3)};var bD=fh("FullYear",!0);function MX(){return Mv(this.year())}function fh(t,e){return function(n){return n!=null?(SD(this,t,n),Z.updateOffset(this,e),this):Cf(this,t)}}function Cf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function SD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Mv(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function _X(t){return t=Pi(t),Qo(this[t])?this[t]():this}function PX(t,e){if(typeof t=="object"){t=J0(t);var n=vX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Pi(t),Qo(this[t]))return this[t](e);return this}function xX(t,e){return(t%e+e)%e}var sn;Array.prototype.indexOf?sn=Array.prototype.indexOf:sn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function tE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=xX(e,12);return t+=(e-n)/12,n===1?Mv(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Dt,dh);ue("MM",Dt,ni);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});wt(["M","MM"],function(t,e){e[Is]=Ge(t)-1});wt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Is]=i:Ne(n).invalidMonth=t});var IX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),RD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ED=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,OX=sg,AX=sg;function HX(t,e){return t?no(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||ED).test(e)?"format":"standalone"][t.month()]:no(this._months)?this._months:this._months.standalone}function NX(t,e){return t?no(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[ED.test(e)?"format":"standalone"][t.month()]:no(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function DX(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Zo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=sn.call(this._shortMonthsParse,s),i!==-1?i:null):(i=sn.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=sn.call(this._shortMonthsParse,s),i!==-1?i:(i=sn.call(this._longMonthsParse,s),i!==-1?i:null)):(i=sn.call(this._longMonthsParse,s),i!==-1?i:(i=sn.call(this._shortMonthsParse,s),i!==-1?i:null))}function kX(t,e,n){var r,i,o;if(this._monthsParseExact)return DX.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Zo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function TD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ge(e);else if(e=t.localeData().monthsParse(e),!Vs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,tE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function MD(t){return t!=null?(TD(this,t),Z.updateOffset(this,!0),this):Cf(this,"Month")}function $X(){return tE(this.year(),this.month())}function LX(t){return this._monthsParseExact?(rt(this,"_monthsRegex")||_D.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(rt(this,"_monthsShortRegex")||(this._monthsShortRegex=OX),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function FX(t){return this._monthsParseExact?(rt(this,"_monthsRegex")||_D.call(this),t?this._monthsStrictRegex:this._monthsRegex):(rt(this,"_monthsRegex")||(this._monthsRegex=AX),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function _D(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Zo([2e3,i]),s=Ls(this.monthsShort(o,"")),a=Ls(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function VX(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function bf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function pw(t,e,n){var r=7+e-n,i=(7+bf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function PD(t,e,n,r,i){var o=(7+n-r)%7,s=pw(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Wd(l)+a):a>Wd(t)?(l=t+1,u=a-Wd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Sf(t,e,n){var r=pw(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Fs(s,e,n)):i>Fs(t.year(),e,n)?(o=i-Fs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Fs(t,e,n){var r=pw(t,e,n),i=pw(t+1,e,n);return(Wd(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ue("w",Dt,dh);ue("ww",Dt,ni);ue("W",Dt,dh);ue("WW",Dt,ni);ag(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Ge(t)});function WX(t){return Sf(t,this._week.dow,this._week.doy).week}var BX={dow:0,doy:6};function jX(){return this._week.dow}function UX(){return this._week.doy}function zX(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function YX(t){var e=Sf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ue("d",Dt);ue("e",Dt);ue("E",Dt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});ag(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ne(n).invalidWeekday=t});ag(["d","e","E"],function(t,e,n,r){e[r]=Ge(t)});function GX(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function KX(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function nE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var qX="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),xD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),XX="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),JX=sg,ZX=sg,QX=sg;function e6(t,e){var n=no(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?nE(n,this._week.dow):t?n[t.day()]:n}function t6(t){return t===!0?nE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function n6(t){return t===!0?nE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function r6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Zo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=sn.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=sn.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=sn.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=sn.call(this._weekdaysParse,s),i!==-1||(i=sn.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=sn.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=sn.call(this._shortWeekdaysParse,s),i!==-1||(i=sn.call(this._weekdaysParse,s),i!==-1)?i:(i=sn.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=sn.call(this._minWeekdaysParse,s),i!==-1||(i=sn.call(this._weekdaysParse,s),i!==-1)?i:(i=sn.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function i6(t,e,n){var r,i,o;if(this._weekdaysParseExact)return r6.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Zo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function o6(t){if(!this.isValid())return t!=null?this:NaN;var e=Cf(this,"Day");return t!=null?(t=GX(t,this.localeData()),this.add(t-e,"d")):e}function s6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function a6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=KX(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function l6(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||rE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(rt(this,"_weekdaysRegex")||(this._weekdaysRegex=JX),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function u6(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||rE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(rt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ZX),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function c6(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||rE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(rt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=QX),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function rE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Zo([2e3,1]).day(o),a=Ls(this.weekdaysMin(s,"")),l=Ls(this.weekdaysShort(s,"")),u=Ls(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function iE(){return this.hours()%12||12}function h6(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,iE);Ce("k",["kk",2],0,h6);Ce("hmm",0,0,function(){return""+iE.apply(this)+Go(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+iE.apply(this)+Go(this.minutes(),2)+Go(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+Go(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+Go(this.minutes(),2)+Go(this.seconds(),2)});function ID(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}ID("a",!0);ID("A",!1);function OD(t,e){return e._meridiemParse}ue("a",OD);ue("A",OD);ue("H",Dt,eE);ue("h",Dt,dh);ue("k",Dt,dh);ue("HH",Dt,ni);ue("hh",Dt,ni);ue("kk",Dt,ni);ue("hmm",yD);ue("hmmss",CD);ue("Hmm",yD);ue("Hmmss",CD);wt(["H","HH"],Tn);wt(["k","kk"],function(t,e,n){var r=Ge(t);e[Tn]=r===24?0:r});wt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});wt(["h","hh"],function(t,e,n){e[Tn]=Ge(t),Ne(n).bigHour=!0});wt("hmm",function(t,e,n){var r=t.length-2;e[Tn]=Ge(t.substr(0,r)),e[Qi]=Ge(t.substr(r)),Ne(n).bigHour=!0});wt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Tn]=Ge(t.substr(0,r)),e[Qi]=Ge(t.substr(r,2)),e[Os]=Ge(t.substr(i)),Ne(n).bigHour=!0});wt("Hmm",function(t,e,n){var r=t.length-2;e[Tn]=Ge(t.substr(0,r)),e[Qi]=Ge(t.substr(r))});wt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Tn]=Ge(t.substr(0,r)),e[Qi]=Ge(t.substr(r,2)),e[Os]=Ge(t.substr(i))});function d6(t){return(t+"").toLowerCase().charAt(0)==="p"}var f6=/[ap]\.?m?\.?/i,g6=fh("Hours",!0);function m6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var AD={calendar:rX,longDateFormat:aX,invalidDate:uX,ordinal:hX,dayOfMonthOrdinalParse:dX,relativeTime:gX,months:IX,monthsShort:RD,week:BX,weekdays:qX,weekdaysMin:XX,weekdaysShort:xD,meridiemParse:f6},$t={},Hh={},Rf;function p6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function Dx(t){return t&&t.toLowerCase().replace("_","-")}function w6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=Dx(t[e]).split("-"),n=o.length,r=Dx(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=_v(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&p6(o,r)>=n-1)break;n--}e++}return Rf}function v6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function _v(t){var e=null,n;if($t[t]===void 0&&typeof Jp<"u"&&Jp&&Jp.exports&&v6(t))try{e=Rf._abbr,n=require,n("./locale/"+t),Na(e)}catch{$t[t]=null}return $t[t]}function Na(t,e){var n;return t&&(Tr(e)?n=Ys(t):n=oE(t,e),n?Rf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Rf._abbr}function oE(t,e){if(e!==null){var n,r=AD;if(e.abbr=t,$t[t]!=null)mD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=$t[t]._config;else if(e.parentLocale!=null)if($t[e.parentLocale]!=null)r=$t[e.parentLocale]._config;else if(n=_v(e.parentLocale),n!=null)r=n._config;else return Hh[e.parentLocale]||(Hh[e.parentLocale]=[]),Hh[e.parentLocale].push({name:t,config:e}),null;return $t[t]=new q0(ZS(r,e)),Hh[t]&&Hh[t].forEach(function(i){oE(i.name,i.config)}),Na(t),$t[t]}else return delete $t[t],null}function y6(t,e){if(e!=null){var n,r,i=AD;$t[t]!=null&&$t[t].parentLocale!=null?$t[t].set(ZS($t[t]._config,e)):(r=_v(t),r!=null&&(i=r._config),e=ZS(i,e),r==null&&(e.abbr=t),n=new q0(e),n.parentLocale=$t[t],$t[t]=n),Na(t)}else $t[t]!=null&&($t[t].parentLocale!=null?($t[t]=$t[t].parentLocale,t===Na()&&Na(t)):$t[t]!=null&&delete $t[t]);return $t[t]}function Ys(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Rf;if(!no(t)){if(e=_v(t),e)return e;t=[t]}return w6(t)}function C6(){return QS($t)}function sE(t){var e,n=t._a;return n&&Ne(t).overflow===-2&&(e=n[Is]<0||n[Is]>11?Is:n[$o]<1||n[$o]>tE(n[Xn],n[Is])?$o:n[Tn]<0||n[Tn]>24||n[Tn]===24&&(n[Qi]!==0||n[Os]!==0||n[Gl]!==0)?Tn:n[Qi]<0||n[Qi]>59?Qi:n[Os]<0||n[Os]>59?Os:n[Gl]<0||n[Gl]>999?Gl:-1,Ne(t)._overflowDayOfYear&&(e<Xn||e>$o)&&(e=$o),Ne(t)._overflowWeeks&&e===-1&&(e=EX),Ne(t)._overflowWeekday&&e===-1&&(e=TX),Ne(t).overflow=e),t}var b6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,S6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,R6=/Z|[+-]\d\d(?::?\d\d)?/,jg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],sC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],E6=/^\/?Date\((-?\d+)/i,T6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,M6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function HD(t){var e,n,r=t._i,i=b6.exec(r)||S6.exec(r),o,s,a,l,u=jg.length,c=sC.length;if(i){for(Ne(t).iso=!0,e=0,n=u;e<n;e++)if(jg[e][1].exec(i[1])){s=jg[e][0],o=jg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(sC[e][1].exec(i[3])){a=(i[2]||" ")+sC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(R6.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),lE(t)}else t._isValid=!1}function _6(t,e,n,r,i,o){var s=[P6(t),RD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function P6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function x6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function I6(t,e,n){if(t){var r=xD.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ne(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function O6(t,e,n){if(t)return M6[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function ND(t){var e=T6.exec(x6(t._i)),n;if(e){if(n=_6(e[4],e[3],e[2],e[5],e[6],e[7]),!I6(e[1],n,t))return;t._a=n,t._tzm=O6(e[8],e[9],e[10]),t._d=bf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ne(t).rfc2822=!0}else t._isValid=!1}function A6(t){var e=E6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(HD(t),t._isValid===!1)delete t._isValid;else return;if(ND(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=_i("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function vc(t,e,n){return t??e??n}function H6(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function aE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=H6(t),t._w&&t._a[$o]==null&&t._a[Is]==null&&N6(t),t._dayOfYear!=null&&(s=vc(t._a[Xn],i[Xn]),(t._dayOfYear>Wd(s)||t._dayOfYear===0)&&(Ne(t)._overflowDayOfYear=!0),n=bf(s,0,t._dayOfYear),t._a[Is]=n.getUTCMonth(),t._a[$o]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Tn]===24&&t._a[Qi]===0&&t._a[Os]===0&&t._a[Gl]===0&&(t._nextDay=!0,t._a[Tn]=0),t._d=(t._useUTC?bf:VX).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Tn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ne(t).weekdayMismatch=!0)}}function N6(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=vc(e.GG,t._a[Xn],Sf(Nt(),1,4).year),r=vc(e.W,1),i=vc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Sf(Nt(),o,s),n=vc(e.gg,t._a[Xn],u.year),r=vc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Fs(n,o,s)?Ne(t)._overflowWeeks=!0:l!=null?Ne(t)._overflowWeekday=!0:(a=PD(n,r,i,o,s),t._a[Xn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function lE(t){if(t._f===Z.ISO_8601){HD(t);return}if(t._f===Z.RFC_2822){ND(t);return}t._a=[],Ne(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=pD(t._f,t._locale).match(X0)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(bX(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ne(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),kc[o]?(r?Ne(t).empty=!1:Ne(t).unusedTokens.push(o),RX(o,r,t)):t._strict&&!r&&Ne(t).unusedTokens.push(o);Ne(t).charsLeftOver=a-l,e.length>0&&Ne(t).unusedInput.push(e),t._a[Tn]<=12&&Ne(t).bigHour===!0&&t._a[Tn]>0&&(Ne(t).bigHour=void 0),Ne(t).parsedDateParts=t._a.slice(0),Ne(t).meridiem=t._meridiem,t._a[Tn]=D6(t._locale,t._a[Tn],t._meridiem),u=Ne(t).era,u!==null&&(t._a[Xn]=t._locale.erasConvertYear(u,t._a[Xn])),aE(t),sE(t)}function D6(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function k6(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ne(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=K0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],lE(e),G0(e)&&(s=!0),o+=Ne(e).charsLeftOver,o+=Ne(e).unusedTokens.length*10,Ne(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));_a(t,n||e)}function $6(t){if(!t._d){var e=J0(t._i),n=e.day===void 0?e.date:e.day;t._a=fD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),aE(t)}}function L6(t){var e=new og(sE(DD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function DD(t){var e=t._i,n=t._f;return t._locale=t._locale||Ys(t._l),e===null||n===void 0&&e===""?Cv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ro(e)?new og(sE(e)):(ig(e)?t._d=e:no(n)?k6(t):n?lE(t):F6(t),G0(t)||(t._d=null),t))}function F6(t){var e=t._i;Tr(e)?t._d=new Date(Z.now()):ig(e)?t._d=new Date(e.valueOf()):typeof e=="string"?A6(t):no(e)?(t._a=fD(e.slice(0),function(n){return parseInt(n,10)}),aE(t)):tu(e)?$6(t):Vs(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function kD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(tu(t)&&Y0(t)||no(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,L6(o)}function Nt(t,e,n,r){return kD(t,e,n,r,!1)}var V6=_i("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Nt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Cv()}),W6=_i("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Nt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Cv()});function $D(t,e){var n,r;if(e.length===1&&no(e[0])&&(e=e[0]),!e.length)return Nt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function B6(){var t=[].slice.call(arguments,0);return $D("isBefore",t)}function j6(){var t=[].slice.call(arguments,0);return $D("isAfter",t)}var U6=function(){return Date.now?Date.now():+new Date},Nh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function z6(t){var e,n=!1,r,i=Nh.length;for(e in t)if(rt(t,e)&&!(sn.call(Nh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Nh[r]]){if(n)return!1;parseFloat(t[Nh[r]])!==Ge(t[Nh[r]])&&(n=!0)}return!0}function Y6(){return this._isValid}function G6(){return so(NaN)}function Pv(t){var e=J0(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=z6(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Ys(),this._bubble()}function xp(t){return t instanceof Pv}function tR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function K6(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Ge(t[s])!==Ge(e[s])&&o++;return o+i}function LD(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Go(~~(n/60),2)+e+Go(~~n%60,2)})}LD("Z",":");LD("ZZ","");ue("Z",Tv);ue("ZZ",Tv);wt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=uE(Tv,t)});var q6=/([\+\-]|\d\d)/gi;function uE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(q6)||["-",0,0],o=+(i[1]*60)+Ge(i[2]),o===0?0:i[0]==="+"?o:-o)}function cE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ro(t)||ig(t)?t.valueOf():Nt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Nt(t).local()}function nR(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function X6(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=uE(Tv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=nR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?WD(this,so(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:nR(this)}function J6(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Z6(t){return this.utcOffset(0,t)}function Q6(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(nR(this),"m")),this}function e7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=uE(yX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function t7(t){return this.isValid()?(t=t?Nt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function n7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function r7(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return K0(t,this),t=DD(t),t._a?(e=t._isUTC?Zo(t._a):Nt(t._a),this._isDSTShifted=this.isValid()&&K6(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function i7(){return this.isValid()?!this._isUTC:!1}function o7(){return this.isValid()?this._isUTC:!1}function FD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var s7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,a7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function so(t,e){var n=t,r=null,i,o,s;return xp(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Vs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=s7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Ge(r[$o])*i,h:Ge(r[Tn])*i,m:Ge(r[Qi])*i,s:Ge(r[Os])*i,ms:Ge(tR(r[Gl]*1e3))*i}):(r=a7.exec(t))?(i=r[1]==="-"?-1:1,n={y:el(r[2],i),M:el(r[3],i),w:el(r[4],i),d:el(r[5],i),h:el(r[6],i),m:el(r[7],i),s:el(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=l7(Nt(n.from),Nt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Pv(n),xp(t)&&rt(t,"_locale")&&(o._locale=t._locale),xp(t)&&rt(t,"_isValid")&&(o._isValid=t._isValid),o}so.fn=Pv.prototype;so.invalid=G6;function el(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function kx(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function l7(t,e){var n;return t.isValid()&&e.isValid()?(e=cE(e,t),t.isBefore(e)?n=kx(t,e):(n=kx(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function VD(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(mD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=so(n,r),WD(this,i,t),this}}function WD(t,e,n,r){var i=e._milliseconds,o=tR(e._days),s=tR(e._months);t.isValid()&&(r=r??!0,s&&TD(t,Cf(t,"Month")+s*n),o&&SD(t,"Date",Cf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var u7=VD(1,"add"),c7=VD(-1,"subtract");function BD(t){return typeof t=="string"||t instanceof String}function h7(t){return ro(t)||ig(t)||BD(t)||Vs(t)||f7(t)||d7(t)||t===null||t===void 0}function d7(t){var e=tu(t)&&!Y0(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||rt(t,o);return e&&n}function f7(t){var e=no(t),n=!1;return e&&(n=t.filter(function(r){return!Vs(r)&&BD(t)}).length===0),e&&n}function g7(t){var e=tu(t)&&!Y0(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||rt(t,o);return e&&n}function m7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function p7(t,e){arguments.length===1&&(arguments[0]?h7(arguments[0])?(t=arguments[0],e=void 0):g7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Nt(),r=cE(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(Qo(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Nt(n)))}function w7(){return new og(this)}function v7(t,e){var n=ro(t)?t:Nt(t);return this.isValid()&&n.isValid()?(e=Pi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function y7(t,e){var n=ro(t)?t:Nt(t);return this.isValid()&&n.isValid()?(e=Pi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function C7(t,e,n,r){var i=ro(t)?t:Nt(t),o=ro(e)?e:Nt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function b7(t,e){var n=ro(t)?t:Nt(t),r;return this.isValid()&&n.isValid()?(e=Pi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function S7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function R7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function E7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=cE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Pi(e),e){case"year":o=Ip(this,r)/12;break;case"month":o=Ip(this,r);break;case"quarter":o=Ip(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:wi(o)}function Ip(t,e){if(t.date()<e.date())return-Ip(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function T7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function M7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Pp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Qo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Pp(n,"Z")):Pp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function _7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function P7(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Pp(this,t);return this.localeData().postformat(e)}function x7(t,e){return this.isValid()&&(ro(t)&&t.isValid()||Nt(t).isValid())?so({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function I7(t){return this.from(Nt(),t)}function O7(t,e){return this.isValid()&&(ro(t)&&t.isValid()||Nt(t).isValid())?so({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function A7(t){return this.to(Nt(),t)}function jD(t){var e;return t===void 0?this._locale._abbr:(e=Ys(t),e!=null&&(this._locale=e),this)}var UD=_i("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function zD(){return this._locale}var ww=1e3,$c=60*ww,vw=60*$c,YD=(365*400+97)*24*vw;function Lc(t,e){return(t%e+e)%e}function GD(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-YD:new Date(t,e,n).valueOf()}function KD(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-YD:Date.UTC(t,e,n)}function H7(t){var e,n;if(t=Pi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?KD:GD,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Lc(e+(this._isUTC?0:this.utcOffset()*$c),vw);break;case"minute":e=this._d.valueOf(),e-=Lc(e,$c);break;case"second":e=this._d.valueOf(),e-=Lc(e,ww);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function N7(t){var e,n;if(t=Pi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?KD:GD,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=vw-Lc(e+(this._isUTC?0:this.utcOffset()*$c),vw)-1;break;case"minute":e=this._d.valueOf(),e+=$c-Lc(e,$c)-1;break;case"second":e=this._d.valueOf(),e+=ww-Lc(e,ww)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function D7(){return this._d.valueOf()-(this._offset||0)*6e4}function k7(){return Math.floor(this.valueOf()/1e3)}function $7(){return new Date(this.valueOf())}function L7(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function F7(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function V7(){return this.isValid()?this.toISOString():null}function W7(){return G0(this)}function B7(){return _a({},Ne(this))}function j7(){return Ne(this).overflow}function U7(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ue("N",hE);ue("NN",hE);ue("NNN",hE);ue("NNNN",t9);ue("NNNNN",n9);wt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ne(n).era=i:Ne(n).invalidEra=t});ue("y",hh);ue("yy",hh);ue("yyy",hh);ue("yyyy",hh);ue("yo",r9);wt(["y","yy","yyy","yyyy"],Xn);wt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Xn]=n._locale.eraYearOrdinalParse(t,i):e[Xn]=parseInt(t,10)});function z7(t,e){var n,r,i,o=this._eras||Ys("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function Y7(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function G7(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function K7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function q7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function X7(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function J7(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function Z7(t){return rt(this,"_erasNameRegex")||dE.call(this),t?this._erasNameRegex:this._erasRegex}function Q7(t){return rt(this,"_erasAbbrRegex")||dE.call(this),t?this._erasAbbrRegex:this._erasRegex}function e9(t){return rt(this,"_erasNarrowRegex")||dE.call(this),t?this._erasNarrowRegex:this._erasRegex}function hE(t,e){return e.erasAbbrRegex(t)}function t9(t,e){return e.erasNameRegex(t)}function n9(t,e){return e.erasNarrowRegex(t)}function r9(t,e){return e._eraYearOrdinalRegex||hh}function dE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Ls(u[i].name),a=Ls(u[i].abbr),l=Ls(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function xv(t,e){Ce(0,[t,t.length],0,e)}xv("gggg","weekYear");xv("ggggg","weekYear");xv("GGGG","isoWeekYear");xv("GGGGG","isoWeekYear");ue("G",Ev);ue("g",Ev);ue("GG",Dt,ni);ue("gg",Dt,ni);ue("GGGG",Q0,Z0);ue("gggg",Q0,Z0);ue("GGGGG",Rv,bv);ue("ggggg",Rv,bv);ag(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Ge(t)});ag(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function i9(t){return qD.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function o9(t){return qD.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function s9(){return Fs(this.year(),1,4)}function a9(){return Fs(this.isoWeekYear(),1,4)}function l9(){var t=this.localeData()._week;return Fs(this.year(),t.dow,t.doy)}function u9(){var t=this.localeData()._week;return Fs(this.weekYear(),t.dow,t.doy)}function qD(t,e,n,r,i){var o;return t==null?Sf(this,r,i).year:(o=Fs(t,r,i),e>o&&(e=o),c9.call(this,t,e,n,r,i))}function c9(t,e,n,r,i){var o=PD(t,e,n,r,i),s=bf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ue("Q",wD);wt("Q",function(t,e){e[Is]=(Ge(t)-1)*3});function h9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ue("D",Dt,dh);ue("DD",Dt,ni);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});wt(["D","DD"],$o);wt("Do",function(t,e){e[$o]=Ge(t.match(Dt)[0])});var XD=fh("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Sv);ue("DDDD",vD);wt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ge(t)});function d9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ue("m",Dt,eE);ue("mm",Dt,ni);wt(["m","mm"],Qi);var f9=fh("Minutes",!1);Ce("s",["ss",2],0,"second");ue("s",Dt,eE);ue("ss",Dt,ni);wt(["s","ss"],Os);var g9=fh("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Sv,wD);ue("SS",Sv,ni);ue("SSS",Sv,vD);var Pa,JD;for(Pa="SSSS";Pa.length<=9;Pa+="S")ue(Pa,hh);function m9(t,e){e[Gl]=Ge(("0."+t)*1e3)}for(Pa="S";Pa.length<=9;Pa+="S")wt(Pa,m9);JD=fh("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function p9(){return this._isUTC?"UTC":""}function w9(){return this._isUTC?"Coordinated Universal Time":""}var ee=og.prototype;ee.add=u7;ee.calendar=p7;ee.clone=w7;ee.diff=E7;ee.endOf=N7;ee.format=P7;ee.from=x7;ee.fromNow=I7;ee.to=O7;ee.toNow=A7;ee.get=_X;ee.invalidAt=j7;ee.isAfter=v7;ee.isBefore=y7;ee.isBetween=C7;ee.isSame=b7;ee.isSameOrAfter=S7;ee.isSameOrBefore=R7;ee.isValid=W7;ee.lang=UD;ee.locale=jD;ee.localeData=zD;ee.max=W6;ee.min=V6;ee.parsingFlags=B7;ee.set=PX;ee.startOf=H7;ee.subtract=c7;ee.toArray=L7;ee.toObject=F7;ee.toDate=$7;ee.toISOString=M7;ee.inspect=_7;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=V7;ee.toString=T7;ee.unix=k7;ee.valueOf=D7;ee.creationData=U7;ee.eraName=K7;ee.eraNarrow=q7;ee.eraAbbr=X7;ee.eraYear=J7;ee.year=bD;ee.isLeapYear=MX;ee.weekYear=i9;ee.isoWeekYear=o9;ee.quarter=ee.quarters=h9;ee.month=MD;ee.daysInMonth=$X;ee.week=ee.weeks=zX;ee.isoWeek=ee.isoWeeks=YX;ee.weeksInYear=l9;ee.weeksInWeekYear=u9;ee.isoWeeksInYear=s9;ee.isoWeeksInISOWeekYear=a9;ee.date=XD;ee.day=ee.days=o6;ee.weekday=s6;ee.isoWeekday=a6;ee.dayOfYear=d9;ee.hour=ee.hours=g6;ee.minute=ee.minutes=f9;ee.second=ee.seconds=g9;ee.millisecond=ee.milliseconds=JD;ee.utcOffset=X6;ee.utc=Z6;ee.local=Q6;ee.parseZone=e7;ee.hasAlignedHourOffset=t7;ee.isDST=n7;ee.isLocal=i7;ee.isUtcOffset=o7;ee.isUtc=FD;ee.isUTC=FD;ee.zoneAbbr=p9;ee.zoneName=w9;ee.dates=_i("dates accessor is deprecated. Use date instead.",XD);ee.months=_i("months accessor is deprecated. Use month instead",MD);ee.years=_i("years accessor is deprecated. Use year instead",bD);ee.zone=_i("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",J6);ee.isDSTShifted=_i("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",r7);function v9(t){return Nt(t*1e3)}function y9(){return Nt.apply(null,arguments).parseZone()}function ZD(t){return t}var it=q0.prototype;it.calendar=iX;it.longDateFormat=lX;it.invalidDate=cX;it.ordinal=fX;it.preparse=ZD;it.postformat=ZD;it.relativeTime=mX;it.pastFuture=pX;it.set=nX;it.eras=z7;it.erasParse=Y7;it.erasConvertYear=G7;it.erasAbbrRegex=Q7;it.erasNameRegex=Z7;it.erasNarrowRegex=e9;it.months=HX;it.monthsShort=NX;it.monthsParse=kX;it.monthsRegex=FX;it.monthsShortRegex=LX;it.week=WX;it.firstDayOfYear=UX;it.firstDayOfWeek=jX;it.weekdays=e6;it.weekdaysMin=n6;it.weekdaysShort=t6;it.weekdaysParse=i6;it.weekdaysRegex=l6;it.weekdaysShortRegex=u6;it.weekdaysMinRegex=c6;it.isPM=d6;it.meridiem=m6;function yw(t,e,n,r){var i=Ys(),o=Zo().set(r,e);return i[n](o,t)}function QD(t,e,n){if(Vs(t)&&(e=t,t=void 0),t=t||"",e!=null)return yw(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=yw(t,r,n,"month");return i}function fE(t,e,n,r){typeof t=="boolean"?(Vs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Vs(e)&&(n=e,e=void 0),e=e||"");var i=Ys(),o=t?i._week.dow:0,s,a=[];if(n!=null)return yw(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=yw(e,(s+o)%7,r,"day");return a}function C9(t,e){return QD(t,e,"months")}function b9(t,e){return QD(t,e,"monthsShort")}function S9(t,e,n){return fE(t,e,n,"weekdays")}function R9(t,e,n){return fE(t,e,n,"weekdaysShort")}function E9(t,e,n){return fE(t,e,n,"weekdaysMin")}Na("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ge(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=_i("moment.lang is deprecated. Use moment.locale instead.",Na);Z.langData=_i("moment.langData is deprecated. Use moment.localeData instead.",Ys);var is=Math.abs;function T9(){var t=this._data;return this._milliseconds=is(this._milliseconds),this._days=is(this._days),this._months=is(this._months),t.milliseconds=is(t.milliseconds),t.seconds=is(t.seconds),t.minutes=is(t.minutes),t.hours=is(t.hours),t.months=is(t.months),t.years=is(t.years),this}function ek(t,e,n,r){var i=so(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function M9(t,e){return ek(this,t,e,1)}function _9(t,e){return ek(this,t,e,-1)}function $x(t){return t<0?Math.floor(t):Math.ceil(t)}function P9(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=$x(rR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=wi(t/1e3),r.seconds=i%60,o=wi(i/60),r.minutes=o%60,s=wi(o/60),r.hours=s%24,e+=wi(s/24),l=wi(tk(e)),n+=l,e-=$x(rR(l)),a=wi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function tk(t){return t*4800/146097}function rR(t){return t*146097/4800}function x9(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Pi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+tk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(rR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Gs(t){return function(){return this.as(t)}}var nk=Gs("ms"),I9=Gs("s"),O9=Gs("m"),A9=Gs("h"),H9=Gs("d"),N9=Gs("w"),D9=Gs("M"),k9=Gs("Q"),$9=Gs("y"),L9=nk;function F9(){return so(this)}function V9(t){return t=Pi(t),this.isValid()?this[t+"s"]():NaN}function Ru(t){return function(){return this.isValid()?this._data[t]:NaN}}var W9=Ru("milliseconds"),B9=Ru("seconds"),j9=Ru("minutes"),U9=Ru("hours"),z9=Ru("days"),Y9=Ru("months"),G9=Ru("years");function K9(){return wi(this.days()/7)}var Rs=Math.round,_c={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function q9(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function X9(t,e,n,r){var i=so(t).abs(),o=Rs(i.as("s")),s=Rs(i.as("m")),a=Rs(i.as("h")),l=Rs(i.as("d")),u=Rs(i.as("M")),c=Rs(i.as("w")),h=Rs(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,q9.apply(null,d)}function J9(t){return t===void 0?Rs:typeof t=="function"?(Rs=t,!0):!1}function Z9(t,e){return _c[t]===void 0?!1:e===void 0?_c[t]:(_c[t]=e,t==="s"&&(_c.ss=e-1),!0)}function Q9(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=_c,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},_c,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=X9(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var aC=Math.abs;function Au(t){return(t>0)-(t<0)||+t}function Iv(){if(!this.isValid())return this.localeData().invalidDate();var t=aC(this._milliseconds)/1e3,e=aC(this._days),n=aC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=wi(t/60),i=wi(r/60),t%=60,r%=60,o=wi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Au(this._months)!==Au(a)?"-":"",c=Au(this._days)!==Au(a)?"-":"",h=Au(this._milliseconds)!==Au(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ze=Pv.prototype;Ze.isValid=Y6;Ze.abs=T9;Ze.add=M9;Ze.subtract=_9;Ze.as=x9;Ze.asMilliseconds=nk;Ze.asSeconds=I9;Ze.asMinutes=O9;Ze.asHours=A9;Ze.asDays=H9;Ze.asWeeks=N9;Ze.asMonths=D9;Ze.asQuarters=k9;Ze.asYears=$9;Ze.valueOf=L9;Ze._bubble=P9;Ze.clone=F9;Ze.get=V9;Ze.milliseconds=W9;Ze.seconds=B9;Ze.minutes=j9;Ze.hours=U9;Ze.days=z9;Ze.weeks=K9;Ze.months=Y9;Ze.years=G9;Ze.humanize=Q9;Ze.toISOString=Iv;Ze.toString=Iv;Ze.toJSON=Iv;Ze.locale=jD;Ze.localeData=zD;Ze.toIsoString=_i("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Iv);Ze.lang=UD;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ue("x",Ev);ue("X",CX);wt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});wt("x",function(t,e,n){n._d=new Date(Ge(t))});//! moment.js
Z.version="2.30.1";eX(Nt);Z.fn=ee;Z.min=B6;Z.max=j6;Z.now=U6;Z.utc=Zo;Z.unix=v9;Z.months=C9;Z.isDate=ig;Z.locale=Na;Z.invalid=Cv;Z.duration=so;Z.isMoment=ro;Z.weekdays=S9;Z.parseZone=y9;Z.localeData=Ys;Z.isDuration=xp;Z.monthsShort=b9;Z.weekdaysMin=E9;Z.defineLocale=oE;Z.updateLocale=y6;Z.locales=C6;Z.weekdaysShort=R9;Z.normalizeUnits=Pi;Z.relativeTimeRounding=J9;Z.relativeTimeThreshold=Z9;Z.calendarFormat=m7;Z.prototype=ee;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function rk(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function iR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Bd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function bn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Va(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function M(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function ik(t){return bn(t,(e,n)=>e+n,0)}function e8(t){return bn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function t8(t){return bn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function n8(t){return t.length?ik(t)/t.length:0}function ok(t){return bn(t,(e,n)=>e.concat(Array.isArray(n)?ok(n):n),[])}function sk(t){const e=[];return M(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function oR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return M(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function r8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return M(i,s=>{o=o.filter(a=>s.includes(a))}),o}function i8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return M(i,s=>{M(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function sR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const o8=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:n8,arrayEach:M,arrayFilter:Va,arrayFlatten:ok,arrayMap:Ue,arrayMax:e8,arrayMin:t8,arrayReduce:bn,arraySum:ik,arrayUnique:sk,extendArray:iR,getDifferenceOfArrays:oR,getIntersectionOfArrays:r8,getUnionOfArrays:i8,pivot:Bd,stringToArray:sR,to2dArray:rk},Symbol.toStringTag,{value:"Module"}));function ct(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return bn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Rt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Ht(t){return typeof t>"u"}function Yt(t){return t===null||t===""||Ht(t)}function ak(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Ad="length",jd=t=>parseInt(t,16),Lx=t=>parseInt(t,10),Cw=(t,e,n)=>t.substr(e,n),Ud=t=>t.codePointAt(0)-65,aR=t=>`${t}`.replace(/\-/g,""),s8=t=>jd(Cw(aR(t),jd("12"),Ud("F")))/(jd(Cw(aR(t),Ud("B"),~~![][Ad]))||9),a8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Fx=!1;const Vx={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Wx={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function lk(t,e){const n=!Yt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=aR(t||"");const l=l8(t);if(n||r||l)if(l){const u=Z("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=s8(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(a8()&&(s="valid",a="valid"),!Fx&&s!=="valid"&&(Vx[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Vx[s]({keyValidityDate:o,hotVersion:i})),Fx=!0),a!=="valid"&&e.parentNode&&Wx[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=Wx[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function l8(t){let e=[][Ad],n=e;if(t[Ad]!==Ud("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Ud(i.shift());o;o=Ud(i.shift()||"A"))--o<""[Ad]?n=n|(Lx(`${Lx(jd(r)+(jd(Cw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Cw(t,o,o?i[Ad]===1?9:8:6);return n===e}const u8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:lk,isDefined:le,isEmpty:Yt,isRegExp:ak,isUndefined:Ht,stringify:Rt},Symbol.toStringTag,{value:"Module"}));function Zn(t){return t[0].toUpperCase()+t.substr(1)}function c8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Rt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function gE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function mE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function pE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function lR(t){return Ov(`${t}`,{ALLOWED_TAGS:[]})}function Ov(t,e){return Q4.sanitize(t,e)}const h8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:c8,isPercentValue:mE,randomString:gE,sanitize:Ov,stripTags:lR,substitute:pE,toUpperCaseFirst:Zn},Symbol.toStringTag,{value:"Module"})),Eu=t=>["tabindex",t],d8=()=>["role","treegrid"],As=()=>["role","presentation"],f8=()=>["role","gridcell"],g8=()=>["role","rowheader"],uk=()=>["role","rowgroup"],m8=()=>["role","columnheader"],uR=()=>["role","row"],p8=()=>["role","menu"],w8=()=>["role","menuitem"],v8=()=>["role","menuitemcheckbox"],y8=()=>["role","combobox"],ck=()=>["role","listbox"],C8=()=>["role","option"],b8=()=>["role","checkbox"],S8=()=>["scope","col"],R8=()=>["scope","row"],E8=()=>["type","text"],Ef=t=>["aria-label",t],Tu=()=>["aria-hidden","true"],T8=()=>["aria-disabled","true"],M8=()=>["aria-multiselectable","true"],hk=t=>["aria-haspopup",t],dk=t=>["aria-rowcount",t],Av=t=>["aria-colcount",t],fk=t=>["aria-rowindex",t],wE=t=>["aria-colindex",t],Ci=t=>["aria-expanded",t],_8=t=>["aria-sort",t],Bx=()=>["aria-readonly","true"],jx=()=>["aria-invalid","true"],gk=t=>["aria-checked",t],vE=()=>["aria-selected","true"],P8=()=>["aria-autocomplete","list"],x8=t=>["aria-controls",t],I8=t=>["aria-activedescendant",t],O8=t=>["aria-live",t],A8=t=>["aria-relevant",t],H8=t=>["aria-setsize",t],N8=t=>["aria-posinset",t];function mk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function zd(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function pk(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function au(t){return pk(t)&&t.parent}function D8(t){return!!Object.getPrototypeOf(t.parent)}function Wa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Hd(t,e,n){const r=[];let i=t;for(;i&&(i=Wa(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function wk(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Da(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function vk(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function fa(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function yk(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Ck(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=yk(e),e.length>0&&t.classList.add(...e)}function we(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Ck(e,!0);n=yk(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function be(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Mu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Ck(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function yE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)yE(e[n])}}function Ko(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const bk=/(<(.*)>|&(.*);)/;function _u(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;bk.test(e)?t.innerHTML=n?Ov(e):e:Ba(t,e)}function Ba(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Ko(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function lu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return lu(r.host.impl);if(r.host)return lu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function Sk(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Ln(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function CE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Hv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Nv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?CE(e):t.scrollTop}function bE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Hv(e):t.scrollLeft}function Tf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Rk(t){return t.scrollHeight-t.clientHeight}function Ek(t){return t.scrollWidth-t.clientWidth}function qc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Mf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function k8(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Qt(t){return t.offsetWidth}function ln(t){return t.offsetHeight}function Fc(t){return t.clientHeight||t.innerHeight}function SE(t){return t.clientWidth||t.innerWidth}function $8(t,e,n){t.addEventListener(e,n,!1)}function L8(t,e,n){t.removeEventListener(e,n,!1)}function RE(t){return t.selectionStart?t.selectionStart:0}function Tk(t){return t.selectionEnd?t.selectionEnd:0}function F8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function cR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function lg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let lC;function V8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Mn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return lC===void 0&&(lC=V8(t)),lC}function EE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function TE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Dv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function W8(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function ug(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Yd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function kv(t){return Yd(t)&&t.hasAttribute("data-hot-input")===!1}function B8(t){const e=t.ownerDocument.activeElement;kv(e)||t.select()}function ME(t){return!t.parentNode}function Mk(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function _E(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();be(t,"contenteditable",!0),n&&be(t,...Tu()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function PE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&we(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function _k(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_E(t,n),e(),PE(t,n)}function Uo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const j8=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:bk,addClass:q,addEvent:$8,clearTextSelection:cR,closest:Wa,closestDown:Hd,empty:Ko,fastInnerHTML:_u,fastInnerText:Ba,findFirstParentWithClass:wk,getCaretPosition:RE,getCssTransform:W8,getFrameElement:pk,getMaximumScrollLeft:Ek,getMaximumScrollTop:Rk,getParent:mk,getParentWindow:au,getScrollLeft:bE,getScrollTop:Nv,getScrollableElement:Tf,getScrollbarWidth:Mn,getSelectionEndPosition:Tk,getSelectionText:F8,getStyle:Mf,getTrimmingContainer:qc,getWindowScrollLeft:Hv,getWindowScrollTop:CE,hasAccessToParentWindow:D8,hasClass:ve,hasHorizontalScrollbar:TE,hasVerticalScrollbar:EE,hasZeroHeight:Sk,index:vk,innerHeight:Fc,innerWidth:SE,isChildOf:Da,isDetached:ME,isHTMLElement:Uo,isInput:Yd,isInternalElement:zd,isOutsideInput:kv,isVisible:lu,makeElementContentEditableAndSelectItsContent:_E,matchesCSSRules:k8,observeVisibilityChangeOnce:Mk,offset:Ln,outerHeight:ln,outerWidth:Qt,overlayContainsElement:fa,removeAttribute:Mu,removeClass:we,removeContentEditableFromElementAndDeselect:PE,removeEvent:L8,removeTextNodes:yE,resetCssTransform:ug,runWithSelectedContendEditableElement:_k,selectElementIfAllowed:B8,setAttribute:be,setCaretPosition:lg,setOverlayPosition:Dv},Symbol.toStringTag,{value:"Module"}));function lt(t){return typeof t=="function"}function Pk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function U8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=Pk(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function cg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function z8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return bn(i,(u,c)=>c(u),r.apply(this,a))}}function xE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function xk(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Y8(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function bw(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const G8=Object.freeze(Object.defineProperty({__proto__:null,curry:xk,curryRight:Y8,debounce:cg,fastCall:bw,isFunction:lt,partial:xE,pipe:z8,throttle:Pk,throttleAfterHits:U8},Symbol.toStringTag,{value:"Module"}));var K8=hn,Ux=CN,q8=yn,zx=wu,X8=yv,Yx=K8([].push),J8=function(t){if(q8(t))return t;if(Ux(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?Yx(n,i):(typeof i=="number"||zx(i)==="Number"||zx(i)==="String")&&Yx(n,X8(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(Ux(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},Z8=yt,Ik=sh,Ok=tg,Q8=vn,hg=hn,Ak=Nn,Gx=yn,Kx=_0,Hk=U0,eJ=J8,tJ=M0,nJ=String,ka=Ik("JSON","stringify"),Ug=hg(/./.exec),qx=hg("".charAt),rJ=hg("".charCodeAt),iJ=hg("".replace),oJ=hg(1 .toString),sJ=/[\uD800-\uDFFF]/g,Xx=/^[\uD800-\uDBFF]$/,Jx=/^[\uDC00-\uDFFF]$/,Zx=!tJ||Ak(function(){var t=Ik("Symbol")("stringify detection");return ka([t])!=="[null]"||ka({a:t})!=="{}"||ka(Object(t))!=="{}"}),Qx=Ak(function(){return ka("\uDF06\uD834")!=='"\\udf06\\ud834"'||ka("\uDEAD")!=='"\\udead"'}),aJ=function(t,e){var n=Hk(arguments),r=eJ(e);if(!(!Gx(r)&&(t===void 0||Kx(t))))return n[1]=function(i,o){if(Gx(r)&&(o=Q8(r,this,nJ(i),o)),!Kx(o))return o},Ok(ka,null,n)},lJ=function(t,e,n){var r=qx(n,e-1),i=qx(n,e+1);return Ug(Xx,t)&&!Ug(Jx,i)||Ug(Jx,t)&&!Ug(Xx,r)?"\\u"+oJ(rJ(t,0),16):t};ka&&Z8({target:"JSON",stat:!0,arity:3,forced:Zx||Qx},{stringify:function(e,n,r){var i=Hk(arguments),o=Ok(Zx?aJ:ka,null,i);return Qx&&typeof o=="string"?iJ(o,sJ,lJ):o}});function Xc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ke(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Xc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Xc(n[0])]:e[r]=[]:e[r]=null)})),e}function Nk(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function un(t,e,n){const r=Array.isArray(n);return ke(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function dg(t,e){ke(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),dg(t[r],e[r])):t[r]=e[r]})}function Qn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function io(t){const e={};return ke(t,(n,r)=>{e[r]=n}),e}function gt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return M(n,i=>{t.MIXINS.push(i.MIXIN_NAME),ke(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let v=g;return(Array.isArray(v)||De(v))&&(v=Qn(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function $v(t,e){return JSON.stringify(t)===JSON.stringify(e)}function De(t){return Object.prototype.toString.call(t)==="[object Object]"}function es(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function ke(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Dk(t,e){const n=e.split(".");let r=t;return ke(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Op(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(an(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function Lv(t){if(!De(t))return 0;const e=function(n){let r=0;return De(n)?ke(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function an(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const uJ=Object.freeze(Object.defineProperty({__proto__:null,clone:io,createObjectPropListener:Hr,deepClone:Qn,deepExtend:dg,deepObjectSize:Lv,defineGetter:es,duckSchema:Xc,extend:un,getProperty:Dk,hasOwnProperty:an,inherit:Nk,isObject:De,isObjectEqual:$v,mixin:gt,objectEach:ke,setProperty:Op},Symbol.toStringTag,{value:"Module"}));function _f(t){return window.requestAnimationFrame(t)}function Pf(t){window.cancelAnimationFrame(t)}function IE(){return"ontouchstart"in window}function kk(){return typeof window<"u"}let Hu;function $k(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Hu||(typeof Intl=="object"?Hu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Hu=(n,r)=>`${n}`.localeCompare(r):Hu=(n,r)=>n===r?0:n>r?-1:1,Hu)}const cJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Pf,getComparisonFunction:$k,isCSR:kk,isTouchSupported:IE,requestAnimationFrame:_f},Symbol.toStringTag,{value:"Module"})),di=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Ks={chrome:di((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:di(t=>/CriOS/.test(t)),edge:di(t=>/Edge/.test(t)),edgeWebKit:di(t=>/EdgiOS/.test(t)),firefox:di(t=>/Firefox/.test(t)),firefoxWebKit:di(t=>/FxiOS/.test(t)),mobile:di(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:di((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},gh={mac:di(t=>/^Mac/.test(t)),win:di(t=>/^Win/.test(t)),linux:di(t=>/^Linux/.test(t)),ios:di(t=>/iPhone|iPad|iPod/i.test(t))};function Lk(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(Ks,n=>{let{test:r}=n;return void r(t,e)})}function Fk(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(gh,e=>{let{test:n}=e;return void n(t)})}kk()&&(Lk(),Fk());function OE(){return Ks.chrome.value}function Vk(){return Ks.chromeWebKit.value}function Ap(){return Ks.firefox.value}function Wk(){return Ks.firefoxWebKit.value}function xf(){return Ks.safari.value}function Bk(){return Ks.edge.value}function hJ(){return Ks.edgeWebKit.value}function Bo(){return Ks.mobile.value}function AE(){return gh.ios.value}function HE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&gh.mac.value}function hR(){return gh.win.value}function Sw(){return gh.mac.value}function dJ(){return gh.linux.value}const fJ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:OE,isChromeWebKit:Vk,isEdge:Bk,isEdgeWebKit:hJ,isFirefox:Ap,isFirefoxWebKit:Wk,isIOS:AE,isIpadOS:HE,isLinuxOS:dJ,isMacOS:Sw,isMobileBrowser:Bo,isSafari:xf,isWindowsOS:hR,setBrowserMeta:Lk,setPlatformMeta:Fk},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Ap()?182:174,AUDIO_MUTE:Ap()?181:173,AUDIO_UP:Ap()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},gJ=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function jk(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function NE(t){return gJ.includes(t)}function mJ(t){const e=[];return Sw()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function Uk(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function mh(t,e){const n=e.split("|");let r=!1;return M(n,i=>{if(t===de[i])return r=!0,!1}),r}const pJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:mJ,isCtrlMetaKey:Uk,isFunctionKey:NE,isKey:mh,isPrintableChar:jk},Symbol.toStringTag,{value:"Module"}));function xi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ba(t){return t.isImmediatePropagationEnabled===!1}function ja(t){return t.button===2}function Fv(t){return t.button===0}function zk(t){return t instanceof TouchEvent}function Yk(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!Uo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const wJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ba,isLeftClick:Fv,isRightClick:ja,isTouchEvent:zk,offsetRelativeTo:Yk,stopImmediatePropagation:xi},Symbol.toStringTag,{value:"Module"}));function tt(){le(console)&&console.warn(...arguments)}function DE(){le(console)&&console.error(...arguments)}const Ul=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],uC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),cC=new Map([[]]);var vJ=uh,yJ=function(t,e,n){for(var r=0,i=arguments.length>2?n:vJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},CJ=wn,bJ=function(t,e){var n=CJ[t],r=n&&n.prototype;return r&&r[e]},SJ=oo,RJ=FN,EJ=zs.f,dR=SJ("unscopables"),fR=Array.prototype;fR[dR]===void 0&&EJ(fR,dR,{configurable:!0,value:RJ(null)});var Vv=function(t){fR[dR][t]=!0},TJ=yt,MJ=hn,_J=Dr,PJ=Xf,xJ=yJ,IJ=bJ,OJ=Vv,AJ=Array,HJ=MJ(IJ("Array","sort"));TJ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&_J(e);var n=PJ(this),r=xJ(AJ,n);return HJ(r,e)}});OJ("toSorted");var NJ=yt,DJ=vn,kJ=ch,$J=Dr,LJ=Cn,FJ=Jo,VJ=ti,WJ=Ga,hC=WJ("find",TypeError);NJ({target:"Iterator",proto:!0,real:!0,forced:hC},{find:function(e){LJ(this);try{$J(e)}catch(i){VJ(this,"throw",i)}if(hC)return DJ(hC,this,e);var n=FJ(this),r=0;return kJ(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function BJ(t,e){Gk(t,e),e.add(t)}function dC(t,e,n){Gk(t,e),e.set(t,n)}function Gk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eI(t,e,n){return t.set(Rw(t,e),n),n}function $n(t,e){return t.get(Rw(t,e))}function Rw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jJ=100;var Wr=new WeakMap,yc=new WeakMap,fC=new WeakMap,gC=new WeakSet;class tI{constructor(){BJ(this,gC),dC(this,Wr,new Map),dC(this,yc,new Map),dC(this,fC,new Set),Ul.forEach(e=>Rw(gC,this,nI).call(this,e))}getHooks(e){var n;return(n=$n(Wr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};$n(Wr,this).has(e)||(Rw(gC,this,nI).call(this,e),Ul.push(e));const i=$n(Wr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=$n(fC,this).has(e);!u&&o!==0&&(u=!0,$n(fC,this).add(e)),u&&i.length>1&&$n(Wr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return $n(Wr,this).has(e)&&$n(Wr,this).get(e).length>0}remove(e,n){if(!$n(Wr,this).has(e))return!1;const r=$n(Wr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=$n(yc,this).get(e);return i.skip=!0,o+=1,o>jJ&&($n(Wr,this).set(e,r.filter(s=>!s.skip)),o=0),$n(yc,this).set(e,o),!0}return!1}destroy(){$n(Wr,this).clear(),$n(yc,this).clear(),eI(Wr,this,null),eI(yc,this,null)}}function nI(t){$n(Wr,this).set(t,[]),$n(yc,this).set(t,0)}function UJ(t,e,n){return(e=zJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zJ(t){var e=YJ(t,"string");return typeof e=="symbol"?e:e+""}function YJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const GJ=ct`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class oe{constructor(){UJ(this,"globalBucket",new tI)}static getSingleton(){return qJ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new tI),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.add(e,o,r)):(uC.has(e)&&tt(pE(GJ,{hookName:e,removedInVersion:uC.get(e)})),cC.has(e)&&tt(cC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?M(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=bw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=bw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Ul.push(e)}deregister(e){this.isRegistered(e)&&Ul.splice(Ul.indexOf(e),1)}isDeprecated(e){return cC.has(e)||uC.has(e)}isRegistered(e){return Ul.indexOf(e)>=0}getRegistered(){return Ul}}const KJ=new oe;function qJ(){return KJ}const mC=new Map;function ao(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";mC.has(t)||mC.set(t,new Map);const e=mC.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const gR=new WeakMap,{register:XJ,getItem:Kk,hasItem:qk,getNames:JJ,getValues:JRe}=ao("editors");function ZJ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},oe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Xk(t,e){let n;if(typeof t=="function")gR.get(t)||Mr(null,t),n=gR.get(t);else if(typeof t=="string")n=Kk(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Ew(t){if(typeof t=="function")return t;if(!qk(t))throw Error(`No registered editor found under "${t}" name`);return Kk(t).getConstructor()}function Mr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new ZJ(e);typeof t=="string"&&XJ(t,n),gR.set(e,n)}function QJ(t,e,n){return(e=eZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eZ(t){var e=tZ(t,"string");return typeof e=="symbol"?e:e+""}function tZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Hp=0;class Ri{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;QJ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,nZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Hp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Hp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Hp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function nZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),xi(this)},t}function rZ(){return Hp}function iZ(t,e){oZ(t,e),e.add(t)}function oZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tl(t,e,n){return(e=sZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sZ(t){var e=aZ(t,"string");return typeof e=="symbol"?e:e+""}function aZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zg=new WeakSet;class mR{constructor(e,n,r){iZ(this,zg),tl(this,"hot",void 0),tl(this,"tableMeta",void 0),tl(this,"selection",void 0),tl(this,"eventManager",void 0),tl(this,"destroyed",!1),tl(this,"activeEditor",void 0),tl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Ri(e),this.hot.addHook("afterDocumentKeyDown",i=>pC(zg,this,rI).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>pC(zg,this,rI).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>pC(zg,this,lZ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=Xk(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function rI(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ba(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!NE(n)&&!Uk(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function lZ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const iI=new WeakMap;mR.getInstance=function(t,e,n){let r=iI.get(t);return r||(r=new mR(t,e,n),iI.set(t,r)),r};function uZ(t,e){Jk(t,e),e.add(t)}function Dh(t,e,n){Jk(t,e),e.set(t,n)}function Jk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){return t.get(_s(t,e))}function kh(t,e,n){return t.set(_s(t,e),n),n}function _s(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vc=Object.freeze({CELL:"cell",MIXED:"mixed"});var pn=new WeakMap,Yg=new WeakMap,Gg=new WeakMap,Kg=new WeakMap,qg=new WeakMap,pa=new WeakSet;class cZ{constructor(e){var n=this;uZ(this,pa),Dh(this,pn,void 0),Dh(this,Yg,void 0),Dh(this,Gg,1),Dh(this,Kg,null),Dh(this,qg,new Map);const r=e.getSettings();kh(pn,this,e),kh(Yg,this,r.imeFastEdit?Vc.MIXED:Vc.CELL),bt(pn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _s(pa,n,dZ).call(n,...o)}),bt(pn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _s(pa,n,oI).call(n,...o)}),bt(pn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _s(pa,n,oI).call(n,...o)}),bt(pn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _s(pa,n,hZ).call(n,...o)})}getFocusMode(){return bt(Yg,this)}setFocusMode(e){Object.values(Vc).includes(e)?kh(Yg,this,e):tt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return bt(Gg,this)}setRefocusDelay(e){kh(Gg,this,e)}setRefocusElementGetter(e){kh(Kg,this,e)}getRefocusElement(){var e;return typeof bt(Kg,this)=="function"?bt(Kg,this).call(this):(e=bt(pn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=bt(pn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=bt(pn,this).runHooks("modifyFocusedElement",s.row,s.col,r);Uo(a)||(a=r),a&&!((o=bt(pn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):_s(pa,this,kE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bt(Gg,this);if(bt(pn,this).getSettings().imeFastEdit&&!((e=bt(pn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=bt(pn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),bt(qg,this).has(n)||bt(qg,this).set(n,cg(()=>{if(!bt(pn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),bt(qg,this).get(n)()}}}function kE(t){var e;const n=(e=bt(pn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!bt(pn,this).selection.isCellVisible(n)){t(null);return}const r=bt(pn,this).getCell(n.row,n.col,!0);r===null?bt(pn,this).addHookOnce("afterScroll",()=>{t(bt(pn,this).getCell(n.row,n.col,!0))}):t(r)}function oI(){_s(pa,this,kE).call(this,t=>{const{activeElement:e}=bt(pn,this).rootDocument;e&&kv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function hZ(){_s(pa,this,kE).call(this,t=>{this.getFocusMode()===Vc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function dZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Vc.MIXED:Vc.CELL)}var fZ=Ti,gZ=wu,mZ=oo,pZ=mZ("match"),wZ=function(t){var e;return fZ(t)&&((e=t[pZ])!==void 0?!!e:gZ(t)==="RegExp")},vZ=Cn,yZ=function(){var t=vZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},CZ=vn,bZ=Mi,SZ=Jf,RZ=yZ,sI=RegExp.prototype,EZ=function(t){var e=t.flags;return e===void 0&&!("flags"in sI)&&!bZ(t,"flags")&&SZ(sI,t)?CZ(RZ,t):e},$E=hn,TZ=ah,MZ=Math.floor,wC=$E("".charAt),_Z=$E("".replace),vC=$E("".slice),PZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,xZ=/\$([$&'`]|\d{1,2})/g,IZ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=xZ;return i!==void 0&&(i=TZ(i),l=PZ),_Z(o,l,function(u,c){var h;switch(wC(c,0)){case"$":return"$";case"&":return t;case"`":return vC(e,0,n);case"'":return vC(e,s);case"<":h=i[vC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=MZ(d/10);return f===0?u:f<=a?r[f-1]===void 0?wC(c,1):r[f-1]+wC(c,1):u}h=r[d-1]}return h===void 0?"":h})},OZ=yt,AZ=vn,LE=hn,aI=qf,HZ=yn,NZ=Ti,DZ=wZ,$h=yv,kZ=Zf,$Z=EZ,LZ=IZ,FZ=oo,VZ=FZ("replace"),WZ=TypeError,yC=LE("".indexOf);LE("".replace);var lI=LE("".slice),BZ=Math.max;OZ({target:"String",proto:!0},{replaceAll:function(e,n){var r=aI(this),i,o,s,a,l,u,c,h,d,f,g=0,v="";if(NZ(e)){if(i=DZ(e),i&&(o=$h(aI($Z(e))),!~yC(o,"g")))throw new WZ("`.replaceAll` does not allow non-global regexes");if(s=kZ(e,VZ),s)return AZ(s,e,r,n)}for(a=$h(r),l=$h(e),u=HZ(n),u||(n=$h(n)),c=l.length,h=BZ(1,c),d=yC(a,l);d!==-1;)f=u?$h(n(l,d,a)):LZ(l,a,d,[],void 0,n),v+=lI(a,g,d)+f,g=d+c,d=d+h>a.length?-1:yC(a,l,d+h);return g<a.length&&(v+=lI(a,g)),v}});var jZ=yt,UZ=ch,zZ=Dr,YZ=Cn,GZ=Jo,KZ=ti,qZ=Ga,XZ=tg,JZ=Nn,Zk=TypeError,Qk=JZ(function(){[].keys().reduce(function(){},void 0)}),CC=!Qk&&qZ("reduce",Zk);jZ({target:"Iterator",proto:!0,real:!0,forced:Qk||CC},{reduce:function(e){YZ(this);try{zZ(e)}catch(s){KZ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(CC)return XZ(CC,this,n?[e]:[e,r]);var i=GZ(this),o=0;if(UZ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new Zk("Reduce of empty iterator with no initial value");return r}});const e$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},ZZ=new RegExp(Object.keys(e$).map(t=>`(${t})`).join("|"),"gi");function QZ(t){return(t&&t.nodeName||"")==="TABLE"}function pR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let y=0;y<s;y+=1){const E=!f&&n&&y===0;let C="";if(f)C=`<th>${t.getColHeader(y-c)}</th>`;else if(E)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const P=i[d][y],{hidden:A,rowspan:_,colspan:T}=t.getCellMeta(d-h,y-c);if(!A){const H=[];if(_&&H.push(`rowspan="${_}"`),T&&H.push(`colspan="${T}"`),Yt(P))C=`<td ${H.join(" ")}></td>`;else{const G=P.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${H.join(" ")}>${G}</td>`}}}g.push(C)}const v=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function wR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Yt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function t$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const P=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,A=>{const _=A.match(/<td\b[^>]*?>/g)[0],T=/<p.*?>/g,H=A.substring(_.length,A.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(T,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${_}${H}</td>`});i.insertAdjacentHTML("afterbegin",`${P}`),o=i.querySelector("table")}if(!o||!QZ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((P,A)=>P+A.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const P=Array.from(o.tHead.rows).filter(A=>{const _=A.querySelector("td")!==null;return _&&h.push(A),!_});f=P.length,d=f>0,f>1?n.nestedHeaders=Array.from(P).reduce((A,_)=>{const T=Array.from(_.cells).reduce((H,G,U)=>{if(a&&U===0)return H;const{colSpan:V,innerHTML:X}=G,ne=V>1?{label:X,colspan:V}:X;return H.push(ne),H},[]);return A.push(T),A},[]):d&&(n.colHeaders=Array.from(P[0].children).reduce((A,_,T)=>(a&&T===0||A.push(_.innerHTML),A),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((P,A)=>(P.push(...Array.from(A.rows)),P),[]),...c];g=v.length;const y=new Array(g);for(let P=0;P<g;P++)y[P]=new Array(u);const E=[],C=[];for(let P=0;P<g;P++){const A=v[P],_=Array.from(A.cells),T=_.length;for(let H=0;H<T;H++){const G=_[H],{nodeName:U,innerHTML:V,rowSpan:X,colSpan:ne}=G,Q=y[P].findIndex(te=>te===void 0);if(U==="TD"){if(X>1||ne>1){for(let Re=P;Re<P+X;Re++)if(Re<g)for(let Ae=Q;Ae<Q+ne;Ae++)y[Re][Ae]=null;const pe=G.getAttribute("style");pe&&pe.includes("mso-ignore:colspan")||E.push({col:Q,row:P,rowspan:X,colspan:ne})}let te="";s&&/excel/gi.test(s.content)?te=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[P][Q]=te.replace(ZZ,pe=>e$[pe])}else C.push(V)}}return E.length&&(n.mergeCells=E),C.length&&(n.rowHeaders=C),y.length&&(n.data=y),n}const eQ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:wR,htmlToGridSettings:t$,instanceToHTML:pR},Symbol.toStringTag,{value:"Module"}));function Gn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function n$(t){return Gn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function vR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function FE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ye(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const tQ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ye,isNumeric:Gn,isNumericLike:n$,rangeEach:fe,rangeEachReverse:vR,valueAccordingPercent:FE},Symbol.toStringTag,{value:"Module"})),yR="asc",nQ="desc",uI=new Map([[yR,[-1,1]],[nQ,[1,-1]]]),rQ=t=>`The priority '${t}' is already declared in a map.`,iQ=t=>`The priority '${t}' is not a number.`;function oQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=lt(t)?t:rQ,e=lt(e)?e:iQ;function r(o,s){if(!Gn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yR;const[s,a]=uI.get(o)||uI.get(yR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const sQ=t=>`The id '${t}' is already declared in a map.`;function Wv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=lt(t)?t:sQ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const aQ=t=>`'${t}' value is already declared in a unique set.`;function lQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=lt(t)?t:aQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const VE=t=>`There is already registered "${t}" plugin.`,uQ=t=>`There is already registered plugin on priority "${t}".`,cQ=t=>`The priority "${t}" is not a number.`,r$=oQ({errorPriorityExists:uQ,errorPriorityNaN:cQ}),i$=lQ({errorItemExists:VE}),CR=Wv({errorIdExists:VE});function WE(){return[...r$.getItems(),...i$.getItems()]}function fg(t){const e=Zn(t);return CR.getItem(e)}function hQ(t){return!!fg(t)}function Ke(t,e,n){[t,e,n]=fQ(t,e,n),fg(t)===void 0&&dQ(t,e,n)}function dQ(t,e,n){const r=Zn(t);if(CR.hasItem(r))throw new Error(VE(r));n===void 0?i$.addItem(r):r$.addItem(n,r),CR.addItem(r,e)}function fQ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:gQ,getItem:mQ,hasItem:o$,getNames:pQ,getValues:ZRe}=ao("renderers");function Tw(t){if(typeof t=="function")return t;if(!o$(t))throw Error(`No registered renderer found under "${t}" name`);return mQ(t)}function jr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),gQ(t,e)}const{register:wQ,getItem:vQ,hasItem:s$,getNames:yQ,getValues:QRe}=ao("validators");function BE(t){if(typeof t=="function")return t;if(!s$(t))throw Error(`No registered validator found under "${t}" name`);return vQ(t)}function zl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),wQ(t,e)}var CQ=yt,bQ=ah,SQ=uh,RQ=Qf,EQ=Vv;CQ({target:"Array",proto:!0},{at:function(e){var n=bQ(this),r=SQ(n),i=RQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});EQ("at");var TQ=yt,MQ=hn,_Q=qf,PQ=Qf,xQ=yv,IQ=Nn,OQ=MQ("".charAt),AQ=IQ(function(){return"𠮷".at(-2)!=="\uD842"});TQ({target:"String",proto:!0,forced:AQ},{at:function(e){var n=xQ(_Q(this)),r=n.length,i=PQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:OQ(n,o)}});function Lh(t,e,n){return(e=HQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HQ(t){var e=NQ(t,"string");return typeof e=="symbol"?e:e+""}function NQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DQ{constructor(){Lh(this,"count",0),Lh(this,"startColumn",null),Lh(this,"endColumn",null),Lh(this,"startPosition",null),Lh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Fh(t,e,n){return(e=kQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kQ(t){var e=$Q(t,"string");return typeof e=="symbol"?e:e+""}function $Q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LQ{constructor(){Fh(this,"count",0),Fh(this,"startRow",null),Fh(this,"endRow",null),Fh(this,"startPosition",null),Fh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Vh(t,e,n){return(e=FQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FQ(t){var e=VQ(t,"string");return typeof e=="symbol"?e:e+""}function VQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a${constructor(){Vh(this,"count",0),Vh(this,"startColumn",null),Vh(this,"endColumn",null),Vh(this,"startPosition",null),Vh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Wh(t,e,n){return(e=WQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WQ(t){var e=BQ(t,"string");return typeof e=="symbol"?e:e+""}function BQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l${constructor(){Wh(this,"count",0),Wh(this,"startRow",null),Wh(this,"endRow",null),Wh(this,"startPosition",null),Wh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Bh(t,e,n){return(e=jQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jQ(t){var e=UQ(t,"string");return typeof e=="symbol"?e:e+""}function UQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zQ{constructor(){Bh(this,"count",0),Bh(this,"startColumn",0),Bh(this,"endColumn",0),Bh(this,"startPosition",0),Bh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function jh(t,e,n){return(e=YQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YQ(t){var e=GQ(t,"string");return typeof e=="symbol"?e:e+""}function GQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KQ{constructor(){jh(this,"count",0),jh(this,"startRow",0),jh(this,"endRow",0),jh(this,"startPosition",0),jh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function cI(t,e,n){return(e=qQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qQ(t){var e=XQ(t,"string");return typeof e=="symbol"?e:e+""}function XQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JQ extends a${constructor(){super(...arguments),cI(this,"columnStartOffset",0),cI(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function hI(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=QQ(t,"string");return typeof e=="symbol"?e:e+""}function QQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eee extends l${constructor(){super(...arguments),hI(this,"rowStartOffset",0),hI(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function dI(t,e,n){return(e=tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tee(t){var e=nee(t,"string");return typeof e=="symbol"?e:e+""}function nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u${constructor(e){dI(this,"calculationTypes",[]),dI(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Ai(t,e,n){return(e=ree(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ree(t){var e=iee(t,"string");return typeof e=="symbol"?e:e+""}function iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Jc=50;class oee extends u${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Ai(this,"viewportWidth",0),Ai(this,"scrollOffset",0),Ai(this,"zeroBasedScrollOffset",0),Ai(this,"totalColumns",0),Ai(this,"columnWidthFn",null),Ai(this,"columnWidth",0),Ai(this,"overrideFn",null),Ai(this,"inlineStartOffset",0),Ai(this,"totalCalculatedWidth",0),Ai(this,"startPositions",[]),Ai(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Jc:n}}function oi(t,e,n){return(e=see(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function see(t){var e=aee(t,"string");return typeof e=="symbol"?e:e+""}function aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lee extends u${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),oi(this,"viewportHeight",0),oi(this,"scrollOffset",0),oi(this,"zeroBasedScrollOffset",0),oi(this,"totalRows",0),oi(this,"rowHeightFn",null),oi(this,"rowHeight",0),oi(this,"overrideFn",null),oi(this,"horizontalScrollbarHeight",0),oi(this,"innerViewportHeight",0),oi(this,"totalCalculatedHeight",0),oi(this,"startPositions",[]),oi(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function uee(t,e,n){cee(t,e),e.set(t,n)}function cee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fI(t,e,n){return(e=hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hee(t){var e=dee(t,"string");return typeof e=="symbol"?e:e+""}function dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nu(t,e){return t.get(c$(t,e))}function gI(t,e,n){return t.set(c$(t,e),n),n}function c$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var os=new WeakMap;class uu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;fI(this,"row",null),fI(this,"col",null),uee(this,os,!1),gI(os,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Nu(os,this)}isSouthEastOf(e){return this.row>=e.row&&(Nu(os,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Nu(os,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Nu(os,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Nu(os,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof uu&&gI(os,this,e.isRtl()),this}clone(){return new uu(this.row,this.col,Nu(os,this))}toObject(){return{row:this.row,col:this.col}}}function fee(t,e,n){gee(t,e),e.set(t,n)}function gee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bC(t,e,n){return(e=mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mee(t){var e=pee(t,"string");return typeof e=="symbol"?e:e+""}function pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function si(t,e){return t.get(h$(t,e))}function wee(t,e,n){return t.set(h$(t,e),n),n}function h$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pr=new WeakMap;class gg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;bC(this,"highlight",null),bC(this,"from",null),bC(this,"to",null),fee(this,pr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),wee(pr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return si(pr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return si(pr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return si(pr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return si(pr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return si(pr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return si(pr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return si(pr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return si(pr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof uu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(si(pr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(si(pr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new gg(this.highlight,this.from,this.to,si(pr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new uu(e,n,si(pr,this))}}function ho(t,e,n){vee(t,e),e.set(t,n)}function vee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(d$(t,e))}function Zs(t,e,n){return t.set(d$(t,e),n),n}function d$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ai=new WeakMap,SC=new WeakMap,xn=new WeakMap,Du=new WeakMap,Xg=new WeakMap,Hi=new WeakMap,RC=new WeakMap,Uh=new WeakMap,nl=new WeakMap,fo=new WeakMap;let f$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ho(this,ai,void 0),ho(this,SC,void 0),ho(this,xn,void 0),ho(this,Du,void 0),ho(this,Xg,void 0),ho(this,Hi,void 0),ho(this,RC,void 0),ho(this,Uh,void 0),ho(this,nl,[null,null]),ho(this,fo,[null,null]),Zs(ai,this,r),Zs(SC,this,n),Zs(xn,this,o),Zs(Du,this,s),Zs(Xg,this,a),Zs(Hi,this,i),Zs(RC,this,e),this.registerEvents()}registerEvents(){ge(Hi,this).addEventListener(ge(xn,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(Hi,this).addEventListener(ge(xn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(Hi,this).addEventListener(ge(xn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(Hi,this).addEventListener(ge(xn,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(Hi,this).addEventListener(ge(xn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(Hi,this).addEventListener(ge(xn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(ai,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(ai,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(Hi,this).addEventListener(ge(xn,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(Hi,this).addEventListener(ge(xn,this).holder,"mousedown",r=>this.onMouseDown(r))};Bo()?e():(IE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(Uh,this)&&r){const[i,o]=[r.row,ge(Uh,this).from.row],[s,a]=[r.col,ge(Uh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(xn,this).TABLE,i=Hd(e,["TD","TH"],r);return i?(n.coords=ge(xn,this).getCoords(i),n.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(n.coords=ge(Du,this).getFocusSelection().cellRange.highlight,n.TD=ge(xn,this).getCell(n.coords)):ve(e,"wtBorder")&&ve(e,"area")&&ge(Du,this).getAreaSelection().cellRange&&(n.coords=ge(Du,this).getAreaSelection().cellRange.to,n.TD=ge(xn,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(SC,this).rootDocument.activeElement,r=xE(mk,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ve(i,"corner")?ge(ai,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(ai,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(fo,this)[0]=o.TD,clearTimeout(ge(nl,this)[0]),ge(nl,this)[0]=setTimeout(()=>{ge(fo,this)[0]=null},1e3))}onContextMenu(e){if(ge(ai,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(ai,this).has("onCellMouseOver"))return;const n=ge(xn,this).TABLE,r=Hd(e.target,["TD","TH"],n),i=ge(Xg,this)||this;r&&r!==i.lastMouseOver&&Da(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(xn,this).getCoords(r),r))}onMouseOut(e){if(!ge(ai,this).has("onCellMouseOut"))return;const n=ge(xn,this).TABLE,r=Hd(e.target,["TD","TH"],n),i=Hd(e.relatedTarget,["TD","TH"],n),o=ge(Xg,this)||this;r&&r!==i&&Da(r,n)&&(this.callListener("onCellMouseOut",e,ge(xn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(ai,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(fo,this)[0]&&n.TD===ge(fo,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(fo,this)[0]=null,ge(fo,this)[1]=null):n.TD===ge(fo,this)[0]&&(ge(fo,this)[1]=n.TD,clearTimeout(ge(nl,this)[1]),ge(nl,this)[1]=setTimeout(()=>{ge(fo,this)[1]=null},500)))}onTouchStart(e){Zs(Uh,this,ge(Du,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(ai,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];AE()&&(Vk()||Wk())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(ai,this).getSettingPure(e);o&&o(n,r,i,ge(RC,this).call(this))}destroy(){clearTimeout(ge(nl,this)[0]),clearTimeout(ge(nl,this)[1]),ge(Hi,this).destroy()}};function EC(t,e,n){return(e=yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:e+""}function Cee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bee{constructor(e,n,r){EC(this,"offset",void 0),EC(this,"total",void 0),EC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function TC(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=Ree(t,"string");return typeof e=="symbol"?e:e+""}function Ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eee{constructor(e,n,r){TC(this,"offset",void 0),TC(this,"total",void 0),TC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Jg(t,e,n){return(e=Tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tee(t){var e=Mee(t,"string");return typeof e=="symbol"?e:e+""}function Mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _ee{constructor(){Jg(this,"currentSize",0),Jg(this,"nextSize",0),Jg(this,"currentOffset",0),Jg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Pee=0,mI=1,bR=2;function MC(t,e,n){return(e=xee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xee(t){var e=Iee(t,"string");return typeof e=="symbol"?e:e+""}function Iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oee{constructor(){MC(this,"size",new _ee),MC(this,"workingSpace",Pee),MC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=mI,e.workingSpace=bR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=bR,e.workingSpace=mI,this.sharedSize=e.getViewSize()}}var pI=vv,Aee=TypeError,Hee=function(t,e){if(!delete t[e])throw new Aee("Cannot delete property "+pI(e)+" of "+pI(t))},Nee=yt,Dee=ah,kee=uh,$ee=bN,Lee=Hee,Fee=SN,Vee=[].unshift(0)!==1,Wee=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},Bee=Vee||!Wee();Nee({target:"Array",proto:!0,arity:1,forced:Bee},{unshift:function(e){var n=Dee(this),r=kee(n),i=arguments.length;if(i){Fee(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Lee(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return $ee(n,r+i)}});function jee(t,e,n){return(e=Uee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uee(t){var e=zee(t,"string");return typeof e=="symbol"?e:e+""}function zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wI{constructor(e,n){jee(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Yee(t,e,n){return(e=Gee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gee(t){var e=Kee(t,"string");return typeof e=="symbol"?e:e+""}function Kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qee{constructor(e){Yee(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new wI(o,n),l=new wI(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(bR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function ku(t,e,n){return(e=Xee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xee(t){var e=Jee(t,"string");return typeof e=="symbol"?e:e+""}function Jee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g${constructor(e,n){ku(this,"rootNode",void 0),ku(this,"nodesPool",void 0),ku(this,"sizeSet",new Oee),ku(this,"collectedNodes",[]),ku(this,"viewDiffer",new qee(this.sizeSet)),ku(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class m$ extends g${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function vI(t,e,n){return(e=Zee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zee(t){var e=Qee(t,"string");return typeof e=="symbol"?e:e+""}function Qee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ete{constructor(e){vI(this,"nodeType",void 0),vI(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function zh(t,e,n){return(e=tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tte(t){var e=nte(t,"string");return typeof e=="symbol"?e:e+""}function nte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mg{constructor(e,n){zh(this,"nodesPool",null),zh(this,"nodeType",void 0),zh(this,"rootNode",void 0),zh(this,"table",null),zh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new ete(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function yI(t,e,n){return(e=rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ite(t,"string");return typeof e=="symbol"?e:e+""}function ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ote extends mg{constructor(){super("TH"),yI(this,"orderViews",new WeakMap),yI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new m$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Mu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(d,[g8(),R8(),wE(h+1),Eu(-1)]),n[h](a,d,h)}u.end()}}}class ste extends mg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Ko(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&be(this.rootNode,[uk()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&be(s,[uR(),fk(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Mu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(u,[wE(a+1+this.table.rowHeadersCount),Eu(-1),m8(),...a>=0?[S8()]:[uR()]]),r[n](l,u,n)}}}}let CI=!1;class ate extends mg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!CI&&e>1e3&&(CI=!0,tt(ct`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function lte(t,e,n){return(e=ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ute(t){var e=cte(t,"string");return typeof e=="symbol"?e:e+""}function cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $u={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let bI=!1;class hte extends mg{constructor(e){super("TR",e),lte(this,"orderView",void 0),this.orderView=new g$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!bI&&e>1e3&&(bI=!0,tt(ct`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&be(this.rootNode,[uk()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;be(o,[uR(),fk(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ve(o,$u.rowEven)||(we(o,$u.rowOdd),q(o,$u.rowEven)):ve(o,$u.rowOdd)||(we(o,$u.rowEven),q(o,$u.rowOdd))}this.orderView.end()}}function SI(t,e,n){return(e=dte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dte(t){var e=fte(t,"string");return typeof e=="symbol"?e:e+""}function fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gte extends mg{constructor(){super("TD"),SI(this,"orderViews",new WeakMap),SI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new m$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(ve(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Mu(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;be(g,[...g.hasAttribute("role")?[]:[f8()],Eu(-1),wE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function gn(t,e,n){return(e=mte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mte(t){var e=pte(t,"string");return typeof e=="symbol"?e:e+""}function pte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wte{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gn(this,"rootNode",void 0),gn(this,"rootDocument",void 0),gn(this,"rowHeaders",null),gn(this,"columnHeaders",null),gn(this,"colGroup",null),gn(this,"rows",null),gn(this,"cells",null),gn(this,"rowFilter",null),gn(this,"columnFilter",null),gn(this,"rowUtils",null),gn(this,"columnUtils",null),gn(this,"rowsToRender",0),gn(this,"columnsToRender",0),gn(this,"rowHeaderFunctions",[]),gn(this,"rowHeadersCount",0),gn(this,"columnHeaderFunctions",[]),gn(this,"columnHeadersCount",0),gn(this,"cellRenderer",void 0),gn(this,"activeOverlayName",void 0),gn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class vte{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new wte(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new ote,columnHeaders:new ste(n),colGroup:new ate(r),rows:new hte(i),cells:new gte}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function _C(t,e,n){return(e=yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yte(t){var e=Cte(t,"string");return typeof e=="symbol"?e:e+""}function Cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bte{constructor(e,n){_C(this,"dataAccessObject",void 0),_C(this,"wtSettings",void 0),_C(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function RI(t,e,n){return(e=Ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ste(t){var e=Rte(t,"string");return typeof e=="symbol"?e:e+""}function Rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ete{constructor(e,n){RI(this,"dataAccessObject",void 0),RI(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function go(t,e,n){return(e=Tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ph{constructor(e,n,r,i,o){go(this,"wtSettings",null),go(this,"domBindings",void 0),go(this,"TBODY",null),go(this,"THEAD",null),go(this,"COLGROUP",null),go(this,"hasTableHeight",!0),go(this,"hasTableWidth",!0),go(this,"isTableVisible",!1),go(this,"tableOffset",0),go(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,yE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Ete(this.dataAccessObject,this.wtSettings),this.columnUtils=new bte(this.dataAccessObject,this.wtSettings),this.tableRenderer=new vte({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&be(r,[As()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[As()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",be(r,[Eu(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&be(r.parentNode,[As()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[As()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Ln(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Ln(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Eee(f,o,c),this.columnFilter=new bee(g,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),v=y.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Lo)||this.is($a))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Lo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Lo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Fc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Lo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Wa(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=vk(r),s=n.cellIndex;fa(du,n,this.wtRootElement)||fa(cu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):fa($a,n,this.wtRootElement)||fa(Lo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),fa(du,n,this.wtRootElement)||fa(hu,n,this.wtRootElement)||fa($a,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=Fc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?ln:Fc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Qt(this.TABLE)}getHeight(){return ln(this.TABLE)}getTotalWidth(){const e=Qt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=ln(this.hider);return e!==0?e:this.getHeight()}isVisible(){return lu(this.TABLE)}_modifyRowHeaderWidth(e){let n=lt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const _te="stickyRowsBottom",jE={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};es(jE,"MIXIN_NAME",_te,{writable:!1,enumerable:!1});const Pte="stickyColumnsStart",Bv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};es(Bv,"MIXIN_NAME",Pte,{writable:!1,enumerable:!1});class UE extends ph{constructor(e,n,r,i){super(e,n,r,i,$a)}}gt(UE,jE);gt(UE,Bv);const cu="top",Lo="bottom",hu="inline_start",du="top_inline_start_corner",$a="bottom_inline_start_corner",p$=[cu,Lo,hu,du,$a],xte=new Map([[cu,`ht_clone_${cu}`],[Lo,`ht_clone_${Lo}`],[hu,`ht_clone_${hu} ht_clone_left`],[du,`ht_clone_${du} ht_clone_top_left_corner`],[$a,`ht_clone_${$a} ht_clone_bottom_left_corner`]]);function Ite(t,e){Ote(t,e),e.add(t)}function Ote(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ate(t,e,n){return(e=Hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hte(t){var e=Nte(t,"string");return typeof e=="symbol"?e:e+""}function Nte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yh=new WeakSet;class Dte{constructor(e){Ite(this,Yh),Ate(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Zg(Yh,this,TI).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Zg(Yh,this,TI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Zg(Yh,this,EI).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Zg(Yh,this,EI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function EI(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Ln(r.wtRootElement).left;const u=Math.abs(bE(s,s));if(l>u){const c=SE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function TI(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Ln(n.wtRootElement),a=Nv(o,o);if(s.top>a){const l=Fc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function li(t,e,n){return(e=kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kte(t){var e=$te(t,"string");return typeof e=="symbol"?e:e+""}function $te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zE{get eventManager(){return new Ri(this)}constructor(e,n){li(this,"wtTable",void 0),li(this,"wtScroll",void 0),li(this,"wtViewport",void 0),li(this,"wtOverlays",void 0),li(this,"selectionManager",void 0),li(this,"wtEvent",void 0),li(this,"guid",`wt_${gE()}`),li(this,"drawInterrupted",!1),li(this,"drawn",!1),li(this,"activeOverlayName","master"),li(this,"domBindings",void 0),li(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Dte(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Ba(r,e[n])}])}}createCellCoords(e,n){return new uu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new gg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||Sk(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function MI(t,e,n){return(e=Lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lte(t){var e=Fte(t,"string");return typeof e=="symbol"?e:e+""}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vte extends zE{constructor(e,n,r){super(e,n),MI(this,"cloneSource",void 0),MI(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new f$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function Wte(t,e,n){return(e=Bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bte(t){var e=jte(t,"string");return typeof e=="symbol"?e:e+""}function jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pg{constructor(e,n,r,i,o){Wte(this,"wtSettings",null),es(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=qc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=qc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Tf(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){tt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Mn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(p$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${xte.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&be(o,[As()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===cu||u==="vertical"&&this.type===hu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Tf(e.TABLE),new Vte(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Ute extends pg{constructor(e,n,r,i,o,s){super(e,n,$a,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new UE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else ug(n),this.repositionOverlay();let r=ln(this.clone.wtTable.TABLE);const i=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Mn(r)),i.style.bottom=`${o}px`}}const zte="calculatedColumns",jv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};es(jv,"MIXIN_NAME",zte,{writable:!1,enumerable:!1});class YE extends ph{constructor(e,n,r,i){super(e,n,r,i,Lo)}}gt(YE,jE);gt(YE,jv);function Yte(t,e,n){return(e=Gte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:e+""}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qte extends pg{constructor(e,n,r,i){super(e,n,Lo,r,i),Yte(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new YE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Mn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Hv(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Mn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=ln(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Mn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Nv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(we(s,"innerBorderBottom"),o=a)}return o}}const Xte="calculatedRows",GE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};es(GE,"MIXIN_NAME",Xte,{writable:!1,enumerable:!1});class KE extends ph{constructor(e,n,r,i){super(e,n,r,i,hu)}}gt(KE,GE);gt(KE,Bv);const Jte="localHooks",Fn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)bw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};es(Fn,"MIXIN_NAME",Jte,{writable:!1,enumerable:!1});let w$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};gt(w$,Fn);const v$="active-header",qE="header",XE="area",Gd="focus",Zte="fill",Qte="row",ene="column",tne="custom-selection",JE=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var nne=Vv;nne("flat");function rne(t,e){y$(t,e),e.add(t)}function _I(t,e,n){y$(t,e),e.set(t,n)}function y$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e){return t.get(Kd(t,e))}function PI(t,e,n){return t.set(Kd(t,e),n),n}function Kd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fi=new WeakMap,Un=new WeakMap,Qg=new WeakSet;class ine{constructor(){rne(this,Qg),_I(this,Fi,void 0),_I(this,Un,void 0)}setActiveOverlay(e){return PI(Un,this,e),this}setActiveSelection(e){return PI(Fi,this,e),this}scan(){const e=Bt(Fi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Bt(Fi,this).getCorners(),{wtTable:s}=Bt(Un,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const v=Bt(Un,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Bt(Fi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==h&&(g=s.getColumnHeader(v,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Bt(Fi,this).getCorners(),{wtTable:s}=Bt(Un,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const v=Bt(Un,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Bt(Fi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(g=s.getRowHeader(v,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Bt(Un,this);Kd(Qg,this,one).call(this,(r,i)=>{const o=n.getCell(Bt(Un,this).createCellCoords(r,i)),s=Bt(Un,this).getSetting("onAfterDrawSelection",r,i,Bt(Fi,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Bt(Fi,this).getCorners(),{wtTable:i}=Bt(Un,this);Kd(Qg,this,xI).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Bt(Un,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Bt(Fi,this).getCorners(),{wtTable:i}=Bt(Un,this);Kd(Qg,this,xI).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Bt(Un,this).createCellCoords(o,s));e(a)}})}}function one(t){let[e,n,r,i]=Bt(Fi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Bt(Un,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Bt(Un,this).createCellCoords(e,n));if(!Uo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function xI(t){const{wtTable:e}=Bt(Un,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class II{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=JE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),xi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Bo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};ke(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};ke(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),y-g-f*2),P=Math.min(parseInt(i+o-v/4,10),y-v-f*2);h[l]=`${C}px`,d[l]=`${P}px`;const A=Math.min(parseInt(r+s,10),E-g-f*2),_=Math.min(parseInt(r+s-v/4,10),E-v-f*2);h.top=`${A}px`,d.top=`${_}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!Uo(g)){this.disappear();return}const v=u?s.getCell(this.wot.createCellCoords(i,o)):g,y=Ln(g),E=u?Ln(v):y,C=Ln(s.TABLE),P=y.top,A=y.left,_=this.wot.wtSettings.getSetting("rtlMode");let T=0,H=0;if(_){const Re=Qt(s.TABLE),Ae=Qt(g),ot=l.innerWidth-C.left-Re;H=A+Ae-E.left,T=l.innerWidth-A-Ae-ot-1}else H=E.left+Qt(v)-A,T=A-C.left-1;if(this.isEntireColumnSelected(n,i)){const Re=n,Ae=this.getDimensionsFromHeader("columns",r,o,Re,C);let ot=null;Ae&&([ot,T,H]=Ae),ot&&(g=ot)}let G=P-C.top-1,U=E.top+ln(v)-P;if(this.isEntireRowSelected(r,o)){const Re=r,Ae=this.getDimensionsFromHeader("rows",n,i,Re,C);let ot=null;Ae&&([ot,G,U]=Ae),ot&&(g=ot)}const V=l.getComputedStyle(g);parseInt(V.borderTopWidth,10)>0&&(G+=1,U=U>0?U-1:0),parseInt(V[_?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,H=H>0?H-1:0);const X=_?"right":"left";this.topStyle.top=`${G}px`,this.topStyle[X]=`${T}px`,this.topStyle.width=`${H}px`,this.topStyle.display="block",this.startStyle.top=`${G}px`,this.startStyle[X]=`${T}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${G+U-ne}px`,this.bottomStyle[X]=`${T}px`,this.bottomStyle.width=`${H}px`,this.bottomStyle.display="block",this.endStyle.top=`${G}px`,this.endStyle[X]=`${T+H-ne}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let Q=this.settings.border.cornerVisible;Q=typeof Q=="function"?Q(this.settings.layerLevel):Q;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[pe,et]=[i,o];if(te&&Array.isArray(te)&&([,,pe,et]=te),Bo()||!Q||this.isPartRange(pe,et))this.cornerStyle.display="none";else{this.cornerStyle.top=`${G+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[X]=`${T+H+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Re=qc(s.TABLE);const Ae=Re===l;Ae&&(Re=a.documentElement);const ot=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,_n=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),st=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ae?v.getBoundingClientRect().left:v.offsetLeft;let w=!1,p=0;_?(p=m-parseInt(this.cornerDefaultStyle.width,10)/2,w=p<0):(p=m+Qt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,w=p>=SE(Re)),w&&(this.cornerStyle[X]=`${Math.floor(T+H+this.cornerCenterPointOffset-_n-ot)}px`,this.cornerStyle[_?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const p=(Ae?v.getBoundingClientRect().top:v.offsetTop)+ln(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=Fc(Re),I=this.wot.stylesHandler.isClassicTheme();if(p){const L=Math.floor(G+U+this.cornerCenterPointOffset-st-ot);I?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}Bo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,G,T,H,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return ln(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Qt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(g=l(n,y-i),v=l(r,y-i),!g||!v)return!1;const E=Ln(g),C=Ln(v);return g&&v&&(h=E[f]-o[f]-1,d=C[f]+u(v)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(ve(this[e],"hidden")&&we(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):we(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Bo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function sne(t,e){C$(t,e),e.add(t)}function Lu(t,e,n){C$(t,e),e.set(t,n)}function C$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(ZE(t,e))}function OI(t,e,n){return t.set(ZE(t,e),n),n}function ZE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zn=new WeakMap,_r=new WeakMap,PC=new WeakMap,Nd=new WeakMap,xC=new WeakMap,rl=new WeakMap,AI=new WeakSet;class ane{constructor(e){sne(this,AI),Lu(this,zn,void 0),Lu(this,_r,void 0),Lu(this,PC,new ine),Lu(this,Nd,new WeakMap),Lu(this,xC,new WeakSet),Lu(this,rl,new Map),OI(_r,this,e)}setActiveOverlay(e){return OI(zn,this,e),$e(PC,this).setActiveOverlay($e(zn,this)),$e(Nd,this).has($e(zn,this))||$e(Nd,this).set($e(zn,this),new Set),this}getFocusSelection(){return $e(_r,this)!==null?$e(_r,this).getFocus():null}getAreaSelection(){return $e(_r,this)!==null?$e(_r,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if($e(rl,this).has(e)){const r=$e(rl,this).get(e);if(r.has($e(zn,this)))return r.get($e(zn,this));const i=new II($e(zn,this),e.settings);return r.set($e(zn,this),i),i}const n=new II($e(zn,this),e.settings);return $e(rl,this).set(e,new Map([[$e(zn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=$e(rl,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){$e(rl,this).get(e).forEach(n=>n.destroy()),$e(rl,this).delete(e)}render(e){if($e(_r,this)===null)return;e&&ZE(AI,this,lne).call(this);const n=Array.from($e(_r,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;$e(xC,this).has(s)||($e(xC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&$e(PC,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const v=r.get(g);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();$e(zn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>$e(Nd,this).get($e(zn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=$e(_r,this).options)===null||a===void 0?void 0:a.cellAttributes)&&be(s,$e(_r,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{be(o,[...i.get(o)])})}}function lne(){const t=$e(Nd,this).get($e(zn,this)),e=$e(zn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=$e(zn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=$e(_r,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=$e(_r,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=$e(_r,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...$e(_r,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)we(o[a],n),Mu(o[a],s)}),t.clear()}class une extends pg{constructor(e,n,r,i){super(e,n,hu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new KE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Dv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),ug(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,CE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Mn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Qt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=JE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Mn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Ek(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(bE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?we(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(we(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const cne="stickyRowsTop",QE={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};es(QE,"MIXIN_NAME",cne,{writable:!1,enumerable:!1});class eT extends ph{constructor(e,n,r,i){super(e,n,r,i,du)}}gt(eT,QE);gt(eT,Bv);function HI(t,e,n){return(e=hne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hne(t){var e=dne(t,"string");return typeof e=="symbol"?e:e+""}function dne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fne extends pg{constructor(e,n,r,i,o,s){super(e,n,du,r,i),HI(this,"topOverlay",void 0),HI(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new eT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Dv(e,`${i}px`,`${o}px`)}else ug(e);let n=ln(this.clone.wtTable.TABLE);const r=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class tT extends ph{constructor(e,n,r,i){super(e,n,r,i,cu)}}gt(tT,QE);gt(tT,jv);function gne(t,e,n){return(e=mne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mne(t){var e=pne(t,"string");return typeof e=="symbol"?e:e+""}function pne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wne extends pg{constructor(e,n,r,i){super(e,n,cu,r,i),gne(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new tT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Dv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),ug(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Hv(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Mn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=ln(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=JE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=Mn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Rk(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Nv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?we(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(we(i,"innerBorderTop"),a=h)}}return a}}function em(t,e,n){vne(t,e),e.set(t,n)}function vne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ss(t,e,n){return(e=yne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yne(t){var e=Cne(t,"string");return typeof e=="symbol"?e:e+""}function Cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function il(t,e,n){return t.set(b$(t,e),n),n}function as(t,e){return t.get(b$(t,e))}function b$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fu=new WeakMap,tm=new WeakMap,Vu=new WeakMap,nm=new WeakMap;class bne{constructor(e,n,r,i,o,s){ss(this,"wot",null),em(this,Fu,[]),ss(this,"topOverlay",null),ss(this,"bottomOverlay",null),ss(this,"inlineStartOverlay",null),ss(this,"topInlineStartCornerOverlay",null),ss(this,"bottomInlineStartCornerOverlay",null),ss(this,"browserLineHeight",void 0),ss(this,"wtSettings",null),em(this,tm,!1),em(this,Vu,0),em(this,nm,null),ss(this,"resizeObserver",new ResizeObserver(c=>{_f(()=>{!Array.isArray(c)||!c.length||(il(Vu,this,as(Vu,this)+1),as(Vu,this)===100&&(tt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),as(nm,this)!==null&&clearTimeout(as(nm,this)),il(nm,this,setTimeout(()=>{il(Vu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Mn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Tf(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...as(Fu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new wne(...e),this.bottomOverlay=new qte(...e),this.inlineStartOverlay=new une(...e),this.topInlineStartCornerOverlay=new fne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Ute(...e,this.bottomOverlay,this.inlineStartOverlay),il(Fu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){il(tm,this,as(Fu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),as(Fu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),as(Fu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!OE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{_f(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{il(Vu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=mh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!as(tm,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),il(tm,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Tf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),v=f()?1:0,y=g()?1:0;d.width=`${c+y}px`,d.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return M(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];M(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function NI(t,e,n){return(e=Sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sne(t){var e=Rne(t,"string");return typeof e=="symbol"?e:e+""}function Rne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ene{constructor(e){NI(this,"settings",{}),NI(this,"defaults",Object.freeze(this.getDefaults())),ke(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Ba(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?ke(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class nT extends ph{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=qc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Mf(e,"height",n),o=Mf(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=lu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}gt(nT,GE);gt(nT,jv);class Tne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new KQ:new eee],["fullyVisible",()=>new LQ],["partiallyVisible",()=>new l$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new zQ:new JQ],["fullyVisible",()=>new DQ],["partiallyVisible",()=>new a$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=ln(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Ln(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ln(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Qt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Mn(this.domBindings.rootDocument),new lee({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Mn(this.domBindings.rootDocument)),new oee({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){ke(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function Mne(t,e){S$(t,e),e.add(t)}function ol(t,e,n){S$(t,e),e.set(t,n)}function S$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function It(t,e){return t.get(Ki(t,e))}function Gi(t,e,n){return t.set(Ki(t,e),n),n}function Ki(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DI=23;var _o=new WeakMap,Ps=new WeakMap,rT=new WeakMap,SR=new WeakMap,ga=new WeakMap,Dd=new WeakMap,If=new WeakMap,Io=new WeakSet;class _ne{constructor(e){Mne(this,Io),ol(this,_o,void 0),ol(this,Ps,void 0),ol(this,rT,void 0),ol(this,SR,void 0),ol(this,ga,!0),ol(this,Dd,{}),ol(this,If,{}),Gi(Ps,this,e.rootTable.parentElement.parentElement),Gi(SR,this,e.rootDocument)}isClassicTheme(){return It(ga,this)}getCSSVariableValue(e){var n;if(It(ga,this))return null;if(It(Dd,this)[`--ht-${e}`])return It(Dd,this)[`--ht-${e}`];const r=(n=Ki(Io,this,One).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Ki(Io,this,R$).call(this,`--ht-${e}`);if(r!==null)return It(Dd,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=It(If,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(It(ga,this))return DI;const e=Ki(Io,this,Pne).call(this);return!e&&ve(It(Ps,this),"ht-wrapper")?(tt(`The "${It(_o,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Gi(ga,this,!0),this.useTheme(),DI):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Ki(Io,this,kI).call(this),Gi(ga,this,!0),Gi(_o,this,e||void 0);return}e&&e!==It(_o,this)&&(It(_o,this)&&Ki(Io,this,Ane).call(this),Gi(_o,this,e),Gi(ga,this,!1),Ki(Io,this,xne).call(this),Ki(Io,this,kI).call(this))}getThemeName(){return It(_o,this)}removeClassNames(){ve(It(Ps,this),It(_o,this))&&we(It(Ps,this),It(_o,this))}}function Pne(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function xne(){we(It(Ps,this),/ht-theme-.*/g),q(It(Ps,this),It(_o,this))}function kI(){this.isClassicTheme()||Gi(rT,this,getComputedStyle(It(Ps,this)));const t=Ki(Io,this,Ine).call(this,["box-sizing","border-bottom-width"]);It(If,this).td={...It(If,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Ine(t){const e=It(SR,this),n=It(Ps,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function One(t){const e=Math.ceil(parseFloat(Ki(Io,this,R$).call(this,t)));return Number.isNaN(e)?null:e}function R$(t){const e=It(rT,this).getPropertyValue(t);return e===""?null:e}function Ane(){Gi(If,this,{}),Gi(Dd,this,{}),Gi(ga,this,!0)}class Hne extends zE{constructor(e,n){super(e,new Ene(n)),this.stylesHandler=new _ne(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new nT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Tne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new ane(this.wtSettings.getSetting("selections")),this.wtEvent=new f$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new bne(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];ke(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),we(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!p$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class iT{constructor(e){e instanceof zE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new iT(n);return()=>r},this._wot=new Hne(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function $I(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Nne(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const Dne=new Map([["mousedown",$I],["mouseover",Nne],["touchstart",$I]]);function LI(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;Dne.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Fv(t)||t.type==="touchstart",isRightClick:ja(t)})}const E$=new WeakMap,oT=Symbol("rootInstance");function kne(t){E$.set(t,!0)}function $ne(t){return t===oT}function Np(t){return E$.has(t)}function Lne(t,e){T$(t,e),e.add(t)}function Qs(t,e,n){T$(t,e),e.set(t,n)}function T$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ea(t,e,n){return(e=Fne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fne(t){var e=Vne(t,"string");return typeof e=="symbol"?e:e+""}function Vne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nn(t,e){return t.get(Wc(t,e))}function wr(t,e,n){return t.set(Wc(t,e),n),n}function Wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var IC=new WeakMap,rm=new WeakMap,im=new WeakMap,ls=new WeakMap,Ni=new WeakMap,OC=new WeakMap,AC=new WeakMap,Wu=new WeakMap,kd=new WeakSet;class Wne{constructor(e){Lne(this,kd),ea(this,"hot",void 0),ea(this,"eventManager",void 0),ea(this,"settings",void 0),ea(this,"THEAD",void 0),ea(this,"TBODY",void 0),ea(this,"_wt",void 0),ea(this,"activeWt",void 0),Qs(this,IC,0),Qs(this,rm,0),ea(this,"postponedAdjustElementsSize",!1),Qs(this,im,!1),Qs(this,ls,void 0),Qs(this,Ni,void 0),Qs(this,OC,0),Qs(this,AC,0),Qs(this,Wu,null),this.hot=e,this.eventManager=new Ri(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Wc(kd,this,jne).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),wr(Ni,this,n.createElement("TABLE")),q(nn(Ni,this),"htCore"),this.hot.getSettings().tableClassName&&q(nn(Ni,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(be(nn(Ni,this),[As()]),be(e,[d8(),dk(-1),Av(this.hot.countCols()),M8()])),this.THEAD=n.createElement("THEAD"),nn(Ni,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),nn(Ni,this).appendChild(this.TBODY),this.hot.table=nn(Ni,this),this.hot.container.insertBefore(nn(Ni,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{wr(im,this,!0),this.isTextSelectionAllowed(a.target)||(cR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{wr(im,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{nn(im,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&cR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&Fv(a)&&r.finish(),wr(ls,this,!1);const l=kv(n.activeElement);Yd(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!ja(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&ja(a)&&(r.finish(),wr(ls,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),wr(ls,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(nn(ls,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=Mn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=au(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=au(s);this.eventManager.addEventListener(nn(Ni,this),"selectstart",a=>{this.settings.fragmentSelection||Yd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&we(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:nn(Ni,this),isDataViewInstance:()=>Np(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),wr(rm,this,o.length),this.hot.getSettings().ariaTags&&Wc(kd,this,M$).call(this)===this.hot.countCols()&&Wc(kd,this,Bne).call(this,nn(rm,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),wr(IC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,v,f),this.hot.runHooks("afterRenderer",a,l,u,g,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&lu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,wr(ls,this,!0),wr(Wu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ba(o)&&(LI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,wr(ls,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ba(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ba(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ba(o)&&(nn(ls,this)&&(!nn(Wu,this)||nn(Wu,this).x!==o.clientX||nn(Wu,this).y!==o.clientY)&&LI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,wr(Wu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ba(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,v,y,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new iT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Yd(e))return!0;const n=Da(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return nn(ls,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ve(r,"relative")){Ko(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(Ko(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(be(a,...As()),be(l,...As())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?_u(e,r(n,i)):(Ba(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){wr(OC,this,e),wr(AC,this,n)}getLastSize(){return{width:nn(OC,this),height:nn(AC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return nn(IC,this)}getRowHeadersCount(){return nn(rm,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function M$(){return parseInt(this.hot.rootElement.getAttribute(Av()[0]),10)}function Bne(t){const e=Wc(kd,this,M$).call(this)+t;be(this.hot.rootElement,...Av(e))}function jne(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):we(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):we(t,"htHasScrollX")}var Une=yt,zne=vn,Yne=ch,Gne=Dr,Kne=Cn,qne=Jo,Xne=ti,Jne=Ga,HC=Jne("every",TypeError);Une({target:"Iterator",proto:!0,real:!0,forced:HC},{every:function(e){Kne(this);try{Gne(e)}catch(i){Xne(this,"throw",i)}if(HC)return zne(HC,this,e);var n=qne(this),r=0;return!Yne(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const _$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",RR=_$.length;function Uv(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%RR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/RR,10);return n}function Zne(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=RR**r*(_$.indexOf(t[n])+1);return e-=1,e}function Qne(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Uv(i)+(r+1));n.push(o)}return n}function ere(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Uv(i)+(r+1);n.push(o)}return n}function tre(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function sT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function aT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&De(t[0])&&(e=Lv(t[0]))),e}function P$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function x$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const nre=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:aT,createEmptySpreadsheetData:tre,createSpreadsheetData:Qne,createSpreadsheetObjectData:ere,dataRowToChangesArray:sT,isArrayOfArrays:P$,isArrayOfObjects:x$,spreadsheetColumnIndex:Zne,spreadsheetColumnLabel:Uv},Symbol.toStringTag,{value:"Module"}));function Gh(t,e,n){return(e=rre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rre(t){var e=ire(t,"string");return typeof e=="symbol"?e:e+""}function ire(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ore{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Gh(this,"hot",void 0),Gh(this,"data",void 0),Gh(this,"dataType","array"),Gh(this,"colToProp",()=>{}),Gh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return M(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(De(a)||lt(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Op(l,d,f):l[d]=f}})}else ke(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Op(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Hr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Op(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Dk(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Hr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return aT(this.data)}destroy(){this.data=null,this.hot=null}}var sre=yt,are=vn,lre=ch,ure=Dr,cre=Cn,hre=Jo,dre=ti,fre=Ga,NC=fre("some",TypeError);sre({target:"Iterator",proto:!0,real:!0,forced:NC},{some:function(e){cre(this);try{ure(e)}catch(i){dre(this,"throw",i)}if(NC)return are(NC,this,e);var n=hre(this),r=0;return lre(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function FI(t,e,n){return(e=gre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gre(t){var e=mre(t,"string");return typeof e=="symbol"?e:e+""}function mre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;FI(this,"indexedValues",[]),FI(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,lt(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}gt(Pu,Fn);function lT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>lt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function uT(t,e){return Va(t,(n,r)=>e.includes(r)===!1)}class Ka extends Pu{insert(e,n){this.indexedValues=lT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=uT(this.indexedValues,e),super.remove(e)}}class zv extends Ka{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return bn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function cT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Of(t,e){return Va(t,n=>e.includes(n)===!1)}function hT(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function dT(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function pre(t,e,n){return(e=wre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wre(t){var e=vre(t,"string");return typeof e=="symbol"?e:e+""}function vre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yv extends Pu{constructor(){super(...arguments),pre(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Of(this.orderOfIndexes,[e]),lt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=lT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=dT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=uT(this.indexedValues,e),this.orderOfIndexes=Of(this.orderOfIndexes,e),this.orderOfIndexes=hT(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class wg extends Ka{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return bn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const VI=new Map([["indexesSequence",{getListWithInsertedItems:cT,getListWithRemovedItems:Of}],["physicallyIndexed",{getListWithInsertedItems:lT,getListWithRemovedItems:uT}]]),I$=t=>{if(VI.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return VI.get(t)};class O$ extends Pu{constructor(){super(e=>e)}insert(e,n){const r=dT(this.indexedValues,n);this.indexedValues=cT(r,e,n),super.insert(e,n)}remove(e){const n=Of(this.indexedValues,e);this.indexedValues=hT(n,e),super.remove(e)}}const WI=new Map([["hiding",zv],["index",Pu],["linkedPhysicalIndexToValue",Yv],["physicalIndexToValue",Ka],["trimming",wg]]);function yre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!WI.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(WI.get(t))(e)}function Cre(t,e,n){return(e=bre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bre(t){var e=Sre(t,"string");return typeof e=="symbol"?e:e+""}function Sre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let ER=0;class fT{constructor(){Cre(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),ER+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),ER-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ht(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}gt(fT,Fn);function Rre(){return ER}function DC(t,e,n){return(e=Ere(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ere(t){var e=Tre(t,"string");return typeof e=="symbol"?e:e+""}function Tre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BI extends fT{constructor(e,n){super(),DC(this,"mergedValuesCache",[]),DC(this,"aggregationFunction",void 0),DC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Mre(t,e,n){_re(t,e),e.set(t,n)}function _re(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pre(t,e,n){return t.set(A$(t,e),n),n}function xre(t,e){return t.get(A$(t,e))}function A$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kC=new WeakMap;class H${constructor(){Mre(this,kC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(xre(kC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Pre(kC,this,e)}}gt(H$,Fn);function jI(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Kh(t,e,n){Ire(t,e),e.set(t,n)}function Ire(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ui(t,e){return t.get(N$(t,e))}function om(t,e,n){return t.set(N$(t,e),n),n}function N$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sm=new WeakMap,qh=new WeakMap,am=new WeakMap,lm=new WeakMap,um=new WeakMap;class Ore{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Kh(this,sm,new Set),Kh(this,qh,[]),Kh(this,am,[]),Kh(this,lm,!1),Kh(this,um,!1),om(um,this,e??!1)}createObserver(){const e=new H$;return ui(sm,this).add(e),e.addLocalHook("unsubscribe",()=>{ui(sm,this).delete(e)}),e._writeInitialChanges(jI(ui(qh,this),ui(am,this))),e}emit(e){let n=ui(am,this);(!ui(lm,this)||ui(qh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(ui(um,this)):om(qh,this,new Array(e.length).fill(ui(um,this))),ui(lm,this)||(om(lm,this,!0),n=ui(qh,this)));const r=jI(n,e);ui(sm,this).forEach(i=>i._write(r)),om(am,this,e)}}function nr(t,e,n){return(e=Are(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Are(t){var e=Hre(t,"string");return typeof e=="symbol"?e:e+""}function Hre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TR{constructor(){nr(this,"indexesSequence",new O$),nr(this,"trimmingMapsCollection",new BI(e=>e.some(n=>n===!0),!1)),nr(this,"hidingMapsCollection",new BI(e=>e.some(n=>n===!0),!1)),nr(this,"variousMapsCollection",new fT),nr(this,"hidingChangesObservable",new Ore({initialIndexValue:!1})),nr(this,"notTrimmedIndexesCache",[]),nr(this,"notHiddenIndexesCache",[]),nr(this,"isBatched",!1),nr(this,"indexesSequenceChanged",!1),nr(this,"indexesChangeSource",void 0),nr(this,"trimmedIndexesChanged",!1),nr(this,"hiddenIndexesChanged",!1),nr(this,"renderablePhysicalIndexesCache",[]),nr(this,"fromPhysicalToVisualIndexesCache",new Map),nr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,yre(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof wg?this.trimmingMapsCollection.register(e,n):n instanceof zv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Of(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(cT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}gt(TR,Fn);function Nre(t,e){return ke(e,(n,r)=>{Ht(t[r])&&(t[r]=n)}),t}function D$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function k$(t){le(t)&&DE(ct`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Dre(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:kre,getValues:$re}=ao("phraseFormatters");function Lre(t,e){kre(t,e)}function Fre(){return $re()}Lre("pluralize",Dre);const $$="ContextMenu:items",Ie=$$,gT=`${Ie}.noItems`,mT=`${Ie}.insertRowAbove`,pT=`${Ie}.insertRowBelow`,wT=`${Ie}.insertColumnOnTheLeft`,vT=`${Ie}.insertColumnOnTheRight`,yT=`${Ie}.removeRow`,CT=`${Ie}.removeColumn`,bT=`${Ie}.undo`,ST=`${Ie}.redo`,Mw=`${Ie}.readOnly`,RT=`${Ie}.clearColumn`,ET=`${Ie}.copy`,TT=`${Ie}.copyWithHeaders`,MT=`${Ie}.copyWithGroupHeaders`,_T=`${Ie}.copyHeadersOnly`,PT=`${Ie}.cut`,xT=`${Ie}.freezeColumn`,IT=`${Ie}.unfreezeColumn`,OT=`${Ie}.mergeCells`,AT=`${Ie}.unmergeCells`,HT=`${Ie}.addComment`,NT=`${Ie}.editComment`,DT=`${Ie}.removeComment`,kT=`${Ie}.readOnlyComment`,$T=`${Ie}.align`,LT=`${Ie}.align.left`,FT=`${Ie}.align.center`,VT=`${Ie}.align.right`,WT=`${Ie}.align.justify`,BT=`${Ie}.align.top`,jT=`${Ie}.align.middle`,UT=`${Ie}.align.bottom`,zT=`${Ie}.borders`,YT=`${Ie}.borders.top`,GT=`${Ie}.borders.right`,KT=`${Ie}.borders.bottom`,qT=`${Ie}.borders.left`,XT=`${Ie}.borders.remove`,JT=`${Ie}.nestedHeaders.insertChildRow`,ZT=`${Ie}.nestedHeaders.detachFromParent`,QT=`${Ie}.hideColumn`,eM=`${Ie}.showColumn`,tM=`${Ie}.hideRow`,nM=`${Ie}.showRow`,gr="Filters:",Gt=`${gr}conditions`,Gv=`${Gt}.none`,rM=`${Gt}.isEmpty`,iM=`${Gt}.isNotEmpty`,oM=`${Gt}.isEqualTo`,sM=`${Gt}.isNotEqualTo`,aM=`${Gt}.beginsWith`,lM=`${Gt}.endsWith`,uM=`${Gt}.contains`,cM=`${Gt}.doesNotContain`,Vre=`${Gt}.byValue`,hM=`${Gt}.greaterThan`,dM=`${Gt}.greaterThanOrEqualTo`,fM=`${Gt}.lessThan`,gM=`${Gt}.lessThanOrEqualTo`,mM=`${Gt}.isBetween`,pM=`${Gt}.isNotBetween`,wM=`${Gt}.after`,vM=`${Gt}.before`,yM=`${Gt}.today`,CM=`${Gt}.tomorrow`,bM=`${Gt}.yesterday`,SM=`${gr}labels.filterByCondition`,RM=`${gr}labels.filterByValue`,EM=`${gr}labels.conjunction`,Kv=`${gr}labels.disjunction`,_w=`${gr}values.blankCells`,TM=`${gr}buttons.selectAll`,MM=`${gr}buttons.clear`,_M=`${gr}buttons.ok`,PM=`${gr}buttons.cancel`,xM=`${gr}buttons.placeholder.search`,IM=`${gr}buttons.placeholder.value`,OM=`${gr}buttons.placeholder.secondValue`,AM="CheckboxRenderer:",HM=`${AM}checked`,NM=`${AM}unchecked`,Wre=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:HM,CHECKBOX_RENDERER_NAMESPACE:AM,CHECKBOX_UNCHECKED:NM,CONTEXTMENU_ITEMS_ADD_COMMENT:HT,CONTEXTMENU_ITEMS_ALIGNMENT:$T,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:UT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:FT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:WT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:LT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:jT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:VT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:BT,CONTEXTMENU_ITEMS_BORDERS:zT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:KT,CONTEXTMENU_ITEMS_BORDERS_LEFT:qT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:GT,CONTEXTMENU_ITEMS_BORDERS_TOP:YT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:RT,CONTEXTMENU_ITEMS_COPY:ET,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:_T,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:MT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:TT,CONTEXTMENU_ITEMS_CUT:PT,CONTEXTMENU_ITEMS_EDIT_COMMENT:NT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:xT,CONTEXTMENU_ITEMS_HIDE_COLUMN:QT,CONTEXTMENU_ITEMS_HIDE_ROW:tM,CONTEXTMENU_ITEMS_INSERT_LEFT:wT,CONTEXTMENU_ITEMS_INSERT_RIGHT:vT,CONTEXTMENU_ITEMS_MERGE_CELLS:OT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:ZT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:JT,CONTEXTMENU_ITEMS_NO_ITEMS:gT,CONTEXTMENU_ITEMS_READ_ONLY:Mw,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:kT,CONTEXTMENU_ITEMS_REDO:ST,CONTEXTMENU_ITEMS_REMOVE_BORDERS:XT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:CT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:DT,CONTEXTMENU_ITEMS_REMOVE_ROW:yT,CONTEXTMENU_ITEMS_ROW_ABOVE:mT,CONTEXTMENU_ITEMS_ROW_BELOW:pT,CONTEXTMENU_ITEMS_SHOW_COLUMN:eM,CONTEXTMENU_ITEMS_SHOW_ROW:nM,CONTEXTMENU_ITEMS_UNDO:bT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:IT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:AT,CONTEXT_MENU_ITEMS_NAMESPACE:$$,FILTERS_BUTTONS_CANCEL:PM,FILTERS_BUTTONS_CLEAR:MM,FILTERS_BUTTONS_OK:_M,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:xM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:OM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:IM,FILTERS_BUTTONS_SELECT_ALL:TM,FILTERS_CONDITIONS_AFTER:wM,FILTERS_CONDITIONS_BEFORE:vM,FILTERS_CONDITIONS_BEGINS_WITH:aM,FILTERS_CONDITIONS_BETWEEN:mM,FILTERS_CONDITIONS_BY_VALUE:Vre,FILTERS_CONDITIONS_CONTAINS:uM,FILTERS_CONDITIONS_EMPTY:rM,FILTERS_CONDITIONS_ENDS_WITH:lM,FILTERS_CONDITIONS_EQUAL:oM,FILTERS_CONDITIONS_GREATER_THAN:hM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:dM,FILTERS_CONDITIONS_LESS_THAN:fM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:gM,FILTERS_CONDITIONS_NAMESPACE:Gt,FILTERS_CONDITIONS_NONE:Gv,FILTERS_CONDITIONS_NOT_BETWEEN:pM,FILTERS_CONDITIONS_NOT_CONTAIN:cM,FILTERS_CONDITIONS_NOT_EMPTY:iM,FILTERS_CONDITIONS_NOT_EQUAL:sM,FILTERS_CONDITIONS_TODAY:yM,FILTERS_CONDITIONS_TOMORROW:CM,FILTERS_CONDITIONS_YESTERDAY:bM,FILTERS_DIVS_FILTER_BY_CONDITION:SM,FILTERS_DIVS_FILTER_BY_VALUE:RM,FILTERS_LABELS_CONJUNCTION:EM,FILTERS_LABELS_DISJUNCTION:Kv,FILTERS_NAMESPACE:gr,FILTERS_VALUES_BLANK_CELLS:_w},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const L$={languageCode:"en-US",[gT]:"No available options",[mT]:"Insert row above",[pT]:"Insert row below",[wT]:"Insert column left",[vT]:"Insert column right",[yT]:["Remove row","Remove rows"],[CT]:["Remove column","Remove columns"],[bT]:"Undo",[ST]:"Redo",[Mw]:"Read only",[RT]:"Clear column",[$T]:"Alignment",[LT]:"Left",[FT]:"Center",[VT]:"Right",[WT]:"Justify",[BT]:"Top",[jT]:"Middle",[UT]:"Bottom",[xT]:"Freeze column",[IT]:"Unfreeze column",[zT]:"Borders",[YT]:"Top",[GT]:"Right",[KT]:"Bottom",[qT]:"Left",[XT]:"Remove border(s)",[HT]:"Add comment",[NT]:"Edit comment",[DT]:"Delete comment",[kT]:"Read-only comment",[OT]:"Merge cells",[AT]:"Unmerge cells",[ET]:"Copy",[TT]:["Copy with header","Copy with headers"],[MT]:["Copy with group header","Copy with group headers"],[_T]:["Copy header only","Copy headers only"],[PT]:"Cut",[JT]:"Insert child row",[ZT]:"Detach from parent",[QT]:["Hide column","Hide columns"],[eM]:["Show column","Show columns"],[tM]:["Hide row","Hide rows"],[nM]:["Show row","Show rows"],[Gv]:"None",[rM]:"Is empty",[iM]:"Is not empty",[oM]:"Is equal to",[sM]:"Is not equal to",[aM]:"Begins with",[lM]:"Ends with",[uM]:"Contains",[cM]:"Does not contain",[hM]:"Greater than",[dM]:"Greater than or equal to",[fM]:"Less than",[gM]:"Less than or equal to",[mM]:"Is between",[pM]:"Is not between",[wM]:"After",[vM]:"Before",[yM]:"Today",[CM]:"Tomorrow",[bM]:"Yesterday",[_w]:"Blank cells",[SM]:"Filter by condition",[RM]:"Filter by value",[EM]:"And",[Kv]:"Or",[TM]:"Select all",[MM]:"Clear",[_M]:"OK",[PM]:"Cancel",[xM]:"Search",[IM]:"Value",[OM]:"Second value",[HM]:"Checked",[NM]:"Unchecked"},Bre=Wre,MR=L$.languageCode,{register:jre,getItem:F$,hasItem:Ure,getValues:zre}=ao("languagesDictionaries");V$(L$);function V$(t,e){let n=t,r=e;return De(t)&&(r=t,n=r.languageCode),Yre(n,r),jre(n,Qn(r)),Qn(r)}function Yre(t,e){t!==MR&&Nre(e,F$(MR))}function W$(t){return DM(t)?Qn(F$(t)):null}function DM(t){return Ure(t)}function Gre(){return zre()}function B$(t,e,n){const r=W$(t);if(r===null)return null;const i=r[e];if(Ht(i))return null;const o=Kre(i,n);return Array.isArray(o)?o[0]:o}function Kre(t,e){let n=t;return M(Fre(),r=>{n=r(t,e)}),n}function qre(t){let e=D$(t);return DM(e)||(e=MR,k$(t)),e}function Xre(t,e,n){return(e=Jre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jre(t){var e=Zre(t,"string");return typeof e=="symbol"?e:e+""}function Zre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qs extends w${constructor(e,n){super(e,null),Xre(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function $C(t){let{activeHeaderClassName:e,...n}=t;return new qs({className:e,...n,selectionType:v$})}function Qre(t){let{areaCornerVisible:e,...n}=t;return new qs({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:XE})}function eie(t){let{...e}=t;return new qs({className:"highlight",...e,selectionType:XE})}function tie(t){let{columnClassName:e,...n}=t;return new qs({className:e,...n,selectionType:ene})}function nie(t){let{cellCornerVisible:e,...n}=t;return new qs({className:"current",headerAttributes:[vE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Gd})}function rie(t){let{border:e,visualCellRange:n,...r}=t;return new qs({...e,...r,selectionType:tne},n)}function iie(t){let{...e}=t;return new qs({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Zte})}function UI(t){let{headerClassName:e,...n}=t;return new qs({className:e,...n,selectionType:qE})}function oie(t){let{rowClassName:e,...n}=t;return new qs({className:e,...n,selectionType:Qte})}function sie(t,e){aie(t,e),e.add(t)}function aie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e,n){return(e=lie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lie(t){var e=uie(t,"string");return typeof e=="symbol"?e:e+""}function uie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function us(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mo=new WeakSet;class cie{constructor(e){sie(this,mo),vr(this,"options",void 0),vr(this,"layerLevel",0),vr(this,"focus",void 0),vr(this,"fill",void 0),vr(this,"layeredAreas",new Map),vr(this,"areas",new Map),vr(this,"rowHeaders",new Map),vr(this,"columnHeaders",new Map),vr(this,"activeRowHeaders",new Map),vr(this,"activeColumnHeaders",new Map),vr(this,"activeCornerHeaders",new Map),vr(this,"rowHighlights",new Map),vr(this,"columnHighlights",new Map),vr(this,"customSelections",[]),this.options=e,this.focus=nie(e),this.fill=iie(e)}isEnabledFor(e,n){let r=e;e===Gd&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return us(mo,this,cs).call(this,this.layeredAreas,Qre)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return us(mo,this,cs).call(this,this.areas,eie)}getAreas(){return[...this.areas.values()]}createRowHeader(){return us(mo,this,cs).call(this,this.rowHeaders,UI)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return us(mo,this,cs).call(this,this.columnHeaders,UI)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return us(mo,this,cs).call(this,this.activeRowHeaders,$C)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return us(mo,this,cs).call(this,this.activeColumnHeaders,$C)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return us(mo,this,cs).call(this,this.activeCornerHeaders,$C)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return us(mo,this,cs).call(this,this.rowHighlights,oie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return us(mo,this,cs).call(this,this.columnHighlights,tie)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(rie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),M(this.areas.values(),e=>void e.clear()),M(this.layeredAreas.values(),e=>void e.clear()),M(this.rowHeaders.values(),e=>void e.clear()),M(this.columnHeaders.values(),e=>void e.clear()),M(this.activeRowHeaders.values(),e=>void e.clear()),M(this.activeColumnHeaders.values(),e=>void e.clear()),M(this.activeCornerHeaders.values(),e=>void e.clear()),M(this.rowHighlights.values(),e=>void e.clear()),M(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function cs(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function zI(t,e,n){return(e=hie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hie(t){var e=die(t,"string");return typeof e=="symbol"?e:e+""}function die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fie{constructor(e){zI(this,"ranges",[]),zI(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function gie(t,e){j$(t,e),e.add(t)}function LC(t,e,n){j$(t,e),e.set(t,n)}function j$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(mn(t,e))}function cm(t,e,n){return t.set(mn(t,e),n),n}function mn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hm=new WeakMap,St=new WeakMap,eo=new WeakMap,Rn=new WeakSet;class _R{constructor(e,n){gie(this,Rn),LC(this,hm,void 0),LC(this,St,void 0),LC(this,eo,{x:0,y:0}),cm(hm,this,e),cm(St,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Je(St,this).createCellCoords(e,n);let o=Je(hm,this).current().highlight;const s=Je(St,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=mn(Rn,this,U$).call(this),{row:h,col:d}=mn(Rn,this,GI).call(this,o),f=Je(St,this).fixedRowsBottom(),g=Je(St,this).minSpareRows(),v=Je(St,this).minSpareCols(),y=Je(St,this).autoWrapRow(),E=Je(St,this).autoWrapCol(),C=Je(St,this).createCellCoords(h+i.row,d+i.col);if(C.row>=c){const _=Hr(r&&g>0&&f===0),T=C.col+1,H=Je(St,this).createCellCoords(C.row-c,T>=u?T-u:T);this.runLocalHooks("beforeColumnWrap",_,mn(Rn,this,Bu).call(this,H),T>=u),_.value?this.runLocalHooks("insertRowRequire",Je(St,this).countRenderableRows()):E&&C.assign(H)}else if(C.row<0){const _=Hr(E),T=C.col-1,H=Je(St,this).createCellCoords(c+C.row,T<0?u+T:T);this.runLocalHooks("beforeColumnWrap",_,mn(Rn,this,Bu).call(this,H),T<0),E&&C.assign(H)}if(C.col>=u){const _=Hr(r&&v>0),T=C.row+1,H=Je(St,this).createCellCoords(T>=c?T-c:T,C.col-u);this.runLocalHooks("beforeRowWrap",_,mn(Rn,this,Bu).call(this,H),T>=c),_.value?this.runLocalHooks("insertColRequire",Je(St,this).countRenderableColumns()):y&&C.assign(H)}else if(C.col<0){const _=Hr(y),T=C.row-1,H=Je(St,this).createCellCoords(T<0?c+T:T,u+C.col);this.runLocalHooks("beforeRowWrap",_,mn(Rn,this,Bu).call(this,H),T<0),y&&C.assign(H)}const{rowDir:P,colDir:A}=mn(Rn,this,YI).call(this,C);a=P,l=A,o=mn(Rn,this,Bu).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Je(St,this).createCellCoords(e,n),i=Je(hm,this).current(),o=Je(St,this).visualToRenderableCoords(i.highlight),s=mn(Rn,this,FC).call(this,i.to.row,i.from.row),a=mn(Rn,this,VC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=mn(Rn,this,GI).call(this,i.highlight),f=Je(St,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),v=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const A=f.col-d;f.col=mn(Rn,this,VC).call(this,g.col,v.col)+A}else if(r.col>0&&a<=d&&f.col>d){const A=mn(Rn,this,VC).call(this,v.col,g.col),_=Math.max(f.col-A,1);f.col=A+_}if(r.row<0&&s>=h&&f.row<h){const A=f.row-h;f.row=mn(Rn,this,FC).call(this,g.row,y.row)+A}else if(r.row>0&&s<=h&&f.row>h){const A=mn(Rn,this,FC).call(this,y.row,g.row),_=Math.max(f.row-A,1);f.row=A+_}const{rowDir:E,colDir:C}=mn(Rn,this,YI).call(this,f);u=E,c=C;const P=mn(Rn,this,Bu).call(this,f);r.row===0&&r.col!==0?l.col=P.col:r.row!==0&&r.col===0?l.row=P.row:(l.row=P.row,l.col=P.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;cm(eo,this,{x:n,y:r})}resetOffsetSize(){cm(eo,this,{x:0,y:0})}}function YI(t){const{width:e,height:n}=mn(Rn,this,U$).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function U$(){return{width:Je(eo,this).x+Je(St,this).countRenderableColumns(),height:Je(eo,this).y+Je(St,this).countRenderableRows()}}function FC(t,e){const n=Je(St,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Je(eo,this).y+n}function VC(t,e){const n=Je(St,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Je(eo,this).x+n}function GI(t){const{row:e,col:n}=Je(St,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Je(St,this).createCellCoords(Je(eo,this).y+e,Je(eo,this).x+n)}function Bu(t){const e=t.clone();return e.col=t.col-Je(eo,this).x,e.row=t.row-Je(eo,this).y,Je(St,this).renderableToVisualCoords(e)}gt(_R,Fn);const qv=0,Xv=1,z$=2,kM=3,mie=[kM,z$],pie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],WC=Symbol("root"),KI=Symbol("child");function Zc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:WC;if(e!==WC&&e!==KI)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===WC;let i=qv;if(n){const o=t[0];t.length===0?i=Xv:r&&o instanceof gg?i=kM:r&&Array.isArray(o)?i=Zc(o,KI):t.length>=2&&t.length<=4&&!t.some((a,l)=>!pie[l].includes(typeof a))&&(i=z$)}return i}function Af(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!mie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===kM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ht(u)&&(u=a),Ht(c)&&(c=l),!r){const f=a,g=l,v=u,y=c;a=Math.min(f,v),l=Math.min(g,y),u=Math.max(f,v),c=Math.max(g,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function wie(t){const e=Zc(t.getSelected());if(e===qv||e===Xv)return[];const n=Af(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return bn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function vie(t){const e=Zc(t.getSelected());if(e===qv||e===Xv)return[];const n=Af(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return bn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function ju(t,e,n){yie(t,e),e.set(t,n)}function yie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sl(t,e,n){return(e=Cie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cie(t){var e=bie(t,"string");return typeof e=="symbol"?e:e+""}function bie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pt(t,e){return t.get(Y$(t,e))}function po(t,e,n){return t.set(Y$(t,e),n),n}function Y$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wn=new WeakMap,al=new WeakMap,dm=new WeakMap,Xh=new WeakMap,fm=new WeakMap,Jh=new WeakMap;class G${constructor(e,n){var r=this;sl(this,"settings",void 0),sl(this,"tableProps",void 0),sl(this,"inProgress",!1),sl(this,"selectedRange",new fie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),sl(this,"highlight",void 0),ju(this,Wn,void 0),ju(this,al,void 0),sl(this,"selectedByRowHeader",new Set),sl(this,"selectedByColumnHeader",new Set),ju(this,dm,!1),ju(this,Xh,!1),ju(this,fm,"unknown"),ju(this,Jh,-1),this.settings=e,this.tableProps=n,this.highlight=new cie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[vE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),po(Wn,this,new _R(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),po(al,this,new _R(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Pt(Wn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Pt(Wn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Pt(Wn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Pt(Wn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Pt(Wn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Pt(Wn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Pt(Wn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Pt(Wn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Pt(al,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Pt(al,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){po(fm,this,e)}markEndSource(){po(fm,this,"unknown")}getSelectionSource(){return Pt(fm,this)}setExpectedLayers(e){po(Jh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,po(Jh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ht(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();po(dm,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ht(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Pt(Jh,this)===-1||this.selectedRange.size()===Pt(Jh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(M(this.highlight.getAreas(),g=>void g.clear()),M(this.highlight.getLayeredAreas(),g=>void g.clear()),M(this.highlight.getRowHeaders(),g=>void g.clear()),M(this.highlight.getColumnHeaders(),g=>void g.clear()),M(this.highlight.getActiveRowHeaders(),g=>void g.clear()),M(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),M(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),M(this.highlight.getRowHighlights(),g=>void g.clear()),M(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(XE,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(qE,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),P=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(C).commit(),d.add(y).commit(),f.add(C).commit()):(a.add(y).add(E).commit(),l.add(C).add(P).commit(),d.add(y).add(E).commit(),f.add(C).add(P).commit())}const g=!Pt(Xh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!Pt(Xh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Gd,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(po(dm,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Pt(Wn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Pt(Wn,this).resetOffsetSize(),this.setRangeStart(Pt(Wn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?Pt(Wn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Pt(Wn,this).resetOffsetSize(),this.setRangeEnd(Pt(Wn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?Pt(al,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Pt(al,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Pt(al,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ye(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ye(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ye(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ye(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ye(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ye(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Hr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Pt(dm,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;po(Xh,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ye(d.row,u,o-1),Ye(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),po(Xh,this,!1)}selectCells(e){var n=this;const r=Zc(e);if(r===Xv)return!1;if(r===qv)throw new Error(ct`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Af(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),M(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ye(r.row,u,s-1),g=Ye(r.col,Math.min(i,o),Math.max(i,o))):(f=Ye(r,u,s-1),g=i);const v=this.tableProps.createCellCoords(f,g),y=l===0?0:Ye(v.row,u,-1),E=s-1,C=this.tableProps.createCellCoords(y,i),P=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",C,P,v),C.row=y,P.row=E,this.setRangeStartOnly(C,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(P),this.runLocalHooks("afterSelectColumns",C,P,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ye(r.row,Math.min(e,n),Math.max(e,n)),d=Ye(r.col,a,o-1)):(h=e,d=Ye(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Ye(f.col,a,-1),v=o-1,y=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",y,E,f),y.col=g,E.col=v,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",y,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Ye(s.row,-1/0,e-1),col:Ye(s.col,-1/0,n-1)}),i.assign({row:Ye(i.row,-1/0,e-1),col:Ye(i.col,-1/0,n-1)}),o.assign({row:Ye(o.row,0,e-1),col:Ye(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(Gd,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Gd,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}gt(G$,Fn);const qI=/^(\r\n|\n\r|\r|\n)/,Sie=/^[^\t\r\n]+/,XI=/^\t/;function Rie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(XI))t=t.replace(XI,""),n+=1,e[r][n]="";else if(t.match(qI))t=t.replace(qI,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Sie);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function qd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ll(t,e,n){return(e=Eie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eie(t){var e=Tie(t,"string");return typeof e=="symbol"?e:e+""}function Tie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){ll(this,"hot",void 0),ll(this,"metaManager",void 0),ll(this,"tableMeta",void 0),ll(this,"dataSource",void 0),ll(this,"duckSchema",void 0),ll(this,"colToPropCache",void 0),ll(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Lv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(De(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return aT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&ke(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Xc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Qn(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},dg(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const v=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(v,n));const y=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",y,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];iR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return rk(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];iR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&an(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Hr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Hr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&an(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Pc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Pc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return qd(this.getRange(e,n,Pc.DESTINATION_RENDERER))}getCopyableText(e,n){return qd(this.getRange(e,n,Pc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:Mie,getItem:_ie,hasItem:K$,getNames:Pie,getValues:n0e}=ao("cellTypes");function $M(t){if(!K$(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return _ie(t)}function ci(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Mr(t,n),r&&jr(t,r),i&&zl(t,i),Mie(t,e)}function xie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!an(e,t)}function Jv(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?$M(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ke(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!De(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};ke(r,(o,s)=>{if(xie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),un(t,i)}function Iie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Nk(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Dp(t){return Number.isInteger(t)&&t>=0}function kp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function gm(t){return t==null}const q$=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Yt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Yt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),$v(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function JI(t,e,n){return(e=Oie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oie(t){var e=Aie(t,"string");return typeof e=="symbol"?e:e+""}function Aie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hie(){return class{}}class Nie{constructor(e){JI(this,"metaCtor",Hie()),JI(this,"meta",void 0),this.meta=this.metaCtor.prototype,un(this.meta,q$()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;un(this.meta,e),Jv(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Die(t,e,n){return(e=kie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kie(t){var e=$ie(t,"string");return typeof e=="symbol"?e:e+""}function $ie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lie{constructor(e){Die(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){un(this.meta,e),Jv(this.meta,e,e)}}function mm(t,e,n){return(e=Fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fie(t){var e=Vie(t,"string");return typeof e=="symbol"?e:e+""}function Vie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pw{constructor(e){mm(this,"valueFactory",void 0),mm(this,"data",[]),mm(this,"index",[]),mm(this,"holes",new Set),this.valueFactory=e}obtain(e){kp(()=>Dp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;kp(()=>Dp(e)||gm(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=gm(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;kp(()=>Dp(e)||gm(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(gm(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function ZI(t,e,n){return(e=Wie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wie(t){var e=Bie(t,"string");return typeof e=="symbol"?e:e+""}function Bie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jie=["data","width"];class Uie{constructor(e){ZI(this,"globalMeta",void 0),ZI(this,"metas",new Pw(()=>this._createMeta())),this.globalMeta=e,this.metas=new Pw(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);un(r,n),Jv(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Iie(this.globalMeta.getMetaConstructor(),jie).prototype}}function QI(t,e,n){return(e=zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zie(t){var e=Yie(t,"string");return typeof e=="symbol"?e:e+""}function Yie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gie{constructor(e){QI(this,"columnMeta",void 0),QI(this,"metas",new Pw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);un(i,r),Jv(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){kp(()=>Dp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Pw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class X${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Nie(e),this.tableMeta=new Lie(this.globalMeta),this.columnMeta=new Uie(this.globalMeta),this.cellMeta=new Gie(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}gt(X$,Fn);function eO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Zn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":lt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Pc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let v,y=0,E=0;for(y=0,E=d.startRows;y<E;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Qn(g),t.push(v);else if(i.dataType==="array")v=Qn(g[0]),t.push(v);else{v=[];for(let C=0,P=d.startCols;C<P;C++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&be(i.rootElement,[dk(-1),Av(i.countCols()+(i.view?i.countRowHeaders():0))])}function tO(t,e,n){return(e=Kie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xie{constructor(e){var n=this;tO(this,"metaManager",void 0),tO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),oe.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=an(e,"type")?e.type:null;let c=lt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Jie(t,e,n){Zie(t,e),e.set(t,n)}function Zie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BC(t,e,n){return(e=Qie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qie(t){var e=eoe(t,"string");return typeof e=="symbol"?e:e+""}function eoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function toe(t,e){return t.get(noe(t,e))}function noe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nO=new WeakMap;class roe{constructor(e){BC(this,"metaManager",void 0),BC(this,"usageTracker",new Set),BC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Jie(this,nO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,toe(nO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const J$="gridDefault",qa="editorManager.handlingEditor",ioe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},ooe="hooksRefRegisterer",Z$={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){M(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ke(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};es(Z$,"MIXIN_NAME",ooe,{writable:!1,enumerable:!1});function Di(t,e,n){return(e=soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function soe(t){var e=aoe(t,"string");return typeof e=="symbol"?e:e+""}function aoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const loe="base",Jt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class wh{static get EDITOR_TYPE(){return loe}constructor(e){Di(this,"hot",void 0),Di(this,"state",Jt.VIRGIN),Di(this,"_opened",!1),Di(this,"_fullEditMode",!1),Di(this,"_closeCallback",null),Di(this,"TD",null),Di(this,"row",null),Di(this,"col",null),Di(this,"prop",null),Di(this,"originalValue",null),Di(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Jt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Jt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Jt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Rt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Jt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Jt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Jt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Jt.FINISHED,this.discardEditor(s)}):(this.state=Jt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Jt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Jt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Jt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Jt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Jt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Ln(n),a=Qt(n),l=Ln(this.hot.rootElement),u=Qt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,E=["master","inline_start"].includes(y)?d:0,C=["master","top","bottom"].includes(y)?f:0,P=s.top===l.top?0:1;let A=s.top-l.top-P-E,_=0;this.hot.isRtl()?_=o.innerWidth-s.left-a-g-1+C:_=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(y)&&(A+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(_+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const T=this.hot.hasColHeaders(),H=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),G=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),V=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(T&&H<=0||H===V)&&(A+=1),G<=0&&(_+=1);const X=i.rowsRenderCalculator.startPosition,ne=i.columnsRenderCalculator.startPosition,Q=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),pe=Mn(this.hot.rootDocument);let et=n.offsetTop;if(["inline_start","master"].includes(y)&&(et+=X-te),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:K,wtTable:J}=r.bottomOverlay.clone;et+=K.getWorkspaceHeight()-J.getHeight()-pe}let Re=n.offsetLeft;this.hot.isRtl()?(Re>=0?Re=v.getWidth()-n.offsetLeft:Re=Math.abs(Re),Re+=ne-Q-a):["top","master","bottom"].includes(y)&&(Re+=ne-Q);const Ae=o.getComputedStyle(this.TD),ot=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",_n=parseInt(Ae[ot],10)>0?0:1,st=parseInt(Ae.borderTopWidth,10)>0?0:1,m=Qt(n)+_n,w=ln(n)+st,p=EE(c)?pe:0,I=TE(h)?pe:0,L=this.hot.view.maximumVisibleElementWidth(Re)-p+_n,j=Math.max(this.hot.view.maximumVisibleElementHeight(et)-I+st,this.hot.view.getDefaultRowHeight());return{top:A,start:_,height:w,maxHeight:j,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}gt(wh,Z$);const uoe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Jt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},coe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},hoe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},doe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},foe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),xi(e))}};function goe(){return[ioe,uoe,coe,hoe,doe,foe]}const moe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},poe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},woe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},voe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},yoe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},Coe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},boe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Soe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Roe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Eoe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Toe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Moe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},_oe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},Poe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function xoe(){return[moe,poe,woe,voe,yoe,Coe,boe,Soe,Roe,Eoe,Toe,Moe,_oe,Poe]}const Ioe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Ooe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Aoe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},Hoe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},Noe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Doe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},koe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},$oe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},Loe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Foe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},Voe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Woe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Boe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},joe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},Uoe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},zoe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Yoe(){return[Ioe,Ooe,Aoe,Hoe,Noe,Doe,koe,$oe,Loe,Foe,Voe,Woe,Boe,joe,Uoe,zoe]}const Goe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Koe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},qoe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Xoe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Joe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Zoe=[...goe(),...xoe(),...Yoe(),Goe,Koe,qoe,Xoe,Joe];function Q$(t){const e={};return Zoe.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Qoe(t){const e=t.getShortcutManager().addContext("editor"),n=Q$(t),r={group:qa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function ese(t){const e=t.getShortcutManager().addContext("grid"),n=Q$(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:J$};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:qa,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function tse(t){[ese,Qoe].forEach(e=>e(t))}function nse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=rO(t),i=rO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function rO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&be(n,[Ef("Focus catcher")]),n}function rse(t){const e=ise(t);let n;const{activate:r,deactivate:i}=nse(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:PR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:xR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:J$,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?PR(t):xR(t)),u(),!1;h.preventDefault()},position:"after"}])}function PR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function xR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function ise(t){return e=>{if(!e)return null;const n=PR(t),r=xR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function vh(t){Uo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Zv(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,v=f<=h,y=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:v&&y?r.highlight.row:v?f:y?g:E.row}}}function ose(t){return e=>{const n=Zv(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;vh(t.getCell(r?-1:0,n,!0))})}}function sse(){return()=>{}}function ase(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;vh(t.getCell(n,r,!0))})}}function lse(t){return e=>{const n=Zv(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;vh(t.getCell(i,o,!0))})}}function use(t){return e=>{const n=Zv(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;vh(t.getCell(i,o,!0))})}}function cse(t){return e=>{const n=Zv(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;vh(t.getCell(n,r?-1:0,!0))})}}function hse(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{vh(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function dse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=ase(t):e.isSelectedByCorner()?s=sse():e.isSelectedByRowHeader()?s=cse(t):e.isSelectedByColumnHeader()?s=ose(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=lse(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=hse(t):e.getSelectedRange().size()>1&&(s=use(t)),(o=s)===null||o===void 0||o(i)}}}const iO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),pm=t=>t.map(e=>{const n=e.toLowerCase();return iO.has(n)?iO.get(n):n}).sort().join("+"),fse=t=>t.split("+"),oO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),jC=t=>{let{which:e,key:n}=t;if(oO.has(e))return oO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},eL=Symbol("shortcut-context");function tL(t){return De(t)&&t.__kindOf===eL}const gse=t=>{const e=Wv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:v,position:y,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ht(c))throw new Error("You need to define the shortcut's group.");if(lt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ct`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(v)&&(C.relativeToGroup=v,C.position=y),tL(E)&&(C.forwardToContext=E),l.forEach(P=>{const A=pm(P);if(e.hasItem(A)){const T=e.getItem(A);let H=T.findIndex(G=>G.group===v);H!==-1?y==="before"?H-=1:H+=1:H=T.length,T.splice(H,0,C)}else e.addItem(A,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ke(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=pm(l);e.removeItem(u)};return{__kindOf:eL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=pm(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=pm(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(fse(h)):(d.length=0,d.push(...f))})}}};function mse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const pse=["meta","alt","shift","control"],Zh=mse(),Qh=[];let wm=0;function wse(t,e,n,r,i){const o=f=>pse.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),g&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||ba(f))return;const v=jC(f);let y=[];o(v)||(y=s(f));const E=[v].concat(y);!i(f,E)&&(Sw()&&y.includes("meta")||!Sw()&&y.includes("control"))&&i(f,[v].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=jC(f);o(g)&&Zh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=jC(f);o(g)&&Zh.release(g)}},c=()=>{Zh.releaseAll()};return{mount:()=>{let f=t;for(wm+=1;f;)wm===1&&(f.document.documentElement.addEventListener("keydown",l),Qh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Qh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=au(f)},unmount:()=>{let f=t;for(wm-=1;f;){if(wm===0){for(let g=0;g<Qh.length;g++){const{event:v,listener:y}=Qh[g];f.document.documentElement.removeEventListener(v,y)}Qh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=au(f)}},isPressed:f=>Zh.isPressed(f),releasePressedKeys:()=>Zh.releaseAll()}}const vse=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Wv({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const v=gse(g);return o.addItem(g,v),v},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(ct`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=tL(y)?y:u(y);let C=!1;if(!E.hasShortcut(v))return C;const P=E.getShortcuts(v);for(let A=0;A<P.length;A++){const{callback:_,runOnlyIf:T,preventDefault:H,stopPropagation:G,captureCtrl:U,forwardToContext:V}=P[A];if(T(g)===!0){if(h=U,C=_(g,v)===!1,h=!1,H&&g.preventDefault(),G&&(xi(g),g.stopPropagation()),C)break;V&&d(g,v,V)}}return C},f=wse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function sO(t){const{classNames:e}=wk(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let UC=null;const zC=new Map;function nL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Ri(o);let a,l,u,c,h,d,f=!0;$ne(i)&&kne(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=qre(e.language);const y=Object.fromEntries(Object.entries(e).filter(m=>{let[w]=m;return!(oe.getSingleton().isRegistered(w)||oe.getSingleton().isDeprecated(w))})),E=new X$(o,y,[Xie,roe]),C=E.getTableMeta(),P=E.getGlobalMeta(),A=Wv();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),Np(this)&&(lk(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${gE()}`,zC.set(this.guid,this),this.columnIndexMapper=new TR,this.rowIndexMapper=new TR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new ore(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const _=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getRenderableFromVisualIndex(w):w,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},T=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getVisualFromRenderableIndex(w):w,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},H=(m,w)=>{const p=w>m?1:-1,I=Math.min(m,w),L=Math.max(m,w),j=o.rowIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<I?null:j>=0?o.rowIndexMapper.getRenderableFromVisualIndex(j):j},G=(m,w)=>{const p=w>m?1:-1,I=Math.min(m,w),L=Math.max(m,w),j=o.columnIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<I?null:j>=0?o.columnIndexMapper.getRenderableFromVisualIndex(j):j};let U=new G$(C,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,w)=>o._createCellCoords(m,w),createCellRange:(m,w,p)=>o._createCellRange(m,w,p),visualToRenderableCoords:_,renderableToVisualCoords:T,findFirstNonHiddenRenderableRow:H,findFirstNonHiddenRenderableColumn:G,isDisabledCellSelection:(m,w)=>m<0||w<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,w).disableVisualSelection});this.selection=U;const V=m=>{let{hiddenIndexesChanged:w}=m;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("afterSetRangeEnd",(m,w)=>{const p=Hr(!1),I=this.selection.getSelectedRange(),{from:L,to:j}=I.current(),K=I.size()-1;this.runHooks("afterSelection",L.row,L.col,j.row,j.col,p,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),j.row,o.colToProp(j.col),p,K),w&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m);const J=U.isSelectedByRowHeader(),b=U.isSelectedByColumnHeader();J&&b?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(we(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):b?(we(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),U.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const w=Hr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const w=m.length-1,{from:p,to:I}=m[w];this.runHooks("afterSelectionEnd",p.row,p.col,I.row,I.col,w),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),I.row,o.colToProp(I.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const w=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,I=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const j=K=>{if(K.length===0)return[];const J=[...K];return J.sort((R,S)=>{let[$]=R,[x]=S;return $===x?0:$>x?1:-1}),bn(J,(R,S)=>{let[$,x]=S;const N=R[R.length-1],[B,O]=N,D=B+O;if($<=D){const W=Math.max(x-(D-$),0);N[1]+=W}else R.push([$,x]);return R},[J[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(C.maxRows===K)return;const J=m==="insert_row_below"?"below":"above";w=w??(J==="below"?K:0);const{delta:b,startPhysicalIndex:R}=a.createRow(w,p,{source:I,mode:J});U.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";w=w??(S==="end"?o.countSourceCols():0);const{delta:$,startPhysicalIndex:x}=a.createCol(w,p,{source:I,mode:S});if($){if(Array.isArray(C.colHeaders)){const O=[o.toVisualColumn(x),0];O.length+=$,Array.prototype.splice.apply(C.colHeaders,O)}U.shiftColumns(o.toVisualColumn(x),$)}break;case"remove_row":const N=O=>{let D=0;M(O,W=>{let[F,Y]=W;const ae=Yt(F)?o.countRows()-1:Math.max(F-D,0);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeRow(F,Y,I))return;if(U.isSelected()){const{row:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+Y-1&&c.closeEditor(!0)}const _e=o.countRows(),Fe=C.fixedRowsTop;Fe>=ae+1&&(C.fixedRowsTop-=Math.min(Y,Fe-ae));const ze=C.fixedRowsBottom;ze&&ae>=_e-ze&&(C.fixedRowsBottom-=Math.min(Y,ze)),_e===0?U.deselect():I==="ContextMenu.removeRow"?U.refresh():U.shiftRows(F,-Y),D+=Y})};Array.isArray(w)?N(j(w)):N([[w,p]]);break;case"remove_col":const B=O=>{let D=0;M(O,W=>{let[F,Y]=W;const ae=Yt(F)?o.countCols()-1:Math.max(F-D,0);let ce=o.toPhysicalColumn(ae);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeCol(F,Y,I))return;if(U.isSelected()){const{col:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+Y-1&&c.closeEditor(!0)}o.countCols()===0?U.deselect():I==="ContextMenu.removeColumn"?U.refresh():U.shiftColumns(F,-Y);const ze=C.fixedColumnsStart;ze>=ae+1&&(C.fixedColumnsStart-=Math.min(Y,ze-ae)),Array.isArray(C.colHeaders)&&(typeof ce>"u"&&(ce=-1),C.colHeaders.splice(ce,Y)),D+=Y})};Array.isArray(w)?B(j(w)):B([[w,p]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=C.minRows,w=C.minSpareRows,p=C.minCols,I=C.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(w){const L=o.countEmptyRows(!0);if(L<w){const j=w-L,K=Math.min(j,C.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(p||I)&&(L=o.countEmptyCols(!0));let j=o.countCols();if(p&&!C.columns&&j<p){const K=p-j;L+=K,a.createCol(j,K,{source:"auto"})}if(I&&!C.columns&&o.dataType==="array"&&L<I){j=o.countCols();const K=I-L,J=Math.min(K,C.maxCols-j);a.createCol(j,J,{source:"auto"})}}},populateFromArray(m,w,p,I,L){let j,K,J,b;const R=[],S={},$=[],x=m.row,N=m.col;if(K=w.length,K===0)return!1;let B=0,O=0;switch(De(p)&&(B=p.col-N+1,O=p.row-x+1),L){case"shift_down":const D=Bd(w),W=D.length,F=Math.max(W,B),Y=o.getData().slice(x),ae=Bd(Y).slice(N,N+F);for(J=0;J<F;J+=1)if(J<W){for(j=0,K=D[J].length;j<O-K;j+=1)D[J].push(D[J][j%K]);J<ae.length?$.push(D[J].concat(ae[J])):$.push(D[J].concat(new Array(Y.length).fill(null)))}else $.push(D[J%W].concat(ae[J]));o.populateFromArray(x,N,Bd($));break;case"shift_right":const ce=w.length,_e=Math.max(ce,O),Fe=o.getData().slice(x).map(Mt=>Mt.slice(N));for(j=0;j<_e;j+=1)if(j<ce){for(J=0,b=w[j].length;J<B-b;J+=1)w[j].push(w[j][J%b]);if(j<Fe.length)for(let Mt=0;Mt<Fe[j].length;Mt+=1)w[j].push(Fe[j][Mt]);else w[j].push(...new Array(Fe[0].length).fill(null))}else w.push(w[j%K].slice(0,_e).concat(Fe[j]));o.populateFromArray(x,N,w);break;case"overwrite":default:S.row=m.row,S.col=m.col;let ze=0,Me=0,Ve=!0,Tt;const Oi=function(fn){let Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const _t=w[fn%w.length];return Ct!==null?_t[Ct%_t.length]:_t},ns=w.length,ri=p?p.row-m.row+1:0;for(p?K=ri:K=Math.max(ns,ri),j=0;j<K&&!(p&&S.row>p.row&&ri>ns||!C.allowInsertRow&&S.row>o.countRows()-1||S.row>=C.maxRows);j++){const Mt=j-ze,fn=Oi(Mt).length,Ct=p?p.col-m.col+1:0;if(p?b=Ct:b=Math.max(fn,Ct),S.col=m.col,Tt=o.getCellMeta(S.row,S.col),(I==="CopyPaste.paste"||I==="Autofill.fill")&&Tt.skipRowOnPaste){ze+=1,S.row+=1,K+=1;continue}for(Me=0,J=0;J<b&&!(p&&S.col>p.col&&Ct>fn||!C.allowInsertColumn&&S.col>o.countCols()-1||S.col>=C.maxCols);J++){if(Tt=o.getCellMeta(S.row,S.col),(I==="CopyPaste.paste"||I==="Autofill.fill")&&Tt.skipColumnOnPaste){Me+=1,S.col+=1,b+=1;continue}if(Tt.readOnly&&I!=="UndoRedo.undo"){S.col+=1;continue}const _t=J-Me;let We=Oi(Mt,_t),ii=o.getDataAtCell(S.row,S.col);if(We!==null&&typeof We=="object")if(Array.isArray(We)&&ii===null&&(ii=[]),ii===null||typeof ii!="object")Ve=!1;else{const Xa=Xc(Array.isArray(ii)?ii:ii[0]||ii),Ja=Xc(Array.isArray(We)?We:We[0]||We);$v(Xa,Ja)||Array.isArray(Xa)&&Array.isArray(Ja)?We=Qn(We):Ve=!1}else ii!==null&&typeof ii=="object"&&(Ve=!1);Ve&&R.push([S.row,S.col,We]),Ve=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,I||"populateFromArray");break}}};function X(m){const w=D$(m);DM(w)?(o.runHooks("beforeLanguageChange",w),P.language=w,o.runHooks("afterLanguageChange",w)):k$(m)}function ne(m,w){const p=m==="className"?o.rootElement:o.table;if(f)q(p,w);else{let I=[],L=[];P[m]&&(I=Array.isArray(P[m])?P[m]:sR(P[m])),w&&(L=Array.isArray(w)?w:sR(w));const j=oR(I,L),K=oR(L,I);j.length&&we(p,j),K.length&&q(p,K)}P[m]=w}this.init=function(){l.setData(C.data),o.runHooks("beforeInit"),(Bo()||HE())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Wne(this);const m=C.themeName||sO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=mR.getInstance(o,C,U),d=dse(o),h=new cZ(o),Np(this)&&rse(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&Mk(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function Q(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const w=m.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):m}function pe(m,w,p){if(!m.length){p();return}const I=o.getActiveEditor(),L=new Q;let j=!0;L.onQueueEmpty=()=>{I&&j&&I.cancelChanges(),p()};for(let K=m.length-1;K>=0;K--){const[J,b]=m[K],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(J,R):S={...Object.getPrototypeOf(C),...C},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function($,x){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&x.allowInvalid===!1&&(j=!1,m.splice($,1),x.valid=!0),L.removeValidatorFormQueue()}}(K,S),w))}L.checkIfQueueIsEmpty()}function et(m,w){for(let I=m.length-1;I>=0;I--){let L=!1;if(m[I]===null){m.splice(I,1);continue}if(!((m[I][2]===null||m[I][2]===void 0)&&(m[I][3]===null||m[I][3]===void 0))){if(C.allowInsertRow)for(;m[I][0]>o.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}if(o.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(m[I][1])>o.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}L||a.set(m[I][0],m[I][1],m[I][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,w),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,w||"edit");const I=o.getActiveEditor();I&&le(I.refreshValue)&&I.refreshValue()}else o.render()}this._createCellCoords=function(m,w){return o.view._wt.createCellCoords(m,w)},this._createCellRange=function(m,w,p){return o.view._wt.createCellRange(m,w,p)},this.validateCell=function(m,w,p,I){let L=o.getCellValidator(w);function j(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){p(K);return}const b=w.visualCol,R=w.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const $=o.rowIndexMapper.getRenderableFromVisualIndex(R),x=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",$,x,S)}p(K)}ak(L)&&(L=function(K){return function(J,b){b(K.test(J))}}(L)),lt(L)?(m=o.runHooks("beforeValidate",m,w.visualRow,w.prop,I),o._registerImmediate(()=>{L.call(w,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,w.visualRow,w.prop,I),w.valid=K,j(K),o.runHooks("postAfterValidate",K,m,w.visualRow,w.prop,I))})})):o._registerImmediate(()=>{w.valid=!0,j(w.valid,!1)})};function Re(m,w,p){return Array.isArray(m)?m:[[m,w,p]]}function Ae(m,w){const p=o.runHooks("beforeChange",m,w||"edit"),I=m.filter(j=>j!==null);if(p===!1||I.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let j=I.length-1;j>=0;j--){const[K,J,,b]=I[j],R=a.propToCol(J);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(C),...C};const{type:$,checkedTemplate:x,uncheckedTemplate:N}=S;if($==="numeric"&&typeof b=="string"&&n$(b)&&(I[j][3]=te(b)),$==="checkbox"){const B=Rt(b),O=B===Rt(x),D=B===Rt(N);(O||D)&&(I[j][3]=O?x:N)}}return I}this.setDataAtCell=function(m,w,p,I){const L=Re(m,w,p),j=[];let K=I,J,b,R;for(J=0,b=L.length;J<b;J++){if(typeof L[J]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[J][1]>=this.countCols()?R=L[J][1]:R=a.colToProp(L[J][1]),j.push([L[J][0],R,l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]])}!K&&typeof m=="object"&&(K=w);const S=Ae(j,K);o.runHooks("afterSetDataAtCell",S,K),pe(S,K,()=>{et(S,K)})},this.setDataAtRowProp=function(m,w,p,I){const L=Re(m,w,p),j=[];let K=I,J,b;for(J=0,b=L.length;J<b;J++)j.push([L[J][0],L[J][1],l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]]);!K&&typeof m=="object"&&(K=w);const R=Ae(j,I);o.runHooks("afterSetDataAtRowProp",R,K),pe(R,K,()=>{et(R,K)})},this.listen=function(){o&&!o.isListening()&&(zC.forEach(m=>{o!==m&&m.unlisten()}),UC=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(UC=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return UC===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),w&&U.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,w,p,I,L,j,K){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const J=typeof I=="number"?o._createCellCoords(I,L):null;return u.populateFromArray(o._createCellCoords(m,w),p,J,j,K)},this.spliceCol=function(m,w,p){for(var I=arguments.length,L=new Array(I>3?I-3:0),j=3;j<I;j++)L[j-3]=arguments[j];return a.spliceCol(m,w,p,...L)},this.spliceRow=function(m,w,p){for(var I=arguments.length,L=new Array(I>3?I-3:0),j=3;j<I;j++)L[j-3]=arguments[j];return a.spliceRow(m,w,p,...L)},this.getSelected=function(){if(U.isSelected())return Ue(U.getSelectedRange(),m=>{let{from:w,to:p}=m;return[w.row,w.col,p.row,p.col]})},this.getSelectedLast=function(){const m=this.getSelected();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.emptySelectedCells=function(m){if(!U.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];M(U.getSelectedRange(),p=>{if(p.isSingleHeader())return;const I=p.getTopStartCorner(),L=p.getBottomEndCorner();fe(I.row,L.row,j=>{fe(I.col,L.col,K=>{this.getCellMeta(j,K).readOnly||w.push([j,K,null])})})}),w.length>0&&this.setDataAtCell(w,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const w=m();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=m();return this.resumeExecution(w),p},this.batch=function(m){this.suspendRender(),this.suspendExecution();const w=m();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:w,height:p}=m.getLastSize(),{width:I,height:L}=o.rootElement.getBoundingClientRect(),j=I!==w||L!==p;o.runHooks("beforeRefreshDimensions",{width:w,height:p},{width:I,height:L},j)!==!1&&((j||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(I,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:w,height:p},{width:I,height:L},j))},this.updateData=function(m,w){eO(m,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),U.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:E,firstRun:f})},this.loadData=function(m,w){eO(m,p=>{a=p},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),U.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=C.columns;let w=0;if(Array.isArray(m))w=m.length;else if(lt(m))if(o.dataType==="array"){const p=this.countSourceCols();for(let I=0;I<p;I+=1)m(I)&&(w+=1)}else(o.dataType==="object"||o.dataType==="function")&&(w=a.colToPropCache.length);else if(le(C.dataSchema)){const p=a.getSchema();w=Array.isArray(p)?p.length:Lv(p)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,w,p,I){return Ht(m)?a.getAll():a.getRange(o._createCellCoords(m,w),o._createCellCoords(p,I),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,w,p,I){return a.getCopyableText(o._createCellCoords(m,w),o._createCellCoords(p,I))},this.getCopyableData=function(m,w){return a.getCopyable(m,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(f?o.loadData:o.updateData).bind(this);let I=!1,L,j;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&X(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")ne("className",m.className);else if(L==="tableClassName"&&o.table)ne("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(oe.getSingleton().isRegistered(L)||oe.getSingleton().isDeprecated(L)){const S=m[L];lt(S)?(oe.getSingleton().addAsFixed(L,S,o),C[L]=S):Array.isArray(S)&&(oe.getSingleton().add(L,S,o),C[L]=S)}else!w&&an(m,L)&&(P[L]=m[L]);m.data===void 0&&C.data===void 0?p(null,"updateSettings"):m.data!==void 0?p(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),J=C.columns;if(J&&lt(J)&&(I=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),K>0)for(L=0,j=0;L<K;L++){if(J){const S=I?J(L):J[j];S&&E.updateColumnMeta(j,S)}j+=1}le(m.cell)&&ke(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(lt(R)&&(R=R()),w&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;lt(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!w){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),$=an(m,"themeName");S&&$&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const x=$&&m.themeName||sO(o.rootElement);o.useTheme(x),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!w&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(C.getValue){if(lt(C.getValue))return C.getValue.call(o);if(m)return o.getData()[m[0][0]][C.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,w,p,I,L){u.alter(m,w,p,I,L)},this.getCell=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,I=w,L=m;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;I=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||I===null||L===void 0||I===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,I),p)},this.getCoords=function(m){const w=this.view._wt.wtTable.getCoords(m);if(w===null)return null;const{row:p,col:I}=w;let L=p,j=I;return p>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(p)),I>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(I)),o._createCellCoords(L,j)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,w){return a.get(m,a.colToProp(w))},this.getDataAtRowProp=function(m,w){return a.get(m,w)},this.getDataAtCol=function(m){const w=[],p=a.getRange(o._createCellCoords(0,m),o._createCellCoords(C.data.length-1,m),a.DESTINATION_RENDERER);for(let I=0;I<p.length;I+=1)for(let L=0;L<p[I].length;L+=1)w.push(p[I][L]);return w},this.getDataAtProp=function(m){const w=[],p=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(C.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let I=0;I<p.length;I+=1)for(let L=0;L<p[I].length;L+=1)w.push(p[I][L]);return w},this.getSourceData=function(m,w,p,I){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,I)),L},this.getSourceDataArray=function(m,w,p,I){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,I),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,w,p,I){const L=Re(m,w,p),j=this.hasHook("afterSetSourceDataAtCell"),K=[];j&&M(L,b=>{let[R,S,$]=b;K.push([R,S,l.getAtCell(R,S),$])}),M(L,b=>{let[R,S,$]=b;l.setAtCell(R,S,$)}),j&&this.runHooks("afterSetSourceDataAtCell",K,I),this.render();const J=o.getActiveEditor();J&&le(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,w){return l.getAtCell(m,w)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,w,p,I){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,w,p,I],[j,K]=L;let[,,J,b]=L,R=null,S=null;J===void 0&&(J=j),b===void 0&&(b=K);let $="mixed";return fe(Math.max(Math.min(j,J),0),Math.max(j,J),x=>{let N=!0;return fe(Math.max(Math.min(K,b),0),Math.max(K,b),B=>(S=this.getCellMeta(x,B).type,R?N=R===S:R=S,N)),$=N?S:"mixed",N}),$},this.removeCellMeta=function(m,w,p){const[I,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(w)];let j=E.getCellMetaKeyValue(I,L,p);o.runHooks("beforeRemoveCellMeta",m,w,p,j)!==!1&&(E.removeCellMeta(I,L,p),o.runHooks("afterRemoveCellMeta",m,w,p,j)),j=null},this.spliceCellsMeta=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,I=new Array(p>2?p-2:0),L=2;L<p;L++)I[L-2]=arguments[L];if(I.length>0&&!Array.isArray(I[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&E.removeRow(this.toPhysicalRow(m),w),I.length>0&&M(I.reverse(),j=>{E.createRow(this.toPhysicalRow(m)),M(j,(K,J)=>this.setCellMetaObject(m,J,K))}),o.render()},this.setCellMetaObject=function(m,w,p){typeof p=="object"&&ke(p,(I,L)=>{this.setCellMeta(m,w,L,I)})},this.setCellMeta=function(m,w,p,I){if(o.runHooks("beforeSetCellMeta",m,w,p,I)===!1)return;let j=m,K=w;m<this.countRows()&&(j=this.toPhysicalRow(m)),w<this.countCols()&&(K=this.toPhysicalColumn(w)),E.setCellMeta(j,K,p,I),o.runHooks("afterSetCellMeta",m,w,p,I)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},I=this.toPhysicalRow(m),L=this.toPhysicalColumn(w);return I===null&&(I=m),L===null&&(L=w),E.getCellMeta(I,L,{visualRow:m,visualColumn:w,...p})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||C.columns)},this.getCellRenderer=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).renderer:m.renderer;return typeof p=="string"?Tw(p):Ht(p)?Tw("text"):p},this.getCellEditor=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).editor:m.editor;return typeof p=="string"?Ew(p):Ht(p)?Ew("text"):p},this.getCellValidator=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).validator:m.validator;return typeof p=="string"?BE(p):p},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,w){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,m)},this.validateColumns=function(m,w){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,m)},this._validateCells=function(m,w,p){const I=new Q;m&&(I.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(w!==void 0&&w.indexOf(L)===-1){L-=1;continue}let j=o.countCols()-1;for(;j>=0;){if(p!==void 0&&p.indexOf(j)===-1){j-=1;continue}I.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,j),o.getCellMeta(L,j),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(I.valid=!1),I.removeValidatorFormQueue()},"validateCells"),j-=1}L-=1}I.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let w=C.rowHeaders,p=m;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(w=[],fe(o.countRows()-1,I=>{w.push(o.getRowHeader(I))})):Array.isArray(w)&&w[p]!==void 0?w=w[p]:lt(w)?w=w(p):w&&typeof w!="string"&&typeof w!="number"&&(w=p+1),w},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let m=0,w=o.countCols();m<w;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",m);if(p===void 0){const J=[],b=o.countCols();for(let R=0;R<b;R++)J.push(o.getColHeader(R));return J}let I=C.colHeaders;const L=function(J){const b=[],R=o.countCols();let S=0;for(;S<R;S++)lt(C.columns)&&C.columns(S)&&b.push(S);return b[J]},j=o.toPhysicalColumn(p),K=L(j);return C.colHeaders===!1?I=null:C.columns&&lt(C.columns)&&C.columns(K)&&C.columns(K).title?I=C.columns(K).title:C.columns&&C.columns[j]&&C.columns[j].title?I=C.columns[j].title:Array.isArray(C.colHeaders)&&C.colHeaders[j]!==void 0?I=C.colHeaders[j]:lt(C.colHeaders)?I=C.colHeaders(j):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(I=Uv(p)),I=o.runHooks("modifyColumnHeaderValue",I,m,w),I},this._getColWidthFromSettings=function(m){let w;if(m>=0&&(w=o.getCellMeta(0,m).width),(w===void 0||w===C.width)&&(w=C.colWidths),w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(m,w){let p=o._getColWidthFromSettings(m);return p=o.runHooks("modifyColWidth",p,m,w),p===void 0&&(p=Jc),p},this._getRowHeightFromSettings=function(m){const w=this.view.getDefaultRowHeight();let p=C.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<w?w:p},this.getRowHeight=function(m,w){let p=o._getRowHeightFromSettings(m);return p=o.runHooks("modifyRowHeight",p,m,w),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=C.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,w)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return vR(o.countRows()-1,p=>{if(o.isEmptyRow(p))w+=1;else if(m===!0)return!1}),w},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return vR(o.countCols()-1,p=>{if(o.isEmptyCol(p))w+=1;else if(m===!0)return!1}),w},this.isEmptyRow=function(m){return C.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return C.isEmptyCol.call(o,m)},this.selectCell=function(m,w,p,I){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ht(m)||Ht(w)?!1:this.selectCells([[m,w,p,I]],L,j)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const I=U.selectCells(m);return I&&p&&o.listen(),d.resume(),I},this.selectColumns=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectColumns(m,w,p)},this.selectRows=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectRows(m,w,p)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),U.selectAll(m,w,p)};const ot=(m,w)=>m.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(m,w){if(typeof m=="number"){var p;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:I,col:L,considerHiddenIndexes:j}=m??{};let K=I,J=L;if(lt(w)&&this.addHookOnce("afterScroll",w),j===void 0||j){const $=Number.isInteger(I)&&I>=0,x=Number.isInteger(L)&&L>=0,N=$?ot(this.rowIndexMapper,I):void 0,B=x?ot(this.columnIndexMapper,L):void 0;if(N===null||B===null)return!1;K=$?o.rowIndexMapper.getRenderableFromVisualIndex(N):I,J=x?o.columnIndexMapper.getRenderableFromVisualIndex(B):L}const b=Number.isInteger(K),R=Number.isInteger(J);let S=!1;return b&&K>=0&&R&&J>=0?S=o.view.scrollViewport(o._createCellCoords(K,J),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(R&&J<0||!R)?S=o.view.scrollViewportVertically(K,m.verticalSnap):R&&J>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(J,m.horizontalSnap)),lt(w)&&(S?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;lt(m)&&this.addHookOnce("afterScroll",m);const{highlight:w}=this.getSelectedRangeLast(),p=this.scrollViewportTo(w.toObject());return p?this.view.render():lt(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),p},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),zC.delete(this.guid),Np(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}Ko(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),A.getItems().forEach(m=>{let[,w]=m;w.destroy()}),A.clear(),o.runHooks("afterDestroy")},!0),oe.getSingleton().destroy(o),ke(o,(m,w,p)=>{lt(m)?p[w]=_n(w):w!=="guid"&&(p[w]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,U=null,c=null,o=null};function _n(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return A.getItem(Zn(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:A.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,w,p){oe.getSingleton().add(m,w,o,p)},this.hasHook=function(m){return oe.getSingleton().has(m,o)||oe.getSingleton().has(m)},this.addHookOnce=function(m,w,p){oe.getSingleton().once(m,w,o,p)},this.removeHook=function(m,w){oe.getSingleton().remove(m,w,o)},this.runHooks=function(m,w,p,I,L,j,K){return oe.getSingleton().run(o,m,w,p,I,L,j,K)},this.getTranslatedPhrase=function(m,w){return B$(C.language,m,w)},this.toHTML=()=>pR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",pR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=m;typeof p=="function"&&(p=setTimeout(p,w)),this.timeouts.push(p)},this._clearTimeouts=function(){M(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){M(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const st=vse({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&st.releasePressedKeys()}),this.getShortcutManager=function(){return st},this.getFocusManager=function(){return h},WE().forEach(m=>{const w=fg(m);A.addItem(m,new w(this))}),tse(o),st.setActiveContextName("grid"),oe.getSingleton().run(o,"construct")}function aO(t,e,n){t.addEventListener(e,n,!1)}function lO(t,e,n){t.removeEventListener(e,n,!1)}function vm(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function rL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=vm(s).fontSize,o.style.fontFamily=vm(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=vm(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=vm(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+g+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>v?y.width=`${n.minWidth}px`:v>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${v}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?y.height=`${n.minHeight}px`:n.maxHeight<E?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(aO(s,"input",a),aO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){lO(s,"input",a),lO(s,"keydown",l)}}}function uO(t,e){const n=RE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}lg(e,i)}function ul(t,e,n){return(e=yse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yse(t){var e=Cse(t,"string");return typeof e=="symbol"?e:e+""}function Cse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bse="ht_editor_visible",ym="ht_editor_hidden",cO="textEditor",Sse="text";class xu extends wh{static get EDITOR_TYPE(){return Sse}constructor(e){super(e),ul(this,"eventManager",new Ri(this)),ul(this,"autoResize",rL(this.hot.rootDocument)),ul(this,"TEXTAREA",void 0),ul(this,"textareaStyle",void 0),ul(this,"TEXTAREA_PARENT",void 0),ul(this,"textareaParentStyle",void 0),ul(this,"layerClass",void 0),this.eventManager=new Ri(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),zd(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Jt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Jt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),lg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),be(this.TEXTAREA,[["data-hot-input",""],Eu(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,ym),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Bk()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,ym)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(ve(i,"handsontableEditor"))return n=!0,!1}),ve(this.TEXTAREA_PARENT,ym)&&we(this.TEXTAREA_PARENT,ym),n?(this.layerClass=bse,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Jt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){AE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:cO},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;uO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;uO(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(cO)}}const Rse="base";function vg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(Bx())):a&&c.push(Bx()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(jx())):(u.push(s.invalidCellClassName),a&&c.push(jx()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),we(e,u),q(e,l),Mu(e,c),be(e,h)}vg.RENDERER_TYPE=Rse;const Ese="text";function Xs(t,e,n,r,i,o,s){vg.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Rt(a),s.trimWhitespace&&(a=a.trim()),Ba(e,a)}Xs.RENDERER_TYPE=Ese;const Tse="text",iL={CELL_TYPE:Tse,editor:xu,renderer:Xs};ci(iL);Te.editors={BaseEditor:wh};function Te(t,e){const n=new nL(t,e||{},oT);return n.init(),n}Te.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new nL(t,e,oT)};Te.DefaultSettings=q$();Te.hooks=oe.getSingleton();Te.CellCoords=uu;Te.CellRange=gg;Te.packageName="handsontable";Te.buildDate="24/04/2025 10:59:00";Te.version="15.3.0";Te.languages={dictionaryKeys:Bre,getLanguageDictionary:W$,getLanguagesDictionaries:Gre,registerLanguageDictionary:V$,getTranslatedPhrase:B$};const hO="handsontableEditor",Mse="handsontable";class LM extends xu{static get EDITOR_TYPE(){return Mse}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),lg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&un(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:hO,relativeToGroup:qa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),xi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(hO)}}function _se(t,e){oL(t,e),e.add(t)}function dO(t,e,n){oL(t,e),e.set(t,n)}function oL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cm(t,e,n){return(e=Pse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pse(t){var e=xse(t,"string");return typeof e=="symbol"?e:e+""}function xse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YC(t,e){return t.get(IR(t,e))}function IR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ise="autocomplete";var GC=new WeakMap,fO=new WeakMap,KC=new WeakSet;class FM extends LM{constructor(){super(...arguments),_se(this,KC),Cm(this,"query",null),Cm(this,"strippedChoices",[]),Cm(this,"rawChoices",[]),dO(this,GC,this.hot.guid.slice(0,9)),dO(this,fO,cg(()=>{this.focus()},100)),Cm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=lR(Rt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return Ise}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[E8(),y8(),hk("listbox"),P8()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[Ci("false"),x8(`${YC(GC,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",YC(fO,this)),this.htEditor.updateSettings({colWidths:e?[Qt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Xs(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:v,locale:y}=this.cellProperties,E=this.query;let C=Rt(d),P,A;C&&!v&&(P=g===!0?C.indexOf(E):C.toLocaleLowerCase(y).indexOf(E.toLocaleLowerCase(y)),P!==-1&&(A=C.substr(P,E.length),C=C.replace(A,`<strong>${A}</strong>`))),n&&be(l,[C8(),...r?[H8(i)]:[],...r?[N8(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=C},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{be(h,[vE()]),be(this.TEXTAREA,...I8(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(be(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...As()),be(this.htEditor.rootElement,[ck(),O8("polite"),A8("text"),["id",`${YC(GC,this)}-listbox-${o}-${s}`]]),be(this.TEXTAREA,...Ci("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[Ci("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=RE(this.TEXTAREA),r=Tk(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Bd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),lg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),IR(KC,this,gO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),IR(KC,this,gO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Rt(o));return Ue(r,o=>n?o:lR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(jk(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function gO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+Mn(this.hot.rootDocument)})}const Ose="checkbox";class sL extends wh{static get EDITOR_TYPE(){return Ose}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ve(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const xa=()=>window,pi=()=>window.document,OR=(t,e)=>window.setTimeout(t,e),Po=function(t,e,n,r){t.addEventListener(e,n,!!r)},hs=function(t,e,n,r){t.removeEventListener(e,n,!!r)},Ase=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Br=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},qC=function(t,e){Br(t,e)||(t.className=t.className===""?e:t.className+" "+e)},XC=function(t,e){t.className=Ase((" "+t.className+" ").replace(" "+e+" "," "))},VM=function(t){return/Array/.test(Object.prototype.toString.call(t))},Yr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Hse=function(t){let e=t.getDay();return e===0||e===6},Nse=function(t){return t%4===0&&t%100!==0||t%400===0},mO=function(t,e){return[31,Nse(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},bm=function(t){Yr(t)&&t.setHours(0,0,0,0)},Sm=function(t,e){return t.getTime()===e.getTime()},xw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Yr(e[r])?n&&(t[r]=new Date(e[r].getTime())):VM(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=xw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},pO=function(t,e,n){let r=pi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=xw(r,n),t.dispatchEvent(r)},wO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},wo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},vO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Dse=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},kse=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},$se=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():kse(o,i))+"</td>"},Lse=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Fse=function(t){return"<tbody>"+t.join("")+"</tbody>"},Vse=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+vO(t,e)+'">'+vO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Wse=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,v=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",VM(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},Bse=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Vse(t)+Fse(e)+"</table>"};function AR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||xa().event;let o=i.target||i.srcElement;if(o)if(Br(o,"is-disabled")||(Br(o,"pika-button")&&!Br(o,"is-empty")&&!Br(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&OR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Br(o,"pika-prev")?e.prevMonth():Br(o,"pika-next")&&e.nextMonth()),Br(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||xa().event;let o=i.target||i.srcElement;o&&(Br(o,"pika-select-month")?e.gotoMonth(o.value):Br(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||xa().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Yr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=pi().activeElement;do if(Br(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=OR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||xa().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Br(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Po(o,"change",e._onChange)));do if(Br(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=pi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Po(e.el,"mousedown",e._onMouseDown,!0),Po(e.el,"touchend",e._onMouseDown,!0),Po(e.el,"change",e._onChange),n.keyboardInput&&Po(pi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?pi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Po(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Yr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Po(n.trigger,"click",e._onInputClick),Po(n.trigger,"focus",e._onInputFocus),Po(n.trigger,"blur",e._onInputBlur)):this.show()}AR.prototype={config:function(t){this._o||(this._o=xw({},wo,!0));let e=xw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Yr(e.minDate)||(e.minDate=!1),Yr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),VM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||wo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Yr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Yr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",pO(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Yr(t))return;let n=this._o.minDate,r=this._o.maxDate;Yr(n)&&t<n?t=n:Yr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),bm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),pO(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Yr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=wO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=wO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(bm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=wo.minDate,this._o.minYear=wo.minYear,this._o.minMonth=wo.minMonth,this._o.startRange=wo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(bm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=wo.maxDate,this._o.maxYear=wo.maxYear,this._o.maxMonth=wo.maxMonth,this._o.endRange=wo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Wse(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&OR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=xa().innerWidth||pi().documentElement.clientWidth,i=xa().innerHeight||pi().documentElement.clientHeight,o=pi().body.scrollTop||pi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+xa().pageXOffset,a=l.bottom+xa().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",qC(this.el,u?"left-aligned":"right-aligned"),qC(this.el,c?"bottom-aligned":"top-aligned"),XC(this.el,u?"right-aligned":"left-aligned"),XC(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=mO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];bm(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=mO(h,u),g=o+s,v=g;for(;v>7;)v-=7;g+=7-v;let y=!1;for(let E=0,C=0;E<g;E++){let P=new Date(t,e,1+(E-s)),A=Yr(this._d)?Sm(P,this._d):!1,_=Sm(P,i),T=r.events.indexOf(P.toDateString())!==-1,H=E<s||E>=o+s,G=1+(E-s),U=e,V=t,X=r.startRange&&Sm(r.startRange,P),ne=r.endRange&&Sm(r.endRange,P),Q=r.startRange&&r.endRange&&r.startRange<P&&P<r.endRange,te=r.minDate&&P<r.minDate||r.maxDate&&P>r.maxDate||r.disableWeekends&&Hse(P)||r.disableDayFn&&r.disableDayFn(P);H&&(E<s?(G=f+G,U=u,V=h):(G=G-o,U=c,V=d));let pe={day:G,month:U,year:V,hasEvent:T,isSelected:A,isToday:_,isDisabled:te,isEmpty:H,isStartRange:X,isEndRange:ne,isInRange:Q,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&A&&(y=!0),l.push(Dse(pe)),++C===7&&(r.showWeekNumber&&l.unshift($se(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(Lse(l,r.isRTL,r.pickWholeWeek,y)),l=[],C=0,y=!1)}return Bse(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),XC(this.el,"is-hidden"),this._o.bound&&(Po(pi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&hs(pi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),qC(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),hs(this.el,"mousedown",this._onMouseDown,!0),hs(this.el,"touchend",this._onMouseDown,!0),hs(this.el,"change",this._onChange),t.keyboardInput&&hs(pi(),"keydown",this._onKeyChange),t.field&&(hs(t.field,"change",this._onInputChange),t.bound&&(hs(t.trigger,"click",this._onInputClick),hs(t.trigger,"focus",this._onInputFocus),hs(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function jse(t,e){Use(t,e),e.add(t)}function Use(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yO(t,e,n){return(e=zse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zse(t){var e=Yse(t,"string");return typeof e=="symbol"?e:e+""}function Yse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aL="date",CO="dateEditor",Gse="DD/MM/YYYY";var Rm=new WeakSet;class lL extends xu{constructor(){super(...arguments),jse(this,Rm),yO(this,"parentDestroyed",!1),yO(this,"$datePicker",null)}static get EDITOR_TYPE(){return aL}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof AR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(we(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();we(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{ve(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:CO})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(CO),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=JC(Rm,this,ZC).call(this),r=this.hot.view.isMouseDown(),i=e?NE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new AR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&dg(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:JC(Rm,this,ZC).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Z(a).format(JC(Rm,this,ZC).call(this))),this.setValue(a),i&&i(),Bo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+ln(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Qt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function ZC(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:Gse}const Kse="dropdown";class uL extends FM{static get EDITOR_TYPE(){return Kse}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const qse="numeric";class cL extends xu{static get EDITOR_TYPE(){return qse}}function Xse(t,e,n){return(e=Jse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jse(t){var e=Zse(t,"string");return typeof e=="symbol"?e:e+""}function Zse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qse="password";class hL extends xu{constructor(){super(...arguments),Xse(this,"autoResize",rL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Qse}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Ko(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const QC="ht_editor_visible",bO="selectEditor",eae="select";class dL extends wh{static get EDITOR_TYPE(){return eae}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Tu()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ve(this.selectWrapper,QC)&&we(this.selectWrapper,QC),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Ko(this.select),ke(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,_u(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,QC)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:bO};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(bO)}}const tae="time";class fL extends xu{static get EDITOR_TYPE(){return tae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function nae(){Mr(wh),Mr(FM),Mr(sL),Mr(lL),Mr(uL),Mr(LM),Mr(cL),Mr(hL),Mr(dL),Mr(xu),Mr(fL)}const rae="html";function WM(t,e,n,r,i,o,s){vg.apply(this,[t,e,n,r,i,o,s]),_u(e,o??"",!1)}WM.RENDERER_TYPE=rae;const iae="autocomplete";function yh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?WM:Xs,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Tu()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new Ri(t);t.acArrowListener=function(d){ve(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}yh.RENDERER_TYPE=iae;const oae="dropdown";function BM(t,e,n,r,i,o,s){yh.apply(this,[t,e,n,r,i,o,s])}BM.RENDERER_TYPE=oae;const SO=new WeakMap,RO=new WeakMap,sae="htBadValue",Qc="data-row",eh="data-col",aae="checkboxRenderer",gL="checkbox";oe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===gL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function jM(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;vg.apply(this,[t,e,n,r,i,o,s]),lae(t);let u=uae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Ko(e),o===s.checkedTemplate||Rt(o).toLocaleLowerCase(s.locale)===Rt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Rt(o).toLocaleLowerCase(s.locale)===Rt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Yt(o)?q(u,"noValue"):(u.style.display="none",q(u,sae),h=!0),be(u,[[Qc,n],[eh,r]]),l&&be(u,[Ef(u.checked?t.getTranslatedPhrase(HM):t.getTranslatedPhrase(NM)),gk(u.checked),b8()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);v=E!==null?E:""}const y=cae(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),SO.has(t)||(SO.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),E={group:aae,relativeToGroup:qa,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const C=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(C==null?void 0:C.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],E)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),E=[],C=new Map;let P=[],A=0;if(y){for(let _=0;_<y.length;_++){const{row:T,col:H}=y[_].getTopStartCorner(),{row:G,col:U}=y[_].getBottomEndCorner();for(let V=T;V<=G;V+=1)for(let X=H;X<=U;X+=1){const ne=t.getCellMeta(V,X);if(ne.hidden)continue;const Q={checkedTemplate:ne.checkedTemplate,uncheckedTemplate:ne.uncheckedTemplate};if(ne.type!=="checkbox"){v===!0&&!ne.readOnly&&(C.has(E.length)?C.set(E.length,[...C.get(E.length),[V,X,null]]):C.set(E.length,[[V,X,null]]));continue}if(ne.readOnly===!0)continue;typeof ne.checkedTemplate>"u"&&(ne.checkedTemplate=!0),typeof ne.uncheckedTemplate>"u"&&(ne.uncheckedTemplate=!1);const te=t.getDataAtCell(V,X);v===!1?[ne.checkedTemplate,ne.checkedTemplate.toString()].includes(te)?P.push([V,X,ne.uncheckedTemplate,Q]):[ne.uncheckedTemplate,ne.uncheckedTemplate.toString(),null,void 0].includes(te)&&P.push([V,X,ne.checkedTemplate,Q]):P.push([V,X,ne.uncheckedTemplate,Q]),A+=1}E.push(A),A=0}P.every(_=>{let[,,T]=_;return T===P[0][2]})?P=P.map(_=>{let[T,H,G]=_;return[T,H,G]}):P=P.map(_=>{let[T,H,,G]=_;return[T,H,G.checkedTemplate]}),P.length>0&&E.forEach((_,T)=>{let H=P.splice(0,_);C.size&&C.has(T)&&(H=[...H,...C.get(T)]),t.setDataAtCell(H)})}}function g(){const v=t.getSelectedRange();if(v){for(let y=0;y<v.length;y++){const E=v[y].getTopStartCorner(),C=v[y].getBottomEndCorner();for(let P=E.row;P<=C.row;P++)for(let A=E.col;A<=C.col;A++){if(t.getCellMeta(P,A).readOnly)continue;const T=t.getCell(P,A);if(Uo(T)&&T.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}jM.RENDERER_TYPE=gL;function lae(t){let e=RO.get(t);if(!e){const{rootElement:n}=t;e=new Ri(t),e.addEventListener(n,"click",r=>dae(r,t)),e.addEventListener(n,"mouseup",r=>hae(r,t)),e.addEventListener(n,"change",r=>fae(r,t)),RO.set(t,e)}return e}function uae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function cae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function hae(t,e){const{target:n}=t;UM(n)&&(!n.hasAttribute(Qc)||!n.hasAttribute(eh)||setTimeout(e.listen,10))}function dae(t,e){const{target:n}=t;if(!UM(n)||!n.hasAttribute(Qc)||!n.hasAttribute(eh))return;const r=parseInt(n.getAttribute(Qc),10),i=parseInt(n.getAttribute(eh),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function fae(t,e){const{target:n}=t;if(!UM(n)||!n.hasAttribute(Qc)||!n.hasAttribute(eh))return;const r=parseInt(n.getAttribute(Qc),10),i=parseInt(n.getAttribute(eh),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function UM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const gae="handsontable";function zM(t,e,n,r,i,o,s){yh.apply(this,[t,e,n,r,i,o,s])}zM.RENDERER_TYPE=gae;var mae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var eb,EO;function wae(){return EO||(EO=1,eb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),eb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var tb,TO;function mL(){if(TO)return tb;TO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let v="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let T=0;T<t.length;T++){let H=t[T];if(v=l.replace(RegExp(`([0-9 ])(${H.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*H.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let C=h(E);if(C&&C!=="."&&(v=l.replace(new RegExp(`${e(C)}$`),""),v!==l))return n(v,u,c,h,d,f);let P={};Object.keys(f).forEach(T=>{P[f[T]]=T});let A=Object.keys(P).sort().reverse(),_=A.length;for(let T=0;T<_;T++){let H=A[T],G=P[H];if(v=l.replace(H,""),v!==l){let U;switch(G){case"thousand":U=Math.pow(10,3);break;case"million":U=Math.pow(10,6);break;case"billion":U=Math.pow(10,9);break;case"trillion":U=Math.pow(10,12);break}return n(v,u,c,h,d,f)*U}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let v=r(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=KM();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),v=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,g,v);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return tb={unformat:a},tb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var nb,MO;function YM(){if(MO)return nb;MO=1;let t=mL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,E){let C=d(y),P=g(E);return C&&P}function d(y){return t.unformat(y)!==void 0}function f(y,E,C,P=!1){let A=Object.keys(y).map(_=>{if(!E[_])return console.error(`${C} Invalid key: ${_}`),!1;let T=y[_],H=E[_];if(typeof H=="string"&&(H={type:H}),H.type==="format"){if(!f(T,u,`[Validate ${_}]`,!0))return!1}else if(typeof T!==H.type)return console.error(`${C} ${_} type mismatched: "${H.type}" expected, "${typeof T}" provided`),!1;if(H.restrictions&&H.restrictions.length){let G=H.restrictions.length;for(let U=0;U<G;U++){let{restriction:V,message:X}=H.restrictions[U];if(!V(T,y))return console.error(`${C} ${_} invalid value: ${X}`),!1}}return H.restriction&&!H.restriction(T,y)?(console.error(`${C} ${_} invalid value: ${H.message}`),!1):H.validValues&&H.validValues.indexOf(T)===-1?(console.error(`${C} ${_} invalid value: must be among ${JSON.stringify(H.validValues)}, "${T}" provided`),!1):!(H.children&&!f(T,H.children,`[Validate ${_}]`))});return P||A.push(...Object.keys(E).map(_=>{let T=E[_];if(typeof T=="string"&&(T={type:T}),T.mandatory){let H=T.mandatory;if(typeof H=="function"&&(H=H(y)),H&&y[_]===void 0)return console.error(`${C} Missing mandatory key "${_}"`),!1}return!0})),A.reduce((_,T)=>_&&T,!0)}function g(y){return f(y,u,"[Validate format]")}function v(y){return f(y,c,"[Validate language]")}return nb={validate:h,validateFormat:g,validateInput:d,validateLanguage:v},nb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function vae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function yae(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function Cae(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function bae(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Sae(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function Rae(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function Eae(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function Tae(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function Mae(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function _ae(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Pae(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function xae(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function Iae(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function Oae(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Aae(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Hae(t,e={}){return typeof t!="string"?t:(t=vae(t,e),t=yae(t,e),Cae(t,e),Rae(t,e),Eae(t,e),Iae(t,e),_ae(t,e),Pae(t,e),Tae(t,e),xae(t,e),Mae(t,e),bae(t,e),Sae(t,e),Oae(t,e),Aae(t,e),e)}var GM={parseFormat:Hae};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var rb,_O;function KM(){if(_O)return rb;_O=1;const t=wae(),e=YM(),n=GM;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,rb=r,rb}function Nae(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Dae(t,e){t.forEach(n=>{let r;try{r=Nae(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var kae=t=>({loadLanguagesInNode:e=>Dae(e,t)}),pL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(T){var H,G,U,V=p.prototype={constructor:p,toString:null,valueOf:null},X=new p(1),ne=20,Q=4,te=-7,pe=21,et=-1e7,Re=1e7,Ae=!1,ot=1,_n=0,st={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function p(b,R){var S,$,x,N,B,O,D,W,F=this;if(!(F instanceof p))return new p(b,R);if(R==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>Re?F.c=F.e=null:b.e<et?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((O=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(N=0,B=b;B>=10;B/=10,N++);N>Re?F.c=F.e=null:(F.e=N,F.c=[b]);return}W=String(b)}else{if(!r.test(W=String(b)))return U(F,W,O);F.s=W.charCodeAt(0)==45?(W=W.slice(1),-1):1}(N=W.indexOf("."))>-1&&(W=W.replace(".","")),(B=W.search(/e/i))>0?(N<0&&(N=B),N+=+W.slice(B+1),W=W.substring(0,B)):N<0&&(N=W.length)}else{if(C(R,2,m.length,"Base"),R==10&&w)return F=new p(b),K(F,ne+F.e+1,Q);if(W=String(b),O=typeof b=="number"){if(b*0!=0)return U(F,W,O,R);if(F.s=1/b<0?(W=W.slice(1),-1):1,p.DEBUG&&W.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=W.charCodeAt(0)===45?(W=W.slice(1),-1):1;for(S=m.slice(0,R),N=B=0,D=W.length;B<D;B++)if(S.indexOf($=W.charAt(B))<0){if($=="."){if(B>N){N=D;continue}}else if(!x&&(W==W.toUpperCase()&&(W=W.toLowerCase())||W==W.toLowerCase()&&(W=W.toUpperCase()))){x=!0,B=-1,N=0;continue}return U(F,String(b),O,R)}O=!1,W=G(W,R,10,F.s),(N=W.indexOf("."))>-1?W=W.replace(".",""):N=W.length}for(B=0;W.charCodeAt(B)===48;B++);for(D=W.length;W.charCodeAt(--D)===48;);if(W=W.slice(B,++D)){if(D-=B,O&&p.DEBUG&&D>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((N=N-B-1)>Re)F.c=F.e=null;else if(N<et)F.c=[F.e=0];else{if(F.e=N,F.c=[],B=(N+1)%u,N<0&&(B+=u),B<D){for(B&&F.c.push(+W.slice(0,B)),D-=u;B<D;)F.c.push(+W.slice(B,B+=u));B=u-(W=W.slice(B)).length}else B-=D;for(;B--;W+="0");F.c.push(+W)}}else F.c=[F.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],C(S,0,f,R),ne=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],C(S,0,8,R),Q=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(C(S[0],-1e9,0,R),C(S[1],0,f,R),te=S[0],pe=S[1]):(C(S,-1e9,f,R),te=-(pe=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)C(S[0],-1e9,-1,R),C(S[1],1,f,R),et=S[0],Re=S[1];else if(C(S,-1e9,f,R),S)et=-(Re=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ae=S;else throw Ae=!S,Error(s+"crypto unavailable");else Ae=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],C(S,0,9,R),ot=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],C(S,0,f,R),_n=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")st=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))w=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:ne,ROUNDING_MODE:Q,EXPONENTIAL_AT:[te,pe],RANGE:[et,Re],CRYPTO:Ae,MODULO_MODE:ot,POW_PRECISION:_n,FORMAT:st,ALPHABET:m}},p.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,S,$=b.c,x=b.e,N=b.s;e:if({}.toString.call($)=="[object Array]"){if((N===1||N===-1)&&x>=-1e9&&x<=f&&x===o(x)){if($[0]===0){if(x===0&&$.length===1)return!0;break e}if(R=(x+1)%u,R<1&&(R+=u),String($[0]).length==R){for(R=0;R<$.length;R++)if(S=$[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if($===null&&x===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},p.maximum=p.max=function(){return L(arguments,-1)},p.minimum=p.min=function(){return L(arguments,1)},p.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var $,x,N,B,O,D=0,W=[],F=new p(X);if(S==null?S=ne:C(S,0,f),B=i(S/u),Ae)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(B*=2));D<B;)O=$[D]*131072+($[D+1]>>>11),O>=9e15?(x=crypto.getRandomValues(new Uint32Array(2)),$[D]=x[0],$[D+1]=x[1]):(W.push(O%1e14),D+=2);D=B/2}else if(crypto.randomBytes){for($=crypto.randomBytes(B*=7);D<B;)O=($[D]&31)*281474976710656+$[D+1]*1099511627776+$[D+2]*4294967296+$[D+3]*16777216+($[D+4]<<16)+($[D+5]<<8)+$[D+6],O>=9e15?crypto.randomBytes(7).copy($,D):(W.push(O%1e14),D+=7);D=B/7}else throw Ae=!1,Error(s+"crypto unavailable");if(!Ae)for(;D<B;)O=R(),O<9e15&&(W[D++]=O%1e14);for(B=W[--D],S%=u,B&&S&&(O=h[u-S],W[D]=o(B/O)*O);W[D]===0;W.pop(),D--);if(D<0)W=[N=0];else{for(N=-1;W[0]===0;W.splice(0,1),N-=u);for(D=1,O=W[0];O>=10;O/=10,D++);D<u&&(N-=u-D)}return F.e=N,F.c=W,F}}(),p.sum=function(){for(var b=1,R=arguments,S=new p(R[0]);b<R.length;)S=S.plus(R[b++]);return S},G=function(){var b="0123456789";function R(S,$,x,N){for(var B,O=[0],D,W=0,F=S.length;W<F;){for(D=O.length;D--;O[D]*=$);for(O[0]+=N.indexOf(S.charAt(W++)),B=0;B<O.length;B++)O[B]>x-1&&(O[B+1]==null&&(O[B+1]=0),O[B+1]+=O[B]/x|0,O[B]%=x)}return O.reverse()}return function(S,$,x,N,B){var O,D,W,F,Y,ae,ce,_e,Fe=S.indexOf("."),ze=ne,Me=Q;for(Fe>=0&&(F=_n,_n=0,S=S.replace(".",""),_e=new p($),ae=_e.pow(S.length-Fe),_n=F,_e.c=R(_(y(ae.c),ae.e,"0"),10,x,b),_e.e=_e.c.length),ce=R(S,$,x,B?(O=m,b):(O=b,m)),W=F=ce.length;ce[--F]==0;ce.pop());if(!ce[0])return O.charAt(0);if(Fe<0?--W:(ae.c=ce,ae.e=W,ae.s=N,ae=H(ae,_e,ze,Me,x),ce=ae.c,Y=ae.r,W=ae.e),D=W+ze+1,Fe=ce[D],F=x/2,Y=Y||D<0||ce[D+1]!=null,Y=Me<4?(Fe!=null||Y)&&(Me==0||Me==(ae.s<0?3:2)):Fe>F||Fe==F&&(Me==4||Y||Me==6&&ce[D-1]&1||Me==(ae.s<0?8:7)),D<1||!ce[0])S=Y?_(O.charAt(1),-ze,O.charAt(0)):O.charAt(0);else{if(ce.length=D,Y)for(--x;++ce[--D]>x;)ce[D]=0,D||(++W,ce=[1].concat(ce));for(F=ce.length;!ce[--F];);for(Fe=0,S="";Fe<=F;S+=O.charAt(ce[Fe++]));S=_(S,W,O.charAt(0))}return S}}(),H=function(){function b($,x,N){var B,O,D,W,F=0,Y=$.length,ae=x%d,ce=x/d|0;for($=$.slice();Y--;)D=$[Y]%d,W=$[Y]/d|0,B=ce*D+W*ae,O=ae*D+B%d*d+F,F=(O/N|0)+(B/d|0)+ce*W,$[Y]=O%N;return F&&($=[F].concat($)),$}function R($,x,N,B){var O,D;if(N!=B)D=N>B?1:-1;else for(O=D=0;O<N;O++)if($[O]!=x[O]){D=$[O]>x[O]?1:-1;break}return D}function S($,x,N,B){for(var O=0;N--;)$[N]-=O,O=$[N]<x[N]?1:0,$[N]=O*B+$[N]-x[N];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,x,N,B,O){var D,W,F,Y,ae,ce,_e,Fe,ze,Me,Ve,Tt,Oi,ns,ri,Mt,fn,Ct=$.s==x.s?1:-1,_t=$.c,We=x.c;if(!_t||!_t[0]||!We||!We[0])return new p(!$.s||!x.s||(_t?We&&_t[0]==We[0]:!We)?NaN:_t&&_t[0]==0||!We?Ct*0:Ct/0);for(Fe=new p(Ct),ze=Fe.c=[],W=$.e-x.e,Ct=N+W+1,O||(O=l,W=v($.e/u)-v(x.e/u),Ct=Ct/u|0),F=0;We[F]==(_t[F]||0);F++);if(We[F]>(_t[F]||0)&&W--,Ct<0)ze.push(1),Y=!0;else{for(ns=_t.length,Mt=We.length,F=0,Ct+=2,ae=o(O/(We[0]+1)),ae>1&&(We=b(We,ae,O),_t=b(_t,ae,O),Mt=We.length,ns=_t.length),Oi=Mt,Me=_t.slice(0,Mt),Ve=Me.length;Ve<Mt;Me[Ve++]=0);fn=We.slice(),fn=[0].concat(fn),ri=We[0],We[1]>=O/2&&ri++;do{if(ae=0,D=R(We,Me,Mt,Ve),D<0){if(Tt=Me[0],Mt!=Ve&&(Tt=Tt*O+(Me[1]||0)),ae=o(Tt/ri),ae>1)for(ae>=O&&(ae=O-1),ce=b(We,ae,O),_e=ce.length,Ve=Me.length;R(ce,Me,_e,Ve)==1;)ae--,S(ce,Mt<_e?fn:We,_e,O),_e=ce.length,D=1;else ae==0&&(D=ae=1),ce=We.slice(),_e=ce.length;if(_e<Ve&&(ce=[0].concat(ce)),S(Me,ce,Ve,O),Ve=Me.length,D==-1)for(;R(We,Me,Mt,Ve)<1;)ae++,S(Me,Mt<Ve?fn:We,Ve,O),Ve=Me.length}else D===0&&(ae++,Me=[0]);ze[F++]=ae,Me[0]?Me[Ve++]=_t[Oi]||0:(Me=[_t[Oi]],Ve=1)}while((Oi++<ns||Me[0]!=null)&&Ct--);Y=Me[0]!=null,ze[0]||ze.splice(0,1)}if(O==l){for(F=1,Ct=ze[0];Ct>=10;Ct/=10,F++);K(Fe,N+(Fe.e=F+W*u-1)+1,B,Y)}else Fe.e=W,Fe.r=+Y;return Fe}}();function I(b,R,S,$){var x,N,B,O,D;if(S==null?S=Q:C(S,0,8),!b.c)return b.toString();if(x=b.c[0],B=b.e,R==null)D=y(b.c),D=$==1||$==2&&(B<=te||B>=pe)?A(D,B):_(D,B,"0");else if(b=K(new p(b),R,S),N=b.e,D=y(b.c),O=D.length,$==1||$==2&&(R<=N||N<=te)){for(;O<R;D+="0",O++);D=A(D,N)}else if(R-=B,D=_(D,N,"0"),N+1>O){if(--R>0)for(D+=".";R--;D+="0");}else if(R+=N-O,R>0)for(N+1==O&&(D+=".");R--;D+="0");return b.s<0&&x?"-"+D:D}function L(b,R){for(var S,$,x=1,N=new p(b[0]);x<b.length;x++)$=new p(b[x]),(!$.s||(S=E(N,$))===R||S===0&&N.s===R)&&(N=$);return N}function j(b,R,S){for(var $=1,x=R.length;!R[--x];R.pop());for(x=R[0];x>=10;x/=10,$++);return(S=$+S*u-1)>Re?b.c=b.e=null:S<et?b.c=[b.e=0]:(b.e=S,b.c=R),b}U=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,B,O,D){var W,F=O?B:B.replace(x,"");if($.test(F))N.s=isNaN(F)?null:F<0?-1:1;else{if(!O&&(F=F.replace(b,function(Y,ae,ce){return W=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!D||D==W?ae:Y}),D&&(W=D,F=F.replace(R,"$1").replace(S,"0.$1")),B!=F))return new p(F,W);if(p.DEBUG)throw Error(s+"Not a"+(D?" base "+D:"")+" number: "+B);N.s=null}N.c=N.e=null}}();function K(b,R,S,$){var x,N,B,O,D,W,F,Y=b.c,ae=h;if(Y){e:{for(x=1,O=Y[0];O>=10;O/=10,x++);if(N=R-x,N<0)N+=u,B=R,D=Y[W=0],F=o(D/ae[x-B-1]%10);else if(W=i((N+1)/u),W>=Y.length)if($){for(;Y.length<=W;Y.push(0));D=F=0,x=1,N%=u,B=N-u+1}else break e;else{for(D=O=Y[W],x=1;O>=10;O/=10,x++);N%=u,B=N-u+x,F=B<0?0:o(D/ae[x-B-1]%10)}if($=$||R<0||Y[W+1]!=null||(B<0?D:D%ae[x-B-1]),$=S<4?(F||$)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||$||S==6&&(N>0?B>0?D/ae[x-B]:0:Y[W-1])%10&1||S==(b.s<0?8:7)),R<1||!Y[0])return Y.length=0,$?(R-=b.e+1,Y[0]=ae[(u-R%u)%u],b.e=-R||0):Y[0]=b.e=0,b;if(N==0?(Y.length=W,O=1,W--):(Y.length=W+1,O=ae[u-N],Y[W]=B>0?o(D/ae[x-B]%ae[B])*O:0),$)for(;;)if(W==0){for(N=1,B=Y[0];B>=10;B/=10,N++);for(B=Y[0]+=O,O=1;B>=10;B/=10,O++);N!=O&&(b.e++,Y[0]==l&&(Y[0]=1));break}else{if(Y[W]+=O,Y[W]!=l)break;Y[W--]=0,O=1}for(N=Y.length;Y[--N]===0;Y.pop());}b.e>Re?b.c=b.e=null:b.e<et&&(b.c=[b.e=0])}return b}function J(b){var R,S=b.e;return S===null?b.toString():(R=y(b.c),R=S<=te||S>=pe?A(R,S):_(R,S,"0"),b.s<0?"-"+R:R)}return V.absoluteValue=V.abs=function(){var b=new p(this);return b.s<0&&(b.s=1),b},V.comparedTo=function(b,R){return E(this,new p(b,R))},V.decimalPlaces=V.dp=function(b,R){var S,$,x,N=this;if(b!=null)return C(b,0,f),R==null?R=Q:C(R,0,8),K(new p(N),b+N.e+1,R);if(!(S=N.c))return null;if($=((x=S.length-1)-v(this.e/u))*u,x=S[x])for(;x%10==0;x/=10,$--);return $<0&&($=0),$},V.dividedBy=V.div=function(b,R){return H(this,new p(b,R),ne,Q)},V.dividedToIntegerBy=V.idiv=function(b,R){return H(this,new p(b,R),0,1)},V.exponentiatedBy=V.pow=function(b,R){var S,$,x,N,B,O,D,W,F,Y=this;if(b=new p(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+J(b));if(R!=null&&(R=new p(R)),O=b.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!b.c||!b.c[0])return F=new p(Math.pow(+J(Y),O?b.s*(2-P(b)):+J(b))),R?F.mod(R):F;if(D=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);$=!D&&Y.isInteger()&&R.isInteger(),$&&(Y=Y.mod(R))}else{if(b.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||O&&Y.c[1]>=24e7:Y.c[0]<8e13||O&&Y.c[0]<=9999975e7)))return N=Y.s<0&&P(b)?-0:0,Y.e>-1&&(N=1/N),new p(D?1/N:N);_n&&(N=i(_n/u+2))}for(O?(S=new p(.5),D&&(b.s=1),W=P(b)):(x=Math.abs(+J(b)),W=x%2),F=new p(X);;){if(W){if(F=F.times(Y),!F.c)break;N?F.c.length>N&&(F.c.length=N):$&&(F=F.mod(R))}if(x){if(x=o(x/2),x===0)break;W=x%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)W=P(b);else{if(x=+J(b),x===0)break;W=x%2}Y=Y.times(Y),N?Y.c&&Y.c.length>N&&(Y.c.length=N):$&&(Y=Y.mod(R))}return $?F:(D&&(F=X.div(F)),R?F.mod(R):N?K(F,_n,Q,B):F)},V.integerValue=function(b){var R=new p(this);return b==null?b=Q:C(b,0,8),K(R,R.e+1,b)},V.isEqualTo=V.eq=function(b,R){return E(this,new p(b,R))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(b,R){return E(this,new p(b,R))>0},V.isGreaterThanOrEqualTo=V.gte=function(b,R){return(R=E(this,new p(b,R)))===1||R===0},V.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},V.isLessThan=V.lt=function(b,R){return E(this,new p(b,R))<0},V.isLessThanOrEqualTo=V.lte=function(b,R){return(R=E(this,new p(b,R)))===-1||R===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(b,R){var S,$,x,N,B=this,O=B.s;if(b=new p(b,R),R=b.s,!O||!R)return new p(NaN);if(O!=R)return b.s=-R,B.plus(b);var D=B.e/u,W=b.e/u,F=B.c,Y=b.c;if(!D||!W){if(!F||!Y)return F?(b.s=-R,b):new p(Y?B:NaN);if(!F[0]||!Y[0])return Y[0]?(b.s=-R,b):new p(F[0]?B:Q==3?-0:0)}if(D=v(D),W=v(W),F=F.slice(),O=D-W){for((N=O<0)?(O=-O,x=F):(W=D,x=Y),x.reverse(),R=O;R--;x.push(0));x.reverse()}else for($=(N=(O=F.length)<(R=Y.length))?O:R,O=R=0;R<$;R++)if(F[R]!=Y[R]){N=F[R]<Y[R];break}if(N&&(x=F,F=Y,Y=x,b.s=-b.s),R=($=Y.length)-(S=F.length),R>0)for(;R--;F[S++]=0);for(R=l-1;$>O;){if(F[--$]<Y[$]){for(S=$;S&&!F[--S];F[S]=R);--F[S],F[$]+=l}F[$]-=Y[$]}for(;F[0]==0;F.splice(0,1),--W);return F[0]?j(b,F,W):(b.s=Q==3?-1:1,b.c=[b.e=0],b)},V.modulo=V.mod=function(b,R){var S,$,x=this;return b=new p(b,R),!x.c||!b.s||b.c&&!b.c[0]?new p(NaN):!b.c||x.c&&!x.c[0]?new p(x):(ot==9?($=b.s,b.s=1,S=H(x,b,0,3),b.s=$,S.s*=$):S=H(x,b,0,ot),b=x.minus(S.times(b)),!b.c[0]&&ot==1&&(b.s=x.s),b)},V.multipliedBy=V.times=function(b,R){var S,$,x,N,B,O,D,W,F,Y,ae,ce,_e,Fe,ze,Me=this,Ve=Me.c,Tt=(b=new p(b,R)).c;if(!Ve||!Tt||!Ve[0]||!Tt[0])return!Me.s||!b.s||Ve&&!Ve[0]&&!Tt||Tt&&!Tt[0]&&!Ve?b.c=b.e=b.s=null:(b.s*=Me.s,!Ve||!Tt?b.c=b.e=null:(b.c=[0],b.e=0)),b;for($=v(Me.e/u)+v(b.e/u),b.s*=Me.s,D=Ve.length,Y=Tt.length,D<Y&&(_e=Ve,Ve=Tt,Tt=_e,x=D,D=Y,Y=x),x=D+Y,_e=[];x--;_e.push(0));for(Fe=l,ze=d,x=Y;--x>=0;){for(S=0,ae=Tt[x]%ze,ce=Tt[x]/ze|0,B=D,N=x+B;N>x;)W=Ve[--B]%ze,F=Ve[B]/ze|0,O=ce*W+F*ae,W=ae*W+O%ze*ze+_e[N]+S,S=(W/Fe|0)+(O/ze|0)+ce*F,_e[N--]=W%Fe;_e[N]=S}return S?++$:_e.splice(0,1),j(b,_e,$)},V.negated=function(){var b=new p(this);return b.s=-b.s||null,b},V.plus=function(b,R){var S,$=this,x=$.s;if(b=new p(b,R),R=b.s,!x||!R)return new p(NaN);if(x!=R)return b.s=-R,$.minus(b);var N=$.e/u,B=b.e/u,O=$.c,D=b.c;if(!N||!B){if(!O||!D)return new p(x/0);if(!O[0]||!D[0])return D[0]?b:new p(O[0]?$:x*0)}if(N=v(N),B=v(B),O=O.slice(),x=N-B){for(x>0?(B=N,S=D):(x=-x,S=O),S.reverse();x--;S.push(0));S.reverse()}for(x=O.length,R=D.length,x-R<0&&(S=D,D=O,O=S,R=x),x=0;R;)x=(O[--R]=O[R]+D[R]+x)/l|0,O[R]=l===O[R]?0:O[R]%l;return x&&(O=[x].concat(O),++B),j(b,O,B)},V.precision=V.sd=function(b,R){var S,$,x,N=this;if(b!=null&&b!==!!b)return C(b,1,f),R==null?R=Q:C(R,0,8),K(new p(N),b,R);if(!(S=N.c))return null;if(x=S.length-1,$=x*u+1,x=S[x]){for(;x%10==0;x/=10,$--);for(x=S[0];x>=10;x/=10,$++);}return b&&N.e+1>$&&($=N.e+1),$},V.shiftedBy=function(b){return C(b,-9007199254740991,c),this.times("1e"+b)},V.squareRoot=V.sqrt=function(){var b,R,S,$,x,N=this,B=N.c,O=N.s,D=N.e,W=ne+4,F=new p("0.5");if(O!==1||!B||!B[0])return new p(!O||O<0&&(!B||B[0])?NaN:B?N:1/0);if(O=Math.sqrt(+J(N)),O==0||O==1/0?(R=y(B),(R.length+D)%2==0&&(R+="0"),O=Math.sqrt(+R),D=v((D+1)/2)-(D<0||D%2),O==1/0?R="5e"+D:(R=O.toExponential(),R=R.slice(0,R.indexOf("e")+1)+D),S=new p(R)):S=new p(O+""),S.c[0]){for(D=S.e,O=D+W,O<3&&(O=0);;)if(x=S,S=F.times(x.plus(H(N,x,W,1))),y(x.c).slice(0,O)===(R=y(S.c)).slice(0,O))if(S.e<D&&--O,R=R.slice(O-3,O+1),R=="9999"||!$&&R=="4999"){if(!$&&(K(x,x.e+ne+2,0),x.times(x).eq(N))){S=x;break}W+=4,O+=4,$=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(K(S,S.e+ne+2,1),b=!S.times(S).eq(N));break}}return K(S,S.e+ne+1,Q,b)},V.toExponential=function(b,R){return b!=null&&(C(b,0,f),b++),I(this,b,R,1)},V.toFixed=function(b,R){return b!=null&&(C(b,0,f),b=b+this.e+1),I(this,b,R)},V.toFormat=function(b,R,S){var $,x=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=st;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if($=x.toFixed(b,R),x.c){var N,B=$.split("."),O=+S.groupSize,D=+S.secondaryGroupSize,W=S.groupSeparator||"",F=B[0],Y=B[1],ae=x.s<0,ce=ae?F.slice(1):F,_e=ce.length;if(D&&(N=O,O=D,D=N,_e-=N),O>0&&_e>0){for(N=_e%O||O,F=ce.substr(0,N);N<_e;N+=O)F+=W+ce.substr(N,O);D>0&&(F+=W+ce.slice(N)),ae&&(F="-"+F)}$=Y?F+(S.decimalSeparator||"")+((D=+S.fractionGroupSize)?Y.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):Y):F}return(S.prefix||"")+$+(S.suffix||"")},V.toFraction=function(b){var R,S,$,x,N,B,O,D,W,F,Y,ae,ce=this,_e=ce.c;if(b!=null&&(O=new p(b),!O.isInteger()&&(O.c||O.s!==1)||O.lt(X)))throw Error(s+"Argument "+(O.isInteger()?"out of range: ":"not an integer: ")+J(O));if(!_e)return new p(ce);for(R=new p(X),W=S=new p(X),$=D=new p(X),ae=y(_e),N=R.e=ae.length-ce.e-1,R.c[0]=h[(B=N%u)<0?u+B:B],b=!b||O.comparedTo(R)>0?N>0?R:W:O,B=Re,Re=1/0,O=new p(ae),D.c[0]=0;F=H(O,R,0,1),x=S.plus(F.times($)),x.comparedTo(b)!=1;)S=$,$=x,W=D.plus(F.times(x=W)),D=x,R=O.minus(F.times(x=R)),O=x;return x=H(b.minus(S),$,0,1),D=D.plus(x.times(W)),S=S.plus(x.times($)),D.s=W.s=ce.s,N=N*2,Y=H(W,$,N,Q).minus(ce).abs().comparedTo(H(D,S,N,Q).minus(ce).abs())<1?[W,$]:[D,S],Re=B,Y},V.toNumber=function(){return+J(this)},V.toPrecision=function(b,R){return b!=null&&C(b,1,f),I(this,b,R,2)},V.toString=function(b){var R,S=this,$=S.s,x=S.e;return x===null?$?(R="Infinity",$<0&&(R="-"+R)):R="NaN":(b==null?R=x<=te||x>=pe?A(y(S.c),x):_(y(S.c),x,"0"):b===10&&w?(S=K(new p(S),ne+x+1,Q),R=_(y(S.c),S.e,"0")):(C(b,2,m.length,"Base"),R=G(_(y(S.c),x,"0"),10,b,$,!0)),$<0&&S.c[0]&&(R="-"+R)),R},V.valueOf=V.toJSON=function(){return J(this)},V._isBigNumber=!0,T!=null&&p.set(T),p}function v(T){var H=T|0;return T>0||T===H?H:H-1}function y(T){for(var H,G,U=1,V=T.length,X=T[0]+"";U<V;){for(H=T[U++]+"",G=u-H.length;G--;H="0"+H);X+=H}for(V=X.length;X.charCodeAt(--V)===48;);return X.slice(0,V+1||1)}function E(T,H){var G,U,V=T.c,X=H.c,ne=T.s,Q=H.s,te=T.e,pe=H.e;if(!ne||!Q)return null;if(G=V&&!V[0],U=X&&!X[0],G||U)return G?U?0:-Q:ne;if(ne!=Q)return ne;if(G=ne<0,U=te==pe,!V||!X)return U?0:!V^G?1:-1;if(!U)return te>pe^G?1:-1;for(Q=(te=V.length)<(pe=X.length)?te:pe,ne=0;ne<Q;ne++)if(V[ne]!=X[ne])return V[ne]>X[ne]^G?1:-1;return te==pe?0:te>pe^G?1:-1}function C(T,H,G,U){if(T<H||T>G||T!==o(T))throw Error(s+(U||"Argument")+(typeof T=="number"?T<H||T>G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(T))}function P(T){var H=T.c.length-1;return v(T.e/u)==H&&T.c[H]%2!=0}function A(T,H){return(T.length>1?T.charAt(0)+"."+T.slice(1):T)+(H<0?"e":"e+")+H}function _(T,H,G){var U,V;if(H<0){for(V=G+".";++H;V+=G);T=V+T}else if(U=T.length,++H>U){for(V=G,H-=U;--H;V+=G);T+=V}else H<U&&(T=T.slice(0,H)+"."+T.slice(H));return T}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(mae)})(pL);var wL=pL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Bi=KM(),$ae=YM(),Lae=GM,Fae=wL,kn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},yg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:vL,decimalSuffixes:Iw}=Bi.currentBytes(),qM={general:{scale:1024,suffixes:Iw},binary:{scale:1024,suffixes:vL},decimal:{scale:1e3,suffixes:Iw}};function Vae(t,e={},n){if(typeof e=="string"&&(e=Lae.parseFormat(e)),!$ae.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=Wae(t,e,n);return s=sle(s,i),s=ale(s,o),s}function Wae(t,e,n){switch(e.output){case"currency":return e=Cc(e,Bi.currentCurrencyDefaultFormat()),qae(t,e,Bi);case"percent":return e=Cc(e,Bi.currentPercentageDefaultFormat()),Kae(t,e,Bi,n);case"byte":return e=Cc(e,Bi.currentByteDefaultFormat()),zae(t,e,Bi,n);case"time":return e=Cc(e,Bi.currentTimeDefaultFormat()),Gae(t);case"ordinal":return e=Cc(e,Bi.currentOrdinalDefaultFormat()),Yae(t,e,Bi);case"number":default:return Cg({instance:t,providedFormat:e})}}function Bae(t){let e=qM.decimal;return Qv(t._value,e.suffixes,e.scale).suffix}function jae(t){let e=qM.binary;return Qv(t._value,e.suffixes,e.scale).suffix}function Uae(t){let e=qM.general;return Qv(t._value,e.suffixes,e.scale).suffix}function Qv(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function zae(t,e,n,r){let i=e.base||"binary",o=Object.assign({},yg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Iw,marker:"bd"},binary:{scale:1024,suffixes:s||vL,marker:"b"},decimal:{scale:1e3,suffixes:a||Iw,marker:"d"}}[i],{value:c,suffix:h}=Qv(t._value,u.suffixes,u.scale);return`${Cg({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function Yae(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},yg,e),o=Cg({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function Gae(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function Kae(t,e,n,r){let i=e.prefixSymbol,o=Cg({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},yg,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function qae(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},yg,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Cg({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function Xae({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&kn[e]?(a=r[e],t=t/kn[e]):l>=kn.trillion||n&&s(l/kn.trillion)===1?(a=r.trillion,t=t/kn.trillion):l<kn.trillion&&l>=kn.billion||n&&s(l/kn.billion)===1?(a=r.billion,t=t/kn.billion):l<kn.billion&&l>=kn.million||n&&s(l/kn.million)===1?(a=r.million,t=t/kn.million):(l<kn.million&&l>=kn.thousand||n&&s(l/kn.thousand)===1)&&(a=r.thousand,t=t/kn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function Jae({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Em(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function Zae(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Em(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Em(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Em(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Em(e)}`),n}function Qae(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?Zae(t,e):new Fae(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function ele(t,e,n,r,i,o){if(r===-1)return t;let s=Qae(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function tle(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function nle(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function rle(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),nle(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function ile(t,e){return t+e}function ole(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function sle(t,e){return e+t}function ale(t,e){return t+e}function Cg({instance:t,providedFormat:e,state:n=Bi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},yg,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,y=s.thousandSeparated,E=s.spaceSeparated,C=s.negative,P=s.forceSign,A=s.exponential,_=s.roundingFunction,T="";if(d){let G=Xae({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:_,totalLength:a});o=G.value,T+=G.abbreviation,a&&(f=G.mantissaPrecision)}if(A){let G=Jae({value:o,characteristicPrecision:l});o=G.value,T=G.abbreviation+T}let H=ele(o.toString(),o,g,f,v,_);return H=tle(H,o,u,l),H=rle(H,o,y,n,r),(d||A)&&(H=ile(H,T)),(P||o<0)&&(H=ole(H,o,C)),H}function Cc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var lle=t=>({format:(...e)=>Vae(...e,t),getByteUnit:(...e)=>Uae(...e,t),getBinaryByteUnit:(...e)=>jae(...e,t),getDecimalByteUnit:(...e)=>Bae(...e,t),formatOrDefault:Cc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ws=wL;function ule(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.plus(i).toNumber(),t}function yL(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.minus(i).toNumber(),t}function cle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.times(i).toNumber(),t}function hle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.dividedBy(i).toNumber(),t}function dle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function fle(t,e,n){let r=n(t._value);return yL(r,e,n),Math.abs(r._value)}var gle=t=>({add:(e,n)=>ule(e,n,t),subtract:(e,n)=>yL(e,n,t),multiply:(e,n)=>cle(e,n,t),divide:(e,n)=>hle(e,n,t),set:(e,n)=>dle(e,n,t),difference:(e,n)=>fle(e,n,t),BigNumber:Ws});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const mle="2.5.0",ts=KM(),ple=YM(),wle=kae(tn),vle=mL();let cl=lle(tn),Vl=gle(tn);const yle=GM;class CL{constructor(e){this._value=e}clone(){return tn(this._value)}format(e={}){return cl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=yle.parseFormat(e)),e=cl.formatOrDefault(e,ts.currentCurrencyDefaultFormat()),e.output="currency",cl.format(this,e)}formatTime(e={}){return e.output="time",cl.format(this,e)}binaryByteUnits(){return cl.getBinaryByteUnit(this)}decimalByteUnits(){return cl.getDecimalByteUnit(this)}byteUnits(){return cl.getByteUnit(this)}difference(e){return Vl.difference(this,e)}add(e){return Vl.add(this,e)}subtract(e){return Vl.subtract(this,e)}multiply(e){return Vl.multiply(this,e)}divide(e){return Vl.divide(this,e)}set(e){return Vl.set(this,bL(e))}value(){return this._value}valueOf(){return this._value}}function bL(t){let e=t;return tn.isNumbro(t)?e=t._value:typeof t=="string"?e=tn.unformat(t):isNaN(t)&&(e=NaN),e}function tn(t){return new CL(bL(t))}tn.version=mle;tn.isNumbro=function(t){return t instanceof CL};tn.language=ts.currentLanguage;tn.registerLanguage=ts.registerLanguage;tn.setLanguage=ts.setLanguage;tn.languages=ts.languages;tn.languageData=ts.languageData;tn.zeroFormat=ts.setZeroFormat;tn.defaultFormat=ts.currentDefaults;tn.setDefaults=ts.setDefaults;tn.defaultCurrencyFormat=ts.currentCurrencyDefaultFormat;tn.validate=ple.validate;tn.loadLanguagesInNode=wle.loadLanguagesInNode;tn.unformat=vle.unformat;tn.BigNumber=Vl.BigNumber;var Cle=tn,hl=pae(Cle);const ble="numeric";function SL(t,e){if(Gn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!hl.languages()[r]){const o=r.replace("-",""),s=hl.allLanguages?hl.allLanguages[r]:hl[o];s&&hl.registerLanguage(s)}hl.setLanguage(r),t=hl(t).format(i||"0")}return t}function XM(t,e,n,r,i,o,s){let a=o;if(Gn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=SL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Xs(t,e,n,r,i,a,s)}XM.RENDERER_TYPE=ble;const Sle="password";function JM(t,e,n,r,i,o,s){Xs.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),_u(e,u)}JM.RENDERER_TYPE=Sle;const Rle="select";function ZM(t,e,n,r,i,o,s){Xs.apply(this,[t,e,n,r,i,o,s])}ZM.RENDERER_TYPE=Rle;const Ele="time";function QM(t,e,n,r,i,o,s){Xs.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}QM.RENDERER_TYPE=Ele;function Tle(){jr(yh),jr(vg),jr(jM),jr(BM),jr(zM),jr(WM),jr(XM),jr(JM),jr(ZM),jr(Xs),jr(QM)}const Mle="autocomplete";function ey(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,PO(n,e)):PO(n,e)(this.source):e(!0)}ey.VALIDATOR_TYPE=Mle;function PO(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function RL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const _le=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:RL},Symbol.toStringTag,{value:"Module"})),Ple="date";function e_(t,e){const n=Xk(aL,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=xle(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}e_.VALIDATOR_TYPE=Ple;function xle(t,e){const n=Z(RL(t)),r=Z(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const Ile="dropdown";function t_(t,e){ey.apply(this,[t,e])}t_.VALIDATOR_TYPE=Ile;const Ole="numeric";function n_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Gn(t))}n_.VALIDATOR_TYPE=Ole;const Ale=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Hle="time";function r_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,Ale,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}r_.VALIDATOR_TYPE=Hle;function Nle(){zl(ey),zl(t_),zl(e_),zl(n_),zl(r_)}const Dle="autocomplete",kle={CELL_TYPE:Dle,editor:FM,renderer:yh,validator:ey},$le="checkbox",Lle={CELL_TYPE:$le,editor:sL,renderer:jM},Fle="date";function EL(t,e,n,r,i,o,s){yh.apply(this,[t,e,n,r,i,o,s])}EL.RENDERER_TYPE=Fle;const Vle="date",Wle={CELL_TYPE:Vle,editor:lL,renderer:EL,validator:e_},Ble="dropdown",jle={CELL_TYPE:Ble,editor:uL,renderer:BM,validator:t_,filter:!1,strict:!0},Ule="handsontable",zle={CELL_TYPE:Ule,editor:LM,renderer:zM},Yle="numeric",Gle={CELL_TYPE:Yle,editor:cL,renderer:XM,validator:n_,dataType:"number"},Kle="password",qle={CELL_TYPE:Kle,editor:hL,renderer:JM,copyable:!1},Xle="select",Jle={CELL_TYPE:Xle,editor:dL,renderer:ZM},Zle="time",Qle={CELL_TYPE:Zle,editor:fL,renderer:QM,validator:r_};function eue(){ci(kle),ci(Lle),ci(Wle),ci(jle),ci(zle),ci(Gle),ci(qle),ci(Jle),ci(iL),ci(Qle)}function tue(t,e){TL(t,e),e.add(t)}function nue(t,e,n){TL(t,e),e.set(t,n)}function TL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uu(t,e,n){return(e=rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rue(t){var e=iue(t,"string");return typeof e=="symbol"?e:e+""}function iue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zu(t,e){return t.get(ML(t,e))}function ML(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xO=new Map([["plugin",hQ],["cell-type",K$],["editor",qk],["renderer",o$],["validator",s$]]),_L=Symbol("mainSetting"),oue="base",Tm=[];let dl=null;var fl=new WeakMap,IO=new WeakSet;class qe{static get PLUGIN_KEY(){return oue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){tue(this,IO),Uu(this,"eventManager",new Ri(this)),Uu(this,"pluginName",null),Uu(this,"pluginsInitializedCallbacks",[]),Uu(this,"isPluginsReady",!1),Uu(this,"enabled",!1),Uu(this,"initialized",!1),nue(this,fl,{}),es(this,"hot",e,{writable:!1}),dl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!xO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);xO.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Tm.push(o)}}if(dl||(dl=WE()),dl.indexOf(this.pluginName)>=0&&dl.splice(dl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),dl.length===0){if(Tm.length>0){const i=[`${Tm.join(`
`)}
`,"You have to import and register them manually."].join("");throw Tm.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||De(n))&&r[_L]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(De(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){zu(fl,this)[e]=zu(fl,this)[e]||[];const i=zu(fl,this)[e];this.hot.addHook(e,n,r),i.push(n),zu(fl,this)[e]=i}removeHooks(e){M(zu(fl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=zu(fl,this);ke(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){M(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=ML(IO,this,sue).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ke(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function sue(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function gl(t,e,n){return(e=aue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aue(t){var e=lue(t,"string");return typeof e=="symbol"?e:e+""}function lue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let i_=class{constructor(e){gl(this,"hot",null),gl(this,"container",null),gl(this,"injected",!1),gl(this,"rows",[]),gl(this,"columns",[]),gl(this,"samples",null),gl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),M(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),M(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{M(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{M(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{M(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),M(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{M(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Mm(t,e,n){return(e=uue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uue(t){var e=cue(t,"string");return typeof e=="symbol"?e:e+""}function cue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ty{static get SAMPLE_COUNT(){return 3}constructor(e){Mm(this,"samples",null),Mm(this,"dataFactory",null),Mm(this,"customSampleCount",null),Mm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:ty.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:De(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Rt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function hue(t,e){PL(t,e),e.add(t)}function ib(t,e,n){PL(t,e),e.set(t,n)}function PL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ed(t,e,n){return(e=due(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function due(t){var e=fue(t,"string");return typeof e=="symbol"?e:e+""}function fue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ia(t,e){return t.get(xr(t,e))}function Ow(t,e,n){return t.set(xr(t,e),n),n}function xr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutoColumnSizeSeed");const ob="autoColumnSize",gue=10,mue="autoColumnSize";var o_=new WeakMap,bc=new WeakMap,th=new WeakMap,Ur=new WeakSet;class Xd extends qe{static get PLUGIN_KEY(){return ob}static get PLUGIN_PRIORITY(){return gue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),hue(this,Ur),ed(this,"ghostTable",new i_(this.hot)),ed(this,"samplesGenerator",new ty((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ed(this,"inProgress",!1),ed(this,"measuredColumns",0),ed(this,"columnWidthsMap",new Ka),ib(this,o_,!1),ib(this,bc,[]),ib(this,th,[]),this.hot.columnIndexMapper.registerMap(mue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>xr(Ur,this,OO).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[ob]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(Ur,e,vue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(Ur,e,yue).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(Ur,e,bue).call(e,...i)}),this.addHook("beforeRender",()=>xr(Ur,this,wue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>xr(Ur,this,Cue).call(this)),super.enablePlugin()}updatePlugin(){Ow(th,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>xr(Ur,this,OO).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&xr(Ur,this,xL).call(this,s,o)}),this.ghostTable.columns.length&&(xr(Ur,this,IL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Pf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Xd.CALCULATION_STEP,i)},e,n),r=r+Xd.CALCULATION_STEP+1,r<i?o=_f(s):(Pf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[ob];let n=Xd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return De(e)&&(n=e.syncLimit,mE(n)?n=FE(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Jc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Ia(bc,this).length;return(s-1<o||Ia(bc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Ia(bc,this).push(i):Ia(bc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function pue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||xr(Ur,this,xL).call(this,n,e))}),this.ghostTable.columns.length&&(xr(Ur,this,IL).call(this),this.ghostTable.clean())}function xL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function IL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function wue(){this.calculateVisibleColumnsWidth(),this.inProgress||(xr(Ur,this,pue).call(this,Ia(th,this)),Ow(th,this,[]))}function vue(t,e){e||this.recalculateAllColumnsWidth()}function yue(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Ia(th,this).push(...e)}function OO(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function Cue(){Ow(bc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Ow(o_,this,!0)}function bue(t){if(!Ia(o_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Ia(th,this).push(...e)}const Kl={horizontal:"horizontal",vertical:"vertical"};function Sue(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function Rue(t){const e={};return t===!0?(e.directions=Object.keys(Kl),e.autoInsertRow=!0):De(t)?(le(t.autoInsertRow)?t.direction===Kl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Kl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Eue(t,e){Tue(t,e),e.add(t)}function Tue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yu(t,e,n){return(e=Mue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mue(t){var e=_ue(t,"string");return typeof e=="symbol"?e:e+""}function _ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function td(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutofillRange");oe.getSingleton().register("beforeAutofill");oe.getSingleton().register("afterAutofill");const AO="autofill",Pue=20,xue=["fillHandle"],Iue="insert_row_below",Oue=200;var Gu=new WeakSet;class Aue extends qe{constructor(){super(...arguments),Eue(this,Gu),Yu(this,"addingStarted",!1),Yu(this,"mouseDownOnCellCorner",!1),Yu(this,"mouseDragOutside",!1),Yu(this,"handleDraggedCells",0),Yu(this,"directions",[]),Yu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return AO}static get PLUGIN_PRIORITY(){return Pue}static get SETTING_KEYS(){return[AO,...xue]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>td(Gu,this,Nue).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>td(Gu,this,Hue).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>td(Gu,this,Due).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return M(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),M(a,c=>{const h=[];M(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=Sue(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),v=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,g,v,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=y;const C=y;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(E=[],c==="up"){const P=d.row-h.row+1,A=P%C.length;for(let _=0;_<P;_++)E.push(C[(_+(C.length-A))%C.length])}else{const P=d.col-h.col+1,A=P%C[0].length;for(let _=0;_<C.length;_++){E.push([]);for(let T=0;T<P;T++)E[_].push(C[_][(T+(C[_].length-A))%C[_].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,v,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Kl.vertical)&&this.directions.includes(Kl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Kl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Kl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Iue,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Oue)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Yt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Yt(s)||!Yt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Ln(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+ln(this.hot.table),i=Ln(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Qt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>td(Gu,this,kue).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>td(Gu,this,$ue).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Rue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Hue(){this.selectAdjacent()&&this.fillIn()}function Nue(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Due(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function kue(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function $ue(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Lue(t,e){OL(t,e),e.add(t)}function HO(t,e,n){OL(t,e),e.set(t,n)}function OL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ku(t,e,n){return(e=Fue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fue(t){var e=Vue(t,"string");return typeof e=="symbol"?e:e+""}function Vue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AL(t,e,n){return t.set(Do(t,e),n),n}function Aw(t,e){return t.get(Do(t,e))}function Do(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sb="autoRowSize",Wue=40,Bue="autoRowSize";var Hf=new WeakMap,s_=new WeakMap,ys=new WeakSet;class Jd extends qe{static get PLUGIN_KEY(){return sb}static get PLUGIN_PRIORITY(){return Wue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Lue(this,ys),Ku(this,"headerHeight",null),Ku(this,"ghostTable",new i_(this.hot)),Ku(this,"samplesGenerator",new ty((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Ku(this,"inProgress",!1),Ku(this,"measuredRows",0),Ku(this,"rowHeightsMap",new Ka),HO(this,Hf,[]),HO(this,s_,!1),this.hot.rowIndexMapper.registerMap(Bue,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Do(ys,this,NO).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[sb];return e===!0||De(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Do(ys,e,zue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Do(ys,e,Yue).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Do(ys,e,Kue).call(e,...i)}),this.addHook("beforeRender",()=>Do(ys,this,Uue).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>Do(ys,this,Gue).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Do(ys,this,NO).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Pf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Jd.CALCULATION_STEP,i)},e,n),r=r+Jd.CALCULATION_STEP+1,r<i?o=_f(s):(Pf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[sb];let n=Jd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return De(e)&&(n=e.syncLimit,mE(n)?n=FE(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function jue(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Uue(){this.calculateVisibleRowsHeight(),this.inProgress||(Do(ys,this,jue).call(this,Aw(Hf,this)),AL(Hf,this,[]))}function NO(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function zue(t,e){e||this.recalculateAllRowsHeight()}function Yue(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Aw(Hf,this).push(...e)}function Gue(){this.recalculateAllRowsHeight(),AL(s_,this,!0)}function Kue(t){if(!Aw(s_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Aw(Hf,this).push(...e)}const{getListWithInsertedItems:que,getListWithRemovedItems:Xue}=I$("physicallyIndexed");class Jue extends Pu{constructor(){super(e=>e)}insert(e,n){const r=dT(this.indexedValues,n);this.indexedValues=que(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Xue(this.indexedValues,e);this.indexedValues=hT(n,e),super.remove(e)}}const{getListWithInsertedItems:Zue,getListWithRemovedItems:Que}=I$("physicallyIndexed");class ece extends Pu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Zue(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=Que(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function tce(t,e){nce(t,e),e.add(t)}function nce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rce(t,e,n){return(e=ice(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ice(t){var e=oce(t,"string");return typeof e=="symbol"?e:e+""}function oce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DO="bindRowsWithHeaders",ace=210,lce="loose",kO=new Map([["loose",Jue],["strict",ece]]);var $O=new WeakSet;class uce extends qe{constructor(){super(...arguments),tce(this,$O),rce(this,"headerIndexes",null)}static get PLUGIN_KEY(){return DO}static get PLUGIN_PRIORITY(){return ace}isEnabled(){return!!this.hot.getSettings()[DO]}enablePlugin(){var e;if(this.enabled)return;const n=(e=kO.get(this.getSetting()))!==null&&e!==void 0?e:kO.get(lce);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>sce($O,this,cce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function cce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function hce(t,e){HL(t,e),e.add(t)}function dce(t,e,n){HL(t,e),e.set(t,n)}function HL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LO(t,e,n){return(e=fce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fce(t){var e=gce(t,"string");return typeof e=="symbol"?e:e+""}function gce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FO(t,e){return t.get(xc(t,e))}function ab(t,e,n){return t.set(xc(t,e),n),n}function xc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $p="collapsibleColumns",mce=290,pce=["nestedHeaders"],Bc="collapsibleIndicator",VO=$p,WO=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var qu=new WeakMap,nd=new WeakSet;class wce extends qe{constructor(){super(...arguments),hce(this,nd),LO(this,"nestedHeadersPlugin",null),LO(this,"headerStateManager",null),dce(this,qu,null)}static get PLUGIN_KEY(){return $p}static get PLUGIN_PRIORITY(){return mce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[$p,...pce]}isEnabled(){return!!this.hot.getSettings()[$p]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||tt("You need to configure the Nested Headers plugin in order to use collapsible headers."),ab(qu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>xc(nd,this,Cce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xc(nd,e,bce).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xc(nd,e,vce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>xc(nd,this,yce).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ab(qu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:VO,relativeToGroup:qa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VO)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Bc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Bc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Bc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!WO.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Va(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;M(r,f=>{var g;let{row:v,col:y}=f;const{collapsible:E,isCollapsed:C}=(g=this.headerStateManager.getHeaderSettings(v,y))!==null&&g!==void 0?g:{};if(!E||C&&n==="collapse"||!C&&n==="expand")return i=!1,!1});const o=[],s=[];i&&M(r,f=>{let{row:g,col:v}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:C}=this.headerStateManager.triggerNodeModification(n,g,v);y>0&&(s.push(...E),o.push(C))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=sk([...a,...s]):n==="expand"&&(l=Va(a,f=>!s.includes(f)));const u=WO.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){M(o,f=>{f()});return}this.hot.batchExecution(()=>{M(s,f=>{FO(qu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;y!==null&&E!==null&&this.hot.selectCell(y,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return FO(qu,this).getHiddenIndexes()}destroy(){ab(qu,this,null),super.destroy()}}function vce(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Bc}`);if(Mu(e,[Ci("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,Bc),e.querySelector("div:first-child").appendChild(u)),we(u,["collapsed","expanded"]),s?(q(u,"collapsed"),Ba(u,"+"),l&&be(e,...Ci(!1))):(q(u,"expanded"),Ba(u,"-"),l&&be(e,...Ci(!0))),l&&be(u,...Tu());else{var c;(c=u)===null||c===void 0||c.remove()}}function yce(t,e){ve(t.target,Bc)&&(ve(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ve(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),xi(t))}function Cce(){this.updatePlugin()}function bce(t,e){e||this.updatePlugin()}function ml(t,e,n){return(e=Sce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sce(t){var e=Rce(t,"string");return typeof e=="symbol"?e:e+""}function Rce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ece=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Tce=!1,Mce=!0,_ce=!0;class Pce{constructor(e,n){ml(this,"hot",void 0),ml(this,"sortingStates",new Yv),ml(this,"sortEmptyCells",Tce),ml(this,"indicator",Mce),ml(this,"headerAction",_ce),ml(this,"compareFunctionFactory",void 0),ml(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){De(e)&&ke(e,(n,r)=>{Ece.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return De(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function NL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?zo:Yt(i)?Yt(o)?zo:s&&t==="asc"?Ut:zt:Yt(o)?s&&t==="asc"?zt:Ut:isNaN(i)&&!isNaN(o)?t==="asc"?zt:Ut:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Ut:zt:i>o?t==="asc"?zt:Ut:zo}}const DL="default";function xce(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return zo;if(a){if(Yt(r))return t==="asc"?Ut:zt;if(Yt(i))return t==="asc"?zt:Ut}return isNaN(o)?zt:isNaN(s)?Ut:o<s?t==="asc"?Ut:zt:o>s?t==="asc"?zt:Ut:zo}}const Ice="numeric";function Oce(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Yt(s),u=Yt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return zt;if(l===!1&&u)return Ut}return d===!1&&f?t==="asc"?Ut:zt:d&&f===!1?t==="asc"?zt:Ut:d===!1&&f===!1?NL(t,e,n)(s,a):c===i&&h===r?t==="asc"?Ut:zt:c===r&&h===i?t==="asc"?zt:Ut:zo}}const Ace="checkbox";function Hce(t,e,n){return WL(t,e.dateFormat,n)}const Nce="date";function Dce(t,e,n){return WL(t,e.timeFormat,n)}const kce="time",{register:bg,getItem:BO,hasItem:$ce}=ao("sorting.compareFunctionFactory"),{register:kL,getItem:Lce}=ao("sorting.mainSortComparator");function $L(t){return $ce(t)?BO(t):BO(DL)}bg(Ace,Oce);bg(Nce,Hce);bg(DL,NL);bg(Ice,xce);bg(kce,Dce);const zo=0,Ut=-1,zt=1;function Fce(t,e){const n=Lce(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Hw="asc",Nw="desc",LL="colHeader";function Vce(t){if(De(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Hw,Nw].includes(n)}function Wce(t){if(t.some(n=>Vce(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function jO(t){if(t!==Nw)return t===Hw?Nw:Hw}function FL(t){return t.querySelector(`.${LL}`)}function VL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function a_(t,e,n){return t===-1&&e>=0&&ja(n)===!1}function WL(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return zo;if(Yt(r))return Yt(i)?zo:o&&t==="asc"?Ut:zt;if(Yt(i))return o&&t==="asc"?zt:Ut;const s=Z(r,e),a=Z(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Ut:zt:a.isBefore(s)?t==="asc"?zt:Ut:zo:Ut:zt}}function Bce(t,e){tt(ct`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const jce="ascending",Uce="descending",BL="indicatorDisabled",jL="columnSorting",UL="sortAction",zL=new Map([[Hw,jce],[Nw,Uce]]);function zce(t,e,n,r){const i=[jL];if(r&&i.push(UL),n===!1)return i.push(BL),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(zL.get(o)),i}function Yce(){return Array.from(zL.values()).concat(UL,BL,jL)}function Gce(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:$L(u.type))(l,u,d)(c,h)}(0)}}function Kce(t,e){qce(t,e),e.add(t)}function qce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _m(t,e,n){return(e=Xce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xce(t){var e=Jce(t,"string");return typeof e=="symbol"?e:e+""}function Jce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Dw="columnSorting",Zce=50,kw="append",Qce="replace",UO=Dw;kL(Dw,Gce);oe.getSingleton().register("beforeColumnSort");oe.getSingleton().register("afterColumnSort");const rd=new WeakMap;var Wl=new WeakSet;class YL extends qe{constructor(){super(...arguments),Kce(this,Wl),_m(this,"columnStatesManager",null),_m(this,"columnMetaCache",null),_m(this,"pluginKey",Dw),_m(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Dw}static get PLUGIN_PRIORITY(){return Zce}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(rd.has(this.hot)&&rd.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),Bce(rd.get(this.hot),this.pluginKey);return}this.enabled||(rd.set(this.hot,this.pluginKey),this.columnStatesManager=new Pce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ka(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Sc(Wl,this,ehe).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sc(Wl,e,nhe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Sc(Wl,this,HR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sc(Wl,e,the).call(e,...r)}),this.hot.view&&Sc(Wl,this,HR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=FL(r);VL(n,r)===!1||i===null||this.updateHeaderClasses(i)};rd.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:qa,position:"before",group:UO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(UO)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new O$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Wce(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=jO(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:jO()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:kw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ht(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===kw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Qce)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(De(e)){const n=e[this.pluginKey];if(De(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):lt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);Fce(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(De(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||De(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(we(e,Yce()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,zce(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ve(e.target,LL)}onAfterOnCellMouseDown(e,n){if(a_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function HR(){const t=this.getAllSavedSortSettings();if(De(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function ehe(t,e){const n=FL(e);if(VL(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);be(e,..._8(s?`${s}ending`:"none"))}}function the(t){t===!0&&this.hot.view&&Sc(Wl,this,HR).call(this)}function nhe(t,e,n,r){a_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function pl(t,e,n){return(e=rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rhe(t){var e=ihe(t,"string");return typeof e=="symbol"?e:e+""}function ihe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ohe{constructor(e,n){pl(this,"plugin",void 0),pl(this,"hot",void 0),pl(this,"endpoints",[]),pl(this,"settings",void 0),pl(this,"settingsType","array"),pl(this,"currentEndpoint",null),pl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),M(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();M(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;M(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?M(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):M(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){M(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];M(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),M(i,o=>{let s=[];M(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,M(e.ranges,r=>{M(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],M(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],M(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],M(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&M(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),M(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){tt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function lb(t){return t==null||isNaN(t)}function she(t,e){ahe(t,e),e.add(t)}function ahe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lhe(t,e,n){return(e=uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uhe(t){var e=che(t,"string");return typeof e=="symbol"?e:e+""}function che(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ub="columnSummary",hhe=220;var id=new WeakSet;class dhe extends qe{constructor(){super(...arguments),she(this,id),lhe(this,"endpoints",null)}static get PLUGIN_KEY(){return ub}static get PLUGIN_PRIORITY(){return hhe}isEnabled(){return!!this.hot.getSettings()[ub]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[ub],this.endpoints=new ohe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pm(id,e,fhe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pm(id,e,mhe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pm(id,e,ghe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pm(id,e,phe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return ke(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=lb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return ke(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=lb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=lb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return ke(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ct`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function fhe(){this.endpoints.initEndpoints()}function ghe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function mhe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function phe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function whe(t,e){GL(t,e),e.add(t)}function cb(t,e,n){GL(t,e),e.set(t,n)}function GL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rc(t,e){return t.get(l_(t,e))}function NR(t,e,n){return t.set(l_(t,e),n),n}function l_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $w=new WeakMap,xm=new WeakMap,Im=new WeakMap,zO=new WeakSet;class KL{constructor(){whe(this,zO),cb(this,$w,!0),cb(this,xm,null),cb(this,Im,new ResizeObserver(e=>l_(zO,this,vhe).call(this,e)))}setObservedElement(e){NR(xm,this,e)}unobserve(){Rc(Im,this).unobserve(Rc(xm,this))}observe(){NR($w,this,!0),Rc(Im,this).observe(Rc(xm,this))}destroy(){Rc(Im,this).disconnect()}}function vhe(t){if(Rc($w,this)||!Array.isArray(t)||!t.length){NR($w,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}gt(KL,Fn);function wl(t,e,n){yhe(t,e),e.set(t,n)}function yhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return t.get(qL(t,e))}function ds(t,e,n){return t.set(qL(t,e),n),n}function qL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vl=new WeakMap,hb=new WeakMap,fs=new WeakMap,ta=new WeakMap,na=new WeakMap,Om=new WeakMap,Xu=new WeakMap;class ql{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;wl(this,vl,void 0),wl(this,hb,!1),wl(this,fs,null),wl(this,ta,void 0),wl(this,na,void 0),wl(this,Om,!0),wl(this,Xu,new KL),ds(vl,this,e),ds(hb,this,n),ds(ta,this,this.createEditor()),ds(na,this,mt(ta,this).style),mt(Xu,this).setObservedElement(this.getInputElement()),mt(Xu,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){mt(na,this).left=`${e}px`,mt(na,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Qt(this.getInputElement()),height:ln(this.getInputElement())}}observeSize(){mt(Xu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){mt(na,this).display="block",ds(Om,this,!1)}hide(){mt(Xu,this).unobserve(),mt(Om,this)||(mt(na,this).display="none"),ds(Om,this,!0)}isVisible(){return mt(na,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return mt(vl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=mt(vl,this).createElement("div"),n=mt(vl,this).createElement("textarea");return e.style.display="none",ds(fs,this,mt(vl,this).createElement("div")),mt(fs,this).setAttribute("dir",mt(hb,this)?"rtl":"ltr"),q(mt(fs,this),ql.CLASS_EDITOR_CONTAINER),mt(vl,this).body.appendChild(mt(fs,this)),q(e,ql.CLASS_EDITOR),q(n,ql.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),mt(fs,this).appendChild(e),e}getInputElement(){return mt(ta,this).querySelector(`.${ql.CLASS_INPUT}`)}getEditorElement(){return mt(ta,this)}destroy(){const e=mt(fs,this)?mt(fs,this).parentNode:null;mt(ta,this).parentNode.removeChild(mt(ta,this)),ds(ta,this,null),ds(na,this,null),mt(Xu,this).destroy(),e&&e.removeChild(mt(fs,this))}}gt(ql,Fn);function db(t,e,n){return(e=Che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Che(t){var e=bhe(t,"string");return typeof e=="symbol"?e:e+""}function bhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const She=250,Rhe=250;class XL{constructor(e){db(this,"wasLastActionShow",!0),db(this,"showDebounced",null),db(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Rhe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:She;this.showDebounced=cg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}gt(XL,Fn);function Ehe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function The(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function yl(t,e){const n={};return M(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function ma(t,e,n,r,i){M(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Mhe(s,a,e,n,r,i)})})}function Mhe(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Ehe(s.className,r):a=The(s.className,r)),o(t,e,"className",a)}function JL(t){return`<span class="selected">✓</span>${t}`}function Lp(t,e){let n=!1;return Array.isArray(t)&&M(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function ny(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Le="---------";function _he(){return{name:Le}}const fi="alignment";function Phe(){return{key:fi,name(){return this.getTranslatedPhrase($T)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${fi}:left`,name(){return this.getTranslatedPhrase(LT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:center`,name(){return this.getTranslatedPhrase(FT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:right`,name(){return this.getTranslatedPhrase(VT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:justify`,name(){return this.getTranslatedPhrase(WT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Le},{key:`${fi}:top`,name(){return this.getTranslatedPhrase(BT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:middle`,name(){return this.getTranslatedPhrase(jT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:bottom`,name(){return this.getTranslatedPhrase(UT)},callback(){const t=this.getSelectedRange(),e=yl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),ma(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const ry="clear_column";function xhe(){return{key:ry,name(){return this.getTranslatedPhrase(RT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Sg="col_left";function Ihe(){return{key:Sg,name(){return this.getTranslatedPhrase(wT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Rg="col_right";function Ohe(){return{key:Rg,name(){return this.getTranslatedPhrase(vT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Eg="make_read_only";function Ahe(){return{key:Eg,checkable:!0,ariaChecked(){return Lp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Mw)},name(){let t=this.getTranslatedPhrase(Mw);return Lp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=JL(t)),t},callback(){const t=this.getSelectedRange(),e=Lp(t,(n,r)=>this.getCellMeta(n,r).readOnly);M(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const iy="redo";function Hhe(){return{key:iy,name(){return this.getTranslatedPhrase(ST)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Tg="remove_col";function Nhe(){return{key:Tg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(CT,e)},callback(){this.alter("remove_col",wie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const oy="remove_row";function Dhe(){return{key:oy,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(yT,e)},callback(){this.alter("remove_row",vie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const sy="row_above";function khe(){return{key:sy,name(){return this.getTranslatedPhrase(mT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const ay="row_below";function $he(){return{key:ay,name(){return this.getTranslatedPhrase(pT)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Nf="no_items";function Lhe(){return{key:Nf,name(){return this.getTranslatedPhrase(gT)},disabled:!0,isCommand:!1}}const ly="undo";function Fhe(){return{key:ly,name(){return this.getTranslatedPhrase(bT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Vhe=[sy,ay,Sg,Rg,ry,oy,Tg,ly,iy,Eg,fi,Le,Nf],Whe={[Le]:_he,[Nf]:Lhe,[sy]:khe,[ay]:$he,[Sg]:Ihe,[Rg]:Ohe,[ry]:xhe,[oy]:Dhe,[Tg]:Nhe,[ly]:Fhe,[iy]:Hhe,[Eg]:Ahe,[fi]:Phe};function ZL(){const t={};return ke(Whe,(e,n)=>{t[n]=e()}),t}function Bhe(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(NT):this.getTranslatedPhrase(HT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function jhe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(DT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Uhe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(kT);return Lp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Fp))?JL(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Fp);t.updateCommentMeta(n,r,{[Fp]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function zhe(t,e){QL(t,e),e.add(t)}function Ju(t,e,n){QL(t,e),e.set(t,n)}function QL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yhe(t,e,n){return(e=Ghe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ghe(t){var e=Khe(t,"string");return typeof e=="symbol"?e:e+""}function Khe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oa(t,e,n){return t.set(Rr(t,e),n),n}function He(t,e){return t.get(Rr(t,e))}function Rr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lw="comments",qhe=60,Es="comment",$d="value",eF="style",Fp="readOnly",od=Lw,DR=`plugin:${Lw}`;var dt=new WeakMap,Oo=new WeakMap,uy=new WeakMap,Vp=new WeakMap,kR=new WeakMap,Fw=new WeakMap,kr=new WeakSet;class Xhe extends qe{constructor(){super(...arguments),zhe(this,kr),Yhe(this,"range",{}),Ju(this,dt,null),Ju(this,Oo,null),Ju(this,uy,!1),Ju(this,Vp,!1),Ju(this,kR,null),Ju(this,Fw,"")}static get PLUGIN_KEY(){return Lw}static get PLUGIN_PRIORITY(){return qhe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Lw]}enablePlugin(){var e=this;this.enabled||(He(dt,this)||(Oa(dt,this,new ql(this.hot.rootDocument,this.hot.isRtl())),He(dt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr(kr,e,ide).call(e,...r)})),He(Oo,this)||Oa(Oo,this,new XL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Rr(kr,this,tde).call(this,n,a)),this.addHook("afterScroll",()=>Rr(kr,this,ode).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Rr(kr,this,YO).call(this,n)),this.addHook("beforeCompositionStart",n=>Rr(kr,this,YO).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr(kr,e,sde).call(e,...r)}),He(Oo,this).addLocalHook("hide",()=>this.hide()),He(Oo,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){He(Oo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(DR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Oa(Vp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(DR),this.hot._registerTimeout(()=>{Oa(Vp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:od}),r.addShortcut({keys:[["Escape"]],callback:()=>{He(dt,this).setValue(He(Fw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(dt,this).isVisible()&&He(dt,this).isFocused(),group:od}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(dt,this).isVisible()&&He(dt,this).isFocused(),group:od}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{He(dt,this).setValue(He(dt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:od})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(od)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Rr(kr,this,Qhe).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Rr(kr,this,Jhe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Rr(kr,this,ede).call(this)),this.eventManager.addEventListener(n,"focus",()=>Rr(kr,this,rde).call(this)),this.eventManager.addEventListener(n,"blur",()=>Rr(kr,this,nde).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Rr(kr,this,Zhe).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Wa(e.target,"TD","TBODY");return!!(n&&ve(n,"htCommentCell")&&Wa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=He(dt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[$d]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Es),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,$d)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,$d)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return He(Oo,this).cancelHiding(),He(dt,this).setValue((e=i[Es]?i[Es][$d]:null)!==null&&e!==void 0?e:""),He(dt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){He(dt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!He(dt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;He(dt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(i,o,eF);v?He(dt,this).setSize(v.width,v.height):He(dt,this).resetSize();const y=c?0:f.getColumnWidth(a),E=l&&!u?ln(g):0,{left:C,top:P,width:A,height:_}=g.getBoundingClientRect(),{width:T,height:H}=He(dt,this).getSize(),{innerWidth:G,innerHeight:U}=this.hot.rootWindow,V=this.hot.rootDocument.documentElement,X=Mn(this.hot.rootDocument),ne=EE(this.hot.rootWindow)?X:0,Q=TE(this.hot.rootWindow)?X:0;let te=C+h.scrollX+y,pe=P+h.scrollY+E;this.hot.isRtl()&&(te-=T+y),this.hot.isLtr()&&C+A+T>G-ne?te=C+h.scrollX-T-1:this.hot.isRtl()&&te<-(V.scrollWidth-V.clientWidth)&&(te=C+h.scrollX+y+1),P+H>U-Q&&(pe-=H-_+1),He(dt,this).setPosition(te,pe),He(dt,this).setReadOnlyState(this.getCommentMeta(i,o,Fp)),He(dt,this).observeSize()}focusEditor(){He(dt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Es];let o;i?(o=Qn(i),dg(o,r)):o=r,this.hot.setCellMeta(e,n,Es,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Es])return i[Es][r]}addToContextMenu(e){e.items.push({name:Le},Bhe(this),jhe(this),Uhe(this))}getEditorInputElement(){return He(dt,this).getInputElement()}destroy(){var e,n;(e=He(dt,this))===null||e===void 0||e.destroy(),(n=He(Oo,this))===null||n===void 0||n.destroy(),super.destroy()}}function Jhe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!He(uy,this)&&!this.targetIsCommentTextArea(t)){const e=Wa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Zhe(t){t.stopPropagation()}function Qhe(t){const{rootDocument:e}=this.hot;if(!(He(uy,this)||He(dt,this).isFocused()||ve(t.target,"wtBorder")||He(kR,this)===t.target||!He(dt,this)))if(Oa(kR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));He(Oo,this).show(n)}else Da(t.target,e)&&!this.targetIsCommentTextArea(t)&&He(Oo,this).hide()}function ede(){Oa(uy,this,!1)}function tde(t,e){e[Es]&&e[Es][$d]&&q(t,e.commentedCellClassName)}function nde(){Oa(Fw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function rde(){Oa(Fw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(DR)}function ide(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[eF]:{width:t,height:e}})}function YO(t){He(dt,this).isFocused()&&xi(t)}function ode(){He(Vp,this)||this.hide()}function sde(){const t=He(dt,this).getEditorElement();we(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function fb(t,e,n){return(e=ade(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ade(t){var e=lde(t,"string");return typeof e=="symbol"?e:e+""}function lde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tF{constructor(e){fb(this,"hot",void 0),fb(this,"commands",{}),fb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=ude(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||an(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),M(u,c=>c.apply(this.hot,r))}}function ude(t,e){let n;return M(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function gb(t,e,n){return(e=cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cde(t){var e=hde(t,"string");return typeof e=="symbol"?e:e+""}function hde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;gb(this,"hot",void 0),gb(this,"predefinedItems",ZL()),gb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,ke(e,(r,i)=>{let o="";r.name===Le?(n[Le]=r,o=Le):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return dde(e,this.defaultOrderPattern,this.predefinedItems)}}function dde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),De(i)?ke(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),De(o)?un(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):M(i,(o,s)=>{let a=n[o];!a&&Vhe.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),De(o)&&un(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ra(t,e,n){return(e=fde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fde(t){var e=gde(t,"string");return typeof e=="symbol"?e:e+""}function gde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mde{constructor(e,n){ra(this,"top",void 0),ra(this,"topRelative",void 0),ra(this,"left",void 0),ra(this,"leftRelative",void 0),ra(this,"scrollTop",void 0),ra(this,"scrollLeft",void 0),ra(this,"cellHeight",void 0),ra(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function sd(t,e,n){pde(t,e),e.set(t,n)}function pde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(rF(t,e))}function Am(t,e,n){return t.set(rF(t,e),n),n}function rF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rr=new WeakMap,yr=new WeakMap,Cr=new WeakMap,mb=new WeakMap,Zu=new WeakMap;class wde{constructor(e){sd(this,rr,void 0),sd(this,yr,void 0),sd(this,Cr,void 0),sd(this,mb,!1),sd(this,Zu,{above:0,below:0,left:0,right:0}),Am(mb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Oe(Zu,this)[e]=n,this}setElement(e){return Am(rr,this,e),this}setParentElement(e){return Am(yr,this,e),this}updatePosition(e){Am(Cr,this,new mde(e,Oe(rr,this).ownerDocument.defaultView)),Oe(mb,this)?(Oe(Cr,this).fitsBelow(Oe(rr,this))?this.setPositionBelowCursor():Oe(Cr,this).fitsAbove(Oe(rr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Oe(rr,this).dir==="rtl"?Oe(Cr,this).fitsOnLeft(Oe(rr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Oe(Cr,this).fitsOnRight(Oe(rr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Oe(Zu,this).above+Oe(Cr,this).top-Oe(rr,this).offsetHeight;if(Oe(yr,this)){const r=Oe(yr,this).ownerDocument.defaultView.getComputedStyle(Oe(yr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Cr,this).top+Oe(Cr,this).cellHeight-Oe(rr,this).scrollHeight+i+o}Oe(rr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Oe(Zu,this).below+Oe(Cr,this).top+1;if(Oe(yr,this)){const r=Oe(yr,this).ownerDocument.defaultView.getComputedStyle(Oe(yr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Cr,this).top-i-o-1}Oe(rr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Oe(Cr,this).left;if(Oe(yr,this)){const n=Oe(yr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(yr,this).querySelector(".htCore")).borderRightWidth,10);e+=Oe(Cr,this).cellWidth+r}else e+=Oe(Zu,this).right;Oe(rr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Oe(Zu,this).left+Oe(Cr,this).left-Oe(rr,this).offsetWidth;if(Oe(yr,this)){const n=Oe(yr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(yr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Oe(rr,this).style.left=`${e}px`}}function iF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ye(e,-1,g()-1);function a(y,E){const C=g()-1;return y<0&&(y=C),y>C&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(E===1?++y:--y,E)),y)}function l(y){y>-1&&y<g()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:v}}function vde(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function $R(t){return an(t,"submenu")}function LR(t){return new RegExp(Le,"i").test(t.name)}function Wp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function GO(t){return an(t,"disableSelection")}function yde(t){return ve(t,"htSeparator")}function Cde(t){return ve(t,"htSubmenu")}function bde(t){return ve(t,"htDisabled")}function Sde(t){return ve(t,"htSelectionDisabled")}function Rde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function oF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Ede(t,e){let n=t.slice(0);return n.reverse(),n=oF(n,e),n.reverse(),n}function Tde(t){const e=[];return M(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Mde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le,n=t.slice(0);return n=oF(n,e),n=Ede(n,e),n=Tde(n),n}function _de(t){return t.checkable===!0}function Pde(t){return iF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||yde(r)||bde(r)||Sde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function xde(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const sF="menu",KO=sF;function Ide(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(xde(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:sF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${KO}:${u}`:KO}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Ode(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Ko(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Wp(a,t)&&!GO(a)&&!LR(a);be(n,[..._de(a)?[v8(),Ef(c),gk(h)]:[w8(),Ef(u)],...d?[Eu(-1)]:[],...Wp(a,t)?[T8()]:[],...$R(a)?[Ci(!1)]:[]])}n.className="",n.appendChild(l),LR(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):_u(l,u),Wp(a,t)?q(n,"htDisabled"):GO(a)?q(n,"htSelectionDisabled"):$R(a)&&q(n,"htSubmenu")}}function pb(t,e,n){Ade(t,e),e.set(t,n)}function Ade(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vo(t,e,n){return(e=Hde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hde(t){var e=Nde(t,"string");return typeof e=="symbol"?e:e+""}function Nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wb(t,e,n){return t.set(aF(t,e),n),n}function Cl(t,e){return t.get(aF(t,e))}function aF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qO=215;var ad=new WeakMap,Hm=new WeakMap,Nm=new WeakMap;class Ch{get tableBorderWidth(){return Cl(Nm,this)===void 0&&this.hotMenu&&wb(Nm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Cl(Nm,this)}constructor(e,n){var r=this;vo(this,"hot",void 0),vo(this,"options",void 0),vo(this,"eventManager",new Ri(this)),vo(this,"container",void 0),vo(this,"positioner",void 0),vo(this,"hotMenu",null),vo(this,"hotSubMenus",{}),vo(this,"parentMenu",void 0),vo(this,"menuItems",null),vo(this,"origOutsideClickDeselects",null),pb(this,ad,void 0),pb(this,Hm,void 0),pb(this,Nm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:qO,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new wde(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=au(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Cl(ad,this)}getKeyboardShortcutsCtrl(){return Cl(Hm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=cg(a=>this.openSubMenu(a),300),n=this.options.minWidth||qO;let r=!1,i=Va(this.menuItems,a=>(a.key===Nf&&(r=!0),Rde(a,this.hot)));if(i.length<1&&!r)i.push(ZL()[Nf]);else if(i.length===0)return;i=Mde(i,Le);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Ode(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Cl(ad,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),hR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!hR()||!ja(a))&&o&&this.hasSelectedItem()&&(Bo()||HE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),wb(ad,this,Pde(this.hotMenu)),wb(Hm,this,Ide(this)),Cl(Hm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Cl(ad,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);be(r,[Ci(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Cde(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Ch(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&be(n,[Ci(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&be(i,[Ci(!1)])}}closeAllSubMenus(){M(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?vde(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||LR(e)||Wp(e,this.hot)||$R(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=bn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?ln(this.hotMenu.getCell(c,0)):0;return l+(u.name===Le?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(lt(r)&&(r=r.call(this.hot),r===null||Ht(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&be(this.hotMenu.rootElement,[p8(),Eu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Da(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Da(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&Da(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}gt(Ch,Fn);function Dde(t,e){kde(t,e),e.add(t)}function kde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vb(t,e,n){return(e=$de(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $de(t){var e=Lde(t,"string");return typeof e=="symbol"?e:e+""}function Lde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ld="contextMenu",Fde=70,XO=Ld;oe.getSingleton().register("afterContextMenuDefaultOptions");oe.getSingleton().register("beforeContextMenuShow");oe.getSingleton().register("afterContextMenuShow");oe.getSingleton().register("afterContextMenuHide");oe.getSingleton().register("afterContextMenuExecute");var ld=new WeakSet;class cy extends qe{constructor(){super(...arguments),Dde(this,ld),vb(this,"commandExecutor",new tF(this.hot)),vb(this,"itemsFactory",null),vb(this,"menu",null)}static get PLUGIN_KEY(){return Ld}static get PLUGIN_PRIORITY(){return Fde}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[sy,ay,Le,Sg,Rg,Le,oy,Tg,Le,ly,iy,Le,Eg,Le,fi]}isEnabled(){return!!this.hot.getSettings()[Ld]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Ld];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Ch(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Dm(ld,this,Wde).call(this)),this.menu.addLocalHook("afterOpen",()=>Dm(ld,this,Bde).call(this)),this.menu.addLocalHook("afterClose",()=>Dm(ld,this,jde).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Dm(ld,this,Vde).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=ny(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:XO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(XO)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;ke(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new nF(this.hot,cy.DEFAULT_ITEMS);const e=this.hot.getSettings()[Ld],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),M(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Vde(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=ny(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Wde(){this.hot.runHooks("beforeContextMenuShow",this)}function Bde(){this.hot.runHooks("afterContextMenuShow",this)}function jde(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}cy.SEPARATOR={name:Le};function Ude(t){return{key:"copy",name(){return this.getTranslatedPhrase(ET)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function zde(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(_T,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Yde(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(MT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Gde(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(TT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Kde(t){return{key:"cut",name(){return this.getTranslatedPhrase(PT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class qde{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Xde{constructor(){this.clipboardData=new qde}preventDefault(){}composedPath(){return[]}}function Jde(t,e){lF(t,e),e.add(t)}function Qu(t,e,n){lF(t,e),e.set(t,n)}function lF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(Ic(t,e))}function ec(t,e,n){return t.set(Ic(t,e),n),n}function Ic(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ia=new WeakMap,yb=new WeakMap,ud=new WeakMap,FR=new WeakMap,VR=new WeakMap,cd=new WeakMap,hd=new WeakSet;class Zde{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Jde(this,hd),Qu(this,ia,void 0),Qu(this,yb,void 0),Qu(this,ud,void 0),Qu(this,FR,void 0),Qu(this,VR,void 0),Qu(this,cd,void 0),ec(yb,this,n),ec(ud,this,r),ec(FR,this,i),ec(VR,this,o),ec(cd,this,s)}setSelectedRange(e){ec(ia,this,e)}getCellsRange(){if(sr(yb,this).call(this)===0||sr(ud,this).call(this)===0)return null;const{row:e,col:n}=sr(ia,this).getTopStartCorner(),{row:r,col:i}=sr(ia,this).getBottomEndCorner(),o=Ic(hd,this,Qde).call(this,e,r),s=Ic(hd,this,Cb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(sr(ud,this).call(this)===0||sr(cd,this).call(this)===0)return null;const{col:e}=sr(ia,this).getTopStartCorner(),{col:n}=sr(ia,this).getBottomEndCorner(),r=Ic(hd,this,Cb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(sr(ud,this).call(this)===0||sr(cd,this).call(this)===0)return null;const{col:e}=sr(ia,this).getTopStartCorner(),{col:n}=sr(ia,this).getBottomEndCorner(),r=Ic(hd,this,Cb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-sr(cd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Cb(t,e){return Math.min(e,Math.max(t+sr(VR,this).call(this)-1,t))}function Qde(t,e){return Math.min(e,Math.max(t+sr(FR,this).call(this)-1,t))}function uF(t){const e=[],n=[];return M(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function efe(t,e){cF(t,e),e.add(t)}function oa(t,e,n){cF(t,e),e.set(t,n)}function cF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){return(e=tfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tfe(t){var e=nfe(t,"string");return typeof e=="symbol"?e:e+""}function nfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pr(t,e){return t.get(Ir(t,e))}function Vi(t,e,n){return t.set(Ir(t,e),n),n}function Ir(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterCopyLimit");oe.getSingleton().register("modifyCopyableRange");oe.getSingleton().register("beforeCut");oe.getSingleton().register("afterCut");oe.getSingleton().register("beforePaste");oe.getSingleton().register("afterPaste");oe.getSingleton().register("beforeCopy");oe.getSingleton().register("afterCopy");const bb="copyPaste",rfe=80,ife=["fragmentSelection"],JO=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var WR=new WeakMap,BR=new WeakMap,jR=new WeakMap,tc=new WeakMap,km=new WeakMap,$m=new WeakMap,nc=new WeakMap,Vw=new WeakMap,zr=new WeakSet;class ofe extends qe{constructor(){super(...arguments),efe(this,zr),dd(this,"columnsLimit",1/0),dd(this,"rowsLimit",1/0),dd(this,"pasteMode","overwrite"),dd(this,"uiContainer",this.hot.rootDocument.body),oa(this,WR,!1),oa(this,BR,!1),oa(this,jR,!1),oa(this,tc,"cells-only"),oa(this,km,!1),oa(this,$m,!1),oa(this,nc,new Zde({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),oa(this,Vw,!1),dd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return bb}static get SETTING_KEYS(){return[bb,...ife]}static get PLUGIN_PRIORITY(){return rfe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[bb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Vi(WR,this,this.getSetting("copyColumnHeaders")),Vi(BR,this,this.getSetting("copyColumnGroupHeaders")),Vi(jR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Ir(zr,this,lfe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(zr,r,ufe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Ir(zr,this,cfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),xf()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(zr,r,hfe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(zr,r,dfe).call(r,...o)}),this.addHook("afterSelection",()=>Ir(zr,this,ffe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Vi(tc,this,e),Vi(km,this,!0),Ir(zr,this,ZO).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Vi($m,this,!0),Ir(zr,this,ZO).call(this,"cut")}getRangedCopyableData(e){return qd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=uF(e);return M(r,o=>{const s=[];M(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Xde;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Pr(nc,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Pr(tc,this)==="column-headers-only"?n.set("headers",Pr(nc,this).getMostBottomColumnHeadersRange()):(Pr(tc,this)==="with-column-headers"?n.set("headers",Pr(nc,this).getMostBottomColumnHeadersRange()):Pr(tc,this)==="with-column-group-headers"&&n.set("headers",Pr(nc,this).getAllColumnHeadersRange()),n.set("cells",Pr(nc,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,g===!0)continue;d=v,h=a;const y=[],E=o.length%r;for(;y.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:P}=this.hot.getCellMeta(s,h);if(h=P+1,C===!0)continue;f=P;const A=y.length%i;y.push(e[E][A])}o.push(y)}return Vi(Vw,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Pr(km,this)||this.isEditorOpened()||Uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!zd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Vi(km,this,!1);const o=this.getRangedData(this.copyableRanges),s=Ir(zr,this,sfe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=qd(o);if(e&&e.clipboardData){const u=wR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[JO,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Vi(tc,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Pr($m,this)||this.isEditorOpened()||Uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!zd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Vi($m,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=qd(o);if(e&&e.clipboardData){const l=wR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[JO,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!zd(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Ov(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=t$(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Rie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function ZO(t){if(xf()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&_k(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function sfe(t){const{rows:e}=uF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function afe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&_E(r)}}}function hF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&PE(r)}}}function lfe(t){t.items.push({name:"---------"},Ude(this)),Pr(WR,this)&&t.items.push(Gde(this)),Pr(BR,this)&&t.items.push(Yde(this)),Pr(jR,this)&&t.items.push(zde(this)),t.items.push(Kde(this))}function ufe(t,e,n,r,i){Pr(Vw,this)&&(i.value=!0),Vi(Vw,this,!1)}function cfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function hfe(){Ir(zr,this,hF).call(this)}function dfe(){Ir(zr,this,afe).call(this)}function ffe(){Ir(zr,this,hF).call(this)}function dF(t,e){return`border_row${t}col${e}`}function Fd(){return{width:1,color:"#000"}}function Hs(){return{hide:!0}}function gfe(){return{width:1,color:"#000",cornerVisible:!1}}function Sb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function fd(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Rb(t,e){return{id:dF(t,e),border:gfe(),row:t,col:e,top:Hs(),bottom:Hs(),start:Hs(),end:Hs()}}function mfe(t,e){return an(e,"border")&&e.border&&(t.border=e.border),an(e,"top")&&le(e.top)&&(e.top?(De(e.top)||(e.top=Fd()),t.top=e.top):(e.top=Hs(),t.top=e.top)),an(e,"bottom")&&le(e.bottom)&&(e.bottom?(De(e.bottom)||(e.bottom=Fd()),t.bottom=e.bottom):(e.bottom=Hs(),t.bottom=e.bottom)),an(e,"start")&&le(e.start)&&(e.start?(De(e.start)||(e.start=Fd()),t.start=e.start):(e.start=Hs(),t.start=e.start)),an(e,"end")&&le(e.end)&&(e.end?(De(e.end)||(e.end=Fd()),t.end=e.end):(e.end=Hs(),t.end=e.end)),t}function Bs(t,e){let n=!1;return M(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!an(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function hy(t){return`<span class="selected">✓</span>${t}`}function pfe(t){return t.some(e=>le(e.left)||le(e.right))}function wfe(t){return t.some(e=>le(e.start)||le(e.end))}const vfe=new Map([["left","start"],["right","end"]]);function yfe(t){var e;return(e=vfe.get(t))!==null&&e!==void 0?e:t}function Cfe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(KT);return Bs(this,"bottom")&&(e=hy(e)),e},callback(e,n){const r=Bs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function bfe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(qT);return Bs(this,e)&&(n=hy(n)),n},callback(n,r){const i=Bs(this,e);t.prepareBorder(r,e,i)}}}function Sfe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(XT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Bs(this)}}}function Rfe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(GT);return Bs(this,e)&&(n=hy(n)),n},callback(n,r){const i=Bs(this,e);t.prepareBorder(r,e,i)}}}function Efe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(YT);return Bs(this,"top")&&(e=hy(e)),e},callback(e,n){const r=Bs(this,"top");t.prepareBorder(n,"top",r)}}}function Tfe(t,e){Mfe(t,e),e.add(t)}function Mfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _fe(t,e,n){return(e=Pfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pfe(t){var e=xfe(t,"string");return typeof e=="symbol"?e:e+""}function xfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bp="customBorders",Ife=90;var Eb=new WeakSet;class Ofe extends qe{constructor(){super(...arguments),Tfe(this,Eb),_fe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Bp}static get PLUGIN_PRIORITY(){return Ife}isEnabled(){return!!this.hot.getSettings()[Bp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>QO(Eb,this,Afe).call(this,e)),this.addHook("init",()=>QO(Eb,this,Hfe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Sb(n));const o=Zc(e),s=Af(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});M(e,a=>{s(a).forAll((l,u)=>{M(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,yfe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Zc(e),r=Af(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return M(e,o=>{r(o).forAll((s,a)=>{M(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(fd(l))})})}),i}clearBorders(e){e?this.setBorders(e):(M(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Rb(e,n);r&&(a=mfe(a,r),M(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",fd(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=Rb(o,s);let l=0;o===e.from.row&&an(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&an(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&an(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&an(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",fd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=dF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Rb(e,n):o=Sb(o),i?(o[r]=Hs(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",fd(o)))):(o[r]=Fd(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",fd(o)))}prepareBorder(e,n,r){M(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){M(e,n=>{const r=Sb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return bn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){M(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){M(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):M(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return M(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return M(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):M(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);M(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Bp];if(Array.isArray(e)){const n=Qn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=pfe(e),r=wfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Afe(t){this.hot.getSettings()[Bp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(zT)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Efe(this),Rfe(this),Cfe(this),bfe(this),Sfe(this)]}})}function Hfe(){this.changeBorderSettings()}function Nfe(t,e){Dfe(t,e),e.add(t)}function Dfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tb(t,e,n){return(e=kfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kfe(t){var e=$fe(t,"string");return typeof e=="symbol"?e:e+""}function $fe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const t1="dragToScroll",Lfe=100;var Mb=new WeakSet;class Ffe extends qe{constructor(){super(...arguments),Nfe(this,Mb),Tb(this,"boundaries",null),Tb(this,"callback",null),Tb(this,"listening",!1)}static get PLUGIN_KEY(){return t1}static get PLUGIN_PRIORITY(){return Lfe}isEnabled(){return!!this.hot.getSettings()[t1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>e1(Mb,this,n1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>e1(Mb,this,n1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=au(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function n1(t){if(ja(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Vfe(t,e){fF(t,e),e.add(t)}function Wfe(t,e,n){fF(t,e),e.set(t,n)}function fF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _b(t,e,n){return(e=Bfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bfe(t){var e=jfe(t,"string");return typeof e=="symbol"?e:e+""}function jfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ufe(t,e){return t.get(gi(t,e))}function gF(t,e,n){return t.set(gi(t,e),n),n}function gi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterDropdownMenuDefaultOptions");oe.getSingleton().register("beforeDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuHide");oe.getSingleton().register("afterDropdownMenuExecute");const jp="dropdownMenu",zfe=230,Df="changeType",Pb=jp;var dy=new WeakMap,ji=new WeakSet;class fy extends qe{static get PLUGIN_KEY(){return jp}static get PLUGIN_PRIORITY(){return zfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Sg,Rg,Le,Tg,Le,ry,Le,Eg,Le,fi]}constructor(e){super(e),Vfe(this,ji),_b(this,"commandExecutor",new tF(this.hot)),_b(this,"itemsFactory",null),_b(this,"menu",null),Wfe(this,dy,!1),this.hot.addHook("afterGetColHeader",(n,r)=>gi(ji,this,Gfe).call(this,n,r))}isEnabled(){return this.hot.getSettings()[jp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new nF(this.hot,fy.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gi(ji,e,Qfe).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gi(ji,e,Zfe).call(e,...o)});const n=this.hot.getSettings()[jp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Ch(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>gi(ji,this,Kfe).call(this)),this.menu.addLocalHook("afterOpen",()=>gi(ji,this,qfe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>gi(ji,this,Xfe).call(this,o)),this.menu.addLocalHook("afterClose",()=>gi(ji,this,Jfe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),M(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=ny(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Df}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Pb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Pb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Pb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>gi(ji,this,Yfe).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function mF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Yfe(t){if(ve(t.target,Df)){const e=ny(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),gF(dy,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Gfe(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Df}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Df,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(be(s,[Tu(),Ef(" ")]),be(e,[hk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Kfe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function qfe(){this.hot.runHooks("afterDropdownMenuShow",this),gi(ji,this,mF).call(this,this.menu)}function Xfe(t){gi(ji,this,mF).call(this,t)}function Jfe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Zfe(t){return Ufe(dy,this)?null:t}function Qfe(t){ve(t.target,Df)&&gF(dy,this,!0)}fy.SEPARATOR={name:Le};function r1(t,e,n){return(e=ege(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ege(t){var e=tge(t,"string");return typeof e=="symbol"?e:e+""}function tge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nge{constructor(e){r1(this,"hot",void 0),r1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function i1(t,e,n){return(e=rge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rge(t){var e=ige(t,"string");return typeof e=="symbol"?e:e+""}function ige(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){i1(this,"dataProvider",void 0),i1(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=io(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=un(io(u_.DEFAULT_OPTIONS),n),n=un(n,e),n.filename=pE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function oge(t,e){sge(t,e),e.add(t)}function sge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pF="\r",age='"',lge=`
`,uge="=",cge="+",hge="-",dge="@",fge="	";var xb=new WeakSet;class gge extends u_{constructor(){super(...arguments),oge(this,xb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Ue(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),M(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Rt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=o1(xb,this,pge).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=o1(xb,this,mge).call(this,i)),(n||i.indexOf(pF)>=0||i.indexOf(age)>=0||i.indexOf(lge)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function mge(t){return t.startsWith(uge)||t.startsWith(cge)||t.startsWith(hge)||t.startsWith(dge)||t.startsWith(fge)||t.startsWith(pF)?`'${t}`:t}function pge(t,e){return e.test(t)?`'${t}`:t}const wge="csv",UR={[wge]:gge};function vge(t,e,n){return typeof UR[t]=="function"?new UR[t](e,n):null}const yge="exportFile",Cge=240;class bge extends qe{static get PLUGIN_KEY(){return yge}static get PLUGIN_PRIORITY(){return Cge}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!UR[e])throw new Error(`Export format type "${e}" is not supported.`);return vge(e,new nge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function rc(t,e,n){return(e=Sge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sge(t){var e=Rge(t,"string");return typeof e=="symbol"?e:e+""}function Rge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mg{constructor(e,n){let{id:r,stateless:i=!0}=n;rc(this,"hot",void 0),rc(this,"id",void 0),rc(this,"elements",[]),rc(this,"hidden",!1),rc(this,"stateId",""),rc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Yv)}getElements(){return this.elements}reset(){M(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),M(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}gt(Mg,Fn);const kf={};function Ua(t,e){if(!kf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=kf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Xl(t){if(!kf[t])throw Error(`Filter condition "${t}" does not exist.`);return kf[t].descriptor}function dn(t,e,n){n.key=t,kf[t]={condition:e,descriptor:n}}const An="none";function Ege(){return!0}dn(An,Ege,{name:Gv,inputsCount:0,showOperators:!1});const Zd="empty";function Tge(t){return Yt(t.value)}dn(Zd,Tge,{name:rM,inputsCount:0,showOperators:!0});const Up="not_empty";function Mge(t,e){return!Ua(Zd,e)(t)}dn(Up,Mge,{name:iM,inputsCount:0,showOperators:!0});const Qd="eq";function _ge(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale)===Rt(n)}dn(Qd,_ge,{name:oM,inputsCount:1,showOperators:!0});const zp="neq";function Pge(t,e){return!Ua(Qd,e)(t)}dn(zp,Pge,{name:sM,inputsCount:1,showOperators:!0});const wF="gt";function xge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}dn(wF,xge,{name:hM,inputsCount:1,showOperators:!0});const vF="gte";function Ige(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}dn(vF,Ige,{name:dM,inputsCount:1,showOperators:!0});const yF="lt";function Oge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}dn(yF,Oge,{name:fM,inputsCount:1,showOperators:!0});const CF="lte";function Age(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}dn(CF,Age,{name:gM,inputsCount:1,showOperators:!0});const c_="date_after";function Hge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}dn(c_,Hge,{name:wM,inputsCount:1,showOperators:!0});const h_="date_before";function Nge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}dn(h_,Nge,{name:vM,inputsCount:1,showOperators:!0});const Ww="between";function Dge(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Ua(h_,[o]),a=Ua(c_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}dn(Ww,Dge,{name:mM,inputsCount:2,showOperators:!0});const bF="not_between";function kge(t,e){return!Ua(Ww,e)(t)}dn(bF,kge,{name:pM,inputsCount:2,showOperators:!0});const SF="begins_with";function $ge(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Rt(n))}dn(SF,$ge,{name:aM,inputsCount:1,showOperators:!0});const RF="ends_with";function Lge(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Rt(n))}dn(RF,Lge,{name:lM,inputsCount:1,showOperators:!0});const d_="contains";function Fge(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Rt(n))>=0}dn(d_,Fge,{name:uM,inputsCount:1,showOperators:!0});const EF="not_contains";function Vge(t,e){return!Ua(d_,e)(t)}dn(EF,Vge,{name:cM,inputsCount:1,showOperators:!0});const TF="date_tomorrow";function Wge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}dn(TF,Wge,{name:CM,inputsCount:0});const MF="date_today";function Bge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}dn(MF,Bge,{name:yM,inputsCount:0});const _F="date_yesterday";function jge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}dn(_F,jge,{name:bM,inputsCount:0});$k();function Uge(t,e){let n=t;return n===""&&(n=`(${e})`),n}function _g(t){const e=new Set(t);return function(n){return e.has(n)}}function f_(t){return t??""}function zR(t){return Array.from(new Set(t)).map(e=>f_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function s1(t,e,n,r){const i=[],o=t===e;let s;return o||(s=_g(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Uge(a,n)};r&&r(u),i.push(u)}),i}const Jl="by_value";function zge(t,e){let[n]=e;return n(t.value)}dn(Jl,zge,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[_g(e)]},showOperators:!1});const $f={};function Yge(t){if(!$f[t])throw Error(`Operation with id "${t}" does not exist.`);const e=$f[t].func;return function(n,r){return e(n,r)}}function Gge(t){return $f[t].name}function g_(t,e,n){$f[t]={name:e,func:n}}const La="conjunction",Kge=EM;function qge(t,e){return t.every(n=>n.func(e))}g_(La,Kge,qge);const Bw="disjunction",Xge=Kv;function Jge(t,e){return t.some(n=>n.func(e))}g_(Bw,Xge,Jge);const m_="disjunctionWithExtraCondition",Zge=Kv;function Qge(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}g_(m_,Zge,Qge);const eme="numeric",PF="text",tme="date",a1={[eme]:[An,Le,Zd,Up,Le,Qd,zp,Le,wF,vF,yF,CF,Ww,bF],[PF]:[An,Le,Zd,Up,Le,Qd,zp,Le,SF,RF,Le,d_,EF],[tme]:[An,Le,Zd,Up,Le,Qd,zp,Le,h_,c_,Ww,Le,TF,MF,_F]};function nme(t){const e=[];let n=t;return a1[n]||(n=PF),M(a1[n],r=>{let i;r===Le?i={name:Le}:i=io(Xl(r)),e.push(i)}),e}function gd(t,e,n){return(e=rme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rme(t){var e=ime(t,"string");return typeof e=="symbol"?e:e+""}function ime(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ib="built",Ob="building",l1=["click","input","keydown","keypress","keyup","focus","blur","change"];let to=class xF{static get DEFAULTS(){return io({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){gd(this,"hot",void 0),gd(this,"eventManager",new Ri(this)),gd(this,"options",void 0),gd(this,"_element",void 0),gd(this,"buildState",void 0),this.hot=e,this.options=un(xF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Ob?this._element:this.buildState===Ib?(this.update(),this._element):(this.buildState=Ob,this.build(),this.buildState=Ib,this._element)}isBuilt(){return this.buildState===Ib}translateIfPossible(e){return typeof e=="string"&&e.startsWith(gr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Ob),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)M(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),ke(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),M(l1,r=>e(n,r))}else M(l1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};gt(to,Fn);function ome(t,e){IF(t,e),e.add(t)}function sme(t,e,n){IF(t,e),e.set(t,n)}function IF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lm(t,e){return t.get(p_(t,e))}function ame(t,e,n){return t.set(p_(t,e),n),n}function p_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ic=new WeakMap,u1=new WeakSet;class Fa extends to{static get DEFAULTS(){return io({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,un(Fa.DEFAULTS,n)),ome(this,u1),sme(this,ic,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>p_(u1,this,lme).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");ame(ic,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Lm(ic,this).type=this.options.type,Lm(ic,this).placeholder=this.translateIfPossible(this.options.placeholder),Lm(ic,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Lm(ic,this).focus()}}function lme(t){this.options.value=t.target.value}function ume(t,e){OF(t,e),e.add(t)}function md(t,e,n){OF(t,e),e.set(t,n)}function OF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oc(t,e,n){return t.set(ef(t,e),n),n}function Ft(t,e){return t.get(ef(t,e))}function ef(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sn=new WeakMap,Fm=new WeakMap,Vm=new WeakMap,Ab=new WeakMap,Wm=new WeakMap,Bm=new WeakSet;class Lf extends to{static get DEFAULTS(){return io({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,un(Lf.DEFAULTS,n)),ume(this,Bm),md(this,Sn,null),md(this,Fm,[]),md(this,Vm,void 0),md(this,Ab,void 0),md(this,Wm,void 0),this.registerHooks()}getMenu(){return Ft(Sn,this)}registerHooks(){this.addLocalHook("click",()=>ef(Bm,this,dme).call(this))}setItems(e){oc(Fm,this,this.translateNames(e)),Ft(Sn,this)&&Ft(Sn,this).setMenuItems(Ft(Fm,this))}translateNames(e){return M(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),oc(Sn,this,new Ch(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ft(Sn,this).setMenuItems(Ft(Fm,this));const e=new to(this.hot,{className:"htUISelectCaption"}),n=new to(this.hot,{className:"htUISelectDropdown"});oc(Vm,this,e),oc(Ab,this,e.element),oc(Wm,this,n),this.hot.getSettings().ariaTags&&(be(n.element,[Tu()]),be(this._element,[ck()])),M([e,n],r=>this._element.appendChild(r.element)),Ft(Sn,this).addLocalHook("select",r=>ef(Bm,this,cme).call(this,r)),Ft(Sn,this).addLocalHook("afterClose",()=>ef(Bm,this,hme).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ft(Sn,this).hot.getTranslatedPhrase(Gv),Ft(Ab,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ft(Sn,this)&&(Ft(Sn,this).open(),Ft(Sn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ft(Sn,this).getNavigator().toFirstItem(),Ft(Sn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ft(Sn,this)&&Ft(Sn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ft(Sn,this)&&(Ft(Sn,this).destroy(),oc(Sn,this,null)),Ft(Vm,this)&&Ft(Vm,this).destroy(),Ft(Wm,this)&&Ft(Wm,this).destroy(),super.destroy()}}function cme(t){t.name!==Le&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function hme(){this.runLocalHooks("afterClose")}function dme(){this.openOptions()}function fme(t,e){gme(t,e),e.add(t)}function gme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c1(t,e,n){return(e=mme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mme(t){var e=pme(t,"string");return typeof e=="symbol"?e:e+""}function pme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hb=new WeakSet;class YR extends Mg{constructor(e,n){super(e,{id:n.id,stateless:!1}),fme(this,Hb),c1(this,"name",""),c1(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Lf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Fa(this.hot,{placeholder:IM})),this.elements.push(new Fa(this.hot,{placeholder:OM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>h1(Hb,this,wme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),M(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>h1(Hb,this,vme).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=io(e.command);n.name.startsWith(Gt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),M(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Xl(An),n=[];return M(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Xl(e?e.name:An);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||M(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Lf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Fa)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Xl(An)];if(e!==null){const{visualIndex:r}=e;n=nme(this.hot.getDataType(0,r,this.hot.countRows(),r))}M(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function wme(t){M(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function vme(t){mh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),xi(t))}function d1(t,e,n){yme(t,e),e.set(t,n)}function yme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pd(t,e){return t.get(AF(t,e))}function f1(t,e,n){return t.set(AF(t,e),n),n}function AF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sc=new WeakMap,Nb=new WeakMap;class jw extends to{static get DEFAULTS(){return io({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,un(jw.DEFAULTS,n)),d1(this,sc,void 0),d1(this,Nb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),f1(Nb,this,e),f1(sc,this,this._element.firstChild),pd(sc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(pd(Nb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?pd(sc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(pd(sc,this).checked=e)}focus(){this.isBuilt()&&pd(sc,this).focus()}}function Cme(t,e){bme(t,e),e.add(t)}function bme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sme(t,e,n){return(e=Rme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rme(t){var e=Eme(t,"string");return typeof e=="symbol"?e:e+""}function Eme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const g1=0;var m1=new WeakSet;class Mme extends Mg{constructor(e,n){super(e,{id:n.id,stateless:!1}),Cme(this,m1),Sme(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),M(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[La,Bw];M(e,n=>{const r=new jw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Gge(n)},value:n,checked:n===e[g1],id:n});r.addLocalHook("change",i=>Tme(m1,this,_me).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ct`Radio button with index ${e} doesn't exist.`);M(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof jw&&n.isChecked());return e?e.getValue():La}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&M(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:La,n=arguments.length>1?arguments[1]:void 0,r=e;r===m_&&(r=Bw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(g1)}}function _me(t){this.setState(t.target.value)}function Pme(t,e,n){xme(t,e),e.set(t,n)}function xme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Db(t,e){return t.get(HF(t,e))}function Ime(t,e,n){return t.set(HF(t,e),n),n}function HF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wd=new WeakMap;class Ff extends to{static get DEFAULTS(){return io({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,un(Ff.DEFAULTS,n)),Pme(this,wd,void 0)}build(){super.build(),Ime(wd,this,this._element.firstChild)}update(){this.isBuilt()&&(Db(wd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Db(wd,this).focus()}activate(){Db(wd,this).click()}}function Ome(t,e){NF(t,e),e.add(t)}function ac(t,e,n){NF(t,e),e.set(t,n)}function NF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(Oc(t,e))}function ki(t,e,n){return t.set(Oc(t,e),n),n}function Oc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const p1="multipleSelect.itemBox";var Ui=new WeakMap,Xt=new WeakMap,kb=new WeakMap,gs=new WeakMap,sa=new WeakMap,aa=new WeakMap,vd=new WeakSet;class Vf extends to{static get DEFAULTS(){return io({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,un(Vf.DEFAULTS,n)),Ome(this,vd),ac(this,Ui,[]),ac(this,Xt,void 0),ac(this,kb,void 0),ac(this,gs,void 0),ac(this,sa,void 0),ac(this,aa,void 0),ki(gs,this,new Fa(this.hot,{placeholder:xM,className:"htUIMultipleSelectSearch"})),ki(sa,this,new Ff(this.hot,{textContent:TM,className:"htUISelectAll"})),ki(aa,this,new Ff(this.hot,{textContent:MM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return xe(Xt,this)}registerHooks(){xe(gs,this).addLocalHook("keydown",e=>Oc(vd,this,Hme).call(this,e)),xe(gs,this).addLocalHook("input",e=>Oc(vd,this,Ame).call(this,e)),xe(sa,this).addLocalHook("click",e=>Oc(vd,this,Nme).call(this,e)),xe(aa,this).addLocalHook("click",e=>Oc(vd,this,Dme).call(this,e))}setItems(e){var n;ki(Ui,this,e),(n=xe(Xt,this))===null||n===void 0||n.loadData(xe(Ui,this))}setLocale(e){ki(kb,this,e)}getLocale(){return xe(kb,this)}getItems(){return[...xe(Ui,this)]}getValue(){return $me(xe(Ui,this))}getSearchInputElement(){return xe(gs,this)}getSelectAllElement(){return xe(sa,this)}getClearAllElement(){return xe(aa,this)}isSelectedAllValues(){return xe(Ui,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new to(this.hot,{className:"htUISelectionControls",children:[xe(sa,this),xe(aa,this)]});this._element.appendChild(xe(gs,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=xe(Xt,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),ki(Xt,this,new this.hot.constructor(o,{data:xe(Ui,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{xe(Xt,this).listen()},modifyColWidth:u=>{const c=xe(Xt,this).container.scrollWidth-Mn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),xe(Xt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||xe(Xt,this).useTheme(u)});const l=xe(Xt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:p1}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{xe(Xt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:p1})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&xe(Xt,this).listen()}reset(){xe(gs,this).reset(),xe(sa,this).reset(),xe(aa,this).reset()}update(){this.isBuilt()&&(xe(Xt,this).loadData(kme(xe(Ui,this),this.options.value)),super.update())}destroy(){var e;(e=xe(Xt,this))===null||e===void 0||e.destroy(),xe(gs,this).destroy(),xe(aa,this).destroy(),xe(sa,this).destroy(),ki(gs,this,null),ki(aa,this,null),ki(sa,this,null),ki(Xt,this,null),ki(Ui,this,null),super.destroy()}}function Ame(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...xe(Ui,this)]:n=xe(Ui,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),xe(Xt,this).loadData(n)}function Hme(t){this.runLocalHooks("keydown",t,this),xE(mh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),xi(t),xe(Xt,this).listen(),xe(Xt,this).selectCell(0,0))}function Nme(t){const e=[];t.preventDefault(),xe(Xt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(sT(n,r)[0])}),xe(Xt,this).setSourceDataAtCell(e)}function Dme(t){const e=[];t.preventDefault(),xe(Xt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(sT(n,r)[0])}),xe(Xt,this).setSourceDataAtCell(e)}function kme(t,e){const n=_g(e);return t.map(r=>(r.checked=n(r.value),r))}function $me(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Lme(t,e){Fme(t,e),e.add(t)}function Fme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vme(t,e,n){return(e=Wme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wme(t){var e=Bme(t,"string");return typeof e=="symbol"?e:e+""}function Bme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yd=new WeakSet;class jme extends Mg{constructor(e,n){super(e,{id:n.id,stateless:!1}),Lme(this,yd),Vme(this,"name",""),this.name=n.name,this.elements.push(new Vf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>jm(yd,this,Ume).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>jm(yd,this,zme).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Jl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?An:Jl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Va(i,h=>h.name===Jl),u={},c=this.hot.getTranslatedPhrase(_w);if(l){const h=s(r,a),d=Ue(h,C=>C.value),f=new Map(h.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),g=zR(d);o&&(l.args[0]=o);const v=[],y=s1(g,l.args[0],c,C=>{C.checked&&v.push(C.value),jm(yd,this,w1).call(this,C,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[v],u.command=Xl(Jl),u.itemsSnapshot=y}else u.args=[],u.command=Xl(An);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Vf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(_w),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=zR(r),s=s1(o,o,e,l=>{jm(yd,this,w1).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:f_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Ume(t){mh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),xi(t))}function w1(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function zme(t,e){switch(e.type){case"numeric":return SL(t,e);default:return t}}var DF;function Yme(t,e){Gme(t,e),e.add(t)}function Gme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kme(t,e,n){return(e=qme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qme(t){var e=Xme(t,"string");return typeof e=="symbol"?e:e+""}function Xme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var v1=new WeakSet;class Wf extends Mg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Yme(this,v1),Kme(this,"name",""),this.name=n.name,this.elements.push(new Fa(this.hot,{type:"button",value:_M,className:"htUIButton htUIButtonOK",identifier:Wf.BUTTON_OK})),this.elements.push(new Fa(this.hot,{type:"button",value:PM,className:"htUIButton htUIButtonCancel",identifier:Wf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){M(this.elements,e=>{e.addLocalHook("click",(n,r)=>Jme(v1,this,Zme).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),M(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}DF=Wf;function Zme(t,e){e.options.identifier===DF.BUTTON_OK?this.accept():this.cancel()}function $b(t,e,n){return(e=Qme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qme(t){var e=epe(t,"string");return typeof e=="symbol"?e:e+""}function epe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const y1="ConditionCollection.filteringStates";class w_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;$b(this,"hot",void 0),$b(this,"isMapRegistrable",void 0),$b(this,"filteringStates",new Yv),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(y1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:La;return e.length?Yge(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:La,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ct`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ht($f[r]))throw new Error(ct`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Ua(a,s)}]},i):u.push({name:a,args:s,func:Ua(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(y1),this.filteringStates=null,this.clearLocalHooks()}}gt(w_,Fn);function C1(t,e,n){return(e=tpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tpe(t){var e=npe(t,"string");return typeof e=="symbol"?e:e+""}function npe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];C1(this,"conditionCollection",void 0),C1(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return M(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return M(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return M(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function rpe(t,e){ipe(t,e),e.add(t)}function ipe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bl(t,e,n){return(e=ope(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ope(t){var e=spe(t,"string");return typeof e=="symbol"?e:e+""}function spe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Um=new WeakSet;class $F{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];rpe(this,Um),bl(this,"hot",void 0),bl(this,"conditionCollection",void 0),bl(this,"columnDataFactory",void 0),bl(this,"changes",[]),bl(this,"grouping",!1),bl(this,"latestEditedColumnPosition",-1),bl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Lb(Um,this,ape).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Lb(Um,this,lpe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Lb(Um,this,upe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,M(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=xk(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new w_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const v=r.columnDataFactory(h);let y;f.isEmpty()?y=v:y=new kF(f,C=>r.columnDataFactory(C)).filter(),y=Ue(y,C=>C.meta.visualRow);const E=_g(y);return f.destroy(),Va(v,C=>E(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),ke(this,(e,n)=>{this[n]=null})}}function ape(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function lpe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function upe(){M(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}gt($F,Fn);function cpe(t){return iF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Vf)return r;if(i.element&&!lu(i.element))return!1;i.focus()}})}const Cd="filters";function hpe(t,e){let n=-1,r;const i=cpe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Cd),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof to&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Cd),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Cd)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const v=r.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const v=e[i.getCurrentPage()];v instanceof Lf&&(v.openOptions(),g.preventDefault()),v instanceof Ff&&(v.activate(),g.preventDefault()),v instanceof to||g.preventDefault()}}],Cd)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Cd)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function dpe(t,e){LF(t,e),e.add(t)}function Fb(t,e,n){LF(t,e),e.set(t,n)}function LF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bd(t,e,n){return(e=fpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fpe(t){var e=gpe(t,"string");return typeof e=="symbol"?e:e+""}function gpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yp(t,e,n){return t.set(Er(t,e),n),n}function mi(t,e){return t.get(Er(t,e))}function Er(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const GR="filters",mpe=250,b1=GR;var Cs=new WeakMap,KR=new WeakMap,Yl=new WeakMap,$r=new WeakSet;class ppe extends qe{static get PLUGIN_KEY(){return GR}static get PLUGIN_PRIORITY(){return mpe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,dpe(this,$r),bd(this,"dropdownMenuPlugin",null),bd(this,"conditionCollection",null),bd(this,"conditionUpdateObserver",null),bd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),bd(this,"filtersRowsMap",null),Fb(this,Cs,void 0),Fb(this,KR,new WeakSet),Fb(this,Yl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Er($r,n,Rpe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[GR]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new wg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>Er($r,this,S1).call(this,"accept")),a.addLocalHook("cancel",()=>Er($r,this,S1).call(this,"cancel")),a.addLocalHook("change",l=>Er($r,this,Spe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(SM)}:`,s=()=>`${this.hot.getTranslatedPhrase(RM)}:`;if(!this.components.get("filter_by_condition")){const a=new YR(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Er($r,this,R1).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Mme(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new YR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Er($r,this,R1).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new jme(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Wf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new w_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new $F(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Er($r,this,Epe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Er($r,e,bpe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Er($r,this,Cpe).call(this)),this.addHook("afterDropdownMenuShow",()=>Er($r,this,vpe).call(this)),this.addHook("afterDropdownMenuHide",()=>Er($r,this,ype).call(this)),this.addHook("afterChange",a=>Er($r,this,wpe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!mi(Cs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=mi(Cs,this).getMenu(),c=u.getNavigator(),h=mi(Cs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Yp(Cs,this,hpe(this.dropdownMenuPlugin.menu,a));const l=u=>{mi(Cs,this).listen(),u.preventDefault(),mh(u.keyCode,"TAB")&&(u.shiftKey?mi(Cs,this).toPreviousItem():mi(Cs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:b1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(b1)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:La;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,mi(Yl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=_g(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),M(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Yp(Yl,this,this.exportConditions())}else s!==!1&&!r?(Yp(Yl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(mi(Yl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return M(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:f_(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=zR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Bw&&n.command.key!==An&&r.command.key!==An&&i.command.key!==An?o=m_:i.command.key!==An&&(n.command.key===An||r.command.key===An)&&(o=La),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new kF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return M(i,s=>{M(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function wpe(t){t&&M(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function vpe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function ype(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Cpe(){const t=this.dropdownMenuPlugin.menu;mi(KR,this).has(t)||mi(Cs,this).setMenu(t),mi(KR,this).add(t)}function bpe(t){t.items.push({name:Le}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function S1(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==An&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==An&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==An&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Spe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===YR&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function R1(){this.setListeningDropdownMenu()}function Rpe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):we(e,"htFiltersActive")}function Epe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Yp(Yl,this,mi(Yl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Jl),s=n.filter(a=>a.name!==Jl);if(o.length>=2||s.length>=3)tt(ct`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const FF="internal-use-in-handsontable",qR={licenseKey:FF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function VF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Kn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function WF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Tpe(t){var e;const n=t[Kn],r=WF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=VF(t);return{...qR,...r,...i}}function Mpe(t){var e;const n=t[Kn],r=WF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=VF(t);return{...r,...i}}function _pe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function gy(){const t="engine_relationship",e=ao(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function v_(){const t="shared_engine_usage",e=ao(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Ppe(t){const e=t.getSettings(),n=e[Kn],r=n==null?void 0:n.engine;if(n===!0||Ht(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return xpe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ht(r.hyperformula)){const o=gy(),s=v_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:FF}),(r.getConfig().leapYear1900!==qR.leapYear1900||$v(r.getConfig().nullDate,qR.nullDate)===!1)&&tt(ct`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function xpe(t,e,n){const r=e[Kn],i=Tpe(e),o=gy(),s=v_();Ipe(t,r.functions),Ope(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Ape(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function E1(t){var e;const n=gy(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function T1(t,e){if(t){const n=gy(),r=n.get(t),i=v_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Ipe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){tt(s.message)}})}function Ope(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){tt(r.message)}}}function Ape(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){tt(a.message)}}),t.resumeEvaluation())}function Hpe(t,e){return(Ht(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const BF="DD/MM/YYYY";function Npe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Dpe(t){return Npe(t)?t.substr(1):t}function kpe(t){return typeof t=="string"&&t.startsWith("=")}function y_(t,e){return typeof t=="string"&&e==="date"}function jF(t,e){return Z(t,e,!0).isValid()}function UF(t,e){return Z(t,e,!0).format(BF)}function $pe(t,e){return Z(t,BF,!0).format(e)}function zF(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function Lpe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Fpe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Vpe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function C_(t,e,n){const r=Fpe(t,Lpe(t,e,n));return Vpe(r)}function Sl(t,e,n){Wpe(t,e),e.set(t,n)}function Wpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(t,e){return t.get(YF(t,e))}function la(t,e,n){return t.set(YF(t,e),n),n}function YF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sd=new WeakMap,ua=new WeakMap,Lr=new WeakMap,zm=new WeakMap,Vb=new WeakMap,Wb=new WeakMap,Ym=new WeakMap;class M1{constructor(e,n,r){Sl(this,Sd,void 0),Sl(this,ua,void 0),Sl(this,Lr,void 0),Sl(this,zm,[]),Sl(this,Vb,[]),Sl(this,Wb,void 0),Sl(this,Ym,[]),la(Sd,this,e),la(ua,this,n),la(Lr,this,r)}setRemovedHfIndexes(e){return la(Ym,this,e.map(n=>{const r=xt(ua,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),xt(Ym,this)}getRemovedHfIndexes(){return xt(Ym,this)}getHfIndexFromVisualIndex(e){const n=xt(ua,this).getIndexesSequence(),r=xt(ua,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Zn(xt(Sd,this))}s`;xt(Lr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&xt(Lr,this).getEngine()[r](xt(Lr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(la(Vb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),la(Wb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(xt(Lr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=C_(xt(Vb,this),xt(Wb,this),xt(ua,this).getNumberOfIndexes());xt(Lr,this).getSheetId()===null?xt(Lr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Zn(xt(Sd,this))}Order`;return n=>{if(xt(Lr,this).isPerformingUndoRedo())return;const r=xt(ua,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=xt(zm,this).map(l=>r.indexOf(l)),o=xt(Lr,this).getEngine().getSheetDimensions(xt(Lr,this).getSheetId());let s;xt(Sd,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);xt(Lr,this).getEngine()[e](xt(Lr,this).getSheetId(),i)}la(zm,this,r)}}init(){la(zm,this,xt(ua,this).getIndexesSequence())}}function Rl(t,e,n){Bpe(t,e),e.set(t,n)}function Bpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ms(t,e){return t.get(GF(t,e))}function El(t,e,n){return t.set(GF(t,e),n),n}function GF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gm=new WeakMap,Km=new WeakMap,Bb=new WeakMap,jb=new WeakMap,Ub=new WeakMap,zb=new WeakMap,Yb=new WeakMap;class jpe{constructor(e,n,r){Rl(this,Gm,void 0),Rl(this,Km,void 0),Rl(this,Bb,void 0),Rl(this,jb,!1),Rl(this,Ub,!1),Rl(this,zb,null),Rl(this,Yb,null),El(Gm,this,new M1("row",e,this)),El(Km,this,new M1("column",n,this)),El(Bb,this,r)}getForAxis(e){return e==="row"?ms(Gm,this):ms(Km,this)}setPerformUndo(e){El(jb,this,e)}setPerformRedo(e){El(Ub,this,e)}isPerformingUndoRedo(){return ms(jb,this)||ms(Ub,this)}getSheetId(){return ms(Yb,this)}getEngine(){return ms(zb,this)}getPostponeAction(){return ms(Bb,this)}setupSyncEndpoint(e,n){El(zb,this,e),El(Yb,this,n),ms(Gm,this).init(),ms(Km,this).init()}}function Upe(t,e){KF(t,e),e.add(t)}function Tl(t,e,n){return(e=zpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zpe(t){var e=Ype(t,"string");return typeof e=="symbol"?e:e+""}function Ype(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gb(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function za(t,e,n){return t.set(Xe(t,e),n),n}function nu(t,e){return t.get(Xe(t,e))}function Xe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Kn="formulas",Gpe=["maxRows","maxColumns","language"],Kpe=260;oe.getSingleton().register("afterNamedExpressionAdded");oe.getSingleton().register("afterNamedExpressionRemoved");oe.getSingleton().register("afterSheetAdded");oe.getSingleton().register("afterSheetRemoved");oe.getSingleton().register("afterSheetRenamed");oe.getSingleton().register("afterFormulasValuesUpdate");const bh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var js=new WeakMap,my=new WeakMap,Rd=new WeakMap,Qe=new WeakSet;class qpe extends qe{constructor(){var e;super(...arguments),e=this,Upe(this,Qe),Gb(this,js,!1),Gb(this,my,!1),Gb(this,Rd,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,hwe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,dwe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,fwe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,gwe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,mwe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,pwe).call(e,...r)}]]),Tl(this,"staticRegister",ao("formulas")),Tl(this,"engine",null),Tl(this,"sheetId",null),Tl(this,"sheetName",null),Tl(this,"indexSyncer",null),Tl(this,"rowAxisSyncer",null),Tl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Kn}static get PLUGIN_PRIORITY(){return Kpe}static get SETTING_KEYS(){return[Kn,...Gpe]}isEnabled(){return!!this.hot.getSettings()[Kn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Ppe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){tt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Xe(Qe,this,tf).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,_1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,P1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,_1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,P1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Qpe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,ewe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Xpe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,twe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,x1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,x1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,nwe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,rwe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,swe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,awe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,iwe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,owe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,lwe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,uwe).call(n,...i)}),this.indexSyncer=new jpe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Zpe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,cwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,Jpe).call(n,...i)}),nu(Rd,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){nu(Rd,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),T1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Mpe(this.hot.getSettings());_pe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Kn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Kn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Xe(Qe,this,tf).call(this,o)}}super.updatePlugin(e)}destroy(){nu(Rd,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),za(Rd,this,null),T1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!P$(n))return tt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return tt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return tt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){DE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Xe(Qe,this,tf).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Zn(Kn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),E1(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=E1(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){tt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return y_(r,o.type)&&(jF(r,o.dateFormat)?r=UF(r,o.dateFormat):kpe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function tf(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function Xpe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Gn(s)&&(s=zF(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Jpe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:v}=h.start,{row:y,col:E}=h.end,C=y-g+1,P=E-v+1;for(let A=0;A<f.length;A+=1)for(let _=0;_<f[A].length;_+=1){const T=f[A][_],H=g+A%C,G=v+_%P,U=this.hot.getCellMeta(H,G);y_(T,U.type)&&(T.startsWith("'")?f[A][_]=T.slice(1):this.isFormulaCellType(H,G,this.sheetId)===!1&&(f[A][_]=$pe(T,U.dateFormat)))}return f}function _1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Zn(Kn))||za(my,this,Ht(this.hot.getSettings().data))}function Zpe(){if(nu(my,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;y_(i,s.type)&&(jF(i,a)?t[r][o]=UF(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),za(js,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),za(js,this,!1)}function P1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Zn(Kn)))return;const r=Hpe(this.engine,this.hot.getSettings()[Kn].sheetName);if(Xe(Qe,this,tf).call(this,r),n!=="updateSettings")if(nu(my,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){za(js,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),za(js,this,!1)}}}function Qpe(t,e,n,r){if(r!=="get"||nu(js,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=Dpe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Gn(a)&&(a=zF(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function ewe(t,e,n,r){if(r!=="get"||nu(js,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function x1(t,e){if(bh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function twe(t,e){if(bh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Gn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){tt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function nwe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function rwe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function iwe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function owe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function swe(t,e,n){if(bh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function awe(t,e,n){if(bh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function lwe(t,e,n,r){if(bh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function uwe(t,e,n,r){if(bh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function cwe(t,e,n){var r;za(js,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());za(js,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function hwe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function dwe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function fwe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function gwe(t){this.hot.runHooks("afterSheetAdded",t)}function mwe(t,e){Xe(Qe,this,tf).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function pwe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function wwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(QT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function vwe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(eM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function ywe(t,e){qF(t,e),e.add(t)}function Cwe(t,e,n){qF(t,e),e.set(t,n)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e){return t.get(wa(t,e))}function I1(t,e,n){return t.set(wa(t,e),n),n}function wa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideColumns");oe.getSingleton().register("afterHideColumns");oe.getSingleton().register("beforeUnhideColumns");oe.getSingleton().register("afterUnhideColumns");const O1="hiddenColumns",bwe=310;var yo=new WeakMap,_l=new WeakSet;class Swe extends qe{constructor(){super(...arguments),ywe(this,_l),Cwe(this,yo,null)}static get PLUGIN_KEY(){return O1}static get PLUGIN_PRIORITY(){return bwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[O1]}enablePlugin(){var e=this;this.enabled||(I1(yo,this,new zv),Ml(yo,this).addLocalHook("init",()=>wa(_l,this,Pwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ml(yo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wa(_l,e,_we).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>wa(_l,this,Ewe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>wa(_l,this,Rwe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wa(_l,e,Mwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>wa(_l,this,Twe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Ml(yo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));M(l,u=>{o[u]=!1}),i=bn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Ml(yo,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{Ml(yo,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(Ml(yo,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ml(yo,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){I1(yo,this,null),super.destroy()}}function Rwe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Ewe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Twe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return M(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Mwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function _we(t){t.items.push({name:Le},wwe(this),vwe(this))}function Pwe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function xwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(tM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Iwe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(nM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Owe(t,e){XF(t,e),e.add(t)}function Awe(t,e,n){XF(t,e),e.set(t,n)}function XF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pl(t,e){return t.get(va(t,e))}function A1(t,e,n){return t.set(va(t,e),n),n}function va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideRows");oe.getSingleton().register("afterHideRows");oe.getSingleton().register("beforeUnhideRows");oe.getSingleton().register("afterUnhideRows");const H1="hiddenRows",Hwe=320;var Co=new WeakMap,xl=new WeakSet;class Nwe extends qe{constructor(){super(...arguments),Owe(this,xl),Awe(this,Co,null)}static get PLUGIN_KEY(){return H1}static get PLUGIN_PRIORITY(){return Hwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[H1]}enablePlugin(){var e=this;this.enabled||(A1(Co,this,new zv),Pl(Co,this).addLocalHook("init",()=>va(xl,this,Vwe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Pl(Co,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(xl,e,Fwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>va(xl,this,kwe).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>va(xl,this,Dwe).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(xl,e,Lwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>va(xl,this,$we).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Pl(Co,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));M(l,u=>{o[u]=!1}),i=bn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Pl(Co,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{Pl(Co,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(Pl(Co,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Pl(Co,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){A1(Co,this,null),super.destroy()}}function Dwe(t,e){return this.isHidden(e)?0:t}function kwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function $we(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return M(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Lwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function Fwe(t){t.items.push({name:Le},xwe(this),Iwe(this))}function Vwe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Wwe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(xT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Bwe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(IT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function jwe(t,e){JF(t,e),e.add(t)}function Uwe(t,e,n){JF(t,e),e.set(t,n)}function JF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XR(t,e){return t.get(Uw(t,e))}function Kb(t,e,n){return t.set(Uw(t,e),n),n}function Uw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnFreeze");oe.getSingleton().register("afterColumnFreeze");oe.getSingleton().register("beforeColumnUnfreeze");oe.getSingleton().register("afterColumnUnfreeze");const N1="manualColumnFreeze",zwe=110;var Bl=new WeakMap,qb=new WeakSet;class Ywe extends qe{constructor(){super(...arguments),jwe(this,qb),Uwe(this,Bl,!1)}static get PLUGIN_KEY(){return N1}static get PLUGIN_PRIORITY(){return zwe}isEnabled(){return!!this.hot.getSettings()[N1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Uw(qb,this,Gwe).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Uw(qb,this,Kwe).call(this,e,n)),super.enablePlugin())}disablePlugin(){Kb(Bl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;XR(Bl,this)||Kb(Bl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;XR(Bl,this)||Kb(Bl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Gwe(t){t.items.push({name:"---------"},Wwe(this),Bwe(this))}function Kwe(t,e){if(XR(Bl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function qm(t,e,n){return(e=qwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qwe(t){var e=Xwe(t,"string");return typeof e=="symbol"?e:e+""}function Xwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xb=0,D1=1,k1=2,lc="px";let ZF=class{constructor(e){qm(this,"hot",void 0),qm(this,"_element",null),qm(this,"state",Xb),qm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=k1}build(){this.state===Xb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=D1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Xb}isAppended(){return this.state===k1}isBuilt(){return this.state>=D1}setPosition(e,n){Gn(e)&&(this._element.style.top=e+lc),Gn(n)&&(this._element.style[this.inlineProperty]=n+lc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Gn(e)&&(this._element.style.width=e+lc),Gn(n)&&(this._element.style.height=n+lc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Gn(e)&&(this._element.style.marginTop=e+lc),Gn(n)&&(this._element.style[`margin${Zn(this.inlineProperty)}`]=n+lc)}getOffset(){const e=this._element.style,n=`margin${Zn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Jwe="ht__manualColumnMove--backlight";let Zwe=class extends ZF{build(){super.build(),q(this._element,Jwe)}};const Qwe="ht__manualColumnMove--guideline";let eve=class extends ZF{build(){super.build(),q(this._element,Qwe)}};function tve(t,e){QF(t,e),e.add(t)}function $i(t,e,n){QF(t,e),e.set(t,n)}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(t,e,n){return t.set(ya(t,e),n),n}function he(t,e){return t.get(ya(t,e))}function ya(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnMove");oe.getSingleton().register("afterColumnMove");const Jb="manualColumnMove",nve=120,$1="ht__manualColumnMove",zw="show-ui",JR="on-moving--columns",ZR="after-selection--columns";var lr=new WeakMap,Sa=new WeakMap,Ns=new WeakMap,Gp=new WeakMap,Aa=new WeakMap,ar=new WeakMap,Xm=new WeakMap,hi=new WeakMap,Ec=new WeakMap,Yw=new WeakMap,nf=new WeakMap,Il=new WeakSet;class rve extends qe{constructor(){super(...arguments),tve(this,Il),$i(this,lr,new Zwe(this.hot)),$i(this,Sa,new eve(this.hot)),$i(this,Ns,[]),$i(this,Gp,0),$i(this,Aa,!1),$i(this,ar,{}),$i(this,Xm,void 0),$i(this,hi,void 0),$i(this,Ec,void 0),$i(this,Yw,void 0),$i(this,nf,void 0)}static get PLUGIN_KEY(){return Jb}static get PLUGIN_PRIORITY(){return nve}isEnabled(){return!!this.hot.getSettings()[Jb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,ive).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,sve).call(e,...r)}),this.addHook("afterScrollVertically",()=>ya(Il,this,lve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,uve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,$1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,$1),this.unregisterEvents(),he(lr,this).destroy(),he(Sa,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(Xm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Or(Xm,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Or(Xm,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=bn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Jb];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(hi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(hi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(lr,this).getOffset().start,u=he(lr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,v=Qt(this.hot.rootElement),y=g.innerWidth-he(Ec,this)-v;h=g.innerWidth-he(ar,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=he(ar,this).eventPageX-(he(Ec,this)-(r.scrollX===void 0?i:0));if(he(Yw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(hi,this))&&(o+=i),o+=c,he(hi,this)<0)he(nf,this)>0?he(ar,this).col=0:he(ar,this).col=e>0?e-1:e;else if(he(ar,this).TD.offsetWidth/2+o<=h){const g=he(hi,this)>=he(Gp,this)?he(Gp,this)-1:he(hi,this);he(ar,this).col=g+1,o+=he(ar,this).TD.offsetWidth}else he(ar,this).col=he(hi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(hi,this)<he(nf,this)&&(f-=he(Ec,this)<=r.scrollX?he(Ec,this):0),he(lr,this).setPosition(null,d),he(Sa,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ya(Il,this,ove).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ya(Il,this,ave).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(lr,this).build(),he(Sa,this).build()}destroy(){he(lr,this).destroy(),he(Sa,this).destroy(),super.destroy()}}function ive(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ve(t.target,"sortAction");if(!s||!o||he(Aa,this)||t.button!==0||a){Or(Aa,this,!1),he(Ns,this).length=0,we(this.hot.rootElement,[JR,zw]);return}const l=he(Sa,this).isBuilt()&&!he(Sa,this).isAppended(),u=he(lr,this).isBuilt()&&!he(lr,this).isAppended();l&&u&&(he(Sa,this).appendTo(i.hider),he(lr,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Or(Aa,this,!0);const g=n.firstChild?Yk(t,n.firstChild).x:t.offsetX;he(ar,this).eventPageX=t.pageX,Or(hi,this,e.col),he(ar,this).TD=n,he(ar,this).col=e.col,Or(Ns,this,this.prepareColumnsToMoving(d,f)),Or(Yw,this,!!this.hot.getSettings().rowHeaders),Or(Gp,this,this.hot.countCols()),Or(nf,this,this.hot.getSettings().fixedColumnsStart),Or(Ec,this,Ln(this.hot.rootElement).left);const v=he(Yw,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(nf,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),P=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),A=this.getColumnsWidth(d,e.col-1)+P,_=this.getColumnsWidth(v,d-1)+(E?C:0)+A;he(lr,this).setPosition(y,_),he(lr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),he(lr,this).setOffset(null,-A),q(this.hot.rootElement,JR)}else we(this.hot.rootElement,ZR),Or(Aa,this,!1),he(Ns,this).length=0}function ove(t){he(Aa,this)&&(he(ar,this).eventPageX=t.pageX,this.refreshPositions())}function sve(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(Aa,this)||(he(Ns,this).indexOf(e.col)>-1?we(this.hot.rootElement,zw):q(this.hot.rootElement,zw),r.row=!0,r.column=!0,r.cell=!0,Or(hi,this,e.col),he(ar,this).TD=n)}function ave(){const t=he(ar,this).col,e=he(Ns,this).length;if(Or(hi,this,void 0),Or(Aa,this,!1),we(this.hot.rootElement,[JR,zw,ZR]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,ZR),e<1||t===void 0)return;const n=he(Ns,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(Ns,this),t);if(he(Ns,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function lve(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(lr,this).setPosition(r),he(lr,this).setSize(null,t.hider.offsetHeight-r)}function uve(){this.moveBySettingsOrLoad()}function cve(t,e){eV(t,e),e.add(t)}function Bn(t,e,n){eV(t,e),e.set(t,n)}function eV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zt(t,e,n){return t.set(zi(t,e),n),n}function se(t,e){return t.get(zi(t,e))}function zi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gw="manualColumnResize",hve=130,L1="manualColumnWidths";var Ts=new WeakMap,Jm=new WeakMap,Gr=new WeakMap,Kw=new WeakMap,Fo=new WeakMap,dve=new WeakMap,jc=new WeakMap,Zm=new WeakMap,Sr=new WeakMap,bs=new WeakMap,fu=new WeakMap,qw=new WeakMap,rf=new WeakMap,of=new WeakMap,qr=new WeakMap,sf=new WeakMap,bo=new WeakSet;class fve extends qe{static get PLUGIN_KEY(){return Gw}static get PLUGIN_PRIORITY(){return hve}constructor(e){super(e),cve(this,bo),Bn(this,Ts,null),Bn(this,Jm,null),Bn(this,Gr,[]),Bn(this,Kw,null),Bn(this,Fo,null),Bn(this,dve,null),Bn(this,jc,null),Bn(this,Zm,null),Bn(this,Sr,this.hot.rootDocument.createElement("DIV")),Bn(this,bs,this.hot.rootDocument.createElement("DIV")),Bn(this,fu,null),Bn(this,qw,!1),Bn(this,rf,0),Bn(this,of,null),Bn(this,qr,void 0),Bn(this,sf,void 0),q(se(Sr,this),"manualColumnResizer"),q(se(bs,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Gw]}enablePlugin(){var e=this;this.enabled||(Zt(qr,this,new Ka),se(qr,this).addLocalHook("init",()=>zi(bo,this,gve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,se(qr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zi(bo,e,Cve).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zi(bo,e,bve).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zi(bo,e,Sve).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Zt(sf,this,se(qr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",L1,se(qr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",L1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return se(qr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);se(qr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Zt(Ts,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(se(Ts,this)),i=r.col;if(i<0)return;const o=ln(se(Ts,this)),s=se(Ts,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(Ts,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(se(Ts,this),r.row,r.col)),Zt(Jm,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Zt(Gr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();M(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{se(Gr,this).includes(g)||se(Gr,this).push(g)})})}se(Gr,this).includes(se(Jm,this))||Zt(Gr,this,[se(Jm,this)]),Zt(Zm,this,l.start-6),Zt(jc,this,parseInt(s.width,10)),se(Sr,this).style.top=`${l.top}px`,se(Sr,this).style[this.inlineDir]=`${se(Zm,this)+se(jc,this)}px`,se(Sr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(se(Sr,this))}refreshHandlePosition(){se(Sr,this).style[this.inlineDir]=`${se(Zm,this)+se(Kw,this)}px`}setupGuidePosition(){const e=parseInt(ln(se(Sr,this)),10),n=parseInt(se(Sr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(se(Sr,this),"active"),q(se(bs,this),"active"),se(bs,this).style.top=`${n}px`,this.refreshGuidePosition(),se(bs,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(se(bs,this))}refreshGuidePosition(){se(bs,this).style[this.inlineDir]=se(Sr,this).style[this.inlineDir]}hideHandleAndGuide(){we(se(Sr,this),"active"),we(se(bs,this),"active")}checkIfColumnHeader(e){const n=Wa(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",se(Fo,this),r,!0);o!==void 0&&Zt(Fo,this,o),this.setManualSize(r,se(Fo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Fo,this),r,!0),i&&e()};se(rf,this)>=2&&(se(Gr,this).length>1?(M(se(Gr,this),i=>{n(i)}),e()):M(se(Gr,this),i=>{n(i,!0)})),Zt(rf,this,0),Zt(of,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>zi(bo,this,mve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>zi(bo,this,pve).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>zi(bo,this,wve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>zi(bo,this,vve).call(this)),this.eventManager.addEventListener(se(Sr,this),"contextmenu",()=>zi(bo,this,yve).call(this))}destroy(){super.destroy()}}function gve(){const t=this.hot.getSettings()[Gw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{se(qr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{se(qr,this).setValueAtIndex(r,n)})},!0),Zt(sf,this,t)):t===!0&&Array.isArray(se(sf,this))&&this.hot.batchExecution(()=>{se(sf,this).forEach((n,r)=>{se(qr,this).setValueAtIndex(r,n)})},!0)}function mve(t){if(!ME(t.target)&&se(qw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(se(fu,this)||this.setupHandlePosition(e))}}function pve(t){t.target.parentNode===this.hot.rootElement&&ve(t.target,"manualColumnResizer")&&(this.setupHandlePosition(se(Ts,this)),this.setupGuidePosition(),Zt(fu,this,!0),se(of,this)===null&&(Zt(of,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(of,this))),Zt(rf,this,se(rf,this)+1),this.startX=t.pageX,Zt(Fo,this,se(jc,this)))}function wve(t){if(se(fu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Zt(Kw,this,se(jc,this)+e),M(se(Gr,this),n=>{Zt(Fo,this,this.setManualSize(n,se(Kw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function vve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",se(Fo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Fo,this),n,!1)};se(fu,this)&&(this.hideHandleAndGuide(),Zt(fu,this,!1),se(Fo,this)!==se(jc,this)&&(se(Gr,this).length>1?(M(se(Gr,this),r=>{e(r)}),t()):M(se(Gr,this),r=>{e(r,!0)})),this.setupHandlePosition(se(Ts,this)))}function yve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(Sr,this)),this.hot.rootElement.removeChild(se(bs,this)),Zt(fu,this,!1),Zt(qw,this,!0),this.hot._registerImmediate(()=>{Zt(qw,this,!1)})}function Cve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=se(qr,this).getValueAtIndex(r);this.hot.getSettings()[Gw]&&i&&(n=i)}return n}function bve(t,e){const n=se(qr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Sve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Zb(t,e,n){return(e=Rve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rve(t){var e=Eve(t,"string");return typeof e=="symbol"?e:e+""}function Eve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qb=0,F1=1,V1=2,uc="px";let tV=class{constructor(e){Zb(this,"hot",void 0),Zb(this,"_element",null),Zb(this,"state",Qb),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=V1}build(){this.state===Qb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=F1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Qb}isAppended(){return this.state===V1}isBuilt(){return this.state>=F1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+uc),n!==void 0&&(this._element.style.left=n+uc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+uc),n&&(this._element.style.height=n+uc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+uc),n&&(this._element.style.marginLeft=n+uc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Tve="ht__manualRowMove--backlight";class Mve extends tV{build(){super.build(),q(this._element,Tve)}}const _ve="ht__manualRowMove--guideline";class Pve extends tV{build(){super.build(),q(this._element,_ve)}}function xve(t,e){nV(t,e),e.add(t)}function cc(t,e,n){nV(t,e),e.set(t,n)}function nV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zl(t,e,n){return t.set(Ca(t,e),n),n}function Pe(t,e){return t.get(Ca(t,e))}function Ca(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeRowMove");oe.getSingleton().register("afterRowMove");const eS="manualRowMove",Ive=140,W1="ht__manualRowMove",Xw="show-ui",QR="on-moving--rows",e0="after-selection--rows";var ur=new WeakMap,Ra=new WeakMap,Ds=new WeakMap,Ha=new WeakMap,Ar=new WeakMap,Qm=new WeakMap,Ol=new WeakSet;class Ove extends qe{constructor(){super(...arguments),xve(this,Ol),cc(this,ur,new Mve(this.hot)),cc(this,Ra,new Pve(this.hot)),cc(this,Ds,[]),cc(this,Ha,void 0),cc(this,Ar,{}),cc(this,Qm,void 0)}static get PLUGIN_KEY(){return eS}static get PLUGIN_PRIORITY(){return Ive}isEnabled(){return!!this.hot.getSettings()[eS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,Ave).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,Nve).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ca(Ol,this,kve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,$ve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,W1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,W1),this.unregisterEvents(),Pe(ur,this).destroy(),Pe(Ra,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Pe(Qm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Zl(Qm,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Zl(Qm,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=bn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[eS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Pe(Ar,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Pe(Ar,this).TD,a=this.hot.rootElement,l=Ln(a),u=qc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Pe(Ar,this).eventPageY-d+c,g=o.hider.offsetHeight,v=o.TBODY.offsetTop,y=Pe(ur,this).getOffset().top,E=Pe(ur,this).getSize().height,C=s.offsetHeight/2,P=s.offsetHeight;let A=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const _=f>=A+C;this.isFixedRowTop(e.row)&&(A+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Pe(Ar,this).row=n>0?n-1:n:_?(Pe(Ar,this).row=e.row+1,A+=e.row===0?P-1:P):Pe(Ar,this).row=e.row;let T=f,H=A;f+E+y>=g?T=g-E-y:f+y<v&&(T=v+Math.abs(y)),A>=g-1&&(H=g-1),Pe(ur,this).setPosition(T),Pe(Ra,this).setPosition(H)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ca(Ol,this,Hve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ca(Ol,this,Dve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(ur,this).build(),Pe(Ra,this).build()}destroy(){Pe(ur,this).destroy(),Pe(Ra,this).destroy(),super.destroy()}}function Ave(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Pe(Ha,this)||t.button!==0){Zl(Ha,this,!1),Pe(Ds,this).length=0,we(this.hot.rootElement,[QR,Xw]);return}const l=Pe(Ra,this).isBuilt()&&!Pe(Ra,this).isAppended(),u=Pe(ur,this).isBuilt()&&!Pe(ur,this).isAppended();l&&u&&(Pe(Ra,this).appendTo(i.hider),Pe(ur,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,Zl(Ha,this,!0),Pe(Ar,this).eventPageY=t.pageY,Pe(Ar,this).coords=e,Pe(Ar,this).TD=n,Zl(Ds,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Pe(ur,this).setPosition(null,g),Pe(ur,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Pe(ur,this).setOffset(-v,null),q(this.hot.rootElement,QR),this.refreshPositions()}else we(this.hot.rootElement,e0),Zl(Ha,this,!1),Pe(Ds,this).length=0}function Hve(t){Pe(Ha,this)&&(Pe(Ar,this).eventPageY=t.pageY,this.refreshPositions())}function Nve(t,e,n,r){!this.hot.getSelectedRangeLast()||!Pe(Ha,this)||(Pe(Ds,this).indexOf(e.row)>-1?we(this.hot.rootElement,Xw):q(this.hot.rootElement,Xw),r.row=!0,r.column=!0,r.cell=!0,Pe(Ar,this).coords=e,Pe(Ar,this).TD=n)}function Dve(){const t=Pe(Ar,this).row,e=Pe(Ds,this).length;if(Zl(Ha,this,!1),we(this.hot.rootElement,[QR,Xw,e0]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,e0),e<1||t===void 0)return;const n=Pe(Ds,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Pe(Ds,this),t);if(Pe(Ds,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function kve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Pe(ur,this).setPosition(null,r),Pe(ur,this).setSize(t.hider.offsetWidth-r)}function $ve(){this.moveBySettingsOrLoad()}function Lve(t,e){rV(t,e),e.add(t)}function jn(t,e,n){rV(t,e),e.set(t,n)}function rV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jt(t,e,n){return t.set(Ms(t,e),n),n}function ie(t,e){return t.get(Ms(t,e))}function Ms(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jw="manualRowResize",Fve=30,B1="manualRowHeights";var Ao=new WeakMap,ep=new WeakMap,Kr=new WeakMap,af=new WeakMap,Ea=new WeakMap,b_=new WeakMap,Uc=new WeakMap,tp=new WeakMap,or=new WeakMap,xo=new WeakMap,gu=new WeakMap,Zw=new WeakMap,lf=new WeakMap,uf=new WeakMap,qi=new WeakMap,cf=new WeakMap,ca=new WeakSet;class Vve extends qe{static get PLUGIN_KEY(){return Jw}static get PLUGIN_PRIORITY(){return Fve}constructor(e){super(e),Lve(this,ca),jn(this,Ao,null),jn(this,ep,null),jn(this,Kr,[]),jn(this,af,null),jn(this,Ea,null),jn(this,b_,null),jn(this,Uc,null),jn(this,tp,null),jn(this,or,this.hot.rootDocument.createElement("DIV")),jn(this,xo,this.hot.rootDocument.createElement("DIV")),jn(this,gu,!1),jn(this,Zw,!1),jn(this,lf,0),jn(this,uf,null),jn(this,qi,void 0),jn(this,cf,void 0),q(ie(or,this),"manualRowResizer"),q(ie(xo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Jw]}enablePlugin(){this.enabled||(jt(qi,this,new Ka),ie(qi,this).addLocalHook("init",()=>Ms(ca,this,Gve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ie(qi,this)),this.addHook("modifyRowHeight",(e,n)=>Ms(ca,this,Yve).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){jt(cf,this,ie(qi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",B1,ie(qi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",B1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return ie(qi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ie(af,this)}setupHandlePosition(e){jt(Ao,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ie(Ao,this)),o=i.row;if(o<0)return;const s=Qt(ie(Ao,this)),a=ie(Ao,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(Ao,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ie(Ao,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ie(Ao,this),i.row,i.col)),jt(ep,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),jt(Kr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();M(d,f=>{const g=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;fe(g,v,y=>{ie(Kr,this).includes(y)||ie(Kr,this).push(y)})})}ie(Kr,this).includes(ie(ep,this))||jt(Kr,this,[ie(ep,this)]),jt(tp,this,c.top-6),jt(Uc,this,parseInt(a.height,10)),ie(or,this).style.top=`${ie(tp,this)+ie(Uc,this)}px`,ie(or,this).style[this.inlineDir]=`${c.start}px`,ie(or,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ie(or,this))}refreshHandlePosition(){ie(or,this).style.top=`${ie(tp,this)+ie(af,this)}px`}setupGuidePosition(){const e=parseInt(Qt(ie(or,this)),10),n=parseInt(ie(or,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(ie(or,this),"active"),q(ie(xo,this),"active"),ie(xo,this).style.top=ie(or,this).style.top,ie(xo,this).style[this.inlineDir]=`${n}px`,ie(xo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ie(xo,this))}refreshGuidePosition(){ie(xo,this).style.top=ie(or,this).style.top}hideHandleAndGuide(){we(ie(or,this),"active"),we(ie(xo,this),"active")}checkIfRowHeader(e){const n=Wa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ie(Ea,this)<n?n:ie(Ea,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&jt(Ea,this,o),this.setManualSize(r,ie(Ea,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ie(lf,this)>=2&&(ie(Kr,this).length>1?(M(ie(Kr,this),i=>{n(i)}),e()):M(ie(Kr,this),i=>{n(i,!0)})),jt(lf,this,0),jt(uf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ms(ca,this,Wve).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ms(ca,this,Bve).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Ms(ca,this,jve).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Ms(ca,this,Uve).call(this)),this.eventManager.addEventListener(ie(or,this),"contextmenu",()=>Ms(ca,this,zve).call(this))}destroy(){super.destroy()}}function Wve(t){if(!ME(t.target)&&ie(Zw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ie(gu,this)||this.setupHandlePosition(e))}}function Bve(t){ve(t.target,"manualRowResizer")&&(this.setupHandlePosition(ie(Ao,this)),this.setupGuidePosition(),jt(gu,this,!0),ie(uf,this)===null&&(jt(uf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(uf,this))),jt(lf,this,ie(lf,this)+1),jt(b_,this,t.pageY),jt(Ea,this,ie(Uc,this)))}function jve(t){ie(gu,this)&&(jt(af,this,ie(Uc,this)+(t.pageY-ie(b_,this))),M(ie(Kr,this),e=>{jt(Ea,this,this.setManualSize(e,ie(af,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Uve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ie(gu,this)&&(this.hideHandleAndGuide(),jt(gu,this,!1),ie(Ea,this)!==ie(Uc,this)&&(ie(Kr,this).length>1?(M(ie(Kr,this),r=>{e(r)}),t()):M(ie(Kr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(Ao,this)))}function zve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(or,this)),this.hot.rootElement.removeChild(ie(xo,this)),jt(gu,this,!1),jt(Zw,this,!0),this.hot._registerImmediate(()=>{jt(Zw,this,!1)})}function Yve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ie(qi,this).getValueAtIndex(r);this.hot.getSettings()[Jw]&&i&&(n=i)}return n}function Gve(){const t=this.hot.getSettings()[Jw],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ie(qi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ie(qi,this).setValueAtIndex(r,n)}),jt(cf,this,t)):t===!0&&Array.isArray(ie(cf,this))&&ie(cf,this).forEach((n,r)=>{ie(qi,this).setValueAtIndex(r,n)})},!0)}var Kve=Vv;Kve("flatMap");var qve=vn,j1=Cn,Xve=Jo,Jve=$0,Zve=function(t,e){(!e||typeof t!="string")&&j1(t);var n=Jve(t);return Xve(j1(n!==void 0?qve(n,t):t))},Qve=yt,t0=vn,eye=Dr,n0=Cn,tye=Jo,nye=Zve,rye=j0,r0=ti,iye=Ga,tS=iye("flatMap",TypeError),oye=rye(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=n0(t0(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){r0(t,"throw",i)}if(n=n0(t0(this.next,t)),this.done=!!n.done)return;try{this.inner=nye(e(n.value,this.counter++),!1)}catch(i){r0(t,"throw",i)}}});Qve({target:"Iterator",proto:!0,real:!0,forced:tS},{flatMap:function(e){n0(this);try{eye(e)}catch(n){r0(this,"throw",n)}return tS?t0(tS,this,e):new oye(tye(this),{mapper:e,inner:null})}});function sye(t,e,n){aye(t,e),e.set(t,n)}function aye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(t,e,n){return(e=lye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lye(t){var e=uye(t,"string");return typeof e=="symbol"?e:e+""}function uye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U1(t,e){return t.get(iV(t,e))}function np(t,e,n){return t.set(iV(t,e),n),n}function iV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hl=new WeakMap;class Ho{constructor(e,n,r,i,o,s){Al(this,"row",void 0),Al(this,"col",void 0),Al(this,"rowspan",void 0),Al(this,"colspan",void 0),Al(this,"removed",!1),Al(this,"cellCoordsFactory",void 0),Al(this,"cellRangeFactory",void 0),sye(this,Hl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return ct`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return ct`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return ct`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return ct`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),np(Hl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,np(Hl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return np(Hl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return U1(Hl,this)||np(Hl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),U1(Hl,this)}}function cye(t,e){hye(t,e),e.add(t)}function hye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rp(t,e,n){return(e=dye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dye(t){var e=fye(t,"string");return typeof e=="symbol"?e:e+""}function fye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ha=new WeakSet;class Qw{constructor(e){cye(this,ha),rp(this,"plugin",void 0),rp(this,"mergedCells",[]),rp(this,"mergedCellsMatrix",new Map),rp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return ct`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){tt(Qw.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Ho(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Nl(ha,this,z1).call(this,a),a):(u&&tt(Qw.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Nl(ha,this,gye).call(this,r),r):!1}clear(){M(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ye(u,i,i+s-1),d=Ye(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Nl(ha,this,ip).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Nl(ha,this,ip).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Nl(ha,this,ip).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Nl(ha,this,ip).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Nl(ha,this,z1).call(this,s)})}}function ip(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function z1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function gye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function nS(t,e,n){return(e=mye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mye(t){var e=pye(t,"string");return typeof e=="symbol"?e:e+""}function pye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wye{constructor(e){nS(this,"plugin",void 0),nS(this,"mergedCellsCollection",void 0),nS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const y=v.row+v.rowspan-a-g;o[2]+y>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?y:0}else if(r==="right"){const y=v.col+v.colspan-l-g;o[3]+y>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?y:0}else if(r==="up"){const y=u-g-v.row+1;o[0]+y<0?o[0]+=g:o[0]-=g?y:0}else if(r==="left"){const y=c-g-v.col+1;o[1]+y<0?o[1]+=g:o[1]-=g?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),un(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,v=d-g;let y=null,E=null,C=null;switch(r){case"up":y="includesVertically",C=c-v+1;break;case"left":y="includesHorizontally",C=c-v+1;break;case"down":y="includesVertically",C=h+v-1;break;case"right":y="includesHorizontally",C=h+v-1;break}return M(i,P=>{P[y](C)&&P.isFarther(E,r)&&(E=P)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return M(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:v}=g;return v===h.getWidth()}):!f.every(g=>{let{rowspan:v}=g;return v===h.getHeight()})}}function rS(t,e,n){return(e=vye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vye(t){var e=yye(t,"string");return typeof e=="symbol"?e:e+""}function yye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cye{constructor(e){rS(this,"plugin",void 0),rS(this,"hot",void 0),rS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function bye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(AT)}return this.getTranslatedPhrase(OT)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Ho.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function hf(t,e,n){return(e=Sye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sye(t){var e=Rye(t,"string");return typeof e=="symbol"?e:e+""}function Rye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y1{constructor(e){hf(this,"data",void 0),hf(this,"next",null),hf(this,"prev",null),this.data=e}}class op{constructor(){hf(this,"first",null),hf(this,"last",null)}push(e){const n=new Y1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new Y1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Eye(t,e){oV(t,e),e.add(t)}function Dl(t,e,n){oV(t,e),e.set(t,n)}function oV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){return t.get(ev(t,e))}function Fr(t,e,n){return t.set(ev(t,e),n),n}function ev(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var So=new WeakMap,Ro=new WeakMap,Eo=new WeakMap,To=new WeakMap,i0=new WeakMap,sp=new WeakMap,ap=new WeakMap,iS=new WeakSet;class Tye{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Eye(this,iS),Dl(this,So,new op),Dl(this,Ro,new op),Dl(this,Eo,null),Dl(this,To,null),Dl(this,i0,null),Dl(this,sp,null),Dl(this,ap,null),Fr(i0,this,n),Fr(sp,this,r),Fr(ap,this,i)}getCurrentVerticalNode(){return at(To,this).data}getFirstVerticalNode(){return at(Ro,this).first.data}getNextVerticalNode(){return at(To,this).next.data}getPrevVerticalNode(){return at(To,this).prev.data}getCurrentHorizontalNode(){return at(Eo,this).data}getFirstHorizontalNode(){return at(So,this).first.data}getNextHorizontalNode(){return at(Eo,this).next.data}getPrevHorizontalNode(){return at(Eo,this).prev.data}setPrevNodeAsActive(){Fr(To,this,at(To,this).prev),Fr(Eo,this,at(Eo,this).prev)}setNextNodeAsActive(){Fr(To,this,at(To,this).next),Fr(Eo,this,at(Eo,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Fr(So,this,new op);for(let s=n.row;s<=r.row;s++)if(!at(sp,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(at(ap,this).isHidden(a))continue;const l=ev(iS,this,G1).call(this,e,at(So,this),i,s,a);l&&Fr(Eo,this,l)}at(So,this).first&&(at(So,this).first.prev=at(So,this).last,at(So,this).last.next=at(So,this).first);const o=new WeakSet;Fr(Ro,this,new op);for(let s=n.col;s<=r.col;s++)if(!at(ap,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(at(sp,this).isHidden(a))continue;const l=ev(iS,this,G1).call(this,e,at(Ro,this),o,a,s);l&&Fr(To,this,l)}at(Ro,this).first&&(at(Ro,this).first.prev=at(Ro,this).last,at(Ro,this).last.next=at(Ro,this).first)}setActiveNode(e,n){return at(So,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Fr(Eo,this,r),!1}),at(Ro,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Fr(To,this,r),!1}),this}}function G1(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=at(i0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function sV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function Mye(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!De(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),xf()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[v,y]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if(xf()&&d===0&&!e.getSettings().rowHeaders){const V=sV(e,h,g);i.set(l,V/g)}const C=n.getRenderableFromVisualIndex(l),P=r.getRenderableFromVisualIndex(u),A=v-C+1,_=y-P+1;let T=n.getNearestNotHiddenIndex(h,1),H=r.getNearestNotHiddenIndex(d,1);if(E){const V=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(V)||(T=Math.max(T,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(V)||(H=Math.max(H,e.getFirstRenderedVisibleColumn()))}const G=Math.min(g,A),U=Math.min(f,_);T===l&&H===u?(a.setAttribute("rowspan",G),a.setAttribute("colspan",U)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function _ye(t,e){aV(t,e),e.add(t)}function lp(t,e,n){aV(t,e),e.set(t,n)}function aV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oS(t,e,n){return(e=Pye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pye(t){var e=xye(t,"string");return typeof e=="symbol"?e:e+""}function xye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bf(t,e,n){return t.set(ht(t,e),n),n}function vt(t,e){return t.get(ht(t,e))}function ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeMergeCells");oe.getSingleton().register("afterMergeCells");oe.getSingleton().register("beforeUnmergeCells");oe.getSingleton().register("afterUnmergeCells");const o0="mergeCells",Iye=150,K1=o0;var vi=new WeakMap,yi=new WeakMap,Vo=new WeakMap,q1=new WeakMap,pt=new WeakSet;class Oye extends qe{constructor(){super(...arguments),_ye(this,pt),oS(this,"mergedCellsCollection",null),oS(this,"autofillCalculations",null),oS(this,"selectionCalculations",null),lp(this,vi,null),lp(this,yi,{row:0,col:0}),lp(this,Vo,new Tye({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),lp(this,q1,Mye(this))}static get PLUGIN_KEY(){return o0}static get PLUGIN_PRIORITY(){return Iye}static get DEFAULT_SETTINGS(){return{[_L]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[o0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Qw(this),this.autofillCalculations=new wye(this),this.selectionCalculations=new Cye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Aye).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Nye).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Dye).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,kye).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,$ye).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,J1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,J1).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Fye).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Vye).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Wye).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,X1).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,X1).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Hye).call(e,...r)}),this.addHook("afterRenderer",function(){return vt(q1,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Lye).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Bye).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,jye).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Uye).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,zye).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Yye).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Gye).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Kye).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,qye).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Xye).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Jye).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Zye).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,Qye).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,eCe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(pt,e,tCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!OE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Mf(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Mf(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Ho.containsNegativeValues(e)?(tt(Ho.NEGATIVE_VALUES_WARNING(e)),!1):Ho.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(tt(Ho.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Ho.isSingleCell(e)?(tt(Ho.IS_SINGLE_CELL(e)),!1):Ho.containsZeroSpan(e)?(tt(Ho.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),M(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:K1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(K1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Aye(){this.generateFromSettings(),this.hot.render()}function Hye(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Nye(t){vt(yi,this).row=t.row,vt(yi,this).col=t.col}function Dye(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;vt(vi,this)&&(i.getRenderableFromVisualIndex(vt(vi,this).row)!==null&&(n.row=vt(vi,this).row),r.getRenderableFromVisualIndex(vt(vi,this).col)!==null&&(n.col=vt(vi,this).col),Bf(vi,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function kye(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function $ye(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Bf(vi,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Bf(vi,this,e.clone()),n&&e.assign(n)}function X1(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ye(g,u,h),Ye(v,c,d),Ye(this.hot.getLastRenderedVisibleRow(),u,h),Ye(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Lye(t){t.items.push({name:"---------"},bye(this))}function J1(){Bf(vi,this,null)}function Fye(){if(vt(vi,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=vt(vi,this).clone().normalize();vt(Vo,this).setActiveNode(r.row,r.col),vt(yi,this).row>0||vt(yi,this).col>0?vt(Vo,this).setPrevNodeAsActive():(n==="E-W"&&vt(yi,this).col<0||e==="S-N"&&vt(yi,this).row<0)&&vt(Vo,this).setNextNodeAsActive()}function Vye(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(vt(yi,this).col<0){const{rowEnd:a,colEnd:l}=vt(Vo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(vt(yi,this).col>0){const{rowStart:a,colStart:l}=vt(Vo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(vt(yi,this).row<0){const{rowEnd:a,colEnd:l}=vt(Vo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(vt(yi,this).row>0){const{rowStart:a,colStart:l}=vt(Vo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}vt(Vo,this).setActiveNode(t,e),Bf(yi,this,{row:0,col:0})}function Wye(){this.hot.getSelectedRangeLast().isHeader()||vt(Vo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Bye(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function jye(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Uye(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function zye(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function Yye(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Gye(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Kye(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function qye(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Xye(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Jye(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);M(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Zye(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Qye(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function eCe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function tCe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,sV(this.hot,e,g))}),t}function nCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:$L(u.type))(l,u,d)(c,h);if(g===zo){const v=a+1;if(typeof e[v]<"u")return s(v)}return g}(0)}}const lV="sort";function rCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${lV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function iCe(t){const e=t.className.split(" "),n=new RegExp(`^${lV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function oCe(t,e,n){return(e=sCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sCe(t){var e=aCe(t,"string");return typeof e=="symbol"?e:e+""}function aCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tv="multiColumnSorting",lCe=170,Z1=tv;kL(tv,nCe);class uCe extends YL{constructor(){super(...arguments),oCe(this,"pluginKey",tv)}static get PLUGIN_KEY(){return tv}static get PLUGIN_PRIORITY(){return lCe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,kw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:qa,position:"before",group:Z1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Z1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),we(e,iCe(e)),this.enabled!==!1&&q(e,rCe(...r))}onAfterOnCellMouseDown(e,n){a_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,kw))):this.sort(this.getColumnNextConfig(n.col)))}}function Q1(t,e,n){return(e=cCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cCe(t){var e=hCe(t,"string");return typeof e=="symbol"?e:e+""}function hCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dCe="multipleSelectionHandles",fCe=160;class gCe extends qe{constructor(){super(...arguments),Q1(this,"dragged",[]),Q1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return dCe}static get PLUGIN_PRIORITY(){return fCe}isEnabled(){return Bo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ve(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ve(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function s0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function uV(){return{label:"",isPlaceholder:!0}}function mCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;M(t,i=>{const o=[];let s=0;n.push(o),M(i,a=>{const l=s0();if(De(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Rt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Rt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(uV());return!u})});const r=Math.max(...Ue(n,i=>i.length));return M(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>s0());i.splice(i.length,0,...o)}}),n}function sS(t,e,n){pCe(t,e),e.set(t,n)}function pCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Li(t,e){return t.get(cV(t,e))}function Ed(t,e,n){return t.set(cV(t,e),n),n}function cV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eA=["label","collapsible"];var ps=new WeakMap,kl=new WeakMap,aS=new WeakMap;class wCe{constructor(){sS(this,ps,[]),sS(this,kl,0),sS(this,aS,1/0)}setColumnsLimit(e){Ed(aS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Ed(ps,this,mCe(e,Li(aS,this))),Ed(kl,this,Li(ps,this).length)}getData(){return Li(ps,this)}mergeWith(e){M(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&un(s,o,eA)})}map(e){M(Li(ps,this),n=>{M(n,r=>{const i=e({...r});De(i)&&un(r,i,eA)})})}getHeaderSettings(e,n){var r;if(e>=Li(kl,this)||e<0)return null;const i=Li(ps,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Li(kl,this)||e<0)return i;const o=Li(ps,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Li(kl,this)}getColumnsCount(){return Li(kl,this)>0?Li(ps,this)[0].length:0}clear(){Ed(ps,this,[]),Ed(kl,this,0)}}function lS(t,e,n){return(e=vCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vCe(t){var e=yCe(t,"string");return typeof e=="symbol"?e:e+""}function yCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hV="DF-pre-order";function dV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=dV.call(this.childs[r],t,e)}return n}const CCe="DF-post-order";function fV(t,e){for(let n=0;n<this.childs.length;n++)if(fV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const gV="BF";function bCe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const SCe=gV,tA=new Map([[hV,dV],[CCe,fV],[gV,bCe]]);class nv{constructor(e){lS(this,"data",{}),lS(this,"parent",null),lS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new nv({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:SCe;if(!tA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);tA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function uS(t,e,n){RCe(t,e),e.set(t,n)}function RCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(t,e){return t.get(mV(t,e))}function ECe(t,e,n){return t.set(mV(t,e),n),n}function mV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hc=new WeakMap,$l=new WeakMap,dc=new WeakMap;class TCe{constructor(e){uS(this,hc,new Map),uS(this,$l,new Map),uS(this,dc,null),ECe(dc,this,e)}getRoots(){return Array.from(ir(hc,this).values())}getRootByColumn(e){let n;return ir($l,this).has(e)&&(n=ir(hc,this).get(ir($l,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-ir($l,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;ir($l,this).clear(),M(ir(hc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)ir($l,this).set(i,e);e+=r})}buildTree(){this.clear();const e=ir(dc,this).getColumnsCount();let n=0;for(;n<e;){const r=ir(dc,this).getHeaderSettings(0,n),i=new nv;ir(hc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=ir(dc,this).getHeadersSettings(r,n,i);r+=1,M(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new nv(a),e.addChild(l)),r<ir(dc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){ir(hc,this).clear(),ir($l,this).clear()}}function pV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function rv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function iv(t){return rv(t,"origColspan")===t.data.origColspan}function S_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(iv(t))return S_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)M(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,pV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):iv(a)&&(l.isCollapsed=rv(a,"isCollapsed"))}),{rollbackModification:()=>R_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function R_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(iv(t))return R_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)M(o,l=>{pV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=rv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):iv(l)&&(u.isCollapsed=rv(l,"isCollapsed"))}),{rollbackModification:()=>S_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function MCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function _Ce(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const nA=new Map([["collapse",R_],["expand",S_],["hide-column",MCe],["show-column",_Ce]]);function PCe(t,e,n){if(!nA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return nA.get(t)(e,n)}function up(t){const e=[];return M(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=ICe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(uV());else{const f=xCe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function xCe(t){const{crossHiddenColumns:e,...n}=s0(t);return n}function ICe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function cS(t,e,n){OCe(t,e),e.set(t,n)}function OCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Td(t,e,n){return t.set(wV(t,e),n),n}function Vt(t,e){return t.get(wV(t,e))}function wV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mo=new WeakMap,br=new WeakMap,Ll=new WeakMap;class ACe{constructor(){cS(this,Mo,new wCe),cS(this,br,new TCe(Vt(Mo,this))),cS(this,Ll,[[]])}setState(e){Vt(Mo,this).setData(e);let n=!1;try{Vt(br,this).buildTree()}catch{Vt(br,this).clear(),Vt(Mo,this).clear(),n=!0}return Td(Ll,this,up(Vt(br,this).getRoots())),n}setColumnsLimit(e){Vt(Mo,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Vt(Mo,this).mergeWith(n),Vt(br,this).buildTree(),Td(Ll,this,up(Vt(br,this).getRoots()))}mapState(e){Vt(Mo,this).map(e),Vt(br,this).buildTree(),Td(Ll,this,up(Vt(br,this).getRoots()))}mapNodes(e){return bn(Vt(br,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Vt(br,this).getNode(n,r);let o;return i&&(o=PCe(e,i,r),Td(Ll,this,up(Vt(br,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Vt(Ll,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Vt(br,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Vt(br,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},hV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Vt(Mo,this).getLayersCount()}getColumnsCount(){return Vt(Mo,this).getColumnsCount()}clear(){Td(Ll,this,[]),Vt(Mo,this).clear(),Vt(br,this).clear()}}function Md(t,e,n){return(e=HCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HCe(t){var e=NCe(t,"string");return typeof e=="symbol"?e:e+""}function NCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DCe{constructor(e,n){Md(this,"hot",void 0),Md(this,"nestedHeaderSettingsGetter",void 0),Md(this,"layersCount",0),Md(this,"container",void 0),Md(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),_u(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function kCe(t,e){vV(t,e),e.add(t)}function rA(t,e,n){return(e=$Ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Ce(t){var e=LCe(t,"string");return typeof e=="symbol"?e:e+""}function LCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _d(t,e,n){vV(t,e),e.set(t,n)}function vV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ks(t,e,n){return t.set(Wt(t,e),n),n}function je(t,e){return t.get(Wt(t,e))}function Wt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iA="nestedHeaders",FCe=280;var ft=new WeakMap,da=new WeakMap,df=new WeakMap,py=new WeakMap,ov=new WeakMap,Kt=new WeakSet;class VCe extends qe{constructor(){super(...arguments),kCe(this,Kt),_d(this,ft,new ACe),_d(this,da,null),_d(this,df,null),_d(this,py,!1),_d(this,ov,null),rA(this,"ghostTable",new DCe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),rA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return iA}static get PLUGIN_PRIORITY(){return FCe}isEnabled(){return!!this.hot.getSettings()[iA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&tt(ct`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Wt(Kt,this,nbe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,rbe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,UCe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,zCe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,YCe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,GCe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,KCe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,qCe).call(e,...i)}),this.addHook("afterSelection",()=>Wt(Kt,this,cp).call(this)),this.addHook("afterSelectionFocusSet",()=>Wt(Kt,this,cp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,WCe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Wt(Kt,this,JCe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,QCe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,ebe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,BCe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,jCe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,XCe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,ZCe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wt(Kt,e,tbe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Wt(Kt,this,cp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Wt(Kt,this,cp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();je(ft,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=je(ft,this).setState(e)),this.detectedOverlappedHeaders&&tt(ct`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";je(ft,this).triggerColumnModification(i,r)}),!je(da,this)&&this.enabled&&ks(da,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";je(ft,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),je(ft,this).clear(),je(da,this).unsubscribe(),ks(da,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return je(ft,this)}getLayersCount(){return je(ft,this).getLayersCount()}getHeaderSettings(e,n){return je(ft,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),we(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),we(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),we(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),we(o,"hiddenHeader"),we(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=je(ft,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,v,y;const{wtOverlays:E}=l._wt,C=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),P=(v=E.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((y=E.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const _=C||P?Math.min(c,r-i):c;_>1&&o.setAttribute("colspan",_)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(we(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=je(ft,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){ks(ft,this,null),je(da,this)!==null&&(je(da,this).unsubscribe(),ks(da,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return je(ft,this).getHeaderTreeNodeData(e.row,e.col)}}function cp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=je(ft,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function WCe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=je(ov,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(ks(ov,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=je(ft,this).findLeftMostColumnIndex(a,l),g=je(ft,this).findRightMostColumnIndex(a,l),v=g-f+1;if(f<c&&g>h)return f;if(s){let y=null;return f>=c&&g>h?v>d?(e.value="start",y=f):(e.value="end",y=g):f<c&&g<=h&&(v>d?(e.value="end",y=g):(e.value="start",y=f)),y}return f<=c?f:g}function BCe(t,e,n){const r=je(ft,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=je(ft,this).getHeaderSettings(e,t);if(o===qE){if(!a)return r.columnIndex}else if(o===v$&&(l>s-i||!a))return null;return t}function jCe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,v=d-a;if(v===0)continue;((i=je(ft,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][v]="")}}}function UCe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function zCe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;ks(df,this,e.clone()),ks(py,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Fv(t)||ja(t)&&l||zk(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function YCe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ye(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function GCe(){ks(py,this,!1)}function KCe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!je(py,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=je(ft,this).getHeaderTreeNodeData(je(df,this).row,je(df,this).col);if(e.setHighlight(je(df,this)),o>e.getWidth()||i<n||i+o-1>r){const s=je(ft,this).findTopMostEntireHeaderLevel(Ye(n,i,i+o-1),Ye(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function qCe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=je(ft,this).findLeftMostColumnIndex(n.row,n.col),o=je(ft,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function XCe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});ks(ov,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function JCe(t){if(je(ft,this).getLayersCount()>0){t.length=0;for(let e=0;e<je(ft,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function ZCe(t){const e=je(ft,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=je(ft,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Gn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?je(ft,this).getHeaderTreeNodeData(0,n).columnIndex:n}function QCe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function ebe(t,e,n){var r;const{label:i}=(r=je(ft,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function tbe(t,e){if(t<0)return this.hot.getCell(t,je(ft,this).findLeftMostColumnIndex(t,e),!0)}function nbe(){this.updatePlugin()}function rbe(t,e){e||this.updatePlugin()}function Pd(t,e,n){return(e=ibe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ibe(t){var e=obe(t,"string");return typeof e=="symbol"?e:e+""}function obe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sbe{constructor(e,n){Pd(this,"hot",void 0),Pd(this,"data",null),Pd(this,"plugin",void 0),Pd(this,"parentReference",new WeakMap),Pd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&M(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&M(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ke(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(M(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];M(r,o=>{i.push(this.getDataObject(o))}),M(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function oA(t,e,n){return(e=abe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function abe(t){var e=lbe(t,"string");return typeof e=="symbol"?e:e+""}function lbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E_{constructor(e,n){oA(this,"hot",void 0),oA(this,"plugin",void 0),this.hot=n,this.plugin=e}}class ko extends E_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(M(l,c=>{c&&s.removeChild(c)}),q(n,ko.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");q(d,ko.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&be(c,[Tu()]),q(n,ko.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${ko.CSS_CLASSES.button} ${ko.CSS_CLASSES.expandButton}`),u&&be(n,[Ci(!1)])):(q(c,`${ko.CSS_CLASSES.button} ${ko.CSS_CLASSES.collapseButton}`),u&&be(n,[Ci(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class ube extends E_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),M(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&M(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];M(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return M(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);M(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return M(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);M(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&M(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];M(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];M(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];M(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&M(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ve(e.target,ko.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),xi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function cbe(t,e,n){hbe(t,e),e.set(t,n)}function hbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dbe(t,e,n){return(e=fbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fbe(t){var e=gbe(t,"string");return typeof e=="symbol"?e:e+""}function gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mbe(t,e){return t.get(pbe(t,e))}function pbe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sA=new WeakMap;class wbe extends E_{constructor(){super(...arguments),dbe(this,"dataManager",this.plugin.dataManager),cbe(this,sA,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(JT)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(ZT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return M(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=mbe(sA,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function hp(t,e,n){return(e=vbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vbe(t){var e=ybe(t,"string");return typeof e=="symbol"?e:e+""}function ybe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cbe{constructor(e){hp(this,"plugin",void 0),hp(this,"hot",void 0),hp(this,"dataManager",void 0),hp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Ht(i)&&(tt(ct`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function bbe(t,e){yV(t,e),e.add(t)}function aA(t,e,n){yV(t,e),e.set(t,n)}function yV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hS(t,e,n){return(e=Sbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sbe(t){var e=Rbe(t,"string");return typeof e=="symbol"?e:e+""}function Rbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kp(t,e){return t.get(En(t,e))}function sv(t,e,n){return t.set(En(t,e),n),n}function En(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const av="nestedRows",Ebe=300,lA=av,Tbe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var wy=new WeakMap,fc=new WeakMap,In=new WeakSet;class Mbe extends qe{constructor(){super(...arguments),bbe(this,In),hS(this,"dataManager",null),hS(this,"headersUI",null),hS(this,"collapsedRowsMap",null),aA(this,wy,!1),aA(this,fc,!1)}static get PLUGIN_KEY(){return av}static get PLUGIN_PRIORITY(){return Ebe}isEnabled(){return!!this.hot.getSettings()[av]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new wg),this.dataManager=new sbe(this,this.hot),this.collapsingUI=new ube(this,this.hot),this.headersUI=new ko(this,this.hot),this.contextMenuUI=new wbe(this,this.hot),this.rowMoveController=new Cbe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Vbe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Wbe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,xbe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Ibe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Obe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Pbe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Nbe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Hbe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Dbe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,kbe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,$be).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Lbe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Abe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,Fbe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return En(In,e,_be).call(e,...r)}),this.addHook("beforeLoadData",n=>En(In,this,uA).call(this,n)),this.addHook("beforeUpdateData",n=>En(In,this,uA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:lA,relativeToGroup:qa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lA)}disableCoreAPIModifiers(){sv(fc,this,!0)}enableCoreAPIModifiers(){sv(fc,this,!1)}onModifyRowData(e){if(!Kp(fc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Kp(fc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Kp(fc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function _be(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Pbe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function xbe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),sv(wy,this,!0),this.dataManager.getData().slice()}function Ibe(t){return this.contextMenuUI.appendOptions(t)}function Obe(t,e){this.headersUI.appendLevelIndicators(t,e)}function Abe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Hbe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{sv(wy,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Nbe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Dbe(){this.collapsingUI.collapsedRowsStash.stash()}function kbe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function $be(){this.collapsingUI.collapsedRowsStash.stash()}function Lbe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Fbe(){this.dataManager.rewriteCache()}function Vbe(){this.headersUI.updateRowHeaderWidth()}function Wbe(t,e){Kp(wy,this)&&(e.skipRender=!0)}function uA(t){if(!x$(t)){DE(Tbe),this.hot.getSettings()[av]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function dS(t,e,n){return(e=Bbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bbe(t){var e=jbe(t,"string");return typeof e=="symbol"?e:e+""}function jbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ube{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;dS(this,"rootWindow",void 0),dS(this,"prefix",void 0),dS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){M(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function zbe(t,e,n){return(e=Ybe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ybe(t){var e=Gbe(t,"string");return typeof e=="symbol"?e:e+""}function Gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}oe.getSingleton().register("persistentStateSave");oe.getSingleton().register("persistentStateLoad");oe.getSingleton().register("persistentStateReset");const cA="persistentState",Kbe=0;class qbe extends qe{constructor(){super(...arguments),zbe(this,"storage",void 0)}static get PLUGIN_KEY(){return cA}static get PLUGIN_PRIORITY(){return Kbe}isEnabled(){return!!this.hot.getSettings()[cA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Ube(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Xbe(t,e){Jbe(t,e),e.add(t)}function Jbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fS(t,e,n){return(e=Zbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zbe(t){var e=Qbe(t,"string");return typeof e=="symbol"?e:e+""}function Qbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gS="search",eSe=190,tSe="htSearchResult",nSe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},rSe=function(t,e,n){return Ht(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ht(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var mS=new WeakSet;class iSe extends qe{constructor(){super(...arguments),Xbe(this,mS),fS(this,"callback",nSe),fS(this,"queryMethod",rSe),fS(this,"searchResultClass",tSe)}static get PLUGIN_KEY(){return gS}static get PLUGIN_PRIORITY(){return eSe}isEnabled(){return this.hot.getSettings()[gS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[gS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hA(mS,e,dA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hA(mS,e,dA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){De(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function dA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function dp(t,e,n){return(e=oSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oSe(t){var e=sSe(t,"string");return typeof e=="symbol"?e:e+""}function sSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CV{constructor(e){dp(this,"viewportWidth",void 0),dp(this,"overwriteColumnWidthFn",void 0),dp(this,"baseWidths",new Map),dp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class aSe extends CV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=Jc?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=Jc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,v=g;o.includes(f)||(v=Math.round(g*l)),this.stretchedWidths.set(f,v),u=f,d<i.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function fA(t,e,n){lSe(t,e),e.set(t,n)}function lSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pS(t,e){return t.get(bV(t,e))}function fp(t,e,n){return t.set(bV(t,e),n),n}function bV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gp=new WeakMap,xd=new WeakMap;class uSe extends CV{constructor(){super(...arguments),fA(this,gp,0),fA(this,xd,-1)}prepare(e){super.prepare(e),fp(gp,this,0),fp(xd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),fp(xd,this,e),fp(gp,this,n)}calculate(){if(pS(xd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+pS(gp,this),0);this.stretchedWidths.set(pS(xd,this),n)}}function cSe(t,e){SV(t,e),e.add(t)}function mp(t,e,n){SV(t,e),e.set(t,n)}function SV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e){return t.get(Ac(t,e))}function wS(t,e,n){return t.set(Ac(t,e),n),n}function Ac(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hSe="stretchColumns";var Yn=new WeakMap,gc=new WeakMap,vS=new WeakMap,pp=new WeakMap,Id=new WeakSet;class dSe{constructor(e){cSe(this,Id),mp(this,Yn,void 0),mp(this,gc,void 0),mp(this,vS,new Map([["all",new aSe(Ac(Id,this,gA).bind(this))],["last",new uSe(Ac(Id,this,gA).bind(this))]])),mp(this,pp,"none"),wS(Yn,this,e),wS(gc,this,qt(Yn,this).columnIndexMapper.createAndRegisterIndexMap(hSe,"physicalIndexToValue"))}useStrategy(e){wS(pp,this,qt(vS,this).has(e)?e:"none")}refreshStretching(){if(qt(pp,this)==="none"){qt(gc,this).clear();return}qt(Yn,this).batchExecution(()=>{qt(gc,this).clear();const e=qt(vS,this).get(qt(pp,this));let r=qt(Yn,this).view.getViewportWidth();Ac(Id,this,fSe).call(this)&&(r-=Mn(qt(Yn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<qt(Yn,this).countCols();i++)qt(Yn,this).columnIndexMapper.isHidden(qt(Yn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Ac(Id,this,gSe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;qt(gc,this).setValueAtIndex(qt(Yn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return qt(gc,this).getValueAtIndex(qt(Yn,this).toPhysicalColumn(e))}}function fSe(){const{view:t}=qt(Yn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=qt(Yn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=qt(Yn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function gSe(t){var e;return(e=qt(Yn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Jc}function gA(t,e){return qt(Yn,this).runHooks("beforeStretchingColumnWidth",t,e)}function mSe(t,e){RV(t,e),e.add(t)}function yS(t,e,n){RV(t,e),e.set(t,n)}function RV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CS(t,e,n){return t.set(lv(t,e),n),n}function Ss(t,e){return t.get(lv(t,e))}function lv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pSe="stretchColumns",wSe=155;var Tc=new WeakMap,wp=new WeakMap,Od=new WeakMap,bS=new WeakSet;class vSe extends qe{constructor(){super(...arguments),mSe(this,bS),yS(this,Tc,new dSe(this.hot)),yS(this,wp,null),yS(this,Od,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Ss(wp,this)!==null&&Ss(wp,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),CS(wp,this,i.width)})})}))}static get PLUGIN_KEY(){return pSe}static get PLUGIN_PRIORITY(){return wSe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Ss(Tc,this).useStrategy(this.hot.getSettings().stretchH),Ss(Od,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return lv(bS,e,CSe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return lv(bS,e,ySe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Ss(Tc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Ss(Od,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Ss(Tc,this).getStretchedWidth(e)}destroy(){Ss(Od,this).disconnect(),CS(Od,this,null),CS(Tc,this,null),super.destroy()}}function ySe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function CSe(t){t&&Ss(Tc,this).refreshStretching()}function bSe(t,e){SSe(t,e),e.add(t)}function SSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vp(t,e,n){return(e=RSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RSe(t){var e=ESe(t,"string");return typeof e=="symbol"?e:e+""}function ESe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TSe="touchScroll",MSe=200;var yp=new WeakSet;class _Se extends qe{constructor(){super(...arguments),bSe(this,yp),vp(this,"scrollbars",[]),vp(this,"clones",[]),vp(this,"lockedCollection",!1),vp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return TSe}static get PLUGIN_PRIORITY(){return MSe}static get SETTING_KEYS(){return!0}isEnabled(){return IE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>SS(yp,this,PSe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>SS(yp,this,xSe).call(this)),this.addHook("afterMomentumScroll",()=>SS(yp,this,ISe).call(this))}}function PSe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function xSe(){this.freezeOverlays=!0,M(this.clones,t=>{q(t,"hide-tween")})}function ISe(){this.freezeOverlays=!1,M(this.clones,t=>{we(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{M(this.clones,t=>{we(t,"show-tween")})},400),M(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function OSe(t,e){ASe(t,e),e.add(t)}function ASe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HSe(t,e,n){return(e=NSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NSe(t){var e=DSe(t,"string");return typeof e=="symbol"?e:e+""}function DSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kSe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qp="trimRows",$Se=330;var mA=new WeakSet;class LSe extends qe{constructor(){super(...arguments),OSe(this,mA),HSe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return qp}static get PLUGIN_PRIORITY(){return $Se}isEnabled(){return!!this.hot.getSettings()[qp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new wg),this.trimmedRowsMap.addLocalHook("init",()=>kSe(mA,this,FSe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[qp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),M(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(M(e,l=>{o[l]=!1}),i=bn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function FSe(){const t=this.hot.getSettings()[qp];Array.isArray(t)&&this.hot.batchExecution(()=>{M(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function VSe(t,e,n){return(e=WSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WSe(t){var e=BSe(t,"string");return typeof e=="symbol"?e:e+""}function BSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ii{constructor(e){VSe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Cp(t,e,n){return(e=jSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jSe(t){var e=USe(t,"string");return typeof e=="symbol"?e:e+""}function USe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T_ extends Ii{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Cp(this,"stateBefore",void 0),Cp(this,"range",void 0),Cp(this,"type",void 0),Cp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new T_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){M(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){ma(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function pA(t,e,n){return(e=zSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zSe(t){var e=YSe(t,"string");return typeof e=="symbol"?e:e+""}function YSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M_ extends Ii{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),pA(this,"columns",void 0),pA(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new M_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),C_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function wA(t,e,n){return(e=GSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GSe(t){var e=KSe(t,"string");return typeof e=="symbol"?e:e+""}function KSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class __ extends Ii{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),wA(this,"previousSortState",void 0),wA(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new __({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function vA(t,e,n){return(e=qSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qSe(t){var e=XSe(t,"string");return typeof e=="symbol"?e:e+""}function XSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P_ extends Ii{constructor(e){let{index:n,amount:r}=e;super("insert_col"),vA(this,"index",void 0),vA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new P_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function yA(t,e,n){return(e=JSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JSe(t){var e=ZSe(t,"string");return typeof e=="symbol"?e:e+""}function ZSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x_ extends Ii{constructor(e){let{index:n,amount:r}=e;super("insert_row"),yA(this,"index",void 0),yA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new x_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function bp(t,e,n){return(e=QSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QSe(t){var e=eRe(t,"string");return typeof e=="symbol"?e:e+""}function eRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I_ extends Ii{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),bp(this,"changes",void 0),bp(this,"selected",void 0),bp(this,"countCols",void 0),bp(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new I_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Qn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Qn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function CA(t,e,n){return(e=tRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tRe(t){var e=nRe(t,"string");return typeof e=="symbol"?e:e+""}function nRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O_ extends Ii{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),CA(this,"conditionsStack",void 0),CA(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new O_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function rRe(t,e,n){return(e=iRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iRe(t){var e=oRe(t,"string");return typeof e=="symbol"?e:e+""}function oRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A_ extends Ii{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),rRe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new A_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function EV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function ws(t,e,n){return(e=sRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sRe(t){var e=aRe(t,"string");return typeof e=="symbol"?e:e+""}function aRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H_ extends Ii{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),ws(this,"index",void 0),ws(this,"indexes",void 0),ws(this,"data",void 0),ws(this,"amount",void 0),ws(this,"headers",void 0),ws(this,"columnPositions",void 0),ws(this,"rowPositions",void 0),ws(this,"fixedColumnsStart",void 0),ws(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const v=[],y=l[g];fe(u,c,E=>{v.push(y[e.toPhysicalColumn(E)])}),h.push(v)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new H_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:EV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ue(this.data[c],o));const l=Ue(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),M(e.getSourceDataArray(),(c,h)=>{M(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&M(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function mc(t,e,n){return(e=lRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lRe(t){var e=uRe(t,"string");return typeof e=="symbol"?e:e+""}function uRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N_ extends Ii{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),mc(this,"index",void 0),mc(this,"data",void 0),mc(this,"fixedRowsBottom",void 0),mc(this,"fixedRowsTop",void 0),mc(this,"rowIndexesSequence",void 0),mc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Qn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new N_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:EV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function bA(t,e,n){return(e=cRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cRe(t){var e=hRe(t,"string");return typeof e=="symbol"?e:e+""}function hRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D_ extends Ii{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),bA(this,"rows",void 0),bA(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new D_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),C_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function dRe(t,e,n){return(e=fRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fRe(t){var e=gRe(t,"string");return typeof e=="symbol"?e:e+""}function gRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k_ extends Ii{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),dRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new k_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function mRe(t,e){[T_,M_,__,P_,x_,I_,O_,A_,H_,N_,D_,k_].forEach(n=>n.startRegisteringEvents(t,e))}function pRe(t,e){wRe(t,e),e.add(t)}function wRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RS(t,e,n){return(e=vRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vRe(t){var e=yRe(t,"string");return typeof e=="symbol"?e:e+""}function yRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ES(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SA="undoRedo",CRe="undoRedo",bRe=1e3;oe.getSingleton().register("beforeUndo");oe.getSingleton().register("afterUndo");oe.getSingleton().register("beforeRedo");oe.getSingleton().register("afterRedo");const RA=new Set;var Sp=new WeakSet;class SRe extends qe{static get PLUGIN_KEY(){return CRe}static get PLUGIN_PRIORITY(){return bRe}static get SETTING_KEYS(){return!0}constructor(e){super(e),pRe(this,Sp),RS(this,"doneActions",[]),RS(this,"undoneActions",[]),RS(this,"ignoreNewActions",!1),mRe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ES(Sp,e,RRe).call(e,...r)}),this.registerShortcuts(),ES(Sp,this,ERe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),ES(Sp,this,TRe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:SA};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SA)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function RRe(t,e){e==="loadData"&&this.clear()}function ERe(){const t=e=>{RA.has(e)||(tt(ct`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),RA.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function TRe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function MRe(){Ke(Xd),Ke(Aue),Ke(Jd),Ke(uce),Ke(wce),Ke(YL),Ke(dhe),Ke(Xhe),Ke(cy),Ke(ofe),Ke(Ofe),Ke(Ffe),Ke(fy),Ke(bge),Ke(ppe),Ke(qpe),Ke(Swe),Ke(Nwe),Ke(Ywe),Ke(rve),Ke(fve),Ke(Ove),Ke(Vve),Ke(Oye),Ke(uCe),Ke(gCe),Ke(VCe),Ke(Mbe),Ke(qbe),Ke(iSe),Ke(vSe),Ke(_Se),Ke(LSe),Ke(SRe)}function _Re(){nae(),Tle(),Nle(),eue(),MRe()}function PRe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var TS,MS,_S,PS,xS;_Re();PRe(Te);Te.__GhostTable=i_;Te._getListenersCounter=rZ;Te._getRegisteredMapsCounter=Rre;Te.EventManager=Ri;const xRe=[o8,fJ,nre,_le,cJ,G8,u8,tQ,uJ,h8,pJ,eQ],IRe=[j8,wJ];Te.helper={};Te.dom={};M(xRe,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.helper[e]=t[e])})});M(IRe,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.dom[e]=t[e])})});Te.cellTypes=(TS=Te.cellTypes)!==null&&TS!==void 0?TS:{};M(Pie(),t=>{Te.cellTypes[t]=$M(t)});Te.cellTypes.registerCellType=ci;Te.cellTypes.getCellType=$M;Te.editors=(MS=Te.editors)!==null&&MS!==void 0?MS:{};M(JJ(),t=>{Te.editors[`${Zn(t)}Editor`]=Ew(t)});Te.editors.registerEditor=Mr;Te.editors.getEditor=Ew;Te.renderers=(_S=Te.renderers)!==null&&_S!==void 0?_S:{};M(pQ(),t=>{const e=Tw(t);t==="base"&&(Te.renderers.cellDecorator=e),Te.renderers[`${Zn(t)}Renderer`]=e});Te.renderers.registerRenderer=jr;Te.renderers.getRenderer=Tw;Te.validators=(PS=Te.validators)!==null&&PS!==void 0?PS:{};M(yQ(),t=>{Te.validators[`${Zn(t)}Validator`]=BE(t)});Te.validators.registerValidator=zl;Te.validators.getValidator=BE;Te.plugins=(xS=Te.plugins)!==null&&xS!==void 0?xS:{};M(WE(),t=>{Te.plugins[t]=fg(t)});Te.plugins[`${Zn(qe.PLUGIN_KEY)}Plugin`]=qe;Te.plugins.registerPlugin=Ke;Te.plugins.getPlugin=fg;let ff=null,On=new Map,pc={row:-1,col:-1,time:0};function vs(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return t===void 0?(o="undefined",s.readOnly=!1):typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function Vr(t,e,n){let r=[],i=!0,o=new Map;const s={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback},a=n.dataPathString||"";if(Array.isArray(t)){const l=t.length>0?t[0]:null;if(l&&typeof l=="object"&&l!==null&&!Array.isArray(l)){let u=Object.keys(l);if(u.length===0){for(let c=1;c<t.length;c++)if(t[c]&&typeof t[c]=="object"&&Object.keys(t[c]).length>0){u=Object.keys(t[c]);break}}i=u.length>0?u:t.length>0?["(내용 없음)"]:["새 열"],t.forEach((c,h)=>{const d=[],f=typeof c=="object"&&c!==null?c:{};i.forEach((g,v)=>{const y=f[g],E=`${a}[${h}]`,{displayValue:C,cellMeta:P}=vs(y,E,g,!1,s);d.push(C),o.set(`${h}-${v}`,P)}),r.push(d)}),t.length===0&&(Array.isArray(n.rootJsonData)&&n.rootJsonData.length>0&&typeof n.rootJsonData[0]=="object"&&n.rootJsonData[0]!==null&&Object.keys(n.rootJsonData[0]).length>0||(i===!0||Array.isArray(i)&&i.length===0)&&(i=["데이터 없음"]))}else i=["Index","Value"],r=t.map((u,c)=>{const{displayValue:h,cellMeta:d}=vs(c,a,String(c),!0,s),{displayValue:f,cellMeta:g}=vs(u,a,String(c),!1,s);return o.set(`${c}-0`,d),o.set(`${c}-1`,g),[h,f]})}else if(typeof t=="object"&&t!==null){const l=Object.keys(t);if(l.length>0&&l.every(c=>Array.isArray(t[c]))){let c=0;l.forEach(d=>{c=Math.max(c,t[d].length)});const h=["항목 (Key)"];for(let d=0;d<c;d++)h.push(String(d));i=h,r=l.map((d,f)=>{const g=t[d],v=[],{displayValue:y,cellMeta:E}=vs(d,a,d,!0,s);v.push(y),o.set(`${f}-0`,E);for(let C=0;C<c;C++)if(C<g.length){const P=g[C],A=`${a?a+".":""}${d}`,{displayValue:_,cellMeta:T}=vs(P,A,String(C),!1,s);v.push(_),o.set(`${f}-${1+C}`,T)}else v.push(""),o.set(`${f}-${1+C}`,{readOnly:!0,originalValue:null,isPadding:!0});return v})}else i=["항목 (Key)","값 (Value)"],r=l.map((c,h)=>{const d=t[c],{displayValue:f,cellMeta:g}=vs(c,a,c,!0,s),{displayValue:v,cellMeta:y}=vs(d,a,c,!1,s);return o.set(`${h}-0`,g),o.set(`${h}-1`,y),[f,v]})}else{i=["항목","값"];const l=e||(t==null?String(t):"Value"),{displayValue:u,cellMeta:c}=vs(l,a,"",!0,s),{displayValue:h,cellMeta:d}=vs(t,a,"",!1,s);o.set("0-0",c),o.set("0-1",d),r=[[u,h]]}return{preparedHotData:r,preparedColHeaders:i,preparedCellMetaMap:o}}function TV(){return ff&&(ff.destroy(),ff=null),null}function ORe(t,e,n){const r=n.tableViewDomElement;TV(),r&&(r.innerHTML="");const{preparedHotData:i,preparedColHeaders:o,preparedCellMetaMap:s}=Vr(t,e,n);return On=s,pc={row:-1,col:-1,time:0},r?(ff=new Te(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입"},col_right:{name:"오른쪽에 열 삽입"},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제"},"---------":Te.plugins.ContextMenu.SEPARATOR,duplicate_row:{name:"선택 행 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)||typeof t=="object"&&t!==null&&!Array.isArray(t)):!0},callback:async function(a,l){const u=this,c=l[0].start.row;if(Array.isArray(t)){if(c>=0&&c<t.length){const h=JSON.parse(JSON.stringify(t[c]));t.splice(c+1,0,h),n.refreshTreeViewCallback("row_duplicated_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=Vr(t,e,n);On=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}else if(typeof t=="object"&&t!==null){const h=Object.keys(t);if(c<0||c>=h.length)return;const d=h[c];let f=d+"_복제본",g=f,v=1;for(;t.hasOwnProperty(g);)g=`${f}_${v++}`;wc({title:"새 키 입력 (행 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:y=>{const E=y.trim();return E?E!==d&&t.hasOwnProperty(E)?"이미 사용 중인 키입니다.":/^\d+$/.test(E)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(y=>{if(y.isConfirmed&&y.value!==void 0){const E=y.value.trim(),C=JSON.parse(JSON.stringify(t[d])),P={};for(const H of Object.keys(t))P[H]=t[H],H===d&&(P[E]=C);Object.keys(t).forEach(H=>delete t[H]),Object.assign(t,P),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered");const{preparedHotData:A,preparedColHeaders:_,preparedCellMetaMap:T}=Vr(t,e,n);On=T,u.updateSettings({colHeaders:_}),u.loadData(A)}})}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])):!0},callback:async function(a,l){const u=this,c=l[0].start.col,h=u.getColHeader();if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])&&Array.isArray(h)&&c>=0&&c<h.length){const d=h[c];if(typeof d!="string")return;let f=d+"_복제본",g=f,v=1;for(;t[0].hasOwnProperty(g);)g=`${f}_${v++}`;wc({title:"새 열 키 입력 (열 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:y=>{const E=y.trim();return E?t.length>0&&t[0].hasOwnProperty(E)&&E!==d?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(E)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(y=>{if(y.isConfirmed&&y.value!==void 0){const E=y.value.trim();t.forEach(_=>{if(typeof _=="object"&&_!==null){const T=_.hasOwnProperty(d)?JSON.parse(JSON.stringify(_[d])):null,H=Object.keys(_);for(let G=0;G<H.length;G++){const U=H[G];_[U]}_[E]=T}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered");const{preparedHotData:C,preparedColHeaders:P,preparedCellMetaMap:A}=Vr(t,e,n);On=A,u.updateSettings({colHeaders:P}),u.loadData(C)}})}}},make_array:{name:"값을 빈 배열 [] 로 변경",hidden:function(){const a=this.getSelectedRangeLast();if(!a)return!0;const{from:l}=a;return!(typeof t=="object"&&t!==null&&!Array.isArray(t)&&l.col===1)},callback:function(a,l){const u=this,c=l[0].start.row,h=On.get(`${c}-0`);if(h&&h.originalKey&&typeof t=="object"&&t!==null){t[h.originalKey]=[],n.refreshTreeViewCallback("value_to_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=Vr(t,e,n);On=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}},make_object:{name:"값을 빈 객체 {} 로 변경",hidden:function(){const a=this.getSelectedRangeLast();if(!a)return!0;const{from:l}=a;return!(typeof t=="object"&&t!==null&&!Array.isArray(t)&&l.col===1)},callback:function(a,l){const u=this,c=l[0].start.row,h=On.get(`${c}-0`);if(h&&h.originalKey&&typeof t=="object"&&t!==null){t[h.originalKey]={},n.refreshTreeViewCallback("value_to_object_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=Vr(t,e,n);On=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(a,l,u){const c={},h=On.get(`${a}-${l}`);return h&&(c.readOnly=h.readOnly,h.isDrillable&&(c.renderer=function(d,f,g,v,y,E){Te.renderers.TextRenderer.apply(this,arguments),f.style.color="#007bff",f.style.textDecoration="underline",f.style.cursor="pointer"})),c},afterOnCellMouseDown:function(a,l,u){if(a.button!==0)return;const c=new Date().getTime(),{row:h,col:d}=l,f=On.get(`${h}-${d}`),g=300;let v=!1;if(f&&h===pc.row&&d===pc.col&&c-pc.time<g?(v=!0,pc={row:-1,col:-1,time:0}):pc={row:h,col:d,time:c},v){let y=!1;const E=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(E)&&E.length>0&&E[0]==="항목 (Key)"&&d===0&&f&&(y=!0),y){const C=f.originalKey,P=t,A=n.dataPathString;wc({title:`키 이름 변경: "${C}"`,inputValue:C,customClass:{popup:"custom-swal-popup"},confirmButtonText:"저장",inputValidator:_=>{const T=_.trim();return T?/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다!":P.hasOwnProperty(T)&&T!==C?"이미 사용 중인 키입니다!":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:this}).then(_=>{if(_.isConfirmed&&_.value!==void 0){const T=_.value.trim();T!==C&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(A,C,T,P)}});return}}if(f&&f.isDrillable&&f.originalValue!==void 0){const y=typeof t=="object"&&t!==null&&!Array.isArray(t)&&d===0&&f&&f.isDrillable;(!v||v&&!y&&f.drillPath)&&typeof f.originalValue=="object"&&f.originalValue!==null&&n.displayTableCallback(f.originalValue,f.originalKey,n.rootJsonData,f.drillPath)}},afterChange:function(a,l){if(l==="loadData"||!a||!Array.isArray(a)||a.length===0)return;const u=l==="CopyPaste.paste"||l==="Autofill.fill"||a.length>1,c=this.getColHeader();a.forEach(([h,d,f,g])=>{let v=-1;if(typeof d=="number"?v=d:typeof d=="string"&&Array.isArray(c)&&(v=c.indexOf(d)),v===-1)if(typeof d=="number"&&c===!0)v=d;else{console.warn("변경을 위한 컬럼 인덱스를 결정할 수 없습니다:",h,d,c);return}const y={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(c)?c:c===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:On};let E=ARe(h,v,y);E!==null&&n.updateJsonDataCallback(E,String(g),u,f)}),u&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_update_handsontable_afterChange")},afterCreateRow:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)){const f=c.getColHeader();for(let g=0;g<l;g++){let v=null;Array.isArray(f)&&f.length>0&&f[0]!=="Index"&&(v={},f.forEach(y=>{typeof y=="string"&&(v[y]=null)})),h.splice(a+g,0,v)}d=!0,d&&n.refreshTreeViewCallback("row_added_array_hot")}else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){(async()=>{let f={...h},g=0;for(let C=0;C<l;C++){const P=a+C,A=await wc({title:`새 항목 키 입력 (${C+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:_=>{const T=_.trim();return T?f.hasOwnProperty(T)?"이미 사용 중인 키입니다.":/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(A.isConfirmed&&A.value!==void 0){const _=A.value.trim(),T=null,H=Object.keys(f),G={};let U=!1;if(P>=H.length){f[_]=T;const V={};H.forEach(X=>V[X]=f[X]),V[_]=T,f=V}else{for(let V=0;V<H.length;V++)V===P&&!U&&(G[_]=T,U=!0),G[H[V]]=f[H[V]];U||(G[_]=T),f=G}g++}else break}g>0&&(Object.keys(h).forEach(C=>delete h[C]),Object.assign(h,f),d=!0,n.refreshTreeViewCallback("key_added_object_hot_ordered"));const{preparedHotData:v,preparedColHeaders:y,preparedCellMetaMap:E}=Vr(h,e,n);On=E,c.updateSettings({colHeaders:y}),c.loadData(v)})();return}if(d||u!=="loadData"){const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(h,e,n);On=v,c.updateSettings({colHeaders:g}),c.loadData(f)}},afterCreateCol:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){(async()=>{for(let y=0;y<l;y++){const E=a+y,C=await wc({title:`새 열(속성)의 키 입력 (${y+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:P=>{const A=P.trim();return A?h[0].hasOwnProperty(A)?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(A)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(C.isConfirmed&&C.value!==void 0){const P=C.value.trim();h.forEach(A=>{if(typeof A=="object"&&A!==null){const _=Object.keys(A),T={};let H=!1;if(E>=_.length)A[P]=null;else{for(let G=0;G<_.length;G++)G===E&&!H&&(T[P]=null,H=!0),T[_[G]]=A[_[G]];H||(T[P]=null),Object.keys(A).forEach(G=>delete A[G]),Object.assign(A,T)}}}),d=!0}else break}d&&n.refreshTreeViewCallback("col_added_array_of_obj_hot_ordered");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(h,e,n);On=v,c.updateSettings({colHeaders:g}),c.loadData(f)})();return}else if(typeof h=="object"&&h!==null&&!Array.isArray(h))At({title:"알림",html:'이 뷰에서는 "열 추가"가 "새 키-값 쌍 추가"(행 추가와 유사)로 동작합니다.<br>행 추가 기능을 사용해주세요.',icon:"info",showCancelButton:!1,hotInstance:c}).then(()=>{const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(h,e,n);On=v,c.updateSettings({colHeaders:g}),c.loadData(f)});else{At({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c});const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(h,e,n);On=v,c.updateSettings({colHeaders:g}),c.loadData(f)}},beforeRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;if(u.sort((d,f)=>f-d),Array.isArray(h))u.forEach(d=>{d>=0&&d<h.length&&h.splice(d,1)});else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=Object.keys(h),f=u.map(g=>d[g]).filter(g=>g!==void 0);f.length>0&&f.forEach(g=>{delete h[g]})}else return!1;return!0},afterRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef||c==="ContextMenu.remove_row_custom")return;const h=this;let d=t;n.refreshTreeViewCallback("row_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(d,e,n);On=v,h.updateSettings({colHeaders:g}),h.loadData(f)},beforeRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;const d=this.getColHeader();if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){if(!Array.isArray(d))return At({title:"오류",text:"열 헤더 정보를 가져올 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1;u.sort((f,g)=>g-f),u.forEach(f=>{if(f>=0&&f<d.length){const g=d[f];typeof g=="string"&&h.forEach(v=>{typeof v=="object"&&v!==null&&delete v[g]})}})}else return typeof h=="object"&&h!==null&&!Array.isArray(h)?(At({title:"알림",text:"이 뷰에서 특정 열 부분 삭제는 지원되지 않습니다. 행 전체를 삭제해주세요.",icon:"info",showCancelButton:!1,hotInstance:this}),!1):(At({title:"오류",text:"현재 데이터 구조에 열 삭제 불가.",icon:"error",showCancelButton:!1,hotInstance:this}),!1);return!0},afterRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return;const h=this;let d=t;n.refreshTreeViewCallback("col_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=Vr(d,e,n);On=v,h.updateSettings({colHeaders:g}),h.loadData(f)}}),ff):(console.error("Handsontable 컨테이너를 찾을 수 없습니다."),null)}function ARe(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a,cellMetaMap:l}=n;let u="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const c=o[e];u=`[${t}].${c}`}else return null;else if(e===1)u=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){const c=l.get(`${t}-0`);if(!c||c.originalKey===void 0)return null;const h=c.originalKey;if(e===0)return null;const d=Array.isArray(o)&&o.length>1&&o[0]==="항목 (Key)"&&o[1]==="0",f=Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)";if(d)if(e>0&&e<o.length){const g=o[e],v=r[h];if(Array.isArray(v)){const y=l.get(`${t}-${e}`);if(y&&y.isPadding)return null;u=`.${h}[${g}]`}else return null}else return null;else if(f)if(e===1)u=`.${h}`;else return null;else return Object.keys(r).length===0&&Array.isArray(o)&&o.length===1&&o[0]==="항목 (Key)",null}else return t===0&&e===1?i||"":null;return i?u.startsWith(".")||u.startsWith("[")?i+u:u?i+"."+u:i:u.startsWith(".")?u.substring(1):u}let Yi=[],Zi=-1;const HRe=30;let $_=!1;function NRe(){Yi=[],Zi=-1,$_=!1}function DRe(t){if($_)return;const{dataPathString:e,dataKeyName:n}=t,r=Yi[Zi];r&&r.dataPathString===e&&r.dataKeyName===n||(Zi<Yi.length-1&&(Yi=Yi.slice(0,Zi+1)),Yi.push({dataPathString:e,dataKeyName:n}),Zi=Yi.length-1,Yi.length>HRe&&(Yi.shift(),Zi--))}function kRe(t){let e=!1,n=Zi;return t==="back"&&Zi>0?(n--,e=!0):t==="forward"&&Zi<Yi.length-1&&(n++,e=!0),e?(Zi=n,Yi[Zi]):null}function EA(t){$_=t}function $Re(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function LRe(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=$Re(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function TA(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}let Ee=null,ru=null,xs,gf,qn,Lt=null;function FRe(){const t=document.getElementById("loadBtn");t&&t.addEventListener("click",L_);const e=document.getElementById("saveBtn");e&&e.addEventListener("click",zRe);const n=document.getElementById("minifyBtn");n&&n.addEventListener("click",()=>{if(on&&on.value)try{on.value=NV(on.value)}catch(h){en&&(en.textContent="Minify 오류: "+h.message)}else on&&(on.value="")});const r=document.getElementById("uglifyBtn");r&&r.addEventListener("click",()=>{if(on&&on.value)try{on.value=DV(on.value)}catch(h){en&&(en.textContent="Uglify(포맷팅) 오류: "+h.message)}else on&&(on.value="")});const i=document.getElementById("diffBtn");i&&i.addEventListener("click",()=>{if(!ru&&!Ee){At({title:"알림",text:"먼저 JSON 데이터를 로드해주세요.",icon:"info",showCancelButton:!1,hotInstance:Lt});return}if(!ru){At({title:"알림",text:"로드 시점의 원본 JSON 데이터가 없습니다. 변경사항을 비교할 수 없습니다.",icon:"info",showCancelButton:!1,hotInstance:Lt});return}aj({title:"JSON 데이터 변경사항",jsonDiffData:{left:ru,right:Ee===null?{}:Ee},buttons:[{text:"닫기",role:"confirm"}],hotInstance:Lt}).catch(d=>{console.error("showJsonDiffPopup 실행 중 오류:",d),At({title:"오류",text:"변경점 확인 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})})});const o=document.getElementById("loadFromFileBtn");o&&o.addEventListener("click",jRe);const s=document.getElementById("saveToFileBtn");s&&s.addEventListener("click",URe),xs=document.getElementById("searchInput"),gf=document.getElementById("searchTargetSelect"),qn=document.getElementById("searchResultsDropdown"),xs&&xs.addEventListener("input",_A),gf&&gf.addEventListener("change",_A),document.addEventListener("click",h=>{qn&&xs&&!xs.contains(h.target)&&!qn.contains(h.target)&&(qn.style.display="none")}),qn&&qn.addEventListener("click",h=>h.stopPropagation()),window.addEventListener("mousedown",h=>{(h.button===3||h.button===4)&&(h.preventDefault(),h.button===3?xA("back"):h.button===4&&xA("forward"))}),window.addEventListener("contextmenu",h=>{h.preventDefault()});const a=document.querySelector(".json-control-panel");a?(a.addEventListener("dragover",VRe),a.addEventListener("dragleave",WRe),a.addEventListener("drop",BRe)):console.warn(".json-control-panel 요소를 찾을 수 없어 드래그앤드롭 기능을 활성화할 수 없습니다.");const l=document.querySelector(".main-layout-triple-panel"),u=[document.querySelector(".json-control-panel"),document.querySelector(".tree-view-panel"),document.querySelector(".table-view-panel")],c=[document.getElementById("resizer-1"),document.getElementById("resizer-2")];l&&u.every(h=>h)&&c.every(h=>h)?(MA(l,u,c),window.addEventListener("resize",()=>MA(l,u,c)),c.forEach((h,d)=>{let f=!1,g=0,v=[];h.addEventListener("mousedown",C=>{C.preventDefault(),f=!0,g=C.clientX,v=[u[d].offsetWidth,u[d+1].offsetWidth],document.addEventListener("mousemove",y),document.addEventListener("mouseup",E)});function y(C){if(!f)return;const P=C.clientX-g,A=50;let _=v[0]+P,T=v[1]-P;_<A&&(_=A,T=v[0]+v[1]-_),T<A&&(T=A,_=v[0]+v[1]-T),u[d].style.flexBasis=`${_}px`,u[d+1].style.flexBasis=`${T}px`}function E(){f&&(f=!1,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",E))}})):console.warn("3-패널 레이아웃에 필요한 요소를 모두 찾을 수 없습니다. 리사이저가 동작하지 않을 수 있습니다.")}function VRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.add("dragover-active"),t.dataTransfer.dropEffect="copy"}function WRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active")}function BRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active");const e=t.dataTransfer.files;if(e.length>0){const n=e[0];if(n.type==="application/json"||n.name.toLowerCase().endsWith(".json")){const r=new FileReader;r.onload=i=>{try{const o=i.target.result;on?(on.value=o,L_(),eu(Xr,`${n.name} 파일이 드롭되어 로드되었습니다.`,3e3)):(console.error("JSON 입력 필드를 찾을 수 없습니다."),At({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt}))}catch(o){console.error("파일 읽기 또는 JSON 파싱 오류 (드롭):",o),en&&(en.textContent=`파일 오류 (드롭): ${o.message}`),At({title:"파일 로드 오류 (드롭)",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}},r.onerror=i=>{console.error("파일 읽기 오류 (드롭):",i),en&&(en.textContent="파일을 읽는 중 오류가 발생했습니다 (드롭)."),At({title:"파일 읽기 오류 (드롭)",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})},r.readAsText(n)}else At({title:"잘못된 파일 타입",text:"JSON 파일(.json)만 드롭해주세요.",icon:"warning",showCancelButton:!1,hotInstance:Lt})}}function MA(t,e,n){const r=t.offsetWidth,i=n.reduce((l,u)=>l+u.offsetWidth,0),o=r-i,s=[.1,.15,.75],a=50;if(o>0){let l=Math.max(a,Math.floor(o*s[0])),u=Math.max(a,Math.floor(o*s[1])),c=Math.max(a,o-l-u);l+u+c>o&&(c=o-l-u),e[0].style.flexBasis=`${l}px`,e[1].style.flexBasis=`${u}px`,e[2].style.flexBasis=`${c}px`}}function _A(){if(!xs||!gf||!qn)return;const t=xs.value.trim().toLowerCase(),e=gf.value;if(!t){qn.innerHTML="",qn.style.display="none";return}if(Ee==null){TA([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],qn,t,PA);return}const n=LRe(t,e,Ee);TA(n,qn,t,PA)}function PA(t){t&&typeof Ya=="function"&&(Ya(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString||""),qn&&(qn.style.display="none"))}function jRe(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",t.addEventListener("change",e=>{const n=e.target.files[0];if(!n)return;const r=new FileReader;r.onload=i=>{try{const o=i.target.result;on?(on.value=o,L_(),eu(Xr,`${n.name} 파일이 로드되었습니다.`,3e3)):(console.error("JSON 입력 필드를 찾을 수 없습니다."),At({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt}))}catch(o){console.error("파일 읽기 또는 JSON 파싱 오류:",o),en&&(en.textContent=`파일 오류: ${o.message}`),At({title:"파일 로드 오류",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}},r.onerror=i=>{console.error("파일 읽기 오류:",i),en&&(en.textContent="파일을 읽는 중 오류가 발생했습니다."),At({title:"파일 읽기 오류",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})},r.readAsText(n),document.body.removeChild(t)}),document.body.appendChild(t),t.click()}async function URe(){if(Ee==null){eu(Xr,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await wc({title:"파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:Lt});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".json")||(e+=".json");const n=JSON.stringify(Ee,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),eu(Xr,`${e} 파일이 성공적으로 저장되었습니다!`,3e3)}else eu(Xr,"파일 저장이 취소되었습니다.",3e3)}catch(t){console.error("JSON 파일 저장 오류:",t),en&&(en.textContent="JSON 파일 저장 오류: "+t.message),At({title:"파일 저장 오류",text:`JSON 데이터를 파일로 저장하는 중 오류가 발생했습니다: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}}function L_(){YRe(),NRe();try{const t=on.value.trim();if(!t){Ee=null,ru=null,Dc(null,mf),Xp();return}Ee=JSON.parse(t),ru=JSON.parse(JSON.stringify(Ee));const e=MV();if(Ot&&(Ot.innerHTML=""),typeof Ee=="object"&&Ee!==null)wf(Ee,Ot,"",Ee,0,e);else{const r={["value"]:Ee};wf(r,Ot,"",r,0,e)}Xp(),Dc(null,mf)}catch(t){en&&(en.textContent="JSON 파싱 오류: "+t.message),Ee=null,ru=null,Ot&&(Ot.innerHTML=""),Xp(),Dc(null,mf)}}function zRe(){if(en&&(en.textContent=""),Ee!=null)try{const t=JSON.stringify(Ee,null,2);on&&(on.value=t),Xr&&eu(Xr,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){en&&(en.textContent="JSON 문자열 변환 오류: "+t.message),Xr&&(Xr.textContent="")}else on&&(on.value=""),Xr&&eu(Xr,"저장할 JSON 데이터가 없습니다.",3e3)}function YRe(){uj(),Xp(),Ee=null,ru=null,Kc(null),qn&&(qn.innerHTML="",qn.style.display="none"),xs&&(xs.value=""),Ot&&(Ot.innerHTML=""),Dc(null,mf)}function Xp(){Lt=TV()}function GRe(t,e,n=!1){if(Ee==null){console.error("데이터 업데이트 오류: currentJsonData가 없습니다.");return}const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Ee:s=ou(Ee,o),o===""&&t===i&&(typeof Ee!="object"||Ee===null)){if(Ee=DS(e,Ee),n)return;uv(t),Ya(Ee,"value",Ee,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){console.error("데이터 업데이트 오류: 부모 객체를 찾을 수 없거나 객체/배열이 아님.",{pathString:t,parentPath:o,parentObject:s}),At({title:"오류",text:"데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).",icon:"error",showCancelButton:!1,hotInstance:Lt});return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){console.error("데이터 업데이트 오류: 배열 인덱스 범위 초과.",{targetKeyOrIndex:a,arrayLength:s.length}),At({title:"오류",text:"배열 인덱스 범위를 벗어났습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt});return}let l=!0;const u=s[a],c=DS(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&Ot){const f=Ot.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(VH(g,c),l=!1)}}!n&&l&&uv(t)}}function KRe(t,e,n,r){let i;if(r&&(t===""||ou(Ee,t)===r)?i=r:i=t===""?Ee:ou(Ee,t),typeof i!="object"||i===null||Array.isArray(i)){At({title:"오류",text:"키를 업데이트할 부모 객체를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt});return}if(!i.hasOwnProperty(e)){At({title:"오류",text:`기존 키 "${e}"를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt});return}if(n===e){At({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다.",showCancelButton:!1,hotInstance:Lt});return}if(i.hasOwnProperty(n)){At({title:"오류",text:`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt});return}const o={},s=i[e];for(const a in i)i.hasOwnProperty(a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)i.hasOwnProperty(a)&&delete i[a];for(const a in o)o.hasOwnProperty(a)&&(i[a]=o[a]);At({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`,showCancelButton:!1,hotInstance:Lt}),uv(`key_renamed_in_parent:${t}`),Ya(i,n,Ee,t)}function uv(t="N/A"){if(Ot&&Ee!=null){const e=dj(),n=fj(Ot);Ot.innerHTML="";const r=MV();if(typeof Ee=="object"&&Ee!==null)wf(Ee,Ot,"",Ee,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Ee};wf(o,Ot,"",o,0,r)}if(gj(Ot,n),e){const i=Ot.querySelector(`.tree-node[data-path="${e}"]`);i&&Kc(i)}}else Ot&&(Ot.innerHTML="")}function MV(){return{displayTableCallback:Ya,getObjectByPathCallback:ou,rootJsonData:Ee}}function mf(t){const e=ou(Ee,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}Ya(e,n,Ee,t,{syncTreeView:!0})}else console.warn(`Data not found for path: ${t}`),At({title:"오류",text:`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt})}function Ya(t,e,n,r,i={syncTreeView:!0}){if(DRe({dataPathString:r,dataKeyName:e}),Dc(r,mf),Lt=ORe(t,e,{tableViewDomElement:FH,updateJsonDataCallback:GRe,updateJsonKeyCallback:KRe,refreshTreeViewCallback:uv,getObjectByPathCallback:ou,convertToTypedValueCallback:DS,rootJsonData:n,currentJsonDataRef:()=>Ee,dataPathString:r,displayTableCallback:Ya}),i.syncTreeView&&Ot&&r!==void 0&&r!==null){const s=Ot.querySelector(`.tree-node[data-path="${r}"]`);s?(Kc(s),setTimeout(()=>{const a=Ot.querySelector(`.tree-node[data-path="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},50)):r===""?(Kc(null),Ot.firstChild&&(Ot.scrollTop=0)):console.warn(`Tree node for path "${r}" not found for synchronization.`)}}function xA(t){const e=kRe(t);if(e){EA(!0);try{const n=ou(Ee,e.dataPathString);Ya(n,e.dataKeyName,Ee,e.dataPathString,{syncTreeView:!1})}catch(n){console.error("Error navigating history:",n),At({title:"오류",text:"히스토리 복원 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})}finally{EA(!1)}}}document.addEventListener("DOMContentLoaded",FRe)});export default qRe();
