var nB=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var H0e=nB((K0e,sw)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function rB(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function iB(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function K1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function oB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fx(t,e){return t.get(K1(t,e))}function sB(t,e,n){oB(t,e),e.set(t,n)}function aB(t,e,n){return t.set(K1(t,e),n),n}const lB=100,Te={},uB=()=>{Te.previousActiveElement instanceof HTMLElement?(Te.previousActiveElement.focus(),Te.previousActiveElement=null):document.body&&document.body.focus()},cB=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Te.restoreFocusTimeout=setTimeout(()=>{uB(),e()},lB),window.scrollTo(n,r)}),q1="swal2-",hB=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],Y=hB.reduce((t,e)=>(t[e]=q1+e,t),{}),dB=["success","warning","info","question","error"],aw=dB.reduce((t,e)=>(t[e]=q1+e,t),{}),X1="SweetAlert2:",R0=t=>t.charAt(0).toUpperCase()+t.slice(1),mr=t=>{console.warn(`${X1} ${typeof t=="object"?t.join(" "):t}`)},bu=t=>{console.error(`${X1} ${t}`)},gx=[],fB=t=>{gx.includes(t)||(gx.push(t),mr(t))},J1=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;fB(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},Cv=t=>typeof t=="function"?t():t,E0=t=>t&&typeof t.toPromise=="function",Jf=t=>E0(t)?t.toPromise():Promise.resolve(t),T0=t=>t&&Promise.resolve(t)===t,vr=()=>document.body.querySelector(`.${Y.container}`),Zf=t=>{const e=vr();return e?e.querySelector(t):null},ri=t=>Zf(`.${t}`),lt=()=>ri(Y.popup),lh=()=>ri(Y.icon),gB=()=>ri(Y["icon-content"]),Z1=()=>ri(Y.title),M0=()=>ri(Y["html-container"]),Q1=()=>ri(Y.image),_0=()=>ri(Y["progress-steps"]),bv=()=>ri(Y["validation-message"]),Zo=()=>Zf(`.${Y.actions} .${Y.confirm}`),uh=()=>Zf(`.${Y.actions} .${Y.cancel}`),Su=()=>Zf(`.${Y.actions} .${Y.deny}`),mB=()=>ri(Y["input-label"]),ch=()=>Zf(`.${Y.loader}`),Qf=()=>ri(Y.actions),eH=()=>ri(Y.footer),Sv=()=>ri(Y["timer-progress-bar"]),x0=()=>ri(Y.close),pB=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,P0=()=>{const t=lt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(pB),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>Fr(o))},I0=()=>js(document.body,Y.shown)&&!js(document.body,Y["toast-shown"])&&!js(document.body,Y["no-backdrop"]),Rv=()=>{const t=lt();return t?js(t,Y.toast):!1},wB=()=>{const t=lt();return t?t.hasAttribute("data-loading"):!1},ii=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},js=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},vB=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(Y).includes(n)&&!Object.values(aw).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},ni=(t,e,n)=>{if(vB(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){mr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}gt(t,r)}},Ev=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${Y.popup} > .${Y[e]}`);case"checkbox":return t.querySelector(`.${Y.popup} > .${Y.checkbox} input`);case"radio":return t.querySelector(`.${Y.popup} > .${Y.radio} input:checked`)||t.querySelector(`.${Y.popup} > .${Y.radio} input:first-child`);case"range":return t.querySelector(`.${Y.popup} > .${Y.range} input`);default:return t.querySelector(`.${Y.popup} > .${Y.input}`)}},tH=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},nH=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},gt=(t,e)=>{nH(t,e,!0)},Ti=(t,e)=>{nH(t,e,!1)},Oa=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&js(i,e))return i}},ou=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},kn=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},tr=t=>{t&&(t.style.display="none")},O0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{eg(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},mx=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},eg=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?kn(t,n):tr(t)},Fr=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),yB=()=>!Fr(Zo())&&!Fr(Su())&&!Fr(uh()),px=t=>t.scrollHeight>t.clientHeight,rH=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},A0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=Sv();n&&Fr(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},CB=()=>{const t=Sv();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},bB=()=>typeof window>"u"||typeof document>"u",SB=`
 <div aria-labelledby="${Y.title}" aria-describedby="${Y["html-container"]}" class="${Y.popup}" tabindex="-1">
   <button type="button" class="${Y.close}"></button>
   <ul class="${Y["progress-steps"]}"></ul>
   <div class="${Y.icon}"></div>
   <img class="${Y.image}" />
   <h2 class="${Y.title}" id="${Y.title}"></h2>
   <div class="${Y["html-container"]}" id="${Y["html-container"]}"></div>
   <input class="${Y.input}" id="${Y.input}" />
   <input type="file" class="${Y.file}" />
   <div class="${Y.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${Y.select}" id="${Y.select}"></select>
   <div class="${Y.radio}"></div>
   <label class="${Y.checkbox}">
     <input type="checkbox" id="${Y.checkbox}" />
     <span class="${Y.label}"></span>
   </label>
   <textarea class="${Y.textarea}" id="${Y.textarea}"></textarea>
   <div class="${Y["validation-message"]}" id="${Y["validation-message"]}"></div>
   <div class="${Y.actions}">
     <div class="${Y.loader}"></div>
     <button type="button" class="${Y.confirm}"></button>
     <button type="button" class="${Y.deny}"></button>
     <button type="button" class="${Y.cancel}"></button>
   </div>
   <div class="${Y.footer}"></div>
   <div class="${Y["timer-progress-bar-container"]}">
     <div class="${Y["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),RB=()=>{const t=vr();return t?(t.remove(),Ti([document.documentElement,document.body],[Y["no-backdrop"],Y["toast-shown"],Y["has-column"]]),!0):!1},il=()=>{Te.currentInstance.resetValidationMessage()},EB=()=>{const t=lt(),e=Oa(t,Y.input),n=Oa(t,Y.file),r=t.querySelector(`.${Y.range} input`),i=t.querySelector(`.${Y.range} output`),o=Oa(t,Y.select),s=t.querySelector(`.${Y.checkbox} input`),a=Oa(t,Y.textarea);e.oninput=il,n.onchange=il,o.onchange=il,s.onchange=il,a.oninput=il,r.oninput=()=>{il(),i.value=r.value},r.onchange=()=>{il(),i.value=r.value}},TB=t=>typeof t=="string"?document.querySelector(t):t,MB=t=>{const e=lt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},_B=t=>{window.getComputedStyle(t).direction==="rtl"&&gt(vr(),Y.rtl)},xB=t=>{const e=RB();if(bB()){bu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=Y.container,e&&gt(n,Y["no-transition"]),ii(n,SB),n.dataset.swal2Theme=t.theme;const r=TB(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),MB(t),_B(r),EB()},H0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?PB(t,e):t&&ii(e,t)},PB=(t,e)=>{t.jquery?IB(e,t):ii(e,t.toString())},IB=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},OB=(t,e)=>{const n=Qf(),r=ch();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?tr(n):kn(n),ni(n,e,"actions"),AB(n,r,e),ii(r,e.loaderHtml||""),ni(r,e,"loader"))};function AB(t,e,n){const r=Zo(),i=Su(),o=uh();!r||!i||!o||(Hy(r,"confirm",n),Hy(i,"deny",n),Hy(o,"cancel",n),HB(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function HB(t,e,n,r){if(!r.buttonsStyling){Ti([t,e,n],Y.styled);return}gt([t,e,n],Y.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),Ay(t),Ay(e),Ay(n)}function Ay(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function Hy(t,e,n){const r=R0(e);eg(t,n[`show${r}Button`],"inline-block"),ii(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=Y[e],ni(t,n,`${e}Button`)}const NB=(t,e)=>{const n=x0();n&&(ii(n,e.closeButtonHtml||""),ni(n,e,"closeButton"),eg(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},DB=(t,e)=>{const n=vr();n&&(kB(n,e.backdrop),$B(n,e.position),LB(n,e.grow),ni(n,e,"container"))};function kB(t,e){typeof e=="string"?t.style.background=e:e||gt([document.documentElement,document.body],Y["no-backdrop"])}function $B(t,e){e&&(e in Y?gt(t,Y[e]):(mr('The "position" parameter is not valid, defaulting to "center"'),gt(t,Y.center)))}function LB(t,e){e&&gt(t,Y[`grow-${e}`])}var Ot={innerParams:new WeakMap,domCache:new WeakMap};const FB=["input","file","range","select","radio","checkbox","textarea"],VB=(t,e)=>{const n=lt();if(!n)return;const r=Ot.innerParams.get(t),i=!r||e.input!==r.input;FB.forEach(o=>{const s=Oa(n,Y[o]);s&&(jB(o,e.inputAttributes),s.className=Y[o],i&&tr(s))}),e.input&&(i&&BB(e),UB(e))},BB=t=>{if(!t.input)return;if(!ln[t.input]){bu(`Unexpected type of input! Expected ${Object.keys(ln).join(" | ")}, got "${t.input}"`);return}const e=iH(t.input);if(!e)return;const n=ln[t.input](e,t);kn(e),t.inputAutoFocus&&setTimeout(()=>{tH(n)})},WB=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},jB=(t,e)=>{const n=lt();if(!n)return;const r=Ev(n,t);if(r){WB(r);for(const i in e)r.setAttribute(i,e[i])}},UB=t=>{if(!t.input)return;const e=iH(t.input);e&&ni(e,t,"input")},N0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},tg=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=Y["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&gt(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},iH=t=>{const e=lt();if(e)return Oa(e,Y[t]||Y.input)},lw=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:T0(e)||mr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},ln={};ln.text=ln.email=ln.password=ln.number=ln.tel=ln.url=ln.search=ln.date=ln["datetime-local"]=ln.time=ln.week=ln.month=(t,e)=>(lw(t,e.inputValue),tg(t,t,e),N0(t,e),t.type=e.input,t);ln.file=(t,e)=>(tg(t,t,e),N0(t,e),t);ln.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return lw(n,e.inputValue),n.type=e.input,lw(r,e.inputValue),tg(n,t,e),t};ln.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");ii(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return tg(t,t,e),t};ln.radio=t=>(t.textContent="",t);ln.checkbox=(t,e)=>{const n=Ev(lt(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return ii(r,e.inputPlaceholder||e.inputLabel),n};ln.textarea=(t,e)=>{lw(t,e.inputValue),N0(t,e),tg(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(lt()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?lt().style.width=`${o}px`:ou(lt(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const zB=(t,e)=>{const n=M0();n&&(O0(n),ni(n,e,"htmlContainer"),e.html?(H0(e.html,n),kn(n,"block")):e.text?(n.textContent=e.text,kn(n,"block")):tr(n),VB(t,e))},YB=(t,e)=>{const n=eH();n&&(O0(n),eg(n,e.footer,"block"),e.footer&&H0(e.footer,n),ni(n,e,"footer"))},GB=(t,e)=>{const n=Ot.innerParams.get(t),r=lh();if(!r)return;if(n&&e.icon===n.icon){vx(r,e),wx(r,e);return}if(!e.icon&&!e.iconHtml){tr(r);return}if(e.icon&&Object.keys(aw).indexOf(e.icon)===-1){bu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),tr(r);return}kn(r),vx(r,e),wx(r,e),gt(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",oH)},wx=(t,e)=>{for(const[n,r]of Object.entries(aw))e.icon!==n&&Ti(t,r);gt(t,e.icon&&aw[e.icon]),XB(t,e),oH(),ni(t,e,"icon")},oH=()=>{const t=lt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},KB=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,qB=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,vx=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=yx(e.iconHtml):e.icon==="success"?(r=KB,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=qB:e.icon&&(r=yx({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&ii(t,r)},XB=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])mx(t,n,"background-color",e.iconColor);mx(t,".swal2-success-ring","border-color",e.iconColor)}},yx=t=>`<div class="${Y["icon-content"]}">${t}</div>`,JB=(t,e)=>{const n=Q1();if(n){if(!e.imageUrl){tr(n);return}kn(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),ou(n,"width",e.imageWidth),ou(n,"height",e.imageHeight),n.className=Y.image,ni(n,e,"image")}};let D0=!1,sH=0,aH=0,lH=0,uH=0;const ZB=t=>{t.addEventListener("mousedown",uw),document.body.addEventListener("mousemove",cw),t.addEventListener("mouseup",hw),t.addEventListener("touchstart",uw),document.body.addEventListener("touchmove",cw),t.addEventListener("touchend",hw)},QB=t=>{t.removeEventListener("mousedown",uw),document.body.removeEventListener("mousemove",cw),t.removeEventListener("mouseup",hw),t.removeEventListener("touchstart",uw),document.body.removeEventListener("touchmove",cw),t.removeEventListener("touchend",hw)},uw=t=>{const e=lt();if(t.target===e||lh().contains(t.target)){D0=!0;const n=cH(t);sH=n.clientX,aH=n.clientY,lH=parseInt(e.style.insetInlineStart)||0,uH=parseInt(e.style.insetBlockStart)||0,gt(e,"swal2-dragging")}},cw=t=>{const e=lt();if(D0){let{clientX:n,clientY:r}=cH(t);e.style.insetInlineStart=`${lH+(n-sH)}px`,e.style.insetBlockStart=`${uH+(r-aH)}px`}},hw=()=>{const t=lt();D0=!1,Ti(t,"swal2-dragging")},cH=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},eW=(t,e)=>{const n=vr(),r=lt();if(!(!n||!r)){if(e.toast){ou(n,"width",e.width),r.style.width="100%";const i=ch();i&&r.insertBefore(i,lh())}else ou(r,"width",e.width);ou(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),tr(bv()),tW(r,e),e.draggable&&!e.toast?(gt(r,Y.draggable),ZB(r)):(Ti(r,Y.draggable),QB(r))}},tW=(t,e)=>{const n=e.showClass||{};t.className=`${Y.popup} ${Fr(t)?n.popup:""}`,e.toast?(gt([document.documentElement,document.body],Y["toast-shown"]),gt(t,Y.toast)):gt(t,Y.modal),ni(t,e,"popup"),typeof e.customClass=="string"&&gt(t,e.customClass),e.icon&&gt(t,Y[`icon-${e.icon}`])},nW=(t,e)=>{const n=_0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){tr(n);return}kn(n),n.textContent="",i>=r.length&&mr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=rW(o);if(n.appendChild(a),s===i&&gt(a,Y["active-progress-step"]),s!==r.length-1){const l=iW(e);n.appendChild(l)}})},rW=t=>{const e=document.createElement("li");return gt(e,Y["progress-step"]),ii(e,t),e},iW=t=>{const e=document.createElement("li");return gt(e,Y["progress-step-line"]),t.progressStepsDistance&&ou(e,"width",t.progressStepsDistance),e},oW=(t,e)=>{const n=Z1();n&&(O0(n),eg(n,e.title||e.titleText,"block"),e.title&&H0(e.title,n),e.titleText&&(n.innerText=e.titleText),ni(n,e,"title"))},hH=(t,e)=>{eW(t,e),DB(t,e),nW(t,e),GB(t,e),JB(t,e),oW(t,e),NB(t,e),zB(t,e),OB(t,e),YB(t,e);const n=lt();typeof e.didRender=="function"&&n&&e.didRender(n),Te.eventEmitter.emit("didRender",n)},sW=()=>Fr(lt()),dH=()=>{var t;return(t=Zo())===null||t===void 0?void 0:t.click()},aW=()=>{var t;return(t=Su())===null||t===void 0?void 0:t.click()},lW=()=>{var t;return(t=uh())===null||t===void 0?void 0:t.click()},hh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),fH=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},uW=(t,e,n)=>{fH(t),e.toast||(t.keydownHandler=r=>hW(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:lt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},US=(t,e)=>{var n;const r=P0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=lt())===null||n===void 0||n.focus()},gH=["ArrowRight","ArrowDown"],cW=["ArrowLeft","ArrowUp"],hW=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?dW(e,t):e.key==="Tab"?fW(e):[...gH,...cW].includes(e.key)?gW(e.key):e.key==="Escape"&&mW(e,t,n)))},dW=(t,e)=>{if(!Cv(e.allowEnterKey))return;const n=Ev(lt(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;dH(),t.preventDefault()}},fW=t=>{const e=t.target,n=P0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?US(r,-1):US(r,1),t.stopPropagation(),t.preventDefault()},gW=t=>{const e=Qf(),n=Zo(),r=Su(),i=uh();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=gH.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Fr(a))break}a instanceof HTMLButtonElement&&a.focus()}},mW=(t,e,n)=>{Cv(e.allowEscapeKey)&&(t.preventDefault(),n(hh.esc))};var Jc={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const pW=()=>{const t=vr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},mH=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},pH=typeof window<"u"&&!!window.GestureEvent,wW=()=>{if(pH&&!js(document.body,Y.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,gt(document.body,Y.iosfix),vW()}},vW=()=>{const t=vr();if(!t)return;let e;t.ontouchstart=n=>{e=yW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},yW=t=>{const e=t.target,n=vr(),r=M0();return!n||!r||CW(t)||bW(t)?!1:e===n||!px(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(px(r)&&r.contains(e))},CW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",bW=t=>t.touches&&t.touches.length>1,SW=()=>{if(js(document.body,Y.iosfix)){const t=parseInt(document.body.style.top,10);Ti(document.body,Y.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},RW=()=>{const t=document.createElement("div");t.className=Y["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let Fc=null;const EW=t=>{Fc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(Fc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Fc+RW()}px`)},TW=()=>{Fc!==null&&(document.body.style.paddingRight=`${Fc}px`,Fc=null)};function wH(t,e,n,r){Rv()?Cx(t,r):(cB(n).then(()=>Cx(t,r)),fH(Te)),pH?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),I0()&&(TW(),SW(),mH()),MW()}function MW(){Ti([document.documentElement,document.body],[Y.shown,Y["height-auto"],Y["no-backdrop"],Y["toast-shown"]])}function Aa(t){t=xW(t);const e=Jc.swalPromiseResolve.get(this),n=_W(this);this.isAwaitingPromise?t.isDismissed||(ng(this),e(t)):n&&e(t)}const _W=t=>{const e=lt();if(!e)return!1;const n=Ot.innerParams.get(t);if(!n||js(e,n.hideClass.popup))return!1;Ti(e,n.showClass.popup),gt(e,n.hideClass.popup);const r=vr();return Ti(r,n.showClass.backdrop),gt(r,n.hideClass.backdrop),PW(t,e,n),!0};function vH(t){const e=Jc.swalPromiseReject.get(this);ng(this),e&&e(t)}const ng=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Ot.innerParams.get(t)||t._destroy())},xW=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),PW=(t,e,n)=>{var r;const i=vr(),o=rH(e);typeof n.willClose=="function"&&n.willClose(e),(r=Te.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?IW(t,e,i,n.returnFocus,n.didClose):wH(t,i,n.returnFocus,n.didClose)},IW=(t,e,n,r,i)=>{Te.swalCloseEventFinishedCallback=wH.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Te.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Te),delete Te.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},Cx=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Te.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Zc=t=>{let e=lt();if(e||new ei,e=lt(),!e)return;const n=ch();Rv()?tr(lh()):OW(e,t),kn(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},OW=(t,e)=>{const n=Qf(),r=ch();!n||!r||(!e&&Fr(Zo())&&(e=Zo()),kn(n),e&&(tr(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),gt([t,n],Y.loading))},AW=(t,e)=>{e.input==="select"||e.input==="radio"?$W(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(E0(e.inputValue)||T0(e.inputValue))&&(Zc(Zo()),LW(t,e))},HW=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return NW(n);case"radio":return DW(n);case"file":return kW(n);default:return e.inputAutoTrim?n.value.trim():n.value}},NW=t=>t.checked?1:0,DW=t=>t.checked?t.value:null,kW=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,$W=(t,e)=>{const n=lt();if(!n)return;const r=i=>{e.input==="select"?FW(n,dw(i),e):e.input==="radio"&&VW(n,dw(i),e)};E0(e.inputOptions)||T0(e.inputOptions)?(Zc(Zo()),Jf(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):bu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},LW=(t,e)=>{const n=t.getInput();n&&(tr(n),Jf(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,kn(n),n.focus(),t.hideLoading()}).catch(r=>{bu(`Error in inputValue promise: ${r}`),n.value="",kn(n),n.focus(),t.hideLoading()}))};function FW(t,e,n){const r=Oa(t,Y.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,ii(l,s),l.selected=yH(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function VW(t,e,n){const r=Oa(t,Y.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=Y.radio,l.value=s,yH(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");ii(c,a),c.className=Y.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const dw=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=dw(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=dw(r)),e.push([n,r])}),e},yH=(t,e)=>!!e&&e.toString()===t.toString(),BW=t=>{const e=Ot.innerParams.get(t);t.disableButtons(),e.input?CH(t,"confirm"):$0(t,!0)},WW=t=>{const e=Ot.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?CH(t,"deny"):k0(t,!1)},jW=(t,e)=>{t.disableButtons(),e(hh.cancel)},CH=(t,e)=>{const n=Ot.innerParams.get(t);if(!n.input){bu(`The "input" parameter is needed to be set when using returnInputValueOn${R0(e)}`);return}const r=t.getInput(),i=HW(t,n);n.inputValidator?UW(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?k0(t,i):$0(t,i)},UW=(t,e,n)=>{const r=Ot.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Jf(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?k0(t,e):$0(t,e)})},k0=(t,e)=>{const n=Ot.innerParams.get(t||void 0);n.showLoaderOnDeny&&Zc(Su()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Jf(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),ng(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>bH(t||void 0,i))):t.close({isDenied:!0,value:e})},bx=(t,e)=>{t.close({isConfirmed:!0,value:e})},bH=(t,e)=>{t.rejectPromise(e)},$0=(t,e)=>{const n=Ot.innerParams.get(t||void 0);n.showLoaderOnConfirm&&Zc(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Jf(n.preConfirm(e,n.validationMessage))).then(i=>{Fr(bv())||i===!1?(t.hideLoading(),ng(t)):bx(t,typeof i>"u"?e:i)}).catch(i=>bH(t||void 0,i))):bx(t,e)};function fw(){const t=Ot.innerParams.get(this);if(!t)return;const e=Ot.domCache.get(this);tr(e.loader),Rv()?t.icon&&kn(lh()):zW(e),Ti([e.popup,e.actions],Y.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const zW=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?kn(e[0],"inline-block"):yB()&&tr(t.actions)};function SH(){const t=Ot.innerParams.get(this),e=Ot.domCache.get(this);return e?Ev(e.popup,t.input):null}function RH(t,e,n){const r=Ot.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function EH(t,e){const n=lt();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${Y.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function TH(){RH(this,["confirmButton","denyButton","cancelButton"],!1)}function MH(){RH(this,["confirmButton","denyButton","cancelButton"],!0)}function _H(){EH(this.getInput(),!1)}function xH(){EH(this.getInput(),!0)}function PH(t){const e=Ot.domCache.get(this),n=Ot.innerParams.get(this);ii(e.validationMessage,t),e.validationMessage.className=Y["validation-message"],n.customClass&&n.customClass.validationMessage&&gt(e.validationMessage,n.customClass.validationMessage),kn(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",Y["validation-message"]),tH(r),gt(r,Y.inputerror))}function IH(){const t=Ot.domCache.get(this);t.validationMessage&&tr(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Ti(e,Y.inputerror))}const Vc={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},YW=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],GW={allowEnterKey:void 0},KW=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],OH=t=>Object.prototype.hasOwnProperty.call(Vc,t),AH=t=>YW.indexOf(t)!==-1,HH=t=>GW[t],qW=t=>{OH(t)||mr(`Unknown parameter "${t}"`)},XW=t=>{KW.includes(t)&&mr(`The parameter "${t}" is incompatible with toasts`)},JW=t=>{const e=HH(t);e&&J1(t,e)},NH=t=>{t.backdrop===!1&&t.allowOutsideClick&&mr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&mr(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)qW(e),t.toast&&XW(e),JW(e)};function DH(t){const e=vr(),n=lt(),r=Ot.innerParams.get(this);if(!n||js(n,r.hideClass.popup)){mr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=ZW(t),o=Object.assign({},r,i);NH(o),e.dataset.swal2Theme=o.theme,hH(this,o),Ot.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const ZW=t=>{const e={};return Object.keys(t).forEach(n=>{AH(n)?e[n]=t[n]:mr(`Invalid parameter to update: ${n}`)}),e};function kH(){const t=Ot.domCache.get(this),e=Ot.innerParams.get(this);if(!e){$H(this);return}t.popup&&Te.swalCloseEventFinishedCallback&&(Te.swalCloseEventFinishedCallback(),delete Te.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Te.eventEmitter.emit("didDestroy"),QW(this)}const QW=t=>{$H(t),delete t.params,delete Te.keydownHandler,delete Te.keydownTarget,delete Te.currentInstance},$H=t=>{t.isAwaitingPromise?(Ny(Ot,t),t.isAwaitingPromise=!0):(Ny(Jc,t),Ny(Ot,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},Ny=(t,e)=>{for(const n in t)t[n].delete(e)};var e2=Object.freeze({__proto__:null,_destroy:kH,close:Aa,closeModal:Aa,closePopup:Aa,closeToast:Aa,disableButtons:MH,disableInput:xH,disableLoading:fw,enableButtons:TH,enableInput:_H,getInput:SH,handleAwaitingPromise:ng,hideLoading:fw,rejectPromise:vH,resetValidationMessage:IH,showValidationMessage:PH,update:DH});const t2=(t,e,n)=>{t.toast?n2(t,e,n):(i2(e),o2(e),s2(t,e,n))},n2=(t,e,n)=>{e.popup.onclick=()=>{t&&(r2(t)||t.timer||t.input)||n(hh.close)}},r2=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let gw=!1;const i2=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(gw=!0)}}},o2=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(gw=!0)}}},s2=(t,e,n)=>{e.container.onclick=r=>{if(gw){gw=!1;return}r.target===e.container&&Cv(t.allowOutsideClick)&&n(hh.backdrop)}},a2=t=>typeof t=="object"&&t.jquery,Sx=t=>t instanceof Element||a2(t),l2=t=>{const e={};return typeof t[0]=="object"&&!Sx(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||Sx(i)?e[n]=i:i!==void 0&&bu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function u2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function c2(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const h2=()=>Te.timeout&&Te.timeout.getTimerLeft(),LH=()=>{if(Te.timeout)return CB(),Te.timeout.stop()},FH=()=>{if(Te.timeout){const t=Te.timeout.start();return A0(t),t}},d2=()=>{const t=Te.timeout;return t&&(t.running?LH():FH())},f2=t=>{if(Te.timeout){const e=Te.timeout.increase(t);return A0(e,!0),e}},g2=()=>!!(Te.timeout&&Te.timeout.isRunning());let Rx=!1;const zS={};function m2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";zS[t]=this,Rx||(document.body.addEventListener("click",p2),Rx=!0)}const p2=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in zS){const r=e.getAttribute(n);if(r){zS[n].fire({template:r});return}}};class w2{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Te.eventEmitter=new w2;const v2=(t,e)=>{Te.eventEmitter.on(t,e)},y2=(t,e)=>{Te.eventEmitter.once(t,e)},C2=(t,e)=>{if(!t){Te.eventEmitter.reset();return}e?Te.eventEmitter.removeListener(t,e):Te.eventEmitter.removeAllListeners(t)};var b2=Object.freeze({__proto__:null,argsToParams:l2,bindClickHandler:m2,clickCancel:lW,clickConfirm:dH,clickDeny:aW,enableLoading:Zc,fire:u2,getActions:Qf,getCancelButton:uh,getCloseButton:x0,getConfirmButton:Zo,getContainer:vr,getDenyButton:Su,getFocusableElements:P0,getFooter:eH,getHtmlContainer:M0,getIcon:lh,getIconContent:gB,getImage:Q1,getInputLabel:mB,getLoader:ch,getPopup:lt,getProgressSteps:_0,getTimerLeft:h2,getTimerProgressBar:Sv,getTitle:Z1,getValidationMessage:bv,increaseTimer:f2,isDeprecatedParameter:HH,isLoading:wB,isTimerRunning:g2,isUpdatableParameter:AH,isValidParameter:OH,isVisible:sW,mixin:c2,off:C2,on:v2,once:y2,resumeTimer:FH,showLoading:Zc,stopTimer:LH,toggleTimer:d2});class S2{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const VH=["swal-title","swal-html","swal-footer"],R2=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return O2(n),Object.assign(E2(n),T2(n),M2(n),_2(n),x2(n),P2(n),I2(n,VH))},E2=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{cu(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof Vc[i]=="boolean"?e[i]=o!=="false":typeof Vc[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},T2=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},M2=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{cu(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${R0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},_2=t=>{const e={},n=t.querySelector("swal-image");return n&&(cu(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},x2=t=>{const e={},n=t.querySelector("swal-icon");return n&&(cu(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},P2=t=>{const e={},n=t.querySelector("swal-input");n&&(cu(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{cu(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},I2=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(cu(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},O2=t=>{const e=VH.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||mr(`Unrecognized element <${r}>`)})},cu=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&mr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},BH=10,A2=t=>{const e=vr(),n=lt();typeof t.willOpen=="function"&&t.willOpen(n),Te.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;D2(e,n,t),setTimeout(()=>{H2(e,n)},BH),I0()&&(N2(e,t.scrollbarPadding,i),pW()),!Rv()&&!Te.previousActiveElement&&(Te.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Te.eventEmitter.emit("didOpen",n),Ti(e,Y["no-transition"])},mw=t=>{const e=lt();if(t.target!==e)return;const n=vr();e.removeEventListener("animationend",mw),e.removeEventListener("transitionend",mw),n.style.overflowY="auto"},H2=(t,e)=>{rH(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",mw),e.addEventListener("transitionend",mw)):t.style.overflowY="auto"},N2=(t,e,n)=>{wW(),e&&n!=="hidden"&&EW(n),setTimeout(()=>{t.scrollTop=0})},D2=(t,e,n)=>{gt(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),kn(e,"grid"),setTimeout(()=>{gt(e,n.showClass.popup),e.style.removeProperty("opacity")},BH)):kn(e,"grid"),gt([document.documentElement,document.body],Y.shown),n.heightAuto&&n.backdrop&&!n.toast&&gt([document.documentElement,document.body],Y["height-auto"])};var Ex={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function k2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=Ex.email),t.input==="url"&&(t.inputValidator=Ex.url))}function $2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(mr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function L2(t){k2(t),t.showLoaderOnConfirm&&!t.preConfirm&&mr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),$2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),xB(t)}let Fo;var Lg=new WeakMap;class gn{constructor(){if(sB(this,Lg,void 0),typeof window>"u")return;Fo=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,aB(Lg,this,this._main(Fo.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(NH(Object.assign({},n,e)),Te.currentInstance){const o=Jc.swalPromiseResolve.get(Te.currentInstance),{isAwaitingPromise:s}=Te.currentInstance;Te.currentInstance._destroy(),s||o({isDismissed:!0}),I0()&&mH()}Te.currentInstance=Fo;const r=V2(e,n);L2(r),Object.freeze(r),Te.timeout&&(Te.timeout.stop(),delete Te.timeout),clearTimeout(Te.restoreFocusTimeout);const i=B2(Fo);return hH(Fo,r),Ot.innerParams.set(Fo,r),F2(Fo,i,r)}then(e){return fx(Lg,this).then(e)}finally(e){return fx(Lg,this).finally(e)}}const F2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};Jc.swalPromiseResolve.set(t,r),Jc.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{BW(t)},e.denyButton.onclick=()=>{WW(t)},e.cancelButton.onclick=()=>{jW(t,o)},e.closeButton.onclick=()=>{o(hh.close)},t2(n,e,o),uW(Te,n,o),AW(t,n),A2(n),W2(Te,n,o),j2(e,n),setTimeout(()=>{e.container.scrollTop=0})}),V2=(t,e)=>{const n=R2(t),r=Object.assign({},Vc,e,n,t);return r.showClass=Object.assign({},Vc.showClass,r.showClass),r.hideClass=Object.assign({},Vc.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},B2=t=>{const e={popup:lt(),container:vr(),actions:Qf(),confirmButton:Zo(),denyButton:Su(),cancelButton:uh(),loader:ch(),closeButton:x0(),validationMessage:bv(),progressSteps:_0()};return Ot.domCache.set(t,e),e},W2=(t,e,n)=>{const r=Sv();tr(r),e.timer&&(t.timeout=new S2(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(kn(r),ni(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&A0(e.timer)})))},j2=(t,e)=>{if(!e.toast){if(!Cv(e.allowEnterKey)){J1("allowEnterKey"),Y2();return}U2(t)||z2(t,e)||US(-1,1)}},U2=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&Fr(n))return n.focus(),!0;return!1},z2=(t,e)=>e.focusDeny&&Fr(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Fr(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&Fr(t.confirmButton)?(t.confirmButton.focus(),!0):!1,Y2=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}gn.prototype.disableButtons=MH;gn.prototype.enableButtons=TH;gn.prototype.getInput=SH;gn.prototype.disableInput=xH;gn.prototype.enableInput=_H;gn.prototype.hideLoading=fw;gn.prototype.disableLoading=fw;gn.prototype.showValidationMessage=PH;gn.prototype.resetValidationMessage=IH;gn.prototype.close=Aa;gn.prototype.closePopup=Aa;gn.prototype.closeModal=Aa;gn.prototype.closeToast=Aa;gn.prototype.rejectPromise=vH;gn.prototype.update=DH;gn.prototype._destroy=kH;Object.assign(gn,b2);Object.keys(e2).forEach(t=>{gn[t]=function(){return Fo&&Fo[t]?Fo[t](...arguments):null}});gn.DismissReason=hh;gn.version="11.21.0";const ei=gn;ei.default=ei;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var Xs=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(_){if(_=o.postProcess(_,r),i){setTimeout(function(){i(_)},0);return}else return _},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],p=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&p+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var C=-1/0,E=1/0,y=function(){for(var _=Math.max(C,-c);_<=Math.min(E,c);_+=2){var I=void 0,M=g[_-1],P=g[_+1];M&&(g[_-1]=void 0);var z=!1;if(P){var W=P.oldPos-_;z=P&&0<=W&&W<l}var V=M&&M.oldPos+1<u;if(!z&&!V){g[_]=void 0;continue}if(!V||z&&M.oldPos<P.oldPos?I=o.addToPath(P,!0,!1,0,r):I=o.addToPath(M,!1,!0,1,r),p=o.extractCommon(I,n,e,_,r),I.oldPos+1>=u&&p+1>=l)return a(o.buildValues(I.lastComponent,n,e))||!0;g[_]=I,I.oldPos+1>=u&&(E=Math.min(E,_-1)),p+1>=l&&(C=Math.max(C,_+1))}c++};if(i)(function _(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);y()||_()},0)})();else for(;c<=h&&Date.now()<=f;){var T=y();if(T)return T}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),G2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),K2=function(t){G2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Xs),WH=new K2;function q2(t,e,n){return WH.diff(t,e,n)}function Tx(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function Mx(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function YS(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function GS(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function Ih(t,e){return YS(t,e,"")}function Fg(t,e){return GS(t,e,"")}function _x(t,e){return e.slice(0,X2(t,e))}function X2(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function J2(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function Z2(t){return!t.includes(`\r
`)&&t.includes(`
`)}function Oh(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function ra(t){var e=t.match(/^\s*/);return e?e[0]:""}var jH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),pw="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Q2=new RegExp("[".concat(pw,"]+|\\s+|[^").concat(pw,"]"),"ug"),ej=function(t){jH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(Q2)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&xx(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&xx(i,s,o,null),n},e}(Xs),UH=new ej;function tj(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?YH(t,e,n):UH.diff(t,e,n)}function xx(t,e,n,r){if(e&&n){var i=ra(e.value),o=Oh(e.value),s=ra(n.value),a=Oh(n.value);if(t){var l=Tx(i,s);t.value=GS(t.value,s,l),e.value=Ih(e.value,l),n.value=Ih(n.value,l)}if(r){var u=Mx(o,a);r.value=YS(r.value,a,u),e.value=Fg(e.value,u),n.value=Fg(n.value,u)}}else if(n){if(t){var c=ra(n.value);n.value=n.value.substring(c.length)}if(r){var c=ra(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=ra(r.value),d=ra(e.value),f=Oh(e.value),g=Tx(h,d);e.value=Ih(e.value,g);var p=Mx(Ih(h,g),f);e.value=Fg(e.value,p),r.value=YS(r.value,h,p),t.value=GS(t.value,h,h.slice(0,h.length-p.length))}else if(r){var C=ra(r.value),E=Oh(e.value),y=_x(E,C);e.value=Fg(e.value,y)}else if(t){var T=Oh(t.value),_=ra(e.value),y=_x(T,_);e.value=Ih(e.value,y)}}var nj=function(t){jH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(pw,"]+|[^\\S\\n\\r]+|[^").concat(pw,"]"),"ug");return n.match(r)||[]},e}(Xs),zH=new nj;function YH(t,e,n){return zH.diff(t,e,n)}function rj(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var ij=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),oj=function(t){ij(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=GH,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}(Xs),L0=new oj;function Ef(t,e,n){return L0.diff(t,e,n)}function sj(t,e,n){return n=rj(n,{ignoreWhitespace:!0}),L0.diff(t,e,n)}function GH(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var aj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),lj=function(t){aj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}(Xs),KH=new lj;function uj(t,e,n){return KH.diff(t,e,n)}var cj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),hj=function(t){cj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}(Xs),qH=new hj;function dj(t,e,n){return qH.diff(t,e,n)}var fj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),gj=function(t){fj(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=GH,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(ww(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}(Xs),XH=new gj;function mj(t,e,n){return XH.diff(t,e,n)}function ww(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=ww(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=ww(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var pj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),wj=function(t){pj(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}(Xs),JH=new wj;function vj(t,e,n){return JH.diff(t,e,n)}var Go=function(){return Go=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Go.apply(this,arguments)};function ZH(t){return Array.isArray(t)?t.map(function(e){return ZH(e)}):Go(Go({},t),{hunks:t.hunks.map(function(e){return Go(Go({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function QH(t){return Array.isArray(t)?t.map(function(e){return QH(e)}):Go(Go({},t),{hunks:t.hunks.map(function(e){return Go(Go({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function yj(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function Cj(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function F0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function bj(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function eN(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=F0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return Sj(t,r[0],n)}function Sj(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(J2(t)&&yj(e)?e=ZH(e):Z2(t)&&Cj(e)&&(e=QH(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(z,W,V,q){return W===q},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(z,W,V,q,Z,ee,te){q===void 0&&(q=0),Z===void 0&&(Z=!0),ee===void 0&&(ee=[]),te===void 0&&(te=0);for(var ce=0,je=!1;q<z.length;q++){var we=z[q],Ae=we.length>0?we[0]:" ",ot=we.length>0?we.substr(1):we;if(Ae==="-")if(o(W+1,r[W],Ae,ot))W++,ce=0;else return!V||r[W]==null?null:(ee[te]=r[W],f(z,W+1,V-1,q,!1,ee,te+1));if(Ae==="+"){if(!Z)return null;ee[te]=ot,te++,ce=0,je=!0}if(Ae===" ")if(ce++,ee[te]=r[W],o(W+1,r[W],Ae,ot))te++,Z=!0,je=!1,W++;else return je||!V?null:r[W]&&(f(z,W+1,V-1,q+1,!1,ee,te+1)||f(z,W+1,V-1,q,!1,ee,te+1))||f(z,W,V-1,q+1,!1,ee,te)}return te-=ce,W-=ce,ee.length=te,{patchedLines:ee,oldLineLastI:W-1}}for(var g=[],p=0,h=0;h<i.length;h++){for(var C=i[h],E=void 0,y=r.length-C.oldLines+s,T=void 0,_=0;_<=s;_++){T=C.oldStart+p-1;for(var I=bj(T,a,y);T!==void 0&&(E=f(C.lines,T,_),!E);T=I());if(E)break}if(!E)return!1;for(var M=a;M<T;M++)g.push(r[M]);for(var P=0;P<E.patchedLines.length;P++){var d=E.patchedLines[P];g.push(d)}a=E.oldLineLastI+1,p=T+1-C.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function Rj(t,e){var n=typeof t=="string"?F0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=eN(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var vw=function(){return vw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},vw.apply(this,arguments)};function tN(t){return Array.isArray(t)?t.map(function(e){return tN(e)}).reverse():vw(vw({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var Qc=function(){return Qc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Qc.apply(this,arguments)};function KS(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;Ef(n,r,Qc(Qc({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(Ef(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(Ae){return Ae.map(function(ot){return" "+ot})}for(var f=[],g=0,p=0,C=[],E=1,y=1,T=0;T<h.length;T++){var _=h[T],I=_.lines||Tj(_.value);if(_.lines=I,_.added||_.removed){if(!g){var M=h[T-1];g=E,p=y,M&&(C=l>0?d(M.lines.slice(-l)):[],g-=C.length,p-=C.length)}for(var P=0,z=I;P<z.length;P++){var W=z[P];C.push((_.added?"+":"-")+W)}_.added?y+=I.length:E+=I.length}else{if(g)if(I.length<=l*2&&T<h.length-2)for(var V=0,q=d(I);V<q.length;V++){var W=q[V];C.push(W)}else{for(var Z=Math.min(I.length,l),ee=0,te=d(I.slice(0,Z));ee<te.length;ee++){var W=te[ee];C.push(W)}var ce={oldStart:g,oldLines:E-g+Z,newStart:p,newLines:y-p+Z,lines:C};f.push(ce),g=0,p=0,C=[]}E+=I.length,y+=I.length}}for(var je=0,we=f;je<we.length;je++)for(var ce=we[je],T=0;T<ce.lines.length;T++)ce.lines[T].endsWith(`
`)?ce.lines[T]=ce.lines[T].slice(0,-1):(ce.lines.splice(T+1,0,"\\ No newline at end of file"),T++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function yw(t){if(Array.isArray(t))return t.map(yw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function nN(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;KS(t,e,n,r,i,o,Qc(Qc({},s),{callback:function(u){l(u?yw(u):void 0)}}))}else{var a=KS(t,e,n,r,i,o,s);return a?yw(a):void 0}}function Ej(t,e,n,r,i,o){return nN(t,t,e,n,r,i,o)}function Tj(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function Mj(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function _j(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(xj(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function xj(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const Pj=Object.freeze(Object.defineProperty({__proto__:null,Diff:Xs,applyPatch:eN,applyPatches:Rj,arrayDiff:JH,canonicalize:ww,characterDiff:WH,convertChangesToDMP:Mj,convertChangesToXML:_j,createPatch:Ej,createTwoFilesPatch:nN,cssDiff:qH,diffArrays:vj,diffChars:q2,diffCss:dj,diffJson:mj,diffLines:Ef,diffSentences:uj,diffTrimmedLines:sj,diffWords:tj,diffWordsWithSpace:YH,formatPatch:yw,jsonDiff:XH,lineDiff:L0,parsePatch:F0,reversePatch:tN,sentenceDiff:KH,structuredPatch:KS,wordDiff:UH,wordsWithSpaceDiff:zH},Symbol.toStringTag,{value:"Module"}));function Bn(t){return typeof t!="string"?"":t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Tv(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u,hotInstance:c}=t;c&&typeof c.deselectCell=="function"&&c.deselectCell();const h={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:{...a,popup:`popup-base ${a.popup||""}`.trim()},preConfirm:l,didOpen:u},d=i.find(g=>g.role==="confirm"||!g.role&&i.indexOf(g)===0),f=i.find(g=>g.role==="cancel");return d?(h.confirmButtonText=d.text||ei.getConfirmButton().innerText,d.color&&(h.confirmButtonColor=d.color)):(!l&&i.every(g=>g.role==="cancel")||i.length===0&&!l)&&(h.showConfirmButton=!1),f&&(h.showCancelButton=!0,h.cancelButtonText=f.text||ei.getCancelButton().innerText,f.color&&(h.cancelButtonColor=f.color)),typeof ei>"u"?(console.error("SweetAlert2 (Swal) is not loaded!"),Promise.reject("SweetAlert2 is not imported")):ei.fire(h).then(g=>{const p={...g,formData:g.value&&typeof g.value=="object"?g.value:{}};return g.isConfirmed&&l&&(p.formData=g.value),g.isConfirmed&&d&&typeof d.action=="function"&&!l?d.action(p):g.isDismissed&&f&&typeof f.action=="function"&&g.dismiss===ei.DismissReason.cancel&&f.action(p),p})}function Ij(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[],hotInstance:i,customClass:o={}}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();let s="",a="",l=[],u=0,c=0;const h=(g,p=2)=>{const C=E=>{if(typeof E!="object"||E===null)return E;if(Array.isArray(E))return E.map(C);const y={};return Object.keys(E).forEach(T=>{y[T]=C(E[T])}),y};try{return JSON.stringify(C(g),null,p)}catch{return JSON.stringify(g,null,p)}};if(n&&n.left!==void 0&&n.right!==void 0)if(typeof Pj>"u"||typeof Ef!="function")a='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다.</p>',s='<div class="diff-popup-header diff-error">라이브러리 오류</div>';else try{const g=h(n.left),p=h(n.right),C=Ef(g,p);C.forEach(V=>{const q=V.value||"",Z=q.split(`
`);let ee=Z.length;Z[Z.length-1]===""&&q.length>0&&ee--,q===""&&(ee=0),V.added?u+=ee:V.removed&&(c+=ee)});const E=[];let y=1,T=1;C.forEach((V,q)=>{const Z=V.value||"",ee=Z.split(`
`);let te=ee.length;ee[ee.length-1]===""&&Z.length>0&&te--,Z===""&&(te=0),V.removed?(E.push({originalPartIndex:q,part:V,sourceType:"del",lineNumber:y,numLines:te}),y+=te):V.added?(E.push({originalPartIndex:q,part:V,sourceType:"ins",lineNumber:T,numLines:te}),T+=te):(y+=te,T+=te)}),l=[];let _=[...E];if(_.length>0){_.sort((q,Z)=>q.lineNumber!==Z.lineNumber?q.lineNumber-Z.lineNumber:q.sourceType==="del"&&Z.sourceType!=="del"?-1:q.sourceType!=="del"&&Z.sourceType==="del"?1:q.originalPartIndex-Z.originalPartIndex);let V=_.shift();for(l.push(V);_.length>0&&V;){const q=V.lineNumber;let Z=null;const ee=_.map(te=>({...te,diff:Math.abs(te.lineNumber-q),sortOrder:te.lineNumber>=q?0:1})).sort((te,ce)=>te.sortOrder!==ce.sortOrder?te.sortOrder-ce.sortOrder:te.diff!==ce.diff?te.diff-ce.diff:te.lineNumber!==ce.lineNumber?te.lineNumber-ce.lineNumber:te.sourceType==="del"&&ce.sourceType!=="del"?-1:te.sourceType!=="del"&&ce.sourceType==="del"?1:te.originalPartIndex-ce.originalPartIndex);if(ee.length>0&&(Z=ee[0]),Z)l.push(Z),V=Z,_=_.filter(te=>te.originalPartIndex!==Z.originalPartIndex);else break}}let I="",M="",P=1,z=1;const W=new Map;l.forEach((V,q)=>W.set(V.originalPartIndex,q)),C.forEach((V,q)=>{const Z=V.value||"",ee=Z.endsWith(`
`)?Z.slice(0,-1).split(`
`):Z.split(`
`);Z===""&&ee.length===1&&ee[0]===""||ee.forEach((te,ce)=>{let je="";(V.added||V.removed)&&ce===0&&W.has(q)&&(je=`id="diff-nav-target-${W.get(q)}"`),V.added?(I+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,M+=`<div ${je} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${z++}</span><span class="diff-sbs-line-content">${Bn(te)}</span></div>
`):V.removed?(I+=`<div ${je} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${P++}</span><span class="diff-sbs-line-content">${Bn(te)}</span></div>
`,M+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(I+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${P++}</span><span class="diff-sbs-line-content">${Bn(te)}</span></div>
`,M+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${z++}</span><span class="diff-sbs-line-content">${Bn(te)}</span></div>
`)})}),a=`<div class="diff-sbs-container"><div class="diff-sbs-pane" id="diff-left-pane">${I}</div><div class="diff-sbs-pane" id="diff-right-pane">${M}</div></div>`,l.length>0||u>0||c>0?s=`<div class="diff-popup-header">JSON 비교 결과</div><div id="diff-navigation" class="diff-navigation-controls">${u>0||c>0?`<span class="diff-summary"><strong class="diff-summary-added">+${u}</strong> <strong class="diff-summary-removed">-${c}</strong></span>`:""}<button id="prev-change-btn" class="swal2-styled">이전 변경점</button><button id="next-change-btn" class="swal2-styled">다음 변경점</button><span id="current-change-info" class="diff-current-change-info"></span></div>`:(s='<div class="diff-popup-header">JSON 비교 결과</div>',a=g===p?'<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':'<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>')}catch(g){a=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${Bn(g.message)}</p>`,s='<div class="diff-popup-header diff-error">오류 발생</div>'}else a='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',s='<div class="diff-popup-header diff-error">데이터 오류</div>';const d=`${s}<div id="diff-container" class="diff-main-container">${a}</div>`,f={...o,popup:`popup-diff-view ${o.popup||""}`.trim(),htmlContainer:o.htmlContainer||"custom-swal-html-container-text-diff"};return Tv({title:e,html:d,buttons:r,width:"95%",customClass:f,didOpen:g=>{const p=l.map((z,W)=>document.getElementById(`diff-nav-target-${W}`)).filter(z=>z);let C=-1,E=null;const y=document.getElementById("diff-navigation"),T=document.getElementById("next-change-btn"),_=document.getElementById("prev-change-btn"),I=document.getElementById("current-change-info");function M(){if(!y)return;const z=p.length===0;T&&(T.style.display=z?"none":"inline-block"),_&&(_.style.display=z?"none":"inline-block"),I&&(I.textContent=z?u>0||c>0?"0 / 0":"변경점 없음":`${C+1} / ${p.length}`),T&&(T.disabled=C>=p.length-1),_&&(_.disabled=C<=0)}function P(z){if(z<0||z>=p.length)return;E&&E.classList.remove("diff-navigation-highlight");const W=p[z];if(W){const V=document.getElementById("diff-container");if(V){const q=W.offsetTop;V.scrollTop=q-V.clientHeight/2+W.clientHeight/2}else W.scrollIntoView({block:"center"});W.classList.add("diff-navigation-highlight"),E=W}C=z,M()}p.length>0?P(0):M(),T&&T.addEventListener("click",()=>{C<p.length-1&&P(C+1)}),_&&_.addEventListener("click",()=>{C>0&&P(C-1)}),g.addEventListener("keydown",z=>{p.length===0||!T||!_||(z.key==="ArrowDown"||z.key==="PageDown"?(z.preventDefault(),T.disabled||T.click()):(z.key==="ArrowUp"||z.key==="PageUp")&&(z.preventDefault(),_.disabled||_.click()))}),M()},hotInstance:i})}async function Zi(t){const{title:e,inputLabel:n,inputValue:r="",inputPlaceholder:i="",inputValidator:o,confirmButtonText:s="확인",cancelButtonText:a="취소",showCancelButton:l=!0,customClass:u={},html:c,hotInstance:h}=t;h&&typeof h.deselectCell=="function"&&h.deselectCell();const d={title:e,input:"text",inputValue:r,inputPlaceholder:i,inputValidator:o,showCancelButton:l,confirmButtonText:s,cancelButtonText:a,customClass:{...u,popup:`swal-text-input-popup ${u.popup||""}`.trim()},didOpen:()=>{const f=ei.getInput();f&&(f.focus(),typeof f.select=="function"&&f.select())}};return c?d.html=c:n&&(d.inputLabel=n),ei.fire(d)}async function ye(t){const{title:e,text:n="",html:r="",icon:i="warning",confirmButtonText:o="확인",cancelButtonText:s="취소",showCancelButton:a=!0,customClass:l={},hotInstance:u}=t;return u&&typeof u.deselectCell=="function"&&u.deselectCell(),ei.fire({title:e,text:n,html:r,icon:i,showCancelButton:a,confirmButtonText:o,cancelButtonText:s,customClass:{...l,popup:`swal-confirmation-popup ${l.popup||""}`.trim()}})}async function Px(t){const{title:e="URL 작업",initialInputValue:n="",inputLabel:r="입력:",outputLabel:i="결과:",actionButtonText:o="실행",confirmButtonText:s="결과를 메인 편집기에 복사",cancelButtonText:a="팝업 닫기",onExecuteAction:l,hotInstance:u,customClass:c={}}=t;u&&typeof u.deselectCell=="function"&&u.deselectCell();const h=Date.now(),d=`popup-url-input-${h}`,f=`popup-url-output-${h}`,g=`popup-execute-action-${h}`,p=`popup-url-validation-${h}`,C=`
        <div class="popup-url-process-container">
            <div class="popup-form-group">
                <label for="${d}" class="popup-label">${Bn(r)}</label>
                <textarea id="${d}" class="swal2-textarea popup-textarea" placeholder="여기에 문자열을 입력하세요...">${Bn(n)}</textarea>
            </div>
            <div class="popup-action-button-container">
                <button type="button" id="${g}" class="swal2-styled popup-execute-button">${Bn(o)}</button>
            </div>
            <div class="popup-form-group">
                <label for="${f}" class="popup-label">${Bn(i)}</label>
                <textarea id="${f}" class="swal2-textarea popup-textarea" readonly placeholder="결과가 여기에 표시됩니다..."></textarea>
            </div>
            <div id="${p}" class="popup-validation-message"></div>
        </div>`,E={...c,popup:`popup-url-process popup-basic-white-theme ${c.popup||""}`.trim(),htmlContainer:c.htmlContainer||"popup-html-container-spacing"};return Tv({title:e,html:C,hotInstance:u,width:"50em",padding:"1.5em",customClass:E,buttons:[{text:s,role:"confirm"},{text:a,role:"cancel"}],didOpen:y=>{const T=y.querySelector(`#${d}`),_=y.querySelector(`#${f}`),I=y.querySelector(`#${g}`),M=y.querySelector(`#${p}`);T&&T.focus(),I&&T&&_&&M&&I.addEventListener("click",()=>{const P=T.value;if(M.textContent="",P.trim()===""){_.value="",M.textContent="입력값이 비어있습니다.";return}if(typeof l=="function")try{const z=l(P);_.value=z,typeof z=="string"&&z.startsWith("오류:")&&(M.textContent=z)}catch(z){const W=`실행 중 예외: ${z.message}`;_.value=W,M.textContent=W}else{const z="오류: 실행할 작업(onExecuteAction)이 정의되지 않았습니다.";_.value=z,M.textContent=z}})},preConfirm:()=>{const y=document.getElementById(f),T=document.getElementById(p);return T&&(T.textContent=""),y&&y.value.trim()!==""?y.value.startsWith("오류:")||y.value.startsWith("실행 중 예외:")?(T&&(T.textContent="오류가 있는 결과는 복사할 수 없습니다."),!1):y.value:(T&&(T.textContent="메인 편집기에 복사할 결과가 없습니다."),!1)}})}async function rN(t){const{title:e="템플릿 선택",templates:n=[],message:r="",confirmButtonText:i="확인",cancelButtonText:o="취소",hotInstance:s,existingUserTemplateNames:a=[],customClass:l={}}=t;if(s&&typeof s.deselectCell=="function"&&s.deselectCell(),n.length===0)return await ye({title:e,text:"선택할 템플릿이 없습니다.",icon:"info",showCancelButton:!1,confirmButtonText:"닫기",hotInstance:s}),{isConfirmed:!1,selectedTemplates:[]};const u=n.map((f,g)=>{const C=!f.isDefault&&a.includes(f.name)?' <span class="popup-template-overwrite-indicator">(덮어씀)</span>':"";return{id:`template_checkbox_${g}_${Date.now()}`,label:`${Bn(f.name)} <span class="popup-template-type-indicator">(${Bn(f.type)})</span>${f.isDefault?' <span class="popup-template-default-indicator">[기본]</span>':""}${C}`,initialChecked:!0,originalTemplate:f}});let c='<form id="popup-template-selection-form" class="popup-template-selection-container">';r&&(c+=`<p class="popup-message">${Bn(r)}</p>`),u.forEach(f=>{c+=`<div class="popup-template-item">
                        <input type="checkbox" id="${f.id}" name="${f.id}" value="true" ${f.initialChecked?"checked":""} class="popup-checkbox">
                        <label for="${f.id}" class="popup-label-checkbox">${f.label}</label>
                     </div>`}),c+="</form>";const h={...l,popup:`popup-template-selection popup-basic-white-theme ${l.popup||""}`.trim()},d=await Tv({title:e,html:c,hotInstance:s,buttons:[{text:i,role:"confirm"},{text:o,role:"cancel"}],width:"45em",padding:"1.5em",customClass:h,preConfirm:()=>{const f=document.getElementById("popup-template-selection-form");return f?u.filter(g=>{var p;return(p=f.querySelector(`#${g.id}`))==null?void 0:p.checked}).map(g=>g.originalTemplate):[]}});return{isConfirmed:d.isConfirmed,selectedTemplates:d.isConfirmed&&Array.isArray(d.formData)?d.formData:[]}}async function Oj(t){const{templateName:e,templateValue:n,hotInstance:r,customClass:i={}}=t;r&&typeof r.deselectCell=="function"&&r.deselectCell();let o;try{const a=JSON.stringify(n,null,2);o=`<pre class="popup-template-content-pre">${Bn(a)}</pre>`}catch(a){o=`<p class="popup-error-message">템플릿 내용을 표시 중 오류: ${Bn(a.message)}</p>`}const s={...i,popup:`popup-template-content popup-basic-white-theme ${i.popup||""}`.trim(),htmlContainer:i.htmlContainer||"popup-html-container-spacing"};return ye({title:`${Bn(e)} - 내용`,html:o,icon:null,showCancelButton:!1,confirmButtonText:"닫기",customClass:s,hotInstance:r})}async function Aj(t){const{title:e="템플릿 관리",userTemplates:n=[],callbacks:r={},hotInstance:i,customClass:o={}}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();const s=l=>{if(l.length===0)return'<p class="popup-empty-message">관리할 사용자 정의 템플릿이 없습니다.</p>';let u='<div class="popup-template-management-list-container"><ul class="popup-list">';return l.forEach(c=>{const h=Bn(c.name),d=Bn(c.type);u+=`
                <li class="popup-list-item tm-list-item-hoverable">
                    <span class="popup-list-item-name" title="${h} (${d})">
                        ${h} <span class="popup-list-item-type">(${d})</span>
                    </span>
                    <span class="popup-list-item-actions">
                        <button type="button" class="swal2-styled swal2-styled-small tm-view-btn" data-template-name="${h}" title="내용 보기">내용 확인</button>
                        <button type="button" class="swal2-styled swal2-styled-small tm-rename-btn" data-template-name="${h}" title="이름 변경">이름 변경</button>
                        <button type="button" class="swal2-styled swal2-styled-small tm-delete-btn" data-template-name="${h}" title="삭제">삭제</button>
                    </span>
                </li>`}),u+="</ul></div>",u},a={...o,popup:`popup-template-management popup-basic-white-theme ${o.popup||""}`.trim(),htmlContainer:o.htmlContainer||"popup-html-container-spacing"};return Tv({title:e,html:s(n),hotInstance:i,width:"60em",padding:"1.5em",customClass:a,buttons:[{text:"닫기",role:"cancel"}],didOpen:l=>{l.addEventListener("click",u=>{const c=u.target.closest("button[data-template-name]");if(!c)return;const h=c.dataset.templateName;h&&(c.classList.contains("tm-view-btn")&&r.onViewRequest?r.onViewRequest(h):c.classList.contains("tm-rename-btn")&&r.onRenameRequest?r.onRenameRequest(h):c.classList.contains("tm-delete-btn")&&r.onDeleteRequest&&r.onDeleteRequest(h))})}})}const dt=document.getElementById("json-input"),We=document.getElementById("save-message"),ze=document.getElementById("json-error"),xt=document.getElementById("tree-view"),qS=document.getElementById("table-view");function Pt(t,e,n){t&&(t.textContent=e,setTimeout(()=>{t.textContent=""},n))}function Bc(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent&&a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(i.appendChild(document.createTextNode(o)),e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.style.color="var(--table-cell-text)",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));if(t&&t!==""){let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u;for(;(u=l.exec(t))!==null;){const c=u[0];let h=c;if(a===""?a=c:c.startsWith("[")?a+=c:a+="."+c,i.appendChild(document.createTextNode(" > ")),e){const d=document.createElement("a");d.href="#",d.textContent=h,d.style.textDecoration="underline",d.style.cursor="pointer",d.style.color="var(--table-cell-text)",d.onclick=(f=>g=>{g.preventDefault(),e(f)})(a),i.appendChild(d)}else i.appendChild(document.createTextNode(h))}}i.appendChild(document.createTextNode(s))}function Hj(){xt&&(xt.innerHTML=""),qS&&(qS.innerHTML=""),ze&&(ze.textContent=""),We&&(We.textContent=""),Bc(null,null)}function hu(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function XS(t,e){if(typeof t=="string"){const n=t.trim();if(n.toLowerCase()==="null")return null;if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1;if(n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,"")))return Number(n);if(n.startsWith("[")&&n.endsWith("]")||n.startsWith("{")&&n.endsWith("}"))try{return JSON.parse(n)}catch{return t}return t}return t}function iN(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let ql=null;function eh(t){ql&&ql.classList.remove("selected-node"),ql=t,ql&&ql.classList.add("selected-node")}function Nj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),eh(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),iN(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),eh(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function Dj(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),Tf(e,o,n,r.rootJsonData,r.depth+1,r),o}function Tf(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=Nj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=Dj(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function kj(){return ql?ql.dataset.path:null}function $j(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function Lj(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var Vg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ah=function(t){return t&&t.Math===Math&&t},Sn=Ah(typeof globalThis=="object"&&globalThis)||Ah(typeof window=="object"&&window)||Ah(typeof self=="object"&&self)||Ah(typeof Vg=="object"&&Vg)||Ah(typeof Vg=="object"&&Vg)||function(){return this}()||Function("return this")(),V0={},$n=function(t){try{return!!t()}catch{return!0}},Fj=$n,xi=!Fj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Vj=$n,Mv=!Vj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Bj=Mv,Bg=Function.prototype.call,Rn=Bj?Bg.bind(Bg):function(){return Bg.apply(Bg,arguments)},oN={},sN={}.propertyIsEnumerable,aN=Object.getOwnPropertyDescriptor,Wj=aN&&!sN.call({1:2},1);oN.f=Wj?function(e){var n=aN(this,e);return!!n&&n.enumerable}:sN;var _v=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},lN=Mv,uN=Function.prototype,JS=uN.call,jj=lN&&uN.bind.bind(JS,JS),mn=lN?jj:function(t){return function(){return JS.apply(t,arguments)}},cN=mn,Uj=cN({}.toString),zj=cN("".slice),Ru=function(t){return zj(Uj(t),8,-1)},Yj=mn,Gj=$n,Kj=Ru,Dy=Object,qj=Yj("".split),Xj=Gj(function(){return!Dy("z").propertyIsEnumerable(0)})?function(t){return Kj(t)==="String"?qj(t,""):Dy(t)}:Dy,B0=function(t){return t==null},Jj=B0,Zj=TypeError,rg=function(t){if(Jj(t))throw new Zj("Can't call method on "+t);return t},Qj=Xj,eU=rg,ig=function(t){return Qj(eU(t))},ky=typeof document=="object"&&document.all,En=typeof ky>"u"&&ky!==void 0?function(t){return typeof t=="function"||t===ky}:function(t){return typeof t=="function"},tU=En,Pi=function(t){return typeof t=="object"?t!==null:tU(t)},$y=Sn,nU=En,rU=function(t){return nU(t)?t:void 0},dh=function(t,e){return arguments.length<2?rU($y[t]):$y[t]&&$y[t][e]},iU=mn,og=iU({}.isPrototypeOf),oU=Sn,Ix=oU.navigator,Ox=Ix&&Ix.userAgent,xv=Ox?String(Ox):"",hN=Sn,Ly=xv,Ax=hN.process,Hx=hN.Deno,Nx=Ax&&Ax.versions||Hx&&Hx.version,Dx=Nx&&Nx.v8,no,Cw;Dx&&(no=Dx.split("."),Cw=no[0]>0&&no[0]<4?1:+(no[0]+no[1]));!Cw&&Ly&&(no=Ly.match(/Edge\/(\d+)/),(!no||no[1]>=74)&&(no=Ly.match(/Chrome\/(\d+)/),no&&(Cw=+no[1])));var sU=Cw,kx=sU,aU=$n,lU=Sn,uU=lU.String,W0=!!Object.getOwnPropertySymbols&&!aU(function(){var t=Symbol("symbol detection");return!uU(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&kx&&kx<41}),cU=W0,dN=cU&&!Symbol.sham&&typeof Symbol.iterator=="symbol",hU=dh,dU=En,fU=og,gU=dN,mU=Object,j0=gU?function(t){return typeof t=="symbol"}:function(t){var e=hU("Symbol");return dU(e)&&fU(e.prototype,mU(t))},pU=String,Pv=function(t){try{return pU(t)}catch{return"Object"}},wU=En,vU=Pv,yU=TypeError,Vr=function(t){if(wU(t))return t;throw new yU(vU(t)+" is not a function")},CU=Vr,bU=B0,sg=function(t,e){var n=t[e];return bU(n)?void 0:CU(n)},Fy=Rn,Vy=En,By=Pi,SU=TypeError,RU=function(t,e){var n,r;if(e==="string"&&Vy(n=t.toString)&&!By(r=Fy(n,t))||Vy(n=t.valueOf)&&!By(r=Fy(n,t))||e!=="string"&&Vy(n=t.toString)&&!By(r=Fy(n,t)))return r;throw new SU("Can't convert object to primitive value")},fN={exports:{}},$x=Sn,EU=Object.defineProperty,U0=function(t,e){try{EU($x,t,{value:e,configurable:!0,writable:!0})}catch{$x[t]=e}return e},TU=Sn,MU=U0,Lx="__core-js_shared__",Fx=fN.exports=TU[Lx]||MU(Lx,{});(Fx.versions||(Fx.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var z0=fN.exports,Vx=z0,gN=function(t,e){return Vx[t]||(Vx[t]=e||{})},_U=rg,xU=Object,fh=function(t){return xU(_U(t))},PU=mn,IU=fh,OU=PU({}.hasOwnProperty),Ii=Object.hasOwn||function(e,n){return OU(IU(e),n)},AU=mn,HU=0,NU=Math.random(),DU=AU(1 .toString),mN=function(t){return"Symbol("+(t===void 0?"":t)+")_"+DU(++HU+NU,36)},kU=Sn,$U=gN,Bx=Ii,LU=mN,FU=W0,VU=dN,Ac=kU.Symbol,Wy=$U("wks"),BU=VU?Ac.for||Ac:Ac&&Ac.withoutSetter||LU,co=function(t){return Bx(Wy,t)||(Wy[t]=FU&&Bx(Ac,t)?Ac[t]:BU("Symbol."+t)),Wy[t]},WU=Rn,Wx=Pi,jx=j0,jU=sg,UU=RU,zU=co,YU=TypeError,GU=zU("toPrimitive"),KU=function(t,e){if(!Wx(t)||jx(t))return t;var n=jU(t,GU),r;if(n){if(e===void 0&&(e="default"),r=WU(n,t,e),!Wx(r)||jx(r))return r;throw new YU("Can't convert object to primitive value")}return e===void 0&&(e="number"),UU(t,e)},qU=KU,XU=j0,pN=function(t){var e=qU(t,"string");return XU(e)?e:e+""},JU=Sn,Ux=Pi,ZS=JU.document,ZU=Ux(ZS)&&Ux(ZS.createElement),Y0=function(t){return ZU?ZS.createElement(t):{}},QU=xi,ez=$n,tz=Y0,wN=!QU&&!ez(function(){return Object.defineProperty(tz("div"),"a",{get:function(){return 7}}).a!==7}),nz=xi,rz=Rn,iz=oN,oz=_v,sz=ig,az=pN,lz=Ii,uz=wN,zx=Object.getOwnPropertyDescriptor;V0.f=nz?zx:function(e,n){if(e=sz(e),n=az(n),uz)try{return zx(e,n)}catch{}if(lz(e,n))return oz(!rz(iz.f,e,n),e[n])};var Js={},cz=xi,hz=$n,vN=cz&&hz(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),dz=Pi,fz=String,gz=TypeError,Tn=function(t){if(dz(t))return t;throw new gz(fz(t)+" is not an object")},mz=xi,pz=wN,wz=vN,Wg=Tn,Yx=pN,vz=TypeError,jy=Object.defineProperty,yz=Object.getOwnPropertyDescriptor,Uy="enumerable",zy="configurable",Yy="writable";Js.f=mz?wz?function(e,n,r){if(Wg(e),n=Yx(n),Wg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Yy in r&&!r[Yy]){var i=yz(e,n);i&&i[Yy]&&(e[n]=r.value,r={configurable:zy in r?r[zy]:i[zy],enumerable:Uy in r?r[Uy]:i[Uy],writable:!1})}return jy(e,n,r)}:jy:function(e,n,r){if(Wg(e),n=Yx(n),Wg(r),pz)try{return jy(e,n,r)}catch{}if("get"in r||"set"in r)throw new vz("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var Cz=xi,bz=Js,Sz=_v,gh=Cz?function(t,e,n){return bz.f(t,e,Sz(1,n))}:function(t,e,n){return t[e]=n,t},yN={exports:{}},QS=xi,Rz=Ii,CN=Function.prototype,Ez=QS&&Object.getOwnPropertyDescriptor,Tz=Rz(CN,"name"),Mz=Tz&&(!QS||QS&&Ez(CN,"name").configurable),_z={CONFIGURABLE:Mz},xz=mn,Pz=En,eR=z0,Iz=xz(Function.toString);Pz(eR.inspectSource)||(eR.inspectSource=function(t){return Iz(t)});var Oz=eR.inspectSource,Az=Sn,Hz=En,Gx=Az.WeakMap,Nz=Hz(Gx)&&/native code/.test(String(Gx)),Dz=gN,kz=mN,Kx=Dz("keys"),G0=function(t){return Kx[t]||(Kx[t]=kz(t))},K0={},$z=Nz,bN=Sn,Lz=Pi,Fz=gh,Gy=Ii,Ky=z0,Vz=G0,Bz=K0,qx="Object already initialized",tR=bN.TypeError,Wz=bN.WeakMap,bw,Mf,Sw,jz=function(t){return Sw(t)?Mf(t):bw(t,{})},Uz=function(t){return function(e){var n;if(!Lz(e)||(n=Mf(e)).type!==t)throw new tR("Incompatible receiver, "+t+" required");return n}};if($z||Ky.state){var po=Ky.state||(Ky.state=new Wz);po.get=po.get,po.has=po.has,po.set=po.set,bw=function(t,e){if(po.has(t))throw new tR(qx);return e.facade=t,po.set(t,e),e},Mf=function(t){return po.get(t)||{}},Sw=function(t){return po.has(t)}}else{var $u=Vz("state");Bz[$u]=!0,bw=function(t,e){if(Gy(t,$u))throw new tR(qx);return e.facade=t,Fz(t,$u,e),e},Mf=function(t){return Gy(t,$u)?t[$u]:{}},Sw=function(t){return Gy(t,$u)}}var SN={set:bw,get:Mf,has:Sw,enforce:jz,getterFor:Uz},q0=mn,zz=$n,Yz=En,jg=Ii,nR=xi,Gz=_z.CONFIGURABLE,Kz=Oz,RN=SN,qz=RN.enforce,Xz=RN.get,Xx=String,Ap=Object.defineProperty,Jz=q0("".slice),Zz=q0("".replace),Qz=q0([].join),eY=nR&&!zz(function(){return Ap(function(){},"length",{value:8}).length!==8}),tY=String(String).split("String"),nY=yN.exports=function(t,e,n){Jz(Xx(e),0,7)==="Symbol("&&(e="["+Zz(Xx(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!jg(t,"name")||Gz&&t.name!==e)&&(nR?Ap(t,"name",{value:e,configurable:!0}):t.name=e),eY&&n&&jg(n,"arity")&&t.length!==n.arity&&Ap(t,"length",{value:n.arity});try{n&&jg(n,"constructor")&&n.constructor?nR&&Ap(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=qz(t);return jg(r,"source")||(r.source=Qz(tY,typeof e=="string"?e:"")),t};Function.prototype.toString=nY(function(){return Yz(this)&&Xz(this).source||Kz(this)},"toString");var EN=yN.exports,rY=En,iY=Js,oY=EN,sY=U0,X0=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(rY(n)&&oY(n,o,r),r.global)i?t[e]=n:sY(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:iY.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},TN={},aY=Math.ceil,lY=Math.floor,uY=Math.trunc||function(e){var n=+e;return(n>0?lY:aY)(n)},cY=uY,ag=function(t){var e=+t;return e!==e||e===0?0:cY(e)},hY=ag,dY=Math.max,fY=Math.min,gY=function(t,e){var n=hY(t);return n<0?dY(n+e,0):fY(n,e)},mY=ag,pY=Math.min,wY=function(t){var e=mY(t);return e>0?pY(e,9007199254740991):0},vY=wY,mh=function(t){return vY(t.length)},yY=ig,CY=gY,bY=mh,SY=function(t){return function(e,n,r){var i=yY(e),o=bY(i);if(o===0)return!t&&-1;var s=CY(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},RY={indexOf:SY(!1)},EY=mn,qy=Ii,TY=ig,MY=RY.indexOf,_Y=K0,Jx=EY([].push),MN=function(t,e){var n=TY(t),r=0,i=[],o;for(o in n)!qy(_Y,o)&&qy(n,o)&&Jx(i,o);for(;e.length>r;)qy(n,o=e[r++])&&(~MY(i,o)||Jx(i,o));return i},J0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],xY=MN,PY=J0,IY=PY.concat("length","prototype");TN.f=Object.getOwnPropertyNames||function(e){return xY(e,IY)};var _N={};_N.f=Object.getOwnPropertySymbols;var OY=dh,AY=mn,HY=TN,NY=_N,DY=Tn,kY=AY([].concat),$Y=OY("Reflect","ownKeys")||function(e){var n=HY.f(DY(e)),r=NY.f;return r?kY(n,r(e)):n},Zx=Ii,LY=$Y,FY=V0,VY=Js,xN=function(t,e,n){for(var r=LY(e),i=VY.f,o=FY.f,s=0;s<r.length;s++){var a=r[s];!Zx(t,a)&&!(n&&Zx(n,a))&&i(t,a,o(e,a))}},BY=$n,WY=En,jY=/#|\.prototype\./,lg=function(t,e){var n=zY[UY(t)];return n===GY?!0:n===YY?!1:WY(e)?BY(e):!!e},UY=lg.normalize=function(t){return String(t).replace(jY,".").toLowerCase()},zY=lg.data={},YY=lg.NATIVE="N",GY=lg.POLYFILL="P",KY=lg,Ug=Sn,qY=V0.f,XY=gh,JY=X0,ZY=U0,QY=xN,eG=KY,Et=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Ug:i?s=Ug[n]||ZY(n,{}):s=Ug[n]&&Ug[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=qY(s,a),l=c&&c.value):l=s[a],o=eG(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;QY(u,l)}(t.sham||l&&l.sham)&&XY(u,"sham",!0),JY(s,a,u,t)}},tG=Mv,PN=Function.prototype,Qx=PN.apply,eP=PN.call,ug=typeof Reflect=="object"&&Reflect.apply||(tG?eP.bind(Qx):function(){return eP.apply(Qx,arguments)}),nG=mn,rG=Vr,IN=function(t,e,n){try{return nG(rG(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},iG=Pi,oG=function(t){return iG(t)||t===null},sG=oG,aG=String,lG=TypeError,uG=function(t){if(sG(t))return t;throw new lG("Can't set "+aG(t)+" as a prototype")},cG=IN,hG=Pi,dG=rg,fG=uG,ON=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=cG(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return dG(i),fG(o),hG(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),gG=Js.f,mG=function(t,e,n){n in t||gG(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},pG=En,wG=Pi,tP=ON,vG=function(t,e,n){var r,i;return tP&&pG(r=e.constructor)&&r!==n&&wG(i=r.prototype)&&i!==n.prototype&&tP(t,i),t},yG=co,CG=yG("toStringTag"),AN={};AN[CG]="z";var bG=String(AN)==="[object z]",SG=bG,RG=En,Hp=Ru,EG=co,TG=EG("toStringTag"),MG=Object,_G=Hp(function(){return arguments}())==="Arguments",xG=function(t,e){try{return t[e]}catch{}},HN=SG?Hp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=xG(e=MG(t),TG))=="string"?n:_G?Hp(e):(r=Hp(e))==="Object"&&RG(e.callee)?"Arguments":r},PG=HN,IG=String,Iv=function(t){if(PG(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return IG(t)},OG=Iv,AG=function(t,e){return t===void 0?arguments.length<2?"":e:OG(t)},HG=Pi,NG=gh,DG=function(t,e){HG(e)&&"cause"in e&&NG(t,"cause",e.cause)},kG=mn,NN=Error,$G=kG("".replace),LG=function(t){return String(new NN(t).stack)}("zxcasd"),DN=/\n\s*at [^:]*:[^\n]*/,FG=DN.test(LG),VG=function(t,e){if(FG&&typeof t=="string"&&!NN.prepareStackTrace)for(;e--;)t=$G(t,DN,"");return t},BG=$n,WG=_v,jG=!BG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",WG(1,7)),t.stack!==7):!0}),UG=gh,zG=VG,YG=jG,nP=Error.captureStackTrace,GG=function(t,e,n,r){YG&&(nP?nP(t,e):UG(t,"stack",zG(n,r)))},rP=dh,KG=Ii,iP=gh,qG=og,oP=ON,sP=xN,aP=mG,XG=vG,JG=AG,ZG=DG,QG=GG,eK=xi,tK=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=rP.apply(null,s);if(l){var u=l.prototype;if(KG(u,"cause")&&delete u.cause,!n)return l;var c=rP("Error"),h=e(function(d,f){var g=JG(r?f:d,void 0),p=r?new l(d):new l;return g!==void 0&&iP(p,"message",g),QG(p,h,p.stack,2),this&&qG(u,this)&&XG(p,this,h),arguments.length>o&&ZG(p,arguments[o]),p});h.prototype=u,a!=="Error"?oP?oP(h,c):sP(h,c,{name:!0}):eK&&i in l&&(aP(h,l,i),aP(h,l,"prepareStackTrace")),sP(h,l);try{u.name!==a&&iP(u,"name",a),u.constructor=h}catch{}return h}},kN=Et,nK=Sn,ts=ug,$N=tK,rR="WebAssembly",lP=nK[rR],Rw=new Error("e",{cause:7}).cause!==7,Eu=function(t,e){var n={};n[t]=$N(t,e,Rw),kN({global:!0,constructor:!0,arity:1,forced:Rw},n)},Z0=function(t,e){if(lP&&lP[t]){var n={};n[t]=$N(rR+"."+t,e,Rw),kN({target:rR,stat:!0,constructor:!0,arity:1,forced:Rw},n)}};Eu("Error",function(t){return function(n){return ts(t,this,arguments)}});Eu("EvalError",function(t){return function(n){return ts(t,this,arguments)}});Eu("RangeError",function(t){return function(n){return ts(t,this,arguments)}});Eu("ReferenceError",function(t){return function(n){return ts(t,this,arguments)}});Eu("SyntaxError",function(t){return function(n){return ts(t,this,arguments)}});Eu("TypeError",function(t){return function(n){return ts(t,this,arguments)}});Eu("URIError",function(t){return function(n){return ts(t,this,arguments)}});Z0("CompileError",function(t){return function(n){return ts(t,this,arguments)}});Z0("LinkError",function(t){return function(n){return ts(t,this,arguments)}});Z0("RuntimeError",function(t){return function(n){return ts(t,this,arguments)}});var rK=Ru,LN=Array.isArray||function(e){return rK(e)==="Array"},iK=xi,oK=LN,sK=TypeError,aK=Object.getOwnPropertyDescriptor,lK=iK&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),FN=lK?function(t,e){if(oK(t)&&!aK(t,"length").writable)throw new sK("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},uK=TypeError,cK=9007199254740991,VN=function(t){if(t>cK)throw uK("Maximum allowed index exceeded");return t},hK=Et,dK=fh,fK=mh,gK=FN,mK=VN,pK=$n,wK=pK(function(){return[].push.call({length:4294967296},1)!==4294967297}),vK=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},yK=wK||!vK();hK({target:"Array",proto:!0,arity:1,forced:yK},{push:function(e){var n=dK(this),r=fK(n),i=arguments.length;mK(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return gK(n,r),r}});var CK=Ru,bK=mn,SK=function(t){if(CK(t)==="Function")return bK(t)},uP=SK,RK=Vr,EK=Mv,TK=uP(uP.bind),BN=function(t,e){return RK(t),e===void 0?t:EK?TK(t,e):function(){return t.apply(e,arguments)}},WN={},MK=co,_K=WN,xK=MK("iterator"),PK=Array.prototype,IK=function(t){return t!==void 0&&(_K.Array===t||PK[xK]===t)},OK=HN,cP=sg,AK=B0,HK=WN,NK=co,DK=NK("iterator"),Q0=function(t){if(!AK(t))return cP(t,DK)||cP(t,"@@iterator")||HK[OK(t)]},kK=Rn,$K=Vr,LK=Tn,FK=Pv,VK=Q0,BK=TypeError,WK=function(t,e){var n=arguments.length<2?VK(t):e;if($K(n))return LK(kK(n,t));throw new BK(FK(t)+" is not iterable")},jK=Rn,hP=Tn,UK=sg,oi=function(t,e,n){var r,i;hP(t);try{if(r=UK(t,"return"),!r){if(e==="throw")throw n;return n}r=jK(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return hP(r),n},zK=BN,YK=Rn,GK=Tn,KK=Pv,qK=IK,XK=mh,dP=og,JK=WK,ZK=Q0,fP=oi,QK=TypeError,Np=function(t,e){this.stopped=t,this.result=e},gP=Np.prototype,ph=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=zK(e,r),u,c,h,d,f,g,p,C=function(y){return u&&fP(u,"normal",y),new Np(!0,y)},E=function(y){return i?(GK(y),a?l(y[0],y[1],C):l(y[0],y[1])):a?l(y,C):l(y)};if(o)u=t.iterator;else if(s)u=t;else{if(c=ZK(t),!c)throw new QK(KK(t)+" is not iterable");if(qK(c)){for(h=0,d=XK(t);d>h;h++)if(f=E(t[h]),f&&dP(gP,f))return f;return new Np(!1)}u=JK(t,c)}for(g=o?t.next:u.next;!(p=YK(g,u)).done;){try{f=E(p.value)}catch(y){fP(u,"throw",y)}if(typeof f=="object"&&f&&dP(gP,f))return f}return new Np(!1)},e3=xi,t3=Js,n3=_v,jN=function(t,e,n){e3?t3.f(t,e,n3(0,n)):t[e]=n},r3=Et,i3=ph,o3=jN;r3({target:"Object",stat:!0},{fromEntries:function(e){var n={};return i3(e,function(r,i){o3(n,r,i)},{AS_ENTRIES:!0}),n}});var Xy=mn,zg=Set.prototype,ns={Set,add:Xy(zg.add),has:Xy(zg.has),remove:Xy(zg.delete),proto:zg},s3=ns.has,Tu=function(t){return s3(t),t},a3=Rn,Mu=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=a3(i,r)).done;)if(s=e(o.value),s!==void 0)return s},UN=mn,l3=Mu,zN=ns,u3=zN.Set,YN=zN.proto,c3=UN(YN.forEach),GN=UN(YN.keys),h3=GN(new u3).next,cg=function(t,e,n){return n?l3({iterator:GN(t),next:h3},e):c3(t,e)},KN=ns,d3=cg,f3=KN.Set,g3=KN.add,eE=function(t){var e=new f3;return d3(t,function(n){g3(e,n)}),e},m3=IN,p3=ns,hg=m3(p3.proto,"size","get")||function(t){return t.size},rs=function(t){return{iterator:t,next:t.next,done:!1}},mP=Vr,qN=Tn,pP=Rn,w3=ag,v3=rs,wP="Invalid size",y3=RangeError,C3=TypeError,b3=Math.max,XN=function(t,e){this.set=t,this.size=b3(e,0),this.has=mP(t.has),this.keys=mP(t.keys)};XN.prototype={getIterator:function(){return v3(qN(pP(this.keys,this.set)))},includes:function(t){return pP(this.has,this.set,t)}};var _u=function(t){qN(t);var e=+t.size;if(e!==e)throw new C3(wP);var n=w3(e);if(n<0)throw new y3(wP);return new XN(t,n)},S3=Tu,JN=ns,R3=eE,E3=hg,T3=_u,M3=cg,_3=Mu,x3=JN.has,vP=JN.remove,P3=function(e){var n=S3(this),r=T3(e),i=R3(n);return E3(n)<=r.size?M3(n,function(o){r.includes(o)&&vP(i,o)}):_3(r.getIterator(),function(o){x3(n,o)&&vP(i,o)}),i},I3=dh,yP=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},CP=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},xu=function(t,e){var n=I3("Set");try{new n()[t](yP(0));try{return new n()[t](yP(-1)),!1}catch{if(!e)return!0;try{return new n()[t](CP(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](CP(1/0)))}}}catch{return!1}},O3=Et,A3=P3,H3=xu,N3=!H3("difference",function(t){return t.size===0});O3({target:"Set",proto:!0,real:!0,forced:N3},{difference:A3});var D3=Tu,tE=ns,k3=hg,$3=_u,L3=cg,F3=Mu,V3=tE.Set,bP=tE.add,B3=tE.has,W3=function(e){var n=D3(this),r=$3(e),i=new V3;return k3(n)>r.size?F3(r.getIterator(),function(o){B3(n,o)&&bP(i,o)}):L3(n,function(o){r.includes(o)&&bP(i,o)}),i},j3=Et,U3=$n,z3=W3,Y3=xu,G3=!Y3("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||U3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});j3({target:"Set",proto:!0,real:!0,forced:G3},{intersection:z3});var K3=Tu,q3=ns.has,X3=hg,J3=_u,Z3=cg,Q3=Mu,e5=oi,t5=function(e){var n=K3(this),r=J3(e);if(X3(n)<=r.size)return Z3(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return Q3(i,function(o){if(q3(n,o))return e5(i,"normal",!1)})!==!1},n5=Et,r5=t5,i5=xu,o5=!i5("isDisjointFrom",function(t){return!t});n5({target:"Set",proto:!0,real:!0,forced:o5},{isDisjointFrom:r5});var s5=Tu,a5=hg,l5=cg,u5=_u,c5=function(e){var n=s5(this),r=u5(e);return a5(n)>r.size?!1:l5(n,function(i){if(!r.includes(i))return!1},!0)!==!1},h5=Et,d5=c5,f5=xu,g5=!f5("isSubsetOf",function(t){return t});h5({target:"Set",proto:!0,real:!0,forced:g5},{isSubsetOf:d5});var m5=Tu,p5=ns.has,w5=hg,v5=_u,y5=Mu,C5=oi,b5=function(e){var n=m5(this),r=v5(e);if(w5(n)<r.size)return!1;var i=r.getIterator();return y5(i,function(o){if(!p5(n,o))return C5(i,"normal",!1)})!==!1},S5=Et,R5=b5,E5=xu,T5=!E5("isSupersetOf",function(t){return!t});S5({target:"Set",proto:!0,real:!0,forced:T5},{isSupersetOf:R5});var M5=Tu,nE=ns,_5=eE,x5=_u,P5=Mu,I5=nE.add,O5=nE.has,A5=nE.remove,H5=function(e){var n=M5(this),r=x5(e).getIterator(),i=_5(n);return P5(r,function(o){O5(n,o)?A5(i,o):I5(i,o)}),i},N5=Et,D5=H5,k5=xu;N5({target:"Set",proto:!0,real:!0,forced:!k5("symmetricDifference")},{symmetricDifference:D5});var $5=Tu,L5=ns.add,F5=eE,V5=_u,B5=Mu,W5=function(e){var n=$5(this),r=V5(e).getIterator(),i=F5(n);return B5(r,function(o){L5(i,o)}),i},j5=Et,U5=W5,z5=xu;j5({target:"Set",proto:!0,real:!0,forced:!z5("union")},{union:U5});var Y5=og,G5=TypeError,K5=function(t,e){if(Y5(e,t))return t;throw new G5("Incorrect invocation")},q5=$n,X5=!q5(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),J5=Ii,Z5=En,Q5=fh,eq=G0,tq=X5,SP=eq("IE_PROTO"),iR=Object,nq=iR.prototype,ZN=tq?iR.getPrototypeOf:function(t){var e=Q5(t);if(J5(e,SP))return e[SP];var n=e.constructor;return Z5(n)&&e instanceof n?n.prototype:e instanceof iR?nq:null},RP=EN,rq=Js,iq=function(t,e,n){return n.get&&RP(n.get,e,{getter:!0}),n.set&&RP(n.set,e,{setter:!0}),rq.f(t,e,n)},QN={},oq=MN,sq=J0,aq=Object.keys||function(e){return oq(e,sq)},lq=xi,uq=vN,cq=Js,hq=Tn,dq=ig,fq=aq;QN.f=lq&&!uq?Object.defineProperties:function(e,n){hq(e);for(var r=dq(n),i=fq(n),o=i.length,s=0,a;o>s;)cq.f(e,a=i[s++],r[a]);return e};var gq=dh,eD=gq("document","documentElement"),mq=Tn,pq=QN,EP=J0,wq=K0,vq=eD,yq=Y0,Cq=G0,TP=">",MP="<",oR="prototype",sR="script",tD=Cq("IE_PROTO"),Jy=function(){},nD=function(t){return MP+sR+TP+t+MP+"/"+sR+TP},_P=function(t){t.write(nD("")),t.close();var e=t.parentWindow.Object;return t=null,e},bq=function(){var t=yq("iframe"),e="java"+sR+":",n;return t.style.display="none",vq.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(nD("document.F=Object")),n.close(),n.F},Yg,Dp=function(){try{Yg=new ActiveXObject("htmlfile")}catch{}Dp=typeof document<"u"?document.domain&&Yg?_P(Yg):bq():_P(Yg);for(var t=EP.length;t--;)delete Dp[oR][EP[t]];return Dp()};wq[tD]=!0;var rD=Object.create||function(e,n){var r;return e!==null?(Jy[oR]=mq(e),r=new Jy,Jy[oR]=null,r[tD]=e):r=Dp(),n===void 0?r:pq.f(r,n)},Sq=$n,Rq=En,Eq=Pi,xP=ZN,Tq=X0,Mq=co,aR=Mq("iterator"),du,Zy,Qy;[].keys&&(Qy=[].keys(),"next"in Qy&&(Zy=xP(xP(Qy)),Zy!==Object.prototype&&(du=Zy)));var _q=!Eq(du)||Sq(function(){var t={};return du[aR].call(t)!==t});_q&&(du={});Rq(du[aR])||Tq(du,aR,function(){return this});var iD={IteratorPrototype:du},xq=Et,Pq=Sn,Iq=K5,Oq=Tn,Aq=En,Hq=ZN,Nq=iq,Dq=jN,kq=$n,rE=Ii,$q=co,qo=iD.IteratorPrototype,Lq=xi,eC="constructor",oD="Iterator",PP=$q("toStringTag"),sD=TypeError,tC=Pq[oD],aD=!Aq(tC)||tC.prototype!==qo||!kq(function(){tC({})}),iE=function(){if(Iq(this,qo),Hq(this)===qo)throw new sD("Abstract class Iterator not directly constructable")},lD=function(t,e){Lq?Nq(qo,t,{configurable:!0,get:function(){return e},set:function(n){if(Oq(this),this===qo)throw new sD("You can't redefine this property");rE(this,t)?this[t]=n:Dq(this,t,n)}}):qo[t]=e};rE(qo,PP)||lD(PP,oD);(aD||!rE(qo,eC)||qo[eC]===Object)&&lD(eC,iE);iE.prototype=qo;xq({global:!0,constructor:!0,forced:aD},{Iterator:iE});var Fq=X0,Vq=function(t,e,n){for(var r in e)Fq(t,r,e[r],n);return t},Bq=function(t,e){return{value:t,done:e}},Wq=Rn,jq=rD,Uq=gh,zq=Vq,Yq=co,uD=SN,Gq=sg,Kq=iD.IteratorPrototype,Gg=Bq,nC=oi,qq=Yq("toStringTag"),cD="IteratorHelper",hD="WrapForValidIterator",Xq=uD.set,dD=function(t){var e=uD.getterFor(t?hD:cD);return zq(jq(Kq),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return Gg(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:Gg(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=Gq(r,"return");return i?Wq(i,r):Gg(void 0,!0)}if(n.inner)try{nC(n.inner.iterator,"normal")}catch(o){return nC(r,"throw",o)}return r&&nC(r,"normal"),Gg(void 0,!0)}})},Jq=dD(!0),fD=dD(!1);Uq(fD,qq,"Iterator Helper");var oE=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?hD:cD,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,Xq(this,s)};return r.prototype=e?Jq:fD,r},Zq=Tn,Qq=oi,gD=function(t,e,n,r){try{return r?e(Zq(n)[0],n[1]):e(n)}catch(i){Qq(t,"throw",i)}},e4=Sn,Qa=function(t,e){var n=e4.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},t4=Et,mD=Rn,n4=Vr,pD=Tn,r4=rs,i4=oE,o4=gD,s4=oi,a4=Qa,rC=a4("filter",TypeError),l4=i4(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=pD(mD(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,o4(t,e,[o,this.counter++],!0))return o}});t4({target:"Iterator",proto:!0,real:!0,forced:rC},{filter:function(e){pD(this);try{n4(e)}catch(n){s4(this,"throw",n)}return rC?mD(rC,this,e):new l4(r4(this),{predicate:e})}});var u4=Et,c4=Rn,h4=ph,d4=Vr,f4=Tn,g4=rs,m4=oi,p4=Qa,iC=p4("forEach",TypeError);u4({target:"Iterator",proto:!0,real:!0,forced:iC},{forEach:function(e){f4(this);try{d4(e)}catch(i){m4(this,"throw",i)}if(iC)return c4(iC,this,e);var n=g4(this),r=0;h4(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var w4=Et,wD=Rn,v4=Vr,vD=Tn,y4=rs,C4=oE,b4=gD,S4=oi,R4=Qa,oC=R4("map",TypeError),E4=C4(function(){var t=this.iterator,e=vD(wD(this.next,t)),n=this.done=!!e.done;if(!n)return b4(t,this.mapper,[e.value,this.counter++],!0)});w4({target:"Iterator",proto:!0,real:!0,forced:oC},{map:function(e){vD(this);try{v4(e)}catch(n){S4(this,"throw",n)}return oC?wD(oC,this,e):new E4(y4(this),{mapper:e})}});var T4=mn,sE=T4([].slice),M4=TypeError,yD=function(t,e){if(t<e)throw new M4("Not enough arguments");return t},_4=xv,x4=/(?:ipad|iphone|ipod).*applewebkit/i.test(_4),Hh=Sn,P4=xv,I4=Ru,Kg=function(t){return P4.slice(0,t.length)===t},CD=function(){return Kg("Bun/")?"BUN":Kg("Cloudflare-Workers")?"CLOUDFLARE":Kg("Deno/")?"DENO":Kg("Node.js/")?"NODE":Hh.Bun&&typeof Bun.version=="string"?"BUN":Hh.Deno&&typeof Deno.version=="object"?"DENO":I4(Hh.process)==="process"?"NODE":Hh.window&&Hh.document?"BROWSER":"REST"}(),O4=CD,A4=O4==="NODE",ti=Sn,H4=ug,N4=BN,IP=En,D4=Ii,bD=$n,OP=eD,k4=sE,AP=Y0,$4=yD,L4=x4,F4=A4,lR=ti.setImmediate,uR=ti.clearImmediate,V4=ti.process,sC=ti.Dispatch,B4=ti.Function,HP=ti.MessageChannel,W4=ti.String,aC=0,Gd={},NP="onreadystatechange",_f,ol,lC,uC;bD(function(){_f=ti.location});var aE=function(t){if(D4(Gd,t)){var e=Gd[t];delete Gd[t],e()}},cC=function(t){return function(){aE(t)}},DP=function(t){aE(t.data)},kP=function(t){ti.postMessage(W4(t),_f.protocol+"//"+_f.host)};(!lR||!uR)&&(lR=function(e){$4(arguments.length,1);var n=IP(e)?e:B4(e),r=k4(arguments,1);return Gd[++aC]=function(){H4(n,void 0,r)},ol(aC),aC},uR=function(e){delete Gd[e]},F4?ol=function(t){V4.nextTick(cC(t))}:sC&&sC.now?ol=function(t){sC.now(cC(t))}:HP&&!L4?(lC=new HP,uC=lC.port2,lC.port1.onmessage=DP,ol=N4(uC.postMessage,uC)):ti.addEventListener&&IP(ti.postMessage)&&!ti.importScripts&&_f&&_f.protocol!=="file:"&&!bD(kP)?(ol=kP,ti.addEventListener("message",DP,!1)):NP in AP("script")?ol=function(t){OP.appendChild(AP("script"))[NP]=function(){OP.removeChild(this),aE(t)}}:ol=function(t){setTimeout(cC(t),0)});var SD={set:lR,clear:uR},j4=Et,U4=Sn,$P=SD.clear;j4({global:!0,bind:!0,enumerable:!0,forced:U4.clearImmediate!==$P},{clearImmediate:$P});var RD=Sn,z4=ug,Y4=En,G4=CD,K4=xv,q4=sE,X4=yD,J4=RD.Function,Z4=/MSIE .\./.test(K4)||G4==="BUN"&&function(){var t=RD.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),Q4=function(t,e){var n=e?2:1;return Z4?function(r,i){var o=X4(arguments.length,1)>n,s=Y4(r)?r:J4(r),a=o?q4(arguments,n):[],l=o?function(){z4(s,this,a)}:s;return e?t(l,i):t(l)}:t},eX=Et,ED=Sn,LP=SD.set,tX=Q4,FP=ED.setImmediate?tX(LP,!1):LP;eX({global:!0,bind:!0,enumerable:!0,forced:ED.setImmediate!==FP},{setImmediate:FP});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:TD,setPrototypeOf:VP,isFrozen:nX,getPrototypeOf:rX,getOwnPropertyDescriptor:iX}=Object;let{freeze:pr,seal:Mi,create:MD}=Object,{apply:cR,construct:hR}=typeof Reflect<"u"&&Reflect;pr||(pr=function(e){return e});Mi||(Mi=function(e){return e});cR||(cR=function(e,n,r){return e.apply(n,r)});hR||(hR=function(e,n){return new e(...n)});const qg=wr(Array.prototype.forEach),oX=wr(Array.prototype.lastIndexOf),BP=wr(Array.prototype.pop),Nh=wr(Array.prototype.push),sX=wr(Array.prototype.splice),kp=wr(String.prototype.toLowerCase),hC=wr(String.prototype.toString),WP=wr(String.prototype.match),Dh=wr(String.prototype.replace),aX=wr(String.prototype.indexOf),lX=wr(String.prototype.trim),zi=wr(Object.prototype.hasOwnProperty),or=wr(RegExp.prototype.test),kh=uX(TypeError);function wr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return cR(t,e,r)}}function uX(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hR(t,n)}}function Ke(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:kp;VP&&VP(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(nX(e)||(e[r]=o),i=o)}t[i]=!0}return t}function cX(t){for(let e=0;e<t.length;e++)zi(t,e)||(t[e]=null);return t}function zl(t){const e=MD(null);for(const[n,r]of TD(t))zi(t,n)&&(Array.isArray(r)?e[n]=cX(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=zl(r):e[n]=r);return e}function $h(t,e){for(;t!==null;){const r=iX(t,e);if(r){if(r.get)return wr(r.get);if(typeof r.value=="function")return wr(r.value)}t=rX(t)}function n(){return null}return n}const jP=pr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dC=pr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fC=pr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),hX=pr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),gC=pr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),dX=pr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),UP=pr(["#text"]),zP=pr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),mC=pr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),YP=pr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Xg=pr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),fX=Mi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),gX=Mi(/<%[\w\W]*|[\w\W]*%>/gm),mX=Mi(/\$\{[\w\W]*/gm),pX=Mi(/^data-[\-\w.\u00B7-\uFFFF]+$/),wX=Mi(/^aria-[\-\w]+$/),_D=Mi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),vX=Mi(/^(?:\w+script|data):/i),yX=Mi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),xD=Mi(/^html$/i),CX=Mi(/^[a-z][.\w]*(-[.\w]+)+$/i);var GP=Object.freeze({__proto__:null,ARIA_ATTR:wX,ATTR_WHITESPACE:yX,CUSTOM_ELEMENT:CX,DATA_ATTR:pX,DOCTYPE_NAME:xD,ERB_EXPR:gX,IS_ALLOWED_URI:_D,IS_SCRIPT_OR_DATA:vX,MUSTACHE_EXPR:fX,TMPLIT_EXPR:mX});const Lh={element:1,text:3,progressingInstruction:7,comment:8,document:9},bX=function(){return typeof window>"u"?null:window},SX=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},KP=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function PD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bX();const e=be=>PD(be);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==Lh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,p=$h(g,"cloneNode"),C=$h(g,"remove"),E=$h(g,"nextSibling"),y=$h(g,"childNodes"),T=$h(g,"parentNode");if(typeof s=="function"){const be=n.createElement("template");be.content&&be.content.ownerDocument&&(n=be.content.ownerDocument)}let _,I="";const{implementation:M,createNodeIterator:P,createDocumentFragment:z,getElementsByTagName:W}=n,{importNode:V}=r;let q=KP();e.isSupported=typeof TD=="function"&&typeof T=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Z,ERB_EXPR:ee,TMPLIT_EXPR:te,DATA_ATTR:ce,ARIA_ATTR:je,IS_SCRIPT_OR_DATA:we,ATTR_WHITESPACE:Ae,CUSTOM_ELEMENT:ot}=GP;let{IS_ALLOWED_URI:wn}=GP,Ue=null;const m=Ke({},[...jP,...dC,...fC,...gC,...UP]);let v=null;const w=Ke({},[...zP,...mC,...YP,...Xg]);let A=Object.seal(MD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,U=null,K=!0,J=!0,b=!1,R=!0,S=!1,$=!0,O=!1,N=!1,j=!1,H=!1,D=!1,B=!1,F=!0,G=!1;const ae="user-content-";let he=!0,xe=!1,Be={},Je=null;const _e=Ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ye=null;const At=Ke({},["audio","video","img","source","image","track"]);let Di=null;const ls=Ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ai="http://www.w3.org/1998/Math/MathML",Ht="http://www.w3.org/2000/svg",vn="http://www.w3.org/1999/xhtml";let Tt=vn,Nt=!1,Ge=null;const li=Ke({},[ai,Ht,vn],hC);let nl=Ke({},["mi","mo","mn","ms","mtext"]),rl=Ke({},["annotation-xml"]);const XV=Ke({},["title","style","font","a","script"]);let xh=null;const JV=["application/xhtml+xml","text/html"],ZV="text/html";let An=null,ku=null;const QV=n.createElement("form"),tx=function(k){return k instanceof RegExp||k instanceof Function},Iy=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ku&&ku===k)){if((!k||typeof k!="object")&&(k={}),k=zl(k),xh=JV.indexOf(k.PARSER_MEDIA_TYPE)===-1?ZV:k.PARSER_MEDIA_TYPE,An=xh==="application/xhtml+xml"?hC:kp,Ue=zi(k,"ALLOWED_TAGS")?Ke({},k.ALLOWED_TAGS,An):m,v=zi(k,"ALLOWED_ATTR")?Ke({},k.ALLOWED_ATTR,An):w,Ge=zi(k,"ALLOWED_NAMESPACES")?Ke({},k.ALLOWED_NAMESPACES,hC):li,Di=zi(k,"ADD_URI_SAFE_ATTR")?Ke(zl(ls),k.ADD_URI_SAFE_ATTR,An):ls,Ye=zi(k,"ADD_DATA_URI_TAGS")?Ke(zl(At),k.ADD_DATA_URI_TAGS,An):At,Je=zi(k,"FORBID_CONTENTS")?Ke({},k.FORBID_CONTENTS,An):_e,L=zi(k,"FORBID_TAGS")?Ke({},k.FORBID_TAGS,An):{},U=zi(k,"FORBID_ATTR")?Ke({},k.FORBID_ATTR,An):{},Be=zi(k,"USE_PROFILES")?k.USE_PROFILES:!1,K=k.ALLOW_ARIA_ATTR!==!1,J=k.ALLOW_DATA_ATTR!==!1,b=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=k.SAFE_FOR_TEMPLATES||!1,$=k.SAFE_FOR_XML!==!1,O=k.WHOLE_DOCUMENT||!1,H=k.RETURN_DOM||!1,D=k.RETURN_DOM_FRAGMENT||!1,B=k.RETURN_TRUSTED_TYPE||!1,j=k.FORCE_BODY||!1,F=k.SANITIZE_DOM!==!1,G=k.SANITIZE_NAMED_PROPS||!1,he=k.KEEP_CONTENT!==!1,xe=k.IN_PLACE||!1,wn=k.ALLOWED_URI_REGEXP||_D,Tt=k.NAMESPACE||vn,nl=k.MATHML_TEXT_INTEGRATION_POINTS||nl,rl=k.HTML_INTEGRATION_POINTS||rl,A=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&tx(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(A.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&tx(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(A.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(A.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(J=!1),D&&(H=!0),Be&&(Ue=Ke({},UP),v=[],Be.html===!0&&(Ke(Ue,jP),Ke(v,zP)),Be.svg===!0&&(Ke(Ue,dC),Ke(v,mC),Ke(v,Xg)),Be.svgFilters===!0&&(Ke(Ue,fC),Ke(v,mC),Ke(v,Xg)),Be.mathMl===!0&&(Ke(Ue,gC),Ke(v,YP),Ke(v,Xg))),k.ADD_TAGS&&(Ue===m&&(Ue=zl(Ue)),Ke(Ue,k.ADD_TAGS,An)),k.ADD_ATTR&&(v===w&&(v=zl(v)),Ke(v,k.ADD_ATTR,An)),k.ADD_URI_SAFE_ATTR&&Ke(Di,k.ADD_URI_SAFE_ATTR,An),k.FORBID_CONTENTS&&(Je===_e&&(Je=zl(Je)),Ke(Je,k.FORBID_CONTENTS,An)),he&&(Ue["#text"]=!0),O&&Ke(Ue,["html","head","body"]),Ue.table&&(Ke(Ue,["tbody"]),delete L.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw kh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw kh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=k.TRUSTED_TYPES_POLICY,I=_.createHTML("")}else _===void 0&&(_=SX(f,i)),_!==null&&typeof I=="string"&&(I=_.createHTML(""));pr&&pr(k),ku=k}},nx=Ke({},[...dC,...fC,...hX]),rx=Ke({},[...gC,...dX]),eB=function(k){let re=T(k);(!re||!re.tagName)&&(re={namespaceURI:Tt,tagName:"template"});const pe=kp(k.tagName),Bt=kp(re.tagName);return Ge[k.namespaceURI]?k.namespaceURI===Ht?re.namespaceURI===vn?pe==="svg":re.namespaceURI===ai?pe==="svg"&&(Bt==="annotation-xml"||nl[Bt]):!!nx[pe]:k.namespaceURI===ai?re.namespaceURI===vn?pe==="math":re.namespaceURI===Ht?pe==="math"&&rl[Bt]:!!rx[pe]:k.namespaceURI===vn?re.namespaceURI===Ht&&!rl[Bt]||re.namespaceURI===ai&&!nl[Bt]?!1:!rx[pe]&&(XV[pe]||!nx[pe]):!!(xh==="application/xhtml+xml"&&Ge[k.namespaceURI]):!1},go=function(k){Nh(e.removed,{element:k});try{T(k).removeChild(k)}catch{C(k)}},$g=function(k,re){try{Nh(e.removed,{attribute:re.getAttributeNode(k),from:re})}catch{Nh(e.removed,{attribute:null,from:re})}if(re.removeAttribute(k),k==="is")if(H||D)try{go(re)}catch{}else try{re.setAttribute(k,"")}catch{}},ix=function(k){let re=null,pe=null;if(j)k="<remove></remove>"+k;else{const Ln=WP(k,/^[\r\n\t ]+/);pe=Ln&&Ln[0]}xh==="application/xhtml+xml"&&Tt===vn&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const Bt=_?_.createHTML(k):k;if(Tt===vn)try{re=new d().parseFromString(Bt,xh)}catch{}if(!re||!re.documentElement){re=M.createDocument(Tt,"template",null);try{re.documentElement.innerHTML=Nt?I:Bt}catch{}}const Un=re.body||re.documentElement;return k&&pe&&Un.insertBefore(n.createTextNode(pe),Un.childNodes[0]||null),Tt===vn?W.call(re,O?"html":"body")[0]:O?re.documentElement:Un},ox=function(k){return P.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Oy=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},sx=function(k){return typeof a=="function"&&k instanceof a};function us(be,k,re){qg(be,pe=>{pe.call(e,k,re,ku)})}const ax=function(k){let re=null;if(us(q.beforeSanitizeElements,k,null),Oy(k))return go(k),!0;const pe=An(k.nodeName);if(us(q.uponSanitizeElement,k,{tagName:pe,allowedTags:Ue}),k.hasChildNodes()&&!sx(k.firstElementChild)&&or(/<[/\w!]/g,k.innerHTML)&&or(/<[/\w!]/g,k.textContent)||k.nodeType===Lh.progressingInstruction||$&&k.nodeType===Lh.comment&&or(/<[/\w]/g,k.data))return go(k),!0;if(!Ue[pe]||L[pe]){if(!L[pe]&&ux(pe)&&(A.tagNameCheck instanceof RegExp&&or(A.tagNameCheck,pe)||A.tagNameCheck instanceof Function&&A.tagNameCheck(pe)))return!1;if(he&&!Je[pe]){const Bt=T(k)||k.parentNode,Un=y(k)||k.childNodes;if(Un&&Bt){const Ln=Un.length;for(let Cr=Ln-1;Cr>=0;--Cr){const mo=p(Un[Cr],!0);mo.__removalCount=(k.__removalCount||0)+1,Bt.insertBefore(mo,E(k))}}}return go(k),!0}return k instanceof l&&!eB(k)||(pe==="noscript"||pe==="noembed"||pe==="noframes")&&or(/<\/no(script|embed|frames)/i,k.innerHTML)?(go(k),!0):(S&&k.nodeType===Lh.text&&(re=k.textContent,qg([Z,ee,te],Bt=>{re=Dh(re,Bt," ")}),k.textContent!==re&&(Nh(e.removed,{element:k.cloneNode()}),k.textContent=re)),us(q.afterSanitizeElements,k,null),!1)},lx=function(k,re,pe){if(F&&(re==="id"||re==="name")&&(pe in n||pe in QV))return!1;if(!(J&&!U[re]&&or(ce,re))){if(!(K&&or(je,re))){if(!v[re]||U[re]){if(!(ux(k)&&(A.tagNameCheck instanceof RegExp&&or(A.tagNameCheck,k)||A.tagNameCheck instanceof Function&&A.tagNameCheck(k))&&(A.attributeNameCheck instanceof RegExp&&or(A.attributeNameCheck,re)||A.attributeNameCheck instanceof Function&&A.attributeNameCheck(re))||re==="is"&&A.allowCustomizedBuiltInElements&&(A.tagNameCheck instanceof RegExp&&or(A.tagNameCheck,pe)||A.tagNameCheck instanceof Function&&A.tagNameCheck(pe))))return!1}else if(!Di[re]){if(!or(wn,Dh(pe,Ae,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&k!=="script"&&aX(pe,"data:")===0&&Ye[k])){if(!(b&&!or(we,Dh(pe,Ae,"")))){if(pe)return!1}}}}}}return!0},ux=function(k){return k!=="annotation-xml"&&WP(k,ot)},cx=function(k){us(q.beforeSanitizeAttributes,k,null);const{attributes:re}=k;if(!re||Oy(k))return;const pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:v,forceKeepAttr:void 0};let Bt=re.length;for(;Bt--;){const Un=re[Bt],{name:Ln,namespaceURI:Cr,value:mo}=Un,Ph=An(Ln);let ir=Ln==="value"?mo:lX(mo);if(pe.attrName=Ph,pe.attrValue=ir,pe.keepAttr=!0,pe.forceKeepAttr=void 0,us(q.uponSanitizeAttribute,k,pe),ir=pe.attrValue,G&&(Ph==="id"||Ph==="name")&&($g(Ln,k),ir=ae+ir),$&&or(/((--!?|])>)|<\/(style|title)/i,ir)){$g(Ln,k);continue}if(pe.forceKeepAttr||($g(Ln,k),!pe.keepAttr))continue;if(!R&&or(/\/>/i,ir)){$g(Ln,k);continue}S&&qg([Z,ee,te],dx=>{ir=Dh(ir,dx," ")});const hx=An(k.nodeName);if(lx(hx,Ph,ir)){if(_&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Cr)switch(f.getAttributeType(hx,Ph)){case"TrustedHTML":{ir=_.createHTML(ir);break}case"TrustedScriptURL":{ir=_.createScriptURL(ir);break}}try{Cr?k.setAttributeNS(Cr,Ln,ir):k.setAttribute(Ln,ir),Oy(k)?go(k):BP(e.removed)}catch{}}}us(q.afterSanitizeAttributes,k,null)},tB=function be(k){let re=null;const pe=ox(k);for(us(q.beforeSanitizeShadowDOM,k,null);re=pe.nextNode();)us(q.uponSanitizeShadowNode,re,null),ax(re),cx(re),re.content instanceof o&&be(re.content);us(q.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(be){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,pe=null,Bt=null,Un=null;if(Nt=!be,Nt&&(be="<!-->"),typeof be!="string"&&!sx(be))if(typeof be.toString=="function"){if(be=be.toString(),typeof be!="string")throw kh("dirty is not a string, aborting")}else throw kh("toString is not a function");if(!e.isSupported)return be;if(N||Iy(k),e.removed=[],typeof be=="string"&&(xe=!1),xe){if(be.nodeName){const mo=An(be.nodeName);if(!Ue[mo]||L[mo])throw kh("root node is forbidden and cannot be sanitized in-place")}}else if(be instanceof a)re=ix("<!---->"),pe=re.ownerDocument.importNode(be,!0),pe.nodeType===Lh.element&&pe.nodeName==="BODY"||pe.nodeName==="HTML"?re=pe:re.appendChild(pe);else{if(!H&&!S&&!O&&be.indexOf("<")===-1)return _&&B?_.createHTML(be):be;if(re=ix(be),!re)return H?null:B?I:""}re&&j&&go(re.firstChild);const Ln=ox(xe?be:re);for(;Bt=Ln.nextNode();)ax(Bt),cx(Bt),Bt.content instanceof o&&tB(Bt.content);if(xe)return be;if(H){if(D)for(Un=z.call(re.ownerDocument);re.firstChild;)Un.appendChild(re.firstChild);else Un=re;return(v.shadowroot||v.shadowrootmode)&&(Un=V.call(r,Un,!0)),Un}let Cr=O?re.outerHTML:re.innerHTML;return O&&Ue["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&or(xD,re.ownerDocument.doctype.name)&&(Cr="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+Cr),S&&qg([Z,ee,te],mo=>{Cr=Dh(Cr,mo," ")}),_&&B?_.createHTML(Cr):Cr},e.setConfig=function(){let be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Iy(be),N=!0},e.clearConfig=function(){ku=null,N=!1},e.isValidAttribute=function(be,k,re){ku||Iy({});const pe=An(be),Bt=An(k);return lx(pe,Bt,re)},e.addHook=function(be,k){typeof k=="function"&&Nh(q[be],k)},e.removeHook=function(be,k){if(k!==void 0){const re=oX(q[be],k);return re===-1?void 0:sX(q[be],re,1)[0]}return BP(q[be])},e.removeHooks=function(be){q[be]=[]},e.removeAllHooks=function(){q=KP()},e}var RX=PD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var ID;function Q(){return ID.apply(null,arguments)}function EX(t){ID=t}function ao(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function su(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function ut(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function lE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(ut(t,e))return!1;return!0}function Ir(t){return t===void 0}function Ys(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function dg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function OD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Ha(t,e){for(var n in e)ut(e,n)&&(t[n]=e[n]);return ut(e,"toString")&&(t.toString=e.toString),ut(e,"valueOf")&&(t.valueOf=e.valueOf),t}function is(t,e,n,r){return ek(t,e,n,r,!0).utc()}function TX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ke(t){return t._pf==null&&(t._pf=TX()),t._pf}var dR;Array.prototype.some?dR=Array.prototype.some:dR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function uE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=ke(t),n=dR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Ov(t){var e=is(NaN);return t!=null?Ha(ke(e),t):ke(e).userInvalidated=!0,e}var qP=Q.momentProperties=[],pC=!1;function cE(t,e){var n,r,i,o=qP.length;if(Ir(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Ir(e._i)||(t._i=e._i),Ir(e._f)||(t._f=e._f),Ir(e._l)||(t._l=e._l),Ir(e._strict)||(t._strict=e._strict),Ir(e._tzm)||(t._tzm=e._tzm),Ir(e._isUTC)||(t._isUTC=e._isUTC),Ir(e._offset)||(t._offset=e._offset),Ir(e._pf)||(t._pf=ke(e)),Ir(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=qP[n],i=e[r],Ir(i)||(t[r]=i);return t}function fg(t){cE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),pC===!1&&(pC=!0,Q.updateOffset(this),pC=!1)}function lo(t){return t instanceof fg||t!=null&&t._isAMomentObject!=null}function AD(t){Q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Oi(t,e){var n=!0;return Ha(function(){if(Q.deprecationHandler!=null&&Q.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])ut(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}AD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var XP={};function HD(t,e){Q.deprecationHandler!=null&&Q.deprecationHandler(t,e),XP[t]||(AD(e),XP[t]=!0)}Q.suppressDeprecationWarnings=!1;Q.deprecationHandler=null;function os(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function MX(t){var e,n;for(n in t)ut(t,n)&&(e=t[n],os(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function fR(t,e){var n=Ha({},t),r;for(r in e)ut(e,r)&&(su(t[r])&&su(e[r])?(n[r]={},Ha(n[r],t[r]),Ha(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)ut(t,r)&&!ut(e,r)&&su(t[r])&&(n[r]=Ha({},n[r]));return n}function hE(t){t!=null&&this.set(t)}var gR;Object.keys?gR=Object.keys:gR=function(t){var e,n=[];for(e in t)ut(t,e)&&n.push(e);return n};var _X={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function xX(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return os(r)?r.call(e,n):r}function Qo(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var dE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Jg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,wC={},Wc={};function Se(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Wc[t]=i),e&&(Wc[e[0]]=function(){return Qo(i.apply(this,arguments),e[1],e[2])}),n&&(Wc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function PX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function IX(t){var e=t.match(dE),n,r;for(n=0,r=e.length;n<r;n++)Wc[e[n]]?e[n]=Wc[e[n]]:e[n]=PX(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=os(e[s])?e[s].call(i,t):e[s];return o}}function $p(t,e){return t.isValid()?(e=ND(e,t.localeData()),wC[e]=wC[e]||IX(e),wC[e](t)):t.localeData().invalidDate()}function ND(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Jg.lastIndex=0;n>=0&&Jg.test(t);)t=t.replace(Jg,r),Jg.lastIndex=0,n-=1;return t}var OX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function AX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(dE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var HX="Invalid date";function NX(){return this._invalidDate}var DX="%d",kX=/\d{1,2}/;function $X(t){return this._ordinal.replace("%d",t)}var LX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function FX(t,e,n,r){var i=this._relativeTime[n];return os(i)?i(t,e,n,r):i.replace(/%d/i,t)}function VX(t,e){var n=this._relativeTime[t>0?"future":"past"];return os(n)?n(e):n.replace(/%s/i,e)}var JP={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ai(t){return typeof t=="string"?JP[t]||JP[t.toLowerCase()]:void 0}function fE(t){var e={},n,r;for(r in t)ut(t,r)&&(n=Ai(r),n&&(e[n]=t[r]));return e}var BX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function WX(t){var e=[],n;for(n in t)ut(t,n)&&e.push({unit:n,priority:BX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var DD=/\d/,si=/\d\d/,kD=/\d{3}/,gE=/\d{4}/,Av=/[+-]?\d{6}/,Vt=/\d\d?/,$D=/\d\d\d\d?/,LD=/\d\d\d\d\d\d?/,Hv=/\d{1,3}/,mE=/\d{1,4}/,Nv=/[+-]?\d{1,6}/,wh=/\d+/,Dv=/[+-]?\d+/,jX=/Z|[+-]\d\d:?\d\d/gi,kv=/Z|[+-]\d\d(?::?\d\d)?/gi,UX=/[+-]?\d+(\.\d{1,3})?/,gg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vh=/^[1-9]\d?/,pE=/^([1-9]\d|\d)/,Ew;Ew={};function ue(t,e,n){Ew[t]=os(e)?e:function(r,i){return r&&n?n:e}}function zX(t,e){return ut(Ew,t)?Ew[t](e._strict,e._locale):new RegExp(YX(t))}function YX(t){return Us(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Us(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function bi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=bi(e)),n}var mR={};function St(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Ys(e)&&(r=function(o,s){s[e]=Qe(o)}),i=t.length,n=0;n<i;n++)mR[t[n]]=r}function mg(t,e){St(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function GX(t,e,n){e!=null&&ut(mR,t)&&mR[t](e,n._a,n,t)}function $v(t){return t%4===0&&t%100!==0||t%400===0}var er=0,ks=1,Wo=2,In=3,io=4,$s=5,Ql=6,KX=7,qX=8;Se("Y",0,0,function(){var t=this.year();return t<=9999?Qo(t,4):"+"+t});Se(0,["YY",2],0,function(){return this.year()%100});Se(0,["YYYY",4],0,"year");Se(0,["YYYYY",5],0,"year");Se(0,["YYYYYY",6,!0],0,"year");ue("Y",Dv);ue("YY",Vt,si);ue("YYYY",mE,gE);ue("YYYYY",Nv,Av);ue("YYYYYY",Nv,Av);St(["YYYYY","YYYYYY"],er);St("YYYY",function(t,e){e[er]=t.length===2?Q.parseTwoDigitYear(t):Qe(t)});St("YY",function(t,e){e[er]=Q.parseTwoDigitYear(t)});St("Y",function(t,e){e[er]=parseInt(t,10)});function Kd(t){return $v(t)?366:365}Q.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var FD=yh("FullYear",!0);function XX(){return $v(this.year())}function yh(t,e){return function(n){return n!=null?(VD(this,t,n),Q.updateOffset(this,e),this):xf(this,t)}}function xf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function VD(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!$v(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function JX(t){return t=Ai(t),os(this[t])?this[t]():this}function ZX(t,e){if(typeof t=="object"){t=fE(t);var n=WX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Ai(t),os(this[t]))return this[t](e);return this}function QX(t,e){return(t%e+e)%e}var un;Array.prototype.indexOf?un=Array.prototype.indexOf:un=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function wE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=QX(e,12);return t+=(e-n)/12,n===1?$v(t)?29:28:31-n%7%2}Se("M",["MM",2],"Mo",function(){return this.month()+1});Se("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Se("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Vt,vh);ue("MM",Vt,si);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});St(["M","MM"],function(t,e){e[ks]=Qe(t)-1});St(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ks]=i:ke(n).invalidMonth=t});var e6="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),BD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),WD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,t6=gg,n6=gg;function r6(t,e){return t?ao(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||WD).test(e)?"format":"standalone"][t.month()]:ao(this._months)?this._months:this._months.standalone}function i6(t,e){return t?ao(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[WD.test(e)?"format":"standalone"][t.month()]:ao(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function o6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=is([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=un.call(this._shortMonthsParse,s),i!==-1?i:null):(i=un.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=un.call(this._shortMonthsParse,s),i!==-1?i:(i=un.call(this._longMonthsParse,s),i!==-1?i:null)):(i=un.call(this._longMonthsParse,s),i!==-1?i:(i=un.call(this._shortMonthsParse,s),i!==-1?i:null))}function s6(t,e,n){var r,i,o;if(this._monthsParseExact)return o6.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=is([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function jD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!Ys(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,wE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function UD(t){return t!=null?(jD(this,t),Q.updateOffset(this,!0),this):xf(this,"Month")}function a6(){return wE(this.year(),this.month())}function l6(t){return this._monthsParseExact?(ut(this,"_monthsRegex")||zD.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(ut(this,"_monthsShortRegex")||(this._monthsShortRegex=t6),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function u6(t){return this._monthsParseExact?(ut(this,"_monthsRegex")||zD.call(this),t?this._monthsStrictRegex:this._monthsRegex):(ut(this,"_monthsRegex")||(this._monthsRegex=n6),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function zD(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=is([2e3,i]),s=Us(this.monthsShort(o,"")),a=Us(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function c6(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Pf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Tw(t,e,n){var r=7+e-n,i=(7+Pf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function YD(t,e,n,r,i){var o=(7+n-r)%7,s=Tw(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Kd(l)+a):a>Kd(t)?(l=t+1,u=a-Kd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function If(t,e,n){var r=Tw(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+zs(s,e,n)):i>zs(t.year(),e,n)?(o=i-zs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function zs(t,e,n){var r=Tw(t,e,n),i=Tw(t+1,e,n);return(Kd(t)-r+i)/7}Se("w",["ww",2],"wo","week");Se("W",["WW",2],"Wo","isoWeek");ue("w",Vt,vh);ue("ww",Vt,si);ue("W",Vt,vh);ue("WW",Vt,si);mg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Qe(t)});function h6(t){return If(t,this._week.dow,this._week.doy).week}var d6={dow:0,doy:6};function f6(){return this._week.dow}function g6(){return this._week.doy}function m6(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function p6(t){var e=If(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Se("d",0,"do","day");Se("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Se("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Se("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Se("e",0,0,"weekday");Se("E",0,0,"isoWeekday");ue("d",Vt);ue("e",Vt);ue("E",Vt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});mg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:ke(n).invalidWeekday=t});mg(["d","e","E"],function(t,e,n,r){e[r]=Qe(t)});function w6(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function v6(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function vE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var y6="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),GD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),C6="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),b6=gg,S6=gg,R6=gg;function E6(t,e){var n=ao(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?vE(n,this._week.dow):t?n[t.day()]:n}function T6(t){return t===!0?vE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function M6(t){return t===!0?vE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function _6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=is([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=un.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=un.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=un.call(this._weekdaysParse,s),i!==-1||(i=un.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=un.call(this._shortWeekdaysParse,s),i!==-1||(i=un.call(this._weekdaysParse,s),i!==-1)?i:(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=un.call(this._minWeekdaysParse,s),i!==-1||(i=un.call(this._weekdaysParse,s),i!==-1)?i:(i=un.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function x6(t,e,n){var r,i,o;if(this._weekdaysParseExact)return _6.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=is([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function P6(t){if(!this.isValid())return t!=null?this:NaN;var e=xf(this,"Day");return t!=null?(t=w6(t,this.localeData()),this.add(t-e,"d")):e}function I6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function O6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=v6(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function A6(t){return this._weekdaysParseExact?(ut(this,"_weekdaysRegex")||yE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(ut(this,"_weekdaysRegex")||(this._weekdaysRegex=b6),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function H6(t){return this._weekdaysParseExact?(ut(this,"_weekdaysRegex")||yE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ut(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=S6),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function N6(t){return this._weekdaysParseExact?(ut(this,"_weekdaysRegex")||yE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ut(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=R6),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function yE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=is([2e3,1]).day(o),a=Us(this.weekdaysMin(s,"")),l=Us(this.weekdaysShort(s,"")),u=Us(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function CE(){return this.hours()%12||12}function D6(){return this.hours()||24}Se("H",["HH",2],0,"hour");Se("h",["hh",2],0,CE);Se("k",["kk",2],0,D6);Se("hmm",0,0,function(){return""+CE.apply(this)+Qo(this.minutes(),2)});Se("hmmss",0,0,function(){return""+CE.apply(this)+Qo(this.minutes(),2)+Qo(this.seconds(),2)});Se("Hmm",0,0,function(){return""+this.hours()+Qo(this.minutes(),2)});Se("Hmmss",0,0,function(){return""+this.hours()+Qo(this.minutes(),2)+Qo(this.seconds(),2)});function KD(t,e){Se(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}KD("a",!0);KD("A",!1);function qD(t,e){return e._meridiemParse}ue("a",qD);ue("A",qD);ue("H",Vt,pE);ue("h",Vt,vh);ue("k",Vt,vh);ue("HH",Vt,si);ue("hh",Vt,si);ue("kk",Vt,si);ue("hmm",$D);ue("hmmss",LD);ue("Hmm",$D);ue("Hmmss",LD);St(["H","HH"],In);St(["k","kk"],function(t,e,n){var r=Qe(t);e[In]=r===24?0:r});St(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});St(["h","hh"],function(t,e,n){e[In]=Qe(t),ke(n).bigHour=!0});St("hmm",function(t,e,n){var r=t.length-2;e[In]=Qe(t.substr(0,r)),e[io]=Qe(t.substr(r)),ke(n).bigHour=!0});St("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[In]=Qe(t.substr(0,r)),e[io]=Qe(t.substr(r,2)),e[$s]=Qe(t.substr(i)),ke(n).bigHour=!0});St("Hmm",function(t,e,n){var r=t.length-2;e[In]=Qe(t.substr(0,r)),e[io]=Qe(t.substr(r))});St("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[In]=Qe(t.substr(0,r)),e[io]=Qe(t.substr(r,2)),e[$s]=Qe(t.substr(i))});function k6(t){return(t+"").toLowerCase().charAt(0)==="p"}var $6=/[ap]\.?m?\.?/i,L6=yh("Hours",!0);function F6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var XD={calendar:_X,longDateFormat:OX,invalidDate:HX,ordinal:DX,dayOfMonthOrdinalParse:kX,relativeTime:LX,months:e6,monthsShort:BD,week:d6,weekdays:y6,weekdaysMin:C6,weekdaysShort:GD,meridiemParse:$6},jt={},Fh={},Of;function V6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function ZP(t){return t&&t.toLowerCase().replace("_","-")}function B6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=ZP(t[e]).split("-"),n=o.length,r=ZP(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Lv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&V6(o,r)>=n-1)break;n--}e++}return Of}function W6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Lv(t){var e=null,n;if(jt[t]===void 0&&typeof sw<"u"&&sw&&sw.exports&&W6(t))try{e=Of._abbr,n=require,n("./locale/"+t),Va(e)}catch{jt[t]=null}return jt[t]}function Va(t,e){var n;return t&&(Ir(e)?n=Zs(t):n=bE(t,e),n?Of=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Of._abbr}function bE(t,e){if(e!==null){var n,r=XD;if(e.abbr=t,jt[t]!=null)HD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=jt[t]._config;else if(e.parentLocale!=null)if(jt[e.parentLocale]!=null)r=jt[e.parentLocale]._config;else if(n=Lv(e.parentLocale),n!=null)r=n._config;else return Fh[e.parentLocale]||(Fh[e.parentLocale]=[]),Fh[e.parentLocale].push({name:t,config:e}),null;return jt[t]=new hE(fR(r,e)),Fh[t]&&Fh[t].forEach(function(i){bE(i.name,i.config)}),Va(t),jt[t]}else return delete jt[t],null}function j6(t,e){if(e!=null){var n,r,i=XD;jt[t]!=null&&jt[t].parentLocale!=null?jt[t].set(fR(jt[t]._config,e)):(r=Lv(t),r!=null&&(i=r._config),e=fR(i,e),r==null&&(e.abbr=t),n=new hE(e),n.parentLocale=jt[t],jt[t]=n),Va(t)}else jt[t]!=null&&(jt[t].parentLocale!=null?(jt[t]=jt[t].parentLocale,t===Va()&&Va(t)):jt[t]!=null&&delete jt[t]);return jt[t]}function Zs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Of;if(!ao(t)){if(e=Lv(t),e)return e;t=[t]}return B6(t)}function U6(){return gR(jt)}function SE(t){var e,n=t._a;return n&&ke(t).overflow===-2&&(e=n[ks]<0||n[ks]>11?ks:n[Wo]<1||n[Wo]>wE(n[er],n[ks])?Wo:n[In]<0||n[In]>24||n[In]===24&&(n[io]!==0||n[$s]!==0||n[Ql]!==0)?In:n[io]<0||n[io]>59?io:n[$s]<0||n[$s]>59?$s:n[Ql]<0||n[Ql]>999?Ql:-1,ke(t)._overflowDayOfYear&&(e<er||e>Wo)&&(e=Wo),ke(t)._overflowWeeks&&e===-1&&(e=KX),ke(t)._overflowWeekday&&e===-1&&(e=qX),ke(t).overflow=e),t}var z6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Y6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,G6=/Z|[+-]\d\d(?::?\d\d)?/,Zg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],vC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],K6=/^\/?Date\((-?\d+)/i,q6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,X6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function JD(t){var e,n,r=t._i,i=z6.exec(r)||Y6.exec(r),o,s,a,l,u=Zg.length,c=vC.length;if(i){for(ke(t).iso=!0,e=0,n=u;e<n;e++)if(Zg[e][1].exec(i[1])){s=Zg[e][0],o=Zg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(vC[e][1].exec(i[3])){a=(i[2]||" ")+vC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(G6.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),EE(t)}else t._isValid=!1}function J6(t,e,n,r,i,o){var s=[Z6(t),BD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function Z6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Q6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function e7(t,e,n){if(t){var r=GD.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return ke(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function t7(t,e,n){if(t)return X6[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function ZD(t){var e=q6.exec(Q6(t._i)),n;if(e){if(n=J6(e[4],e[3],e[2],e[5],e[6],e[7]),!e7(e[1],n,t))return;t._a=n,t._tzm=t7(e[8],e[9],e[10]),t._d=Pf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ke(t).rfc2822=!0}else t._isValid=!1}function n7(t){var e=K6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(JD(t),t._isValid===!1)delete t._isValid;else return;if(ZD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Q.createFromInputFallback(t)}Q.createFromInputFallback=Oi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Sc(t,e,n){return t??e??n}function r7(t){var e=new Date(Q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function RE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=r7(t),t._w&&t._a[Wo]==null&&t._a[ks]==null&&i7(t),t._dayOfYear!=null&&(s=Sc(t._a[er],i[er]),(t._dayOfYear>Kd(s)||t._dayOfYear===0)&&(ke(t)._overflowDayOfYear=!0),n=Pf(s,0,t._dayOfYear),t._a[ks]=n.getUTCMonth(),t._a[Wo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[In]===24&&t._a[io]===0&&t._a[$s]===0&&t._a[Ql]===0&&(t._nextDay=!0,t._a[In]=0),t._d=(t._useUTC?Pf:c6).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[In]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ke(t).weekdayMismatch=!0)}}function i7(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Sc(e.GG,t._a[er],If(Ft(),1,4).year),r=Sc(e.W,1),i=Sc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=If(Ft(),o,s),n=Sc(e.gg,t._a[er],u.year),r=Sc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>zs(n,o,s)?ke(t)._overflowWeeks=!0:l!=null?ke(t)._overflowWeekday=!0:(a=YD(n,r,i,o,s),t._a[er]=a.year,t._dayOfYear=a.dayOfYear)}Q.ISO_8601=function(){};Q.RFC_2822=function(){};function EE(t){if(t._f===Q.ISO_8601){JD(t);return}if(t._f===Q.RFC_2822){ZD(t);return}t._a=[],ke(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=ND(t._f,t._locale).match(dE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(zX(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&ke(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Wc[o]?(r?ke(t).empty=!1:ke(t).unusedTokens.push(o),GX(o,r,t)):t._strict&&!r&&ke(t).unusedTokens.push(o);ke(t).charsLeftOver=a-l,e.length>0&&ke(t).unusedInput.push(e),t._a[In]<=12&&ke(t).bigHour===!0&&t._a[In]>0&&(ke(t).bigHour=void 0),ke(t).parsedDateParts=t._a.slice(0),ke(t).meridiem=t._meridiem,t._a[In]=o7(t._locale,t._a[In],t._meridiem),u=ke(t).era,u!==null&&(t._a[er]=t._locale.erasConvertYear(u,t._a[er])),RE(t),SE(t)}function o7(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function s7(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){ke(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=cE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],EE(e),uE(e)&&(s=!0),o+=ke(e).charsLeftOver,o+=ke(e).unusedTokens.length*10,ke(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Ha(t,n||e)}function a7(t){if(!t._d){var e=fE(t._i),n=e.day===void 0?e.date:e.day;t._a=OD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),RE(t)}}function l7(t){var e=new fg(SE(QD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function QD(t){var e=t._i,n=t._f;return t._locale=t._locale||Zs(t._l),e===null||n===void 0&&e===""?Ov({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),lo(e)?new fg(SE(e)):(dg(e)?t._d=e:ao(n)?s7(t):n?EE(t):u7(t),uE(t)||(t._d=null),t))}function u7(t){var e=t._i;Ir(e)?t._d=new Date(Q.now()):dg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?n7(t):ao(e)?(t._a=OD(e.slice(0),function(n){return parseInt(n,10)}),RE(t)):su(e)?a7(t):Ys(e)?t._d=new Date(e):Q.createFromInputFallback(t)}function ek(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(su(t)&&lE(t)||ao(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,l7(o)}function Ft(t,e,n,r){return ek(t,e,n,r,!1)}var c7=Oi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ft.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Ov()}),h7=Oi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ft.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Ov()});function tk(t,e){var n,r;if(e.length===1&&ao(e[0])&&(e=e[0]),!e.length)return Ft();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function d7(){var t=[].slice.call(arguments,0);return tk("isBefore",t)}function f7(){var t=[].slice.call(arguments,0);return tk("isAfter",t)}var g7=function(){return Date.now?Date.now():+new Date},Vh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function m7(t){var e,n=!1,r,i=Vh.length;for(e in t)if(ut(t,e)&&!(un.call(Vh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Vh[r]]){if(n)return!1;parseFloat(t[Vh[r]])!==Qe(t[Vh[r]])&&(n=!0)}return!0}function p7(){return this._isValid}function w7(){return ho(NaN)}function Fv(t){var e=fE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=m7(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Zs(),this._bubble()}function Lp(t){return t instanceof Fv}function pR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function v7(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Qe(t[s])!==Qe(e[s])&&o++;return o+i}function nk(t,e){Se(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Qo(~~(n/60),2)+e+Qo(~~n%60,2)})}nk("Z",":");nk("ZZ","");ue("Z",kv);ue("ZZ",kv);St(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=TE(kv,t)});var y7=/([\+\-]|\d\d)/gi;function TE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(y7)||["-",0,0],o=+(i[1]*60)+Qe(i[2]),o===0?0:i[0]==="+"?o:-o)}function ME(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(lo(t)||dg(t)?t.valueOf():Ft(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Q.updateOffset(n,!1),n):Ft(t).local()}function wR(t){return-Math.round(t._d.getTimezoneOffset())}Q.updateOffset=function(){};function C7(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=TE(kv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=wR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?ok(this,ho(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:wR(this)}function b7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function S7(t){return this.utcOffset(0,t)}function R7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(wR(this),"m")),this}function E7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=TE(jX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function T7(t){return this.isValid()?(t=t?Ft(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function M7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function _7(){if(!Ir(this._isDSTShifted))return this._isDSTShifted;var t={},e;return cE(t,this),t=QD(t),t._a?(e=t._isUTC?is(t._a):Ft(t._a),this._isDSTShifted=this.isValid()&&v7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function x7(){return this.isValid()?!this._isUTC:!1}function P7(){return this.isValid()?this._isUTC:!1}function rk(){return this.isValid()?this._isUTC&&this._offset===0:!1}var I7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,O7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ho(t,e){var n=t,r=null,i,o,s;return Lp(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ys(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=I7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Qe(r[Wo])*i,h:Qe(r[In])*i,m:Qe(r[io])*i,s:Qe(r[$s])*i,ms:Qe(pR(r[Ql]*1e3))*i}):(r=O7.exec(t))?(i=r[1]==="-"?-1:1,n={y:sl(r[2],i),M:sl(r[3],i),w:sl(r[4],i),d:sl(r[5],i),h:sl(r[6],i),m:sl(r[7],i),s:sl(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=A7(Ft(n.from),Ft(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Fv(n),Lp(t)&&ut(t,"_locale")&&(o._locale=t._locale),Lp(t)&&ut(t,"_isValid")&&(o._isValid=t._isValid),o}ho.fn=Fv.prototype;ho.invalid=w7;function sl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function QP(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function A7(t,e){var n;return t.isValid()&&e.isValid()?(e=ME(e,t),t.isBefore(e)?n=QP(t,e):(n=QP(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function ik(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(HD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ho(n,r),ok(this,i,t),this}}function ok(t,e,n,r){var i=e._milliseconds,o=pR(e._days),s=pR(e._months);t.isValid()&&(r=r??!0,s&&jD(t,xf(t,"Month")+s*n),o&&VD(t,"Date",xf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Q.updateOffset(t,o||s))}var H7=ik(1,"add"),N7=ik(-1,"subtract");function sk(t){return typeof t=="string"||t instanceof String}function D7(t){return lo(t)||dg(t)||sk(t)||Ys(t)||$7(t)||k7(t)||t===null||t===void 0}function k7(t){var e=su(t)&&!lE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||ut(t,o);return e&&n}function $7(t){var e=ao(t),n=!1;return e&&(n=t.filter(function(r){return!Ys(r)&&sk(t)}).length===0),e&&n}function L7(t){var e=su(t)&&!lE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||ut(t,o);return e&&n}function F7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function V7(t,e){arguments.length===1&&(arguments[0]?D7(arguments[0])?(t=arguments[0],e=void 0):L7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Ft(),r=ME(n,this).startOf("day"),i=Q.calendarFormat(this,r)||"sameElse",o=e&&(os(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Ft(n)))}function B7(){return new fg(this)}function W7(t,e){var n=lo(t)?t:Ft(t);return this.isValid()&&n.isValid()?(e=Ai(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function j7(t,e){var n=lo(t)?t:Ft(t);return this.isValid()&&n.isValid()?(e=Ai(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function U7(t,e,n,r){var i=lo(t)?t:Ft(t),o=lo(e)?e:Ft(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function z7(t,e){var n=lo(t)?t:Ft(t),r;return this.isValid()&&n.isValid()?(e=Ai(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function Y7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function G7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function K7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=ME(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Ai(e),e){case"year":o=Fp(this,r)/12;break;case"month":o=Fp(this,r);break;case"quarter":o=Fp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:bi(o)}function Fp(t,e){if(t.date()<e.date())return-Fp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function q7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function X7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?$p(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):os(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",$p(n,"Z")):$p(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function J7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function Z7(t){t||(t=this.isUtc()?Q.defaultFormatUtc:Q.defaultFormat);var e=$p(this,t);return this.localeData().postformat(e)}function Q7(t,e){return this.isValid()&&(lo(t)&&t.isValid()||Ft(t).isValid())?ho({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function e9(t){return this.from(Ft(),t)}function t9(t,e){return this.isValid()&&(lo(t)&&t.isValid()||Ft(t).isValid())?ho({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function n9(t){return this.to(Ft(),t)}function ak(t){var e;return t===void 0?this._locale._abbr:(e=Zs(t),e!=null&&(this._locale=e),this)}var lk=Oi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function uk(){return this._locale}var Mw=1e3,jc=60*Mw,_w=60*jc,ck=(365*400+97)*24*_w;function Uc(t,e){return(t%e+e)%e}function hk(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-ck:new Date(t,e,n).valueOf()}function dk(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-ck:Date.UTC(t,e,n)}function r9(t){var e,n;if(t=Ai(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?dk:hk,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Uc(e+(this._isUTC?0:this.utcOffset()*jc),_w);break;case"minute":e=this._d.valueOf(),e-=Uc(e,jc);break;case"second":e=this._d.valueOf(),e-=Uc(e,Mw);break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function i9(t){var e,n;if(t=Ai(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?dk:hk,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=_w-Uc(e+(this._isUTC?0:this.utcOffset()*jc),_w)-1;break;case"minute":e=this._d.valueOf(),e+=jc-Uc(e,jc)-1;break;case"second":e=this._d.valueOf(),e+=Mw-Uc(e,Mw)-1;break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function o9(){return this._d.valueOf()-(this._offset||0)*6e4}function s9(){return Math.floor(this.valueOf()/1e3)}function a9(){return new Date(this.valueOf())}function l9(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function u9(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function c9(){return this.isValid()?this.toISOString():null}function h9(){return uE(this)}function d9(){return Ha({},ke(this))}function f9(){return ke(this).overflow}function g9(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Se("N",0,0,"eraAbbr");Se("NN",0,0,"eraAbbr");Se("NNN",0,0,"eraAbbr");Se("NNNN",0,0,"eraName");Se("NNNNN",0,0,"eraNarrow");Se("y",["y",1],"yo","eraYear");Se("y",["yy",2],0,"eraYear");Se("y",["yyy",3],0,"eraYear");Se("y",["yyyy",4],0,"eraYear");ue("N",_E);ue("NN",_E);ue("NNN",_E);ue("NNNN",T9);ue("NNNNN",M9);St(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?ke(n).era=i:ke(n).invalidEra=t});ue("y",wh);ue("yy",wh);ue("yyy",wh);ue("yyyy",wh);ue("yo",_9);St(["y","yy","yyy","yyyy"],er);St(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[er]=n._locale.eraYearOrdinalParse(t,i):e[er]=parseInt(t,10)});function m9(t,e){var n,r,i,o=this._eras||Zs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Q(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Q(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function p9(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function w9(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Q(t.since).year():Q(t.since).year()+(e-t.offset)*n}function v9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function y9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function C9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function b9(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Q(i[t].since).year())*n+i[t].offset;return this.year()}function S9(t){return ut(this,"_erasNameRegex")||xE.call(this),t?this._erasNameRegex:this._erasRegex}function R9(t){return ut(this,"_erasAbbrRegex")||xE.call(this),t?this._erasAbbrRegex:this._erasRegex}function E9(t){return ut(this,"_erasNarrowRegex")||xE.call(this),t?this._erasNarrowRegex:this._erasRegex}function _E(t,e){return e.erasAbbrRegex(t)}function T9(t,e){return e.erasNameRegex(t)}function M9(t,e){return e.erasNarrowRegex(t)}function _9(t,e){return e._eraYearOrdinalRegex||wh}function xE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Us(u[i].name),a=Us(u[i].abbr),l=Us(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Se(0,["gg",2],0,function(){return this.weekYear()%100});Se(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Vv(t,e){Se(0,[t,t.length],0,e)}Vv("gggg","weekYear");Vv("ggggg","weekYear");Vv("GGGG","isoWeekYear");Vv("GGGGG","isoWeekYear");ue("G",Dv);ue("g",Dv);ue("GG",Vt,si);ue("gg",Vt,si);ue("GGGG",mE,gE);ue("gggg",mE,gE);ue("GGGGG",Nv,Av);ue("ggggg",Nv,Av);mg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Qe(t)});mg(["gg","GG"],function(t,e,n,r){e[r]=Q.parseTwoDigitYear(t)});function x9(t){return fk.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function P9(t){return fk.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function I9(){return zs(this.year(),1,4)}function O9(){return zs(this.isoWeekYear(),1,4)}function A9(){var t=this.localeData()._week;return zs(this.year(),t.dow,t.doy)}function H9(){var t=this.localeData()._week;return zs(this.weekYear(),t.dow,t.doy)}function fk(t,e,n,r,i){var o;return t==null?If(this,r,i).year:(o=zs(t,r,i),e>o&&(e=o),N9.call(this,t,e,n,r,i))}function N9(t,e,n,r,i){var o=YD(t,e,n,r,i),s=Pf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Se("Q",0,"Qo","quarter");ue("Q",DD);St("Q",function(t,e){e[ks]=(Qe(t)-1)*3});function D9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Se("D",["DD",2],"Do","date");ue("D",Vt,vh);ue("DD",Vt,si);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});St(["D","DD"],Wo);St("Do",function(t,e){e[Wo]=Qe(t.match(Vt)[0])});var gk=yh("Date",!0);Se("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Hv);ue("DDDD",kD);St(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function k9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Se("m",["mm",2],0,"minute");ue("m",Vt,pE);ue("mm",Vt,si);St(["m","mm"],io);var $9=yh("Minutes",!1);Se("s",["ss",2],0,"second");ue("s",Vt,pE);ue("ss",Vt,si);St(["s","ss"],$s);var L9=yh("Seconds",!1);Se("S",0,0,function(){return~~(this.millisecond()/100)});Se(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Se(0,["SSS",3],0,"millisecond");Se(0,["SSSS",4],0,function(){return this.millisecond()*10});Se(0,["SSSSS",5],0,function(){return this.millisecond()*100});Se(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Se(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Se(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Se(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Hv,DD);ue("SS",Hv,si);ue("SSS",Hv,kD);var Na,mk;for(Na="SSSS";Na.length<=9;Na+="S")ue(Na,wh);function F9(t,e){e[Ql]=Qe(("0."+t)*1e3)}for(Na="S";Na.length<=9;Na+="S")St(Na,F9);mk=yh("Milliseconds",!1);Se("z",0,0,"zoneAbbr");Se("zz",0,0,"zoneName");function V9(){return this._isUTC?"UTC":""}function B9(){return this._isUTC?"Coordinated Universal Time":""}var ne=fg.prototype;ne.add=H7;ne.calendar=V7;ne.clone=B7;ne.diff=K7;ne.endOf=i9;ne.format=Z7;ne.from=Q7;ne.fromNow=e9;ne.to=t9;ne.toNow=n9;ne.get=JX;ne.invalidAt=f9;ne.isAfter=W7;ne.isBefore=j7;ne.isBetween=U7;ne.isSame=z7;ne.isSameOrAfter=Y7;ne.isSameOrBefore=G7;ne.isValid=h9;ne.lang=lk;ne.locale=ak;ne.localeData=uk;ne.max=h7;ne.min=c7;ne.parsingFlags=d9;ne.set=ZX;ne.startOf=r9;ne.subtract=N7;ne.toArray=l9;ne.toObject=u9;ne.toDate=a9;ne.toISOString=X7;ne.inspect=J7;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=c9;ne.toString=q7;ne.unix=s9;ne.valueOf=o9;ne.creationData=g9;ne.eraName=v9;ne.eraNarrow=y9;ne.eraAbbr=C9;ne.eraYear=b9;ne.year=FD;ne.isLeapYear=XX;ne.weekYear=x9;ne.isoWeekYear=P9;ne.quarter=ne.quarters=D9;ne.month=UD;ne.daysInMonth=a6;ne.week=ne.weeks=m6;ne.isoWeek=ne.isoWeeks=p6;ne.weeksInYear=A9;ne.weeksInWeekYear=H9;ne.isoWeeksInYear=I9;ne.isoWeeksInISOWeekYear=O9;ne.date=gk;ne.day=ne.days=P6;ne.weekday=I6;ne.isoWeekday=O6;ne.dayOfYear=k9;ne.hour=ne.hours=L6;ne.minute=ne.minutes=$9;ne.second=ne.seconds=L9;ne.millisecond=ne.milliseconds=mk;ne.utcOffset=C7;ne.utc=S7;ne.local=R7;ne.parseZone=E7;ne.hasAlignedHourOffset=T7;ne.isDST=M7;ne.isLocal=x7;ne.isUtcOffset=P7;ne.isUtc=rk;ne.isUTC=rk;ne.zoneAbbr=V9;ne.zoneName=B9;ne.dates=Oi("dates accessor is deprecated. Use date instead.",gk);ne.months=Oi("months accessor is deprecated. Use month instead",UD);ne.years=Oi("years accessor is deprecated. Use year instead",FD);ne.zone=Oi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",b7);ne.isDSTShifted=Oi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",_7);function W9(t){return Ft(t*1e3)}function j9(){return Ft.apply(null,arguments).parseZone()}function pk(t){return t}var ct=hE.prototype;ct.calendar=xX;ct.longDateFormat=AX;ct.invalidDate=NX;ct.ordinal=$X;ct.preparse=pk;ct.postformat=pk;ct.relativeTime=FX;ct.pastFuture=VX;ct.set=MX;ct.eras=m9;ct.erasParse=p9;ct.erasConvertYear=w9;ct.erasAbbrRegex=R9;ct.erasNameRegex=S9;ct.erasNarrowRegex=E9;ct.months=r6;ct.monthsShort=i6;ct.monthsParse=s6;ct.monthsRegex=u6;ct.monthsShortRegex=l6;ct.week=h6;ct.firstDayOfYear=g6;ct.firstDayOfWeek=f6;ct.weekdays=E6;ct.weekdaysMin=M6;ct.weekdaysShort=T6;ct.weekdaysParse=x6;ct.weekdaysRegex=A6;ct.weekdaysShortRegex=H6;ct.weekdaysMinRegex=N6;ct.isPM=k6;ct.meridiem=F6;function xw(t,e,n,r){var i=Zs(),o=is().set(r,e);return i[n](o,t)}function wk(t,e,n){if(Ys(t)&&(e=t,t=void 0),t=t||"",e!=null)return xw(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=xw(t,r,n,"month");return i}function PE(t,e,n,r){typeof t=="boolean"?(Ys(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ys(e)&&(n=e,e=void 0),e=e||"");var i=Zs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return xw(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=xw(e,(s+o)%7,r,"day");return a}function U9(t,e){return wk(t,e,"months")}function z9(t,e){return wk(t,e,"monthsShort")}function Y9(t,e,n){return PE(t,e,n,"weekdays")}function G9(t,e,n){return PE(t,e,n,"weekdaysShort")}function K9(t,e,n){return PE(t,e,n,"weekdaysMin")}Va("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Q.lang=Oi("moment.lang is deprecated. Use moment.locale instead.",Va);Q.langData=Oi("moment.langData is deprecated. Use moment.localeData instead.",Zs);var cs=Math.abs;function q9(){var t=this._data;return this._milliseconds=cs(this._milliseconds),this._days=cs(this._days),this._months=cs(this._months),t.milliseconds=cs(t.milliseconds),t.seconds=cs(t.seconds),t.minutes=cs(t.minutes),t.hours=cs(t.hours),t.months=cs(t.months),t.years=cs(t.years),this}function vk(t,e,n,r){var i=ho(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function X9(t,e){return vk(this,t,e,1)}function J9(t,e){return vk(this,t,e,-1)}function eI(t){return t<0?Math.floor(t):Math.ceil(t)}function Z9(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=eI(vR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=bi(t/1e3),r.seconds=i%60,o=bi(i/60),r.minutes=o%60,s=bi(o/60),r.hours=s%24,e+=bi(s/24),l=bi(yk(e)),n+=l,e-=eI(vR(l)),a=bi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function yk(t){return t*4800/146097}function vR(t){return t*146097/4800}function Q9(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Ai(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+yk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(vR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Qs(t){return function(){return this.as(t)}}var Ck=Qs("ms"),e8=Qs("s"),t8=Qs("m"),n8=Qs("h"),r8=Qs("d"),i8=Qs("w"),o8=Qs("M"),s8=Qs("Q"),a8=Qs("y"),l8=Ck;function u8(){return ho(this)}function c8(t){return t=Ai(t),this.isValid()?this[t+"s"]():NaN}function Pu(t){return function(){return this.isValid()?this._data[t]:NaN}}var h8=Pu("milliseconds"),d8=Pu("seconds"),f8=Pu("minutes"),g8=Pu("hours"),m8=Pu("days"),p8=Pu("months"),w8=Pu("years");function v8(){return bi(this.days()/7)}var Ps=Math.round,Hc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function y8(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function C8(t,e,n,r){var i=ho(t).abs(),o=Ps(i.as("s")),s=Ps(i.as("m")),a=Ps(i.as("h")),l=Ps(i.as("d")),u=Ps(i.as("M")),c=Ps(i.as("w")),h=Ps(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,y8.apply(null,d)}function b8(t){return t===void 0?Ps:typeof t=="function"?(Ps=t,!0):!1}function S8(t,e){return Hc[t]===void 0?!1:e===void 0?Hc[t]:(Hc[t]=e,t==="s"&&(Hc.ss=e-1),!0)}function R8(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Hc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Hc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=C8(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var yC=Math.abs;function Lu(t){return(t>0)-(t<0)||+t}function Bv(){if(!this.isValid())return this.localeData().invalidDate();var t=yC(this._milliseconds)/1e3,e=yC(this._days),n=yC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=bi(t/60),i=bi(r/60),t%=60,r%=60,o=bi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Lu(this._months)!==Lu(a)?"-":"",c=Lu(this._days)!==Lu(a)?"-":"",h=Lu(this._milliseconds)!==Lu(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var it=Fv.prototype;it.isValid=p7;it.abs=q9;it.add=X9;it.subtract=J9;it.as=Q9;it.asMilliseconds=Ck;it.asSeconds=e8;it.asMinutes=t8;it.asHours=n8;it.asDays=r8;it.asWeeks=i8;it.asMonths=o8;it.asQuarters=s8;it.asYears=a8;it.valueOf=l8;it._bubble=Z9;it.clone=u8;it.get=c8;it.milliseconds=h8;it.seconds=d8;it.minutes=f8;it.hours=g8;it.days=m8;it.weeks=v8;it.months=p8;it.years=w8;it.humanize=R8;it.toISOString=Bv;it.toString=Bv;it.toJSON=Bv;it.locale=ak;it.localeData=uk;it.toIsoString=Oi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Bv);it.lang=lk;Se("X",0,0,"unix");Se("x",0,0,"valueOf");ue("x",Dv);ue("X",UX);St("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});St("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
Q.version="2.30.1";EX(Ft);Q.fn=ne;Q.min=d7;Q.max=f7;Q.now=g7;Q.utc=is;Q.unix=W9;Q.months=U9;Q.isDate=dg;Q.locale=Va;Q.invalid=Ov;Q.duration=ho;Q.isMoment=lo;Q.weekdays=Y9;Q.parseZone=j9;Q.localeData=Zs;Q.isDuration=Lp;Q.monthsShort=z9;Q.weekdaysMin=K9;Q.defineLocale=bE;Q.updateLocale=j6;Q.locales=U6;Q.weekdaysShort=G9;Q.normalizeUnits=Ai;Q.relativeTimeRounding=b8;Q.relativeTimeThreshold=S8;Q.calendarFormat=F7;Q.prototype=ne;Q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function bk(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function yR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function qd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Mn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Ya(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Xe(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function x(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function Sk(t){return Mn(t,(e,n)=>e+n,0)}function E8(t){return Mn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function T8(t){return Mn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function M8(t){return t.length?Sk(t)/t.length:0}function Rk(t){return Mn(t,(e,n)=>e.concat(Array.isArray(n)?Rk(n):n),[])}function Ek(t){const e=[];return x(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function CR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return x(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function _8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return x(i,s=>{o=o.filter(a=>s.includes(a))}),o}function x8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return x(i,s=>{x(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function bR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const P8=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:M8,arrayEach:x,arrayFilter:Ya,arrayFlatten:Rk,arrayMap:Xe,arrayMax:E8,arrayMin:T8,arrayReduce:Mn,arraySum:Sk,arrayUnique:Ek,extendArray:yR,getDifferenceOfArrays:CR,getIntersectionOfArrays:_8,getUnionOfArrays:x8,pivot:qd,stringToArray:bR,to2dArray:bk},Symbol.toStringTag,{value:"Module"}));function mt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Mn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function It(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Lt(t){return typeof t>"u"}function Jt(t){return t===null||t===""||Lt(t)}function Tk(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Fd="length",Xd=t=>parseInt(t,16),tI=t=>parseInt(t,10),Pw=(t,e,n)=>t.substr(e,n),Jd=t=>t.codePointAt(0)-65,SR=t=>`${t}`.replace(/\-/g,""),I8=t=>Xd(Pw(SR(t),Xd("12"),Jd("F")))/(Xd(Pw(SR(t),Jd("B"),~~![][Fd]))||9),O8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let nI=!1;const rI={invalid:()=>mt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return mt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>mt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},iI={invalid:()=>mt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return mt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>mt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Mk(t,e){const n=!Jt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=SR(t||"");const l=A8(t);if(n||r||l)if(l){const u=Q("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=I8(t);o=Q((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(O8()&&(s="valid",a="valid"),!nI&&s!=="valid"&&(rI[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](rI[s]({keyValidityDate:o,hotVersion:i})),nI=!0),a!=="valid"&&e.parentNode&&iI[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=iI[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function A8(t){let e=[][Fd],n=e;if(t[Fd]!==Jd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Jd(i.shift());o;o=Jd(i.shift()||"A"))--o<""[Fd]?n=n|(tI(`${tI(Xd(r)+(Xd(Pw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Pw(t,o,o?i[Fd]===1?9:8:6);return n===e}const H8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:Mk,isDefined:le,isEmpty:Jt,isRegExp:Tk,isUndefined:Lt,stringify:It},Symbol.toStringTag,{value:"Module"}));function nr(t){return t[0].toUpperCase()+t.substr(1)}function N8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=It(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function IE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function OE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function AE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function RR(t){return Wv(`${t}`,{ALLOWED_TAGS:[]})}function Wv(t,e){return RX.sanitize(t,e)}const D8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:N8,isPercentValue:OE,randomString:IE,sanitize:Wv,stripTags:RR,substitute:AE,toUpperCaseFirst:nr},Symbol.toStringTag,{value:"Module"})),Iu=t=>["tabindex",t],k8=()=>["role","treegrid"],Ls=()=>["role","presentation"],$8=()=>["role","gridcell"],L8=()=>["role","rowheader"],_k=()=>["role","rowgroup"],F8=()=>["role","columnheader"],ER=()=>["role","row"],V8=()=>["role","menu"],B8=()=>["role","menuitem"],W8=()=>["role","menuitemcheckbox"],j8=()=>["role","combobox"],xk=()=>["role","listbox"],U8=()=>["role","option"],z8=()=>["role","checkbox"],Y8=()=>["scope","col"],G8=()=>["scope","row"],K8=()=>["type","text"],Af=t=>["aria-label",t],Ou=()=>["aria-hidden","true"],q8=()=>["aria-disabled","true"],X8=()=>["aria-multiselectable","true"],Pk=t=>["aria-haspopup",t],Ik=t=>["aria-rowcount",t],jv=t=>["aria-colcount",t],Ok=t=>["aria-rowindex",t],HE=t=>["aria-colindex",t],Ei=t=>["aria-expanded",t],J8=t=>["aria-sort",t],oI=()=>["aria-readonly","true"],sI=()=>["aria-invalid","true"],Ak=t=>["aria-checked",t],NE=()=>["aria-selected","true"],Z8=()=>["aria-autocomplete","list"],Q8=t=>["aria-controls",t],eJ=t=>["aria-activedescendant",t],tJ=t=>["aria-live",t],nJ=t=>["aria-relevant",t],rJ=t=>["aria-setsize",t],iJ=t=>["aria-posinset",t];function Hk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Zd(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function Nk(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function fu(t){return Nk(t)&&t.parent}function oJ(t){return!!Object.getPrototypeOf(t.parent)}function Ga(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Vd(t,e,n){const r=[];let i=t;for(;i&&(i=Ga(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Dk(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Ba(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function kk(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function ya(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function $k(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Lk(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function Ce(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=$k(e),e.length>0&&t.classList.add(...e)}function ve(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Lk(e,!0);n=$k(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Re(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Au(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Lk(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function DE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)DE(e[n])}}function es(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Fk=/(<(.*)>|&(.*);)/;function Hu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Fk.test(e)?t.innerHTML=n?Wv(e):e:Ka(t,e)}function Ka(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(es(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function gu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return gu(r.host.impl);if(r.host)return gu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function Vk(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Wn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function kE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Uv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function zv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?kE(e):t.scrollTop}function $E(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Uv(e):t.scrollLeft}function Hf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Bk(t){return t.scrollHeight-t.clientHeight}function Wk(t){return t.scrollWidth-t.clientWidth}function th(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Nf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function sJ(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function on(t){return t.offsetWidth}function dn(t){return t.offsetHeight}function zc(t){return t.clientHeight||t.innerHeight}function LE(t){return t.clientWidth||t.innerWidth}function aJ(t,e,n){t.addEventListener(e,n,!1)}function lJ(t,e,n){t.removeEventListener(e,n,!1)}function FE(t){return t.selectionStart?t.selectionStart:0}function jk(t){return t.selectionEnd?t.selectionEnd:0}function uJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function TR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function pg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let CC;function cJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function On(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return CC===void 0&&(CC=cJ(t)),CC}function VE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function BE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Yv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function hJ(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function wg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Qd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Gv(t){return Qd(t)&&t.hasAttribute("data-hot-input")===!1}function dJ(t){const e=t.ownerDocument.activeElement;Gv(e)||t.select()}function WE(t){return!t.parentNode}function Uk(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function jE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Re(t,"contenteditable",!0),n&&Re(t,...Ou()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function UE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ve(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function zk(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;jE(t,n),e(),UE(t,n)}function Xo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const fJ=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Fk,addClass:X,addEvent:aJ,clearTextSelection:TR,closest:Ga,closestDown:Vd,empty:es,fastInnerHTML:Hu,fastInnerText:Ka,findFirstParentWithClass:Dk,getCaretPosition:FE,getCssTransform:hJ,getFrameElement:Nk,getMaximumScrollLeft:Wk,getMaximumScrollTop:Bk,getParent:Hk,getParentWindow:fu,getScrollLeft:$E,getScrollTop:zv,getScrollableElement:Hf,getScrollbarWidth:On,getSelectionEndPosition:jk,getSelectionText:uJ,getStyle:Nf,getTrimmingContainer:th,getWindowScrollLeft:Uv,getWindowScrollTop:kE,hasAccessToParentWindow:oJ,hasClass:Ce,hasHorizontalScrollbar:BE,hasVerticalScrollbar:VE,hasZeroHeight:Vk,index:kk,innerHeight:zc,innerWidth:LE,isChildOf:Ba,isDetached:WE,isHTMLElement:Xo,isInput:Qd,isInternalElement:Zd,isOutsideInput:Gv,isVisible:gu,makeElementContentEditableAndSelectItsContent:jE,matchesCSSRules:sJ,observeVisibilityChangeOnce:Uk,offset:Wn,outerHeight:dn,outerWidth:on,overlayContainsElement:ya,removeAttribute:Au,removeClass:ve,removeContentEditableFromElementAndDeselect:UE,removeEvent:lJ,removeTextNodes:DE,resetCssTransform:wg,runWithSelectedContendEditableElement:zk,selectElementIfAllowed:dJ,setAttribute:Re,setCaretPosition:pg,setOverlayPosition:Yv},Symbol.toStringTag,{value:"Module"}));function ft(t){return typeof t=="function"}function Yk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function gJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=Yk(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function vg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function mJ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Mn(i,(u,c)=>c(u),r.apply(this,a))}}function zE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function Gk(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function pJ(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Iw(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const wJ=Object.freeze(Object.defineProperty({__proto__:null,curry:Gk,curryRight:pJ,debounce:vg,fastCall:Iw,isFunction:ft,partial:zE,pipe:mJ,throttle:Yk,throttleAfterHits:gJ},Symbol.toStringTag,{value:"Module"}));var vJ=mn,aI=LN,yJ=En,lI=Ru,CJ=Iv,uI=vJ([].push),bJ=function(t){if(yJ(t))return t;if(aI(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?uI(n,i):(typeof i=="number"||lI(i)==="Number"||lI(i)==="String")&&uI(n,CJ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(aI(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},SJ=Et,Kk=dh,qk=ug,RJ=Rn,yg=mn,Xk=$n,cI=En,hI=j0,Jk=sE,EJ=bJ,TJ=W0,MJ=String,Wa=Kk("JSON","stringify"),Qg=yg(/./.exec),dI=yg("".charAt),_J=yg("".charCodeAt),xJ=yg("".replace),PJ=yg(1 .toString),IJ=/[\uD800-\uDFFF]/g,fI=/^[\uD800-\uDBFF]$/,gI=/^[\uDC00-\uDFFF]$/,mI=!TJ||Xk(function(){var t=Kk("Symbol")("stringify detection");return Wa([t])!=="[null]"||Wa({a:t})!=="{}"||Wa(Object(t))!=="{}"}),pI=Xk(function(){return Wa("\uDF06\uD834")!=='"\\udf06\\ud834"'||Wa("\uDEAD")!=='"\\udead"'}),OJ=function(t,e){var n=Jk(arguments),r=EJ(e);if(!(!cI(r)&&(t===void 0||hI(t))))return n[1]=function(i,o){if(cI(r)&&(o=RJ(r,this,MJ(i),o)),!hI(o))return o},qk(Wa,null,n)},AJ=function(t,e,n){var r=dI(n,e-1),i=dI(n,e+1);return Qg(fI,t)&&!Qg(gI,i)||Qg(gI,t)&&!Qg(fI,r)?"\\u"+PJ(_J(t,0),16):t};Wa&&SJ({target:"JSON",stat:!0,arity:3,forced:mI||pI},{stringify:function(e,n,r){var i=Jk(arguments),o=qk(mI?OJ:Wa,null,i);return pI&&typeof o=="string"?xJ(o,IJ,AJ):o}});function nh(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Le(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=nh(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[nh(n[0])]:e[r]=[]:e[r]=null)})),e}function Zk(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function fn(t,e,n){const r=Array.isArray(n);return Le(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Cg(t,e){Le(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Cg(t[r],e[r])):t[r]=e[r]})}function rr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function uo(t){const e={};return Le(t,(n,r)=>{e[r]=n}),e}function yt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return x(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Le(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let p=g;return(Array.isArray(p)||$e(p))&&(p=rr(p)),p};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Kv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function $e(t){return Object.prototype.toString.call(t)==="[object Object]"}function ss(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Le(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Qk(t,e){const n=e.split(".");let r=t;return Le(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Vp(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(cn(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function qv(t){if(!$e(t))return 0;const e=function(n){let r=0;return $e(n)?Le(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Lr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function cn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const HJ=Object.freeze(Object.defineProperty({__proto__:null,clone:uo,createObjectPropListener:Lr,deepClone:rr,deepExtend:Cg,deepObjectSize:qv,defineGetter:ss,duckSchema:nh,extend:fn,getProperty:Qk,hasOwnProperty:cn,inherit:Zk,isObject:$e,isObjectEqual:Kv,mixin:yt,objectEach:Le,setProperty:Vp},Symbol.toStringTag,{value:"Module"}));function Df(t){return window.requestAnimationFrame(t)}function kf(t){window.cancelAnimationFrame(t)}function YE(){return"ontouchstart"in window}function e$(){return typeof window<"u"}let Fu;function t$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Fu||(typeof Intl=="object"?Fu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Fu=(n,r)=>`${n}`.localeCompare(r):Fu=(n,r)=>n===r?0:n>r?-1:1,Fu)}const NJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:kf,getComparisonFunction:t$,isCSR:e$,isTouchSupported:YE,requestAnimationFrame:Df},Symbol.toStringTag,{value:"Module"})),pi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},ea={chrome:pi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:pi(t=>/CriOS/.test(t)),edge:pi(t=>/Edge/.test(t)),edgeWebKit:pi(t=>/EdgiOS/.test(t)),firefox:pi(t=>/Firefox/.test(t)),firefoxWebKit:pi(t=>/FxiOS/.test(t)),mobile:pi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:pi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Ch={mac:pi(t=>/^Mac/.test(t)),win:pi(t=>/^Win/.test(t)),linux:pi(t=>/^Linux/.test(t)),ios:pi(t=>/iPhone|iPad|iPod/i.test(t))};function n$(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le(ea,n=>{let{test:r}=n;return void r(t,e)})}function r$(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le(Ch,e=>{let{test:n}=e;return void n(t)})}e$()&&(n$(),r$());function GE(){return ea.chrome.value}function i$(){return ea.chromeWebKit.value}function Bp(){return ea.firefox.value}function o$(){return ea.firefoxWebKit.value}function $f(){return ea.safari.value}function s$(){return ea.edge.value}function DJ(){return ea.edgeWebKit.value}function Ko(){return ea.mobile.value}function KE(){return Ch.ios.value}function qE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Ch.mac.value}function MR(){return Ch.win.value}function Ow(){return Ch.mac.value}function kJ(){return Ch.linux.value}const $J=Object.freeze(Object.defineProperty({__proto__:null,isChrome:GE,isChromeWebKit:i$,isEdge:s$,isEdgeWebKit:DJ,isFirefox:Bp,isFirefoxWebKit:o$,isIOS:KE,isIpadOS:qE,isLinuxOS:kJ,isMacOS:Ow,isMobileBrowser:Ko,isSafari:$f,isWindowsOS:MR,setBrowserMeta:n$,setPlatformMeta:r$},Symbol.toStringTag,{value:"Module"})),fe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Bp()?182:174,AUDIO_MUTE:Bp()?181:173,AUDIO_UP:Bp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},LJ=[fe.ALT,fe.ARROW_DOWN,fe.ARROW_LEFT,fe.ARROW_RIGHT,fe.ARROW_UP,fe.AUDIO_DOWN,fe.AUDIO_MUTE,fe.AUDIO_UP,fe.BACKSPACE,fe.CAPS_LOCK,fe.DELETE,fe.END,fe.ENTER,fe.ESCAPE,fe.F1,fe.F2,fe.F3,fe.F4,fe.F5,fe.F6,fe.F7,fe.F8,fe.F9,fe.F10,fe.F11,fe.F12,fe.F13,fe.F14,fe.F15,fe.F16,fe.F17,fe.F18,fe.F19,fe.HOME,fe.INSERT,fe.MEDIA_NEXT,fe.MEDIA_PLAY_PAUSE,fe.MEDIA_PREV,fe.MEDIA_STOP,fe.NULL,fe.NUM_LOCK,fe.PAGE_DOWN,fe.PAGE_UP,fe.PAUSE,fe.SCROLL_LOCK,fe.SHIFT,fe.TAB];function a$(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function XE(t){return LJ.includes(t)}function FJ(t){const e=[];return Ow()?e.push(fe.COMMAND_LEFT,fe.COMMAND_RIGHT,fe.COMMAND_FIREFOX):e.push(fe.CONTROL),e.includes(t)}function l$(t){return[fe.CONTROL,fe.COMMAND_LEFT,fe.COMMAND_RIGHT,fe.COMMAND_FIREFOX].includes(t)}function bh(t,e){const n=e.split("|");let r=!1;return x(n,i=>{if(t===fe[i])return r=!0,!1}),r}const VJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:fe,isCtrlKey:FJ,isCtrlMetaKey:l$,isFunctionKey:XE,isKey:bh,isPrintableChar:a$},Symbol.toStringTag,{value:"Module"}));function Hi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function _a(t){return t.isImmediatePropagationEnabled===!1}function qa(t){return t.button===2}function Xv(t){return t.button===0}function u$(t){return t instanceof TouchEvent}function c$(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!Xo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const BJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:_a,isLeftClick:Xv,isRightClick:qa,isTouchEvent:u$,offsetRelativeTo:c$,stopImmediatePropagation:Hi},Symbol.toStringTag,{value:"Module"}));function at(){le(console)&&console.warn(...arguments)}function JE(){le(console)&&console.error(...arguments)}const Xl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],bC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),SC=new Map([[]]);var WJ=mh,jJ=function(t,e,n){for(var r=0,i=arguments.length>2?n:WJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},UJ=Sn,zJ=function(t,e){var n=UJ[t],r=n&&n.prototype;return r&&r[e]},YJ=co,GJ=rD,KJ=Js.f,_R=YJ("unscopables"),xR=Array.prototype;xR[_R]===void 0&&KJ(xR,_R,{configurable:!0,value:GJ(null)});var Jv=function(t){xR[_R][t]=!0},qJ=Et,XJ=mn,JJ=Vr,ZJ=ig,QJ=jJ,eZ=zJ,tZ=Jv,nZ=Array,rZ=XJ(eZ("Array","sort"));qJ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&JJ(e);var n=ZJ(this),r=QJ(nZ,n);return rZ(r,e)}});tZ("toSorted");var iZ=Et,oZ=Rn,sZ=ph,aZ=Vr,lZ=Tn,uZ=rs,cZ=oi,hZ=Qa,RC=hZ("find",TypeError);iZ({target:"Iterator",proto:!0,real:!0,forced:RC},{find:function(e){lZ(this);try{aZ(e)}catch(i){cZ(this,"throw",i)}if(RC)return oZ(RC,this,e);var n=uZ(this),r=0;return sZ(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function dZ(t,e){h$(t,e),e.add(t)}function EC(t,e,n){h$(t,e),e.set(t,n)}function h$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wI(t,e,n){return t.set(Aw(t,e),n),n}function Vn(t,e){return t.get(Aw(t,e))}function Aw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fZ=100;var zr=new WeakMap,Rc=new WeakMap,TC=new WeakMap,MC=new WeakSet;class vI{constructor(){dZ(this,MC),EC(this,zr,new Map),EC(this,Rc,new Map),EC(this,TC,new Set),Xl.forEach(e=>Aw(MC,this,yI).call(this,e))}getHooks(e){var n;return(n=Vn(zr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Vn(zr,this).has(e)||(Aw(MC,this,yI).call(this,e),Xl.push(e));const i=Vn(zr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Vn(TC,this).has(e);!u&&o!==0&&(u=!0,Vn(TC,this).add(e)),u&&i.length>1&&Vn(zr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Vn(zr,this).has(e)&&Vn(zr,this).get(e).length>0}remove(e,n){if(!Vn(zr,this).has(e))return!1;const r=Vn(zr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Vn(Rc,this).get(e);return i.skip=!0,o+=1,o>fZ&&(Vn(zr,this).set(e,r.filter(s=>!s.skip)),o=0),Vn(Rc,this).set(e,o),!0}return!1}destroy(){Vn(zr,this).clear(),Vn(Rc,this).clear(),wI(zr,this,null),wI(Rc,this,null)}}function yI(t){Vn(zr,this).set(t,[]),Vn(Rc,this).set(t,0)}function gZ(t,e,n){return(e=mZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mZ(t){var e=pZ(t,"string");return typeof e=="symbol"?e:e+""}function pZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wZ=mt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class oe{constructor(){gZ(this,"globalBucket",new vI)}static getSingleton(){return yZ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new vI),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?x(n,o=>this.add(e,o,r)):(bC.has(e)&&at(AE(wZ,{hookName:e,removedInVersion:bC.get(e)})),SC.has(e)&&at(SC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?x(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?x(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Iw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Iw(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Xl.push(e)}deregister(e){this.isRegistered(e)&&Xl.splice(Xl.indexOf(e),1)}isDeprecated(e){return SC.has(e)||bC.has(e)}isRegistered(e){return Xl.indexOf(e)>=0}getRegistered(){return Xl}}const vZ=new oe;function yZ(){return vZ}const _C=new Map;function fo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";_C.has(t)||_C.set(t,new Map);const e=_C.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const PR=new WeakMap,{register:CZ,getItem:d$,hasItem:f$,getNames:bZ,getValues:D0e}=fo("editors");function SZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},oe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function g$(t,e){let n;if(typeof t=="function")PR.get(t)||Or(null,t),n=PR.get(t);else if(typeof t=="string")n=d$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Hw(t){if(typeof t=="function")return t;if(!f$(t))throw Error(`No registered editor found under "${t}" name`);return d$(t).getConstructor()}function Or(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new SZ(e);typeof t=="string"&&CZ(t,n),PR.set(e,n)}function RZ(t,e,n){return(e=EZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EZ(t){var e=TZ(t,"string");return typeof e=="symbol"?e:e+""}function TZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Wp=0;class _i{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;RZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,MZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Wp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Wp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Wp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function MZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Hi(this)},t}function _Z(){return Wp}function xZ(t,e){PZ(t,e),e.add(t)}function PZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function al(t,e,n){return(e=IZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IZ(t){var e=OZ(t,"string");return typeof e=="symbol"?e:e+""}function OZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var em=new WeakSet;class IR{constructor(e,n,r){xZ(this,em),al(this,"hot",void 0),al(this,"tableMeta",void 0),al(this,"selection",void 0),al(this,"eventManager",void 0),al(this,"destroyed",!1),al(this,"activeEditor",void 0),al(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new _i(e),this.hot.addHook("afterDocumentKeyDown",i=>xC(em,this,CI).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>xC(em,this,CI).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>xC(em,this,AZ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=g$(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function CI(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||_a(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!XE(n)&&!l$(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function AZ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const bI=new WeakMap;IR.getInstance=function(t,e,n){let r=bI.get(t);return r||(r=new IR(t,e,n),bI.set(t,r)),r};function HZ(t,e){m$(t,e),e.add(t)}function Bh(t,e,n){m$(t,e),e.set(t,n)}function m$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(Hs(t,e))}function Wh(t,e,n){return t.set(Hs(t,e),n),n}function Hs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yc=Object.freeze({CELL:"cell",MIXED:"mixed"});var bn=new WeakMap,tm=new WeakMap,nm=new WeakMap,rm=new WeakMap,im=new WeakMap,Sa=new WeakSet;class NZ{constructor(e){var n=this;HZ(this,Sa),Bh(this,bn,void 0),Bh(this,tm,void 0),Bh(this,nm,1),Bh(this,rm,null),Bh(this,im,new Map);const r=e.getSettings();Wh(bn,this,e),Wh(tm,this,r.imeFastEdit?Yc.MIXED:Yc.CELL),Mt(bn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Hs(Sa,n,kZ).call(n,...o)}),Mt(bn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Hs(Sa,n,SI).call(n,...o)}),Mt(bn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Hs(Sa,n,SI).call(n,...o)}),Mt(bn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Hs(Sa,n,DZ).call(n,...o)})}getFocusMode(){return Mt(tm,this)}setFocusMode(e){Object.values(Yc).includes(e)?Wh(tm,this,e):at(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Mt(nm,this)}setRefocusDelay(e){Wh(nm,this,e)}setRefocusElementGetter(e){Wh(rm,this,e)}getRefocusElement(){var e;return typeof Mt(rm,this)=="function"?Mt(rm,this).call(this):(e=Mt(bn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Mt(bn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Mt(bn,this).runHooks("modifyFocusedElement",s.row,s.col,r);Xo(a)||(a=r),a&&!((o=Mt(bn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Hs(Sa,this,ZE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mt(nm,this);if(Mt(bn,this).getSettings().imeFastEdit&&!((e=Mt(bn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=Mt(bn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),Mt(im,this).has(n)||Mt(im,this).set(n,vg(()=>{if(!Mt(bn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),Mt(im,this).get(n)()}}}function ZE(t){var e;const n=(e=Mt(bn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Mt(bn,this).selection.isCellVisible(n)){t(null);return}const r=Mt(bn,this).getCell(n.row,n.col,!0);r===null?Mt(bn,this).addHookOnce("afterScroll",()=>{t(Mt(bn,this).getCell(n.row,n.col,!0))}):t(r)}function SI(){Hs(Sa,this,ZE).call(this,t=>{const{activeElement:e}=Mt(bn,this).rootDocument;e&&Gv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function DZ(){Hs(Sa,this,ZE).call(this,t=>{this.getFocusMode()===Yc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function kZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Yc.MIXED:Yc.CELL)}var $Z=Pi,LZ=Ru,FZ=co,VZ=FZ("match"),BZ=function(t){var e;return $Z(t)&&((e=t[VZ])!==void 0?!!e:LZ(t)==="RegExp")},WZ=Tn,jZ=function(){var t=WZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},UZ=Rn,zZ=Ii,YZ=og,GZ=jZ,RI=RegExp.prototype,KZ=function(t){var e=t.flags;return e===void 0&&!("flags"in RI)&&!zZ(t,"flags")&&YZ(RI,t)?UZ(GZ,t):e},QE=mn,qZ=fh,XZ=Math.floor,PC=QE("".charAt),JZ=QE("".replace),IC=QE("".slice),ZZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,QZ=/\$([$&'`]|\d{1,2})/g,eQ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=QZ;return i!==void 0&&(i=qZ(i),l=ZZ),JZ(o,l,function(u,c){var h;switch(PC(c,0)){case"$":return"$";case"&":return t;case"`":return IC(e,0,n);case"'":return IC(e,s);case"<":h=i[IC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=XZ(d/10);return f===0?u:f<=a?r[f-1]===void 0?PC(c,1):r[f-1]+PC(c,1):u}h=r[d-1]}return h===void 0?"":h})},tQ=Et,nQ=Rn,eT=mn,EI=rg,rQ=En,iQ=Pi,oQ=BZ,jh=Iv,sQ=sg,aQ=KZ,lQ=eQ,uQ=co,cQ=uQ("replace"),hQ=TypeError,OC=eT("".indexOf);eT("".replace);var TI=eT("".slice),dQ=Math.max;tQ({target:"String",proto:!0},{replaceAll:function(e,n){var r=EI(this),i,o,s,a,l,u,c,h,d,f,g=0,p="";if(iQ(e)){if(i=oQ(e),i&&(o=jh(EI(aQ(e))),!~OC(o,"g")))throw new hQ("`.replaceAll` does not allow non-global regexes");if(s=sQ(e,cQ),s)return nQ(s,e,r,n)}for(a=jh(r),l=jh(e),u=rQ(n),u||(n=jh(n)),c=l.length,h=dQ(1,c),d=OC(a,l);d!==-1;)f=u?jh(n(l,d,a)):lQ(l,a,d,[],void 0,n),p+=TI(a,g,d)+f,g=d+c,d=d+h>a.length?-1:OC(a,l,d+h);return g<a.length&&(p+=TI(a,g)),p}});var fQ=Et,gQ=ph,mQ=Vr,pQ=Tn,wQ=rs,vQ=oi,yQ=Qa,CQ=ug,bQ=$n,p$=TypeError,w$=bQ(function(){[].keys().reduce(function(){},void 0)}),AC=!w$&&yQ("reduce",p$);fQ({target:"Iterator",proto:!0,real:!0,forced:w$||AC},{reduce:function(e){pQ(this);try{mQ(e)}catch(s){vQ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(AC)return CQ(AC,this,n?[e]:[e,r]);var i=wQ(this),o=0;if(gQ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new p$("Reduce of empty iterator with no initial value");return r}});const v$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},SQ=new RegExp(Object.keys(v$).map(t=>`(${t})`).join("|"),"gi");function RQ(t){return(t&&t.nodeName||"")==="TABLE"}function OR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let C=0;C<s;C+=1){const E=!f&&n&&C===0;let y="";if(f)y=`<th>${t.getColHeader(C-c)}</th>`;else if(E)y=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][C],{hidden:_,rowspan:I,colspan:M}=t.getCellMeta(d-h,C-c);if(!_){const P=[];if(I&&P.push(`rowspan="${I}"`),M&&P.push(`colspan="${M}"`),Jt(T))y=`<td ${P.join(" ")}></td>`;else{const z=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y=`<td ${P.join(" ")}>${z}</td>`}}}g.push(y)}const p=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function AR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Jt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function y$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,_=>{const I=_.match(/<td\b[^>]*?>/g)[0],M=/<p.*?>/g,P=_.substring(I.length,_.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(M,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${I}${P}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!RQ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,_)=>T+_.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(_=>{const I=_.querySelector("td")!==null;return I&&h.push(_),!I});f=T.length,d=f>0,f>1?n.nestedHeaders=Array.from(T).reduce((_,I)=>{const M=Array.from(I.cells).reduce((P,z,W)=>{if(a&&W===0)return P;const{colSpan:V,innerHTML:q}=z,Z=V>1?{label:q,colspan:V}:q;return P.push(Z),P},[]);return _.push(M),_},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((_,I,M)=>(a&&M===0||_.push(I.innerHTML),_),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const p=[...h,...Array.from(o.tBodies).reduce((T,_)=>(T.push(...Array.from(_.rows)),T),[]),...c];g=p.length;const C=new Array(g);for(let T=0;T<g;T++)C[T]=new Array(u);const E=[],y=[];for(let T=0;T<g;T++){const _=p[T],I=Array.from(_.cells),M=I.length;for(let P=0;P<M;P++){const z=I[P],{nodeName:W,innerHTML:V,rowSpan:q,colSpan:Z}=z,ee=C[T].findIndex(te=>te===void 0);if(W==="TD"){if(q>1||Z>1){for(let we=T;we<T+q;we++)if(we<g)for(let Ae=ee;Ae<ee+Z;Ae++)C[we][Ae]=null;const ce=z.getAttribute("style");ce&&ce.includes("mso-ignore:colspan")||E.push({col:ee,row:T,rowspan:q,colspan:Z})}let te="";s&&/excel/gi.test(s.content)?te=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[T][ee]=te.replace(SQ,ce=>v$[ce])}else y.push(V)}}return E.length&&(n.mergeCells=E),y.length&&(n.rowHeaders=y),C.length&&(n.data=C),n}const EQ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:AR,htmlToGridSettings:y$,instanceToHTML:OR},Symbol.toStringTag,{value:"Module"}));function Jn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function C$(t){return Jn(t,[","])}function ge(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function HR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function tT(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ze(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const TQ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ze,isNumeric:Jn,isNumericLike:C$,rangeEach:ge,rangeEachReverse:HR,valueAccordingPercent:tT},Symbol.toStringTag,{value:"Module"})),NR="asc",MQ="desc",MI=new Map([[NR,[-1,1]],[MQ,[1,-1]]]),_Q=t=>`The priority '${t}' is already declared in a map.`,xQ=t=>`The priority '${t}' is not a number.`;function PQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ft(t)?t:_Q,e=ft(e)?e:xQ;function r(o,s){if(!Jn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NR;const[s,a]=MI.get(o)||MI.get(NR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const IQ=t=>`The id '${t}' is already declared in a map.`;function Zv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ft(t)?t:IQ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const OQ=t=>`'${t}' value is already declared in a unique set.`;function AQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ft(t)?t:OQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const nT=t=>`There is already registered "${t}" plugin.`,HQ=t=>`There is already registered plugin on priority "${t}".`,NQ=t=>`The priority "${t}" is not a number.`,b$=PQ({errorPriorityExists:HQ,errorPriorityNaN:NQ}),S$=AQ({errorItemExists:nT}),DR=Zv({errorIdExists:nT});function rT(){return[...b$.getItems(),...S$.getItems()]}function bg(t){const e=nr(t);return DR.getItem(e)}function DQ(t){return!!bg(t)}function et(t,e,n){[t,e,n]=$Q(t,e,n),bg(t)===void 0&&kQ(t,e,n)}function kQ(t,e,n){const r=nr(t);if(DR.hasItem(r))throw new Error(nT(r));n===void 0?S$.addItem(r):b$.addItem(n,r),DR.addItem(r,e)}function $Q(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:LQ,getItem:FQ,hasItem:R$,getNames:VQ,getValues:k0e}=fo("renderers");function Nw(t){if(typeof t=="function")return t;if(!R$(t))throw Error(`No registered renderer found under "${t}" name`);return FQ(t)}function Gr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),LQ(t,e)}const{register:BQ,getItem:WQ,hasItem:E$,getNames:jQ,getValues:$0e}=fo("validators");function iT(t){if(typeof t=="function")return t;if(!E$(t))throw Error(`No registered validator found under "${t}" name`);return WQ(t)}function Jl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),BQ(t,e)}var UQ=Et,zQ=fh,YQ=mh,GQ=ag,KQ=Jv;UQ({target:"Array",proto:!0},{at:function(e){var n=zQ(this),r=YQ(n),i=GQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});KQ("at");var qQ=Et,XQ=mn,JQ=rg,ZQ=ag,QQ=Iv,eee=$n,tee=XQ("".charAt),nee=eee(function(){return"𠮷".at(-2)!=="\uD842"});qQ({target:"String",proto:!0,forced:nee},{at:function(e){var n=QQ(JQ(this)),r=n.length,i=ZQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:tee(n,o)}});function Uh(t,e,n){return(e=ree(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ree(t){var e=iee(t,"string");return typeof e=="symbol"?e:e+""}function iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oee{constructor(){Uh(this,"count",0),Uh(this,"startColumn",null),Uh(this,"endColumn",null),Uh(this,"startPosition",null),Uh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function zh(t,e,n){return(e=see(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function see(t){var e=aee(t,"string");return typeof e=="symbol"?e:e+""}function aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lee{constructor(){zh(this,"count",0),zh(this,"startRow",null),zh(this,"endRow",null),zh(this,"startPosition",null),zh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Yh(t,e,n){return(e=uee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uee(t){var e=cee(t,"string");return typeof e=="symbol"?e:e+""}function cee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T${constructor(){Yh(this,"count",0),Yh(this,"startColumn",null),Yh(this,"endColumn",null),Yh(this,"startPosition",null),Yh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Gh(t,e,n){return(e=hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hee(t){var e=dee(t,"string");return typeof e=="symbol"?e:e+""}function dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M${constructor(){Gh(this,"count",0),Gh(this,"startRow",null),Gh(this,"endRow",null),Gh(this,"startPosition",null),Gh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Kh(t,e,n){return(e=fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fee(t){var e=gee(t,"string");return typeof e=="symbol"?e:e+""}function gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mee{constructor(){Kh(this,"count",0),Kh(this,"startColumn",0),Kh(this,"endColumn",0),Kh(this,"startPosition",0),Kh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function qh(t,e,n){return(e=pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pee(t){var e=wee(t,"string");return typeof e=="symbol"?e:e+""}function wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vee{constructor(){qh(this,"count",0),qh(this,"startRow",0),qh(this,"endRow",0),qh(this,"startPosition",0),qh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function _I(t,e,n){return(e=yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:e+""}function Cee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bee extends T${constructor(){super(...arguments),_I(this,"columnStartOffset",0),_I(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function xI(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=Ree(t,"string");return typeof e=="symbol"?e:e+""}function Ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eee extends M${constructor(){super(...arguments),xI(this,"rowStartOffset",0),xI(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function PI(t,e,n){return(e=Tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tee(t){var e=Mee(t,"string");return typeof e=="symbol"?e:e+""}function Mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _${constructor(e){PI(this,"calculationTypes",[]),PI(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function ki(t,e,n){return(e=_ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ee(t){var e=xee(t,"string");return typeof e=="symbol"?e:e+""}function xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rh=50;class Pee extends _${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),ki(this,"viewportWidth",0),ki(this,"scrollOffset",0),ki(this,"zeroBasedScrollOffset",0),ki(this,"totalColumns",0),ki(this,"columnWidthFn",null),ki(this,"columnWidth",0),ki(this,"overrideFn",null),ki(this,"inlineStartOffset",0),ki(this,"totalCalculatedWidth",0),ki(this,"startPositions",[]),ki(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?rh:n}}function ui(t,e,n){return(e=Iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iee(t){var e=Oee(t,"string");return typeof e=="symbol"?e:e+""}function Oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aee extends _${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),ui(this,"viewportHeight",0),ui(this,"scrollOffset",0),ui(this,"zeroBasedScrollOffset",0),ui(this,"totalRows",0),ui(this,"rowHeightFn",null),ui(this,"rowHeight",0),ui(this,"overrideFn",null),ui(this,"horizontalScrollbarHeight",0),ui(this,"innerViewportHeight",0),ui(this,"totalCalculatedHeight",0),ui(this,"startPositions",[]),ui(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function Hee(t,e,n){Nee(t,e),e.set(t,n)}function Nee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function II(t,e,n){return(e=Dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vu(t,e){return t.get(x$(t,e))}function OI(t,e,n){return t.set(x$(t,e),n),n}function x$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hs=new WeakMap;class mu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;II(this,"row",null),II(this,"col",null),Hee(this,hs,!1),OI(hs,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Vu(hs,this)}isSouthEastOf(e){return this.row>=e.row&&(Vu(hs,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Vu(hs,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Vu(hs,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Vu(hs,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof mu&&OI(hs,this,e.isRtl()),this}clone(){return new mu(this.row,this.col,Vu(hs,this))}toObject(){return{row:this.row,col:this.col}}}function $ee(t,e,n){Lee(t,e),e.set(t,n)}function Lee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HC(t,e,n){return(e=Fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fee(t){var e=Vee(t,"string");return typeof e=="symbol"?e:e+""}function Vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ci(t,e){return t.get(P$(t,e))}function Bee(t,e,n){return t.set(P$(t,e),n),n}function P$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var br=new WeakMap;class Sg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;HC(this,"highlight",null),HC(this,"from",null),HC(this,"to",null),$ee(this,br,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Bee(br,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ci(br,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ci(br,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ci(br,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ci(br,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ci(br,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ci(br,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ci(br,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ci(br,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof mu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(ci(br,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(ci(br,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new Sg(this.highlight,this.from,this.to,ci(br,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new mu(e,n,ci(br,this))}}function wo(t,e,n){Wee(t,e),e.set(t,n)}function Wee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function me(t,e){return t.get(I$(t,e))}function ia(t,e,n){return t.set(I$(t,e),n),n}function I$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hi=new WeakMap,NC=new WeakMap,Hn=new WeakMap,Bu=new WeakMap,om=new WeakMap,$i=new WeakMap,DC=new WeakMap,Xh=new WeakMap,ll=new WeakMap,vo=new WeakMap;let O$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;wo(this,hi,void 0),wo(this,NC,void 0),wo(this,Hn,void 0),wo(this,Bu,void 0),wo(this,om,void 0),wo(this,$i,void 0),wo(this,DC,void 0),wo(this,Xh,void 0),wo(this,ll,[null,null]),wo(this,vo,[null,null]),ia(hi,this,r),ia(NC,this,n),ia(Hn,this,o),ia(Bu,this,s),ia(om,this,a),ia($i,this,i),ia(DC,this,e),this.registerEvents()}registerEvents(){me($i,this).addEventListener(me(Hn,this).holder,"contextmenu",r=>this.onContextMenu(r)),me($i,this).addEventListener(me(Hn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),me($i,this).addEventListener(me(Hn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{me($i,this).addEventListener(me(Hn,this).holder,"touchstart",r=>this.onTouchStart(r)),me($i,this).addEventListener(me(Hn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),me($i,this).addEventListener(me(Hn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||me(hi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,me(hi,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{me($i,this).addEventListener(me(Hn,this).holder,"mouseup",r=>this.onMouseUp(r)),me($i,this).addEventListener(me(Hn,this).holder,"mousedown",r=>this.onMouseDown(r))};Ko()?e():(YE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(me(Xh,this)&&r){const[i,o]=[r.row,me(Xh,this).from.row],[s,a]=[r.col,me(Xh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=me(Hn,this).TABLE,i=Vd(e,["TD","TH"],r);return i?(n.coords=me(Hn,this).getCoords(i),n.TD=i):Ce(e,"wtBorder")&&Ce(e,"current")?(n.coords=me(Bu,this).getFocusSelection().cellRange.highlight,n.TD=me(Hn,this).getCell(n.coords)):Ce(e,"wtBorder")&&Ce(e,"area")&&me(Bu,this).getAreaSelection().cellRange&&(n.coords=me(Bu,this).getAreaSelection().cellRange.to,n.TD=me(Hn,this).getCell(n.coords)),n}onMouseDown(e){const n=me(NC,this).rootDocument.activeElement,r=zE(Hk,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Ce(i,"corner")?me(hi,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&me(hi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(me(vo,this)[0]=o.TD,clearTimeout(me(ll,this)[0]),me(ll,this)[0]=setTimeout(()=>{me(vo,this)[0]=null},1e3))}onContextMenu(e){if(me(hi,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!me(hi,this).has("onCellMouseOver"))return;const n=me(Hn,this).TABLE,r=Vd(e.target,["TD","TH"],n),i=me(om,this)||this;r&&r!==i.lastMouseOver&&Ba(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,me(Hn,this).getCoords(r),r))}onMouseOut(e){if(!me(hi,this).has("onCellMouseOut"))return;const n=me(Hn,this).TABLE,r=Vd(e.target,["TD","TH"],n),i=Vd(e.relatedTarget,["TD","TH"],n),o=me(om,this)||this;r&&r!==i&&Ba(r,n)&&(this.callListener("onCellMouseOut",e,me(Hn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&me(hi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===me(vo,this)[0]&&n.TD===me(vo,this)[1]?(Ce(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),me(vo,this)[0]=null,me(vo,this)[1]=null):n.TD===me(vo,this)[0]&&(me(vo,this)[1]=n.TD,clearTimeout(me(ll,this)[1]),me(ll,this)[1]=setTimeout(()=>{me(vo,this)[1]=null},500)))}onTouchStart(e){ia(Xh,this,me(Bu,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&me(hi,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];KE()&&(i$()||o$())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=me(hi,this).getSettingPure(e);o&&o(n,r,i,me(DC,this).call(this))}destroy(){clearTimeout(me(ll,this)[0]),clearTimeout(me(ll,this)[1]),me($i,this).destroy()}};function kC(t,e,n){return(e=jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jee(t){var e=Uee(t,"string");return typeof e=="symbol"?e:e+""}function Uee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zee{constructor(e,n,r){kC(this,"offset",void 0),kC(this,"total",void 0),kC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function $C(t,e,n){return(e=Yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:e+""}function Gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kee{constructor(e,n,r){$C(this,"offset",void 0),$C(this,"total",void 0),$C(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function sm(t,e,n){return(e=qee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qee(t){var e=Xee(t,"string");return typeof e=="symbol"?e:e+""}function Xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jee{constructor(){sm(this,"currentSize",0),sm(this,"nextSize",0),sm(this,"currentOffset",0),sm(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Zee=0,AI=1,kR=2;function LC(t,e,n){return(e=Qee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qee(t){var e=ete(t,"string");return typeof e=="symbol"?e:e+""}function ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tte{constructor(){LC(this,"size",new Jee),LC(this,"workingSpace",Zee),LC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=AI,e.workingSpace=kR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=kR,e.workingSpace=AI,this.sharedSize=e.getViewSize()}}var HI=Pv,nte=TypeError,rte=function(t,e){if(!delete t[e])throw new nte("Cannot delete property "+HI(e)+" of "+HI(t))},ite=Et,ote=fh,ste=mh,ate=FN,lte=rte,ute=VN,cte=[].unshift(0)!==1,hte=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},dte=cte||!hte();ite({target:"Array",proto:!0,arity:1,forced:dte},{unshift:function(e){var n=ote(this),r=ste(n),i=arguments.length;if(i){ute(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:lte(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return ate(n,r+i)}});function fte(t,e,n){return(e=gte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gte(t){var e=mte(t,"string");return typeof e=="symbol"?e:e+""}function mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NI{constructor(e,n){fte(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function pte(t,e,n){return(e=wte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wte(t){var e=vte(t,"string");return typeof e=="symbol"?e:e+""}function vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yte{constructor(e){pte(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new NI(o,n),l=new NI(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(kR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Wu(t,e,n){return(e=Cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cte(t){var e=bte(t,"string");return typeof e=="symbol"?e:e+""}function bte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A${constructor(e,n){Wu(this,"rootNode",void 0),Wu(this,"nodesPool",void 0),Wu(this,"sizeSet",new tte),Wu(this,"collectedNodes",[]),Wu(this,"viewDiffer",new yte(this.sizeSet)),Wu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class H$ extends A${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function DI(t,e,n){return(e=Ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ste(t){var e=Rte(t,"string");return typeof e=="symbol"?e:e+""}function Rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ete{constructor(e){DI(this,"nodeType",void 0),DI(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Jh(t,e,n){return(e=Tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rg{constructor(e,n){Jh(this,"nodesPool",null),Jh(this,"nodeType",void 0),Jh(this,"rootNode",void 0),Jh(this,"table",null),Jh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Ete(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function kI(t,e,n){return(e=_te(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _te(t){var e=xte(t,"string");return typeof e=="symbol"?e:e+""}function xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pte extends Rg{constructor(){super("TH"),kI(this,"orderViews",new WeakMap),kI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new H$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Au(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Re(d,[L8(),G8(),HE(h+1),Iu(-1)]),n[h](a,d,h)}u.end()}}}class Ite extends Rg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&es(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Re(this.rootNode,[_k()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Re(s,[ER(),Ok(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Au(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Re(u,[HE(a+1+this.table.rowHeadersCount),Iu(-1),F8(),...a>=0?[Y8()]:[ER()]]),r[n](l,u,n)}}}}let $I=!1;class Ote extends Rg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!$I&&e>1e3&&($I=!0,at(mt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&X(r,"rowHeader")}}function Ate(t,e,n){return(e=Hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hte(t){var e=Nte(t,"string");return typeof e=="symbol"?e:e+""}function Nte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ju={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let LI=!1;class Dte extends Rg{constructor(e){super("TR",e),Ate(this,"orderView",void 0),this.orderView=new A$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!LI&&e>1e3&&(LI=!0,at(mt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Re(this.rootNode,[_k()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Re(o,[ER(),Ok(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?Ce(o,ju.rowEven)||(ve(o,ju.rowOdd),X(o,ju.rowEven)):Ce(o,ju.rowOdd)||(ve(o,ju.rowEven),X(o,ju.rowOdd))}this.orderView.end()}}function FI(t,e,n){return(e=kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kte(t){var e=$te(t,"string");return typeof e=="symbol"?e:e+""}function $te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lte extends Rg{constructor(){super("TD"),FI(this,"orderViews",new WeakMap),FI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new H$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(Ce(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Au(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;Re(g,[...g.hasAttribute("role")?[]:[$8()],Iu(-1),HE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function yn(t,e,n){return(e=Fte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fte(t){var e=Vte(t,"string");return typeof e=="symbol"?e:e+""}function Vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bte{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};yn(this,"rootNode",void 0),yn(this,"rootDocument",void 0),yn(this,"rowHeaders",null),yn(this,"columnHeaders",null),yn(this,"colGroup",null),yn(this,"rows",null),yn(this,"cells",null),yn(this,"rowFilter",null),yn(this,"columnFilter",null),yn(this,"rowUtils",null),yn(this,"columnUtils",null),yn(this,"rowsToRender",0),yn(this,"columnsToRender",0),yn(this,"rowHeaderFunctions",[]),yn(this,"rowHeadersCount",0),yn(this,"columnHeaderFunctions",[]),yn(this,"columnHeadersCount",0),yn(this,"cellRenderer",void 0),yn(this,"activeOverlayName",void 0),yn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class Wte{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Bte(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new Pte,columnHeaders:new Ite(n),colGroup:new Ote(r),rows:new Dte(i),cells:new Lte}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function FC(t,e,n){return(e=jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jte(t){var e=Ute(t,"string");return typeof e=="symbol"?e:e+""}function Ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zte{constructor(e,n){FC(this,"dataAccessObject",void 0),FC(this,"wtSettings",void 0),FC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function VI(t,e,n){return(e=Yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yte(t){var e=Gte(t,"string");return typeof e=="symbol"?e:e+""}function Gte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kte{constructor(e,n){VI(this,"dataAccessObject",void 0),VI(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function yo(t,e,n){return(e=qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Xte(t,"string");return typeof e=="symbol"?e:e+""}function Xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sh{constructor(e,n,r,i,o){yo(this,"wtSettings",null),yo(this,"domBindings",void 0),yo(this,"TBODY",null),yo(this,"THEAD",null),yo(this,"COLGROUP",null),yo(this,"hasTableHeight",!0),yo(this,"hasTableWidth",!0),yo(this,"isTableVisible",!1),yo(this,"tableOffset",0),yo(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,DE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Kte(this.dataAccessObject,this.wtSettings),this.columnUtils=new zte(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Wte({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Re(r,[Ls()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Re(r,[Ls()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",Re(r,[Iu(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Re(r.parentNode,[Ls()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Re(r,[Ls()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Wn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Wn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Kee(f,o,c),this.columnFilter=new zee(g,s,l);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),p=C.skipRender!==!0}p&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(jo)||this.is(ja))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(jo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(jo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=zc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(jo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ga(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=kk(r),s=n.cellIndex;ya(vu,n,this.wtRootElement)||ya(pu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):ya(ja,n,this.wtRootElement)||ya(jo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),ya(vu,n,this.wtRootElement)||ya(wu,n,this.wtRootElement)||ya(ja,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=zc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?dn:zc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return on(this.TABLE)}getHeight(){return dn(this.TABLE)}getTotalWidth(){const e=on(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=dn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return gu(this.TABLE)}_modifyRowHeaderWidth(e){let n=ft(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Jte="stickyRowsBottom",oT={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ss(oT,"MIXIN_NAME",Jte,{writable:!1,enumerable:!1});const Zte="stickyColumnsStart",Qv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ss(Qv,"MIXIN_NAME",Zte,{writable:!1,enumerable:!1});class sT extends Sh{constructor(e,n,r,i){super(e,n,r,i,ja)}}yt(sT,oT);yt(sT,Qv);const pu="top",jo="bottom",wu="inline_start",vu="top_inline_start_corner",ja="bottom_inline_start_corner",N$=[pu,jo,wu,vu,ja],Qte=new Map([[pu,`ht_clone_${pu}`],[jo,`ht_clone_${jo}`],[wu,`ht_clone_${wu} ht_clone_left`],[vu,`ht_clone_${vu} ht_clone_top_left_corner`],[ja,`ht_clone_${ja} ht_clone_bottom_left_corner`]]);function ene(t,e){tne(t,e),e.add(t)}function tne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nne(t,e,n){return(e=rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rne(t){var e=ine(t,"string");return typeof e=="symbol"?e:e+""}function ine(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function am(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zh=new WeakSet;class one{constructor(e){ene(this,Zh),nne(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Lr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Lr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return am(Zh,this,WI).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return am(Zh,this,WI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return am(Zh,this,BI).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return am(Zh,this,BI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function BI(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Wn(r.wtRootElement).left;const u=Math.abs($E(s,s));if(l>u){const c=LE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function WI(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Wn(n.wtRootElement),a=zv(o,o);if(s.top>a){const l=zc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function di(t,e,n){return(e=sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sne(t){var e=ane(t,"string");return typeof e=="symbol"?e:e+""}function ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aT{get eventManager(){return new _i(this)}constructor(e,n){di(this,"wtTable",void 0),di(this,"wtScroll",void 0),di(this,"wtViewport",void 0),di(this,"wtOverlays",void 0),di(this,"selectionManager",void 0),di(this,"wtEvent",void 0),di(this,"guid",`wt_${IE()}`),di(this,"drawInterrupted",!1),di(this,"drawn",!1),di(this,"activeOverlayName","master"),di(this,"domBindings",void 0),di(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new one(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Ka(r,e[n])}])}}createCellCoords(e,n){return new mu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new Sg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||Vk(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function jI(t,e,n){return(e=lne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lne(t){var e=une(t,"string");return typeof e=="symbol"?e:e+""}function une(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cne extends aT{constructor(e,n,r){super(e,n),jI(this,"cloneSource",void 0),jI(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new O$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function hne(t,e,n){return(e=dne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dne(t){var e=fne(t,"string");return typeof e=="symbol"?e:e+""}function fne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eg{constructor(e,n,r,i,o){hne(this,"wtSettings",null),ss(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=th(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=th(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Hf(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){at(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+On())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(N$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Qte.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Re(o,[Ls()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===pu||u==="vertical"&&this.type===wu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Hf(e.TABLE),new cne(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class gne extends Eg{constructor(e,n,r,i,o,s){super(e,n,ja,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new sT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else wg(n),this.repositionOverlay();let r=dn(this.clone.wtTable.TABLE);const i=on(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=On(r)),i.style.bottom=`${o}px`}}const mne="calculatedColumns",ey={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ss(ey,"MIXIN_NAME",mne,{writable:!1,enumerable:!1});class lT extends Sh{constructor(e,n,r,i){super(e,n,r,i,jo)}}yt(lT,oT);yt(lT,ey);function pne(t,e,n){return(e=wne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wne(t){var e=vne(t,"string");return typeof e=="symbol"?e:e+""}function vne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yne extends Eg{constructor(e,n,r,i){super(e,n,jo,r,i),pne(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new lT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=On(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Uv(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=On(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=dn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=On(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return zv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ce(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(ve(s,"innerBorderBottom"),o=a)}return o}}const Cne="calculatedRows",uT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ss(uT,"MIXIN_NAME",Cne,{writable:!1,enumerable:!1});class cT extends Sh{constructor(e,n,r,i){super(e,n,r,i,wu)}}yt(cT,uT);yt(cT,Qv);const bne="localHooks",jn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Iw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ss(jn,"MIXIN_NAME",bne,{writable:!1,enumerable:!1});let D$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};yt(D$,jn);const k$="active-header",hT="header",dT="area",ef="focus",Sne="fill",Rne="row",Ene="column",Tne="custom-selection",fT=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var Mne=Jv;Mne("flat");function _ne(t,e){$$(t,e),e.add(t)}function UI(t,e,n){$$(t,e),e.set(t,n)}function $$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gt(t,e){return t.get(tf(t,e))}function zI(t,e,n){return t.set(tf(t,e),n),n}function tf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ji=new WeakMap,Kn=new WeakMap,lm=new WeakSet;class xne{constructor(){_ne(this,lm),UI(this,ji,void 0),UI(this,Kn,void 0)}setActiveOverlay(e){return zI(Kn,this,e),this}setActiveSelection(e){return zI(ji,this,e),this}scan(){const e=Gt(ji,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Gt(ji,this).getCorners(),{wtTable:s}=Gt(Kn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const p=Gt(Kn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Gt(ji,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});p!==null&&(p!==h&&(g=s.getColumnHeader(p,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Gt(ji,this).getCorners(),{wtTable:s}=Gt(Kn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const p=Gt(Kn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Gt(ji,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});p!==null&&(p!==h&&(g=s.getRowHeader(p,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Gt(Kn,this);tf(lm,this,Pne).call(this,(r,i)=>{const o=n.getCell(Gt(Kn,this).createCellCoords(r,i)),s=Gt(Kn,this).getSetting("onAfterDrawSelection",r,i,Gt(ji,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Gt(ji,this).getCorners(),{wtTable:i}=Gt(Kn,this);tf(lm,this,YI).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Gt(Kn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Gt(ji,this).getCorners(),{wtTable:i}=Gt(Kn,this);tf(lm,this,YI).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Gt(Kn,this).createCellCoords(o,s));e(a)}})}}function Pne(t){let[e,n,r,i]=Gt(ji,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Gt(Kn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Gt(Kn,this).createCellCoords(e,n));if(!Xo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function YI(t){const{wtTable:e}=Gt(Kn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class GI{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=fT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Hi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ko()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Le(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};Le(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),p=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-p/4*3,10)}px`,c[l]=`${parseInt(i-p/4*3,10)}px`;const y=Math.min(parseInt(i+o,10),C-g-f*2),T=Math.min(parseInt(i+o-p/4,10),C-p-f*2);h[l]=`${y}px`,d[l]=`${T}px`;const _=Math.min(parseInt(r+s,10),E-g-f*2),I=Math.min(parseInt(r+s-p/4,10),E-p-f*2);h.top=`${_}px`,d.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!Xo(g)){this.disappear();return}const p=u?s.getCell(this.wot.createCellCoords(i,o)):g,C=Wn(g),E=u?Wn(p):C,y=Wn(s.TABLE),T=C.top,_=C.left,I=this.wot.wtSettings.getSetting("rtlMode");let M=0,P=0;if(I){const we=on(s.TABLE),Ae=on(g),ot=l.innerWidth-y.left-we;P=_+Ae-E.left,M=l.innerWidth-_-Ae-ot-1}else P=E.left+on(p)-_,M=_-y.left-1;if(this.isEntireColumnSelected(n,i)){const we=n,Ae=this.getDimensionsFromHeader("columns",r,o,we,y);let ot=null;Ae&&([ot,M,P]=Ae),ot&&(g=ot)}let z=T-y.top-1,W=E.top+dn(p)-T;if(this.isEntireRowSelected(r,o)){const we=r,Ae=this.getDimensionsFromHeader("rows",n,i,we,y);let ot=null;Ae&&([ot,z,W]=Ae),ot&&(g=ot)}const V=l.getComputedStyle(g);parseInt(V.borderTopWidth,10)>0&&(z+=1,W=W>0?W-1:0),parseInt(V[I?"borderRightWidth":"borderLeftWidth"],10)>0&&(M+=1,P=P>0?P-1:0);const q=I?"right":"left";this.topStyle.top=`${z}px`,this.topStyle[q]=`${M}px`,this.topStyle.width=`${P}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[q]=`${M}px`,this.startStyle.height=`${W}px`,this.startStyle.display="block";const Z=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${z+W-Z}px`,this.bottomStyle[q]=`${M}px`,this.bottomStyle.width=`${P}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[q]=`${M+P-Z}px`,this.endStyle.height=`${W+1}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[ce,je]=[i,o];if(te&&Array.isArray(te)&&([,,ce,je]=te),Ko()||!ee||this.isPartRange(ce,je))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[q]=`${M+P+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let we=th(s.TABLE);const Ae=we===l;Ae&&(we=a.documentElement);const ot=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,wn=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Ue=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ae?p.getBoundingClientRect().left:p.offsetLeft;let v=!1,w=0;I?(w=m-parseInt(this.cornerDefaultStyle.width,10)/2,v=w<0):(w=m+on(p)+parseInt(this.cornerDefaultStyle.width,10)/2,v=w>=LE(we)),v&&(this.cornerStyle[q]=`${Math.floor(M+P+this.cornerCenterPointOffset-wn-ot)}px`,this.cornerStyle[I?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const w=(Ae?p.getBoundingClientRect().top:p.offsetTop)+dn(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=zc(we),A=this.wot.stylesHandler.isClassicTheme();if(w){const L=Math.floor(z+W+this.cornerCenterPointOffset-Ue-ot);A?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}Ko()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,z,M,P,W)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,p=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return dn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return on(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(g=l(n,C-i),p=l(r,C-i),!g||!p)return!1;const E=Wn(g),y=Wn(p);return g&&p&&(h=E[f]-o[f]-1,d=y[f]+u(p)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?X(this[e],"hidden"):(Ce(this[e],"hidden")&&ve(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?X(this[e],"hidden"):ve(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ko()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Ine(t,e){L$(t,e),e.add(t)}function Uu(t,e,n){L$(t,e),e.set(t,n)}function L$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(t,e){return t.get(gT(t,e))}function KI(t,e,n){return t.set(gT(t,e),n),n}function gT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qn=new WeakMap,Ar=new WeakMap,VC=new WeakMap,Bd=new WeakMap,BC=new WeakMap,ul=new WeakMap,qI=new WeakSet;class One{constructor(e){Ine(this,qI),Uu(this,qn,void 0),Uu(this,Ar,void 0),Uu(this,VC,new xne),Uu(this,Bd,new WeakMap),Uu(this,BC,new WeakSet),Uu(this,ul,new Map),KI(Ar,this,e)}setActiveOverlay(e){return KI(qn,this,e),Fe(VC,this).setActiveOverlay(Fe(qn,this)),Fe(Bd,this).has(Fe(qn,this))||Fe(Bd,this).set(Fe(qn,this),new Set),this}getFocusSelection(){return Fe(Ar,this)!==null?Fe(Ar,this).getFocus():null}getAreaSelection(){return Fe(Ar,this)!==null?Fe(Ar,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Fe(ul,this).has(e)){const r=Fe(ul,this).get(e);if(r.has(Fe(qn,this)))return r.get(Fe(qn,this));const i=new GI(Fe(qn,this),e.settings);return r.set(Fe(qn,this),i),i}const n=new GI(Fe(qn,this),e.settings);return Fe(ul,this).set(e,new Map([[Fe(qn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Fe(ul,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Fe(ul,this).get(e).forEach(n=>n.destroy()),Fe(ul,this).delete(e)}render(e){if(Fe(Ar,this)===null)return;e&&gT(qI,this,Ane).call(this);const n=Array.from(Fe(Ar,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Fe(BC,this).has(s)||(Fe(BC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Fe(VC,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const p=r.get(g);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();Fe(qn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Fe(Bd,this).get(Fe(qn,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=Fe(Ar,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Re(s,Fe(Ar,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Re(o,[...i.get(o)])})}}function Ane(){const t=Fe(Bd,this).get(Fe(qn,this)),e=Fe(qn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Fe(qn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Fe(Ar,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Fe(Ar,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Fe(Ar,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Fe(Ar,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ve(o[a],n),Au(o[a],s)}),t.clear()}class Hne extends Eg{constructor(e,n,r,i){super(e,n,wu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new cT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Yv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),wg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,kE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=On(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=on(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=fT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!Ce(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=On(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Wk(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs($E(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?ve(r,"emptyRows"):X(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=Ce(r,"innerBorderInlineStart");e?(X(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(ve(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const Nne="stickyRowsTop",mT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ss(mT,"MIXIN_NAME",Nne,{writable:!1,enumerable:!1});class pT extends Sh{constructor(e,n,r,i){super(e,n,r,i,vu)}}yt(pT,mT);yt(pT,Qv);function XI(t,e,n){return(e=Dne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dne(t){var e=kne(t,"string");return typeof e=="symbol"?e:e+""}function kne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ne extends Eg{constructor(e,n,r,i,o,s){super(e,n,vu,r,i),XI(this,"topOverlay",void 0),XI(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new pT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Yv(e,`${i}px`,`${o}px`)}else wg(e);let n=dn(this.clone.wtTable.TABLE);const r=on(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class wT extends Sh{constructor(e,n,r,i){super(e,n,r,i,pu)}}yt(wT,mT);yt(wT,ey);function Lne(t,e,n){return(e=Fne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fne(t){var e=Vne(t,"string");return typeof e=="symbol"?e:e+""}function Vne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bne extends Eg{constructor(e,n,r,i){super(e,n,pu,r,i),Lne(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new wT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Yv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),wg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Uv(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=On(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=dn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=fT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Ce(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=On(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Bk(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return zv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?ve(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Ce(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(ve(i,"innerBorderTop"),a=h)}}return a}}function um(t,e,n){Wne(t,e),e.set(t,n)}function Wne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(t,e,n){return(e=jne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jne(t){var e=Une(t,"string");return typeof e=="symbol"?e:e+""}function Une(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cl(t,e,n){return t.set(F$(t,e),n),n}function fs(t,e){return t.get(F$(t,e))}function F$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zu=new WeakMap,cm=new WeakMap,Yu=new WeakMap,hm=new WeakMap;class zne{constructor(e,n,r,i,o,s){ds(this,"wot",null),um(this,zu,[]),ds(this,"topOverlay",null),ds(this,"bottomOverlay",null),ds(this,"inlineStartOverlay",null),ds(this,"topInlineStartCornerOverlay",null),ds(this,"bottomInlineStartCornerOverlay",null),ds(this,"browserLineHeight",void 0),ds(this,"wtSettings",null),um(this,cm,!1),um(this,Yu,0),um(this,hm,null),ds(this,"resizeObserver",new ResizeObserver(c=>{Df(()=>{!Array.isArray(c)||!c.length||(cl(Yu,this,fs(Yu,this)+1),fs(Yu,this)===100&&(at("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),fs(hm,this)!==null&&clearTimeout(fs(hm,this)),cl(hm,this,setTimeout(()=>{cl(Yu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=On(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Hf(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...fs(zu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Bne(...e),this.bottomOverlay=new yne(...e),this.inlineStartOverlay=new Hne(...e),this.topInlineStartCornerOverlay=new $ne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new gne(...e,this.bottomOverlay,this.inlineStartOverlay),cl(zu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){cl(cm,this,fs(zu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),fs(zu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),fs(zu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!GE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Df(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{cl(Yu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=bh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!fs(cm,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),cl(cm,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Hf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),p=f()?1:0,C=g()?1:0;d.width=`${c+C}px`,d.height=`${u+p}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return x(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];x(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function JI(t,e,n){return(e=Yne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yne(t){var e=Gne(t,"string");return typeof e=="symbol"?e:e+""}function Gne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kne{constructor(e){JI(this,"settings",{}),JI(this,"defaults",Object.freeze(this.getDefaults())),Le(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Ka(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Le(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class vT extends Sh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=th(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Nf(e,"height",n),o=Nf(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=gu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}yt(vT,uT);yt(vT,ey);class qne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new vee:new Eee],["fullyVisible",()=>new lee],["partiallyVisible",()=>new M$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new mee:new bee],["fullyVisible",()=>new oee],["partiallyVisible",()=>new T$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=dn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Wn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=dn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=on(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=On(this.domBindings.rootDocument),new Aee({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=On(this.domBindings.rootDocument)),new Pee({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){Le(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function Xne(t,e){V$(t,e),e.add(t)}function hl(t,e,n){V$(t,e),e.set(t,n)}function V$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(eo(t,e))}function Qi(t,e,n){return t.set(eo(t,e),n),n}function eo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ZI=23;var Ao=new WeakMap,Ns=new WeakMap,yT=new WeakMap,$R=new WeakMap,Ca=new WeakMap,Wd=new WeakMap,Lf=new WeakMap,Do=new WeakSet;class Jne{constructor(e){Xne(this,Do),hl(this,Ao,void 0),hl(this,Ns,void 0),hl(this,yT,void 0),hl(this,$R,void 0),hl(this,Ca,!0),hl(this,Wd,{}),hl(this,Lf,{}),Qi(Ns,this,e.rootTable.parentElement.parentElement),Qi($R,this,e.rootDocument)}isClassicTheme(){return $t(Ca,this)}getCSSVariableValue(e){var n;if($t(Ca,this))return null;if($t(Wd,this)[`--ht-${e}`])return $t(Wd,this)[`--ht-${e}`];const r=(n=eo(Do,this,tre).call(this,`--ht-${e}`))!==null&&n!==void 0?n:eo(Do,this,B$).call(this,`--ht-${e}`);if(r!==null)return $t(Wd,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=$t(Lf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if($t(Ca,this))return ZI;const e=eo(Do,this,Zne).call(this);return!e&&Ce($t(Ns,this),"ht-wrapper")?(at(`The "${$t(Ao,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Qi(Ca,this,!0),this.useTheme(),ZI):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){eo(Do,this,QI).call(this),Qi(Ca,this,!0),Qi(Ao,this,e||void 0);return}e&&e!==$t(Ao,this)&&($t(Ao,this)&&eo(Do,this,nre).call(this),Qi(Ao,this,e),Qi(Ca,this,!1),eo(Do,this,Qne).call(this),eo(Do,this,QI).call(this))}getThemeName(){return $t(Ao,this)}removeClassNames(){Ce($t(Ns,this),$t(Ao,this))&&ve($t(Ns,this),$t(Ao,this))}}function Zne(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Qne(){ve($t(Ns,this),/ht-theme-.*/g),X($t(Ns,this),$t(Ao,this))}function QI(){this.isClassicTheme()||Qi(yT,this,getComputedStyle($t(Ns,this)));const t=eo(Do,this,ere).call(this,["box-sizing","border-bottom-width"]);$t(Lf,this).td={...$t(Lf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function ere(t){const e=$t($R,this),n=$t(Ns,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function tre(t){const e=Math.ceil(parseFloat(eo(Do,this,B$).call(this,t)));return Number.isNaN(e)?null:e}function B$(t){const e=$t(yT,this).getPropertyValue(t);return e===""?null:e}function nre(){Qi(Lf,this,{}),Qi(Wd,this,{}),Qi(Ca,this,!0)}class rre extends aT{constructor(e,n){super(e,new Kne(n)),this.stylesHandler=new Jne(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new vT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new qne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new One(this.wtSettings.getSetting("selections")),this.wtEvent=new O$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new zne(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Le(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),ve(this.wtTable.wtRootElement.parentNode,n),X(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!N$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class CT{constructor(e){e instanceof aT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new CT(n);return()=>r},this._wot=new rre(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function eO(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function ire(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const ore=new Map([["mousedown",eO],["mouseover",ire],["touchstart",eO]]);function tO(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;ore.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Xv(t)||t.type==="touchstart",isRightClick:qa(t)})}const W$=new WeakMap,bT=Symbol("rootInstance");function sre(t){W$.set(t,!0)}function are(t){return t===bT}function jp(t){return W$.has(t)}function lre(t,e){j$(t,e),e.add(t)}function oa(t,e,n){j$(t,e),e.set(t,n)}function j$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sa(t,e,n){return(e=ure(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ure(t){var e=cre(t,"string");return typeof e=="symbol"?e:e+""}function cre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function an(t,e){return t.get(Gc(t,e))}function Sr(t,e,n){return t.set(Gc(t,e),n),n}function Gc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var WC=new WeakMap,dm=new WeakMap,fm=new WeakMap,gs=new WeakMap,Li=new WeakMap,jC=new WeakMap,UC=new WeakMap,Gu=new WeakMap,jd=new WeakSet;class hre{constructor(e){lre(this,jd),sa(this,"hot",void 0),sa(this,"eventManager",void 0),sa(this,"settings",void 0),sa(this,"THEAD",void 0),sa(this,"TBODY",void 0),sa(this,"_wt",void 0),sa(this,"activeWt",void 0),oa(this,WC,0),oa(this,dm,0),sa(this,"postponedAdjustElementsSize",!1),oa(this,fm,!1),oa(this,gs,void 0),oa(this,Li,void 0),oa(this,jC,0),oa(this,UC,0),oa(this,Gu,null),this.hot=e,this.eventManager=new _i(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Gc(jd,this,fre).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),X(e,"handsontable"),Sr(Li,this,n.createElement("TABLE")),X(an(Li,this),"htCore"),this.hot.getSettings().tableClassName&&X(an(Li,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Re(an(Li,this),[Ls()]),Re(e,[k8(),Ik(-1),jv(this.hot.countCols()),X8()])),this.THEAD=n.createElement("THEAD"),an(Li,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),an(Li,this).appendChild(this.TBODY),this.hot.table=an(Li,this),this.hot.container.insertBefore(an(Li,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Sr(fm,this,!0),this.isTextSelectionAllowed(a.target)||(TR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Sr(fm,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{an(fm,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&TR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&Xv(a)&&r.finish(),Sr(gs,this,!1);const l=Gv(n.activeElement);Qd(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!qa(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&qa(a)&&(r.finish(),Sr(gs,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),Sr(gs,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(an(gs,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=On(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=fu(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=fu(s);this.eventManager.addEventListener(an(Li,this),"selectstart",a=>{this.settings.fragmentSelection||Qd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&X(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&ve(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:an(Li,this),isDataViewInstance:()=>jp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Sr(dm,this,o.length),this.hot.getSettings().ariaTags&&Gc(jd,this,U$).call(this)===this.hot.countCols()&&Gc(jd,this,dre).call(this,an(dm,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Sr(WC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let p=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,p,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,p,f),this.hot.runHooks("afterRenderer",a,l,u,g,p,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&gu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Sr(gs,this,!0),Sr(Gu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!_a(o)&&(tO(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Sr(gs,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!_a(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!_a(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!_a(o)&&(an(gs,this)&&(!an(Gu,this)||an(Gu,this).x!==o.clientX||an(Gu,this).y!==o.clientY)&&tO(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Sr(Gu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(_a(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,p,C,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,1)):p,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new CT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Qd(e))return!0;const n=Ba(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return an(gs,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Ce(r,"relative")){es(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;Ce(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",X(s,["relative",...o()])):(es(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Re(a,...Ls()),Re(l,...Ls())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ce(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ce(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Hu(e,r(n,i)):(Ka(e," "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Sr(jC,this,e),Sr(UC,this,n)}getLastSize(){return{width:an(jC,this),height:an(UC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return an(WC,this)}getRowHeadersCount(){return an(dm,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function U$(){return parseInt(this.hot.rootElement.getAttribute(jv()[0]),10)}function dre(t){const e=Gc(jd,this,U$).call(this)+t;Re(this.hot.rootElement,...jv(e))}function fre(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):ve(t,"htHasScrollY"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):ve(t,"htHasScrollX")}var gre=Et,mre=Rn,pre=ph,wre=Vr,vre=Tn,yre=rs,Cre=oi,bre=Qa,zC=bre("every",TypeError);gre({target:"Iterator",proto:!0,real:!0,forced:zC},{every:function(e){vre(this);try{wre(e)}catch(i){Cre(this,"throw",i)}if(zC)return mre(zC,this,e);var n=yre(this),r=0;return!pre(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const z$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",LR=z$.length;function ty(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%LR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/LR,10);return n}function Sre(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=LR**r*(z$.indexOf(t[n])+1);return e-=1,e}function Rre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(ty(i)+(r+1));n.push(o)}return n}function Ere(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=ty(i)+(r+1);n.push(o)}return n}function Tre(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function ST(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function RT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&$e(t[0])&&(e=qv(t[0]))),e}function Y$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function G$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const Mre=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:RT,createEmptySpreadsheetData:Tre,createSpreadsheetData:Rre,createSpreadsheetObjectData:Ere,dataRowToChangesArray:ST,isArrayOfArrays:Y$,isArrayOfObjects:G$,spreadsheetColumnIndex:Sre,spreadsheetColumnLabel:ty},Symbol.toStringTag,{value:"Module"}));function Qh(t,e,n){return(e=_re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _re(t){var e=xre(t,"string");return typeof e=="symbol"?e:e+""}function xre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Qh(this,"hot",void 0),Qh(this,"data",void 0),Qh(this,"dataType","array"),Qh(this,"colToProp",()=>{}),Qh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return x(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):ge(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if($e(a)||ft(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;ge(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Vp(l,d,f):l[d]=f}})}else Le(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Vp(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Lr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Vp(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Qk(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Lr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return ge(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return RT(this.data)}destroy(){this.data=null,this.hot=null}}var Ire=Et,Ore=Rn,Are=ph,Hre=Vr,Nre=Tn,Dre=rs,kre=oi,$re=Qa,YC=$re("some",TypeError);Ire({target:"Iterator",proto:!0,real:!0,forced:YC},{some:function(e){Nre(this);try{Hre(e)}catch(i){kre(this,"throw",i)}if(YC)return Ore(YC,this,e);var n=Dre(this),r=0;return Are(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function nO(t,e,n){return(e=Lre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lre(t){var e=Fre(t,"string");return typeof e=="symbol"?e:e+""}function Fre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;nO(this,"indexedValues",[]),nO(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ft(this.initValueOrFn)?ge(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):ge(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}yt(Nu,jn);function ET(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>ft(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function TT(t,e){return Ya(t,(n,r)=>e.includes(r)===!1)}class el extends Nu{insert(e,n){this.indexedValues=ET(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=TT(this.indexedValues,e),super.remove(e)}}class ny extends el{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Mn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function MT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Ff(t,e){return Ya(t,n=>e.includes(n)===!1)}function _T(t,e){return Xe(t,n=>n-e.filter(r=>r<n).length)}function xT(t,e){const n=e[0],r=e.length;return Xe(t,i=>i>=n?i+r:i)}function Vre(t,e,n){return(e=Bre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bre(t){var e=Wre(t,"string");return typeof e=="symbol"?e:e+""}function Wre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ry extends Nu{constructor(){super(...arguments),Vre(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ff(this.orderOfIndexes,[e]),ft(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=ET(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=xT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=TT(this.indexedValues,e),this.orderOfIndexes=Ff(this.orderOfIndexes,e),this.orderOfIndexes=_T(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Tg extends el{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Mn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const rO=new Map([["indexesSequence",{getListWithInsertedItems:MT,getListWithRemovedItems:Ff}],["physicallyIndexed",{getListWithInsertedItems:ET,getListWithRemovedItems:TT}]]),K$=t=>{if(rO.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return rO.get(t)};class q$ extends Nu{constructor(){super(e=>e)}insert(e,n){const r=xT(this.indexedValues,n);this.indexedValues=MT(r,e,n),super.insert(e,n)}remove(e){const n=Ff(this.indexedValues,e);this.indexedValues=_T(n,e),super.remove(e)}}const iO=new Map([["hiding",ny],["index",Nu],["linkedPhysicalIndexToValue",ry],["physicalIndexToValue",el],["trimming",Tg]]);function jre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!iO.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(iO.get(t))(e)}function Ure(t,e,n){return(e=zre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zre(t){var e=Yre(t,"string");return typeof e=="symbol"?e:e+""}function Yre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let FR=0;class PT{constructor(){Ure(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),FR+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),FR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Lt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}yt(PT,jn);function Gre(){return FR}function GC(t,e,n){return(e=Kre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kre(t){var e=qre(t,"string");return typeof e=="symbol"?e:e+""}function qre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oO extends PT{constructor(e,n){super(),GC(this,"mergedValuesCache",[]),GC(this,"aggregationFunction",void 0),GC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Xe(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Xe(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Xre(t,e,n){Jre(t,e),e.set(t,n)}function Jre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zre(t,e,n){return t.set(X$(t,e),n),n}function Qre(t,e){return t.get(X$(t,e))}function X$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var KC=new WeakMap;class J${constructor(){Xre(this,KC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Qre(KC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Zre(KC,this,e)}}yt(J$,jn);function sO(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function ed(t,e,n){eie(t,e),e.set(t,n)}function eie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fi(t,e){return t.get(Z$(t,e))}function gm(t,e,n){return t.set(Z$(t,e),n),n}function Z$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mm=new WeakMap,td=new WeakMap,pm=new WeakMap,wm=new WeakMap,vm=new WeakMap;class tie{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ed(this,mm,new Set),ed(this,td,[]),ed(this,pm,[]),ed(this,wm,!1),ed(this,vm,!1),gm(vm,this,e??!1)}createObserver(){const e=new J$;return fi(mm,this).add(e),e.addLocalHook("unsubscribe",()=>{fi(mm,this).delete(e)}),e._writeInitialChanges(sO(fi(td,this),fi(pm,this))),e}emit(e){let n=fi(pm,this);(!fi(wm,this)||fi(td,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(fi(vm,this)):gm(td,this,new Array(e.length).fill(fi(vm,this))),fi(wm,this)||(gm(wm,this,!0),n=fi(td,this)));const r=sO(n,e);fi(mm,this).forEach(i=>i._write(r)),gm(pm,this,e)}}function sr(t,e,n){return(e=nie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nie(t){var e=rie(t,"string");return typeof e=="symbol"?e:e+""}function rie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VR{constructor(){sr(this,"indexesSequence",new q$),sr(this,"trimmingMapsCollection",new oO(e=>e.some(n=>n===!0),!1)),sr(this,"hidingMapsCollection",new oO(e=>e.some(n=>n===!0),!1)),sr(this,"variousMapsCollection",new PT),sr(this,"hidingChangesObservable",new tie({initialIndexValue:!1})),sr(this,"notTrimmedIndexesCache",[]),sr(this,"notHiddenIndexesCache",[]),sr(this,"isBatched",!1),sr(this,"indexesSequenceChanged",!1),sr(this,"indexesChangeSource",void 0),sr(this,"trimmedIndexesChanged",!1),sr(this,"hiddenIndexesChanged",!1),sr(this,"renderablePhysicalIndexesCache",[]),sr(this,"fromPhysicalToVisualIndexesCache",new Map),sr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,jre(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Tg?this.trimmingMapsCollection.register(e,n):n instanceof ny?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Xe(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Ff(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(MT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Xe(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}yt(VR,jn);function iie(t,e){return Le(e,(n,r)=>{Lt(t[r])&&(t[r]=n)}),t}function Q$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function eL(t){le(t)&&JE(mt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function oie(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:sie,getValues:aie}=fo("phraseFormatters");function lie(t,e){sie(t,e)}function uie(){return aie()}lie("pluralize",oie);const tL="ContextMenu:items",Oe=tL,IT=`${Oe}.noItems`,OT=`${Oe}.insertRowAbove`,AT=`${Oe}.insertRowBelow`,HT=`${Oe}.insertColumnOnTheLeft`,NT=`${Oe}.insertColumnOnTheRight`,DT=`${Oe}.removeRow`,kT=`${Oe}.removeColumn`,$T=`${Oe}.undo`,LT=`${Oe}.redo`,Dw=`${Oe}.readOnly`,FT=`${Oe}.clearColumn`,VT=`${Oe}.copy`,BT=`${Oe}.copyWithHeaders`,WT=`${Oe}.copyWithGroupHeaders`,jT=`${Oe}.copyHeadersOnly`,UT=`${Oe}.cut`,zT=`${Oe}.freezeColumn`,YT=`${Oe}.unfreezeColumn`,GT=`${Oe}.mergeCells`,KT=`${Oe}.unmergeCells`,qT=`${Oe}.addComment`,XT=`${Oe}.editComment`,JT=`${Oe}.removeComment`,ZT=`${Oe}.readOnlyComment`,QT=`${Oe}.align`,eM=`${Oe}.align.left`,tM=`${Oe}.align.center`,nM=`${Oe}.align.right`,rM=`${Oe}.align.justify`,iM=`${Oe}.align.top`,oM=`${Oe}.align.middle`,sM=`${Oe}.align.bottom`,aM=`${Oe}.borders`,lM=`${Oe}.borders.top`,uM=`${Oe}.borders.right`,cM=`${Oe}.borders.bottom`,hM=`${Oe}.borders.left`,dM=`${Oe}.borders.remove`,fM=`${Oe}.nestedHeaders.insertChildRow`,gM=`${Oe}.nestedHeaders.detachFromParent`,mM=`${Oe}.hideColumn`,pM=`${Oe}.showColumn`,wM=`${Oe}.hideRow`,vM=`${Oe}.showRow`,yr="Filters:",Zt=`${yr}conditions`,iy=`${Zt}.none`,yM=`${Zt}.isEmpty`,CM=`${Zt}.isNotEmpty`,bM=`${Zt}.isEqualTo`,SM=`${Zt}.isNotEqualTo`,RM=`${Zt}.beginsWith`,EM=`${Zt}.endsWith`,TM=`${Zt}.contains`,MM=`${Zt}.doesNotContain`,cie=`${Zt}.byValue`,_M=`${Zt}.greaterThan`,xM=`${Zt}.greaterThanOrEqualTo`,PM=`${Zt}.lessThan`,IM=`${Zt}.lessThanOrEqualTo`,OM=`${Zt}.isBetween`,AM=`${Zt}.isNotBetween`,HM=`${Zt}.after`,NM=`${Zt}.before`,DM=`${Zt}.today`,kM=`${Zt}.tomorrow`,$M=`${Zt}.yesterday`,LM=`${yr}labels.filterByCondition`,FM=`${yr}labels.filterByValue`,VM=`${yr}labels.conjunction`,oy=`${yr}labels.disjunction`,kw=`${yr}values.blankCells`,BM=`${yr}buttons.selectAll`,WM=`${yr}buttons.clear`,jM=`${yr}buttons.ok`,UM=`${yr}buttons.cancel`,zM=`${yr}buttons.placeholder.search`,YM=`${yr}buttons.placeholder.value`,GM=`${yr}buttons.placeholder.secondValue`,KM="CheckboxRenderer:",qM=`${KM}checked`,XM=`${KM}unchecked`,hie=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:qM,CHECKBOX_RENDERER_NAMESPACE:KM,CHECKBOX_UNCHECKED:XM,CONTEXTMENU_ITEMS_ADD_COMMENT:qT,CONTEXTMENU_ITEMS_ALIGNMENT:QT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:sM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:tM,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:rM,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:eM,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:oM,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:nM,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:iM,CONTEXTMENU_ITEMS_BORDERS:aM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:cM,CONTEXTMENU_ITEMS_BORDERS_LEFT:hM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:uM,CONTEXTMENU_ITEMS_BORDERS_TOP:lM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:FT,CONTEXTMENU_ITEMS_COPY:VT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:jT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:WT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:BT,CONTEXTMENU_ITEMS_CUT:UT,CONTEXTMENU_ITEMS_EDIT_COMMENT:XT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:zT,CONTEXTMENU_ITEMS_HIDE_COLUMN:mM,CONTEXTMENU_ITEMS_HIDE_ROW:wM,CONTEXTMENU_ITEMS_INSERT_LEFT:HT,CONTEXTMENU_ITEMS_INSERT_RIGHT:NT,CONTEXTMENU_ITEMS_MERGE_CELLS:GT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:gM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:fM,CONTEXTMENU_ITEMS_NO_ITEMS:IT,CONTEXTMENU_ITEMS_READ_ONLY:Dw,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:ZT,CONTEXTMENU_ITEMS_REDO:LT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:dM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:kT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:JT,CONTEXTMENU_ITEMS_REMOVE_ROW:DT,CONTEXTMENU_ITEMS_ROW_ABOVE:OT,CONTEXTMENU_ITEMS_ROW_BELOW:AT,CONTEXTMENU_ITEMS_SHOW_COLUMN:pM,CONTEXTMENU_ITEMS_SHOW_ROW:vM,CONTEXTMENU_ITEMS_UNDO:$T,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:YT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:KT,CONTEXT_MENU_ITEMS_NAMESPACE:tL,FILTERS_BUTTONS_CANCEL:UM,FILTERS_BUTTONS_CLEAR:WM,FILTERS_BUTTONS_OK:jM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:zM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:GM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:YM,FILTERS_BUTTONS_SELECT_ALL:BM,FILTERS_CONDITIONS_AFTER:HM,FILTERS_CONDITIONS_BEFORE:NM,FILTERS_CONDITIONS_BEGINS_WITH:RM,FILTERS_CONDITIONS_BETWEEN:OM,FILTERS_CONDITIONS_BY_VALUE:cie,FILTERS_CONDITIONS_CONTAINS:TM,FILTERS_CONDITIONS_EMPTY:yM,FILTERS_CONDITIONS_ENDS_WITH:EM,FILTERS_CONDITIONS_EQUAL:bM,FILTERS_CONDITIONS_GREATER_THAN:_M,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:xM,FILTERS_CONDITIONS_LESS_THAN:PM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:IM,FILTERS_CONDITIONS_NAMESPACE:Zt,FILTERS_CONDITIONS_NONE:iy,FILTERS_CONDITIONS_NOT_BETWEEN:AM,FILTERS_CONDITIONS_NOT_CONTAIN:MM,FILTERS_CONDITIONS_NOT_EMPTY:CM,FILTERS_CONDITIONS_NOT_EQUAL:SM,FILTERS_CONDITIONS_TODAY:DM,FILTERS_CONDITIONS_TOMORROW:kM,FILTERS_CONDITIONS_YESTERDAY:$M,FILTERS_DIVS_FILTER_BY_CONDITION:LM,FILTERS_DIVS_FILTER_BY_VALUE:FM,FILTERS_LABELS_CONJUNCTION:VM,FILTERS_LABELS_DISJUNCTION:oy,FILTERS_NAMESPACE:yr,FILTERS_VALUES_BLANK_CELLS:kw},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const nL={languageCode:"en-US",[IT]:"No available options",[OT]:"Insert row above",[AT]:"Insert row below",[HT]:"Insert column left",[NT]:"Insert column right",[DT]:["Remove row","Remove rows"],[kT]:["Remove column","Remove columns"],[$T]:"Undo",[LT]:"Redo",[Dw]:"Read only",[FT]:"Clear column",[QT]:"Alignment",[eM]:"Left",[tM]:"Center",[nM]:"Right",[rM]:"Justify",[iM]:"Top",[oM]:"Middle",[sM]:"Bottom",[zT]:"Freeze column",[YT]:"Unfreeze column",[aM]:"Borders",[lM]:"Top",[uM]:"Right",[cM]:"Bottom",[hM]:"Left",[dM]:"Remove border(s)",[qT]:"Add comment",[XT]:"Edit comment",[JT]:"Delete comment",[ZT]:"Read-only comment",[GT]:"Merge cells",[KT]:"Unmerge cells",[VT]:"Copy",[BT]:["Copy with header","Copy with headers"],[WT]:["Copy with group header","Copy with group headers"],[jT]:["Copy header only","Copy headers only"],[UT]:"Cut",[fM]:"Insert child row",[gM]:"Detach from parent",[mM]:["Hide column","Hide columns"],[pM]:["Show column","Show columns"],[wM]:["Hide row","Hide rows"],[vM]:["Show row","Show rows"],[iy]:"None",[yM]:"Is empty",[CM]:"Is not empty",[bM]:"Is equal to",[SM]:"Is not equal to",[RM]:"Begins with",[EM]:"Ends with",[TM]:"Contains",[MM]:"Does not contain",[_M]:"Greater than",[xM]:"Greater than or equal to",[PM]:"Less than",[IM]:"Less than or equal to",[OM]:"Is between",[AM]:"Is not between",[HM]:"After",[NM]:"Before",[DM]:"Today",[kM]:"Tomorrow",[$M]:"Yesterday",[kw]:"Blank cells",[LM]:"Filter by condition",[FM]:"Filter by value",[VM]:"And",[oy]:"Or",[BM]:"Select all",[WM]:"Clear",[jM]:"OK",[UM]:"Cancel",[zM]:"Search",[YM]:"Value",[GM]:"Second value",[qM]:"Checked",[XM]:"Unchecked"},die=hie,BR=nL.languageCode,{register:fie,getItem:rL,hasItem:gie,getValues:mie}=fo("languagesDictionaries");iL(nL);function iL(t,e){let n=t,r=e;return $e(t)&&(r=t,n=r.languageCode),pie(n,r),fie(n,rr(r)),rr(r)}function pie(t,e){t!==BR&&iie(e,rL(BR))}function oL(t){return JM(t)?rr(rL(t)):null}function JM(t){return gie(t)}function wie(){return mie()}function sL(t,e,n){const r=oL(t);if(r===null)return null;const i=r[e];if(Lt(i))return null;const o=vie(i,n);return Array.isArray(o)?o[0]:o}function vie(t,e){let n=t;return x(uie(),r=>{n=r(t,e)}),n}function yie(t){let e=Q$(t);return JM(e)||(e=BR,eL(t)),e}function Cie(t,e,n){return(e=bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bie(t){var e=Sie(t,"string");return typeof e=="symbol"?e:e+""}function Sie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ta extends D${constructor(e,n){super(e,null),Cie(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function qC(t){let{activeHeaderClassName:e,...n}=t;return new ta({className:e,...n,selectionType:k$})}function Rie(t){let{areaCornerVisible:e,...n}=t;return new ta({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:dT})}function Eie(t){let{...e}=t;return new ta({className:"highlight",...e,selectionType:dT})}function Tie(t){let{columnClassName:e,...n}=t;return new ta({className:e,...n,selectionType:Ene})}function Mie(t){let{cellCornerVisible:e,...n}=t;return new ta({className:"current",headerAttributes:[NE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:ef})}function _ie(t){let{border:e,visualCellRange:n,...r}=t;return new ta({...e,...r,selectionType:Tne},n)}function xie(t){let{...e}=t;return new ta({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Sne})}function aO(t){let{headerClassName:e,...n}=t;return new ta({className:e,...n,selectionType:hT})}function Pie(t){let{rowClassName:e,...n}=t;return new ta({className:e,...n,selectionType:Rne})}function Iie(t,e){Oie(t,e),e.add(t)}function Oie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rr(t,e,n){return(e=Aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aie(t){var e=Hie(t,"string");return typeof e=="symbol"?e:e+""}function Hie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ms(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Co=new WeakSet;class Nie{constructor(e){Iie(this,Co),Rr(this,"options",void 0),Rr(this,"layerLevel",0),Rr(this,"focus",void 0),Rr(this,"fill",void 0),Rr(this,"layeredAreas",new Map),Rr(this,"areas",new Map),Rr(this,"rowHeaders",new Map),Rr(this,"columnHeaders",new Map),Rr(this,"activeRowHeaders",new Map),Rr(this,"activeColumnHeaders",new Map),Rr(this,"activeCornerHeaders",new Map),Rr(this,"rowHighlights",new Map),Rr(this,"columnHighlights",new Map),Rr(this,"customSelections",[]),this.options=e,this.focus=Mie(e),this.fill=xie(e)}isEnabledFor(e,n){let r=e;e===ef&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return ms(Co,this,ps).call(this,this.layeredAreas,Rie)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return ms(Co,this,ps).call(this,this.areas,Eie)}getAreas(){return[...this.areas.values()]}createRowHeader(){return ms(Co,this,ps).call(this,this.rowHeaders,aO)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return ms(Co,this,ps).call(this,this.columnHeaders,aO)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return ms(Co,this,ps).call(this,this.activeRowHeaders,qC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return ms(Co,this,ps).call(this,this.activeColumnHeaders,qC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return ms(Co,this,ps).call(this,this.activeCornerHeaders,qC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return ms(Co,this,ps).call(this,this.rowHighlights,Pie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return ms(Co,this,ps).call(this,this.columnHighlights,Tie)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(_ie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),x(this.areas.values(),e=>void e.clear()),x(this.layeredAreas.values(),e=>void e.clear()),x(this.rowHeaders.values(),e=>void e.clear()),x(this.columnHeaders.values(),e=>void e.clear()),x(this.activeRowHeaders.values(),e=>void e.clear()),x(this.activeColumnHeaders.values(),e=>void e.clear()),x(this.activeCornerHeaders.values(),e=>void e.clear()),x(this.rowHighlights.values(),e=>void e.clear()),x(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ps(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function lO(t,e,n){return(e=Die(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Die(t){var e=kie(t,"string");return typeof e=="symbol"?e:e+""}function kie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ie{constructor(e){lO(this,"ranges",[]),lO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function Lie(t,e){aL(t,e),e.add(t)}function XC(t,e,n){aL(t,e),e.set(t,n)}function aL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){return t.get(Cn(t,e))}function ym(t,e,n){return t.set(Cn(t,e),n),n}function Cn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cm=new WeakMap,_t=new WeakMap,oo=new WeakMap,xn=new WeakSet;class WR{constructor(e,n){Lie(this,xn),XC(this,Cm,void 0),XC(this,_t,void 0),XC(this,oo,{x:0,y:0}),ym(Cm,this,e),ym(_t,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=rt(_t,this).createCellCoords(e,n);let o=rt(Cm,this).current().highlight;const s=rt(_t,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Cn(xn,this,lL).call(this),{row:h,col:d}=Cn(xn,this,cO).call(this,o),f=rt(_t,this).fixedRowsBottom(),g=rt(_t,this).minSpareRows(),p=rt(_t,this).minSpareCols(),C=rt(_t,this).autoWrapRow(),E=rt(_t,this).autoWrapCol(),y=rt(_t,this).createCellCoords(h+i.row,d+i.col);if(y.row>=c){const I=Lr(r&&g>0&&f===0),M=y.col+1,P=rt(_t,this).createCellCoords(y.row-c,M>=u?M-u:M);this.runLocalHooks("beforeColumnWrap",I,Cn(xn,this,Ku).call(this,P),M>=u),I.value?this.runLocalHooks("insertRowRequire",rt(_t,this).countRenderableRows()):E&&y.assign(P)}else if(y.row<0){const I=Lr(E),M=y.col-1,P=rt(_t,this).createCellCoords(c+y.row,M<0?u+M:M);this.runLocalHooks("beforeColumnWrap",I,Cn(xn,this,Ku).call(this,P),M<0),E&&y.assign(P)}if(y.col>=u){const I=Lr(r&&p>0),M=y.row+1,P=rt(_t,this).createCellCoords(M>=c?M-c:M,y.col-u);this.runLocalHooks("beforeRowWrap",I,Cn(xn,this,Ku).call(this,P),M>=c),I.value?this.runLocalHooks("insertColRequire",rt(_t,this).countRenderableColumns()):C&&y.assign(P)}else if(y.col<0){const I=Lr(C),M=y.row-1,P=rt(_t,this).createCellCoords(M<0?c+M:M,u+y.col);this.runLocalHooks("beforeRowWrap",I,Cn(xn,this,Ku).call(this,P),M<0),C&&y.assign(P)}const{rowDir:T,colDir:_}=Cn(xn,this,uO).call(this,y);a=T,l=_,o=Cn(xn,this,Ku).call(this,y)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=rt(_t,this).createCellCoords(e,n),i=rt(Cm,this).current(),o=rt(_t,this).visualToRenderableCoords(i.highlight),s=Cn(xn,this,JC).call(this,i.to.row,i.from.row),a=Cn(xn,this,ZC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Cn(xn,this,cO).call(this,i.highlight),f=rt(_t,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),p=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const _=f.col-d;f.col=Cn(xn,this,ZC).call(this,g.col,p.col)+_}else if(r.col>0&&a<=d&&f.col>d){const _=Cn(xn,this,ZC).call(this,p.col,g.col),I=Math.max(f.col-_,1);f.col=_+I}if(r.row<0&&s>=h&&f.row<h){const _=f.row-h;f.row=Cn(xn,this,JC).call(this,g.row,C.row)+_}else if(r.row>0&&s<=h&&f.row>h){const _=Cn(xn,this,JC).call(this,C.row,g.row),I=Math.max(f.row-_,1);f.row=_+I}const{rowDir:E,colDir:y}=Cn(xn,this,uO).call(this,f);u=E,c=y;const T=Cn(xn,this,Ku).call(this,f);r.row===0&&r.col!==0?l.col=T.col:r.row!==0&&r.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;ym(oo,this,{x:n,y:r})}resetOffsetSize(){ym(oo,this,{x:0,y:0})}}function uO(t){const{width:e,height:n}=Cn(xn,this,lL).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function lL(){return{width:rt(oo,this).x+rt(_t,this).countRenderableColumns(),height:rt(oo,this).y+rt(_t,this).countRenderableRows()}}function JC(t,e){const n=rt(_t,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:rt(oo,this).y+n}function ZC(t,e){const n=rt(_t,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:rt(oo,this).x+n}function cO(t){const{row:e,col:n}=rt(_t,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return rt(_t,this).createCellCoords(rt(oo,this).y+e,rt(oo,this).x+n)}function Ku(t){const e=t.clone();return e.col=t.col-rt(oo,this).x,e.row=t.row-rt(oo,this).y,rt(_t,this).renderableToVisualCoords(e)}yt(WR,jn);const sy=0,ay=1,uL=2,ZM=3,Fie=[ZM,uL],Vie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],QC=Symbol("root"),hO=Symbol("child");function ih(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:QC;if(e!==QC&&e!==hO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===QC;let i=sy;if(n){const o=t[0];t.length===0?i=ay:r&&o instanceof Sg?i=ZM:r&&Array.isArray(o)?i=ih(o,hO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Vie[l].includes(typeof a))&&(i=uL)}return i}function Vf(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Fie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===ZM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Lt(u)&&(u=a),Lt(c)&&(c=l),!r){const f=a,g=l,p=u,C=c;a=Math.min(f,p),l=Math.min(g,C),u=Math.max(f,p),c=Math.max(g,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Bie(t){const e=ih(t.getSelected());if(e===sy||e===ay)return[];const n=Vf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;x(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;x(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Mn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Wie(t){const e=ih(t.getSelected());if(e===sy||e===ay)return[];const n=Vf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;x(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;x(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Mn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function qu(t,e,n){jie(t,e),e.set(t,n)}function jie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dl(t,e,n){return(e=Uie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uie(t){var e=zie(t,"string");return typeof e=="symbol"?e:e+""}function zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dt(t,e){return t.get(cL(t,e))}function bo(t,e,n){return t.set(cL(t,e),n),n}function cL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zn=new WeakMap,fl=new WeakMap,bm=new WeakMap,nd=new WeakMap,Sm=new WeakMap,rd=new WeakMap;class hL{constructor(e,n){var r=this;dl(this,"settings",void 0),dl(this,"tableProps",void 0),dl(this,"inProgress",!1),dl(this,"selectedRange",new $ie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),dl(this,"highlight",void 0),qu(this,zn,void 0),qu(this,fl,void 0),dl(this,"selectedByRowHeader",new Set),dl(this,"selectedByColumnHeader",new Set),qu(this,bm,!1),qu(this,nd,!1),qu(this,Sm,"unknown"),qu(this,rd,-1),this.settings=e,this.tableProps=n,this.highlight=new Nie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[NE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),bo(zn,this,new WR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),bo(fl,this,new WR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Dt(zn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Dt(zn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Dt(zn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Dt(zn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Dt(zn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Dt(zn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Dt(zn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Dt(zn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Dt(fl,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Dt(fl,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){bo(Sm,this,e)}markEndSource(){bo(Sm,this,"unknown")}getSelectionSource(){return Dt(Sm,this)}setExpectedLayers(e){bo(rd,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,bo(rd,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Lt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();bo(bm,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Lt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Dt(rd,this)===-1||this.selectedRange.size()===Dt(rd,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(x(this.highlight.getAreas(),g=>void g.clear()),x(this.highlight.getLayeredAreas(),g=>void g.clear()),x(this.highlight.getRowHeaders(),g=>void g.clear()),x(this.highlight.getColumnHeaders(),g=>void g.clear()),x(this.highlight.getActiveRowHeaders(),g=>void g.clear()),x(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),x(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),x(this.highlight.getRowHighlights(),g=>void g.clear()),x(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(dT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(hT,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),y=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(y).commit(),d.add(C).commit(),f.add(y).commit()):(a.add(C).add(E).commit(),l.add(y).add(T).commit(),d.add(C).add(E).commit(),f.add(y).add(T).commit())}const g=!Dt(nd,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),p=!Dt(nd,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&p&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(ef,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(bo(bm,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Dt(zn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Dt(zn,this).resetOffsetSize(),this.setRangeStart(Dt(zn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?Dt(zn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Dt(zn,this).resetOffsetSize(),this.setRangeEnd(Dt(zn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?Dt(fl,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Dt(fl,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Dt(fl,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ze(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ze(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ze(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ze(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ze(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ze(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Lr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Dt(bm,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;bo(nd,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ze(d.row,u,o-1),Ze(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),p=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.finish(),bo(nd,this,!1)}selectCells(e){var n=this;const r=ih(e);if(r===ay)return!1;if(r===sy)throw new Error(mt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Vf(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),x(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ze(r.row,u,s-1),g=Ze(r.col,Math.min(i,o),Math.max(i,o))):(f=Ze(r,u,s-1),g=i);const p=this.tableProps.createCellCoords(f,g),C=l===0?0:Ze(p.row,u,-1),E=s-1,y=this.tableProps.createCellCoords(C,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",y,T,p),y.row=C,T.row=E,this.setRangeStartOnly(y,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",y,T,p),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ze(r.row,Math.min(e,n),Math.max(e,n)),d=Ze(r.col,a,o-1)):(h=e,d=Ze(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Ze(f.col,a,-1),p=o-1,C=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,p);this.runLocalHooks("beforeSelectRows",C,E,f),C.col=g,E.col=p,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",C,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Ze(s.row,-1/0,e-1),col:Ze(s.col,-1/0,n-1)}),i.assign({row:Ze(i.row,-1/0,e-1),col:Ze(i.col,-1/0,n-1)}),o.assign({row:Ze(o.row,0,e-1),col:Ze(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(ef,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(ef,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}yt(hL,jn);const dO=/^(\r\n|\n\r|\r|\n)/,Yie=/^[^\t\r\n]+/,fO=/^\t/;function Gie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(fO))t=t.replace(fO,""),n+=1,e[r][n]="";else if(t.match(dO))t=t.replace(dO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Yie);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function nf(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function gl(t,e,n){return(e=Kie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){gl(this,"hot",void 0),gl(this,"metaManager",void 0),gl(this,"tableMeta",void 0),gl(this,"dataSource",void 0),gl(this,"duckSchema",void 0),gl(this,"colToPropCache",void 0),gl(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=qv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if($e(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return RT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Le(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?nh(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=rr(this.getSchema()):(g=[],ge(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},Cg(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const p=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(p,n));const C=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",C,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:p}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];yR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return bk(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];yR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&cn(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Lr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Lr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&cn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Nc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Nc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return nf(this.getRange(e,n,Nc.DESTINATION_RENDERER))}getCopyableText(e,n){return nf(this.getRange(e,n,Nc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:Xie,getItem:Jie,hasItem:dL,getNames:Zie,getValues:V0e}=fo("cellTypes");function QM(t){if(!dL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Jie(t)}function gi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Or(t,n),r&&Gr(t,r),i&&Jl(t,i),Xie(t,e)}function Qie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!cn(e,t)}function ly(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?QM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Le(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!$e(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Le(r,(o,s)=>{if(Qie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),fn(t,i)}function eoe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Zk(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Up(t){return Number.isInteger(t)&&t>=0}function zp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Rm(t){return t==null}const fL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Jt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Jt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Kv(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function gO(t,e,n){return(e=toe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function toe(t){var e=noe(t,"string");return typeof e=="symbol"?e:e+""}function noe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function roe(){return class{}}class ioe{constructor(e){gO(this,"metaCtor",roe()),gO(this,"meta",void 0),this.meta=this.metaCtor.prototype,fn(this.meta,fL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;fn(this.meta,e),ly(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function ooe(t,e,n){return(e=soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function soe(t){var e=aoe(t,"string");return typeof e=="symbol"?e:e+""}function aoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class loe{constructor(e){ooe(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){fn(this.meta,e),ly(this.meta,e,e)}}function Em(t,e,n){return(e=uoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uoe(t){var e=coe(t,"string");return typeof e=="symbol"?e:e+""}function coe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $w{constructor(e){Em(this,"valueFactory",void 0),Em(this,"data",[]),Em(this,"index",[]),Em(this,"holes",new Set),this.valueFactory=e}obtain(e){zp(()=>Up(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zp(()=>Up(e)||Rm(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Rm(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zp(()=>Up(e)||Rm(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Rm(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function mO(t,e,n){return(e=hoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hoe(t){var e=doe(t,"string");return typeof e=="symbol"?e:e+""}function doe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const foe=["data","width"];class goe{constructor(e){mO(this,"globalMeta",void 0),mO(this,"metas",new $w(()=>this._createMeta())),this.globalMeta=e,this.metas=new $w(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);fn(r,n),ly(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return eoe(this.globalMeta.getMetaConstructor(),foe).prototype}}function pO(t,e,n){return(e=moe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function moe(t){var e=poe(t,"string");return typeof e=="symbol"?e:e+""}function poe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class woe{constructor(e){pO(this,"columnMeta",void 0),pO(this,"metas",new $w(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);fn(i,r),ly(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){zp(()=>Up(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new $w(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class gL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new ioe(e),this.tableMeta=new loe(this.globalMeta),this.columnMeta=new goe(this.globalMeta),this.cellMeta=new woe(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}yt(gL,jn);function wO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=nr(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ft(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Nc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let p,C=0,E=0;for(C=0,E=d.startRows;C<E;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)p=rr(g),t.push(p);else if(i.dataType==="array")p=rr(g[0]),t.push(p);else{p=[];for(let y=0,T=d.startCols;y<T;y++)p.push(null);t.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Re(i.rootElement,[Ik(-1),jv(i.countCols()+(i.view?i.countRowHeaders():0))])}function vO(t,e,n){return(e=voe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function voe(t){var e=yoe(t,"string");return typeof e=="symbol"?e:e+""}function yoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Coe{constructor(e){var n=this;vO(this,"metaManager",void 0),vO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),oe.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=cn(e,"type")?e.type:null;let c=ft(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function boe(t,e,n){Soe(t,e),e.set(t,n)}function Soe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eb(t,e,n){return(e=Roe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Roe(t){var e=Eoe(t,"string");return typeof e=="symbol"?e:e+""}function Eoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Toe(t,e){return t.get(Moe(t,e))}function Moe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yO=new WeakMap;class _oe{constructor(e){eb(this,"metaManager",void 0),eb(this,"usageTracker",new Set),eb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),boe(this,yO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,Toe(yO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const mL="gridDefault",tl="editorManager.handlingEditor",xoe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Poe="hooksRefRegisterer",pL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){x(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Le(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ss(pL,"MIXIN_NAME",Poe,{writable:!1,enumerable:!1});function Fi(t,e,n){return(e=Ioe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ioe(t){var e=Ooe(t,"string");return typeof e=="symbol"?e:e+""}function Ooe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Aoe="base",nn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Rh{static get EDITOR_TYPE(){return Aoe}constructor(e){Fi(this,"hot",void 0),Fi(this,"state",nn.VIRGIN),Fi(this,"_opened",!1),Fi(this,"_fullEditMode",!1),Fi(this,"_closeCallback",null),Fi(this,"TD",null),Fi(this,"row",null),Fi(this,"col",null),Fi(this,"prop",null),Fi(this,"originalValue",null),Fi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:nn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==nn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=nn.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:It(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===nn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===nn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=nn.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=nn.FINISHED,this.discardEditor(s)}):(this.state=nn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=nn.FINISHED,this.discardEditor()}discardEditor(e){this.state===nn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=nn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=nn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===nn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Wn(n),a=on(n),l=Wn(this.hot.rootElement),u=on(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:p}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=p.name,E=["master","inline_start"].includes(C)?d:0,y=["master","top","bottom"].includes(C)?f:0,T=s.top===l.top?0:1;let _=s.top-l.top-T-E,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-g-1+y:I=s.left-l.left-1-y,["top","top_inline_start_corner"].includes(C)&&(_+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const M=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),V=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(M&&P<=0||P===V)&&(_+=1),z<=0&&(I+=1);const q=i.rowsRenderCalculator.startPosition,Z=i.columnsRenderCalculator.startPosition,ee=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),ce=On(this.hot.rootDocument);let je=n.offsetTop;if(["inline_start","master"].includes(C)&&(je+=q-te),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:K,wtTable:J}=r.bottomOverlay.clone;je+=K.getWorkspaceHeight()-J.getHeight()-ce}let we=n.offsetLeft;this.hot.isRtl()?(we>=0?we=p.getWidth()-n.offsetLeft:we=Math.abs(we),we+=Z-ee-a):["top","master","bottom"].includes(C)&&(we+=Z-ee);const Ae=o.getComputedStyle(this.TD),ot=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",wn=parseInt(Ae[ot],10)>0?0:1,Ue=parseInt(Ae.borderTopWidth,10)>0?0:1,m=on(n)+wn,v=dn(n)+Ue,w=VE(c)?ce:0,A=BE(h)?ce:0,L=this.hot.view.maximumVisibleElementWidth(we)-w+wn,U=Math.max(this.hot.view.maximumVisibleElementHeight(je)-A+Ue,this.hot.view.getDefaultRowHeight());return{top:_,start:I,height:v,maxHeight:U,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}yt(Rh,pL);const Hoe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===nn.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},Noe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},Doe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},koe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},$oe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Hi(e))}};function Loe(){return[xoe,Hoe,Noe,Doe,koe,$oe]}const Foe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},Voe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},Boe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},Woe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},joe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},Uoe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},zoe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Yoe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Goe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Koe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},qoe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Xoe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},Joe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},Zoe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Qoe(){return[Foe,Voe,Boe,Woe,joe,Uoe,zoe,Yoe,Goe,Koe,qoe,Xoe,Joe,Zoe]}const ese={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},tse={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},nse={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},rse={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},ise={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},ose={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},sse={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},ase={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},lse={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},use={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},cse={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},hse={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},dse={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},fse={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},gse={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},mse={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function pse(){return[ese,tse,nse,rse,ise,ose,sse,ase,lse,use,cse,hse,dse,fse,gse,mse]}const wse={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},vse={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},yse={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Cse={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},bse={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Sse=[...Loe(),...Qoe(),...pse(),wse,vse,yse,Cse,bse];function wL(t){const e={};return Sse.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Rse(t){const e=t.getShortcutManager().addContext("editor"),n=wL(t),r={group:tl};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function Ese(t){const e=t.getShortcutManager().addContext("grid"),n=wL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:mL};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:tl,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function Tse(t){[Ese,Rse].forEach(e=>e(t))}function Mse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=CO(t),i=CO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function CO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Re(n,[Af("Focus catcher")]),n}function _se(t){const e=xse(t);let n;const{activate:r,deactivate:i}=Mse(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:jR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:UR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,p)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,p.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:mL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?jR(t):UR(t)),u(),!1;h.preventDefault()},position:"after"}])}function jR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function UR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function xse(t){return e=>{if(!e)return null;const n=jR(t),r=UR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Eh(t){Xo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function uy(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,p=f<=h,C=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:p&&C?r.highlight.row:p?f:C?g:E.row}}}function Pse(t){return e=>{const n=uy(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Eh(t.getCell(r?-1:0,n,!0))})}}function Ise(){return()=>{}}function Ose(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Eh(t.getCell(n,r,!0))})}}function Ase(t){return e=>{const n=uy(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Eh(t.getCell(i,o,!0))})}}function Hse(t){return e=>{const n=uy(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Eh(t.getCell(i,o,!0))})}}function Nse(t){return e=>{const n=uy(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Eh(t.getCell(n,r?-1:0,!0))})}}function Dse(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Eh(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function kse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=Ose(t):e.isSelectedByCorner()?s=Ise():e.isSelectedByRowHeader()?s=Nse(t):e.isSelectedByColumnHeader()?s=Pse(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=Ase(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=Dse(t):e.getSelectedRange().size()>1&&(s=Hse(t)),(o=s)===null||o===void 0||o(i)}}}const bO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Tm=t=>t.map(e=>{const n=e.toLowerCase();return bO.has(n)?bO.get(n):n}).sort().join("+"),$se=t=>t.split("+"),SO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),tb=t=>{let{which:e,key:n}=t;if(SO.has(e))return SO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},vL=Symbol("shortcut-context");function yL(t){return $e(t)&&t.__kindOf===vL}const Lse=t=>{const e=Zv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:p,position:C,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Lt(c))throw new Error("You need to define the shortcut's group.");if(ft(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(mt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const y={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(p)&&(y.relativeToGroup=p,y.position=C),yL(E)&&(y.forwardToContext=E),l.forEach(T=>{const _=Tm(T);if(e.hasItem(_)){const M=e.getItem(_);let P=M.findIndex(z=>z.group===p);P!==-1?C==="before"?P-=1:P+=1:P=M.length,M.splice(P,0,y)}else e.addItem(_,[y])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Le(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Tm(l);e.removeItem(u)};return{__kindOf:vL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Tm(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=Tm(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i($se(h)):(d.length=0,d.push(...f))})}}};function Fse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Vse=["meta","alt","shift","control"],id=Fse(),od=[];let Mm=0;function Bse(t,e,n,r,i){const o=f=>Vse.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),g&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||_a(f))return;const p=tb(f);let C=[];o(p)||(C=s(f));const E=[p].concat(C);!i(f,E)&&(Ow()&&C.includes("meta")||!Ow()&&C.includes("control"))&&i(f,[p].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=tb(f);o(g)&&id.press(g)}},u=f=>{if(typeof f.key=="string"){const g=tb(f);o(g)&&id.release(g)}},c=()=>{id.releaseAll()};return{mount:()=>{let f=t;for(Mm+=1;f;)Mm===1&&(f.document.documentElement.addEventListener("keydown",l),od.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),od.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=fu(f)},unmount:()=>{let f=t;for(Mm-=1;f;){if(Mm===0){for(let g=0;g<od.length;g++){const{event:p,listener:C}=od[g];f.document.documentElement.removeEventListener(p,C)}od.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=fu(f)}},isPressed:f=>id.isPressed(f),releasePressedKeys:()=>id.releaseAll()}}const Wse=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Zv({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const p=Lse(g);return o.addItem(g,p),p},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(mt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,p){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=yL(C)?C:u(C);let y=!1;if(!E.hasShortcut(p))return y;const T=E.getShortcuts(p);for(let _=0;_<T.length;_++){const{callback:I,runOnlyIf:M,preventDefault:P,stopPropagation:z,captureCtrl:W,forwardToContext:V}=T[_];if(M(g)===!0){if(h=W,y=I(g,p)===!1,h=!1,P&&g.preventDefault(),z&&(Hi(g),g.stopPropagation()),y)break;V&&d(g,p,V)}}return y},f=Bse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function RO(t){const{classNames:e}=Dk(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let nb=null;const rb=new Map;function CL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new _i(o);let a,l,u,c,h,d,f=!0;are(i)&&sre(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",p=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=yie(e.language);const C=Object.fromEntries(Object.entries(e).filter(m=>{let[v]=m;return!(oe.getSingleton().isRegistered(v)||oe.getSingleton().isDeprecated(v))})),E=new gL(o,C,[Coe,_oe]),y=E.getTableMeta(),T=E.getGlobalMeta(),_=Zv();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),jp(this)&&(Mk(e.licenseKey,t),X(t,"ht-wrapper")),this.guid=`ht_${IE()}`,rb.set(this.guid,this),this.columnIndexMapper=new VR,this.rowIndexMapper=new VR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new Pre(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const I=m=>{const{row:v,col:w}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getRenderableFromVisualIndex(v):v,w>=0?o.columnIndexMapper.getRenderableFromVisualIndex(w):w)},M=m=>{const{row:v,col:w}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getVisualFromRenderableIndex(v):v,w>=0?o.columnIndexMapper.getVisualFromRenderableIndex(w):w)},P=(m,v)=>{const w=v>m?1:-1,A=Math.min(m,v),L=Math.max(m,v),U=o.rowIndexMapper.getNearestNotHiddenIndex(m,w);return U===null||w===1&&U>L||w===-1&&U<A?null:U>=0?o.rowIndexMapper.getRenderableFromVisualIndex(U):U},z=(m,v)=>{const w=v>m?1:-1,A=Math.min(m,v),L=Math.max(m,v),U=o.columnIndexMapper.getNearestNotHiddenIndex(m,w);return U===null||w===1&&U>L||w===-1&&U<A?null:U>=0?o.columnIndexMapper.getRenderableFromVisualIndex(U):U};let W=new hL(y,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,v)=>o._createCellCoords(m,v),createCellRange:(m,v,w)=>o._createCellRange(m,v,w),visualToRenderableCoords:I,renderableToVisualCoords:M,findFirstNonHiddenRenderableRow:P,findFirstNonHiddenRenderableColumn:z,isDisabledCellSelection:(m,v)=>m<0||v<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,v).disableVisualSelection});this.selection=W;const V=m=>{let{hiddenIndexesChanged:v}=m;this.forceFullRender=!0,v&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("afterSetRangeEnd",(m,v)=>{const w=Lr(!1),A=this.selection.getSelectedRange(),{from:L,to:U}=A.current(),K=A.size()-1;this.runHooks("afterSelection",L.row,L.col,U.row,U.col,w,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),U.row,o.colToProp(U.col),w,K),v&&(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m);const J=W.isSelectedByRowHeader(),b=W.isSelectedByColumnHeader();J&&b?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(ve(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):b?(ve(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):ve(this.rootElement,["ht__selection--rows","ht__selection--columns"]),W.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const v=Lr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,v),(!v.isTouched()||v.isTouched()&&!v.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const v=m.length-1,{from:w,to:A}=m[v];this.runHooks("afterSelectionEnd",w.row,w.col,A.row,A.col,v),this.runHooks("afterSelectionEndByProp",w.row,o.colToProp(w.col),A.row,o.colToProp(A.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const v=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=v)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),ve(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...v)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...v)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...v)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSelectColumns",...v)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterSelectColumns",...v)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSelectRows",...v)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterSelectRows",...v)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformStart",...v)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...v)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformFocus",...v)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformFocus",...v)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformEnd",...v)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...v)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeRowWrap",...v)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeColumnWrap",...v)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const U=K=>{if(K.length===0)return[];const J=[...K];return J.sort((R,S)=>{let[$]=R,[O]=S;return $===O?0:$>O?1:-1}),Mn(J,(R,S)=>{let[$,O]=S;const N=R[R.length-1],[j,H]=N,D=j+H;if($<=D){const B=Math.max(O-(D-$),0);N[1]+=B}else R.push([$,O]);return R},[J[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(y.maxRows===K)return;const J=m==="insert_row_below"?"below":"above";v=v??(J==="below"?K:0);const{delta:b,startPhysicalIndex:R}=a.createRow(v,w,{source:A,mode:J});W.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";v=v??(S==="end"?o.countSourceCols():0);const{delta:$,startPhysicalIndex:O}=a.createCol(v,w,{source:A,mode:S});if($){if(Array.isArray(y.colHeaders)){const H=[o.toVisualColumn(O),0];H.length+=$,Array.prototype.splice.apply(y.colHeaders,H)}W.shiftColumns(o.toVisualColumn(O),$)}break;case"remove_row":const N=H=>{let D=0;x(H,B=>{let[F,G]=B;const ae=Jt(F)?o.countRows()-1:Math.max(F-D,0);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeRow(F,G,A))return;if(W.isSelected()){const{row:_e}=o.getSelectedRangeLast().highlight;_e>=F&&_e<=F+G-1&&c.closeEditor(!0)}const xe=o.countRows(),Be=y.fixedRowsTop;Be>=ae+1&&(y.fixedRowsTop-=Math.min(G,Be-ae));const Je=y.fixedRowsBottom;Je&&ae>=xe-Je&&(y.fixedRowsBottom-=Math.min(G,Je)),xe===0?W.deselect():A==="ContextMenu.removeRow"?W.refresh():W.shiftRows(F,-G),D+=G})};Array.isArray(v)?N(U(v)):N([[v,w]]);break;case"remove_col":const j=H=>{let D=0;x(H,B=>{let[F,G]=B;const ae=Jt(F)?o.countCols()-1:Math.max(F-D,0);let he=o.toPhysicalColumn(ae);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeCol(F,G,A))return;if(W.isSelected()){const{col:_e}=o.getSelectedRangeLast().highlight;_e>=F&&_e<=F+G-1&&c.closeEditor(!0)}o.countCols()===0?W.deselect():A==="ContextMenu.removeColumn"?W.refresh():W.shiftColumns(F,-G);const Je=y.fixedColumnsStart;Je>=ae+1&&(y.fixedColumnsStart-=Math.min(G,Je-ae)),Array.isArray(y.colHeaders)&&(typeof he>"u"&&(he=-1),y.colHeaders.splice(he,G)),D+=G})};Array.isArray(v)?j(U(v)):j([[v,w]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=y.minRows,v=y.minSpareRows,w=y.minCols,A=y.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(v){const L=o.countEmptyRows(!0);if(L<v){const U=v-L,K=Math.min(U,y.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(w||A)&&(L=o.countEmptyCols(!0));let U=o.countCols();if(w&&!y.columns&&U<w){const K=w-U;L+=K,a.createCol(U,K,{source:"auto"})}if(A&&!y.columns&&o.dataType==="array"&&L<A){U=o.countCols();const K=A-L,J=Math.min(K,y.maxCols-U);a.createCol(U,J,{source:"auto"})}}},populateFromArray(m,v,w,A,L){let U,K,J,b;const R=[],S={},$=[],O=m.row,N=m.col;if(K=v.length,K===0)return!1;let j=0,H=0;switch($e(w)&&(j=w.col-N+1,H=w.row-O+1),L){case"shift_down":const D=qd(v),B=D.length,F=Math.max(B,j),G=o.getData().slice(O),ae=qd(G).slice(N,N+F);for(J=0;J<F;J+=1)if(J<B){for(U=0,K=D[J].length;U<H-K;U+=1)D[J].push(D[J][U%K]);J<ae.length?$.push(D[J].concat(ae[J])):$.push(D[J].concat(new Array(G.length).fill(null)))}else $.push(D[J%B].concat(ae[J]));o.populateFromArray(O,N,qd($));break;case"shift_right":const he=v.length,xe=Math.max(he,H),Be=o.getData().slice(O).map(Ht=>Ht.slice(N));for(U=0;U<xe;U+=1)if(U<he){for(J=0,b=v[U].length;J<j-b;J+=1)v[U].push(v[U][J%b]);if(U<Be.length)for(let Ht=0;Ht<Be[U].length;Ht+=1)v[U].push(Be[U][Ht]);else v[U].push(...new Array(Be[0].length).fill(null))}else v.push(v[U%K].slice(0,xe).concat(Be[U]));o.populateFromArray(O,N,v);break;case"overwrite":default:S.row=m.row,S.col=m.col;let Je=0,_e=0,Ye=!0,At;const Di=function(vn){let Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Nt=v[vn%v.length];return Tt!==null?Nt[Tt%Nt.length]:Nt},ls=v.length,ai=w?w.row-m.row+1:0;for(w?K=ai:K=Math.max(ls,ai),U=0;U<K&&!(w&&S.row>w.row&&ai>ls||!y.allowInsertRow&&S.row>o.countRows()-1||S.row>=y.maxRows);U++){const Ht=U-Je,vn=Di(Ht).length,Tt=w?w.col-m.col+1:0;if(w?b=Tt:b=Math.max(vn,Tt),S.col=m.col,At=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&At.skipRowOnPaste){Je+=1,S.row+=1,K+=1;continue}for(_e=0,J=0;J<b&&!(w&&S.col>w.col&&Tt>vn||!y.allowInsertColumn&&S.col>o.countCols()-1||S.col>=y.maxCols);J++){if(At=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&At.skipColumnOnPaste){_e+=1,S.col+=1,b+=1;continue}if(At.readOnly&&A!=="UndoRedo.undo"){S.col+=1;continue}const Nt=J-_e;let Ge=Di(Ht,Nt),li=o.getDataAtCell(S.row,S.col);if(Ge!==null&&typeof Ge=="object")if(Array.isArray(Ge)&&li===null&&(li=[]),li===null||typeof li!="object")Ye=!1;else{const nl=nh(Array.isArray(li)?li:li[0]||li),rl=nh(Array.isArray(Ge)?Ge:Ge[0]||Ge);Kv(nl,rl)||Array.isArray(nl)&&Array.isArray(rl)?Ge=rr(Ge):Ye=!1}else li!==null&&typeof li=="object"&&(Ye=!1);Ye&&R.push([S.row,S.col,Ge]),Ye=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,A||"populateFromArray");break}}};function q(m){const v=Q$(m);JM(v)?(o.runHooks("beforeLanguageChange",v),T.language=v,o.runHooks("afterLanguageChange",v)):eL(m)}function Z(m,v){const w=m==="className"?o.rootElement:o.table;if(f)X(w,v);else{let A=[],L=[];T[m]&&(A=Array.isArray(T[m])?T[m]:bR(T[m])),v&&(L=Array.isArray(v)?v:bR(v));const U=CR(A,L),K=CR(L,A);U.length&&ve(w,U),K.length&&X(w,K)}T[m]=v}this.init=function(){l.setData(y.data),o.runHooks("beforeInit"),(Ko()||qE())&&X(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new hre(this);const m=y.themeName||RO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=IR.getInstance(o,y,W),d=kse(o),h=new NZ(o),jp(this)&&_se(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&Uk(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function ee(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const v=m.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):m}function ce(m,v,w){if(!m.length){w();return}const A=o.getActiveEditor(),L=new ee;let U=!0;L.onQueueEmpty=()=>{A&&U&&A.cancelChanges(),w()};for(let K=m.length-1;K>=0;K--){const[J,b]=m[K],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(J,R):S={...Object.getPrototypeOf(y),...y},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function($,O){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&O.allowInvalid===!1&&(U=!1,m.splice($,1),O.valid=!0),L.removeValidatorFormQueue()}}(K,S),v))}L.checkIfQueueIsEmpty()}function je(m,v){for(let A=m.length-1;A>=0;A--){let L=!1;if(m[A]===null){m.splice(A,1);continue}if(!((m[A][2]===null||m[A][2]===void 0)&&(m[A][3]===null||m[A][3]===void 0))){if(y.allowInsertRow)for(;m[A][0]>o.countRows()-1;){const{delta:U}=a.createRow(void 0,void 0,{source:"auto"});if(U===0){L=!0;break}}if(o.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(m[A][1])>o.countCols()-1;){const{delta:U}=a.createCol(void 0,void 0,{source:"auto"});if(U===0){L=!0;break}}L||a.set(m[A][0],m[A][1],m[A][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,v),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,v||"edit");const A=o.getActiveEditor();A&&le(A.refreshValue)&&A.refreshValue()}else o.render()}this._createCellCoords=function(m,v){return o.view._wt.createCellCoords(m,v)},this._createCellRange=function(m,v,w){return o.view._wt.createCellRange(m,v,w)},this.validateCell=function(m,v,w,A){let L=o.getCellValidator(v);function U(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||v.hidden===!0){w(K);return}const b=v.visualCol,R=v.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const $=o.rowIndexMapper.getRenderableFromVisualIndex(R),O=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",$,O,S)}w(K)}Tk(L)&&(L=function(K){return function(J,b){b(K.test(J))}}(L)),ft(L)?(m=o.runHooks("beforeValidate",m,v.visualRow,v.prop,A),o._registerImmediate(()=>{L.call(v,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,v.visualRow,v.prop,A),v.valid=K,U(K),o.runHooks("postAfterValidate",K,m,v.visualRow,v.prop,A))})})):o._registerImmediate(()=>{v.valid=!0,U(v.valid,!1)})};function we(m,v,w){return Array.isArray(m)?m:[[m,v,w]]}function Ae(m,v){const w=o.runHooks("beforeChange",m,v||"edit"),A=m.filter(U=>U!==null);if(w===!1||A.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let U=A.length-1;U>=0;U--){const[K,J,,b]=A[U],R=a.propToCol(J);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(y),...y};const{type:$,checkedTemplate:O,uncheckedTemplate:N}=S;if($==="numeric"&&typeof b=="string"&&C$(b)&&(A[U][3]=te(b)),$==="checkbox"){const j=It(b),H=j===It(O),D=j===It(N);(H||D)&&(A[U][3]=H?O:N)}}return A}this.setDataAtCell=function(m,v,w,A){const L=we(m,v,w),U=[];let K=A,J,b,R;for(J=0,b=L.length;J<b;J++){if(typeof L[J]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[J][1]>=this.countCols()?R=L[J][1]:R=a.colToProp(L[J][1]),U.push([L[J][0],R,l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]])}!K&&typeof m=="object"&&(K=v);const S=Ae(U,K);o.runHooks("afterSetDataAtCell",S,K),ce(S,K,()=>{je(S,K)})},this.setDataAtRowProp=function(m,v,w,A){const L=we(m,v,w),U=[];let K=A,J,b;for(J=0,b=L.length;J<b;J++)U.push([L[J][0],L[J][1],l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]]);!K&&typeof m=="object"&&(K=v);const R=Ae(U,A);o.runHooks("afterSetDataAtRowProp",R,K),ce(R,K,()=>{je(R,K)})},this.listen=function(){o&&!o.isListening()&&(rb.forEach(m=>{o!==m&&m.unlisten()}),nb=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(nb=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return nb===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),v&&W.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,v,w,A,L,U,K){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const J=typeof A=="number"?o._createCellCoords(A,L):null;return u.populateFromArray(o._createCellCoords(m,v),w,J,U,K)},this.spliceCol=function(m,v,w){for(var A=arguments.length,L=new Array(A>3?A-3:0),U=3;U<A;U++)L[U-3]=arguments[U];return a.spliceCol(m,v,w,...L)},this.spliceRow=function(m,v,w){for(var A=arguments.length,L=new Array(A>3?A-3:0),U=3;U<A;U++)L[U-3]=arguments[U];return a.spliceRow(m,v,w,...L)},this.getSelected=function(){if(W.isSelected())return Xe(W.getSelectedRange(),m=>{let{from:v,to:w}=m;return[v.row,v.col,w.row,w.col]})},this.getSelectedLast=function(){const m=this.getSelected();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.getSelectedRange=function(){if(W.isSelected())return Array.from(W.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.emptySelectedCells=function(m){if(!W.isSelected()||this.countRows()===0||this.countCols()===0)return;const v=[];x(W.getSelectedRange(),w=>{if(w.isSingleHeader())return;const A=w.getTopStartCorner(),L=w.getBottomEndCorner();ge(A.row,L.row,U=>{ge(A.col,L.col,K=>{this.getCellMeta(U,K).readOnly||v.push([U,K,null])})})}),v.length>0&&this.setDataAtCell(v,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const v=m();return this.resumeRender(),v},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(v,0),(!this.isExecutionSuspended()&&v===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=m();return this.resumeExecution(v),w},this.batch=function(m){this.suspendRender(),this.suspendExecution();const v=m();return this.resumeExecution(),this.resumeRender(),v},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:v,height:w}=m.getLastSize(),{width:A,height:L}=o.rootElement.getBoundingClientRect(),U=A!==v||L!==w;o.runHooks("beforeRefreshDimensions",{width:v,height:w},{width:A,height:L},U)!==!1&&((U||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(A,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:v,height:w},{width:A,height:L},U))},this.updateData=function(m,v){wO(m,w=>{a=w},w=>{a=w,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),W.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:v,metaManager:E,firstRun:f})},this.loadData=function(m,v){wO(m,w=>{a=w},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),W.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:v,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=y.columns;let v=0;if(Array.isArray(m))v=m.length;else if(ft(m))if(o.dataType==="array"){const w=this.countSourceCols();for(let A=0;A<w;A+=1)m(A)&&(v+=1)}else(o.dataType==="object"||o.dataType==="function")&&(v=a.colToPropCache.length);else if(le(y.dataSchema)){const w=a.getSchema();v=Array.isArray(w)?w.length:qv(w)}else v=this.countSourceCols();return v},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,v,w,A){return Lt(m)?a.getAll():a.getRange(o._createCellCoords(m,v),o._createCellCoords(w,A),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,v,w,A){return a.getCopyableText(o._createCellCoords(m,v),o._createCellCoords(w,A))},this.getCopyableData=function(m,v){return a.getCopyable(m,a.colToProp(v))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(f?o.loadData:o.updateData).bind(this);let A=!1,L,U;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&q(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")Z("className",m.className);else if(L==="tableClassName"&&o.table)Z("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(oe.getSingleton().isRegistered(L)||oe.getSingleton().isDeprecated(L)){const S=m[L];ft(S)?(oe.getSingleton().addAsFixed(L,S,o),y[L]=S):Array.isArray(S)&&(oe.getSingleton().add(L,S,o),y[L]=S)}else!v&&cn(m,L)&&(T[L]=m[L]);m.data===void 0&&y.data===void 0?w(null,"updateSettings"):m.data!==void 0?w(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),J=y.columns;if(J&&ft(J)&&(A=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),K>0)for(L=0,U=0;L<K;L++){if(J){const S=A?J(L):J[U];S&&E.updateColumnMeta(U,S)}U+=1}le(m.cell)&&Le(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(ft(R)&&(R=R()),v&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;ft(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!v){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),$=cn(m,"themeName");S&&$&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const O=$&&m.themeName||RO(o.rootElement);o.useTheme(O),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!v&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(y.getValue){if(ft(y.getValue))return y.getValue.call(o);if(m)return o.getData()[m[0][0]][y.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,v,w,A,L){u.alter(m,v,w,A,L)},this.getCell=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=v,L=m;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||A===null||L===void 0||A===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,A),w)},this.getCoords=function(m){const v=this.view._wt.wtTable.getCoords(m);if(v===null)return null;const{row:w,col:A}=v;let L=w,U=A;return w>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(w)),A>=0&&(U=this.columnIndexMapper.getVisualFromRenderableIndex(A)),o._createCellCoords(L,U)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,v){return a.get(m,a.colToProp(v))},this.getDataAtRowProp=function(m,v){return a.get(m,v)},this.getDataAtCol=function(m){const v=[],w=a.getRange(o._createCellCoords(0,m),o._createCellCoords(y.data.length-1,m),a.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let L=0;L<w[A].length;L+=1)v.push(w[A][L]);return v},this.getDataAtProp=function(m){const v=[],w=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(y.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let L=0;L<w[A].length;L+=1)v.push(w[A][L]);return v},this.getSourceData=function(m,v,w,A){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(w,A)),L},this.getSourceDataArray=function(m,v,w,A){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(w,A),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,v,w,A){const L=we(m,v,w),U=this.hasHook("afterSetSourceDataAtCell"),K=[];U&&x(L,b=>{let[R,S,$]=b;K.push([R,S,l.getAtCell(R,S),$])}),x(L,b=>{let[R,S,$]=b;l.setAtCell(R,S,$)}),U&&this.runHooks("afterSetSourceDataAtCell",K,A),this.render();const J=o.getActiveEditor();J&&le(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,v){return l.getAtCell(m,v)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,v,w,A){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,v,w,A],[U,K]=L;let[,,J,b]=L,R=null,S=null;J===void 0&&(J=U),b===void 0&&(b=K);let $="mixed";return ge(Math.max(Math.min(U,J),0),Math.max(U,J),O=>{let N=!0;return ge(Math.max(Math.min(K,b),0),Math.max(K,b),j=>(S=this.getCellMeta(O,j).type,R?N=R===S:R=S,N)),$=N?S:"mixed",N}),$},this.removeCellMeta=function(m,v,w){const[A,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(v)];let U=E.getCellMetaKeyValue(A,L,w);o.runHooks("beforeRemoveCellMeta",m,v,w,U)!==!1&&(E.removeCellMeta(A,L,w),o.runHooks("afterRemoveCellMeta",m,v,w,U)),U=null},this.spliceCellsMeta=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,A=new Array(w>2?w-2:0),L=2;L<w;L++)A[L-2]=arguments[L];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&E.removeRow(this.toPhysicalRow(m),v),A.length>0&&x(A.reverse(),U=>{E.createRow(this.toPhysicalRow(m)),x(U,(K,J)=>this.setCellMetaObject(m,J,K))}),o.render()},this.setCellMetaObject=function(m,v,w){typeof w=="object"&&Le(w,(A,L)=>{this.setCellMeta(m,v,L,A)})},this.setCellMeta=function(m,v,w,A){if(o.runHooks("beforeSetCellMeta",m,v,w,A)===!1)return;let U=m,K=v;m<this.countRows()&&(U=this.toPhysicalRow(m)),v<this.countCols()&&(K=this.toPhysicalColumn(v)),E.setCellMeta(U,K,w,A),o.runHooks("afterSetCellMeta",m,v,w,A)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},A=this.toPhysicalRow(m),L=this.toPhysicalColumn(v);return A===null&&(A=m),L===null&&(L=v),E.getCellMeta(A,L,{visualRow:m,visualColumn:v,...w})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||y.columns)},this.getCellRenderer=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).renderer:m.renderer;return typeof w=="string"?Nw(w):Lt(w)?Nw("text"):w},this.getCellEditor=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).editor:m.editor;return typeof w=="string"?Hw(w):Lt(w)?Hw("text"):w},this.getCellValidator=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).validator:m.validator;return typeof w=="string"?iT(w):w},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,v){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,m)},this.validateColumns=function(m,v){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,m)},this._validateCells=function(m,v,w){const A=new ee;m&&(A.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(v!==void 0&&v.indexOf(L)===-1){L-=1;continue}let U=o.countCols()-1;for(;U>=0;){if(w!==void 0&&w.indexOf(U)===-1){U-=1;continue}A.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,U),o.getCellMeta(L,U),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),U-=1}L-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let v=y.rowHeaders,w=m;return w!==void 0&&(w=o.runHooks("modifyRowHeader",w)),w===void 0?(v=[],ge(o.countRows()-1,A=>{v.push(o.getRowHeader(A))})):Array.isArray(v)&&v[w]!==void 0?v=v[w]:ft(v)?v=v(w):v&&typeof v!="string"&&typeof v!="number"&&(v=w+1),v},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let m=0,v=o.countCols();m<v;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=o.runHooks("modifyColHeader",m);if(w===void 0){const J=[],b=o.countCols();for(let R=0;R<b;R++)J.push(o.getColHeader(R));return J}let A=y.colHeaders;const L=function(J){const b=[],R=o.countCols();let S=0;for(;S<R;S++)ft(y.columns)&&y.columns(S)&&b.push(S);return b[J]},U=o.toPhysicalColumn(w),K=L(U);return y.colHeaders===!1?A=null:y.columns&&ft(y.columns)&&y.columns(K)&&y.columns(K).title?A=y.columns(K).title:y.columns&&y.columns[U]&&y.columns[U].title?A=y.columns[U].title:Array.isArray(y.colHeaders)&&y.colHeaders[U]!==void 0?A=y.colHeaders[U]:ft(y.colHeaders)?A=y.colHeaders(U):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(A=ty(w)),A=o.runHooks("modifyColumnHeaderValue",A,m,v),A},this._getColWidthFromSettings=function(m){let v;if(m>=0&&(v=o.getCellMeta(0,m).width),(v===void 0||v===y.width)&&(v=y.colWidths),v!=null){switch(typeof v){case"object":v=v[m];break;case"function":v=v(m);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(m,v){let w=o._getColWidthFromSettings(m);return w=o.runHooks("modifyColWidth",w,m,v),w===void 0&&(w=rh),w},this._getRowHeightFromSettings=function(m){const v=this.view.getDefaultRowHeight();let w=y.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w!=null&&w<v?v:w},this.getRowHeight=function(m,v){let w=o._getRowHeightFromSettings(m);return w=o.runHooks("modifyRowHeight",w,m,v),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=y.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,v)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return HR(o.countRows()-1,w=>{if(o.isEmptyRow(w))v+=1;else if(m===!0)return!1}),v},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return HR(o.countCols()-1,w=>{if(o.isEmptyCol(w))v+=1;else if(m===!0)return!1}),v},this.isEmptyRow=function(m){return y.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return y.isEmptyCol.call(o,m)},this.selectCell=function(m,v,w,A){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,U=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Lt(m)||Lt(v)?!1:this.selectCells([[m,v,w,A]],L,U)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;v===!1&&d.suspend();const A=W.selectCells(m);return A&&w&&o.listen(),d.resume(),A},this.selectColumns=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;return W.selectColumns(m,v,w)},this.selectRows=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;return W.selectRows(m,v,w)},this.deselectCell=function(){W.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),W.selectAll(m,v,w)};const ot=(m,v)=>m.getNearestNotHiddenIndex(v,1,!0);this.scrollViewportTo=function(m,v){if(typeof m=="number"){var w;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:A,col:L,considerHiddenIndexes:U}=m??{};let K=A,J=L;if(ft(v)&&this.addHookOnce("afterScroll",v),U===void 0||U){const $=Number.isInteger(A)&&A>=0,O=Number.isInteger(L)&&L>=0,N=$?ot(this.rowIndexMapper,A):void 0,j=O?ot(this.columnIndexMapper,L):void 0;if(N===null||j===null)return!1;K=$?o.rowIndexMapper.getRenderableFromVisualIndex(N):A,J=O?o.columnIndexMapper.getRenderableFromVisualIndex(j):L}const b=Number.isInteger(K),R=Number.isInteger(J);let S=!1;return b&&K>=0&&R&&J>=0?S=o.view.scrollViewport(o._createCellCoords(K,J),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(R&&J<0||!R)?S=o.view.scrollViewportVertically(K,m.verticalSnap):R&&J>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(J,m.horizontalSnap)),ft(v)&&(S?this.view.render():(this.removeHook("afterScroll",v),this._registerMicrotask(()=>v()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;ft(m)&&this.addHookOnce("afterScroll",m);const{highlight:v}=this.getSelectedRangeLast(),w=this.scrollViewportTo(v.toObject());return w?this.view.render():ft(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),w},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),rb.delete(this.guid),jp(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}es(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(m=>{let[,v]=m;v.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),oe.getSingleton().destroy(o),Le(o,(m,v,w)=>{ft(m)?w[v]=wn(v):v!=="guid"&&(w[v]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,W=null,c=null,o=null};function wn(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return _.getItem(nr(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,v,w){oe.getSingleton().add(m,v,o,w)},this.hasHook=function(m){return oe.getSingleton().has(m,o)||oe.getSingleton().has(m)},this.addHookOnce=function(m,v,w){oe.getSingleton().once(m,v,o,w)},this.removeHook=function(m,v){oe.getSingleton().remove(m,v,o)},this.runHooks=function(m,v,w,A,L,U,K){return oe.getSingleton().run(o,m,v,w,A,L,U,K)},this.getTranslatedPhrase=function(m,v){return sL(y.language,m,v)},this.toHTML=()=>OR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",OR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=m;typeof w=="function"&&(w=setTimeout(w,v)),this.timeouts.push(w)},this._clearTimeouts=function(){x(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){x(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const Ue=Wse({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&Ue.releasePressedKeys()}),this.getShortcutManager=function(){return Ue},this.getFocusManager=function(){return h},rT().forEach(m=>{const v=bg(m);_.addItem(m,new v(this))}),Tse(o),Ue.setActiveContextName("grid"),oe.getSingleton().run(o,"construct")}function EO(t,e,n){t.addEventListener(e,n,!1)}function TO(t,e,n){t.removeEventListener(e,n,!1)}function _m(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function bL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=_m(s).fontSize,o.style.fontFamily=_m(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=_m(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=_m(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),p=o.clientWidth+f+g+1;r.removeChild(o);const C=s.style;C.height=`${n.minHeight}px`,n.minWidth>p?C.width=`${n.minWidth}px`:p>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${p}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?C.height=`${n.minHeight}px`:n.maxHeight<E?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(EO(s,"input",a),EO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){TO(s,"input",a),TO(s,"keydown",l)}}}function MO(t,e){const n=FE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}pg(e,i)}function ml(t,e,n){return(e=jse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jse(t){var e=Use(t,"string");return typeof e=="symbol"?e:e+""}function Use(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zse="ht_editor_visible",xm="ht_editor_hidden",_O="textEditor",Yse="text";class Du extends Rh{static get EDITOR_TYPE(){return Yse}constructor(e){super(e),ml(this,"eventManager",new _i(this)),ml(this,"autoResize",bL(this.hot.rootDocument)),ml(this,"TEXTAREA",void 0),ml(this,"textareaStyle",void 0),ml(this,"TEXTAREA_PARENT",void 0),ml(this,"textareaParentStyle",void 0),ml(this,"layerClass",void 0),this.eventManager=new _i(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Zd(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==nn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===nn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),pg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Re(this.TEXTAREA,[["data-hot-input",""],Iu(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ce(this.TEXTAREA_PARENT,this.layerClass)&&ve(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,xm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){s$()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ve(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,xm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;ge(e.length-1,r=>{const i=e[r];if(Ce(i,"handsontableEditor"))return n=!0,!1}),Ce(this.TEXTAREA_PARENT,xm)&&ve(this.TEXTAREA_PARENT,xm),n?(this.layerClass=zse,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==nn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){KE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===nn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===nn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:_O},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;MO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;MO(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_O)}}const Gse="base";function Mg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(oI())):a&&c.push(oI()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(sI())):(u.push(s.invalidCellClassName),a&&c.push(sI()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),ve(e,u),X(e,l),Au(e,c),Re(e,h)}Mg.RENDERER_TYPE=Gse;const Kse="text";function na(t,e,n,r,i,o,s){Mg.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=It(a),s.trimWhitespace&&(a=a.trim()),Ka(e,a)}na.RENDERER_TYPE=Kse;const qse="text",SL={CELL_TYPE:qse,editor:Du,renderer:na};gi(SL);Me.editors={BaseEditor:Rh};function Me(t,e){const n=new CL(t,e||{},bT);return n.init(),n}Me.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new CL(t,e,bT)};Me.DefaultSettings=fL();Me.hooks=oe.getSingleton();Me.CellCoords=mu;Me.CellRange=Sg;Me.packageName="handsontable";Me.buildDate="24/04/2025 10:59:00";Me.version="15.3.0";Me.languages={dictionaryKeys:die,getLanguageDictionary:oL,getLanguagesDictionaries:wie,registerLanguageDictionary:iL,getTranslatedPhrase:sL};const xO="handsontableEditor",Xse="handsontable";class e_ extends Du{static get EDITOR_TYPE(){return Xse}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),pg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&fn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:xO,relativeToGroup:tl,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Hi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(xO)}}function Jse(t,e){RL(t,e),e.add(t)}function PO(t,e,n){RL(t,e),e.set(t,n)}function RL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pm(t,e,n){return(e=Zse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zse(t){var e=Qse(t,"string");return typeof e=="symbol"?e:e+""}function Qse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ib(t,e){return t.get(zR(t,e))}function zR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eae="autocomplete";var ob=new WeakMap,IO=new WeakMap,sb=new WeakSet;class t_ extends e_{constructor(){super(...arguments),Jse(this,sb),Pm(this,"query",null),Pm(this,"strippedChoices",[]),Pm(this,"rawChoices",[]),PO(this,ob,this.hot.guid.slice(0,9)),PO(this,IO,vg(()=>{this.focus()},100)),Pm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=RR(It(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return eae}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),X(this.htContainer,"autocompleteEditor"),X(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Re(this.TEXTAREA,[K8(),j8(),Pk("listbox"),Z8()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Re(this.TEXTAREA,[Ei("false"),Q8(`${ib(ob,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",ib(IO,this)),this.htEditor.updateSettings({colWidths:e?[on(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{na(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:p,locale:C}=this.cellProperties,E=this.query;let y=It(d),T,_;y&&!p&&(T=g===!0?y.indexOf(E):y.toLocaleLowerCase(C).indexOf(E.toLocaleLowerCase(C)),T!==-1&&(_=y.substr(T,E.length),y=y.replace(_,`<strong>${_}</strong>`))),n&&Re(l,[U8(),...r?[rJ(i)]:[],...r?[iJ(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=y},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{Re(h,[NE()]),Re(this.TEXTAREA,...eJ(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(Re(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ls()),Re(this.htEditor.rootElement,[xk(),tJ("polite"),nJ("text"),["id",`${ib(ob,this)}-listbox-${o}-${s}`]]),Re(this.TEXTAREA,...Ei("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Re(this.TEXTAREA,[Ei("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=FE(this.TEXTAREA),r=jk(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(qd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),pg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),zR(sb,this,OO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),zR(sb,this,OO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Xe(e,o=>It(o));return Xe(r,o=>n?o:RR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===fe.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===fe.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(a$(e.keyCode)||e.keyCode===fe.BACKSPACE||e.keyCode===fe.DELETE||e.keyCode===fe.INSERT){let n=10;if(e.keyCode===fe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function OO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+On(this.hot.rootDocument)})}const tae="checkbox";class EL extends Rh{static get EDITOR_TYPE(){return tae}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');Ce(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Da=()=>window,Ci=()=>window.document,YR=(t,e)=>window.setTimeout(t,e),Ho=function(t,e,n,r){t.addEventListener(e,n,!!r)},ws=function(t,e,n,r){t.removeEventListener(e,n,!!r)},nae=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Yr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},ab=function(t,e){Yr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},lb=function(t,e){t.className=nae((" "+t.className+" ").replace(" "+e+" "," "))},n_=function(t){return/Array/.test(Object.prototype.toString.call(t))},Xr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},rae=function(t){let e=t.getDay();return e===0||e===6},iae=function(t){return t%4===0&&t%100!==0||t%400===0},AO=function(t,e){return[31,iae(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Im=function(t){Xr(t)&&t.setHours(0,0,0,0)},Om=function(t,e){return t.getTime()===e.getTime()},Lw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Xr(e[r])?n&&(t[r]=new Date(e[r].getTime())):n_(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Lw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},HO=function(t,e,n){let r=Ci().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Lw(r,n),t.dispatchEvent(r)},NO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},So={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},DO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},oae=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},sae=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},aae=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():sae(o,i))+"</td>"},lae=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},uae=function(t){return"<tbody>"+t.join("")+"</tbody>"},cae=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+DO(t,e)+'">'+DO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},hae=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,p=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",n_(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(p=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},dae=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+cae(t)+uae(e)+"</table>"};function GR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Da().event;let o=i.target||i.srcElement;if(o)if(Yr(o,"is-disabled")||(Yr(o,"pika-button")&&!Yr(o,"is-empty")&&!Yr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&YR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Yr(o,"pika-prev")?e.prevMonth():Yr(o,"pika-next")&&e.nextMonth()),Yr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Da().event;let o=i.target||i.srcElement;o&&(Yr(o,"pika-select-month")?e.gotoMonth(o.value):Yr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Da().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Xr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Ci().activeElement;do if(Yr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=YR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Da().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Yr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Ho(o,"change",e._onChange)));do if(Yr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Ci().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Ho(e.el,"mousedown",e._onMouseDown,!0),Ho(e.el,"touchend",e._onMouseDown,!0),Ho(e.el,"change",e._onChange),n.keyboardInput&&Ho(Ci(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Ci().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Ho(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Xr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Ho(n.trigger,"click",e._onInputClick),Ho(n.trigger,"focus",e._onInputFocus),Ho(n.trigger,"blur",e._onInputBlur)):this.show()}GR.prototype={config:function(t){this._o||(this._o=Lw({},So,!0));let e=Lw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Xr(e.minDate)||(e.minDate=!1),Xr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),n_(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||So.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Xr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Xr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",HO(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Xr(t))return;let n=this._o.minDate,r=this._o.maxDate;Xr(n)&&t<n?t=n:Xr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Im(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),HO(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Xr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=NO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=NO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Im(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=So.minDate,this._o.minYear=So.minYear,this._o.minMonth=So.minMonth,this._o.startRange=So.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Im(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=So.maxDate,this._o.maxYear=So.maxYear,this._o.maxMonth=So.maxMonth,this._o.endRange=So.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+hae(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&YR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Da().innerWidth||Ci().documentElement.clientWidth,i=Da().innerHeight||Ci().documentElement.clientHeight,o=Ci().body.scrollTop||Ci().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Da().pageXOffset,a=l.bottom+Da().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",ab(this.el,u?"left-aligned":"right-aligned"),ab(this.el,c?"bottom-aligned":"top-aligned"),lb(this.el,u?"right-aligned":"left-aligned"),lb(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=AO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Im(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=AO(h,u),g=o+s,p=g;for(;p>7;)p-=7;g+=7-p;let C=!1;for(let E=0,y=0;E<g;E++){let T=new Date(t,e,1+(E-s)),_=Xr(this._d)?Om(T,this._d):!1,I=Om(T,i),M=r.events.indexOf(T.toDateString())!==-1,P=E<s||E>=o+s,z=1+(E-s),W=e,V=t,q=r.startRange&&Om(r.startRange,T),Z=r.endRange&&Om(r.endRange,T),ee=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,te=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&rae(T)||r.disableDayFn&&r.disableDayFn(T);P&&(E<s?(z=f+z,W=u,V=h):(z=z-o,W=c,V=d));let ce={day:z,month:W,year:V,hasEvent:M,isSelected:_,isToday:I,isDisabled:te,isEmpty:P,isStartRange:q,isEndRange:Z,isInRange:ee,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&_&&(C=!0),l.push(oae(ce)),++y===7&&(r.showWeekNumber&&l.unshift(aae(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(lae(l,r.isRTL,r.pickWholeWeek,C)),l=[],y=0,C=!1)}return dae(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),lb(this.el,"is-hidden"),this._o.bound&&(Ho(Ci(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&ws(Ci(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),ab(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),ws(this.el,"mousedown",this._onMouseDown,!0),ws(this.el,"touchend",this._onMouseDown,!0),ws(this.el,"change",this._onChange),t.keyboardInput&&ws(Ci(),"keydown",this._onKeyChange),t.field&&(ws(t.field,"change",this._onInputChange),t.bound&&(ws(t.trigger,"click",this._onInputClick),ws(t.trigger,"focus",this._onInputFocus),ws(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function fae(t,e){gae(t,e),e.add(t)}function gae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kO(t,e,n){return(e=mae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mae(t){var e=pae(t,"string");return typeof e=="symbol"?e:e+""}function pae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ub(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TL="date",$O="dateEditor",wae="DD/MM/YYYY";var Am=new WeakSet;class ML extends Du{constructor(){super(...arguments),fae(this,Am),kO(this,"parentDestroyed",!1),kO(this,"$datePicker",null)}static get EDITOR_TYPE(){return TL}init(){if(typeof Q!="function")throw new Error("You need to include moment.js to your project.");if(typeof GR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(ve(this.datePicker,/ht-theme-.*/g),X(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),X(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();ve(this.datePicker,/ht-theme-.*/g),X(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{Ce(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:$O})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup($O),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=ub(Am,this,cb).call(this),r=this.hot.view.isMouseDown(),i=e?XE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new GR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Q),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Q(o,n,!0).isValid()&&this.$datePicker.setMoment(Q(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Q(o,n,!0).isValid()&&this.$datePicker.setMoment(Q(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&Cg(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:ub(Am,this,cb).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Q(a).format(ub(Am,this,cb).call(this))),this.setValue(a),i&&i(),Ko()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==nn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+dn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-on(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function cb(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:wae}const vae="dropdown";class _L extends t_{static get EDITOR_TYPE(){return vae}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const yae="numeric";class xL extends Du{static get EDITOR_TYPE(){return yae}}function Cae(t,e,n){return(e=bae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bae(t){var e=Sae(t,"string");return typeof e=="symbol"?e:e+""}function Sae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Rae="password";class PL extends Du{constructor(){super(...arguments),Cae(this,"autoResize",bL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Rae}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,es(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const hb="ht_editor_visible",LO="selectEditor",Eae="select";class IL extends Rh{static get EDITOR_TYPE(){return Eae}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Ou()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),X(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ce(this.selectWrapper,hb)&&ve(this.selectWrapper,hb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),es(this.select),Le(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Hu(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==nn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",X(this.selectWrapper,hb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:LO};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(LO)}}const Tae="time";class OL extends Du{static get EDITOR_TYPE(){return Tae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function Mae(){Or(Rh),Or(t_),Or(EL),Or(ML),Or(_L),Or(e_),Or(xL),Or(PL),Or(IL),Or(Du),Or(OL)}const _ae="html";function r_(t,e,n,r,i,o,s){Mg.apply(this,[t,e,n,r,i,o,s]),Hu(e,o??"",!1)}r_.RENDERER_TYPE=_ae;const xae="autocomplete";function Th(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?r_:na,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Ou()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),X(e,"htAutocomplete"),!t.acArrowListener){const h=new _i(t);t.acArrowListener=function(d){Ce(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Th.RENDERER_TYPE=xae;const Pae="dropdown";function i_(t,e,n,r,i,o,s){Th.apply(this,[t,e,n,r,i,o,s])}i_.RENDERER_TYPE=Pae;const FO=new WeakMap,VO=new WeakMap,Iae="htBadValue",oh="data-row",sh="data-col",Oae="checkboxRenderer",AL="checkbox";oe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===AL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function o_(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Mg.apply(this,[t,e,n,r,i,o,s]),Aae(t);let u=Hae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),es(e),o===s.checkedTemplate||It(o).toLocaleLowerCase(s.locale)===It(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||It(o).toLocaleLowerCase(s.locale)===It(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Jt(o)?X(u,"noValue"):(u.style.display="none",X(u,Iae),h=!0),Re(u,[[oh,n],[sh,r]]),l&&Re(u,[Af(u.checked?t.getTranslatedPhrase(qM):t.getTranslatedPhrase(XM)),Ak(u.checked),z8()]),!h&&c){let p="";if(c.value)p=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);p=E!==null?E:""}const C=Nae(a,p,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),FO.has(t)||(FO.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),E={group:Oae,relativeToGroup:tl,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const y=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(y==null?void 0:y.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var y;return(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight.isCell()}}],E)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),E=[],y=new Map;let T=[],_=0;if(C){for(let I=0;I<C.length;I++){const{row:M,col:P}=C[I].getTopStartCorner(),{row:z,col:W}=C[I].getBottomEndCorner();for(let V=M;V<=z;V+=1)for(let q=P;q<=W;q+=1){const Z=t.getCellMeta(V,q);if(Z.hidden)continue;const ee={checkedTemplate:Z.checkedTemplate,uncheckedTemplate:Z.uncheckedTemplate};if(Z.type!=="checkbox"){p===!0&&!Z.readOnly&&(y.has(E.length)?y.set(E.length,[...y.get(E.length),[V,q,null]]):y.set(E.length,[[V,q,null]]));continue}if(Z.readOnly===!0)continue;typeof Z.checkedTemplate>"u"&&(Z.checkedTemplate=!0),typeof Z.uncheckedTemplate>"u"&&(Z.uncheckedTemplate=!1);const te=t.getDataAtCell(V,q);p===!1?[Z.checkedTemplate,Z.checkedTemplate.toString()].includes(te)?T.push([V,q,Z.uncheckedTemplate,ee]):[Z.uncheckedTemplate,Z.uncheckedTemplate.toString(),null,void 0].includes(te)&&T.push([V,q,Z.checkedTemplate,ee]):T.push([V,q,Z.uncheckedTemplate,ee]),_+=1}E.push(_),_=0}T.every(I=>{let[,,M]=I;return M===T[0][2]})?T=T.map(I=>{let[M,P,z]=I;return[M,P,z]}):T=T.map(I=>{let[M,P,,z]=I;return[M,P,z.checkedTemplate]}),T.length>0&&E.forEach((I,M)=>{let P=T.splice(0,I);y.size&&y.has(M)&&(P=[...P,...y.get(M)]),t.setDataAtCell(P)})}}function g(){const p=t.getSelectedRange();if(p){for(let C=0;C<p.length;C++){const E=p[C].getTopStartCorner(),y=p[C].getBottomEndCorner();for(let T=E.row;T<=y.row;T++)for(let _=E.col;_<=y.col;_++){if(t.getCellMeta(T,_).readOnly)continue;const M=t.getCell(T,_);if(Xo(M)&&M.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}o_.RENDERER_TYPE=AL;function Aae(t){let e=VO.get(t);if(!e){const{rootElement:n}=t;e=new _i(t),e.addEventListener(n,"click",r=>kae(r,t)),e.addEventListener(n,"mouseup",r=>Dae(r,t)),e.addEventListener(n,"change",r=>$ae(r,t)),VO.set(t,e)}return e}function Hae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Nae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function Dae(t,e){const{target:n}=t;s_(n)&&(!n.hasAttribute(oh)||!n.hasAttribute(sh)||setTimeout(e.listen,10))}function kae(t,e){const{target:n}=t;if(!s_(n)||!n.hasAttribute(oh)||!n.hasAttribute(sh))return;const r=parseInt(n.getAttribute(oh),10),i=parseInt(n.getAttribute(sh),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function $ae(t,e){const{target:n}=t;if(!s_(n)||!n.hasAttribute(oh)||!n.hasAttribute(sh))return;const r=parseInt(n.getAttribute(oh),10),i=parseInt(n.getAttribute(sh),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function s_(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const Lae="handsontable";function a_(t,e,n,r,i,o,s){Th.apply(this,[t,e,n,r,i,o,s])}a_.RENDERER_TYPE=Lae;var Fae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var db,BO;function Bae(){return BO||(BO=1,db={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),db}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var fb,WO;function HL(){if(WO)return fb;WO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let p="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let M=0;M<t.length;M++){let P=t[M];if(p=l.replace(RegExp(`([0-9 ])(${P.key})$`),"$1"),p!==l)return n(p,u,c,h,d,f)*P.factor}if(p=l.replace("%",""),p!==l)return n(p,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let y=h(E);if(y&&y!=="."&&(p=l.replace(new RegExp(`${e(y)}$`),""),p!==l))return n(p,u,c,h,d,f);let T={};Object.keys(f).forEach(M=>{T[f[M]]=M});let _=Object.keys(T).sort().reverse(),I=_.length;for(let M=0;M<I;M++){let P=_[M],z=T[P];if(p=l.replace(P,""),p!==l){let W;switch(z){case"thousand":W=Math.pow(10,3);break;case"million":W=Math.pow(10,6);break;case"billion":W=Math.pow(10,9);break;case"trillion":W=Math.pow(10,12);break}return n(p,u,c,h,d,f)*W}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let p=r(l,u,c);return n(p,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=c_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),p=c.currentAbbreviations(),C;if(typeof l=="string")o(l,h)?C=s(l):C=i(l,h,d,f,g,p);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return fb={unformat:a},fb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var gb,jO;function l_(){if(jO)return gb;jO=1;let t=HL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,E){let y=d(C),T=g(E);return y&&T}function d(C){return t.unformat(C)!==void 0}function f(C,E,y,T=!1){let _=Object.keys(C).map(I=>{if(!E[I])return console.error(`${y} Invalid key: ${I}`),!1;let M=C[I],P=E[I];if(typeof P=="string"&&(P={type:P}),P.type==="format"){if(!f(M,u,`[Validate ${I}]`,!0))return!1}else if(typeof M!==P.type)return console.error(`${y} ${I} type mismatched: "${P.type}" expected, "${typeof M}" provided`),!1;if(P.restrictions&&P.restrictions.length){let z=P.restrictions.length;for(let W=0;W<z;W++){let{restriction:V,message:q}=P.restrictions[W];if(!V(M,C))return console.error(`${y} ${I} invalid value: ${q}`),!1}}return P.restriction&&!P.restriction(M,C)?(console.error(`${y} ${I} invalid value: ${P.message}`),!1):P.validValues&&P.validValues.indexOf(M)===-1?(console.error(`${y} ${I} invalid value: must be among ${JSON.stringify(P.validValues)}, "${M}" provided`),!1):!(P.children&&!f(M,P.children,`[Validate ${I}]`))});return T||_.push(...Object.keys(E).map(I=>{let M=E[I];if(typeof M=="string"&&(M={type:M}),M.mandatory){let P=M.mandatory;if(typeof P=="function"&&(P=P(C)),P&&C[I]===void 0)return console.error(`${y} Missing mandatory key "${I}"`),!1}return!0})),_.reduce((I,M)=>I&&M,!0)}function g(C){return f(C,u,"[Validate format]")}function p(C){return f(C,c,"[Validate language]")}return gb={validate:h,validateFormat:g,validateInput:d,validateLanguage:p},gb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Wae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function jae(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function Uae(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function zae(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Yae(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function Gae(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function Kae(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function qae(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function Xae(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function Jae(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Zae(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Qae(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function ele(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function tle(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function nle(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function rle(t,e={}){return typeof t!="string"?t:(t=Wae(t,e),t=jae(t,e),Uae(t,e),Gae(t,e),Kae(t,e),ele(t,e),Jae(t,e),Zae(t,e),qae(t,e),Qae(t,e),Xae(t,e),zae(t,e),Yae(t,e),tle(t,e),nle(t,e),e)}var u_={parseFormat:rle};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var mb,UO;function c_(){if(UO)return mb;UO=1;const t=Bae(),e=l_(),n=u_;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,mb=r,mb}function ile(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function ole(t,e){t.forEach(n=>{let r;try{r=ile(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var sle=t=>({loadLanguagesInNode:e=>ole(e,t)}),NL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(M){var P,z,W,V=w.prototype={constructor:w,toString:null,valueOf:null},q=new w(1),Z=20,ee=4,te=-7,ce=21,je=-1e7,we=1e7,Ae=!1,ot=1,wn=0,Ue={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",v=!0;function w(b,R){var S,$,O,N,j,H,D,B,F=this;if(!(F instanceof w))return new w(b,R);if(R==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>we?F.c=F.e=null:b.e<je?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((H=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(N=0,j=b;j>=10;j/=10,N++);N>we?F.c=F.e=null:(F.e=N,F.c=[b]);return}B=String(b)}else{if(!r.test(B=String(b)))return W(F,B,H);F.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(N=B.indexOf("."))>-1&&(B=B.replace(".","")),(j=B.search(/e/i))>0?(N<0&&(N=j),N+=+B.slice(j+1),B=B.substring(0,j)):N<0&&(N=B.length)}else{if(y(R,2,m.length,"Base"),R==10&&v)return F=new w(b),K(F,Z+F.e+1,ee);if(B=String(b),H=typeof b=="number"){if(b*0!=0)return W(F,B,H,R);if(F.s=1/b<0?(B=B.slice(1),-1):1,w.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(S=m.slice(0,R),N=j=0,D=B.length;j<D;j++)if(S.indexOf($=B.charAt(j))<0){if($=="."){if(j>N){N=D;continue}}else if(!O&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){O=!0,j=-1,N=0;continue}return W(F,String(b),H,R)}H=!1,B=z(B,R,10,F.s),(N=B.indexOf("."))>-1?B=B.replace(".",""):N=B.length}for(j=0;B.charCodeAt(j)===48;j++);for(D=B.length;B.charCodeAt(--D)===48;);if(B=B.slice(j,++D)){if(D-=j,H&&w.DEBUG&&D>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((N=N-j-1)>we)F.c=F.e=null;else if(N<je)F.c=[F.e=0];else{if(F.e=N,F.c=[],j=(N+1)%u,N<0&&(j+=u),j<D){for(j&&F.c.push(+B.slice(0,j)),D-=u;j<D;)F.c.push(+B.slice(j,j+=u));j=u-(B=B.slice(j)).length}else j-=D;for(;j--;B+="0");F.c.push(+B)}}else F.c=[F.e=0]}w.clone=g,w.ROUND_UP=0,w.ROUND_DOWN=1,w.ROUND_CEIL=2,w.ROUND_FLOOR=3,w.ROUND_HALF_UP=4,w.ROUND_HALF_DOWN=5,w.ROUND_HALF_EVEN=6,w.ROUND_HALF_CEIL=7,w.ROUND_HALF_FLOOR=8,w.EUCLID=9,w.config=w.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],y(S,0,f,R),Z=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],y(S,0,8,R),ee=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(y(S[0],-1e9,0,R),y(S[1],0,f,R),te=S[0],ce=S[1]):(y(S,-1e9,f,R),te=-(ce=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)y(S[0],-1e9,-1,R),y(S[1],1,f,R),je=S[0],we=S[1];else if(y(S,-1e9,f,R),S)je=-(we=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ae=S;else throw Ae=!S,Error(s+"crypto unavailable");else Ae=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],y(S,0,9,R),ot=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],y(S,0,f,R),wn=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")Ue=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))v=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:Z,ROUNDING_MODE:ee,EXPONENTIAL_AT:[te,ce],RANGE:[je,we],CRYPTO:Ae,MODULO_MODE:ot,POW_PRECISION:wn,FORMAT:Ue,ALPHABET:m}},w.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!w.DEBUG)return!0;var R,S,$=b.c,O=b.e,N=b.s;e:if({}.toString.call($)=="[object Array]"){if((N===1||N===-1)&&O>=-1e9&&O<=f&&O===o(O)){if($[0]===0){if(O===0&&$.length===1)return!0;break e}if(R=(O+1)%u,R<1&&(R+=u),String($[0]).length==R){for(R=0;R<$.length;R++)if(S=$[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if($===null&&O===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},w.maximum=w.max=function(){return L(arguments,-1)},w.minimum=w.min=function(){return L(arguments,1)},w.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var $,O,N,j,H,D=0,B=[],F=new w(q);if(S==null?S=Z:y(S,0,f),j=i(S/u),Ae)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(j*=2));D<j;)H=$[D]*131072+($[D+1]>>>11),H>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),$[D]=O[0],$[D+1]=O[1]):(B.push(H%1e14),D+=2);D=j/2}else if(crypto.randomBytes){for($=crypto.randomBytes(j*=7);D<j;)H=($[D]&31)*281474976710656+$[D+1]*1099511627776+$[D+2]*4294967296+$[D+3]*16777216+($[D+4]<<16)+($[D+5]<<8)+$[D+6],H>=9e15?crypto.randomBytes(7).copy($,D):(B.push(H%1e14),D+=7);D=j/7}else throw Ae=!1,Error(s+"crypto unavailable");if(!Ae)for(;D<j;)H=R(),H<9e15&&(B[D++]=H%1e14);for(j=B[--D],S%=u,j&&S&&(H=h[u-S],B[D]=o(j/H)*H);B[D]===0;B.pop(),D--);if(D<0)B=[N=0];else{for(N=-1;B[0]===0;B.splice(0,1),N-=u);for(D=1,H=B[0];H>=10;H/=10,D++);D<u&&(N-=u-D)}return F.e=N,F.c=B,F}}(),w.sum=function(){for(var b=1,R=arguments,S=new w(R[0]);b<R.length;)S=S.plus(R[b++]);return S},z=function(){var b="0123456789";function R(S,$,O,N){for(var j,H=[0],D,B=0,F=S.length;B<F;){for(D=H.length;D--;H[D]*=$);for(H[0]+=N.indexOf(S.charAt(B++)),j=0;j<H.length;j++)H[j]>O-1&&(H[j+1]==null&&(H[j+1]=0),H[j+1]+=H[j]/O|0,H[j]%=O)}return H.reverse()}return function(S,$,O,N,j){var H,D,B,F,G,ae,he,xe,Be=S.indexOf("."),Je=Z,_e=ee;for(Be>=0&&(F=wn,wn=0,S=S.replace(".",""),xe=new w($),ae=xe.pow(S.length-Be),wn=F,xe.c=R(I(C(ae.c),ae.e,"0"),10,O,b),xe.e=xe.c.length),he=R(S,$,O,j?(H=m,b):(H=b,m)),B=F=he.length;he[--F]==0;he.pop());if(!he[0])return H.charAt(0);if(Be<0?--B:(ae.c=he,ae.e=B,ae.s=N,ae=P(ae,xe,Je,_e,O),he=ae.c,G=ae.r,B=ae.e),D=B+Je+1,Be=he[D],F=O/2,G=G||D<0||he[D+1]!=null,G=_e<4?(Be!=null||G)&&(_e==0||_e==(ae.s<0?3:2)):Be>F||Be==F&&(_e==4||G||_e==6&&he[D-1]&1||_e==(ae.s<0?8:7)),D<1||!he[0])S=G?I(H.charAt(1),-Je,H.charAt(0)):H.charAt(0);else{if(he.length=D,G)for(--O;++he[--D]>O;)he[D]=0,D||(++B,he=[1].concat(he));for(F=he.length;!he[--F];);for(Be=0,S="";Be<=F;S+=H.charAt(he[Be++]));S=I(S,B,H.charAt(0))}return S}}(),P=function(){function b($,O,N){var j,H,D,B,F=0,G=$.length,ae=O%d,he=O/d|0;for($=$.slice();G--;)D=$[G]%d,B=$[G]/d|0,j=he*D+B*ae,H=ae*D+j%d*d+F,F=(H/N|0)+(j/d|0)+he*B,$[G]=H%N;return F&&($=[F].concat($)),$}function R($,O,N,j){var H,D;if(N!=j)D=N>j?1:-1;else for(H=D=0;H<N;H++)if($[H]!=O[H]){D=$[H]>O[H]?1:-1;break}return D}function S($,O,N,j){for(var H=0;N--;)$[N]-=H,H=$[N]<O[N]?1:0,$[N]=H*j+$[N]-O[N];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,O,N,j,H){var D,B,F,G,ae,he,xe,Be,Je,_e,Ye,At,Di,ls,ai,Ht,vn,Tt=$.s==O.s?1:-1,Nt=$.c,Ge=O.c;if(!Nt||!Nt[0]||!Ge||!Ge[0])return new w(!$.s||!O.s||(Nt?Ge&&Nt[0]==Ge[0]:!Ge)?NaN:Nt&&Nt[0]==0||!Ge?Tt*0:Tt/0);for(Be=new w(Tt),Je=Be.c=[],B=$.e-O.e,Tt=N+B+1,H||(H=l,B=p($.e/u)-p(O.e/u),Tt=Tt/u|0),F=0;Ge[F]==(Nt[F]||0);F++);if(Ge[F]>(Nt[F]||0)&&B--,Tt<0)Je.push(1),G=!0;else{for(ls=Nt.length,Ht=Ge.length,F=0,Tt+=2,ae=o(H/(Ge[0]+1)),ae>1&&(Ge=b(Ge,ae,H),Nt=b(Nt,ae,H),Ht=Ge.length,ls=Nt.length),Di=Ht,_e=Nt.slice(0,Ht),Ye=_e.length;Ye<Ht;_e[Ye++]=0);vn=Ge.slice(),vn=[0].concat(vn),ai=Ge[0],Ge[1]>=H/2&&ai++;do{if(ae=0,D=R(Ge,_e,Ht,Ye),D<0){if(At=_e[0],Ht!=Ye&&(At=At*H+(_e[1]||0)),ae=o(At/ai),ae>1)for(ae>=H&&(ae=H-1),he=b(Ge,ae,H),xe=he.length,Ye=_e.length;R(he,_e,xe,Ye)==1;)ae--,S(he,Ht<xe?vn:Ge,xe,H),xe=he.length,D=1;else ae==0&&(D=ae=1),he=Ge.slice(),xe=he.length;if(xe<Ye&&(he=[0].concat(he)),S(_e,he,Ye,H),Ye=_e.length,D==-1)for(;R(Ge,_e,Ht,Ye)<1;)ae++,S(_e,Ht<Ye?vn:Ge,Ye,H),Ye=_e.length}else D===0&&(ae++,_e=[0]);Je[F++]=ae,_e[0]?_e[Ye++]=Nt[Di]||0:(_e=[Nt[Di]],Ye=1)}while((Di++<ls||_e[0]!=null)&&Tt--);G=_e[0]!=null,Je[0]||Je.splice(0,1)}if(H==l){for(F=1,Tt=Je[0];Tt>=10;Tt/=10,F++);K(Be,N+(Be.e=F+B*u-1)+1,j,G)}else Be.e=B,Be.r=+G;return Be}}();function A(b,R,S,$){var O,N,j,H,D;if(S==null?S=ee:y(S,0,8),!b.c)return b.toString();if(O=b.c[0],j=b.e,R==null)D=C(b.c),D=$==1||$==2&&(j<=te||j>=ce)?_(D,j):I(D,j,"0");else if(b=K(new w(b),R,S),N=b.e,D=C(b.c),H=D.length,$==1||$==2&&(R<=N||N<=te)){for(;H<R;D+="0",H++);D=_(D,N)}else if(R-=j,D=I(D,N,"0"),N+1>H){if(--R>0)for(D+=".";R--;D+="0");}else if(R+=N-H,R>0)for(N+1==H&&(D+=".");R--;D+="0");return b.s<0&&O?"-"+D:D}function L(b,R){for(var S,$,O=1,N=new w(b[0]);O<b.length;O++)$=new w(b[O]),(!$.s||(S=E(N,$))===R||S===0&&N.s===R)&&(N=$);return N}function U(b,R,S){for(var $=1,O=R.length;!R[--O];R.pop());for(O=R[0];O>=10;O/=10,$++);return(S=$+S*u-1)>we?b.c=b.e=null:S<je?b.c=[b.e=0]:(b.e=S,b.c=R),b}W=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,j,H,D){var B,F=H?j:j.replace(O,"");if($.test(F))N.s=isNaN(F)?null:F<0?-1:1;else{if(!H&&(F=F.replace(b,function(G,ae,he){return B=(he=he.toLowerCase())=="x"?16:he=="b"?2:8,!D||D==B?ae:G}),D&&(B=D,F=F.replace(R,"$1").replace(S,"0.$1")),j!=F))return new w(F,B);if(w.DEBUG)throw Error(s+"Not a"+(D?" base "+D:"")+" number: "+j);N.s=null}N.c=N.e=null}}();function K(b,R,S,$){var O,N,j,H,D,B,F,G=b.c,ae=h;if(G){e:{for(O=1,H=G[0];H>=10;H/=10,O++);if(N=R-O,N<0)N+=u,j=R,D=G[B=0],F=o(D/ae[O-j-1]%10);else if(B=i((N+1)/u),B>=G.length)if($){for(;G.length<=B;G.push(0));D=F=0,O=1,N%=u,j=N-u+1}else break e;else{for(D=H=G[B],O=1;H>=10;H/=10,O++);N%=u,j=N-u+O,F=j<0?0:o(D/ae[O-j-1]%10)}if($=$||R<0||G[B+1]!=null||(j<0?D:D%ae[O-j-1]),$=S<4?(F||$)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||$||S==6&&(N>0?j>0?D/ae[O-j]:0:G[B-1])%10&1||S==(b.s<0?8:7)),R<1||!G[0])return G.length=0,$?(R-=b.e+1,G[0]=ae[(u-R%u)%u],b.e=-R||0):G[0]=b.e=0,b;if(N==0?(G.length=B,H=1,B--):(G.length=B+1,H=ae[u-N],G[B]=j>0?o(D/ae[O-j]%ae[j])*H:0),$)for(;;)if(B==0){for(N=1,j=G[0];j>=10;j/=10,N++);for(j=G[0]+=H,H=1;j>=10;j/=10,H++);N!=H&&(b.e++,G[0]==l&&(G[0]=1));break}else{if(G[B]+=H,G[B]!=l)break;G[B--]=0,H=1}for(N=G.length;G[--N]===0;G.pop());}b.e>we?b.c=b.e=null:b.e<je&&(b.c=[b.e=0])}return b}function J(b){var R,S=b.e;return S===null?b.toString():(R=C(b.c),R=S<=te||S>=ce?_(R,S):I(R,S,"0"),b.s<0?"-"+R:R)}return V.absoluteValue=V.abs=function(){var b=new w(this);return b.s<0&&(b.s=1),b},V.comparedTo=function(b,R){return E(this,new w(b,R))},V.decimalPlaces=V.dp=function(b,R){var S,$,O,N=this;if(b!=null)return y(b,0,f),R==null?R=ee:y(R,0,8),K(new w(N),b+N.e+1,R);if(!(S=N.c))return null;if($=((O=S.length-1)-p(this.e/u))*u,O=S[O])for(;O%10==0;O/=10,$--);return $<0&&($=0),$},V.dividedBy=V.div=function(b,R){return P(this,new w(b,R),Z,ee)},V.dividedToIntegerBy=V.idiv=function(b,R){return P(this,new w(b,R),0,1)},V.exponentiatedBy=V.pow=function(b,R){var S,$,O,N,j,H,D,B,F,G=this;if(b=new w(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+J(b));if(R!=null&&(R=new w(R)),H=b.e>14,!G.c||!G.c[0]||G.c[0]==1&&!G.e&&G.c.length==1||!b.c||!b.c[0])return F=new w(Math.pow(+J(G),H?b.s*(2-T(b)):+J(b))),R?F.mod(R):F;if(D=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new w(NaN);$=!D&&G.isInteger()&&R.isInteger(),$&&(G=G.mod(R))}else{if(b.e>9&&(G.e>0||G.e<-1||(G.e==0?G.c[0]>1||H&&G.c[1]>=24e7:G.c[0]<8e13||H&&G.c[0]<=9999975e7)))return N=G.s<0&&T(b)?-0:0,G.e>-1&&(N=1/N),new w(D?1/N:N);wn&&(N=i(wn/u+2))}for(H?(S=new w(.5),D&&(b.s=1),B=T(b)):(O=Math.abs(+J(b)),B=O%2),F=new w(q);;){if(B){if(F=F.times(G),!F.c)break;N?F.c.length>N&&(F.c.length=N):$&&(F=F.mod(R))}if(O){if(O=o(O/2),O===0)break;B=O%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)B=T(b);else{if(O=+J(b),O===0)break;B=O%2}G=G.times(G),N?G.c&&G.c.length>N&&(G.c.length=N):$&&(G=G.mod(R))}return $?F:(D&&(F=q.div(F)),R?F.mod(R):N?K(F,wn,ee,j):F)},V.integerValue=function(b){var R=new w(this);return b==null?b=ee:y(b,0,8),K(R,R.e+1,b)},V.isEqualTo=V.eq=function(b,R){return E(this,new w(b,R))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(b,R){return E(this,new w(b,R))>0},V.isGreaterThanOrEqualTo=V.gte=function(b,R){return(R=E(this,new w(b,R)))===1||R===0},V.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},V.isLessThan=V.lt=function(b,R){return E(this,new w(b,R))<0},V.isLessThanOrEqualTo=V.lte=function(b,R){return(R=E(this,new w(b,R)))===-1||R===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(b,R){var S,$,O,N,j=this,H=j.s;if(b=new w(b,R),R=b.s,!H||!R)return new w(NaN);if(H!=R)return b.s=-R,j.plus(b);var D=j.e/u,B=b.e/u,F=j.c,G=b.c;if(!D||!B){if(!F||!G)return F?(b.s=-R,b):new w(G?j:NaN);if(!F[0]||!G[0])return G[0]?(b.s=-R,b):new w(F[0]?j:ee==3?-0:0)}if(D=p(D),B=p(B),F=F.slice(),H=D-B){for((N=H<0)?(H=-H,O=F):(B=D,O=G),O.reverse(),R=H;R--;O.push(0));O.reverse()}else for($=(N=(H=F.length)<(R=G.length))?H:R,H=R=0;R<$;R++)if(F[R]!=G[R]){N=F[R]<G[R];break}if(N&&(O=F,F=G,G=O,b.s=-b.s),R=($=G.length)-(S=F.length),R>0)for(;R--;F[S++]=0);for(R=l-1;$>H;){if(F[--$]<G[$]){for(S=$;S&&!F[--S];F[S]=R);--F[S],F[$]+=l}F[$]-=G[$]}for(;F[0]==0;F.splice(0,1),--B);return F[0]?U(b,F,B):(b.s=ee==3?-1:1,b.c=[b.e=0],b)},V.modulo=V.mod=function(b,R){var S,$,O=this;return b=new w(b,R),!O.c||!b.s||b.c&&!b.c[0]?new w(NaN):!b.c||O.c&&!O.c[0]?new w(O):(ot==9?($=b.s,b.s=1,S=P(O,b,0,3),b.s=$,S.s*=$):S=P(O,b,0,ot),b=O.minus(S.times(b)),!b.c[0]&&ot==1&&(b.s=O.s),b)},V.multipliedBy=V.times=function(b,R){var S,$,O,N,j,H,D,B,F,G,ae,he,xe,Be,Je,_e=this,Ye=_e.c,At=(b=new w(b,R)).c;if(!Ye||!At||!Ye[0]||!At[0])return!_e.s||!b.s||Ye&&!Ye[0]&&!At||At&&!At[0]&&!Ye?b.c=b.e=b.s=null:(b.s*=_e.s,!Ye||!At?b.c=b.e=null:(b.c=[0],b.e=0)),b;for($=p(_e.e/u)+p(b.e/u),b.s*=_e.s,D=Ye.length,G=At.length,D<G&&(xe=Ye,Ye=At,At=xe,O=D,D=G,G=O),O=D+G,xe=[];O--;xe.push(0));for(Be=l,Je=d,O=G;--O>=0;){for(S=0,ae=At[O]%Je,he=At[O]/Je|0,j=D,N=O+j;N>O;)B=Ye[--j]%Je,F=Ye[j]/Je|0,H=he*B+F*ae,B=ae*B+H%Je*Je+xe[N]+S,S=(B/Be|0)+(H/Je|0)+he*F,xe[N--]=B%Be;xe[N]=S}return S?++$:xe.splice(0,1),U(b,xe,$)},V.negated=function(){var b=new w(this);return b.s=-b.s||null,b},V.plus=function(b,R){var S,$=this,O=$.s;if(b=new w(b,R),R=b.s,!O||!R)return new w(NaN);if(O!=R)return b.s=-R,$.minus(b);var N=$.e/u,j=b.e/u,H=$.c,D=b.c;if(!N||!j){if(!H||!D)return new w(O/0);if(!H[0]||!D[0])return D[0]?b:new w(H[0]?$:O*0)}if(N=p(N),j=p(j),H=H.slice(),O=N-j){for(O>0?(j=N,S=D):(O=-O,S=H),S.reverse();O--;S.push(0));S.reverse()}for(O=H.length,R=D.length,O-R<0&&(S=D,D=H,H=S,R=O),O=0;R;)O=(H[--R]=H[R]+D[R]+O)/l|0,H[R]=l===H[R]?0:H[R]%l;return O&&(H=[O].concat(H),++j),U(b,H,j)},V.precision=V.sd=function(b,R){var S,$,O,N=this;if(b!=null&&b!==!!b)return y(b,1,f),R==null?R=ee:y(R,0,8),K(new w(N),b,R);if(!(S=N.c))return null;if(O=S.length-1,$=O*u+1,O=S[O]){for(;O%10==0;O/=10,$--);for(O=S[0];O>=10;O/=10,$++);}return b&&N.e+1>$&&($=N.e+1),$},V.shiftedBy=function(b){return y(b,-9007199254740991,c),this.times("1e"+b)},V.squareRoot=V.sqrt=function(){var b,R,S,$,O,N=this,j=N.c,H=N.s,D=N.e,B=Z+4,F=new w("0.5");if(H!==1||!j||!j[0])return new w(!H||H<0&&(!j||j[0])?NaN:j?N:1/0);if(H=Math.sqrt(+J(N)),H==0||H==1/0?(R=C(j),(R.length+D)%2==0&&(R+="0"),H=Math.sqrt(+R),D=p((D+1)/2)-(D<0||D%2),H==1/0?R="5e"+D:(R=H.toExponential(),R=R.slice(0,R.indexOf("e")+1)+D),S=new w(R)):S=new w(H+""),S.c[0]){for(D=S.e,H=D+B,H<3&&(H=0);;)if(O=S,S=F.times(O.plus(P(N,O,B,1))),C(O.c).slice(0,H)===(R=C(S.c)).slice(0,H))if(S.e<D&&--H,R=R.slice(H-3,H+1),R=="9999"||!$&&R=="4999"){if(!$&&(K(O,O.e+Z+2,0),O.times(O).eq(N))){S=O;break}B+=4,H+=4,$=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(K(S,S.e+Z+2,1),b=!S.times(S).eq(N));break}}return K(S,S.e+Z+1,ee,b)},V.toExponential=function(b,R){return b!=null&&(y(b,0,f),b++),A(this,b,R,1)},V.toFixed=function(b,R){return b!=null&&(y(b,0,f),b=b+this.e+1),A(this,b,R)},V.toFormat=function(b,R,S){var $,O=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=Ue;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if($=O.toFixed(b,R),O.c){var N,j=$.split("."),H=+S.groupSize,D=+S.secondaryGroupSize,B=S.groupSeparator||"",F=j[0],G=j[1],ae=O.s<0,he=ae?F.slice(1):F,xe=he.length;if(D&&(N=H,H=D,D=N,xe-=N),H>0&&xe>0){for(N=xe%H||H,F=he.substr(0,N);N<xe;N+=H)F+=B+he.substr(N,H);D>0&&(F+=B+he.slice(N)),ae&&(F="-"+F)}$=G?F+(S.decimalSeparator||"")+((D=+S.fractionGroupSize)?G.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):G):F}return(S.prefix||"")+$+(S.suffix||"")},V.toFraction=function(b){var R,S,$,O,N,j,H,D,B,F,G,ae,he=this,xe=he.c;if(b!=null&&(H=new w(b),!H.isInteger()&&(H.c||H.s!==1)||H.lt(q)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+J(H));if(!xe)return new w(he);for(R=new w(q),B=S=new w(q),$=D=new w(q),ae=C(xe),N=R.e=ae.length-he.e-1,R.c[0]=h[(j=N%u)<0?u+j:j],b=!b||H.comparedTo(R)>0?N>0?R:B:H,j=we,we=1/0,H=new w(ae),D.c[0]=0;F=P(H,R,0,1),O=S.plus(F.times($)),O.comparedTo(b)!=1;)S=$,$=O,B=D.plus(F.times(O=B)),D=O,R=H.minus(F.times(O=R)),H=O;return O=P(b.minus(S),$,0,1),D=D.plus(O.times(B)),S=S.plus(O.times($)),D.s=B.s=he.s,N=N*2,G=P(B,$,N,ee).minus(he).abs().comparedTo(P(D,S,N,ee).minus(he).abs())<1?[B,$]:[D,S],we=j,G},V.toNumber=function(){return+J(this)},V.toPrecision=function(b,R){return b!=null&&y(b,1,f),A(this,b,R,2)},V.toString=function(b){var R,S=this,$=S.s,O=S.e;return O===null?$?(R="Infinity",$<0&&(R="-"+R)):R="NaN":(b==null?R=O<=te||O>=ce?_(C(S.c),O):I(C(S.c),O,"0"):b===10&&v?(S=K(new w(S),Z+O+1,ee),R=I(C(S.c),S.e,"0")):(y(b,2,m.length,"Base"),R=z(I(C(S.c),O,"0"),10,b,$,!0)),$<0&&S.c[0]&&(R="-"+R)),R},V.valueOf=V.toJSON=function(){return J(this)},V._isBigNumber=!0,M!=null&&w.set(M),w}function p(M){var P=M|0;return M>0||M===P?P:P-1}function C(M){for(var P,z,W=1,V=M.length,q=M[0]+"";W<V;){for(P=M[W++]+"",z=u-P.length;z--;P="0"+P);q+=P}for(V=q.length;q.charCodeAt(--V)===48;);return q.slice(0,V+1||1)}function E(M,P){var z,W,V=M.c,q=P.c,Z=M.s,ee=P.s,te=M.e,ce=P.e;if(!Z||!ee)return null;if(z=V&&!V[0],W=q&&!q[0],z||W)return z?W?0:-ee:Z;if(Z!=ee)return Z;if(z=Z<0,W=te==ce,!V||!q)return W?0:!V^z?1:-1;if(!W)return te>ce^z?1:-1;for(ee=(te=V.length)<(ce=q.length)?te:ce,Z=0;Z<ee;Z++)if(V[Z]!=q[Z])return V[Z]>q[Z]^z?1:-1;return te==ce?0:te>ce^z?1:-1}function y(M,P,z,W){if(M<P||M>z||M!==o(M))throw Error(s+(W||"Argument")+(typeof M=="number"?M<P||M>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(M))}function T(M){var P=M.c.length-1;return p(M.e/u)==P&&M.c[P]%2!=0}function _(M,P){return(M.length>1?M.charAt(0)+"."+M.slice(1):M)+(P<0?"e":"e+")+P}function I(M,P,z){var W,V;if(P<0){for(V=z+".";++P;V+=z);M=V+M}else if(W=M.length,++P>W){for(V=z,P-=W;--P;V+=z);M+=V}else P<W&&(M=M.slice(0,P)+"."+M.slice(P));return M}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Fae)})(NL);var DL=NL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Yi=c_(),ale=l_(),lle=u_,ule=DL,Fn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},_g={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:kL,decimalSuffixes:Fw}=Yi.currentBytes(),h_={general:{scale:1024,suffixes:Fw},binary:{scale:1024,suffixes:kL},decimal:{scale:1e3,suffixes:Fw}};function cle(t,e={},n){if(typeof e=="string"&&(e=lle.parseFormat(e)),!ale.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=hle(t,e,n);return s=Ile(s,i),s=Ole(s,o),s}function hle(t,e,n){switch(e.output){case"currency":return e=Ec(e,Yi.currentCurrencyDefaultFormat()),yle(t,e,Yi);case"percent":return e=Ec(e,Yi.currentPercentageDefaultFormat()),vle(t,e,Yi,n);case"byte":return e=Ec(e,Yi.currentByteDefaultFormat()),mle(t,e,Yi,n);case"time":return e=Ec(e,Yi.currentTimeDefaultFormat()),wle(t);case"ordinal":return e=Ec(e,Yi.currentOrdinalDefaultFormat()),ple(t,e,Yi);case"number":default:return xg({instance:t,providedFormat:e})}}function dle(t){let e=h_.decimal;return cy(t._value,e.suffixes,e.scale).suffix}function fle(t){let e=h_.binary;return cy(t._value,e.suffixes,e.scale).suffix}function gle(t){let e=h_.general;return cy(t._value,e.suffixes,e.scale).suffix}function cy(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function mle(t,e,n,r){let i=e.base||"binary",o=Object.assign({},_g,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Fw,marker:"bd"},binary:{scale:1024,suffixes:s||kL,marker:"b"},decimal:{scale:1e3,suffixes:a||Fw,marker:"d"}}[i],{value:c,suffix:h}=cy(t._value,u.suffixes,u.scale);return`${xg({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function ple(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},_g,e),o=xg({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function wle(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function vle(t,e,n,r){let i=e.prefixSymbol,o=xg({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},_g,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function yle(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},_g,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=xg({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function Cle({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Fn[e]?(a=r[e],t=t/Fn[e]):l>=Fn.trillion||n&&s(l/Fn.trillion)===1?(a=r.trillion,t=t/Fn.trillion):l<Fn.trillion&&l>=Fn.billion||n&&s(l/Fn.billion)===1?(a=r.billion,t=t/Fn.billion):l<Fn.billion&&l>=Fn.million||n&&s(l/Fn.million)===1?(a=r.million,t=t/Fn.million):(l<Fn.million&&l>=Fn.thousand||n&&s(l/Fn.thousand)===1)&&(a=r.thousand,t=t/Fn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function ble({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function Hm(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function Sle(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Hm(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Hm(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Hm(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${Hm(e)}`),n}function Rle(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?Sle(t,e):new ule(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function Ele(t,e,n,r,i,o){if(r===-1)return t;let s=Rle(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function Tle(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function Mle(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function _le(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),Mle(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function xle(t,e){return t+e}function Ple(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function Ile(t,e){return e+t}function Ole(t,e){return t+e}function xg({instance:t,providedFormat:e,state:n=Yi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},_g,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,p=s.trimMantissa,C=s.thousandSeparated,E=s.spaceSeparated,y=s.negative,T=s.forceSign,_=s.exponential,I=s.roundingFunction,M="";if(d){let z=Cle({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:I,totalLength:a});o=z.value,M+=z.abbreviation,a&&(f=z.mantissaPrecision)}if(_){let z=ble({value:o,characteristicPrecision:l});o=z.value,M=z.abbreviation+M}let P=Ele(o.toString(),o,g,f,p,I);return P=Tle(P,o,u,l),P=_le(P,o,C,n,r),(d||_)&&(P=xle(P,M)),(T||o<0)&&(P=Ple(P,o,y)),P}function Ec(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var Ale=t=>({format:(...e)=>cle(...e,t),getByteUnit:(...e)=>gle(...e,t),getBinaryByteUnit:(...e)=>fle(...e,t),getDecimalByteUnit:(...e)=>dle(...e,t),formatOrDefault:Ec});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Gs=DL;function Hle(t,e,n){let r=new Gs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Gs(i),t._value=r.plus(i).toNumber(),t}function $L(t,e,n){let r=new Gs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Gs(i),t._value=r.minus(i).toNumber(),t}function Nle(t,e,n){let r=new Gs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Gs(i),t._value=r.times(i).toNumber(),t}function Dle(t,e,n){let r=new Gs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Gs(i),t._value=r.dividedBy(i).toNumber(),t}function kle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function $le(t,e,n){let r=n(t._value);return $L(r,e,n),Math.abs(r._value)}var Lle=t=>({add:(e,n)=>Hle(e,n,t),subtract:(e,n)=>$L(e,n,t),multiply:(e,n)=>Nle(e,n,t),divide:(e,n)=>Dle(e,n,t),set:(e,n)=>kle(e,n,t),difference:(e,n)=>$le(e,n,t),BigNumber:Gs});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Fle="2.5.0",as=c_(),Vle=l_(),Ble=sle(sn),Wle=HL();let pl=Ale(sn),Yl=Lle(sn);const jle=u_;class LL{constructor(e){this._value=e}clone(){return sn(this._value)}format(e={}){return pl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=jle.parseFormat(e)),e=pl.formatOrDefault(e,as.currentCurrencyDefaultFormat()),e.output="currency",pl.format(this,e)}formatTime(e={}){return e.output="time",pl.format(this,e)}binaryByteUnits(){return pl.getBinaryByteUnit(this)}decimalByteUnits(){return pl.getDecimalByteUnit(this)}byteUnits(){return pl.getByteUnit(this)}difference(e){return Yl.difference(this,e)}add(e){return Yl.add(this,e)}subtract(e){return Yl.subtract(this,e)}multiply(e){return Yl.multiply(this,e)}divide(e){return Yl.divide(this,e)}set(e){return Yl.set(this,FL(e))}value(){return this._value}valueOf(){return this._value}}function FL(t){let e=t;return sn.isNumbro(t)?e=t._value:typeof t=="string"?e=sn.unformat(t):isNaN(t)&&(e=NaN),e}function sn(t){return new LL(FL(t))}sn.version=Fle;sn.isNumbro=function(t){return t instanceof LL};sn.language=as.currentLanguage;sn.registerLanguage=as.registerLanguage;sn.setLanguage=as.setLanguage;sn.languages=as.languages;sn.languageData=as.languageData;sn.zeroFormat=as.setZeroFormat;sn.defaultFormat=as.currentDefaults;sn.setDefaults=as.setDefaults;sn.defaultCurrencyFormat=as.currentCurrencyDefaultFormat;sn.validate=Vle.validate;sn.loadLanguagesInNode=Ble.loadLanguagesInNode;sn.unformat=Wle.unformat;sn.BigNumber=Yl.BigNumber;var Ule=sn,wl=Vae(Ule);const zle="numeric";function VL(t,e){if(Jn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!wl.languages()[r]){const o=r.replace("-",""),s=wl.allLanguages?wl.allLanguages[r]:wl[o];s&&wl.registerLanguage(s)}wl.setLanguage(r),t=wl(t).format(i||"0")}return t}function d_(t,e,n,r,i,o,s){let a=o;if(Jn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=VL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}na(t,e,n,r,i,a,s)}d_.RENDERER_TYPE=zle;const Yle="password";function f_(t,e,n,r,i,o,s){na.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";ge(a-1,()=>{u+=l}),Hu(e,u)}f_.RENDERER_TYPE=Yle;const Gle="select";function g_(t,e,n,r,i,o,s){na.apply(this,[t,e,n,r,i,o,s])}g_.RENDERER_TYPE=Gle;const Kle="time";function m_(t,e,n,r,i,o,s){na.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}m_.RENDERER_TYPE=Kle;function qle(){Gr(Th),Gr(Mg),Gr(o_),Gr(i_),Gr(a_),Gr(r_),Gr(d_),Gr(f_),Gr(g_),Gr(na),Gr(m_)}const Xle="autocomplete";function hy(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,zO(n,e)):zO(n,e)(this.source):e(!0)}hy.VALIDATOR_TYPE=Xle;function zO(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function BL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Jle=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:BL},Symbol.toStringTag,{value:"Module"})),Zle="date";function p_(t,e){const n=g$(TL,this.instance);let r=t,i=!0;r==null&&(r="");let o=Q(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Q(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=Qle(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}p_.VALIDATOR_TYPE=Zle;function Qle(t,e){const n=Q(BL(t)),r=Q(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const eue="dropdown";function w_(t,e){hy.apply(this,[t,e])}w_.VALIDATOR_TYPE=eue;const tue="numeric";function v_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Jn(t))}v_.VALIDATOR_TYPE=tue;const nue=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],rue="time";function y_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Q(i,nue,!0).isValid()?Q(i):Q(i,n);let a=s.isValid(),l=Q(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}y_.VALIDATOR_TYPE=rue;function iue(){Jl(hy),Jl(w_),Jl(p_),Jl(v_),Jl(y_)}const oue="autocomplete",sue={CELL_TYPE:oue,editor:t_,renderer:Th,validator:hy},aue="checkbox",lue={CELL_TYPE:aue,editor:EL,renderer:o_},uue="date";function WL(t,e,n,r,i,o,s){Th.apply(this,[t,e,n,r,i,o,s])}WL.RENDERER_TYPE=uue;const cue="date",hue={CELL_TYPE:cue,editor:ML,renderer:WL,validator:p_},due="dropdown",fue={CELL_TYPE:due,editor:_L,renderer:i_,validator:w_,filter:!1,strict:!0},gue="handsontable",mue={CELL_TYPE:gue,editor:e_,renderer:a_},pue="numeric",wue={CELL_TYPE:pue,editor:xL,renderer:d_,validator:v_,dataType:"number"},vue="password",yue={CELL_TYPE:vue,editor:PL,renderer:f_,copyable:!1},Cue="select",bue={CELL_TYPE:Cue,editor:IL,renderer:g_},Sue="time",Rue={CELL_TYPE:Sue,editor:OL,renderer:m_,validator:y_};function Eue(){gi(sue),gi(lue),gi(hue),gi(fue),gi(mue),gi(wue),gi(yue),gi(bue),gi(SL),gi(Rue)}function Tue(t,e){jL(t,e),e.add(t)}function Mue(t,e,n){jL(t,e),e.set(t,n)}function jL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xu(t,e,n){return(e=_ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ue(t){var e=xue(t,"string");return typeof e=="symbol"?e:e+""}function xue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ju(t,e){return t.get(UL(t,e))}function UL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const YO=new Map([["plugin",DQ],["cell-type",dL],["editor",f$],["renderer",R$],["validator",E$]]),zL=Symbol("mainSetting"),Pue="base",Nm=[];let vl=null;var yl=new WeakMap,GO=new WeakSet;class tt{static get PLUGIN_KEY(){return Pue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){Tue(this,GO),Xu(this,"eventManager",new _i(this)),Xu(this,"pluginName",null),Xu(this,"pluginsInitializedCallbacks",[]),Xu(this,"isPluginsReady",!1),Xu(this,"enabled",!1),Xu(this,"initialized",!1),Mue(this,yl,{}),ss(this,"hot",e,{writable:!1}),vl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!YO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);YO.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Nm.push(o)}}if(vl||(vl=rT()),vl.indexOf(this.pluginName)>=0&&vl.splice(vl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),vl.length===0){if(Nm.length>0){const i=[`${Nm.join(`
`)}
`,"You have to import and register them manually."].join("");throw Nm.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||$e(n))&&r[zL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if($e(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){Ju(yl,this)[e]=Ju(yl,this)[e]||[];const i=Ju(yl,this)[e];this.hot.addHook(e,n,r),i.push(n),Ju(yl,this)[e]=i}removeHooks(e){x(Ju(yl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Ju(yl,this);Le(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){x(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=UL(GO,this,Iue).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Le(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function Iue(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Cl(t,e,n){return(e=Oue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oue(t){var e=Aue(t,"string");return typeof e=="symbol"?e:e+""}function Aue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let C_=class{constructor(e){Cl(this,"hot",null),Cl(this,"container",null),Cl(this,"injected",!1),Cl(this,"rows",[]),Cl(this,"columns",[]),Cl(this,"samples",null),Cl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),x(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),x(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{x(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{x(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{x(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),x(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{x(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Dm(t,e,n){return(e=Hue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hue(t){var e=Nue(t,"string");return typeof e=="symbol"?e:e+""}function Nue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dy{static get SAMPLE_COUNT(){return 3}constructor(e){Dm(this,"samples",null),Dm(this,"dataFactory",null),Dm(this,"customSampleCount",null),Dm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:dy.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return ge(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return ge(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:$e(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${It(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function Due(t,e){YL(t,e),e.add(t)}function pb(t,e,n){YL(t,e),e.set(t,n)}function YL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e,n){return(e=kue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kue(t){var e=$ue(t,"string");return typeof e=="symbol"?e:e+""}function $ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ka(t,e){return t.get(Nr(t,e))}function Vw(t,e,n){return t.set(Nr(t,e),n),n}function Nr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutoColumnSizeSeed");const wb="autoColumnSize",Lue=10,Fue="autoColumnSize";var b_=new WeakMap,Tc=new WeakMap,ah=new WeakMap,Kr=new WeakSet;class rf extends tt{static get PLUGIN_KEY(){return wb}static get PLUGIN_PRIORITY(){return Lue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Due(this,Kr),sd(this,"ghostTable",new C_(this.hot)),sd(this,"samplesGenerator",new dy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),sd(this,"inProgress",!1),sd(this,"measuredColumns",0),sd(this,"columnWidthsMap",new el),pb(this,b_,!1),pb(this,Tc,[]),pb(this,ah,[]),this.hot.columnIndexMapper.registerMap(Fue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Nr(Kr,this,KO).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[wb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Nr(Kr,e,Wue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Nr(Kr,e,jue).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Nr(Kr,e,zue).call(e,...i)}),this.addHook("beforeRender",()=>Nr(Kr,this,Bue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Nr(Kr,this,Uue).call(this)),super.enablePlugin()}updatePlugin(){Vw(ah,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Nr(Kr,this,KO).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;ge(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Nr(Kr,this,GL).call(this,s,o)}),this.ghostTable.columns.length&&(Nr(Kr,this,KL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){kf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+rf.CALCULATION_STEP,i)},e,n),r=r+rf.CALCULATION_STEP+1,r<i?o=Df(s):(kf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[wb];let n=rf.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return $e(e)&&(n=e.syncLimit,OE(n)?n=tT(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,rh))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=ka(Tc,this).length;return(s-1<o||ka(Tc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?ka(Tc,this).push(i):ka(Tc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Vue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||Nr(Kr,this,GL).call(this,n,e))}),this.ghostTable.columns.length&&(Nr(Kr,this,KL).call(this),this.ghostTable.clean())}function GL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function KL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function Bue(){this.calculateVisibleColumnsWidth(),this.inProgress||(Nr(Kr,this,Vue).call(this,ka(ah,this)),Vw(ah,this,[]))}function Wue(t,e){e||this.recalculateAllColumnsWidth()}function jue(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);ka(ah,this).push(...e)}function KO(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function Uue(){Vw(Tc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Vw(b_,this,!0)}function zue(t){if(!ka(b_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);ka(ah,this).push(...e)}const eu={horizontal:"horizontal",vertical:"vertical"};function Yue(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function Gue(t){const e={};return t===!0?(e.directions=Object.keys(eu),e.autoInsertRow=!0):$e(t)?(le(t.autoInsertRow)?t.direction===eu.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(eu)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Kue(t,e){que(t,e),e.add(t)}function que(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zu(t,e,n){return(e=Xue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xue(t){var e=Jue(t,"string");return typeof e=="symbol"?e:e+""}function Jue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ad(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutofillRange");oe.getSingleton().register("beforeAutofill");oe.getSingleton().register("afterAutofill");const qO="autofill",Zue=20,Que=["fillHandle"],ece="insert_row_below",tce=200;var Qu=new WeakSet;class nce extends tt{constructor(){super(...arguments),Kue(this,Qu),Zu(this,"addingStarted",!1),Zu(this,"mouseDownOnCellCorner",!1),Zu(this,"mouseDragOutside",!1),Zu(this,"handleDraggedCells",0),Zu(this,"directions",[]),Zu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return qO}static get PLUGIN_PRIORITY(){return Zue}static get SETTING_KEYS(){return[qO,...Que]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>ad(Qu,this,ice).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>ad(Qu,this,rce).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>ad(Qu,this,oce).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return x(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),x(a,c=>{const h=[];x(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=Yue(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),p=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,g,p,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=C;const y=C;if(["up","left"].indexOf(c)>-1&&!(y.length===1&&y[0].length===0))if(E=[],c==="up"){const T=d.row-h.row+1,_=T%y.length;for(let I=0;I<T;I++)E.push(y[(I+(y.length-_))%y.length])}else{const T=d.col-h.col+1,_=T%y[0].length;for(let I=0;I<y.length;I++){E.push([]);for(let M=0;M<T;M++)E[I].push(y[I][(M+(y[I].length-_))%y[I].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,p,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(eu.vertical)&&this.directions.includes(eu.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(eu.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(eu.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(ece,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},tce)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Jt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Jt(s)||!Jt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Xe(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Wn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+dn(this.hot.table),i=Wn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+on(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>ad(Qu,this,sce).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>ad(Qu,this,ace).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Gue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function rce(){this.selectAdjacent()&&this.fillIn()}function ice(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function oce(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function sce(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function ace(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function lce(t,e){qL(t,e),e.add(t)}function XO(t,e,n){qL(t,e),e.set(t,n)}function qL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ec(t,e,n){return(e=uce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uce(t){var e=cce(t,"string");return typeof e=="symbol"?e:e+""}function cce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XL(t,e,n){return t.set(Vo(t,e),n),n}function Bw(t,e){return t.get(Vo(t,e))}function Vo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vb="autoRowSize",hce=40,dce="autoRowSize";var Bf=new WeakMap,S_=new WeakMap,Ts=new WeakSet;class of extends tt{static get PLUGIN_KEY(){return vb}static get PLUGIN_PRIORITY(){return hce}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),lce(this,Ts),ec(this,"headerHeight",null),ec(this,"ghostTable",new C_(this.hot)),ec(this,"samplesGenerator",new dy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),ec(this,"inProgress",!1),ec(this,"measuredRows",0),ec(this,"rowHeightsMap",new el),XO(this,Bf,[]),XO(this,S_,!1),this.hot.rowIndexMapper.registerMap(dce,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Vo(Ts,this,JO).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[vb];return e===!0||$e(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Vo(Ts,e,mce).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Vo(Ts,e,pce).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Vo(Ts,e,vce).call(e,...i)}),this.addHook("beforeRender",()=>Vo(Ts,this,gce).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>Vo(Ts,this,wce).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Vo(Ts,this,JO).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}ge(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){kf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+of.CALCULATION_STEP,i)},e,n),r=r+of.CALCULATION_STEP+1,r<i?o=Df(s):(kf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[vb];let n=of.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return $e(e)&&(n=e.syncLimit,OE(n)?n=tT(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ge(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function fce(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function gce(){this.calculateVisibleRowsHeight(),this.inProgress||(Vo(Ts,this,fce).call(this,Bw(Bf,this)),XL(Bf,this,[]))}function JO(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function mce(t,e){e||this.recalculateAllRowsHeight()}function pce(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Bw(Bf,this).push(...e)}function wce(){this.recalculateAllRowsHeight(),XL(S_,this,!0)}function vce(t){if(!Bw(S_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Bw(Bf,this).push(...e)}const{getListWithInsertedItems:yce,getListWithRemovedItems:Cce}=K$("physicallyIndexed");class bce extends Nu{constructor(){super(e=>e)}insert(e,n){const r=xT(this.indexedValues,n);this.indexedValues=yce(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Cce(this.indexedValues,e);this.indexedValues=_T(n,e),super.remove(e)}}const{getListWithInsertedItems:Sce,getListWithRemovedItems:Rce}=K$("physicallyIndexed");class Ece extends Nu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Sce(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=Rce(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Tce(t,e){Mce(t,e),e.add(t)}function Mce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _ce(t,e,n){return(e=xce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xce(t){var e=Pce(t,"string");return typeof e=="symbol"?e:e+""}function Pce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ice(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ZO="bindRowsWithHeaders",Oce=210,Ace="loose",QO=new Map([["loose",bce],["strict",Ece]]);var eA=new WeakSet;class Hce extends tt{constructor(){super(...arguments),Tce(this,eA),_ce(this,"headerIndexes",null)}static get PLUGIN_KEY(){return ZO}static get PLUGIN_PRIORITY(){return Oce}isEnabled(){return!!this.hot.getSettings()[ZO]}enablePlugin(){var e;if(this.enabled)return;const n=(e=QO.get(this.getSetting()))!==null&&e!==void 0?e:QO.get(Ace);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>Ice(eA,this,Nce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Nce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Dce(t,e){JL(t,e),e.add(t)}function kce(t,e,n){JL(t,e),e.set(t,n)}function JL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tA(t,e,n){return(e=$ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ce(t){var e=Lce(t,"string");return typeof e=="symbol"?e:e+""}function Lce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nA(t,e){return t.get(Dc(t,e))}function yb(t,e,n){return t.set(Dc(t,e),n),n}function Dc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yp="collapsibleColumns",Fce=290,Vce=["nestedHeaders"],Kc="collapsibleIndicator",rA=Yp,iA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var tc=new WeakMap,ld=new WeakSet;class Bce extends tt{constructor(){super(...arguments),Dce(this,ld),tA(this,"nestedHeadersPlugin",null),tA(this,"headerStateManager",null),kce(this,tc,null)}static get PLUGIN_KEY(){return Yp}static get PLUGIN_PRIORITY(){return Fce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Yp,...Vce]}isEnabled(){return!!this.hot.getSettings()[Yp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||at("You need to configure the Nested Headers plugin in order to use collapsible headers."),yb(tc,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Dc(ld,this,Uce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dc(ld,e,zce).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dc(ld,e,Wce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Dc(ld,this,jce).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),yb(tc,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:rA,relativeToGroup:tl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};ge(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;ge(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Kc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Kc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Kc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!iA.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Ya(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;x(r,f=>{var g;let{row:p,col:C}=f;const{collapsible:E,isCollapsed:y}=(g=this.headerStateManager.getHeaderSettings(p,C))!==null&&g!==void 0?g:{};if(!E||y&&n==="collapse"||!y&&n==="expand")return i=!1,!1});const o=[],s=[];i&&x(r,f=>{let{row:g,col:p}=f;const{colspanCompensation:C,affectedColumns:E,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,g,p);C>0&&(s.push(...E),o.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=Ek([...a,...s]):n==="expand"&&(l=Ya(a,f=>!s.includes(f)));const u=iA.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){x(o,f=>{f()});return}this.hot.batchExecution(()=>{x(s,f=>{nA(tc,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;C!==null&&E!==null&&this.hot.selectCell(C,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return nA(tc,this).getHiddenIndexes()}destroy(){yb(tc,this,null),super.destroy()}}function Wce(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Kc}`);if(Au(e,[Ei("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),X(u,Kc),e.querySelector("div:first-child").appendChild(u)),ve(u,["collapsed","expanded"]),s?(X(u,"collapsed"),Ka(u,"+"),l&&Re(e,...Ei(!1))):(X(u,"expanded"),Ka(u,"-"),l&&Re(e,...Ei(!0))),l&&Re(u,...Ou());else{var c;(c=u)===null||c===void 0||c.remove()}}function jce(t,e){Ce(t.target,Kc)&&(Ce(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ce(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Hi(t))}function Uce(){this.updatePlugin()}function zce(t,e){e||this.updatePlugin()}function bl(t,e,n){return(e=Yce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yce(t){var e=Gce(t,"string");return typeof e=="symbol"?e:e+""}function Gce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Kce=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],qce=!1,Xce=!0,Jce=!0;class Zce{constructor(e,n){bl(this,"hot",void 0),bl(this,"sortingStates",new ry),bl(this,"sortEmptyCells",qce),bl(this,"indicator",Xce),bl(this,"headerAction",Jce),bl(this,"compareFunctionFactory",void 0),bl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){$e(e)&&Le(e,(n,r)=>{Kce.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return $e(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function ZL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Jo:Jt(i)?Jt(o)?Jo:s&&t==="asc"?qt:Xt:Jt(o)?s&&t==="asc"?Xt:qt:isNaN(i)&&!isNaN(o)?t==="asc"?Xt:qt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?qt:Xt:i>o?t==="asc"?Xt:qt:Jo}}const QL="default";function Qce(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Jo;if(a){if(Jt(r))return t==="asc"?qt:Xt;if(Jt(i))return t==="asc"?Xt:qt}return isNaN(o)?Xt:isNaN(s)?qt:o<s?t==="asc"?qt:Xt:o>s?t==="asc"?Xt:qt:Jo}}const ehe="numeric";function the(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Jt(s),u=Jt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Xt;if(l===!1&&u)return qt}return d===!1&&f?t==="asc"?qt:Xt:d&&f===!1?t==="asc"?Xt:qt:d===!1&&f===!1?ZL(t,e,n)(s,a):c===i&&h===r?t==="asc"?qt:Xt:c===r&&h===i?t==="asc"?Xt:qt:Jo}}const nhe="checkbox";function rhe(t,e,n){return oF(t,e.dateFormat,n)}const ihe="date";function ohe(t,e,n){return oF(t,e.timeFormat,n)}const she="time",{register:Pg,getItem:oA,hasItem:ahe}=fo("sorting.compareFunctionFactory"),{register:eF,getItem:lhe}=fo("sorting.mainSortComparator");function tF(t){return ahe(t)?oA(t):oA(QL)}Pg(nhe,the);Pg(ihe,rhe);Pg(QL,ZL);Pg(ehe,Qce);Pg(she,ohe);const Jo=0,qt=-1,Xt=1;function uhe(t,e){const n=lhe(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Ww="asc",jw="desc",nF="colHeader";function che(t){if($e(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Ww,jw].includes(n)}function hhe(t){if(t.some(n=>che(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function sA(t){if(t!==jw)return t===Ww?jw:Ww}function rF(t){return t.querySelector(`.${nF}`)}function iF(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function R_(t,e,n){return t===-1&&e>=0&&qa(n)===!1}function oF(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Jo;if(Jt(r))return Jt(i)?Jo:o&&t==="asc"?qt:Xt;if(Jt(i))return o&&t==="asc"?Xt:qt;const s=Q(r,e),a=Q(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?qt:Xt:a.isBefore(s)?t==="asc"?Xt:qt:Jo:qt:Xt}}function dhe(t,e){at(mt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const fhe="ascending",ghe="descending",sF="indicatorDisabled",aF="columnSorting",lF="sortAction",uF=new Map([[Ww,fhe],[jw,ghe]]);function mhe(t,e,n,r){const i=[aF];if(r&&i.push(lF),n===!1)return i.push(sF),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(uF.get(o)),i}function phe(){return Array.from(uF.values()).concat(lF,sF,aF)}function whe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:tF(u.type))(l,u,d)(c,h)}(0)}}function vhe(t,e){yhe(t,e),e.add(t)}function yhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function km(t,e,n){return(e=Che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Che(t){var e=bhe(t,"string");return typeof e=="symbol"?e:e+""}function bhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Uw="columnSorting",She=50,zw="append",Rhe="replace",aA=Uw;eF(Uw,whe);oe.getSingleton().register("beforeColumnSort");oe.getSingleton().register("afterColumnSort");const ud=new WeakMap;var Gl=new WeakSet;class cF extends tt{constructor(){super(...arguments),vhe(this,Gl),km(this,"columnStatesManager",null),km(this,"columnMetaCache",null),km(this,"pluginKey",Uw),km(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Uw}static get PLUGIN_PRIORITY(){return She}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(ud.has(this.hot)&&ud.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),dhe(ud.get(this.hot),this.pluginKey);return}this.enabled||(ud.set(this.hot,this.pluginKey),this.columnStatesManager=new Zce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new el(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Mc(Gl,this,Ehe).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Mc(Gl,e,Mhe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Mc(Gl,this,KR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Mc(Gl,e,The).call(e,...r)}),this.hot.view&&Mc(Gl,this,KR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=rF(r);iF(n,r)===!1||i===null||this.updateHeaderClasses(i)};ud.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:tl,position:"before",group:aA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aA)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new q$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return hhe(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Xe(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Xe(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=sA(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:sA()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Lt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===zw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Rhe)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if($e(e)){const n=e[this.pluginKey];if($e(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):ft(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Xe(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Xe(n,u=>u[0]);uhe(n,this.pluginKey,Xe(e,u=>u.sortOrder),Xe(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Xe(n,u=>u[0]),a=new Map(Xe(o,(u,c)=>[u,s[c]])),l=Xe(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if($e(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||$e(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ve(e,phe()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];X(e,mhe(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ce(e.target,nF)}onAfterOnCellMouseDown(e,n){if(R_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function KR(){const t=this.getAllSavedSortSettings();if($e(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Ehe(t,e){const n=rF(e);if(iF(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Re(e,...J8(s?`${s}ending`:"none"))}}function The(t){t===!0&&this.hot.view&&Mc(Gl,this,KR).call(this)}function Mhe(t,e,n,r){R_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Sl(t,e,n){return(e=_he(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _he(t){var e=xhe(t,"string");return typeof e=="symbol"?e:e+""}function xhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Phe{constructor(e,n){Sl(this,"plugin",void 0),Sl(this,"hot",void 0),Sl(this,"endpoints",[]),Sl(this,"settings",void 0),Sl(this,"settingsType","array"),Sl(this,"currentEndpoint",null),Sl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),x(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();x(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;x(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?x(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):x(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){x(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];x(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),x(i,o=>{let s=[];x(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,x(e.ranges,r=>{x(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],x(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],x(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],x(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&x(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),x(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){at("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function Cb(t){return t==null||isNaN(t)}function Ihe(t,e){Ohe(t,e),e.add(t)}function Ohe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ahe(t,e,n){return(e=Hhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hhe(t){var e=Nhe(t,"string");return typeof e=="symbol"?e:e+""}function Nhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $m(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bb="columnSummary",Dhe=220;var cd=new WeakSet;class khe extends tt{constructor(){super(...arguments),Ihe(this,cd),Ahe(this,"endpoints",null)}static get PLUGIN_KEY(){return bb}static get PLUGIN_PRIORITY(){return Dhe}isEnabled(){return!!this.hot.getSettings()[bb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[bb],this.endpoints=new Phe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $m(cd,e,$he).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $m(cd,e,Fhe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $m(cd,e,Lhe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $m(cd,e,Vhe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Le(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Cb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Le(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Cb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Cb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Le(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(mt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function $he(){this.endpoints.initEndpoints()}function Lhe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Fhe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Vhe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Bhe(t,e){hF(t,e),e.add(t)}function Sb(t,e,n){hF(t,e),e.set(t,n)}function hF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _c(t,e){return t.get(E_(t,e))}function qR(t,e,n){return t.set(E_(t,e),n),n}function E_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yw=new WeakMap,Lm=new WeakMap,Fm=new WeakMap,lA=new WeakSet;class dF{constructor(){Bhe(this,lA),Sb(this,Yw,!0),Sb(this,Lm,null),Sb(this,Fm,new ResizeObserver(e=>E_(lA,this,Whe).call(this,e)))}setObservedElement(e){qR(Lm,this,e)}unobserve(){_c(Fm,this).unobserve(_c(Lm,this))}observe(){qR(Yw,this,!0),_c(Fm,this).observe(_c(Lm,this))}destroy(){_c(Fm,this).disconnect()}}function Whe(t){if(_c(Yw,this)||!Array.isArray(t)||!t.length){qR(Yw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}yt(dF,jn);function Rl(t,e,n){jhe(t,e),e.set(t,n)}function jhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(t,e){return t.get(fF(t,e))}function vs(t,e,n){return t.set(fF(t,e),n),n}function fF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var El=new WeakMap,Rb=new WeakMap,ys=new WeakMap,aa=new WeakMap,la=new WeakMap,Vm=new WeakMap,nc=new WeakMap;class tu{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;Rl(this,El,void 0),Rl(this,Rb,!1),Rl(this,ys,null),Rl(this,aa,void 0),Rl(this,la,void 0),Rl(this,Vm,!0),Rl(this,nc,new dF),vs(El,this,e),vs(Rb,this,n),vs(aa,this,this.createEditor()),vs(la,this,Ct(aa,this).style),Ct(nc,this).setObservedElement(this.getInputElement()),Ct(nc,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){Ct(la,this).left=`${e}px`,Ct(la,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:on(this.getInputElement()),height:dn(this.getInputElement())}}observeSize(){Ct(nc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){Ct(la,this).display="block",vs(Vm,this,!1)}hide(){Ct(nc,this).unobserve(),Ct(Vm,this)||(Ct(la,this).display="none"),vs(Vm,this,!0)}isVisible(){return Ct(la,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return Ct(El,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Ct(El,this).createElement("div"),n=Ct(El,this).createElement("textarea");return e.style.display="none",vs(ys,this,Ct(El,this).createElement("div")),Ct(ys,this).setAttribute("dir",Ct(Rb,this)?"rtl":"ltr"),X(Ct(ys,this),tu.CLASS_EDITOR_CONTAINER),Ct(El,this).body.appendChild(Ct(ys,this)),X(e,tu.CLASS_EDITOR),X(n,tu.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),Ct(ys,this).appendChild(e),e}getInputElement(){return Ct(aa,this).querySelector(`.${tu.CLASS_INPUT}`)}getEditorElement(){return Ct(aa,this)}destroy(){const e=Ct(ys,this)?Ct(ys,this).parentNode:null;Ct(aa,this).parentNode.removeChild(Ct(aa,this)),vs(aa,this,null),vs(la,this,null),Ct(nc,this).destroy(),e&&e.removeChild(Ct(ys,this))}}yt(tu,jn);function Eb(t,e,n){return(e=Uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uhe(t){var e=zhe(t,"string");return typeof e=="symbol"?e:e+""}function zhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Yhe=250,Ghe=250;class gF{constructor(e){Eb(this,"wasLastActionShow",!0),Eb(this,"showDebounced",null),Eb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Ghe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yhe;this.showDebounced=vg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}yt(gF,jn);function Khe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function qhe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Tl(t,e){const n={};return x(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function ba(t,e,n,r,i){x(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Xhe(s,a,e,n,r,i)})})}function Xhe(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Khe(s.className,r):a=qhe(s.className,r)),o(t,e,"className",a)}function mF(t){return`<span class="selected">✓</span>${t}`}function Gp(t,e){let n=!1;return Array.isArray(t)&&x(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function fy(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Ve="---------";function Jhe(){return{name:Ve}}const wi="alignment";function Zhe(){return{key:wi,name(){return this.getTranslatedPhrase(QT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${wi}:left`,name(){return this.getTranslatedPhrase(eM)},callback(){const t=this.getSelectedRange(),e=Tl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),ba(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${wi}:center`,name(){return this.getTranslatedPhrase(tM)},callback(){const t=this.getSelectedRange(),e=Tl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),ba(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${wi}:right`,name(){return this.getTranslatedPhrase(nM)},callback(){const t=this.getSelectedRange(),e=Tl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),ba(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${wi}:justify`,name(){return this.getTranslatedPhrase(rM)},callback(){const t=this.getSelectedRange(),e=Tl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),ba(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Ve},{key:`${wi}:top`,name(){return this.getTranslatedPhrase(iM)},callback(){const t=this.getSelectedRange(),e=Tl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),ba(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${wi}:middle`,name(){return this.getTranslatedPhrase(oM)},callback(){const t=this.getSelectedRange(),e=Tl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),ba(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${wi}:bottom`,name(){return this.getTranslatedPhrase(sM)},callback(){const t=this.getSelectedRange(),e=Tl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),ba(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const gy="clear_column";function Qhe(){return{key:gy,name(){return this.getTranslatedPhrase(FT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Ig="col_left";function ede(){return{key:Ig,name(){return this.getTranslatedPhrase(HT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Og="col_right";function tde(){return{key:Og,name(){return this.getTranslatedPhrase(NT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Ag="make_read_only";function nde(){return{key:Ag,checkable:!0,ariaChecked(){return Gp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Dw)},name(){let t=this.getTranslatedPhrase(Dw);return Gp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=mF(t)),t},callback(){const t=this.getSelectedRange(),e=Gp(t,(n,r)=>this.getCellMeta(n,r).readOnly);x(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const my="redo";function rde(){return{key:my,name(){return this.getTranslatedPhrase(LT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Hg="remove_col";function ide(){return{key:Hg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(kT,e)},callback(){this.alter("remove_col",Bie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const py="remove_row";function ode(){return{key:py,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(DT,e)},callback(){this.alter("remove_row",Wie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const wy="row_above";function sde(){return{key:wy,name(){return this.getTranslatedPhrase(OT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const vy="row_below";function ade(){return{key:vy,name(){return this.getTranslatedPhrase(AT)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Wf="no_items";function lde(){return{key:Wf,name(){return this.getTranslatedPhrase(IT)},disabled:!0,isCommand:!1}}const yy="undo";function ude(){return{key:yy,name(){return this.getTranslatedPhrase($T)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const cde=[wy,vy,Ig,Og,gy,py,Hg,yy,my,Ag,wi,Ve,Wf],hde={[Ve]:Jhe,[Wf]:lde,[wy]:sde,[vy]:ade,[Ig]:ede,[Og]:tde,[gy]:Qhe,[py]:ode,[Hg]:ide,[yy]:ude,[my]:rde,[Ag]:nde,[wi]:Zhe};function pF(){const t={};return Le(hde,(e,n)=>{t[n]=e()}),t}function dde(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(XT):this.getTranslatedPhrase(qT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function fde(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(JT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function gde(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(ZT);return Gp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Kp))?mF(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Kp);t.updateCommentMeta(n,r,{[Kp]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function mde(t,e){wF(t,e),e.add(t)}function rc(t,e,n){wF(t,e),e.set(t,n)}function wF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pde(t,e,n){return(e=wde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wde(t){var e=vde(t,"string");return typeof e=="symbol"?e:e+""}function vde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $a(t,e,n){return t.set(xr(t,e),n),n}function De(t,e){return t.get(xr(t,e))}function xr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gw="comments",yde=60,Is="comment",Ud="value",vF="style",Kp="readOnly",hd=Gw,XR=`plugin:${Gw}`;var wt=new WeakMap,ko=new WeakMap,Cy=new WeakMap,qp=new WeakMap,JR=new WeakMap,Kw=new WeakMap,Br=new WeakSet;class Cde extends tt{constructor(){super(...arguments),mde(this,Br),pde(this,"range",{}),rc(this,wt,null),rc(this,ko,null),rc(this,Cy,!1),rc(this,qp,!1),rc(this,JR,null),rc(this,Kw,"")}static get PLUGIN_KEY(){return Gw}static get PLUGIN_PRIORITY(){return yde}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Gw]}enablePlugin(){var e=this;this.enabled||(De(wt,this)||($a(wt,this,new tu(this.hot.rootDocument,this.hot.isRtl())),De(wt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xr(Br,e,xde).call(e,...r)})),De(ko,this)||$a(ko,this,new gF(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>xr(Br,this,Tde).call(this,n,a)),this.addHook("afterScroll",()=>xr(Br,this,Pde).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>xr(Br,this,uA).call(this,n)),this.addHook("beforeCompositionStart",n=>xr(Br,this,uA).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xr(Br,e,Ide).call(e,...r)}),De(ko,this).addLocalHook("hide",()=>this.hide()),De(ko,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){De(ko,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(XR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();$a(qp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(XR),this.hot._registerTimeout(()=>{$a(qp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:hd}),r.addShortcut({keys:[["Escape"]],callback:()=>{De(wt,this).setValue(De(Kw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>De(wt,this).isVisible()&&De(wt,this).isFocused(),group:hd}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>De(wt,this).isVisible()&&De(wt,this).isFocused(),group:hd}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{De(wt,this).setValue(De(wt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:hd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hd)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>xr(Br,this,Rde).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>xr(Br,this,bde).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>xr(Br,this,Ede).call(this)),this.eventManager.addEventListener(n,"focus",()=>xr(Br,this,_de).call(this)),this.eventManager.addEventListener(n,"blur",()=>xr(Br,this,Mde).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>xr(Br,this,Sde).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Ga(e.target,"TD","TBODY");return!!(n&&Ce(n,"htCommentCell")&&Ga(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=De(wt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Ud]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Is),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Ud)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Ud)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return De(ko,this).cancelHiding(),De(wt,this).setValue((e=i[Is]?i[Is][Ud]:null)!==null&&e!==void 0?e:""),De(wt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){De(wt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!De(wt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;De(wt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),p=this.getCommentMeta(i,o,vF);p?De(wt,this).setSize(p.width,p.height):De(wt,this).resetSize();const C=c?0:f.getColumnWidth(a),E=l&&!u?dn(g):0,{left:y,top:T,width:_,height:I}=g.getBoundingClientRect(),{width:M,height:P}=De(wt,this).getSize(),{innerWidth:z,innerHeight:W}=this.hot.rootWindow,V=this.hot.rootDocument.documentElement,q=On(this.hot.rootDocument),Z=VE(this.hot.rootWindow)?q:0,ee=BE(this.hot.rootWindow)?q:0;let te=y+h.scrollX+C,ce=T+h.scrollY+E;this.hot.isRtl()&&(te-=M+C),this.hot.isLtr()&&y+_+M>z-Z?te=y+h.scrollX-M-1:this.hot.isRtl()&&te<-(V.scrollWidth-V.clientWidth)&&(te=y+h.scrollX+C+1),T+P>W-ee&&(ce-=P-I+1),De(wt,this).setPosition(te,ce),De(wt,this).setReadOnlyState(this.getCommentMeta(i,o,Kp)),De(wt,this).observeSize()}focusEditor(){De(wt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Is];let o;i?(o=rr(i),Cg(o,r)):o=r,this.hot.setCellMeta(e,n,Is,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Is])return i[Is][r]}addToContextMenu(e){e.items.push({name:Ve},dde(this),fde(this),gde(this))}getEditorInputElement(){return De(wt,this).getInputElement()}destroy(){var e,n;(e=De(wt,this))===null||e===void 0||e.destroy(),(n=De(ko,this))===null||n===void 0||n.destroy(),super.destroy()}}function bde(t){if(!(!this.hot.view||!this.hot.view._wt)&&!De(Cy,this)&&!this.targetIsCommentTextArea(t)){const e=Ga(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Sde(t){t.stopPropagation()}function Rde(t){const{rootDocument:e}=this.hot;if(!(De(Cy,this)||De(wt,this).isFocused()||Ce(t.target,"wtBorder")||De(JR,this)===t.target||!De(wt,this)))if($a(JR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));De(ko,this).show(n)}else Ba(t.target,e)&&!this.targetIsCommentTextArea(t)&&De(ko,this).hide()}function Ede(){$a(Cy,this,!1)}function Tde(t,e){e[Is]&&e[Is][Ud]&&X(t,e.commentedCellClassName)}function Mde(){$a(Kw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _de(){$a(Kw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(XR)}function xde(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[vF]:{width:t,height:e}})}function uA(t){De(wt,this).isFocused()&&Hi(t)}function Pde(){De(qp,this)||this.hide()}function Ide(){const t=De(wt,this).getEditorElement();ve(t,/ht-theme-.*/g),X(t,this.hot.getCurrentThemeName())}function Tb(t,e,n){return(e=Ode(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ode(t){var e=Ade(t,"string");return typeof e=="symbol"?e:e+""}function Ade(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yF{constructor(e){Tb(this,"hot",void 0),Tb(this,"commands",{}),Tb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Hde(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||cn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),x(u,c=>c.apply(this.hot,r))}}function Hde(t,e){let n;return x(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Mb(t,e,n){return(e=Nde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nde(t){var e=Dde(t,"string");return typeof e=="symbol"?e:e+""}function Dde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Mb(this,"hot",void 0),Mb(this,"predefinedItems",pF()),Mb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Le(e,(r,i)=>{let o="";r.name===Ve?(n[Ve]=r,o=Ve):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return kde(e,this.defaultOrderPattern,this.predefinedItems)}}function kde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),$e(i)?Le(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),$e(o)?fn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):x(i,(o,s)=>{let a=n[o];!a&&cde.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),$e(o)&&fn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ua(t,e,n){return(e=$de(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $de(t){var e=Lde(t,"string");return typeof e=="symbol"?e:e+""}function Lde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fde{constructor(e,n){ua(this,"top",void 0),ua(this,"topRelative",void 0),ua(this,"left",void 0),ua(this,"leftRelative",void 0),ua(this,"scrollTop",void 0),ua(this,"scrollLeft",void 0),ua(this,"cellHeight",void 0),ua(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function dd(t,e,n){Vde(t,e),e.set(t,n)}function Vde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function He(t,e){return t.get(bF(t,e))}function Bm(t,e,n){return t.set(bF(t,e),n),n}function bF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ar=new WeakMap,Er=new WeakMap,Tr=new WeakMap,_b=new WeakMap,ic=new WeakMap;class Bde{constructor(e){dd(this,ar,void 0),dd(this,Er,void 0),dd(this,Tr,void 0),dd(this,_b,!1),dd(this,ic,{above:0,below:0,left:0,right:0}),Bm(_b,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return He(ic,this)[e]=n,this}setElement(e){return Bm(ar,this,e),this}setParentElement(e){return Bm(Er,this,e),this}updatePosition(e){Bm(Tr,this,new Fde(e,He(ar,this).ownerDocument.defaultView)),He(_b,this)?(He(Tr,this).fitsBelow(He(ar,this))?this.setPositionBelowCursor():He(Tr,this).fitsAbove(He(ar,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){He(ar,this).dir==="rtl"?He(Tr,this).fitsOnLeft(He(ar,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():He(Tr,this).fitsOnRight(He(ar,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=He(ic,this).above+He(Tr,this).top-He(ar,this).offsetHeight;if(He(Er,this)){const r=He(Er,this).ownerDocument.defaultView.getComputedStyle(He(Er,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=He(Tr,this).top+He(Tr,this).cellHeight-He(ar,this).scrollHeight+i+o}He(ar,this).style.top=`${e}px`}setPositionBelowCursor(){let e=He(ic,this).below+He(Tr,this).top+1;if(He(Er,this)){const r=He(Er,this).ownerDocument.defaultView.getComputedStyle(He(Er,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=He(Tr,this).top-i-o-1}He(ar,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=He(Tr,this).left;if(He(Er,this)){const n=He(Er,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(He(Er,this).querySelector(".htCore")).borderRightWidth,10);e+=He(Tr,this).cellWidth+r}else e+=He(ic,this).right;He(ar,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=He(ic,this).left+He(Tr,this).left-He(ar,this).offsetWidth;if(He(Er,this)){const n=He(Er,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(He(Er,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}He(ar,this).style.left=`${e}px`}}function SF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ze(e,-1,g()-1);function a(C,E){const y=g()-1;return C<0&&(C=y),C>y&&(C=0),o.has(C)?-1:(o.add(C),r(C,!1)===!1&&(C=a(E===1?++C:--C,E)),C)}function l(C){C>-1&&C<g()&&r(C,!0)!==!1&&(s=C)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function p(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:p}}function Wde(t){return Xe(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ZR(t){return cn(t,"submenu")}function QR(t){return new RegExp(Ve,"i").test(t.name)}function Xp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function cA(t){return cn(t,"disableSelection")}function jde(t){return Ce(t,"htSeparator")}function Ude(t){return Ce(t,"htSubmenu")}function zde(t){return Ce(t,"htDisabled")}function Yde(t){return Ce(t,"htSelectionDisabled")}function Gde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function RF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Kde(t,e){let n=t.slice(0);return n.reverse(),n=RF(n,e),n.reverse(),n}function qde(t){const e=[];return x(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Xde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ve,n=t.slice(0);return n=RF(n,e),n=Kde(n,e),n=qde(n),n}function Jde(t){return t.checkable===!0}function Zde(t){return SF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||jde(r)||zde(r)||Yde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Qde(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const EF="menu",hA=EF;function efe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Qde(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:EF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${hA}:${u}`:hA}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function tfe(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(es(n),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Xp(a,t)&&!cA(a)&&!QR(a);Re(n,[...Jde(a)?[W8(),Af(c),Ak(h)]:[B8(),Af(u)],...d?[Iu(-1)]:[],...Xp(a,t)?[q8()]:[],...ZR(a)?[Ei(!1)]:[]])}n.className="",n.appendChild(l),QR(a)?X(n,"htSeparator"):typeof a.renderer=="function"?(X(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Hu(l,u),Xp(a,t)?X(n,"htDisabled"):cA(a)?X(n,"htSelectionDisabled"):ZR(a)&&X(n,"htSubmenu")}}function xb(t,e,n){nfe(t,e),e.set(t,n)}function nfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ro(t,e,n){return(e=rfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rfe(t){var e=ife(t,"string");return typeof e=="symbol"?e:e+""}function ife(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pb(t,e,n){return t.set(TF(t,e),n),n}function Ml(t,e){return t.get(TF(t,e))}function TF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dA=215;var fd=new WeakMap,Wm=new WeakMap,jm=new WeakMap;class Mh{get tableBorderWidth(){return Ml(jm,this)===void 0&&this.hotMenu&&Pb(jm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ml(jm,this)}constructor(e,n){var r=this;Ro(this,"hot",void 0),Ro(this,"options",void 0),Ro(this,"eventManager",new _i(this)),Ro(this,"container",void 0),Ro(this,"positioner",void 0),Ro(this,"hotMenu",null),Ro(this,"hotSubMenus",{}),Ro(this,"parentMenu",void 0),Ro(this,"menuItems",null),Ro(this,"origOutsideClickDeselects",null),xb(this,fd,void 0),xb(this,Wm,void 0),xb(this,jm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:dA,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Bde(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=fu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ml(fd,this)}getKeyboardShortcutsCtrl(){return Ml(Wm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=vg(a=>this.openSubMenu(a),300),n=this.options.minWidth||dA;let r=!1,i=Ya(this.menuItems,a=>(a.key===Wf&&(r=!0),Gde(a,this.hot)));if(i.length<1&&!r)i.push(pF()[Wf]);else if(i.length===0)return;i=Xde(i,Ve);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:tfe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Ml(fd,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),MR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!MR()||!qa(a))&&o&&this.hasSelectedItem()&&(Ko()||qE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Pb(fd,this,Zde(this.hotMenu)),Pb(Wm,this,efe(this)),Ml(Wm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ml(fd,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Re(r,[Ei(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Ude(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Mh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Re(n,[Ei(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Re(i,[Ei(!1)])}}closeAllSubMenus(){x(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Wde(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||QR(e)||Xp(e,this.hot)||ZR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=Mn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?dn(this.hotMenu.getCell(c,0)):0;return l+(u.name===Ve?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(ft(r)&&(r=r.call(this.hot),r===null||Lt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),r&&X(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Re(this.hotMenu.rootElement,[V8(),Iu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ba(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ba(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ce(e.target,"htCore")&&Ba(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}yt(Mh,jn);function ofe(t,e){sfe(t,e),e.add(t)}function sfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ib(t,e,n){return(e=afe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function afe(t){var e=lfe(t,"string");return typeof e=="symbol"?e:e+""}function lfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Um(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zd="contextMenu",ufe=70,fA=zd;oe.getSingleton().register("afterContextMenuDefaultOptions");oe.getSingleton().register("beforeContextMenuShow");oe.getSingleton().register("afterContextMenuShow");oe.getSingleton().register("afterContextMenuHide");oe.getSingleton().register("afterContextMenuExecute");var gd=new WeakSet;class by extends tt{constructor(){super(...arguments),ofe(this,gd),Ib(this,"commandExecutor",new yF(this.hot)),Ib(this,"itemsFactory",null),Ib(this,"menu",null)}static get PLUGIN_KEY(){return zd}static get PLUGIN_PRIORITY(){return ufe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[wy,vy,Ve,Ig,Og,Ve,py,Hg,Ve,yy,my,Ve,Ag,Ve,wi]}isEnabled(){return!!this.hot.getSettings()[zd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[zd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Mh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Um(gd,this,hfe).call(this)),this.menu.addLocalHook("afterOpen",()=>Um(gd,this,dfe).call(this)),this.menu.addLocalHook("afterClose",()=>Um(gd,this,ffe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Um(gd,this,cfe).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=fy(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:fA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fA)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Le(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new CF(this.hot,by.DEFAULT_ITEMS);const e=this.hot.getSettings()[zd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),x(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function cfe(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ce(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Ce(o,"current")&&Ce(o,"wtBorder"))))return;const s=fy(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function hfe(){this.hot.runHooks("beforeContextMenuShow",this)}function dfe(){this.hot.runHooks("afterContextMenuShow",this)}function ffe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}by.SEPARATOR={name:Ve};function gfe(t){return{key:"copy",name(){return this.getTranslatedPhrase(VT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function mfe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(jT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function pfe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(WT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function wfe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(BT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function vfe(t){return{key:"cut",name(){return this.getTranslatedPhrase(UT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class yfe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Cfe{constructor(){this.clipboardData=new yfe}preventDefault(){}composedPath(){return[]}}function bfe(t,e){MF(t,e),e.add(t)}function oc(t,e,n){MF(t,e),e.set(t,n)}function MF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(t,e){return t.get(kc(t,e))}function sc(t,e,n){return t.set(kc(t,e),n),n}function kc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ca=new WeakMap,Ob=new WeakMap,md=new WeakMap,e0=new WeakMap,t0=new WeakMap,pd=new WeakMap,wd=new WeakSet;class Sfe{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;bfe(this,wd),oc(this,ca,void 0),oc(this,Ob,void 0),oc(this,md,void 0),oc(this,e0,void 0),oc(this,t0,void 0),oc(this,pd,void 0),sc(Ob,this,n),sc(md,this,r),sc(e0,this,i),sc(t0,this,o),sc(pd,this,s)}setSelectedRange(e){sc(ca,this,e)}getCellsRange(){if(hr(Ob,this).call(this)===0||hr(md,this).call(this)===0)return null;const{row:e,col:n}=hr(ca,this).getTopStartCorner(),{row:r,col:i}=hr(ca,this).getBottomEndCorner(),o=kc(wd,this,Rfe).call(this,e,r),s=kc(wd,this,Ab).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(hr(md,this).call(this)===0||hr(pd,this).call(this)===0)return null;const{col:e}=hr(ca,this).getTopStartCorner(),{col:n}=hr(ca,this).getBottomEndCorner(),r=kc(wd,this,Ab).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(hr(md,this).call(this)===0||hr(pd,this).call(this)===0)return null;const{col:e}=hr(ca,this).getTopStartCorner(),{col:n}=hr(ca,this).getBottomEndCorner(),r=kc(wd,this,Ab).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-hr(pd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Ab(t,e){return Math.min(e,Math.max(t+hr(t0,this).call(this)-1,t))}function Rfe(t,e){return Math.min(e,Math.max(t+hr(e0,this).call(this)-1,t))}function _F(t){const e=[],n=[];return x(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);ge(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);ge(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Efe(t,e){xF(t,e),e.add(t)}function ha(t,e,n){xF(t,e),e.set(t,n)}function xF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vd(t,e,n){return(e=Tfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tfe(t){var e=Mfe(t,"string");return typeof e=="symbol"?e:e+""}function Mfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hr(t,e){return t.get(Dr(t,e))}function Ui(t,e,n){return t.set(Dr(t,e),n),n}function Dr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterCopyLimit");oe.getSingleton().register("modifyCopyableRange");oe.getSingleton().register("beforeCut");oe.getSingleton().register("afterCut");oe.getSingleton().register("beforePaste");oe.getSingleton().register("afterPaste");oe.getSingleton().register("beforeCopy");oe.getSingleton().register("afterCopy");const Hb="copyPaste",_fe=80,xfe=["fragmentSelection"],gA=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var n0=new WeakMap,r0=new WeakMap,i0=new WeakMap,ac=new WeakMap,zm=new WeakMap,Ym=new WeakMap,lc=new WeakMap,qw=new WeakMap,qr=new WeakSet;class Pfe extends tt{constructor(){super(...arguments),Efe(this,qr),vd(this,"columnsLimit",1/0),vd(this,"rowsLimit",1/0),vd(this,"pasteMode","overwrite"),vd(this,"uiContainer",this.hot.rootDocument.body),ha(this,n0,!1),ha(this,r0,!1),ha(this,i0,!1),ha(this,ac,"cells-only"),ha(this,zm,!1),ha(this,Ym,!1),ha(this,lc,new Sfe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),ha(this,qw,!1),vd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Hb}static get SETTING_KEYS(){return[Hb,...xfe]}static get PLUGIN_PRIORITY(){return _fe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Hb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Ui(n0,this,this.getSetting("copyColumnHeaders")),Ui(r0,this,this.getSetting("copyColumnGroupHeaders")),Ui(i0,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Dr(qr,this,Afe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Dr(qr,r,Hfe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Dr(qr,this,Nfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),$f()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Dr(qr,r,Dfe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Dr(qr,r,kfe).call(r,...o)}),this.addHook("afterSelection",()=>Dr(qr,this,$fe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ui(ac,this,e),Ui(zm,this,!0),Dr(qr,this,mA).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ui(Ym,this,!0),Dr(qr,this,mA).call(this,"cut")}getRangedCopyableData(e){return nf(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=_F(e);return x(r,o=>{const s=[];x(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Cfe;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Hr(lc,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Hr(ac,this)==="column-headers-only"?n.set("headers",Hr(lc,this).getMostBottomColumnHeadersRange()):(Hr(ac,this)==="with-column-headers"?n.set("headers",Hr(lc,this).getMostBottomColumnHeadersRange()):Hr(ac,this)==="with-column-group-headers"&&n.set("headers",Hr(lc,this).getAllColumnHeadersRange()),n.set("cells",Hr(lc,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:p}=this.hot.getCellMeta(c,a);if(c=p+1,g===!0)continue;d=p,h=a;const C=[],E=o.length%r;for(;C.length<i||h<=u;){const{skipColumnOnPaste:y,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,y===!0)continue;f=T;const _=C.length%i;C.push(e[E][_])}o.push(C)}return Ui(qw,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Hr(zm,this)||this.isEditorOpened()||Xo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Zd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ui(zm,this,!1);const o=this.getRangedData(this.copyableRanges),s=Dr(qr,this,Ife).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=nf(o);if(e&&e.clipboardData){const u=AR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[gA,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Ui(ac,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Hr(Ym,this)||this.isEditorOpened()||Xo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Zd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ui(Ym,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=nf(o);if(e&&e.clipboardData){const l=AR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[gA,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Xo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Zd(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Wv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=y$(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Gie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function mA(t){if($f()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&zk(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Ife(t){const{rows:e}=_F(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Ofe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&jE(r)}}}function PF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&UE(r)}}}function Afe(t){t.items.push({name:"---------"},gfe(this)),Hr(n0,this)&&t.items.push(wfe(this)),Hr(r0,this)&&t.items.push(pfe(this)),Hr(i0,this)&&t.items.push(mfe(this)),t.items.push(vfe(this))}function Hfe(t,e,n,r,i){Hr(qw,this)&&(i.value=!0),Ui(qw,this,!1)}function Nfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Dfe(){Dr(qr,this,PF).call(this)}function kfe(){Dr(qr,this,Ofe).call(this)}function $fe(){Dr(qr,this,PF).call(this)}function IF(t,e){return`border_row${t}col${e}`}function Yd(){return{width:1,color:"#000"}}function Fs(){return{hide:!0}}function Lfe(){return{width:1,color:"#000",cornerVisible:!1}}function Nb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function yd(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Db(t,e){return{id:IF(t,e),border:Lfe(),row:t,col:e,top:Fs(),bottom:Fs(),start:Fs(),end:Fs()}}function Ffe(t,e){return cn(e,"border")&&e.border&&(t.border=e.border),cn(e,"top")&&le(e.top)&&(e.top?($e(e.top)||(e.top=Yd()),t.top=e.top):(e.top=Fs(),t.top=e.top)),cn(e,"bottom")&&le(e.bottom)&&(e.bottom?($e(e.bottom)||(e.bottom=Yd()),t.bottom=e.bottom):(e.bottom=Fs(),t.bottom=e.bottom)),cn(e,"start")&&le(e.start)&&(e.start?($e(e.start)||(e.start=Yd()),t.start=e.start):(e.start=Fs(),t.start=e.start)),cn(e,"end")&&le(e.end)&&(e.end?($e(e.end)||(e.end=Yd()),t.end=e.end):(e.end=Fs(),t.end=e.end)),t}function Ks(t,e){let n=!1;return x(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!cn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Sy(t){return`<span class="selected">✓</span>${t}`}function Vfe(t){return t.some(e=>le(e.left)||le(e.right))}function Bfe(t){return t.some(e=>le(e.start)||le(e.end))}const Wfe=new Map([["left","start"],["right","end"]]);function jfe(t){var e;return(e=Wfe.get(t))!==null&&e!==void 0?e:t}function Ufe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(cM);return Ks(this,"bottom")&&(e=Sy(e)),e},callback(e,n){const r=Ks(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function zfe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(hM);return Ks(this,e)&&(n=Sy(n)),n},callback(n,r){const i=Ks(this,e);t.prepareBorder(r,e,i)}}}function Yfe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(dM)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Ks(this)}}}function Gfe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(uM);return Ks(this,e)&&(n=Sy(n)),n},callback(n,r){const i=Ks(this,e);t.prepareBorder(r,e,i)}}}function Kfe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(lM);return Ks(this,"top")&&(e=Sy(e)),e},callback(e,n){const r=Ks(this,"top");t.prepareBorder(n,"top",r)}}}function qfe(t,e){Xfe(t,e),e.add(t)}function Xfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jfe(t,e,n){return(e=Zfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zfe(t){var e=Qfe(t,"string");return typeof e=="symbol"?e:e+""}function Qfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jp="customBorders",ege=90;var kb=new WeakSet;class tge extends tt{constructor(){super(...arguments),qfe(this,kb),Jfe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Jp}static get PLUGIN_PRIORITY(){return ege}isEnabled(){return!!this.hot.getSettings()[Jp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>pA(kb,this,nge).call(this,e)),this.addHook("init",()=>pA(kb,this,rge).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Nb(n));const o=ih(e),s=Vf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});x(e,a=>{s(a).forAll((l,u)=>{x(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,jfe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=ih(e),r=Vf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return x(e,o=>{r(o).forAll((s,a)=>{x(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(yd(l))})})}),i}clearBorders(e){e?this.setBorders(e):(x(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Db(e,n);r&&(a=Ffe(a,r),x(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",yd(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);ge(e.from.row,r,o=>{ge(e.from.col,i,s=>{const a=Db(o,s);let l=0;o===e.from.row&&cn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&cn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&cn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&cn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",yd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=IF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Db(e,n):o=Nb(o),i?(o[r]=Fs(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",yd(o)))):(o[r]=Yd(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",yd(o)))}prepareBorder(e,n,r){x(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":ge(o.col,s.col,a=>{ge(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":ge(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":ge(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":ge(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":ge(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){x(e,n=>{const r=Nb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Mn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Xe(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){x(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){x(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Xe(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):x(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return x(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return x(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):x(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);x(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Jp];if(Array.isArray(e)){const n=rr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Vfe(e),r=Bfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function nge(t){this.hot.getSettings()[Jp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(aM)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Kfe(this),Gfe(this),Ufe(this),zfe(this),Yfe(this)]}})}function rge(){this.changeBorderSettings()}function ige(t,e){oge(t,e),e.add(t)}function oge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $b(t,e,n){return(e=sge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sge(t){var e=age(t,"string");return typeof e=="symbol"?e:e+""}function age(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vA="dragToScroll",lge=100;var Lb=new WeakSet;class uge extends tt{constructor(){super(...arguments),ige(this,Lb),$b(this,"boundaries",null),$b(this,"callback",null),$b(this,"listening",!1)}static get PLUGIN_KEY(){return vA}static get PLUGIN_PRIORITY(){return lge}isEnabled(){return!!this.hot.getSettings()[vA]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>wA(Lb,this,yA).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>wA(Lb,this,yA).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=fu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function yA(t){if(qa(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function cge(t,e){OF(t,e),e.add(t)}function hge(t,e,n){OF(t,e),e.set(t,n)}function OF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fb(t,e,n){return(e=dge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dge(t){var e=fge(t,"string");return typeof e=="symbol"?e:e+""}function fge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gge(t,e){return t.get(vi(t,e))}function AF(t,e,n){return t.set(vi(t,e),n),n}function vi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterDropdownMenuDefaultOptions");oe.getSingleton().register("beforeDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuHide");oe.getSingleton().register("afterDropdownMenuExecute");const Zp="dropdownMenu",mge=230,jf="changeType",Vb=Zp;var Ry=new WeakMap,Gi=new WeakSet;class Ey extends tt{static get PLUGIN_KEY(){return Zp}static get PLUGIN_PRIORITY(){return mge}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ig,Og,Ve,Hg,Ve,gy,Ve,Ag,Ve,wi]}constructor(e){super(e),cge(this,Gi),Fb(this,"commandExecutor",new yF(this.hot)),Fb(this,"itemsFactory",null),Fb(this,"menu",null),hge(this,Ry,!1),this.hot.addHook("afterGetColHeader",(n,r)=>vi(Gi,this,wge).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Zp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new CF(this.hot,Ey.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return vi(Gi,e,Rge).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return vi(Gi,e,Sge).call(e,...o)});const n=this.hot.getSettings()[Zp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Mh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>vi(Gi,this,vge).call(this)),this.menu.addLocalHook("afterOpen",()=>vi(Gi,this,yge).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>vi(Gi,this,Cge).call(this,o)),this.menu.addLocalHook("afterClose",()=>vi(Gi,this,bge).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),x(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=fy(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${jf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Vb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Vb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Vb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>vi(Gi,this,pge).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Le(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function HF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function pge(t){if(Ce(t.target,jf)){const e=fy(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),AF(Ry,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function wge(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${jf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=jf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Re(s,[Ou(),Af(" ")]),Re(e,[Pk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function vge(){this.hot.runHooks("beforeDropdownMenuShow",this)}function yge(){this.hot.runHooks("afterDropdownMenuShow",this),vi(Gi,this,HF).call(this,this.menu)}function Cge(t){vi(Gi,this,HF).call(this,t)}function bge(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Sge(t){return gge(Ry,this)?null:t}function Rge(t){Ce(t.target,jf)&&AF(Ry,this,!0)}Ey.SEPARATOR={name:Ve};function CA(t,e,n){return(e=Ege(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ege(t){var e=Tge(t,"string");return typeof e=="symbol"?e:e+""}function Tge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mge{constructor(e){CA(this,"hot",void 0),CA(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return ge(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(ge(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();ge(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();ge(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function bA(t,e,n){return(e=_ge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ge(t){var e=xge(t,"string");return typeof e=="symbol"?e:e+""}function xge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){bA(this,"dataProvider",void 0),bA(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=uo(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=fn(uo(T_.DEFAULT_OPTIONS),n),n=fn(n,e),n.filename=AE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function Pge(t,e){Ige(t,e),e.add(t)}function Ige(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const NF="\r",Oge='"',Age=`
`,Hge="=",Nge="+",Dge="-",kge="@",$ge="	";var Bb=new WeakSet;class Lge extends T_{constructor(){super(...arguments),Pge(this,Bb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Xe(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),x(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=It(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=SA(Bb,this,Vge).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=SA(Bb,this,Fge).call(this,i)),(n||i.indexOf(NF)>=0||i.indexOf(Oge)>=0||i.indexOf(Age)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Fge(t){return t.startsWith(Hge)||t.startsWith(Nge)||t.startsWith(Dge)||t.startsWith(kge)||t.startsWith($ge)||t.startsWith(NF)?`'${t}`:t}function Vge(t,e){return e.test(t)?`'${t}`:t}const Bge="csv",o0={[Bge]:Lge};function Wge(t,e,n){return typeof o0[t]=="function"?new o0[t](e,n):null}const jge="exportFile",Uge=240;class zge extends tt{static get PLUGIN_KEY(){return jge}static get PLUGIN_PRIORITY(){return Uge}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!o0[e])throw new Error(`Export format type "${e}" is not supported.`);return Wge(e,new Mge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function uc(t,e,n){return(e=Yge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yge(t){var e=Gge(t,"string");return typeof e=="symbol"?e:e+""}function Gge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ng{constructor(e,n){let{id:r,stateless:i=!0}=n;uc(this,"hot",void 0),uc(this,"id",void 0),uc(this,"elements",[]),uc(this,"hidden",!1),uc(this,"stateId",""),uc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new ry)}getElements(){return this.elements}reset(){x(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),x(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}yt(Ng,jn);const Uf={};function Xa(t,e){if(!Uf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Uf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function nu(t){if(!Uf[t])throw Error(`Filter condition "${t}" does not exist.`);return Uf[t].descriptor}function pn(t,e,n){n.key=t,Uf[t]={condition:e,descriptor:n}}const Dn="none";function Kge(){return!0}pn(Dn,Kge,{name:iy,inputsCount:0,showOperators:!1});const sf="empty";function qge(t){return Jt(t.value)}pn(sf,qge,{name:yM,inputsCount:0,showOperators:!0});const Qp="not_empty";function Xge(t,e){return!Xa(sf,e)(t)}pn(Qp,Xge,{name:CM,inputsCount:0,showOperators:!0});const af="eq";function Jge(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale)===It(n)}pn(af,Jge,{name:bM,inputsCount:1,showOperators:!0});const ew="neq";function Zge(t,e){return!Xa(af,e)(t)}pn(ew,Zge,{name:SM,inputsCount:1,showOperators:!0});const DF="gt";function Qge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}pn(DF,Qge,{name:_M,inputsCount:1,showOperators:!0});const kF="gte";function eme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}pn(kF,eme,{name:xM,inputsCount:1,showOperators:!0});const $F="lt";function tme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}pn($F,tme,{name:PM,inputsCount:1,showOperators:!0});const LF="lte";function nme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}pn(LF,nme,{name:IM,inputsCount:1,showOperators:!0});const M_="date_after";function rme(t,e){let[n]=e;const r=Q(t.value,t.meta.dateFormat),i=Q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}pn(M_,rme,{name:HM,inputsCount:1,showOperators:!0});const __="date_before";function ime(t,e){let[n]=e;const r=Q(t.value,t.meta.dateFormat),i=Q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}pn(__,ime,{name:NM,inputsCount:1,showOperators:!0});const Xw="between";function ome(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Xa(__,[o]),a=Xa(M_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}pn(Xw,ome,{name:OM,inputsCount:2,showOperators:!0});const FF="not_between";function sme(t,e){return!Xa(Xw,e)(t)}pn(FF,sme,{name:AM,inputsCount:2,showOperators:!0});const VF="begins_with";function ame(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).startsWith(It(n))}pn(VF,ame,{name:RM,inputsCount:1,showOperators:!0});const BF="ends_with";function lme(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).endsWith(It(n))}pn(BF,lme,{name:EM,inputsCount:1,showOperators:!0});const x_="contains";function ume(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).indexOf(It(n))>=0}pn(x_,ume,{name:TM,inputsCount:1,showOperators:!0});const WF="not_contains";function cme(t,e){return!Xa(x_,e)(t)}pn(WF,cme,{name:MM,inputsCount:1,showOperators:!0});const jF="date_tomorrow";function hme(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(-1,"days").startOf("day"),"d"):!1}pn(jF,hme,{name:kM,inputsCount:0});const UF="date_today";function dme(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().startOf("day"),"d"):!1}pn(UF,dme,{name:DM,inputsCount:0});const zF="date_yesterday";function fme(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(1,"days").startOf("day"),"d"):!1}pn(zF,fme,{name:$M,inputsCount:0});t$();function gme(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Dg(t){const e=new Set(t);return function(n){return e.has(n)}}function P_(t){return t??""}function s0(t){return Array.from(new Set(t)).map(e=>P_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function RA(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Dg(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:gme(a,n)};r&&r(u),i.push(u)}),i}const ru="by_value";function mme(t,e){let[n]=e;return n(t.value)}pn(ru,mme,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Dg(e)]},showOperators:!1});const zf={};function pme(t){if(!zf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=zf[t].func;return function(n,r){return e(n,r)}}function wme(t){return zf[t].name}function I_(t,e,n){zf[t]={name:e,func:n}}const Ua="conjunction",vme=VM;function yme(t,e){return t.every(n=>n.func(e))}I_(Ua,vme,yme);const Jw="disjunction",Cme=oy;function bme(t,e){return t.some(n=>n.func(e))}I_(Jw,Cme,bme);const O_="disjunctionWithExtraCondition",Sme=oy;function Rme(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}I_(O_,Sme,Rme);const Eme="numeric",YF="text",Tme="date",EA={[Eme]:[Dn,Ve,sf,Qp,Ve,af,ew,Ve,DF,kF,$F,LF,Xw,FF],[YF]:[Dn,Ve,sf,Qp,Ve,af,ew,Ve,VF,BF,Ve,x_,WF],[Tme]:[Dn,Ve,sf,Qp,Ve,af,ew,Ve,__,M_,Xw,Ve,jF,UF,zF]};function Mme(t){const e=[];let n=t;return EA[n]||(n=YF),x(EA[n],r=>{let i;r===Ve?i={name:Ve}:i=uo(nu(r)),e.push(i)}),e}function Cd(t,e,n){return(e=_me(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _me(t){var e=xme(t,"string");return typeof e=="symbol"?e:e+""}function xme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Wb="built",jb="building",TA=["click","input","keydown","keypress","keyup","focus","blur","change"];let so=class GF{static get DEFAULTS(){return uo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Cd(this,"hot",void 0),Cd(this,"eventManager",new _i(this)),Cd(this,"options",void 0),Cd(this,"_element",void 0),Cd(this,"buildState",void 0),this.hot=e,this.options=fn(GF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===jb?this._element:this.buildState===Wb?(this.update(),this._element):(this.buildState=jb,this.build(),this.buildState=Wb,this._element)}isBuilt(){return this.buildState===Wb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(yr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=jb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&X(this._element,this.options.className),this.options.children.length)x(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Le(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),x(TA,r=>e(n,r))}else x(TA,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};yt(so,jn);function Pme(t,e){KF(t,e),e.add(t)}function Ime(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gm(t,e){return t.get(A_(t,e))}function Ome(t,e,n){return t.set(A_(t,e),n),n}function A_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cc=new WeakMap,MA=new WeakSet;class za extends so{static get DEFAULTS(){return uo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,fn(za.DEFAULTS,n)),Pme(this,MA),Ime(this,cc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>A_(MA,this,Ame).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Ome(cc,this,this._element.firstChild),X(this._element,"htUIInput"),X(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Gm(cc,this).type=this.options.type,Gm(cc,this).placeholder=this.translateIfPossible(this.options.placeholder),Gm(cc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Gm(cc,this).focus()}}function Ame(t){this.options.value=t.target.value}function Hme(t,e){qF(t,e),e.add(t)}function bd(t,e,n){qF(t,e),e.set(t,n)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hc(t,e,n){return t.set(lf(t,e),n),n}function Ut(t,e){return t.get(lf(t,e))}function lf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _n=new WeakMap,Km=new WeakMap,qm=new WeakMap,Ub=new WeakMap,Xm=new WeakMap,Jm=new WeakSet;class Yf extends so{static get DEFAULTS(){return uo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,fn(Yf.DEFAULTS,n)),Hme(this,Jm),bd(this,_n,null),bd(this,Km,[]),bd(this,qm,void 0),bd(this,Ub,void 0),bd(this,Xm,void 0),this.registerHooks()}getMenu(){return Ut(_n,this)}registerHooks(){this.addLocalHook("click",()=>lf(Jm,this,kme).call(this))}setItems(e){hc(Km,this,this.translateNames(e)),Ut(_n,this)&&Ut(_n,this).setMenuItems(Ut(Km,this))}translateNames(e){return x(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),hc(_n,this,new Mh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ut(_n,this).setMenuItems(Ut(Km,this));const e=new so(this.hot,{className:"htUISelectCaption"}),n=new so(this.hot,{className:"htUISelectDropdown"});hc(qm,this,e),hc(Ub,this,e.element),hc(Xm,this,n),this.hot.getSettings().ariaTags&&(Re(n.element,[Ou()]),Re(this._element,[xk()])),x([e,n],r=>this._element.appendChild(r.element)),Ut(_n,this).addLocalHook("select",r=>lf(Jm,this,Nme).call(this,r)),Ut(_n,this).addLocalHook("afterClose",()=>lf(Jm,this,Dme).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ut(_n,this).hot.getTranslatedPhrase(iy),Ut(Ub,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ut(_n,this)&&(Ut(_n,this).open(),Ut(_n,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ut(_n,this).getNavigator().toFirstItem(),Ut(_n,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ut(_n,this)&&Ut(_n,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ut(_n,this)&&(Ut(_n,this).destroy(),hc(_n,this,null)),Ut(qm,this)&&Ut(qm,this).destroy(),Ut(Xm,this)&&Ut(Xm,this).destroy(),super.destroy()}}function Nme(t){t.name!==Ve&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Dme(){this.runLocalHooks("afterClose")}function kme(){this.openOptions()}function $me(t,e){Lme(t,e),e.add(t)}function Lme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _A(t,e,n){return(e=Fme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fme(t){var e=Vme(t,"string");return typeof e=="symbol"?e:e+""}function Vme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zb=new WeakSet;class a0 extends Ng{constructor(e,n){super(e,{id:n.id,stateless:!1}),$me(this,zb),_A(this,"name",""),_A(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Yf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new za(this.hot,{placeholder:YM})),this.elements.push(new za(this.hot,{placeholder:GM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>xA(zb,this,Bme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),x(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>xA(zb,this,Wme).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=uo(e.command);n.name.startsWith(Zt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),x(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||nu(Dn),n=[];return x(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=nu(e?e.name:Dn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||x(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Yf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof za)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&X(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||x(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[nu(Dn)];if(e!==null){const{visualIndex:r}=e;n=Mme(this.hot.getDataType(0,r,this.hot.countRows(),r))}x(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Bme(t){x(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Wme(t){bh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Hi(t))}function PA(t,e,n){jme(t,e),e.set(t,n)}function jme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sd(t,e){return t.get(XF(t,e))}function IA(t,e,n){return t.set(XF(t,e),n),n}function XF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dc=new WeakMap,Yb=new WeakMap;class Zw extends so{static get DEFAULTS(){return uo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,fn(Zw.DEFAULTS,n)),PA(this,dc,void 0),PA(this,Yb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),IA(Yb,this,e),IA(dc,this,this._element.firstChild),Sd(dc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Sd(Yb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Sd(dc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Sd(dc,this).checked=e)}focus(){this.isBuilt()&&Sd(dc,this).focus()}}function Ume(t,e){zme(t,e),e.add(t)}function zme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yme(t,e,n){return(e=Gme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gme(t){var e=Kme(t,"string");return typeof e=="symbol"?e:e+""}function Kme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OA=0;var AA=new WeakSet;class Xme extends Ng{constructor(e,n){super(e,{id:n.id,stateless:!1}),Ume(this,AA),Yme(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuOperators"),x(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Ua,Jw];x(e,n=>{const r=new Zw(this.hot,{name:"operator",label:{htmlFor:n,textContent:wme(n)},value:n,checked:n===e[OA],id:n});r.addLocalHook("change",i=>qme(AA,this,Jme).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(mt`Radio button with index ${e} doesn't exist.`);x(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Zw&&n.isChecked());return e?e.getValue():Ua}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&x(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ua,n=arguments.length>1?arguments[1]:void 0,r=e;r===O_&&(r=Jw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(OA)}}function Jme(t){this.setState(t.target.value)}function Zme(t,e,n){Qme(t,e),e.set(t,n)}function Qme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gb(t,e){return t.get(JF(t,e))}function epe(t,e,n){return t.set(JF(t,e),n),n}function JF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rd=new WeakMap;class Gf extends so{static get DEFAULTS(){return uo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,fn(Gf.DEFAULTS,n)),Zme(this,Rd,void 0)}build(){super.build(),epe(Rd,this,this._element.firstChild)}update(){this.isBuilt()&&(Gb(Rd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Gb(Rd,this).focus()}activate(){Gb(Rd,this).click()}}function tpe(t,e){ZF(t,e),e.add(t)}function fc(t,e,n){ZF(t,e),e.set(t,n)}function ZF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get($c(t,e))}function Vi(t,e,n){return t.set($c(t,e),n),n}function $c(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const HA="multipleSelect.itemBox";var Ki=new WeakMap,tn=new WeakMap,Kb=new WeakMap,Cs=new WeakMap,da=new WeakMap,fa=new WeakMap,Ed=new WeakSet;class Kf extends so{static get DEFAULTS(){return uo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,fn(Kf.DEFAULTS,n)),tpe(this,Ed),fc(this,Ki,[]),fc(this,tn,void 0),fc(this,Kb,void 0),fc(this,Cs,void 0),fc(this,da,void 0),fc(this,fa,void 0),Vi(Cs,this,new za(this.hot,{placeholder:zM,className:"htUIMultipleSelectSearch"})),Vi(da,this,new Gf(this.hot,{textContent:BM,className:"htUISelectAll"})),Vi(fa,this,new Gf(this.hot,{textContent:WM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ie(tn,this)}registerHooks(){Ie(Cs,this).addLocalHook("keydown",e=>$c(Ed,this,rpe).call(this,e)),Ie(Cs,this).addLocalHook("input",e=>$c(Ed,this,npe).call(this,e)),Ie(da,this).addLocalHook("click",e=>$c(Ed,this,ipe).call(this,e)),Ie(fa,this).addLocalHook("click",e=>$c(Ed,this,ope).call(this,e))}setItems(e){var n;Vi(Ki,this,e),(n=Ie(tn,this))===null||n===void 0||n.loadData(Ie(Ki,this))}setLocale(e){Vi(Kb,this,e)}getLocale(){return Ie(Kb,this)}getItems(){return[...Ie(Ki,this)]}getValue(){return ape(Ie(Ki,this))}getSearchInputElement(){return Ie(Cs,this)}getSelectAllElement(){return Ie(da,this)}getClearAllElement(){return Ie(fa,this)}isSelectedAllValues(){return Ie(Ki,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new so(this.hot,{className:"htUISelectionControls",children:[Ie(da,this),Ie(fa,this)]});this._element.appendChild(Ie(Cs,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Ie(tn,this))===null||s===void 0||s.destroy(),X(o,"htUIMultipleSelectHot"),Vi(tn,this,new this.hot.constructor(o,{data:Ie(Ki,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ie(tn,this).listen()},modifyColWidth:u=>{const c=Ie(tn,this).container.scrollWidth-On(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ie(tn,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Ie(tn,this).useTheme(u)});const l=Ie(tn,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:HA}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Ie(tn,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:HA})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ie(tn,this).listen()}reset(){Ie(Cs,this).reset(),Ie(da,this).reset(),Ie(fa,this).reset()}update(){this.isBuilt()&&(Ie(tn,this).loadData(spe(Ie(Ki,this),this.options.value)),super.update())}destroy(){var e;(e=Ie(tn,this))===null||e===void 0||e.destroy(),Ie(Cs,this).destroy(),Ie(fa,this).destroy(),Ie(da,this).destroy(),Vi(Cs,this,null),Vi(fa,this,null),Vi(da,this,null),Vi(tn,this,null),Vi(Ki,this,null),super.destroy()}}function npe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ie(Ki,this)]:n=Ie(Ki,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ie(tn,this).loadData(n)}function rpe(t){this.runLocalHooks("keydown",t,this),zE(bh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Hi(t),Ie(tn,this).listen(),Ie(tn,this).selectCell(0,0))}function ipe(t){const e=[];t.preventDefault(),Ie(tn,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(ST(n,r)[0])}),Ie(tn,this).setSourceDataAtCell(e)}function ope(t){const e=[];t.preventDefault(),Ie(tn,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(ST(n,r)[0])}),Ie(tn,this).setSourceDataAtCell(e)}function spe(t,e){const n=Dg(e);return t.map(r=>(r.checked=n(r.value),r))}function ape(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function lpe(t,e){upe(t,e),e.add(t)}function upe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cpe(t,e,n){return(e=hpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hpe(t){var e=dpe(t,"string");return typeof e=="symbol"?e:e+""}function dpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Td=new WeakSet;class fpe extends Ng{constructor(e,n){super(e,{id:n.id,stateless:!1}),lpe(this,Td),cpe(this,"name",""),this.name=n.name,this.elements.push(new Kf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Zm(Td,this,gpe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Zm(Td,this,mpe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ru){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Dn:ru},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Ya(i,h=>h.name===ru),u={},c=this.hot.getTranslatedPhrase(kw);if(l){const h=s(r,a),d=Xe(h,y=>y.value),f=new Map(h.map(y=>[y.value,this.hot.getCellMeta(y.meta.visualRow,y.meta.visualCol)])),g=s0(d);o&&(l.args[0]=o);const p=[],C=RA(g,l.args[0],c,y=>{y.checked&&p.push(y.value),Zm(Td,this,NA).call(this,y,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[p],u.command=nu(ru),u.itemsSnapshot=C}else u.args=[],u.command=nu(Dn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Kf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{X(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||x(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(kw),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=s0(r),s=RA(o,o,e,l=>{Zm(Td,this,NA).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Xe(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:P_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function gpe(t){bh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Hi(t))}function NA(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function mpe(t,e){switch(e.type){case"numeric":return VL(t,e);default:return t}}var QF;function ppe(t,e){wpe(t,e),e.add(t)}function wpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vpe(t,e,n){return(e=ype(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ype(t){var e=Cpe(t,"string");return typeof e=="symbol"?e:e+""}function Cpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bpe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var DA=new WeakSet;class qf extends Ng{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),ppe(this,DA),vpe(this,"name",""),this.name=n.name,this.elements.push(new za(this.hot,{type:"button",value:jM,className:"htUIButton htUIButtonOK",identifier:qf.BUTTON_OK})),this.elements.push(new za(this.hot,{type:"button",value:UM,className:"htUIButton htUIButtonCancel",identifier:qf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){x(this.elements,e=>{e.addLocalHook("click",(n,r)=>bpe(DA,this,Spe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuActionBar"),x(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}QF=qf;function Spe(t,e){e.options.identifier===QF.BUTTON_OK?this.accept():this.cancel()}function qb(t,e,n){return(e=Rpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rpe(t){var e=Epe(t,"string");return typeof e=="symbol"?e:e+""}function Epe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const kA="ConditionCollection.filteringStates";class H_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;qb(this,"hot",void 0),qb(this,"isMapRegistrable",void 0),qb(this,"filteringStates",new ry),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(kA,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ua;return e.length?pme(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ua,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(mt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Lt(zf[r]))throw new Error(mt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Xa(a,s)}]},i):u.push({name:a,args:s,func:Xa(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(kA),this.filteringStates=null,this.clearLocalHooks()}}yt(H_,jn);function $A(t,e,n){return(e=Tpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tpe(t){var e=Mpe(t,"string");return typeof e=="symbol"?e:e+""}function Mpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];$A(this,"conditionCollection",void 0),$A(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return x(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return x(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return x(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function _pe(t,e){xpe(t,e),e.add(t)}function xpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e,n){return(e=Ppe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ppe(t){var e=Ipe(t,"string");return typeof e=="symbol"?e:e+""}function Ipe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qm=new WeakSet;class tV{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];_pe(this,Qm),_l(this,"hot",void 0),_l(this,"conditionCollection",void 0),_l(this,"columnDataFactory",void 0),_l(this,"changes",[]),_l(this,"grouping",!1),_l(this,"latestEditedColumnPosition",-1),_l(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Xb(Qm,this,Ope).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Xb(Qm,this,Ape).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Xb(Qm,this,Hpe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,x(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=Gk(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new H_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const p=r.columnDataFactory(h);let C;f.isEmpty()?C=p:C=new eV(f,y=>r.columnDataFactory(y)).filter(),C=Xe(C,y=>y.meta.visualRow);const E=Dg(C);return f.destroy(),Ya(p,y=>E(y.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Le(this,(e,n)=>{this[n]=null})}}function Ope(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Ape(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Hpe(){x(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}yt(tV,jn);function Npe(t){return SF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Kf)return r;if(i.element&&!gu(i.element))return!1;i.focus()}})}const Md="filters";function Dpe(t,e){let n=-1,r;const i=Npe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Md),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof so&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Md),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Md)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const p=r.getNavigator();p.getCurrentPage()>-1&&(n=p.getCurrentPage()),p.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const p=e[i.getCurrentPage()];p instanceof Yf&&(p.openOptions(),g.preventDefault()),p instanceof Gf&&(p.activate(),g.preventDefault()),p instanceof so||g.preventDefault()}}],Md)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Md)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function kpe(t,e){nV(t,e),e.add(t)}function Jb(t,e,n){nV(t,e),e.set(t,n)}function nV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _d(t,e,n){return(e=$pe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $pe(t){var e=Lpe(t,"string");return typeof e=="symbol"?e:e+""}function Lpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tw(t,e,n){return t.set(Pr(t,e),n),n}function yi(t,e){return t.get(Pr(t,e))}function Pr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const l0="filters",Fpe=250,LA=l0;var Ms=new WeakMap,u0=new WeakMap,Zl=new WeakMap,Wr=new WeakSet;class Vpe extends tt{static get PLUGIN_KEY(){return l0}static get PLUGIN_PRIORITY(){return Fpe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,kpe(this,Wr),_d(this,"dropdownMenuPlugin",null),_d(this,"conditionCollection",null),_d(this,"conditionUpdateObserver",null),_d(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),_d(this,"filtersRowsMap",null),Jb(this,Ms,void 0),Jb(this,u0,new WeakSet),Jb(this,Zl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Pr(Wr,n,Gpe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[l0]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Tg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>Pr(Wr,this,FA).call(this,"accept")),a.addLocalHook("cancel",()=>Pr(Wr,this,FA).call(this,"cancel")),a.addLocalHook("change",l=>Pr(Wr,this,Ype).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(LM)}:`,s=()=>`${this.hot.getTranslatedPhrase(FM)}:`;if(!this.components.get("filter_by_condition")){const a=new a0(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Pr(Wr,this,VA).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Xme(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new a0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Pr(Wr,this,VA).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new fpe(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new qf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new H_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new tV(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Pr(Wr,this,Kpe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Pr(Wr,e,zpe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Pr(Wr,this,Upe).call(this)),this.addHook("afterDropdownMenuShow",()=>Pr(Wr,this,Wpe).call(this)),this.addHook("afterDropdownMenuHide",()=>Pr(Wr,this,jpe).call(this)),this.addHook("afterChange",a=>Pr(Wr,this,Bpe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!yi(Ms,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=yi(Ms,this).getMenu(),c=u.getNavigator(),h=yi(Ms,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];tw(Ms,this,Dpe(this.dropdownMenuPlugin.menu,a));const l=u=>{yi(Ms,this).listen(),u.preventDefault(),bh(u.keyCode,"TAB")&&(u.shiftKey?yi(Ms,this).toPreviousItem():yi(Ms,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:LA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(LA)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ua;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,yi(Zl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Xe(n.filter(),u=>u.meta.visualRow);const l=Dg(i);ge(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),x(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),tw(Zl,this,this.exportConditions())}else s!==!1&&!r?(tw(Zl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(yi(Zl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return x(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),p=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:P_(p)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=s0(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Jw&&n.command.key!==Dn&&r.command.key!==Dn&&i.command.key!==Dn?o=O_:i.command.key!==Dn&&(n.command.key===Dn||r.command.key===Dn)&&(o=Ua),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new eV(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return x(i,s=>{x(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Bpe(t){t&&x(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Wpe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function jpe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Upe(){const t=this.dropdownMenuPlugin.menu;yi(u0,this).has(t)||yi(Ms,this).setMenu(t),yi(u0,this).add(t)}function zpe(t){t.items.push({name:Ve}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function FA(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==Dn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==Dn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Dn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Ype(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===a0&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function VA(){this.setListeningDropdownMenu()}function Gpe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?X(e,"htFiltersActive"):ve(e,"htFiltersActive")}function Kpe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&tw(Zl,this,yi(Zl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===ru),s=n.filter(a=>a.name!==ru);if(o.length>=2||s.length>=3)at(mt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const rV="internal-use-in-handsontable",c0={licenseKey:rV,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function iV(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Zn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function oV(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function qpe(t){var e;const n=t[Zn],r=oV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=iV(t);return{...c0,...r,...i}}function Xpe(t){var e;const n=t[Zn],r=oV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=iV(t);return{...r,...i}}function Jpe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Ty(){const t="engine_relationship",e=fo(Zn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function N_(){const t="shared_engine_usage",e=fo(Zn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Zpe(t){const e=t.getSettings(),n=e[Zn],r=n==null?void 0:n.engine;if(n===!0||Lt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Qpe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Lt(r.hyperformula)){const o=Ty(),s=N_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:rV}),(r.getConfig().leapYear1900!==c0.leapYear1900||Kv(r.getConfig().nullDate,c0.nullDate)===!1)&&at(mt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Qpe(t,e,n){const r=e[Zn],i=qpe(e),o=Ty(),s=N_();ewe(t,r.functions),twe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),nwe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function BA(t){var e;const n=Ty(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function WA(t,e){if(t){const n=Ty(),r=n.get(t),i=N_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function ewe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){at(s.message)}})}function twe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){at(r.message)}}}function nwe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){at(a.message)}}),t.resumeEvaluation())}function rwe(t,e){return(Lt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const sV="DD/MM/YYYY";function iwe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function owe(t){return iwe(t)?t.substr(1):t}function swe(t){return typeof t=="string"&&t.startsWith("=")}function D_(t,e){return typeof t=="string"&&e==="date"}function aV(t,e){return Q(t,e,!0).isValid()}function lV(t,e){return Q(t,e,!0).format(sV)}function awe(t,e){return Q(t,sV,!0).format(e)}function uV(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Q(r).format(e)}function lwe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function uwe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function cwe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function k_(t,e,n){const r=uwe(t,lwe(t,e,n));return cwe(r)}function xl(t,e,n){hwe(t,e),e.set(t,n)}function hwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(cV(t,e))}function ga(t,e,n){return t.set(cV(t,e),n),n}function cV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xd=new WeakMap,ma=new WeakMap,jr=new WeakMap,ep=new WeakMap,Zb=new WeakMap,Qb=new WeakMap,tp=new WeakMap;class jA{constructor(e,n,r){xl(this,xd,void 0),xl(this,ma,void 0),xl(this,jr,void 0),xl(this,ep,[]),xl(this,Zb,[]),xl(this,Qb,void 0),xl(this,tp,[]),ga(xd,this,e),ga(ma,this,n),ga(jr,this,r)}setRemovedHfIndexes(e){return ga(tp,this,e.map(n=>{const r=kt(ma,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),kt(tp,this)}getRemovedHfIndexes(){return kt(tp,this)}getHfIndexFromVisualIndex(e){const n=kt(ma,this).getIndexesSequence(),r=kt(ma,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${nr(kt(xd,this))}s`;kt(jr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&kt(jr,this).getEngine()[r](kt(jr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ga(Zb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),ga(Qb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(kt(jr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=k_(kt(Zb,this),kt(Qb,this),kt(ma,this).getNumberOfIndexes());kt(jr,this).getSheetId()===null?kt(jr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${nr(kt(xd,this))}Order`;return n=>{if(kt(jr,this).isPerformingUndoRedo())return;const r=kt(ma,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=kt(ep,this).map(l=>r.indexOf(l)),o=kt(jr,this).getEngine().getSheetDimensions(kt(jr,this).getSheetId());let s;kt(xd,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);kt(jr,this).getEngine()[e](kt(jr,this).getSheetId(),i)}ga(ep,this,r)}}init(){ga(ep,this,kt(ma,this).getIndexesSequence())}}function Pl(t,e,n){dwe(t,e),e.set(t,n)}function dwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bs(t,e){return t.get(hV(t,e))}function Il(t,e,n){return t.set(hV(t,e),n),n}function hV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var np=new WeakMap,rp=new WeakMap,eS=new WeakMap,tS=new WeakMap,nS=new WeakMap,rS=new WeakMap,iS=new WeakMap;class fwe{constructor(e,n,r){Pl(this,np,void 0),Pl(this,rp,void 0),Pl(this,eS,void 0),Pl(this,tS,!1),Pl(this,nS,!1),Pl(this,rS,null),Pl(this,iS,null),Il(np,this,new jA("row",e,this)),Il(rp,this,new jA("column",n,this)),Il(eS,this,r)}getForAxis(e){return e==="row"?bs(np,this):bs(rp,this)}setPerformUndo(e){Il(tS,this,e)}setPerformRedo(e){Il(nS,this,e)}isPerformingUndoRedo(){return bs(tS,this)||bs(nS,this)}getSheetId(){return bs(iS,this)}getEngine(){return bs(rS,this)}getPostponeAction(){return bs(eS,this)}setupSyncEndpoint(e,n){Il(rS,this,e),Il(iS,this,n),bs(np,this).init(),bs(rp,this).init()}}function gwe(t,e){dV(t,e),e.add(t)}function Ol(t,e,n){return(e=mwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mwe(t){var e=pwe(t,"string");return typeof e=="symbol"?e:e+""}function pwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oS(t,e,n){dV(t,e),e.set(t,n)}function dV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ja(t,e,n){return t.set(nt(t,e),n),n}function au(t,e){return t.get(nt(t,e))}function nt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zn="formulas",wwe=["maxRows","maxColumns","language"],vwe=260;oe.getSingleton().register("afterNamedExpressionAdded");oe.getSingleton().register("afterNamedExpressionRemoved");oe.getSingleton().register("afterSheetAdded");oe.getSingleton().register("afterSheetRemoved");oe.getSingleton().register("afterSheetRenamed");oe.getSingleton().register("afterFormulasValuesUpdate");const _h=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var qs=new WeakMap,My=new WeakMap,Pd=new WeakMap,st=new WeakSet;class ywe extends tt{constructor(){var e;super(...arguments),e=this,gwe(this,st),oS(this,qs,!1),oS(this,My,!1),oS(this,Pd,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return nt(st,e,Dwe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return nt(st,e,kwe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return nt(st,e,$we).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return nt(st,e,Lwe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return nt(st,e,Fwe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return nt(st,e,Vwe).call(e,...r)}]]),Ol(this,"staticRegister",fo("formulas")),Ol(this,"engine",null),Ol(this,"sheetId",null),Ol(this,"sheetName",null),Ol(this,"indexSyncer",null),Ol(this,"rowAxisSyncer",null),Ol(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Zn}static get PLUGIN_PRIORITY(){return vwe}static get SETTING_KEYS(){return[Zn,...wwe]}isEnabled(){return!!this.hot.getSettings()[Zn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Zpe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){at("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&nt(st,this,uf).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,UA).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,zA).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,UA).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,zA).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Rwe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Ewe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Cwe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Twe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,YA).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,YA).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Mwe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,_we).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Iwe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Owe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,xwe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Pwe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Awe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Hwe).call(n,...i)}),this.indexSyncer=new fwe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Swe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,Nwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nt(st,n,bwe).call(n,...i)}),au(Pd,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){au(Pd,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),WA(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Xpe(this.hot.getSettings());Jpe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Zn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Zn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());nt(st,this,uf).call(this,o)}}super.updatePlugin(e)}destroy(){au(Pd,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ja(Pd,this,null),WA(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!Y$(n))return at("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return at("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return at(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){JE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}nt(st,this,uf).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${nr(Zn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),BA(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=BA(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){at(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return D_(r,o.type)&&(aV(r,o.dateFormat)?r=lV(r,o.dateFormat):swe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function uf(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function Cwe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Jn(s)&&(s=uV(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function bwe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:p}=h.start,{row:C,col:E}=h.end,y=C-g+1,T=E-p+1;for(let _=0;_<f.length;_+=1)for(let I=0;I<f[_].length;I+=1){const M=f[_][I],P=g+_%y,z=p+I%T,W=this.hot.getCellMeta(P,z);D_(M,W.type)&&(M.startsWith("'")?f[_][I]=M.slice(1):this.isFormulaCellType(P,z,this.sheetId)===!1&&(f[_][I]=awe(M,W.dateFormat)))}return f}function UA(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(nr(Zn))||Ja(My,this,Lt(this.hot.getSettings().data))}function Swe(){if(au(My,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;D_(i,s.type)&&(aV(i,a)?t[r][o]=lV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Ja(qs,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ja(qs,this,!1)}function zA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(nr(Zn)))return;const r=rwe(this.engine,this.hot.getSettings()[Zn].sheetName);if(nt(st,this,uf).call(this,r),n!=="updateSettings")if(au(My,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Ja(qs,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Ja(qs,this,!1)}}}function Rwe(t,e,n,r){if(r!=="get"||au(qs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=owe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Jn(a)&&(a=uV(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function Ewe(t,e,n,r){if(r!=="get"||au(qs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function YA(t,e){if(_h(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Twe(t,e){if(_h(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Jn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){at(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Mwe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function _we(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function xwe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Pwe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Iwe(t,e,n){if(_h(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Owe(t,e,n){if(_h(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Awe(t,e,n,r){if(_h(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Hwe(t,e,n,r){if(_h(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Nwe(t,e,n){var r;Ja(qs,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ja(qs,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Dwe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function kwe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function $we(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Lwe(t){this.hot.runHooks("afterSheetAdded",t)}function Fwe(t,e){nt(st,this,uf).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Vwe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Bwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(mM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Wwe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(pM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Xe(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return x(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function jwe(t,e){fV(t,e),e.add(t)}function Uwe(t,e,n){fV(t,e),e.set(t,n)}function fV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(t,e){return t.get(Ra(t,e))}function GA(t,e,n){return t.set(Ra(t,e),n),n}function Ra(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideColumns");oe.getSingleton().register("afterHideColumns");oe.getSingleton().register("beforeUnhideColumns");oe.getSingleton().register("afterUnhideColumns");const KA="hiddenColumns",zwe=310;var Eo=new WeakMap,Hl=new WeakSet;class Ywe extends tt{constructor(){super(...arguments),jwe(this,Hl),Uwe(this,Eo,null)}static get PLUGIN_KEY(){return KA}static get PLUGIN_PRIORITY(){return zwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[KA]}enablePlugin(){var e=this;this.enabled||(GA(Eo,this,new ny),Al(Eo,this).addLocalHook("init",()=>Ra(Hl,this,Zwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Al(Eo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Hl,e,Jwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Ra(Hl,this,Kwe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Ra(Hl,this,Gwe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Hl,e,Xwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Ra(Hl,this,qwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Al(Eo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));x(l,u=>{o[u]=!1}),i=Mn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Al(Eo,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{Al(Eo,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Xe(Al(Eo,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Al(Eo,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){x(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){GA(Eo,this,null),super.destroy()}}function Gwe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Kwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function qwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return x(t,r=>{let i=!0,o=0;ge(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Xwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),X(e,n)}function Jwe(t){t.items.push({name:Ve},Bwe(this),Wwe(this))}function Zwe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Qwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(wM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function eve(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(vM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Xe(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return x(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function tve(t,e){gV(t,e),e.add(t)}function nve(t,e,n){gV(t,e),e.set(t,n)}function gV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nl(t,e){return t.get(Ea(t,e))}function qA(t,e,n){return t.set(Ea(t,e),n),n}function Ea(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideRows");oe.getSingleton().register("afterHideRows");oe.getSingleton().register("beforeUnhideRows");oe.getSingleton().register("afterUnhideRows");const XA="hiddenRows",rve=320;var To=new WeakMap,Dl=new WeakSet;class ive extends tt{constructor(){super(...arguments),tve(this,Dl),nve(this,To,null)}static get PLUGIN_KEY(){return XA}static get PLUGIN_PRIORITY(){return rve}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[XA]}enablePlugin(){var e=this;this.enabled||(qA(To,this,new ny),Nl(To,this).addLocalHook("init",()=>Ea(Dl,this,cve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Nl(To,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ea(Dl,e,uve).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Ea(Dl,this,sve).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Ea(Dl,this,ove).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ea(Dl,e,lve).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Ea(Dl,this,ave).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Nl(To,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));x(l,u=>{o[u]=!1}),i=Mn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Nl(To,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{Nl(To,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Xe(Nl(To,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Nl(To,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){x(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){qA(To,this,null),super.destroy()}}function ove(t,e){return this.isHidden(e)?0:t}function sve(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function ave(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return x(t,r=>{let i=!0,o=0;ge(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function lve(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),X(e,n)}function uve(t){t.items.push({name:Ve},Qwe(this),eve(this))}function cve(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function hve(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(zT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function dve(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(YT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function fve(t,e){mV(t,e),e.add(t)}function gve(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h0(t,e){return t.get(Qw(t,e))}function sS(t,e,n){return t.set(Qw(t,e),n),n}function Qw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnFreeze");oe.getSingleton().register("afterColumnFreeze");oe.getSingleton().register("beforeColumnUnfreeze");oe.getSingleton().register("afterColumnUnfreeze");const JA="manualColumnFreeze",mve=110;var Kl=new WeakMap,aS=new WeakSet;class pve extends tt{constructor(){super(...arguments),fve(this,aS),gve(this,Kl,!1)}static get PLUGIN_KEY(){return JA}static get PLUGIN_PRIORITY(){return mve}isEnabled(){return!!this.hot.getSettings()[JA]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Qw(aS,this,wve).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Qw(aS,this,vve).call(this,e,n)),super.enablePlugin())}disablePlugin(){sS(Kl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;h0(Kl,this)||sS(Kl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;h0(Kl,this)||sS(Kl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function wve(t){t.items.push({name:"---------"},hve(this),dve(this))}function vve(t,e){if(h0(Kl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function ip(t,e,n){return(e=yve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yve(t){var e=Cve(t,"string");return typeof e=="symbol"?e:e+""}function Cve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lS=0,ZA=1,QA=2,gc="px";let pV=class{constructor(e){ip(this,"hot",void 0),ip(this,"_element",null),ip(this,"state",lS),ip(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=QA}build(){this.state===lS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=ZA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=lS}isAppended(){return this.state===QA}isBuilt(){return this.state>=ZA}setPosition(e,n){Jn(e)&&(this._element.style.top=e+gc),Jn(n)&&(this._element.style[this.inlineProperty]=n+gc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Jn(e)&&(this._element.style.width=e+gc),Jn(n)&&(this._element.style.height=n+gc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Jn(e)&&(this._element.style.marginTop=e+gc),Jn(n)&&(this._element.style[`margin${nr(this.inlineProperty)}`]=n+gc)}getOffset(){const e=this._element.style,n=`margin${nr(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const bve="ht__manualColumnMove--backlight";let Sve=class extends pV{build(){super.build(),X(this._element,bve)}};const Rve="ht__manualColumnMove--guideline";let Eve=class extends pV{build(){super.build(),X(this._element,Rve)}};function Tve(t,e){wV(t,e),e.add(t)}function Bi(t,e,n){wV(t,e),e.set(t,n)}function wV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kr(t,e,n){return t.set(Ta(t,e),n),n}function de(t,e){return t.get(Ta(t,e))}function Ta(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnMove");oe.getSingleton().register("afterColumnMove");const uS="manualColumnMove",Mve=120,e1="ht__manualColumnMove",ev="show-ui",d0="on-moving--columns",f0="after-selection--columns";var fr=new WeakMap,xa=new WeakMap,Vs=new WeakMap,nw=new WeakMap,La=new WeakMap,dr=new WeakMap,op=new WeakMap,mi=new WeakMap,xc=new WeakMap,tv=new WeakMap,cf=new WeakMap,kl=new WeakSet;class _ve extends tt{constructor(){super(...arguments),Tve(this,kl),Bi(this,fr,new Sve(this.hot)),Bi(this,xa,new Eve(this.hot)),Bi(this,Vs,[]),Bi(this,nw,0),Bi(this,La,!1),Bi(this,dr,{}),Bi(this,op,void 0),Bi(this,mi,void 0),Bi(this,xc,void 0),Bi(this,tv,void 0),Bi(this,cf,void 0)}static get PLUGIN_KEY(){return uS}static get PLUGIN_PRIORITY(){return Mve}isEnabled(){return!!this.hot.getSettings()[uS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ta(kl,e,xve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ta(kl,e,Ive).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ta(kl,this,Ave).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ta(kl,e,Hve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,e1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ve(this.hot.rootElement,e1),this.unregisterEvents(),de(fr,this).destroy(),de(xa,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=de(op,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(kr(op,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return kr(op,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Mn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[uS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return ge(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(de(mi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,de(mi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=de(fr,this).getOffset().start,u=de(fr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,p=on(this.hot.rootElement),C=g.innerWidth-de(xc,this)-p;h=g.innerWidth-de(dr,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=de(dr,this).eventPageX-(de(xc,this)-(r.scrollX===void 0?i:0));if(de(tv,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(de(mi,this))&&(o+=i),o+=c,de(mi,this)<0)de(cf,this)>0?de(dr,this).col=0:de(dr,this).col=e>0?e-1:e;else if(de(dr,this).TD.offsetWidth/2+o<=h){const g=de(mi,this)>=de(nw,this)?de(nw,this)-1:de(mi,this);de(dr,this).col=g+1,o+=de(dr,this).TD.offsetWidth}else de(dr,this).col=de(mi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&de(mi,this)<de(cf,this)&&(f-=de(xc,this)<=r.scrollX?de(xc,this):0),de(fr,this).setPosition(null,d),de(xa,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ta(kl,this,Pve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ta(kl,this,Ove).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){de(fr,this).build(),de(xa,this).build()}destroy(){de(fr,this).destroy(),de(xa,this).destroy(),super.destroy()}}function xve(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ce(t.target,"sortAction");if(!s||!o||de(La,this)||t.button!==0||a){kr(La,this,!1),de(Vs,this).length=0,ve(this.hot.rootElement,[d0,ev]);return}const l=de(xa,this).isBuilt()&&!de(xa,this).isAppended(),u=de(fr,this).isBuilt()&&!de(fr,this).isAppended();l&&u&&(de(xa,this).appendTo(i.hider),de(fr,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,kr(La,this,!0);const g=n.firstChild?c$(t,n.firstChild).x:t.offsetX;de(dr,this).eventPageX=t.pageX,kr(mi,this,e.col),de(dr,this).TD=n,de(dr,this).col=e.col,kr(Vs,this,this.prepareColumnsToMoving(d,f)),kr(tv,this,!!this.hot.getSettings().rowHeaders),kr(nw,this,this.hot.countCols()),kr(cf,this,this.hot.getSettings().fixedColumnsStart),kr(xc,this,Wn(this.hot.rootElement).left);const p=de(tv,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<de(cf,this),y=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),_=this.getColumnsWidth(d,e.col-1)+T,I=this.getColumnsWidth(p,d-1)+(E?y:0)+_;de(fr,this).setPosition(C,I),de(fr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),de(fr,this).setOffset(null,-_),X(this.hot.rootElement,d0)}else ve(this.hot.rootElement,f0),kr(La,this,!1),de(Vs,this).length=0}function Pve(t){de(La,this)&&(de(dr,this).eventPageX=t.pageX,this.refreshPositions())}function Ive(t,e,n,r){!this.hot.getSelectedRangeLast()||!de(La,this)||(de(Vs,this).indexOf(e.col)>-1?ve(this.hot.rootElement,ev):X(this.hot.rootElement,ev),r.row=!0,r.column=!0,r.cell=!0,kr(mi,this,e.col),de(dr,this).TD=n)}function Ove(){const t=de(dr,this).col,e=de(Vs,this).length;if(kr(mi,this,void 0),kr(La,this,!1),ve(this.hot.rootElement,[d0,ev,f0]),this.hot.selection.isSelectedByColumnHeader()&&X(this.hot.rootElement,f0),e<1||t===void 0)return;const n=de(Vs,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(de(Vs,this),t);if(de(Vs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Ave(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;de(fr,this).setPosition(r),de(fr,this).setSize(null,t.hider.offsetHeight-r)}function Hve(){this.moveBySettingsOrLoad()}function Nve(t,e){vV(t,e),e.add(t)}function Yn(t,e,n){vV(t,e),e.set(t,n)}function vV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(t,e,n){return t.set(qi(t,e),n),n}function se(t,e){return t.get(qi(t,e))}function qi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nv="manualColumnResize",Dve=130,t1="manualColumnWidths";var Os=new WeakMap,sp=new WeakMap,Jr=new WeakMap,rv=new WeakMap,Uo=new WeakMap,kve=new WeakMap,qc=new WeakMap,ap=new WeakMap,_r=new WeakMap,_s=new WeakMap,yu=new WeakMap,iv=new WeakMap,hf=new WeakMap,df=new WeakMap,Qr=new WeakMap,ff=new WeakMap,Mo=new WeakSet;class $ve extends tt{static get PLUGIN_KEY(){return nv}static get PLUGIN_PRIORITY(){return Dve}constructor(e){super(e),Nve(this,Mo),Yn(this,Os,null),Yn(this,sp,null),Yn(this,Jr,[]),Yn(this,rv,null),Yn(this,Uo,null),Yn(this,kve,null),Yn(this,qc,null),Yn(this,ap,null),Yn(this,_r,this.hot.rootDocument.createElement("DIV")),Yn(this,_s,this.hot.rootDocument.createElement("DIV")),Yn(this,yu,null),Yn(this,iv,!1),Yn(this,hf,0),Yn(this,df,null),Yn(this,Qr,void 0),Yn(this,ff,void 0),X(se(_r,this),"manualColumnResizer"),X(se(_s,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[nv]}enablePlugin(){var e=this;this.enabled||(rn(Qr,this,new el),se(Qr,this).addLocalHook("init",()=>qi(Mo,this,Lve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,se(Qr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qi(Mo,e,Uve).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qi(Mo,e,zve).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qi(Mo,e,Yve).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){rn(ff,this,se(Qr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",t1,se(Qr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",t1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return se(Qr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);se(Qr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;rn(Os,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(se(Os,this)),i=r.col;if(i<0)return;const o=dn(se(Os,this)),s=se(Os,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(Os,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(se(Os,this),r.row,r.col)),rn(sp,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),rn(Jr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();x(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;ge(d,f,g=>{se(Jr,this).includes(g)||se(Jr,this).push(g)})})}se(Jr,this).includes(se(sp,this))||rn(Jr,this,[se(sp,this)]),rn(ap,this,l.start-6),rn(qc,this,parseInt(s.width,10)),se(_r,this).style.top=`${l.top}px`,se(_r,this).style[this.inlineDir]=`${se(ap,this)+se(qc,this)}px`,se(_r,this).style.height=`${o}px`,this.hot.rootElement.appendChild(se(_r,this))}refreshHandlePosition(){se(_r,this).style[this.inlineDir]=`${se(ap,this)+se(rv,this)}px`}setupGuidePosition(){const e=parseInt(dn(se(_r,this)),10),n=parseInt(se(_r,this).style.top,10)+e,r=this.hot.view.getTableHeight();X(se(_r,this),"active"),X(se(_s,this),"active"),se(_s,this).style.top=`${n}px`,this.refreshGuidePosition(),se(_s,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(se(_s,this))}refreshGuidePosition(){se(_s,this).style[this.inlineDir]=se(_r,this).style[this.inlineDir]}hideHandleAndGuide(){ve(se(_r,this),"active"),ve(se(_s,this),"active")}checkIfColumnHeader(e){const n=Ga(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",se(Uo,this),r,!0);o!==void 0&&rn(Uo,this,o),this.setManualSize(r,se(Uo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Uo,this),r,!0),i&&e()};se(hf,this)>=2&&(se(Jr,this).length>1?(x(se(Jr,this),i=>{n(i)}),e()):x(se(Jr,this),i=>{n(i,!0)})),rn(hf,this,0),rn(df,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>qi(Mo,this,Fve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>qi(Mo,this,Vve).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>qi(Mo,this,Bve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>qi(Mo,this,Wve).call(this)),this.eventManager.addEventListener(se(_r,this),"contextmenu",()=>qi(Mo,this,jve).call(this))}destroy(){super.destroy()}}function Lve(){const t=this.hot.getSettings()[nv],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{se(Qr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{se(Qr,this).setValueAtIndex(r,n)})},!0),rn(ff,this,t)):t===!0&&Array.isArray(se(ff,this))&&this.hot.batchExecution(()=>{se(ff,this).forEach((n,r)=>{se(Qr,this).setValueAtIndex(r,n)})},!0)}function Fve(t){if(!WE(t.target)&&se(iv,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(se(yu,this)||this.setupHandlePosition(e))}}function Vve(t){t.target.parentNode===this.hot.rootElement&&Ce(t.target,"manualColumnResizer")&&(this.setupHandlePosition(se(Os,this)),this.setupGuidePosition(),rn(yu,this,!0),se(df,this)===null&&(rn(df,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(df,this))),rn(hf,this,se(hf,this)+1),this.startX=t.pageX,rn(Uo,this,se(qc,this)))}function Bve(t){if(se(yu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();rn(rv,this,se(qc,this)+e),x(se(Jr,this),n=>{rn(Uo,this,this.setManualSize(n,se(rv,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Wve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",se(Uo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Uo,this),n,!1)};se(yu,this)&&(this.hideHandleAndGuide(),rn(yu,this,!1),se(Uo,this)!==se(qc,this)&&(se(Jr,this).length>1?(x(se(Jr,this),r=>{e(r)}),t()):x(se(Jr,this),r=>{e(r,!0)})),this.setupHandlePosition(se(Os,this)))}function jve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(_r,this)),this.hot.rootElement.removeChild(se(_s,this)),rn(yu,this,!1),rn(iv,this,!0),this.hot._registerImmediate(()=>{rn(iv,this,!1)})}function Uve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=se(Qr,this).getValueAtIndex(r);this.hot.getSettings()[nv]&&i&&(n=i)}return n}function zve(t,e){const n=se(Qr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Yve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function cS(t,e,n){return(e=Gve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gve(t){var e=Kve(t,"string");return typeof e=="symbol"?e:e+""}function Kve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hS=0,n1=1,r1=2,mc="px";let yV=class{constructor(e){cS(this,"hot",void 0),cS(this,"_element",null),cS(this,"state",hS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=r1}build(){this.state===hS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=n1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=hS}isAppended(){return this.state===r1}isBuilt(){return this.state>=n1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+mc),n!==void 0&&(this._element.style.left=n+mc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+mc),n&&(this._element.style.height=n+mc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+mc),n&&(this._element.style.marginLeft=n+mc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const qve="ht__manualRowMove--backlight";class Xve extends yV{build(){super.build(),X(this._element,qve)}}const Jve="ht__manualRowMove--guideline";class Zve extends yV{build(){super.build(),X(this._element,Jve)}}function Qve(t,e){CV(t,e),e.add(t)}function pc(t,e,n){CV(t,e),e.set(t,n)}function CV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iu(t,e,n){return t.set(Ma(t,e),n),n}function Pe(t,e){return t.get(Ma(t,e))}function Ma(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeRowMove");oe.getSingleton().register("afterRowMove");const dS="manualRowMove",eye=140,i1="ht__manualRowMove",ov="show-ui",g0="on-moving--rows",m0="after-selection--rows";var gr=new WeakMap,Pa=new WeakMap,Bs=new WeakMap,Fa=new WeakMap,$r=new WeakMap,lp=new WeakMap,$l=new WeakSet;class tye extends tt{constructor(){super(...arguments),Qve(this,$l),pc(this,gr,new Xve(this.hot)),pc(this,Pa,new Zve(this.hot)),pc(this,Bs,[]),pc(this,Fa,void 0),pc(this,$r,{}),pc(this,lp,void 0)}static get PLUGIN_KEY(){return dS}static get PLUGIN_PRIORITY(){return eye}isEnabled(){return!!this.hot.getSettings()[dS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ma($l,e,nye).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ma($l,e,iye).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ma($l,this,sye).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ma($l,e,aye).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,i1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ve(this.hot.rootElement,i1),this.unregisterEvents(),Pe(gr,this).destroy(),Pe(Pa,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Pe(lp,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(iu(lp,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return iu(lp,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Mn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[dS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return ge(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Pe($r,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Pe($r,this).TD,a=this.hot.rootElement,l=Wn(a),u=th(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Pe($r,this).eventPageY-d+c,g=o.hider.offsetHeight,p=o.TBODY.offsetTop,C=Pe(gr,this).getOffset().top,E=Pe(gr,this).getSize().height,y=s.offsetHeight/2,T=s.offsetHeight;let _=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=f>=_+y;this.isFixedRowTop(e.row)&&(_+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Pe($r,this).row=n>0?n-1:n:I?(Pe($r,this).row=e.row+1,_+=e.row===0?T-1:T):Pe($r,this).row=e.row;let M=f,P=_;f+E+C>=g?M=g-E-C:f+C<p&&(M=p+Math.abs(C)),_>=g-1&&(P=g-1),Pe(gr,this).setPosition(M),Pe(Pa,this).setPosition(P)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ma($l,this,rye).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ma($l,this,oye).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(gr,this).build(),Pe(Pa,this).build()}destroy(){Pe(gr,this).destroy(),Pe(Pa,this).destroy(),super.destroy()}}function nye(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Pe(Fa,this)||t.button!==0){iu(Fa,this,!1),Pe(Bs,this).length=0,ve(this.hot.rootElement,[g0,ov]);return}const l=Pe(Pa,this).isBuilt()&&!Pe(Pa,this).isAppended(),u=Pe(gr,this).isBuilt()&&!Pe(gr,this).isAppended();l&&u&&(Pe(Pa,this).appendTo(i.hider),Pe(gr,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,iu(Fa,this,!0),Pe($r,this).eventPageY=t.pageY,Pe($r,this).coords=e,Pe($r,this).TD=n,iu(Bs,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),p=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Pe(gr,this).setPosition(null,g),Pe(gr,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Pe(gr,this).setOffset(-p,null),X(this.hot.rootElement,g0),this.refreshPositions()}else ve(this.hot.rootElement,m0),iu(Fa,this,!1),Pe(Bs,this).length=0}function rye(t){Pe(Fa,this)&&(Pe($r,this).eventPageY=t.pageY,this.refreshPositions())}function iye(t,e,n,r){!this.hot.getSelectedRangeLast()||!Pe(Fa,this)||(Pe(Bs,this).indexOf(e.row)>-1?ve(this.hot.rootElement,ov):X(this.hot.rootElement,ov),r.row=!0,r.column=!0,r.cell=!0,Pe($r,this).coords=e,Pe($r,this).TD=n)}function oye(){const t=Pe($r,this).row,e=Pe(Bs,this).length;if(iu(Fa,this,!1),ve(this.hot.rootElement,[g0,ov,m0]),this.hot.selection.isSelectedByRowHeader()&&X(this.hot.rootElement,m0),e<1||t===void 0)return;const n=Pe(Bs,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Pe(Bs,this),t);if(Pe(Bs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function sye(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Pe(gr,this).setPosition(null,r),Pe(gr,this).setSize(t.hider.offsetWidth-r)}function aye(){this.moveBySettingsOrLoad()}function lye(t,e){bV(t,e),e.add(t)}function Gn(t,e,n){bV(t,e),e.set(t,n)}function bV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kt(t,e,n){return t.set(As(t,e),n),n}function ie(t,e){return t.get(As(t,e))}function As(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sv="manualRowResize",uye=30,o1="manualRowHeights";var $o=new WeakMap,up=new WeakMap,Zr=new WeakMap,gf=new WeakMap,Ia=new WeakMap,$_=new WeakMap,Xc=new WeakMap,cp=new WeakMap,cr=new WeakMap,No=new WeakMap,Cu=new WeakMap,av=new WeakMap,mf=new WeakMap,pf=new WeakMap,to=new WeakMap,wf=new WeakMap,pa=new WeakSet;class cye extends tt{static get PLUGIN_KEY(){return sv}static get PLUGIN_PRIORITY(){return uye}constructor(e){super(e),lye(this,pa),Gn(this,$o,null),Gn(this,up,null),Gn(this,Zr,[]),Gn(this,gf,null),Gn(this,Ia,null),Gn(this,$_,null),Gn(this,Xc,null),Gn(this,cp,null),Gn(this,cr,this.hot.rootDocument.createElement("DIV")),Gn(this,No,this.hot.rootDocument.createElement("DIV")),Gn(this,Cu,!1),Gn(this,av,!1),Gn(this,mf,0),Gn(this,pf,null),Gn(this,to,void 0),Gn(this,wf,void 0),X(ie(cr,this),"manualRowResizer"),X(ie(No,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[sv]}enablePlugin(){this.enabled||(Kt(to,this,new el),ie(to,this).addLocalHook("init",()=>As(pa,this,wye).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ie(to,this)),this.addHook("modifyRowHeight",(e,n)=>As(pa,this,pye).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Kt(wf,this,ie(to,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",o1,ie(to,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",o1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return ie(to,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ie(gf,this)}setupHandlePosition(e){Kt($o,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ie($o,this)),o=i.row;if(o<0)return;const s=on(ie($o,this)),a=ie($o,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie($o,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ie($o,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ie($o,this),i.row,i.col)),Kt(up,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Kt(Zr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();x(d,f=>{const g=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;ge(g,p,C=>{ie(Zr,this).includes(C)||ie(Zr,this).push(C)})})}ie(Zr,this).includes(ie(up,this))||Kt(Zr,this,[ie(up,this)]),Kt(cp,this,c.top-6),Kt(Xc,this,parseInt(a.height,10)),ie(cr,this).style.top=`${ie(cp,this)+ie(Xc,this)}px`,ie(cr,this).style[this.inlineDir]=`${c.start}px`,ie(cr,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ie(cr,this))}refreshHandlePosition(){ie(cr,this).style.top=`${ie(cp,this)+ie(gf,this)}px`}setupGuidePosition(){const e=parseInt(on(ie(cr,this)),10),n=parseInt(ie(cr,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();X(ie(cr,this),"active"),X(ie(No,this),"active"),ie(No,this).style.top=ie(cr,this).style.top,ie(No,this).style[this.inlineDir]=`${n}px`,ie(No,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ie(No,this))}refreshGuidePosition(){ie(No,this).style.top=ie(cr,this).style.top}hideHandleAndGuide(){ve(ie(cr,this),"active"),ve(ie(No,this),"active")}checkIfRowHeader(e){const n=Ga(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ie(Ia,this)<n?n:ie(Ia,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Kt(Ia,this,o),this.setManualSize(r,ie(Ia,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ie(mf,this)>=2&&(ie(Zr,this).length>1?(x(ie(Zr,this),i=>{n(i)}),e()):x(ie(Zr,this),i=>{n(i,!0)})),Kt(mf,this,0),Kt(pf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>As(pa,this,hye).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>As(pa,this,dye).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>As(pa,this,fye).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>As(pa,this,gye).call(this)),this.eventManager.addEventListener(ie(cr,this),"contextmenu",()=>As(pa,this,mye).call(this))}destroy(){super.destroy()}}function hye(t){if(!WE(t.target)&&ie(av,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ie(Cu,this)||this.setupHandlePosition(e))}}function dye(t){Ce(t.target,"manualRowResizer")&&(this.setupHandlePosition(ie($o,this)),this.setupGuidePosition(),Kt(Cu,this,!0),ie(pf,this)===null&&(Kt(pf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(pf,this))),Kt(mf,this,ie(mf,this)+1),Kt($_,this,t.pageY),Kt(Ia,this,ie(Xc,this)))}function fye(t){ie(Cu,this)&&(Kt(gf,this,ie(Xc,this)+(t.pageY-ie($_,this))),x(ie(Zr,this),e=>{Kt(Ia,this,this.setManualSize(e,ie(gf,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function gye(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ie(Cu,this)&&(this.hideHandleAndGuide(),Kt(Cu,this,!1),ie(Ia,this)!==ie(Xc,this)&&(ie(Zr,this).length>1?(x(ie(Zr,this),r=>{e(r)}),t()):x(ie(Zr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie($o,this)))}function mye(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(cr,this)),this.hot.rootElement.removeChild(ie(No,this)),Kt(Cu,this,!1),Kt(av,this,!0),this.hot._registerImmediate(()=>{Kt(av,this,!1)})}function pye(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ie(to,this).getValueAtIndex(r);this.hot.getSettings()[sv]&&i&&(n=i)}return n}function wye(){const t=this.hot.getSettings()[sv],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ie(to,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ie(to,this).setValueAtIndex(r,n)}),Kt(wf,this,t)):t===!0&&Array.isArray(ie(wf,this))&&ie(wf,this).forEach((n,r)=>{ie(to,this).setValueAtIndex(r,n)})},!0)}var vye=Jv;vye("flatMap");var yye=Rn,s1=Tn,Cye=rs,bye=Q0,Sye=function(t,e){(!e||typeof t!="string")&&s1(t);var n=bye(t);return Cye(s1(n!==void 0?yye(n,t):t))},Rye=Et,p0=Rn,Eye=Vr,w0=Tn,Tye=rs,Mye=Sye,_ye=oE,v0=oi,xye=Qa,fS=xye("flatMap",TypeError),Pye=_ye(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=w0(p0(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){v0(t,"throw",i)}if(n=w0(p0(this.next,t)),this.done=!!n.done)return;try{this.inner=Mye(e(n.value,this.counter++),!1)}catch(i){v0(t,"throw",i)}}});Rye({target:"Iterator",proto:!0,real:!0,forced:fS},{flatMap:function(e){w0(this);try{Eye(e)}catch(n){v0(this,"throw",n)}return fS?p0(fS,this,e):new Pye(Tye(this),{mapper:e,inner:null})}});function Iye(t,e,n){Oye(t,e),e.set(t,n)}function Oye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ll(t,e,n){return(e=Aye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aye(t){var e=Hye(t,"string");return typeof e=="symbol"?e:e+""}function Hye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function a1(t,e){return t.get(SV(t,e))}function hp(t,e,n){return t.set(SV(t,e),n),n}function SV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fl=new WeakMap;class Lo{constructor(e,n,r,i,o,s){Ll(this,"row",void 0),Ll(this,"col",void 0),Ll(this,"rowspan",void 0),Ll(this,"colspan",void 0),Ll(this,"removed",!1),Ll(this,"cellCoordsFactory",void 0),Ll(this,"cellRangeFactory",void 0),Iye(this,Fl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return mt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return mt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return mt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return mt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),hp(Fl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,hp(Fl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return hp(Fl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return a1(Fl,this)||hp(Fl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),a1(Fl,this)}}function Nye(t,e){Dye(t,e),e.add(t)}function Dye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dp(t,e,n){return(e=kye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kye(t){var e=$ye(t,"string");return typeof e=="symbol"?e:e+""}function $ye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wa=new WeakSet;class lv{constructor(e){Nye(this,wa),dp(this,"plugin",void 0),dp(this,"mergedCells",[]),dp(this,"mergedCellsMatrix",new Map),dp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return mt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){at(lv.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Lo(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Vl(wa,this,l1).call(this,a),a):(u&&at(lv.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Vl(wa,this,Lye).call(this,r),r):!1}clear(){x(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;ge(n,n+i,s=>{ge(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ze(u,i,i+s-1),d=Ze(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Vl(wa,this,fp).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Vl(wa,this,fp).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Vl(wa,this,fp).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Vl(wa,this,fp).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Vl(wa,this,l1).call(this,s)})}}function fp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function l1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Lye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function gS(t,e,n){return(e=Fye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fye(t){var e=Vye(t,"string");return typeof e=="symbol"?e:e+""}function Vye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bye{constructor(e){gS(this,"plugin",void 0),gS(this,"mergedCellsCollection",void 0),gS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,p=this.getFarthestCollection(e,n,r,i);if(p){if(r==="down"){const C=p.row+p.rowspan-a-g;o[2]+C>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?C:0}else if(r==="right"){const C=p.col+p.colspan-l-g;o[3]+C>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?C:0}else if(r==="up"){const C=u-g-p.row+1;o[0]+C<0?o[0]+=g:o[0]-=g?C:0}else if(r==="left"){const C=c-g-p.col+1;o[1]+C<0?o[1]+=g:o[1]-=g?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),fn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,p=d-g;let C=null,E=null,y=null;switch(r){case"up":C="includesVertically",y=c-p+1;break;case"left":C="includesHorizontally",y=c-p+1;break;case"down":C="includesVertically",y=h+p-1;break;case"right":C="includesHorizontally",y=h+p-1;break}return x(i,T=>{T[C](y)&&T.isFarther(E,r)&&(E=T)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return x(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:p}=g;return p===h.getWidth()}):!f.every(g=>{let{rowspan:p}=g;return p===h.getHeight()})}}function mS(t,e,n){return(e=Wye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wye(t){var e=jye(t,"string");return typeof e=="symbol"?e:e+""}function jye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uye{constructor(e){mS(this,"plugin",void 0),mS(this,"hot",void 0),mS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function zye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(KT)}return this.getTranslatedPhrase(GT)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Lo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function vf(t,e,n){return(e=Yye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yye(t){var e=Gye(t,"string");return typeof e=="symbol"?e:e+""}function Gye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u1{constructor(e){vf(this,"data",void 0),vf(this,"next",null),vf(this,"prev",null),this.data=e}}class gp{constructor(){vf(this,"first",null),vf(this,"last",null)}push(e){const n=new u1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new u1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Kye(t,e){RV(t,e),e.add(t)}function Bl(t,e,n){RV(t,e),e.set(t,n)}function RV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ht(t,e){return t.get(uv(t,e))}function Ur(t,e,n){return t.set(uv(t,e),n),n}function uv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _o=new WeakMap,xo=new WeakMap,Po=new WeakMap,Io=new WeakMap,y0=new WeakMap,mp=new WeakMap,pp=new WeakMap,pS=new WeakSet;class qye{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Kye(this,pS),Bl(this,_o,new gp),Bl(this,xo,new gp),Bl(this,Po,null),Bl(this,Io,null),Bl(this,y0,null),Bl(this,mp,null),Bl(this,pp,null),Ur(y0,this,n),Ur(mp,this,r),Ur(pp,this,i)}getCurrentVerticalNode(){return ht(Io,this).data}getFirstVerticalNode(){return ht(xo,this).first.data}getNextVerticalNode(){return ht(Io,this).next.data}getPrevVerticalNode(){return ht(Io,this).prev.data}getCurrentHorizontalNode(){return ht(Po,this).data}getFirstHorizontalNode(){return ht(_o,this).first.data}getNextHorizontalNode(){return ht(Po,this).next.data}getPrevHorizontalNode(){return ht(Po,this).prev.data}setPrevNodeAsActive(){Ur(Io,this,ht(Io,this).prev),Ur(Po,this,ht(Po,this).prev)}setNextNodeAsActive(){Ur(Io,this,ht(Io,this).next),Ur(Po,this,ht(Po,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Ur(_o,this,new gp);for(let s=n.row;s<=r.row;s++)if(!ht(mp,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(ht(pp,this).isHidden(a))continue;const l=uv(pS,this,c1).call(this,e,ht(_o,this),i,s,a);l&&Ur(Po,this,l)}ht(_o,this).first&&(ht(_o,this).first.prev=ht(_o,this).last,ht(_o,this).last.next=ht(_o,this).first);const o=new WeakSet;Ur(xo,this,new gp);for(let s=n.col;s<=r.col;s++)if(!ht(pp,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(ht(mp,this).isHidden(a))continue;const l=uv(pS,this,c1).call(this,e,ht(xo,this),o,a,s);l&&Ur(Io,this,l)}ht(xo,this).first&&(ht(xo,this).first.prev=ht(xo,this).last,ht(xo,this).last.next=ht(xo,this).first)}setActiveNode(e,n){return ht(_o,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Ur(Po,this,r),!1}),ht(xo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Ur(Io,this,r),!1}),this}}function c1(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=ht(y0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function EV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function Xye(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!$e(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),$f()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[p,C]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if($f()&&d===0&&!e.getSettings().rowHeaders){const V=EV(e,h,g);i.set(l,V/g)}const y=n.getRenderableFromVisualIndex(l),T=r.getRenderableFromVisualIndex(u),_=p-y+1,I=C-T+1;let M=n.getNearestNotHiddenIndex(h,1),P=r.getNearestNotHiddenIndex(d,1);if(E){const V=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(V)||(M=Math.max(M,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(V)||(P=Math.max(P,e.getFirstRenderedVisibleColumn()))}const z=Math.min(g,_),W=Math.min(f,I);M===l&&P===u?(a.setAttribute("rowspan",z),a.setAttribute("colspan",W)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function Jye(t,e){TV(t,e),e.add(t)}function wp(t,e,n){TV(t,e),e.set(t,n)}function TV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wS(t,e,n){return(e=Zye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zye(t){var e=Qye(t,"string");return typeof e=="symbol"?e:e+""}function Qye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xf(t,e,n){return t.set(pt(t,e),n),n}function Rt(t,e){return t.get(pt(t,e))}function pt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeMergeCells");oe.getSingleton().register("afterMergeCells");oe.getSingleton().register("beforeUnmergeCells");oe.getSingleton().register("afterUnmergeCells");const C0="mergeCells",eCe=150,h1=C0;var Si=new WeakMap,Ri=new WeakMap,zo=new WeakMap,d1=new WeakMap,bt=new WeakSet;class tCe extends tt{constructor(){super(...arguments),Jye(this,bt),wS(this,"mergedCellsCollection",null),wS(this,"autofillCalculations",null),wS(this,"selectionCalculations",null),wp(this,Si,null),wp(this,Ri,{row:0,col:0}),wp(this,zo,new qye({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),wp(this,d1,Xye(this))}static get PLUGIN_KEY(){return C0}static get PLUGIN_PRIORITY(){return eCe}static get DEFAULT_SETTINGS(){return{[zL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[C0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new lv(this),this.autofillCalculations=new Bye(this),this.selectionCalculations=new Uye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,nCe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,iCe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,oCe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,sCe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,aCe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,g1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,g1).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,uCe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,cCe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,hCe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,f1).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,f1).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,rCe).call(e,...r)}),this.addHook("afterRenderer",function(){return Rt(d1,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,lCe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,dCe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,fCe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,gCe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,mCe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,pCe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,wCe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,vCe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,yCe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,CCe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,bCe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,SCe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,RCe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,ECe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(bt,e,TCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!GE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Nf(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Nf(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Lo.containsNegativeValues(e)?(at(Lo.NEGATIVE_VALUES_WARNING(e)),!1):Lo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(at(Lo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Lo.isSingleCell(e)?(at(Lo.IS_SINGLE_CELL(e)),!1):Lo.containsZeroSpan(e)?(at(Lo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),ge(0,s.rowspan-1,c=>{ge(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),x(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),ge(0,i.rowspan-1,o=>{ge(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:h1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(h1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if($e(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if($e(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if($e(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if($e(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function nCe(){this.generateFromSettings(),this.hot.render()}function rCe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function iCe(t){Rt(Ri,this).row=t.row,Rt(Ri,this).col=t.col}function oCe(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;Rt(Si,this)&&(i.getRenderableFromVisualIndex(Rt(Si,this).row)!==null&&(n.row=Rt(Si,this).row),r.getRenderableFromVisualIndex(Rt(Si,this).col)!==null&&(n.col=Rt(Si,this).col),Xf(Si,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function sCe(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function aCe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Xf(Si,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Xf(Si,this,e.clone()),n&&e.assign(n)}function f1(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),p=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ze(g,u,h),Ze(p,c,d),Ze(this.hot.getLastRenderedVisibleRow(),u,h),Ze(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function lCe(t){t.items.push({name:"---------"},zye(this))}function g1(){Xf(Si,this,null)}function uCe(){if(Rt(Si,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=Rt(Si,this).clone().normalize();Rt(zo,this).setActiveNode(r.row,r.col),Rt(Ri,this).row>0||Rt(Ri,this).col>0?Rt(zo,this).setPrevNodeAsActive():(n==="E-W"&&Rt(Ri,this).col<0||e==="S-N"&&Rt(Ri,this).row<0)&&Rt(zo,this).setNextNodeAsActive()}function cCe(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(Rt(Ri,this).col<0){const{rowEnd:a,colEnd:l}=Rt(zo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(Rt(Ri,this).col>0){const{rowStart:a,colStart:l}=Rt(zo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(Rt(Ri,this).row<0){const{rowEnd:a,colEnd:l}=Rt(zo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(Rt(Ri,this).row>0){const{rowStart:a,colStart:l}=Rt(zo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}Rt(zo,this).setActiveNode(t,e),Xf(Ri,this,{row:0,col:0})}function hCe(){this.hot.getSelectedRangeLast().isHeader()||Rt(zo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function dCe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function fCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function gCe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function mCe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function pCe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function wCe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function vCe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function yCe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function CCe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function bCe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);x(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function SCe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function RCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function ECe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function TCe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,EV(this.hot,e,g))}),t}function MCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:tF(u.type))(l,u,d)(c,h);if(g===Jo){const p=a+1;if(typeof e[p]<"u")return s(p)}return g}(0)}}const MV="sort";function _Ce(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${MV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function xCe(t){const e=t.className.split(" "),n=new RegExp(`^${MV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function PCe(t,e,n){return(e=ICe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ICe(t){var e=OCe(t,"string");return typeof e=="symbol"?e:e+""}function OCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cv="multiColumnSorting",ACe=170,m1=cv;eF(cv,MCe);class HCe extends cF{constructor(){super(...arguments),PCe(this,"pluginKey",cv)}static get PLUGIN_KEY(){return cv}static get PLUGIN_PRIORITY(){return ACe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,zw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:tl,position:"before",group:m1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(m1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),ve(e,xCe(e)),this.enabled!==!1&&X(e,_Ce(...r))}onAfterOnCellMouseDown(e,n){R_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,zw))):this.sort(this.getColumnNextConfig(n.col)))}}function p1(t,e,n){return(e=NCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NCe(t){var e=DCe(t,"string");return typeof e=="symbol"?e:e+""}function DCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const kCe="multipleSelectionHandles",$Ce=160;class LCe extends tt{constructor(){super(...arguments),p1(this,"dragged",[]),p1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return kCe}static get PLUGIN_PRIORITY(){return $Ce}isEnabled(){return Ko()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Ce(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Ce(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Ce(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ce(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function b0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function _V(){return{label:"",isPlaceholder:!0}}function FCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;x(t,i=>{const o=[];let s=0;n.push(o),x(i,a=>{const l=b0();if($e(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=It(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=It(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(_V());return!u})});const r=Math.max(...Xe(n,i=>i.length));return x(n,i=>{if(i.length<r){const o=Xe(new Array(r-i.length),()=>b0());i.splice(i.length,0,...o)}}),n}function vS(t,e,n){VCe(t,e),e.set(t,n)}function VCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(t,e){return t.get(xV(t,e))}function Id(t,e,n){return t.set(xV(t,e),n),n}function xV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const w1=["label","collapsible"];var Ss=new WeakMap,Wl=new WeakMap,yS=new WeakMap;class BCe{constructor(){vS(this,Ss,[]),vS(this,Wl,0),vS(this,yS,1/0)}setColumnsLimit(e){Id(yS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Id(Ss,this,FCe(e,Wi(yS,this))),Id(Wl,this,Wi(Ss,this).length)}getData(){return Wi(Ss,this)}mergeWith(e){x(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&fn(s,o,w1)})}map(e){x(Wi(Ss,this),n=>{x(n,r=>{const i=e({...r});$e(i)&&fn(r,i,w1)})})}getHeaderSettings(e,n){var r;if(e>=Wi(Wl,this)||e<0)return null;const i=Wi(Ss,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Wi(Wl,this)||e<0)return i;const o=Wi(Ss,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Wi(Wl,this)}getColumnsCount(){return Wi(Wl,this)>0?Wi(Ss,this)[0].length:0}clear(){Id(Ss,this,[]),Id(Wl,this,0)}}function CS(t,e,n){return(e=WCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WCe(t){var e=jCe(t,"string");return typeof e=="symbol"?e:e+""}function jCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const PV="DF-pre-order";function IV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=IV.call(this.childs[r],t,e)}return n}const UCe="DF-post-order";function OV(t,e){for(let n=0;n<this.childs.length;n++)if(OV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const AV="BF";function zCe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const YCe=AV,v1=new Map([[PV,IV],[UCe,OV],[AV,zCe]]);class hv{constructor(e){CS(this,"data",{}),CS(this,"parent",null),CS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new hv({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:YCe;if(!v1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);v1.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function bS(t,e,n){GCe(t,e),e.set(t,n)}function GCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lr(t,e){return t.get(HV(t,e))}function KCe(t,e,n){return t.set(HV(t,e),n),n}function HV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wc=new WeakMap,jl=new WeakMap,vc=new WeakMap;class qCe{constructor(e){bS(this,wc,new Map),bS(this,jl,new Map),bS(this,vc,null),KCe(vc,this,e)}getRoots(){return Array.from(lr(wc,this).values())}getRootByColumn(e){let n;return lr(jl,this).has(e)&&(n=lr(wc,this).get(lr(jl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-lr(jl,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;lr(jl,this).clear(),x(lr(wc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)lr(jl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=lr(vc,this).getColumnsCount();let n=0;for(;n<e;){const r=lr(vc,this).getHeaderSettings(0,n),i=new hv;lr(wc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=lr(vc,this).getHeadersSettings(r,n,i);r+=1,x(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new hv(a),e.addChild(l)),r<lr(vc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){lr(wc,this).clear(),lr(jl,this).clear()}}function NV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function dv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function fv(t){return dv(t,"origColspan")===t.data.origColspan}function L_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fv(t))return L_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)x(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,NV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):fv(a)&&(l.isCollapsed=dv(a,"isCollapsed"))}),{rollbackModification:()=>F_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function F_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fv(t))return F_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)x(o,l=>{NV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=dv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):fv(l)&&(u.isCollapsed=dv(l,"isCollapsed"))}),{rollbackModification:()=>L_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function XCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(mt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function JCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(mt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const y1=new Map([["collapse",F_],["expand",L_],["hide-column",XCe],["show-column",JCe]]);function ZCe(t,e,n){if(!y1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return y1.get(t)(e,n)}function vp(t){const e=[];return x(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=ebe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(_V());else{const f=QCe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function QCe(t){const{crossHiddenColumns:e,...n}=b0(t);return n}function ebe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function SS(t,e,n){tbe(t,e),e.set(t,n)}function tbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Od(t,e,n){return t.set(DV(t,e),n),n}function zt(t,e){return t.get(DV(t,e))}function DV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Oo=new WeakMap,Mr=new WeakMap,Ul=new WeakMap;class nbe{constructor(){SS(this,Oo,new BCe),SS(this,Mr,new qCe(zt(Oo,this))),SS(this,Ul,[[]])}setState(e){zt(Oo,this).setData(e);let n=!1;try{zt(Mr,this).buildTree()}catch{zt(Mr,this).clear(),zt(Oo,this).clear(),n=!0}return Od(Ul,this,vp(zt(Mr,this).getRoots())),n}setColumnsLimit(e){zt(Oo,this).setColumnsLimit(e)}mergeStateWith(e){const n=Xe(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});zt(Oo,this).mergeWith(n),zt(Mr,this).buildTree(),Od(Ul,this,vp(zt(Mr,this).getRoots()))}mapState(e){zt(Oo,this).map(e),zt(Mr,this).buildTree(),Od(Ul,this,vp(zt(Mr,this).getRoots()))}mapNodes(e){return Mn(zt(Mr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=zt(Mr,this).getNode(n,r);let o;return i&&(o=ZCe(e,i,r),Od(Ul,this,vp(zt(Mr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=zt(Ul,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=zt(Mr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=zt(Mr,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},PV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return zt(Oo,this).getLayersCount()}getColumnsCount(){return zt(Oo,this).getColumnsCount()}clear(){Od(Ul,this,[]),zt(Oo,this).clear(),zt(Mr,this).clear()}}function Ad(t,e,n){return(e=rbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rbe(t){var e=ibe(t,"string");return typeof e=="symbol"?e:e+""}function ibe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class obe{constructor(e,n){Ad(this,"hot",void 0),Ad(this,"nestedHeaderSettingsGetter",void 0),Ad(this,"layersCount",0),Ad(this,"container",void 0),Ad(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),Hu(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function sbe(t,e){kV(t,e),e.add(t)}function C1(t,e,n){return(e=abe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function abe(t){var e=lbe(t,"string");return typeof e=="symbol"?e:e+""}function lbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hd(t,e,n){kV(t,e),e.set(t,n)}function kV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ws(t,e,n){return t.set(Yt(t,e),n),n}function qe(t,e){return t.get(Yt(t,e))}function Yt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const b1="nestedHeaders",ube=280;var vt=new WeakMap,va=new WeakMap,yf=new WeakMap,_y=new WeakMap,gv=new WeakMap,Qt=new WeakSet;class cbe extends tt{constructor(){super(...arguments),sbe(this,Qt),Hd(this,vt,new nbe),Hd(this,va,null),Hd(this,yf,null),Hd(this,_y,!1),Hd(this,gv,null),C1(this,"ghostTable",new obe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),C1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return b1}static get PLUGIN_PRIORITY(){return ube}isEnabled(){return!!this.hot.getSettings()[b1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&at(mt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Yt(Qt,this,Mbe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,_be).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,gbe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,mbe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,pbe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,wbe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,vbe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,ybe).call(e,...i)}),this.addHook("afterSelection",()=>Yt(Qt,this,yp).call(this)),this.addHook("afterSelectionFocusSet",()=>Yt(Qt,this,yp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,hbe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Yt(Qt,this,bbe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,Rbe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,Ebe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,dbe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,fbe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,Cbe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,Sbe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Yt(Qt,e,Tbe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Yt(Qt,this,yp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Yt(Qt,this,yp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();qe(vt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=qe(vt,this).setState(e)),this.detectedOverlappedHeaders&&at(mt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";qe(vt,this).triggerColumnModification(i,r)}),!qe(va,this)&&this.enabled&&Ws(va,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";qe(vt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),qe(vt,this).clear(),qe(va,this).unsubscribe(),Ws(va,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return qe(vt,this)}getLayersCount(){return qe(vt,this).getLayersCount()}getHeaderSettings(e,n){return qe(vt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),ve(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),ve(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ve(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),ve(o,"hiddenHeader"),ve(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=qe(vt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)X(o,"hiddenHeader");else if(c>1){var g,p,C;const{wtOverlays:E}=l._wt,y=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),T=(p=E.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o);((C=E.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&u<r&&X(o,"hiddenHeaderText");const I=y||T?Math.min(c,r-i):c;I>1&&o.setAttribute("colspan",I)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(ve(E,this.hot.getColumnMeta(u).headerClassName),X(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=qe(vt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Ws(vt,this,null),qe(va,this)!==null&&(qe(va,this).unsubscribe(),Ws(va,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return qe(vt,this).getHeaderTreeNodeData(e.row,e.col)}}function yp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=qe(vt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function hbe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=qe(gv,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(Ws(gv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=qe(vt,this).findLeftMostColumnIndex(a,l),g=qe(vt,this).findRightMostColumnIndex(a,l),p=g-f+1;if(f<c&&g>h)return f;if(s){let C=null;return f>=c&&g>h?p>d?(e.value="start",C=f):(e.value="end",C=g):f<c&&g<=h&&(p>d?(e.value="end",C=g):(e.value="start",C=f)),C}return f<=c?f:g}function dbe(t,e,n){const r=qe(vt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=qe(vt,this).getHeaderSettings(e,t);if(o===hT){if(!a)return r.columnIndex}else if(o===k$&&(l>s-i||!a))return null;return t}function fbe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,p=d-a;if(p===0)continue;((i=qe(vt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][p]="")}}}function gbe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function mbe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Ws(yf,this,e.clone()),Ws(_y,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Xv(t)||qa(t)&&l||u$(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function pbe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ze(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function wbe(){Ws(_y,this,!1)}function vbe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!qe(_y,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=qe(vt,this).getHeaderTreeNodeData(qe(yf,this).row,qe(yf,this).col);if(e.setHighlight(qe(yf,this)),o>e.getWidth()||i<n||i+o-1>r){const s=qe(vt,this).findTopMostEntireHeaderLevel(Ze(n,i,i+o-1),Ze(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function ybe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=qe(vt,this).findLeftMostColumnIndex(n.row,n.col),o=qe(vt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Cbe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Ws(gv,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function bbe(t){if(qe(vt,this).getLayersCount()>0){t.length=0;for(let e=0;e<qe(vt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function Sbe(t){const e=qe(vt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=qe(vt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Jn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?qe(vt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Rbe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Ebe(t,e,n){var r;const{label:i}=(r=qe(vt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Tbe(t,e){if(t<0)return this.hot.getCell(t,qe(vt,this).findLeftMostColumnIndex(t,e),!0)}function Mbe(){this.updatePlugin()}function _be(t,e){e||this.updatePlugin()}function Nd(t,e,n){return(e=xbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xbe(t){var e=Pbe(t,"string");return typeof e=="symbol"?e:e+""}function Pbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ibe{constructor(e,n){Nd(this,"hot",void 0),Nd(this,"data",null),Nd(this,"plugin",void 0),Nd(this,"parentReference",new WeakMap),Nd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ge(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&x(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&x(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Le(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(x(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(ge(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),ge(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];x(r,o=>{i.push(this.getDataObject(o))}),x(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function S1(t,e,n){return(e=Obe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Obe(t){var e=Abe(t,"string");return typeof e=="symbol"?e:e+""}function Abe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V_{constructor(e,n){S1(this,"hot",void 0),S1(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Bo extends V_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(x(l,c=>{c&&s.removeChild(c)}),X(n,Bo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",ge(0,i-1,()=>{const d=c.createElement("SPAN");X(d,Bo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Re(c,[Ou()]),X(n,Bo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(X(c,`${Bo.CSS_CLASSES.button} ${Bo.CSS_CLASSES.expandButton}`),u&&Re(n,[Ei(!1)])):(X(c,`${Bo.CSS_CLASSES.button} ${Bo.CSS_CLASSES.collapseButton}`),u&&Re(n,[Ei(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class Hbe extends V_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),x(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{ge(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&x(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];x(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return x(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);x(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return x(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);x(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&x(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];x(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];x(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];x(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{x(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{x(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&x(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Ce(e.target,Bo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Hi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Nbe(t,e,n){Dbe(t,e),e.set(t,n)}function Dbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kbe(t,e,n){return(e=$be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $be(t){var e=Lbe(t,"string");return typeof e=="symbol"?e:e+""}function Lbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fbe(t,e){return t.get(Vbe(t,e))}function Vbe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var R1=new WeakMap;class Bbe extends V_{constructor(){super(...arguments),kbe(this,"dataManager",this.plugin.dataManager),Nbe(this,R1,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(fM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(gM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ge(0,e.items.length-1,r=>{if(r===0)return x(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ge(0,e.items.length-1,n=>{const r=Fbe(R1,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function Cp(t,e,n){return(e=Wbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wbe(t){var e=jbe(t,"string");return typeof e=="symbol"?e:e+""}function jbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ube{constructor(e){Cp(this,"plugin",void 0),Cp(this,"hot",void 0),Cp(this,"dataManager",void 0),Cp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(p,a),p}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Lt(i)&&(at(mt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function zbe(t,e){$V(t,e),e.add(t)}function E1(t,e,n){$V(t,e),e.set(t,n)}function $V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RS(t,e,n){return(e=Ybe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ybe(t){var e=Gbe(t,"string");return typeof e=="symbol"?e:e+""}function Gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rw(t,e){return t.get(Pn(t,e))}function mv(t,e,n){return t.set(Pn(t,e),n),n}function Pn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pv="nestedRows",Kbe=300,T1=pv,qbe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var xy=new WeakMap,yc=new WeakMap,Nn=new WeakSet;class Xbe extends tt{constructor(){super(...arguments),zbe(this,Nn),RS(this,"dataManager",null),RS(this,"headersUI",null),RS(this,"collapsedRowsMap",null),E1(this,xy,!1),E1(this,yc,!1)}static get PLUGIN_KEY(){return pv}static get PLUGIN_PRIORITY(){return Kbe}isEnabled(){return!!this.hot.getSettings()[pv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Tg),this.dataManager=new Ibe(this,this.hot),this.collapsingUI=new Hbe(this,this.hot),this.headersUI=new Bo(this,this.hot),this.contextMenuUI=new Bbe(this,this.hot),this.rowMoveController=new Ube(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,cSe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,hSe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,Qbe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,eSe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,tSe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,Zbe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,iSe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,rSe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,oSe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,sSe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,aSe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,lSe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,nSe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,uSe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pn(Nn,e,Jbe).call(e,...r)}),this.addHook("beforeLoadData",n=>Pn(Nn,this,M1).call(this,n)),this.addHook("beforeUpdateData",n=>Pn(Nn,this,M1).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:T1,relativeToGroup:tl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(T1)}disableCoreAPIModifiers(){mv(yc,this,!0)}enableCoreAPIModifiers(){mv(yc,this,!1)}onModifyRowData(e){if(!rw(yc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!rw(yc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return rw(yc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Jbe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Zbe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Qbe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),mv(xy,this,!0),this.dataManager.getData().slice()}function eSe(t){return this.contextMenuUI.appendOptions(t)}function tSe(t,e){this.headersUI.appendLevelIndicators(t,e)}function nSe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function rSe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{mv(xy,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function iSe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function oSe(){this.collapsingUI.collapsedRowsStash.stash()}function sSe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function aSe(){this.collapsingUI.collapsedRowsStash.stash()}function lSe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function uSe(){this.dataManager.rewriteCache()}function cSe(){this.headersUI.updateRowHeaderWidth()}function hSe(t,e){rw(xy,this)&&(e.skipRender=!0)}function M1(t){if(!G$(t)){JE(qbe),this.hot.getSettings()[pv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function ES(t,e,n){return(e=dSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dSe(t){var e=fSe(t,"string");return typeof e=="symbol"?e:e+""}function fSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gSe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;ES(this,"rootWindow",void 0),ES(this,"prefix",void 0),ES(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){x(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function mSe(t,e,n){return(e=pSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pSe(t){var e=wSe(t,"string");return typeof e=="symbol"?e:e+""}function wSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}oe.getSingleton().register("persistentStateSave");oe.getSingleton().register("persistentStateLoad");oe.getSingleton().register("persistentStateReset");const _1="persistentState",vSe=0;class ySe extends tt{constructor(){super(...arguments),mSe(this,"storage",void 0)}static get PLUGIN_KEY(){return _1}static get PLUGIN_PRIORITY(){return vSe}isEnabled(){return!!this.hot.getSettings()[_1]}enablePlugin(){this.enabled||(this.storage||(this.storage=new gSe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function CSe(t,e){bSe(t,e),e.add(t)}function bSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TS(t,e,n){return(e=SSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SSe(t){var e=RSe(t,"string");return typeof e=="symbol"?e:e+""}function RSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function x1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const MS="search",ESe=190,TSe="htSearchResult",MSe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},_Se=function(t,e,n){return Lt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Lt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var _S=new WeakSet;class xSe extends tt{constructor(){super(...arguments),CSe(this,_S),TS(this,"callback",MSe),TS(this,"queryMethod",_Se),TS(this,"searchResultClass",TSe)}static get PLUGIN_KEY(){return MS}static get PLUGIN_PRIORITY(){return ESe}isEnabled(){return this.hot.getSettings()[MS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[MS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return x1(_S,e,P1).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return x1(_S,e,P1).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return ge(0,i-1,l=>{ge(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const p={row:l,col:u,data:c};s.push(p)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){$e(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function P1(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function bp(t,e,n){return(e=PSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PSe(t){var e=ISe(t,"string");return typeof e=="symbol"?e:e+""}function ISe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LV{constructor(e){bp(this,"viewportWidth",void 0),bp(this,"overwriteColumnWidthFn",void 0),bp(this,"baseWidths",new Map),bp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class OSe extends LV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=rh?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=rh){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,p=g;o.includes(f)||(p=Math.round(g*l)),this.stretchedWidths.set(f,p),u=f,d<i.length-1&&(c+=p)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function I1(t,e,n){ASe(t,e),e.set(t,n)}function ASe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xS(t,e){return t.get(FV(t,e))}function Sp(t,e,n){return t.set(FV(t,e),n),n}function FV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rp=new WeakMap,Dd=new WeakMap;class HSe extends LV{constructor(){super(...arguments),I1(this,Rp,0),I1(this,Dd,-1)}prepare(e){super.prepare(e),Sp(Rp,this,0),Sp(Dd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Sp(Dd,this,e),Sp(Rp,this,n)}calculate(){if(xS(Dd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+xS(Rp,this),0);this.stretchedWidths.set(xS(Dd,this),n)}}function NSe(t,e){VV(t,e),e.add(t)}function Ep(t,e,n){VV(t,e),e.set(t,n)}function VV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function en(t,e){return t.get(Lc(t,e))}function PS(t,e,n){return t.set(Lc(t,e),n),n}function Lc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DSe="stretchColumns";var Xn=new WeakMap,Cc=new WeakMap,IS=new WeakMap,Tp=new WeakMap,kd=new WeakSet;class kSe{constructor(e){NSe(this,kd),Ep(this,Xn,void 0),Ep(this,Cc,void 0),Ep(this,IS,new Map([["all",new OSe(Lc(kd,this,O1).bind(this))],["last",new HSe(Lc(kd,this,O1).bind(this))]])),Ep(this,Tp,"none"),PS(Xn,this,e),PS(Cc,this,en(Xn,this).columnIndexMapper.createAndRegisterIndexMap(DSe,"physicalIndexToValue"))}useStrategy(e){PS(Tp,this,en(IS,this).has(e)?e:"none")}refreshStretching(){if(en(Tp,this)==="none"){en(Cc,this).clear();return}en(Xn,this).batchExecution(()=>{en(Cc,this).clear();const e=en(IS,this).get(en(Tp,this));let r=en(Xn,this).view.getViewportWidth();Lc(kd,this,$Se).call(this)&&(r-=On(en(Xn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<en(Xn,this).countCols();i++)en(Xn,this).columnIndexMapper.isHidden(en(Xn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Lc(kd,this,LSe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;en(Cc,this).setValueAtIndex(en(Xn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return en(Cc,this).getValueAtIndex(en(Xn,this).toPhysicalColumn(e))}}function $Se(){const{view:t}=en(Xn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=en(Xn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=en(Xn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function LSe(t){var e;return(e=en(Xn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:rh}function O1(t,e){return en(Xn,this).runHooks("beforeStretchingColumnWidth",t,e)}function FSe(t,e){BV(t,e),e.add(t)}function OS(t,e,n){BV(t,e),e.set(t,n)}function BV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AS(t,e,n){return t.set(wv(t,e),n),n}function xs(t,e){return t.get(wv(t,e))}function wv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const VSe="stretchColumns",BSe=155;var Pc=new WeakMap,Mp=new WeakMap,$d=new WeakMap,HS=new WeakSet;class WSe extends tt{constructor(){super(...arguments),FSe(this,HS),OS(this,Pc,new kSe(this.hot)),OS(this,Mp,null),OS(this,$d,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;xs(Mp,this)!==null&&xs(Mp,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),AS(Mp,this,i.width)})})}))}static get PLUGIN_KEY(){return VSe}static get PLUGIN_PRIORITY(){return BSe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(xs(Pc,this).useStrategy(this.hot.getSettings().stretchH),xs($d,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wv(HS,e,USe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wv(HS,e,jSe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){xs(Pc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),xs($d,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return xs(Pc,this).getStretchedWidth(e)}destroy(){xs($d,this).disconnect(),AS($d,this,null),AS(Pc,this,null),super.destroy()}}function jSe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function USe(t){t&&xs(Pc,this).refreshStretching()}function zSe(t,e){YSe(t,e),e.add(t)}function YSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _p(t,e,n){return(e=GSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GSe(t){var e=KSe(t,"string");return typeof e=="symbol"?e:e+""}function KSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qSe="touchScroll",XSe=200;var xp=new WeakSet;class JSe extends tt{constructor(){super(...arguments),zSe(this,xp),_p(this,"scrollbars",[]),_p(this,"clones",[]),_p(this,"lockedCollection",!1),_p(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return qSe}static get PLUGIN_PRIORITY(){return XSe}static get SETTING_KEYS(){return!0}isEnabled(){return YE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>NS(xp,this,ZSe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>NS(xp,this,QSe).call(this)),this.addHook("afterMomentumScroll",()=>NS(xp,this,eRe).call(this))}}function ZSe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function QSe(){this.freezeOverlays=!0,x(this.clones,t=>{X(t,"hide-tween")})}function eRe(){this.freezeOverlays=!1,x(this.clones,t=>{ve(t,"hide-tween"),X(t,"show-tween")}),this.hot._registerTimeout(()=>{x(this.clones,t=>{ve(t,"show-tween")})},400),x(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function tRe(t,e){nRe(t,e),e.add(t)}function nRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rRe(t,e,n){return(e=iRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iRe(t){var e=oRe(t,"string");return typeof e=="symbol"?e:e+""}function oRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sRe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iw="trimRows",aRe=330;var A1=new WeakSet;class lRe extends tt{constructor(){super(...arguments),tRe(this,A1),rRe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return iw}static get PLUGIN_PRIORITY(){return aRe}isEnabled(){return!!this.hot.getSettings()[iw]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Tg),this.trimmedRowsMap.addLocalHook("init",()=>sRe(A1,this,uRe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[iw];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),x(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{x(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(x(e,l=>{o[l]=!1}),i=Mn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function uRe(){const t=this.hot.getSettings()[iw];Array.isArray(t)&&this.hot.batchExecution(()=>{x(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function cRe(t,e,n){return(e=hRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hRe(t){var e=dRe(t,"string");return typeof e=="symbol"?e:e+""}function dRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ni{constructor(e){cRe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Pp(t,e,n){return(e=fRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fRe(t){var e=gRe(t,"string");return typeof e=="symbol"?e:e+""}function gRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B_ extends Ni{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Pp(this,"stateBefore",void 0),Pp(this,"range",void 0),Pp(this,"type",void 0),Pp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new B_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){x(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){ba(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function H1(t,e,n){return(e=mRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mRe(t){var e=pRe(t,"string");return typeof e=="symbol"?e:e+""}function pRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W_ extends Ni{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),H1(this,"columns",void 0),H1(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new W_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),k_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function N1(t,e,n){return(e=wRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wRe(t){var e=vRe(t,"string");return typeof e=="symbol"?e:e+""}function vRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j_ extends Ni{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),N1(this,"previousSortState",void 0),N1(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new j_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function D1(t,e,n){return(e=yRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yRe(t){var e=CRe(t,"string");return typeof e=="symbol"?e:e+""}function CRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U_ extends Ni{constructor(e){let{index:n,amount:r}=e;super("insert_col"),D1(this,"index",void 0),D1(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new U_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function k1(t,e,n){return(e=bRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bRe(t){var e=SRe(t,"string");return typeof e=="symbol"?e:e+""}function SRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z_ extends Ni{constructor(e){let{index:n,amount:r}=e;super("insert_row"),k1(this,"index",void 0),k1(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new z_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Ip(t,e,n){return(e=RRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RRe(t){var e=ERe(t,"string");return typeof e=="symbol"?e:e+""}function ERe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y_ extends Ni{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Ip(this,"changes",void 0),Ip(this,"selected",void 0),Ip(this,"countCols",void 0),Ip(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new Y_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=rr(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=rr(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function $1(t,e,n){return(e=TRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TRe(t){var e=MRe(t,"string");return typeof e=="symbol"?e:e+""}function MRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G_ extends Ni{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),$1(this,"conditionsStack",void 0),$1(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new G_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function _Re(t,e,n){return(e=xRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xRe(t){var e=PRe(t,"string");return typeof e=="symbol"?e:e+""}function PRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K_ extends Ni{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),_Re(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new K_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function WV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return ge(r,i,l=>{ge(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Rs(t,e,n){return(e=IRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IRe(t){var e=ORe(t,"string");return typeof e=="symbol"?e:e+""}function ORe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q_ extends Ni{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Rs(this,"index",void 0),Rs(this,"indexes",void 0),Rs(this,"data",void 0),Rs(this,"amount",void 0),Rs(this,"headers",void 0),Rs(this,"columnPositions",void 0),Rs(this,"rowPositions",void 0),Rs(this,"fixedColumnsStart",void 0),Rs(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return ge(l.length-1,g=>{const p=[],C=l[g];ge(u,c,E=>{p.push(C[e.toPhysicalColumn(E)])}),h.push(p)}),ge(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&ge(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new q_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:WV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Xe(this.data[c],o));const l=Xe(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),x(e.getSourceDataArray(),(c,h)=>{x(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&x(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function bc(t,e,n){return(e=ARe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ARe(t){var e=HRe(t,"string");return typeof e=="symbol"?e:e+""}function HRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X_ extends Ni{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),bc(this,"index",void 0),bc(this,"data",void 0),bc(this,"fixedRowsBottom",void 0),bc(this,"fixedRowsTop",void 0),bc(this,"rowIndexesSequence",void 0),bc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=rr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new X_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:WV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function L1(t,e,n){return(e=NRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NRe(t){var e=DRe(t,"string");return typeof e=="symbol"?e:e+""}function DRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J_ extends Ni{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),L1(this,"rows",void 0),L1(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new J_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),k_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function kRe(t,e,n){return(e=$Re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Re(t){var e=LRe(t,"string");return typeof e=="symbol"?e:e+""}function LRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z_ extends Ni{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),kRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new Z_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function FRe(t,e){[B_,W_,j_,U_,z_,Y_,G_,K_,q_,X_,J_,Z_].forEach(n=>n.startRegisteringEvents(t,e))}function VRe(t,e){BRe(t,e),e.add(t)}function BRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DS(t,e,n){return(e=WRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WRe(t){var e=jRe(t,"string");return typeof e=="symbol"?e:e+""}function jRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const F1="undoRedo",URe="undoRedo",zRe=1e3;oe.getSingleton().register("beforeUndo");oe.getSingleton().register("afterUndo");oe.getSingleton().register("beforeRedo");oe.getSingleton().register("afterRedo");const V1=new Set;var Op=new WeakSet;class YRe extends tt{static get PLUGIN_KEY(){return URe}static get PLUGIN_PRIORITY(){return zRe}static get SETTING_KEYS(){return!0}constructor(e){super(e),VRe(this,Op),DS(this,"doneActions",[]),DS(this,"undoneActions",[]),DS(this,"ignoreNewActions",!1),FRe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kS(Op,e,GRe).call(e,...r)}),this.registerShortcuts(),kS(Op,this,KRe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),kS(Op,this,qRe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:F1};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(F1)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=rr(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=rr(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function GRe(t,e){e==="loadData"&&this.clear()}function KRe(){const t=e=>{V1.has(e)||(at(mt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),V1.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function qRe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function XRe(){et(rf),et(nce),et(of),et(Hce),et(Bce),et(cF),et(khe),et(Cde),et(by),et(Pfe),et(tge),et(uge),et(Ey),et(zge),et(Vpe),et(ywe),et(Ywe),et(ive),et(pve),et(_ve),et($ve),et(tye),et(cye),et(tCe),et(HCe),et(LCe),et(cbe),et(Xbe),et(ySe),et(xSe),et(WSe),et(JSe),et(lRe),et(YRe)}function JRe(){Mae(),qle(),iue(),Eue(),XRe()}function ZRe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var $S,LS,FS,VS,BS;JRe();ZRe(Me);Me.__GhostTable=C_;Me._getListenersCounter=_Z;Me._getRegisteredMapsCounter=Gre;Me.EventManager=_i;const QRe=[P8,$J,Mre,Jle,NJ,wJ,H8,TQ,HJ,D8,VJ,EQ],e0e=[fJ,BJ];Me.helper={};Me.dom={};x(QRe,t=>{x(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Me.helper[e]=t[e])})});x(e0e,t=>{x(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Me.dom[e]=t[e])})});Me.cellTypes=($S=Me.cellTypes)!==null&&$S!==void 0?$S:{};x(Zie(),t=>{Me.cellTypes[t]=QM(t)});Me.cellTypes.registerCellType=gi;Me.cellTypes.getCellType=QM;Me.editors=(LS=Me.editors)!==null&&LS!==void 0?LS:{};x(bZ(),t=>{Me.editors[`${nr(t)}Editor`]=Hw(t)});Me.editors.registerEditor=Or;Me.editors.getEditor=Hw;Me.renderers=(FS=Me.renderers)!==null&&FS!==void 0?FS:{};x(VQ(),t=>{const e=Nw(t);t==="base"&&(Me.renderers.cellDecorator=e),Me.renderers[`${nr(t)}Renderer`]=e});Me.renderers.registerRenderer=Gr;Me.renderers.getRenderer=Nw;Me.validators=(VS=Me.validators)!==null&&VS!==void 0?VS:{};x(jQ(),t=>{Me.validators[`${nr(t)}Validator`]=iT(t)});Me.validators.registerValidator=Jl;Me.validators.getValidator=iT;Me.plugins=(BS=Me.plugins)!==null&&BS!==void 0?BS:{};x(rT(),t=>{Me.plugins[t]=bg(t)});Me.plugins[`${nr(tt.PLUGIN_KEY)}Plugin`]=tt;Me.plugins.registerPlugin=et;Me.plugins.getPlugin=bg;function Xi(t){if(typeof t!="object"||t===null)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){if(console.warn("JSON.stringify를 사용한 deepClone 실패, 수동 클론 시도:",e),Array.isArray(t))return t.map(r=>Xi(r));const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=Xi(t[r]));return n}}let Cf=null,Wt=new Map,Ic={row:-1,col:-1,time:0};function Es(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return t===void 0?(o="undefined",s.readOnly=!1):typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function ur(t,e,n){let r=[],i=!0,o=new Map;const s={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback},a=n.dataPathString||"";if(Array.isArray(t)){const l=t.length>0?t[0]:null;if(l&&typeof l=="object"&&l!==null&&!Array.isArray(l)){let u=Object.keys(l);if(u.length===0){for(let c=1;c<t.length;c++)if(t[c]&&typeof t[c]=="object"&&Object.keys(t[c]).length>0){u=Object.keys(t[c]);break}}i=u.length>0?u:t.length>0?["(내용 없음)"]:["새 열"],t.forEach((c,h)=>{const d=[],f=typeof c=="object"&&c!==null?c:{};i.forEach((g,p)=>{const C=f[g],E=`${a}[${h}]`,{displayValue:y,cellMeta:T}=Es(C,E,g,!1,s);d.push(y),o.set(`${h}-${p}`,T)}),r.push(d)})}else i=["Index","Value"],r=t.map((u,c)=>{const h=a,{displayValue:d,cellMeta:f}=Es(c,h,String(c),!0,s),{displayValue:g,cellMeta:p}=Es(u,h,String(c),!1,s);return o.set(`${c}-0`,f),o.set(`${c}-1`,p),[d,g]})}else if(typeof t=="object"&&t!==null){const l=Object.keys(t);if(l.length>0&&l.every(c=>Array.isArray(t[c]))){let c=0;l.forEach(d=>{c=Math.max(c,t[d].length)});const h=["항목 (Key)"];for(let d=0;d<c;d++)h.push(String(d));i=h,r=l.map((d,f)=>{const g=t[d],p=[],C=a,{displayValue:E,cellMeta:y}=Es(d,C,d,!0,s);p.push(E),o.set(`${f}-0`,y);for(let T=0;T<c;T++)if(T<g.length){const _=g[T],I=`${a?a+".":""}${d}`,{displayValue:M,cellMeta:P}=Es(_,I,String(T),!1,s);p.push(M),o.set(`${f}-${1+T}`,P)}else p.push(""),o.set(`${f}-${1+T}`,{readOnly:!0,originalValue:null,isPadding:!0});return p})}else i=["항목 (Key)","값 (Value)"],r=l.map((c,h)=>{const d=t[c],f=a,{displayValue:g,cellMeta:p}=Es(c,f,c,!0,s),{displayValue:C,cellMeta:E}=Es(d,f,c,!1,s);return o.set(`${h}-0`,p),o.set(`${h}-1`,E),[g,C]})}else{i=["항목","값"];const l=e||(t==null?String(t):"Value"),u=a,{displayValue:c,cellMeta:h}=Es(l,u,"",!0,s),{displayValue:d,cellMeta:f}=Es(t,u,"",!1,s);o.set("0-0",h),o.set("0-1",f),r=[[c,d]]}return{preparedHotData:r,preparedColHeaders:i,preparedCellMetaMap:o}}function jV(){return Cf&&(Cf.destroy(),Cf=null),Wt.clear(),Ic={row:-1,col:-1,time:0},null}function t0e(t,e,n){const r=n.tableViewDomElement;jV(),r&&(r.innerHTML="");const{preparedHotData:i,preparedColHeaders:o,preparedCellMetaMap:s}=ur(t,e,n);return Wt=s,r?(Cf=new Me(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{view_key_content:{name:"내용 보기 (View Content)",hidden:function(){const l=this.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row;if(u.col!==0||typeof t!="object"||t===null||Array.isArray(t))return!0;const d=Object.keys(t);if(c>=d.length)return!0;const f=d[c],g=t[f];return!(typeof g=="object"&&g!==null)},callback:function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start){console.error("View Content callback: 유효하지 않은 selection 객체입니다.",l);return}const h=l[0].start.row,d=Object.keys(t);if(h>=d.length){console.error("View Content callback: 행 인덱스가 범위를 벗어났습니다.",h,d);return}const f=d[h],g=t[f];if(typeof g!="object"||g===null){ye({title:"오류",text:"내용을 볼 수 있는 대상(객체/배열)이 아닙니다.",icon:"error",showCancelButton:!1,hotInstance:u});return}const p=n.dataPathString||"",C=p?`${p}.${f}`:f;n.displayTableCallback(g,f,n.rootJsonData,C)}},row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입",hidden:function(){const a=this,l=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(c=>Array.isArray(t[c])),u=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(l){const c=a.getSelectedRangeLast();return!c||c.from.col===0}return!u},callback:async function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start)return;const c=l[0].start.col,h=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(f=>Array.isArray(t[f])),d=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(h){if(c===0){ye({title:"알림",text:"'항목 (Key)' 열 왼쪽에는 열을 추가할 수 없습니다.",icon:"info",hotInstance:u});return}const f=c-1;let g=!1;if(Object.keys(t).forEach(p=>{Array.isArray(t[p])&&f>=0&&f<=t[p].length&&(t[p].splice(f,0,null),g=!0)}),g){n.refreshTreeViewCallback("col_inserted_expanded_array_view");const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=ur(t,e,n);Wt=E,u.updateSettings({colHeaders:C}),u.loadData(p)}}else d?u.alter("insert_col_start",c,1,"custom_insert_col_left_array_of_objects"):ye({title:"작업 불가",text:"현재 데이터 보기 방식에서는 이 열 삽입 작업을 지원하지 않습니다.",icon:"error",hotInstance:u})}},col_right:{name:"오른쪽에 열 삽입",hidden:function(){const a=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(u=>Array.isArray(t[u])),l=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);return!(a||l)},callback:async function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start)return;const c=l[0].start.col,h=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(f=>Array.isArray(t[f])),d=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(h){const f=c===0?0:c;let g=!1;if(Object.keys(t).forEach(p=>{Array.isArray(t[p])&&(t[p].splice(f,0,null),g=!0)}),g){n.refreshTreeViewCallback("col_inserted_expanded_array_view");const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=ur(t,e,n);Wt=E,u.updateSettings({colHeaders:C}),u.loadData(p)}}else d?u.alter("insert_col_start",c+1,1,"custom_insert_col_right_array_of_objects"):ye({title:"작업 불가",text:"현재 데이터 보기 방식에서는 이 열 삽입 작업을 지원하지 않습니다.",icon:"error",hotInstance:u})}},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const u=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(h=>Array.isArray(t[h])),c=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(u){if(l.from.col===0)return!0;const h=Object.keys(t).find(d=>Array.isArray(t[d]));return!!(h&&t[h]&&l.from.col>t[h].length)}if(c){const h=a.getColHeader();return!(Array.isArray(h)&&h.length>0&&l.from.col<h.length)}return!0},callback:async function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start)return;const c=l[0].start.col,h=typeof t=="object"&&t!==null&&!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).every(f=>Array.isArray(t[f])),d=Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]);if(h){if(c===0){ye({title:"오류",text:"'항목 (Key)' 열은 삭제할 수 없습니다.",icon:"error",hotInstance:u});return}const f=c-1;let g=!1;if(Object.keys(t).forEach(p=>{Array.isArray(t[p])&&f>=0&&f<t[p].length&&(t[p].splice(f,1),g=!0)}),g){n.refreshTreeViewCallback("col_removed_expanded_array_view");const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=ur(t,e,n);Wt=E,u.updateSettings({colHeaders:C}),u.loadData(p)}}else d?u.alter("remove_col",c,1,"custom_remove_col_array_of_objects"):ye({title:"작업 불가",text:"현재 데이터 보기 방식에서는 이 열 삭제 작업을 지원하지 않습니다.",icon:"error",hotInstance:u})}},"---------":Me.plugins.ContextMenu.SEPARATOR,duplicate_row:{name:"선택 행 복제",hidden:function(){return!this.getSelectedRangeLast()||!(Array.isArray(t)||typeof t=="object"&&t!==null&&!Array.isArray(t))},callback:async function(a,l){const u=this,c=l[0].start.row;if(Array.isArray(t)){if(c>=0&&c<t.length){const h=Xi(t[c]);t.splice(c+1,0,h),n.refreshTreeViewCallback("row_duplicated_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=ur(t,e,n);Wt=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}else if(typeof t=="object"&&t!==null){const h=Object.keys(t);if(c<0||c>=h.length)return;const d=h[c];let f=d+"_복제본",g=f,p=1;for(;t.hasOwnProperty(g);)g=`${f}_${p++}`;const C=await Zi({title:"새 키 입력 (행 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:E=>{const y=E.trim();return y?y!==d&&t.hasOwnProperty(y)?"이미 사용 중인 키입니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u});if(C.isConfirmed&&C.value!==void 0){const E=C.value.trim(),y=Xi(t[d]),T={};for(const P of Object.keys(t))T[P]=t[P],P===d&&(T[E]=y);Object.keys(t).forEach(P=>delete t[P]),Object.assign(t,T),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered");const{preparedHotData:_,preparedColHeaders:I,preparedCellMetaMap:M}=ur(t,e,n);Wt=M,u.updateSettings({colHeaders:I}),u.loadData(_)}}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return!this.getSelectedRangeLast()||!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0]))},callback:async function(a,l){const u=this,c=l[0].start.col,h=u.getColHeader();if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])&&Array.isArray(h)&&c>=0&&c<h.length){const d=h[c];if(typeof d!="string")return;let f=d+"_복제본",g=f,p=1;for(;t[0].hasOwnProperty(g);)g=`${f}_${p++}`;const C=await Zi({title:"새 열 키 입력 (열 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:E=>{const y=E.trim();return y?t.length>0&&t[0].hasOwnProperty(y)&&y!==d?"첫 번째 객체에 이미 해당 키가 존재합니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u});if(C.isConfirmed&&C.value!==void 0){const E=C.value.trim();t.forEach(I=>{if(typeof I=="object"&&I!==null){const M=I.hasOwnProperty(d)?Xi(I[d]):null,P={};let z=!1;for(const W in I)I.hasOwnProperty(W)&&(P[W]=I[W],W===d&&(P[E]=M,z=!0));z||(P[E]=M),Object.keys(I).forEach(W=>delete I[W]),Object.assign(I,P)}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered");const{preparedHotData:y,preparedColHeaders:T,preparedCellMetaMap:_}=ur(t,e,n);Wt=_,u.updateSettings({colHeaders:T}),u.loadData(y)}}}},set_template:{name:"템플릿으로 채우기",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=Wt.get(`${c}-${h}`);if(d&&d.isPadding)return!0;const f=a.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt};return Ld(c,h,g)===null},callback:async function(a,l){const u=this;u&&typeof u.deselectCell=="function"&&u.deselectCell();const c=n.getTemplates();if(!c||c.length===0){ye({title:"알림",text:"사용 가능한 템플릿이 없습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}const h={};c.forEach((I,M)=>{h[`tpl_idx_${M}`]=I.name});const{value:d}=await ei.fire({title:"템플릿 선택",input:"select",inputOptions:h,inputPlaceholder:"적용할 템플릿을 선택하세요",showCancelButton:!0,confirmButtonText:"다음",cancelButtonText:"취소",customClass:{popup:"custom-swal-popup"}});if(!d){ye({title:"취소됨",text:"템플릿 선택이 취소되었습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}const f=parseInt(d.replace("tpl_idx_",""),10),g=c[f],p=g.value,C=await ei.fire({title:"템플릿 적용 방식",text:`"${g.name}" 템플릿을 선택한 셀에 어떻게 적용하시겠습니까?`,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"완전 덮어쓰기",denyButtonText:"병합 (규칙 적용)",cancelButtonText:"취소",icon:"question",customClass:{popup:"custom-swal-popup"}});let E=null;if(C.isConfirmed)E="overwrite";else if(C.isDenied)E="merge";else{ye({title:"취소됨",text:"템플릿 적용 방식 선택이 취소되었습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}const y=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;let T=!1;const _=u.getColHeader();for(const I of l){const M=I.start,P=I.end;if(!M||!P){console.warn("Skipping invalid range object in selection:",I);continue}const z=Math.min(M.row,P.row),W=Math.max(M.row,P.row),V=Math.min(M.col,P.col),q=Math.max(M.col,P.col);for(let Z=z;Z<=W;Z++)for(let ee=V;ee<=q;ee++){const te={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(_)?_:_===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt},ce=Ld(Z,ee,te);if(ce===null)continue;const je=n.getObjectByPathCallback(y,ce);let we;if(E==="overwrite")we=Xi(p);else{const Ae=typeof je=="object"&&je!==null&&!Array.isArray(je),ot=typeof p=="object"&&p!==null&&!Array.isArray(p);if(Ae&&ot){we={};const wn=Object.keys(p);for(const Ue of wn)Object.prototype.hasOwnProperty.call(p,Ue)&&(Object.prototype.hasOwnProperty.call(je,Ue)?we[Ue]=Xi(je[Ue]):we[Ue]=Xi(p[Ue]))}else we=Xi(p)}n.updateJsonDataCallback(ce,JSON.stringify(we),!0),T=!0}}if(T){let I=t;n.dataPathString?I=n.getObjectByPathCallback(y,n.dataPathString):I=y,I===void 0&&(I={});const{preparedHotData:M,preparedColHeaders:P,preparedCellMetaMap:z}=ur(I,e,n);Wt=z,u.updateSettings({colHeaders:P}),u.loadData(M),n.refreshTreeViewCallback("template_applied_batch"),ye({title:"완료",text:"선택한 셀에 템플릿이 적용되었습니다.",icon:"success",showCancelButton:!1,hotInstance:u})}else ye({title:"알림",text:"템플릿을 적용할 유효한 셀이 없거나 변경사항이 없습니다.",icon:"info",showCancelButton:!1,hotInstance:u})}},add_as_template:{name:"선택 셀 값을 템플릿에 추가",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=a.getColHeader(),f={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(d)?d:d===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt},g=Ld(c,h,f);if(g===null)return!0;const p=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,C=n.getObjectByPathCallback(p,g);return!(typeof C=="object"&&C!==null)},callback:async function(a,l){const u=this,c=l[0].start,h=c.row,d=c.col,f=u.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt},p=Ld(h,d,g);if(p===null)return;const C=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,E=n.getObjectByPathCallback(C,p);if(!(typeof E=="object"&&E!==null)){ye({title:"알림",text:"객체 또는 배열 형식의 값만 템플릿으로 추가할 수 있습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}u&&typeof u.deselectCell=="function"&&u.deselectCell();const{value:y}=await Zi({title:"새 템플릿 이름 입력 (셀 값)",inputLabel:"저장할 템플릿의 이름을 입력하세요:",inputValue:"",confirmButtonText:"추가",inputValidator:T=>{const _=T.trim();return _?n.getTemplates().some(I=>I.name===_)?"이미 사용중인 템플릿 이름입니다.":null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:u});if(y&&y.trim()){const T=Array.isArray(E)?"array":"object",_=Xi(E),I=n.addTemplate(y.trim(),T,_);ye(I===!0?{title:"성공",text:`템플릿 "${y.trim()}"이(가) 추가되었습니다.`,icon:"success",showCancelButton:!1,hotInstance:u}:I==="duplicate_name"?{title:"오류",text:`템플릿 이름 "${y.trim()}"이(가) 이미 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:u}:{title:"오류",text:"템플릿 추가에 실패했습니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},add_current_view_as_template:{name:"현재 테이블 뷰를 템플릿에 추가",hidden:function(){return!(typeof t=="object"&&t!==null)},callback:async function(){const a=this;if(a&&typeof a.deselectCell=="function"&&a.deselectCell(),!(typeof t=="object"&&t!==null)){ye({title:"알림",text:"템플릿으로 추가할 수 있는 데이터(객체/배열)가 아닙니다.",icon:"info",showCancelButton:!1,hotInstance:a});return}const{value:l}=await Zi({title:"새 템플릿 이름 입력 (현재 뷰)",inputLabel:"저장할 템플릿의 이름을 입력하세요:",inputValue:e?`${e}_view_template`:"current_view_template",confirmButtonText:"추가",inputValidator:u=>{const c=u.trim();return c?n.getTemplates().some(h=>h.name===c)?"이미 사용중인 템플릿 이름입니다.":null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:a});if(l&&l.trim()){const u=Array.isArray(t)?"array":"object",c=Xi(t),h=n.addTemplate(l.trim(),u,c);ye(h===!0?{title:"성공",text:`템플릿 "${l.trim()}"이(가) 현재 뷰를 기반으로 추가되었습니다.`,icon:"success",showCancelButton:!1,hotInstance:a}:h==="duplicate_name"?{title:"오류",text:`템플릿 이름 "${l.trim()}"이(가) 이미 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:a}:{title:"오류",text:"템플릿 추가에 실패했습니다.",icon:"error",showCancelButton:!1,hotInstance:a})}}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(a,l,u){const c={},h=Wt.get(`${a}-${l}`);return h&&(c.readOnly=h.readOnly,h.isDrillable&&(c.renderer=function(d,f,g,p,C,E){Me.renderers.TextRenderer.apply(this,arguments),f.style.color="#007bff",f.style.textDecoration="underline",f.style.cursor="pointer"})),c},afterOnCellMouseDown:function(a,l,u){if(a.button!==0)return;const c=new Date().getTime(),{row:h,col:d}=l,f=Wt.get(`${h}-${d}`),g=300;let p=!1;if(f&&h===Ic.row&&d===Ic.col&&c-Ic.time<g?(p=!0,Ic={row:-1,col:-1,time:0}):Ic={row:h,col:d,time:c},p){let C=!1;const E=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(E)&&E.length>0&&E[0]==="항목 (Key)"&&d===0&&f&&(C=!0),C){const y=f.originalKey,T=t,_=n.dataPathString;Zi({title:`키 이름 변경: "${y}"`,inputValue:y,confirmButtonText:"저장",inputValidator:I=>{const M=I.trim();return M?T.hasOwnProperty(M)&&M!==y?"이미 사용 중인 키입니다!":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:this}).then(I=>{if(I.isConfirmed&&I.value!==void 0){const M=I.value.trim();M!==y&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(_,y,M,T)}});return}}if(f&&f.isDrillable&&f.originalValue!==void 0){const C=typeof t=="object"&&t!==null&&!Array.isArray(t)&&d===0&&f&&f.isDrillable;(!p||p&&!C&&f.drillPath)&&typeof f.originalValue=="object"&&f.originalValue!==null&&n.displayTableCallback(f.originalValue,f.originalKey,n.rootJsonData,f.drillPath)}},afterChange:function(a,l){if(l==="loadData"||!a||!Array.isArray(a)||a.length===0)return;const u=l==="CopyPaste.paste"||l==="Autofill.fill"||a.length>1,c=this.getColHeader();a.forEach(([h,d,f,g])=>{let p=-1;if(typeof d=="number"?p=d:typeof d=="string"&&Array.isArray(c)&&(p=c.indexOf(d)),p===-1)if(typeof d=="number"&&c===!0)p=d;else{console.warn("afterChange: 컬럼 인덱스 결정 불가:",h,d,c);return}const C={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(c)?c:c===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:Wt};let E=Ld(h,p,C);E!==null&&n.updateJsonDataCallback(E,String(g),u,f)}),u&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_update_handsontable_afterChange")},afterCreateRow:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)){const f=c.getColHeader();for(let g=0;g<l;g++){let p=null;Array.isArray(f)&&f.length>0&&(f.length!==2||f[0]!=="Index"||f[1]!=="Value")&&(p={},f.forEach(C=>{typeof C=="string"&&(p[C]=null)})),h.splice(a+g,0,p)}d=!0,d&&n.refreshTreeViewCallback("row_added_array_hot")}else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){(async()=>{let f={...h},g=0;for(let y=0;y<l;y++){const T=a+y,_=await Zi({title:`새 항목 키 입력 (${y+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:I=>{const M=I.trim();return M?f.hasOwnProperty(M)?"이미 사용 중인 키입니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(_.isConfirmed&&_.value!==void 0){const I=_.value.trim(),M=null,P=Object.keys(f),z={};let W=!1;for(let V=0;V<P.length;V++)V===T&&!W&&(z[I]=M,W=!0),z[P[V]]=f[P[V]];W||(z[I]=M),f=z,g++}else break}g>0&&(Object.keys(h).forEach(y=>delete h[y]),Object.assign(h,f),d=!0,n.refreshTreeViewCallback("key_added_object_hot_ordered"));const{preparedHotData:p,preparedColHeaders:C,preparedCellMetaMap:E}=ur(h,e,n);Wt=E,c.updateSettings({colHeaders:C}),c.loadData(p)})();return}if(d||u!=="loadData"){const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=ur(h,e,n);Wt=p,c.updateSettings({colHeaders:g}),c.loadData(f)}},afterCreateCol:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){(async()=>{for(let C=0;C<l;C++){const E=a+C,y=await Zi({title:`새 열(속성)의 키 입력 (${C+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:T=>{const _=T.trim();return _?h[0].hasOwnProperty(_)?"첫 번째 객체에 이미 해당 키가 존재합니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(y.isConfirmed&&y.value!==void 0){const T=y.value.trim();h.forEach(_=>{if(typeof _=="object"&&_!==null){const I=Object.keys(_),M={};let P=!1;if(E>=I.length)_[T]=null;else{for(let z=0;z<I.length;z++)z===E&&!P&&(M[T]=null,P=!0),M[I[z]]=_[I[z]];P||(M[T]=null),Object.keys(_).forEach(z=>delete _[z]),Object.assign(_,M)}}}),d=!0}else break}d&&n.refreshTreeViewCallback("col_added_array_of_obj_hot_ordered");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=ur(h,e,n);Wt=p,c.updateSettings({colHeaders:g}),c.loadData(f)})();return}else if(typeof h=="object"&&h!==null&&!Array.isArray(h))ye({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c}).then(()=>{const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=ur(h,e,n);Wt=p,c.updateSettings({colHeaders:g}),c.loadData(f)});else{ye({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c});const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=ur(h,e,n);Wt=p,c.updateSettings({colHeaders:g}),c.loadData(f)}},beforeRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;if(u.sort((d,f)=>f-d),Array.isArray(h))u.forEach(d=>{d>=0&&d<h.length&&h.splice(d,1)});else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=Object.keys(h),f=u.map(g=>d[g]).filter(g=>g!==void 0);f.length>0&&f.forEach(g=>{delete h[g]})}else return!1;return!0},afterRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef||c==="ContextMenu.remove_row_custom")return;const h=this;let d=t;n.refreshTreeViewCallback("row_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=ur(d,e,n);Wt=p,h.updateSettings({colHeaders:g}),h.loadData(f)},beforeRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;const d=this.getColHeader();if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){if(!Array.isArray(d))return ye({title:"오류",text:"열 헤더 정보를 가져올 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1;u.sort((f,g)=>g-f),u.forEach(f=>{if(f>=0&&f<d.length){const g=d[f];typeof g=="string"&&h.forEach(p=>{typeof p=="object"&&p!==null&&delete p[g]})}})}else return typeof h=="object"&&h!==null&&!Array.isArray(h)?(ye({title:"오류",text:"이 뷰에서 특정 열 부분 삭제는 지원되지 않습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1):(ye({title:"오류",text:"현재 데이터 구조에서는 열을 삭제할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1);return!0},afterRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return;const h=this;let d=t;n.refreshTreeViewCallback("col_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:p}=ur(d,e,n);Wt=p,h.updateSettings({colHeaders:g}),h.loadData(f)}}),Cf):(console.error("Handsontable 컨테이너를 찾을 수 없습니다."),null)}function Ld(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a,cellMetaMap:l}=n;let u="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const c=o[e];u=`[${t}].${c}`}else return null;else if(e===1)u=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){const c=l.get(`${t}-0`);if(!c||c.originalKey===void 0)return null;const h=c.originalKey;if(e===0)return null;const d=Array.isArray(o)&&o.length>1&&o[0]==="항목 (Key)"&&!isNaN(parseInt(o[1],10)),f=Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)";if(d)if(e>0&&e<o.length){const g=o[e],p=r[h];if(Array.isArray(p)){const C=l.get(`${t}-${e}`);if(C&&C.isPadding)return null;u=`.${h}[${g}]`}else return null}else return null;else if(f)if(e===1)u=`.${h}`;else return null;else return Object.keys(r).length===0&&Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)",null}else return t===0&&e===1?i||"":null;return i?u.startsWith(".")||u.startsWith("[")?i+u:u?i+"."+u:i:u.startsWith(".")?u.substring(1):u}let Ji=[],ro=-1;const n0e=30;let Q_=!1;function r0e(){Ji=[],ro=-1,Q_=!1}function i0e(t){if(Q_)return;const{dataPathString:e,dataKeyName:n}=t,r=Ji[ro];r&&r.dataPathString===e&&r.dataKeyName===n||(ro<Ji.length-1&&(Ji=Ji.slice(0,ro+1)),Ji.push({dataPathString:e,dataKeyName:n}),ro=Ji.length-1,Ji.length>n0e&&(Ji.shift(),ro--))}function o0e(t){let e=!1,n=ro;return t==="back"&&ro>0?(n--,e=!0):t==="forward"&&ro<Ji.length-1&&(n++,e=!0),e?(ro=n,Ji[ro]):null}function B1(t){Q_=t}function s0e(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function a0e(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=s0e(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function W1(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}const UV="userJsonEditorTemplates_v1";let hn=[];const Yo=[{name:"Null 값 (Null Value)",type:"null",value:null,isDefault:!0},{name:"빈 객체 (Empty Object)",type:"object",value:{},isDefault:!0},{name:"빈 배열 (Empty Array)",type:"array",value:[],isDefault:!0}];function ex(){try{const t=localStorage.getItem(UV);if(t){const e=JSON.parse(t);if(Array.isArray(e)){const n=e.filter(s=>!s.isDefault),r=new Set(Yo.map(s=>s.name)),i=[],o=new Set;n.forEach(s=>{!r.has(s.name)&&!o.has(s.name)&&(i.push({...s,isDefault:!1}),o.add(s.name))}),hn=[...Yo,...i]}else hn=[...Yo]}else hn=[...Yo]}catch(t){console.error("Error loading templates from localStorage:",t),hn=[...Yo]}return kg(),hn}function zV(){return hn.length===0&&ex(),[...hn]}function l0e(t,e,n){if(!t||!e||n===void 0)return!1;const r=t.trim();if(hn.some(o=>o.name===r))return"duplicate_name";if(Yo.some(o=>o.name===r))return"default_conflict";const i={name:r,type:e,value:JSON.parse(JSON.stringify(n)),isDefault:!1};return hn.push(i),kg(),!0}function kg(){try{const t=hn.map(e=>({...e,isDefault:Yo.some(n=>n.name===e.name&&n.isDefault)}));localStorage.setItem(UV,JSON.stringify(t))}catch(t){console.error("Error saving templates to localStorage:",t)}}function u0e(t){if(!Array.isArray(t))return 0;const n=t.map(s=>{const a=s.type==="object"||s.type==="array"?s.type:"object";return{name:String(s.name||`템플릿_${Date.now()}`).trim(),type:a,value:JSON.parse(JSON.stringify(s.value||(a==="array"?[]:{}))),isDefault:!1}}).filter(s=>s.name).filter(s=>!Yo.some(a=>a.name===s.name)),r=hn.filter(s=>!s.isDefault),i=new Map;r.forEach(s=>i.set(s.name,s)),n.forEach(s=>i.set(s.name,{...s,isDefault:!1}));const o=Array.from(i.values());return hn=[...Yo,...o],kg(),n.length}function bf(){return hn.length===0&&ex(),hn.filter(t=>!t.isDefault)}function c0e(t,e){const n=t.trim(),r=e.trim();if(!r)return"empty_name";const i=hn.findIndex(o=>o.name===n&&!o.isDefault);return i===-1?"not_found":hn.some((o,s)=>o.name===r&&s!==i)?"duplicate_name":Yo.some(o=>o.name===r)?"default_conflict":(hn[i].name=r,kg(),!0)}function h0e(t){const e=t.trim(),n=hn.filter(i=>!i.isDefault).length;return hn=hn.filter(i=>!(!i.isDefault&&i.name===e)),hn.filter(i=>!i.isDefault).length<n?(kg(),!0):!1}ex();const YV="selected_theme_json_editor",vv=[{buttonId:"theme-btn-1",themeClass:"theme-soft-dark",name:"Soft Dark"},{buttonId:"theme-btn-2",themeClass:"theme-classic-purple",name:"Classic Purple Light"},{buttonId:"theme-btn-3",themeClass:"theme-soft-mint",name:"Soft Mint"}],GV="theme-classic-purple";let WS=null,lu=null,Oc=null;function S0(t){Oc||(Oc=document.body),vv.forEach(n=>{Oc.classList.contains(n.themeClass)&&Oc.classList.remove(n.themeClass)});let e=GV;t&&vv.some(n=>n.themeClass===t)&&(e=t),Oc.classList.add(e),localStorage.setItem(YV,e),d0e(e)}function d0e(t){lu&&lu.forEach(e=>{const n=vv.find(r=>r.buttonId===e.id);n&&n.themeClass===t?e.classList.add("active-theme"):e.classList.remove("active-theme")})}function f0e(){lu&&lu.forEach(t=>{t.addEventListener("click",()=>{const e=vv.find(n=>n.buttonId===t.id);e&&S0(e.themeClass)})})}function g0e(){if(Oc=document.body,WS=document.querySelector(".theme-switcher"),!WS){console.warn("Theme switcher element not found by theme-switcher.js during initialization.");return}if(lu=WS.querySelectorAll(".theme-button"),!lu||lu.length===0){console.warn("Theme buttons not found by theme-switcher.js during initialization.");return}f0e();const t=localStorage.getItem(YV);S0(t!==null?t:GV),console.log("Theme switcher initialized.")}let Ee=null,uu=null,Ds,Sf,Qn,Ne=null;function m0e(t){if(typeof t!="string")throw new TypeError("입력값은 문자열이어야 합니다.");try{return encodeURIComponent(t)}catch(e){throw console.error("URL 인코딩 중 오류 발생:",e),e}}function p0e(t){if(typeof t!="string")throw new TypeError("입력값은 문자열이어야 합니다.");try{return decodeURIComponent(t)}catch(e){throw console.error("URL 디코딩 중 오류 발생:",e),e}}async function KV(){const t=async(n="",r="success")=>{n&&We&&Pt(We,n,2500),await new Promise(i=>setTimeout(i,50)),KV()},e=bf();await Aj({userTemplates:e,callbacks:{onViewRequest:async n=>{const r=bf().find(i=>i.name===n);r&&await Oj({templateName:r.name,templateValue:r.value,hotInstance:Ne}),await t("템플릿 내용을 확인했습니다.","info")},onRenameRequest:async n=>{if(!bf().find(o=>o.name===n)){await t("변경할 템플릿을 찾지 못했습니다.","error");return}const i=await Zi({title:`'${n}' 템플릿 이름 변경`,inputLabel:"새로운 템플릿 이름을 입력하세요:",inputValue:n,confirmButtonText:"변경 저장",inputValidator:o=>{const s=o.trim();return s?s===n?null:zV().some(a=>a.name===s)?`'${s}' 이름은 이미 사용 중입니다.`:null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:Ne});if(i.isConfirmed&&typeof i.value=="string"){const o=i.value.trim();if(o===n){await t("이름이 변경되지 않았습니다.","info");return}const s=c0e(n,o);if(s===!0)await t(`템플릿 '${n}'이(가) '${o}'(으)로 변경되었습니다.`);else{let a="알 수 없는 오류로 이름 변경에 실패했습니다.";s==="empty_name"?a="새 템플릿 이름은 비워둘 수 없습니다.":s==="not_found"?a=`템플릿 '${n}'을(를) 찾을 수 없습니다.`:s==="duplicate_name"?a=`새 이름 '${o}'은(는) 이미 사용 중입니다.`:s==="default_conflict"&&(a=`새 이름 '${o}'은(는) 기본 템플릿 이름과 충돌합니다.`),await ye({title:"이름 변경 오류",text:a,icon:"error",showCancelButton:!1,hotInstance:Ne}),await t("이름 변경 중 문제가 발생했습니다.","error")}}else await t("이름 변경이 취소되었습니다.","info")},onDeleteRequest:async n=>{(await ye({title:`'${n}' 템플릿 삭제`,text:`정말로 '${n}' 템플릿을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`,icon:"warning",showCancelButton:!0,confirmButtonText:"삭제",cancelButtonText:"취소",hotInstance:Ne})).isConfirmed?h0e(n)?await t(`템플릿 '${n}'이(가) 삭제되었습니다.`):(await ye({title:"삭제 오류",text:`템플릿 '${n}' 삭제에 실패했습니다.`,icon:"error",showCancelButton:!1,hotInstance:Ne}),await t("삭제 중 문제가 발생했습니다.","error")):await t("삭제가 취소되었습니다.","info")}},hotInstance:Ne})}function w0e(){const t=document.getElementById("loadBtn");t&&t.addEventListener("click",Py);const e=document.getElementById("saveBtn");e&&e.addEventListener("click",P0e);const n=document.getElementById("minifyBtn");n&&n.addEventListener("click",()=>{if(dt&&dt.value)try{dt.value=rB(dt.value)}catch(y){ze&&(ze.textContent="Minify 오류: "+y.message)}else dt&&(dt.value="")});const r=document.getElementById("uglifyBtn");r&&r.addEventListener("click",()=>{if(dt&&dt.value)try{dt.value=iB(dt.value)}catch(y){ze&&(ze.textContent="Uglify(포맷팅) 오류: "+y.message)}else dt&&(dt.value="")});const i=document.getElementById("diffBtn");i&&i.addEventListener("click",()=>{if(!uu&&!Ee){ye({title:"알림",text:"먼저 JSON 데이터를 로드해주세요.",icon:"info",showCancelButton:!1,hotInstance:Ne});return}if(!uu){ye({title:"알림",text:"로드 시점의 원본 JSON 데이터가 없습니다.",icon:"info",showCancelButton:!1,hotInstance:Ne});return}Ij({title:"JSON 데이터 변경사항",jsonDiffData:{left:uu,right:Ee===null?{}:Ee},buttons:[{text:"닫기",role:"confirm"}],hotInstance:Ne}).catch(T=>{ye({title:"오류",text:"변경점 확인 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne})})});const o=document.getElementById("loadFromFileBtn");o&&o.addEventListener("click",T0e);const s=document.getElementById("saveToFileBtn");s&&s.addEventListener("click",M0e);const a=document.getElementById("saveToCSV");a&&a.addEventListener("click",E0e);const l=document.getElementById("loadFromCSV");l&&l.addEventListener("click",S0e);const u=document.getElementById("loadTemplatesFromFileBtn");u&&u.addEventListener("click",_0e);const c=document.getElementById("saveTemplatesToFileBtn");c&&c.addEventListener("click",x0e);const h=document.getElementById("manageTemplatesBtn");h&&h.addEventListener("click",KV);const d=document.getElementById("encodeUrlBtn");d&&d.addEventListener("click",async()=>{const y=dt?dt.value:"";try{const T=await Px({title:"URL 인코딩",initialInputValue:y,inputLabel:"인코딩할 원본 문자열:",outputLabel:"인코딩된 결과:",actionButtonText:"인코딩 실행",onExecuteAction:_=>{try{return m0e(_)}catch(I){return`오류: ${I.message}`}},confirmButtonText:"결과를 메인 편집기에 복사",cancelButtonText:"팝업 닫기",hotInstance:Ne});T.isConfirmed&&T.formData&&T.formData!==!1?dt&&(dt.value=T.formData,We&&Pt(We,"결과가 메인 편집기에 복사되었습니다.",2e3)):T.isDismissed&&T.dismiss==="cancel"&&We&&Pt(We,"URL 인코딩 작업창을 닫았습니다.",1500,"info")}catch(T){ze&&(ze.textContent="URL 인코딩 팝업 오류: "+T.message),We&&Pt(We,"URL 인코딩 팝업 처리 중 문제가 발생했습니다.",3e3)}});const f=document.getElementById("decodeUrlBtn");f&&f.addEventListener("click",async()=>{const y=dt?dt.value:"";try{const T=await Px({title:"URL 디코딩",initialInputValue:y,inputLabel:"디코딩할 URL 인코딩된 문자열:",outputLabel:"디코딩된 결과:",actionButtonText:"디코딩 실행",onExecuteAction:_=>{try{return p0e(_)}catch(I){return`오류: ${I.message}`}},confirmButtonText:"결과를 메인 편집기에 복사",cancelButtonText:"팝업 닫기",hotInstance:Ne});T.isConfirmed&&T.formData&&T.formData!==!1?dt&&(dt.value=T.formData,We&&Pt(We,"결과가 메인 편집기에 복사되었습니다.",2e3)):T.isDismissed&&T.dismiss==="cancel"&&We&&Pt(We,"URL 디코딩 작업창을 닫았습니다.",1500,"info")}catch(T){ze&&(ze.textContent="URL 디코딩 팝업 오류: "+T.message),We&&Pt(We,"URL 디코딩 팝업 처리 중 문제가 발생했습니다.",3e3)}}),Ds=document.getElementById("searchInput"),Sf=document.getElementById("searchTargetSelect"),Qn=document.getElementById("searchResultsDropdown"),Ds&&Ds.addEventListener("input",U1),Sf&&Sf.addEventListener("change",U1),document.addEventListener("click",y=>{Qn&&Ds&&!Ds.contains(y.target)&&!Qn.contains(y.target)&&(Qn.style.display="none")}),Qn&&Qn.addEventListener("click",y=>y.stopPropagation()),window.addEventListener("mouseup",y=>{(y.button===3||y.button===4)&&(y.preventDefault(),y.button===3?G1("back"):y.button===4&&G1("forward"))}),window.addEventListener("contextmenu",y=>{y.preventDefault()});const g=document.querySelector(".json-control-panel");g?(g.addEventListener("dragover",v0e),g.addEventListener("dragleave",y0e),g.addEventListener("drop",C0e)):console.warn(".json-control-panel 요소를 찾을 수 없어 드래그앤드롭 기능을 활성화할 수 없습니다.");const p=document.querySelector(".main-layout-triple-panel"),C=[document.querySelector(".json-control-panel"),document.querySelector(".tree-view-panel"),document.querySelector(".table-view-panel")],E=[document.getElementById("resizer-1"),document.getElementById("resizer-2")];p&&C.every(y=>y)&&E.every(y=>y)?(j1(p,C,E),window.addEventListener("resize",()=>j1(p,C,E)),E.forEach((y,T)=>{let _=!1,I=0,M=[];y.addEventListener("mousedown",W=>{W.preventDefault(),_=!0,I=W.clientX,M=[C[T].offsetWidth,C[T+1].offsetWidth],document.addEventListener("mousemove",P),document.addEventListener("mouseup",z)});function P(W){if(!_)return;const V=W.clientX-I,q=50;let Z=M[0]+V,ee=M[1]-V;Z<q&&(Z=q,ee=M[0]+M[1]-Z),ee<q&&(ee=q,Z=M[0]+M[1]-ee),C[T].style.flexBasis=`${Z}px`,C[T+1].style.flexBasis=`${ee}px`}function z(){_&&(_=!1,document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",z))}})):console.warn("3-패널 레이아웃에 필요한 요소를 모두 찾을 수 없습니다. 리사이저가 동작하지 않을 수 있습니다."),g0e()}function v0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.add("dragover-active"),t.dataTransfer.dropEffect="copy"}function y0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active")}function C0e(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active");const e=t.dataTransfer.files;if(e.length>0){const n=e[0];if(n.type==="application/json"||n.name.toLowerCase().endsWith(".json")){const r=new FileReader;r.onload=i=>{try{const o=i.target.result;dt?(dt.value=o,Py(),Pt(We,`${n.name} 파일이 드롭되어 로드되었습니다.`,3e3)):ye({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne})}catch(o){ze&&(ze.textContent=`파일 오류 (드롭): ${o.message}`),ye({title:"파일 로드 오류 (드롭)",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Ne})}},r.onerror=()=>{ze&&(ze.textContent="파일을 읽는 중 오류가 발생했습니다 (드롭)."),ye({title:"파일 읽기 오류 (드롭)",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne})},r.readAsText(n)}else ye({title:"잘못된 파일 타입",text:"JSON 파일(.json)만 드롭해주세요.",icon:"warning",showCancelButton:!1,hotInstance:Ne})}}function j1(t,e,n){const r=t.offsetWidth,i=n.reduce((l,u)=>l+u.offsetWidth,0),o=r-i,s=[.15,.15,.7],a=50;if(o>0){let l=Math.max(a,Math.floor(o*s[0])),u=Math.max(a,Math.floor(o*s[1])),c=Math.max(a,o-l-u);if(l+u+c>o&&(c=o-l-u,c<a)){c=a;const h=o-c;l=Math.floor(h*(s[0]/(s[0]+s[1]))),u=h-l,l<a&&(l=a,u=h-l),u<a&&(u=a,l=h-u)}e[0].style.flexBasis=`${l}px`,e[1].style.flexBasis=`${u}px`,e[2].style.flexBasis=`${c}px`}}function U1(){if(!Ds||!Sf||!Qn)return;const t=Ds.value.trim().toLowerCase(),e=Sf.value;if(!t){Qn.innerHTML="",Qn.style.display="none";return}if(Ee==null){W1([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],Qn,t,z1);return}const n=a0e(t,e,Ee);W1(n,Qn,t,z1)}function z1(t){t&&typeof Za=="function"&&t.data!==void 0&&(Za(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString||""),Qn&&(Qn.style.display="none"))}function jS(t){const e=[];let n="",r=!1;for(let i=0;i<t.length;i++){const o=t[i];o==='"'?r&&i+1<t.length&&t[i+1]==='"'?(n+='"',i++):r=!r:o===","&&!r?(e.push(n),n=""):n+=o}return e.push(n),e}function Y1(t){if(typeof t!="string")return t;const e=t.trim();if(e.toLowerCase()==="null")return null;if(e.toLowerCase()==="true")return!0;if(e.toLowerCase()==="false")return!1;if(e==="")return null;if(e!==""&&!isNaN(Number(e))&&(e.includes(".")||/^-?\d+$/.test(e)||String(Number(e))===e.replace(/^0+(?=\d)/,"")))return Number(e);if(e.startsWith("[")&&e.endsWith("]")||e.startsWith("{")&&e.endsWith("}"))try{return JSON.parse(e)}catch{return e}return e}function b0e(t){const e=t.trim().split(/\r\n|\n|\r/);if(e.length===0)return[];let n=-1;for(let l=0;l<e.length;l++)if(e[l].trim()!==""){n=l;break}if(n===-1)return[];let r=jS(e[n]).map((l,u)=>{const c=l.trim();return c===""?`column_${u+1}`:c});const i=r.map(l=>l.toLowerCase()),o=["key","property","name","field","item"];if(r.length===2&&o.includes(i[0])&&i[1]==="value"){const l={};for(let u=n+1;u<e.length;u++){const c=e[u];if(c.trim()==="")continue;const h=jS(c);if(!h.every(d=>d.trim()==="")&&h.length>=2){const d=h[0].trim();if(d==="")continue;const f=h[1];l[d]=Y1(f)}}return l}else{const l=[];for(let u=n+1;u<e.length;u++){const c=e[u];if(c.trim()==="")continue;const h=jS(c);if(h.every(p=>p.trim()===""))continue;const d={};let f=!1;const g=Math.max(r.length,h.length);for(let p=0;p<g;p++){const C=p<r.length&&r[p]?r[p]:`column_${p+1}`,E=h[p]!==void 0?h[p]:"",y=Y1(E);d[C]=y,y!==null&&String(y).trim()!==""&&(f=!0)}f&&l.push(d)}return l}}async function S0e(){const t=document.createElement("input");t.type="file",t.accept=".csv,text/csv",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=i=>{try{const o=i.target.result,s=b0e(o);let a,l=`${n.name} CSV 로드 완료.`;Array.isArray(s)?s.length>0?(a=s[0],s.length>1&&(l=`${n.name} CSV 로드됨 (주의: 여러 레코드 중 첫 번째만 표시).`)):a=[]:typeof s=="object"&&s!==null?(a=s,l=`${n.name} Key-Value CSV가 단일 JSON 객체로 로드되었습니다.`):(a={},l=`${n.name} CSV 변환 중 예상치 못한 결과.`);const u=JSON.stringify(a,null,2);dt?(dt.value=u,Py(),Pt(We,l,5e3)):ye({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne})}catch(o){ze&&(ze.textContent=`CSV 파일 파싱 오류: ${o.message}`),ye({title:"CSV 파일 파싱 오류",text:`CSV 파일을 JSON으로 변환 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Ne})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{ze&&(ze.textContent="CSV 파일을 읽는 중 오류."),ye({title:"CSV 파일 읽기 오류",text:"CSV 파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}function R0e(t){if(t==null)throw new Error("데이터가 없어 CSV로 변환할 수 없습니다.");let e="";const n=r=>{if(r==null)return"";let i;return typeof r=="object"?i=JSON.stringify(r):i=String(r),(i.includes(",")||i.includes(`
`)||i.includes("\r")||i.includes('"'))&&(i='"'+i.replace(/"/g,'""')+'"'),i};if(Array.isArray(t)){if(t.length===0)return"";if(typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])){const r=[];if(t.forEach(i=>{typeof i=="object"&&i!==null&&Object.keys(i).forEach(o=>{r.includes(o)||r.push(o)})}),r.length>0)e+=r.map(n).join(",")+`\r
`;else if(t.every(i=>typeof i!="object"||i===null))return e+=`value\r
`,t.forEach(i=>{e+=n(i)+`\r
`}),e;t.forEach(i=>{if(typeof i=="object"&&i!==null){const o=r.map(s=>n(i[s]));e+=o.join(",")+`\r
`}else{const o=r.map(()=>n(null));e+=o.join(",")+`\r
`}})}else e+=`value\r
`,t.forEach(r=>{e+=n(r)+`\r
`})}else typeof t=="object"&&t!==null?(e+=`key,value\r
`,Object.keys(t).forEach(r=>{e+=n(r)+","+n(t[r])+`\r
`})):(e+=`value\r
`,e+=n(t)+`\r
`);return e}async function E0e(){if(Ee==null){Pt(We,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await Zi({title:"CSV 파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.csv 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:Ne});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".csv")||(e+=".csv");const n=R0e(Ee),r="\uFEFF",i=new Blob([r+n],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(i),s=document.createElement("a");s.href=o,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o),Pt(We,`${e} 파일이 성공적으로 CSV로 저장되었습니다!`,3e3)}else Pt(We,"CSV 파일 저장이 취소되었습니다.",3e3)}catch(t){ze&&(ze.textContent="CSV 파일 저장/변환 오류: "+t.message),ye({title:"CSV 저장/변환 오류",text:`JSON 데이터를 CSV로 저장/변환 중 오류: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:Ne})}}function T0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=i=>{try{const o=i.target.result;dt?(dt.value=o,Py(),Pt(We,`${n.name} 파일이 로드되었습니다.`,3e3)):ye({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne})}catch(o){ze&&(ze.textContent=`파일 오류: ${o.message}`),ye({title:"파일 로드 오류",text:`파일을 로드하거나 파싱하는 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Ne})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{ze&&(ze.textContent="파일을 읽는 중 오류."),ye({title:"파일 읽기 오류",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}async function M0e(){if(Ee==null){Pt(We,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await Zi({title:"파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:Ne});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".json")||(e+=".json");const n=JSON.stringify(Ee,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),Pt(We,`${e} 파일이 성공적으로 저장되었습니다!`,3e3)}else Pt(We,"파일 저장이 취소되었습니다.",3e3)}catch(t){ze&&(ze.textContent="JSON 파일 저장 오류: "+t.message),ye({title:"파일 저장 오류",text:`JSON 데이터를 파일로 저장 중 오류: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:Ne})}}async function _0e(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",async e=>{const n=e.target.files[0];if(!n){t.parentNode&&t.remove();return}const r=new FileReader;r.onload=async i=>{try{const o=i.target.result,s=JSON.parse(o);if(!Array.isArray(s))throw new Error("템플릿 파일은 배열 형태여야 합니다.");const a=bf().map(u=>u.name),l=await rN({title:`'${n.name}' 파일에서 템플릿 불러오기`,templates:s,message:'아래 목록에서 불러올 템플릿을 선택하세요. <span style="color: var(--color-warning, orange); font-weight:bold;">(덮어씀)</span> 표시는 이름이 같은 기존 사용자 템플릿을 이 파일의 내용으로 변경함을 의미합니다.',confirmButtonText:"선택한 템플릿 불러오기",cancelButtonText:"취소",hotInstance:Ne,existingUserTemplateNames:a});if(l.isConfirmed)if(l.selectedTemplates.length>0){const u=u0e(l.selectedTemplates);Pt(We,`선택된 ${u}개의 사용자 템플릿을 '${n.name}'에서 로드 및 병합했습니다.`,3e3)}else Pt(We,"선택된 템플릿이 없어 아무것도 로드하지 않았습니다.",3e3,"info");else Pt(We,"템플릿 파일 로드가 취소되었습니다.",3e3,"info")}catch(o){ze&&(ze.textContent=`템플릿 파일 처리 오류: ${o.message}`),ye({title:"템플릿 파일 처리 오류",text:`템플릿 파일을 처리하는 중 오류: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Ne})}finally{t.parentNode&&t.remove()}},r.onerror=()=>{ze&&(ze.textContent="템플릿 파일을 읽는 중 오류."),ye({title:"파일 읽기 오류",text:"템플릿 파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne}),t.parentNode&&t.remove()},r.readAsText(n)}),t.click()}async function x0e(){const t=bf();if(!t||t.length===0){Pt(We,"저장할 사용자 정의 템플릿이 없습니다.",3e3);return}try{const e=await rN({title:"파일로 저장할 템플릿 선택",templates:t,message:"파일로 저장할 사용자 정의 템플릿을 선택하세요.",confirmButtonText:"선택한 템플릿 저장하기",cancelButtonText:"취소",hotInstance:Ne});if(e.isConfirmed&&e.selectedTemplates.length>0){const n=e.selectedTemplates.map(({name:i,type:o,value:s})=>({name:i,type:o,value:s})),r=await Zi({title:"템플릿 파일 이름 입력",inputLabel:"저장할 템플릿 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"user_templates",confirmButtonText:"저장",inputValidator:i=>!i||i.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:Ne});if(r.isConfirmed&&r.value){let i=r.value.trim();i.toLowerCase().endsWith(".json")||(i+=".json");const o=JSON.stringify(n,null,2),s=new Blob([o],{type:"application/json"}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a),Pt(We,`선택된 사용자 템플릿이 ${i} 파일로 성공적으로 저장되었습니다!`,3e3)}else Pt(We,"템플릿 파일 이름 입력이 취소되어 저장이 중단되었습니다.",3e3,"info")}else e.isConfirmed&&e.selectedTemplates.length===0?Pt(We,"선택된 템플릿이 없어 아무것도 저장하지 않았습니다.",3e3,"info"):e.isDismissed&&Pt(We,"템플릿 파일 저장이 취소되었습니다.",3e3,"info")}catch(e){ze&&(ze.textContent="템플릿 파일 저장 오류: "+e.message),ye({title:"템플릿 파일 저장 오류",text:`템플릿을 파일로 저장하는 중 오류: ${e.message}`,icon:"error",showCancelButton:!1,hotInstance:Ne})}}function Py(){I0e(),r0e();try{const t=dt.value.trim();if(!t){Ee=null,uu=null,Bc(null,Rf),ow();return}Ee=JSON.parse(t),uu=JSON.parse(JSON.stringify(Ee));const e=qV();if(xt&&(xt.innerHTML=""),typeof Ee=="object"&&Ee!==null)Tf(Ee,xt,"",Ee,0,e);else{const r={["value"]:Ee};Tf(r,xt,"",r,0,e)}ow(),Bc(null,Rf)}catch(t){ze&&(ze.textContent="JSON 파싱 오류: "+t.message),Ee=null,uu=null,xt&&(xt.innerHTML=""),ow(),Bc(null,Rf)}}function P0e(){if(ze&&(ze.textContent=""),Ee!=null)try{const t=JSON.stringify(Ee,null,2);dt&&(dt.value=t),We&&Pt(We,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){ze&&(ze.textContent="JSON 문자열 변환 오류: "+t.message),We&&(We.textContent="")}else dt&&(dt.value=""),We&&Pt(We,"저장할 JSON 데이터가 없습니다.",3e3)}function I0e(){Hj(),ow(),Ee=null,uu=null,eh(null),Qn&&(Qn.innerHTML="",Qn.style.display="none"),Ds&&(Ds.value=""),xt&&(xt.innerHTML=""),Bc(null,Rf)}function ow(){Ne=jV()}function O0e(t,e,n=!1){if(Ee==null)return;const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Ee:s=hu(Ee,o),o===""&&t===i&&(typeof Ee!="object"||Ee===null)){if(Ee=XS(e,Ee),n)return;yv(t),Za(Ee,"value",Ee,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){ye({title:"오류",text:"데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).",icon:"error",showCancelButton:!1,hotInstance:Ne});return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){ye({title:"오류",text:"배열 인덱스 범위를 벗어났습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne});return}let l=!0;const u=s[a],c=XS(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&xt){const f=xt.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(iN(g,c),l=!1)}}!n&&l&&yv(t)}}function A0e(t,e,n,r){let i;if(r&&(t===""||hu(Ee,t)===r)?i=r:i=t===""?Ee:hu(Ee,t),typeof i!="object"||i===null||Array.isArray(i)){ye({title:"오류",text:"키를 업데이트할 부모 객체를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne});return}if(!Object.prototype.hasOwnProperty.call(i,e)){ye({title:"오류",text:`기존 키 "${e}"를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Ne});return}if(n===e){ye({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다.",showCancelButton:!1,hotInstance:Ne});return}if(Object.prototype.hasOwnProperty.call(i,n)){ye({title:"오류",text:`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:Ne});return}const o={},s=i[e];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&delete i[a];for(const a in o)Object.prototype.hasOwnProperty.call(o,a)&&(i[a]=o[a]);ye({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`,showCancelButton:!1,hotInstance:Ne}),yv(`key_renamed_in_parent:${t}`),Za(i,n,Ee,t)}function yv(t="N/A"){if(xt&&Ee!=null){const e=kj(),n=$j(xt);xt.innerHTML="";const r=qV();if(typeof Ee=="object"&&Ee!==null)Tf(Ee,xt,"",Ee,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Ee};Tf(o,xt,"",o,0,r)}if(Lj(xt,n),e){const i=xt.querySelector(`.tree-node[data-path="${e}"]`);i&&eh(i)}}else xt&&(xt.innerHTML="")}function qV(){return{displayTableCallback:Za,getObjectByPathCallback:hu,rootJsonData:Ee}}function Rf(t){const e=hu(Ee,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}Za(e,n,Ee,t,{syncTreeView:!0})}else ye({title:"오류",text:`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Ne})}function Za(t,e,n,r,i={syncTreeView:!0}){if(i0e({dataPathString:r,dataKeyName:e}),Bc(r,Rf),Ne=t0e(t,e,{tableViewDomElement:qS,updateJsonDataCallback:O0e,updateJsonKeyCallback:A0e,refreshTreeViewCallback:yv,getObjectByPathCallback:hu,convertToTypedValueCallback:XS,rootJsonData:n,currentJsonDataRef:()=>Ee,dataPathString:r,displayTableCallback:Za,getTemplates:zV,addTemplate:l0e}),i.syncTreeView&&xt&&r!==void 0&&r!==null){const s=xt.querySelector(`.tree-node[data-path="${r}"]`);s?(eh(s),setTimeout(()=>{const a=xt.querySelector(`.tree-node[data-path="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},50)):r===""&&(eh(null),xt.firstChild&&(xt.scrollTop=0))}}function G1(t){const e=o0e(t);if(e){B1(!0);try{const n=hu(Ee,e.dataPathString);Za(n,e.dataKeyName,Ee,e.dataPathString,{syncTreeView:!1})}catch{ye({title:"오류",text:"히스토리 복원 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Ne})}finally{B1(!1)}}}document.addEventListener("DOMContentLoaded",w0e)});export default H0e();
